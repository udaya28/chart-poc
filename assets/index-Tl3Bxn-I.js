const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-DSzfLmrU.js","assets/init-BvcQWGoJ.js","assets/webworkerAll-3j39heQg.js"])))=>i.map(i=>d[i]);
var __create=Object.create,__defProp$4=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJSMin=(cb,mod)=>()=>(mod||cb((mod={exports:{}}).exports,mod),mod.exports),__export=all=>{let target={};for(var name in all)__defProp$4(target,name,{get:all[name],enumerable:!0});return target},__copyProps=(to,from,except,desc)=>{if(from&&typeof from==`object`||typeof from==`function`)for(var keys$1=__getOwnPropNames(from),i$1=0,n$1=keys$1.length,key$1;i$1<n$1;i$1++)key$1=keys$1[i$1],!__hasOwnProp.call(to,key$1)&&key$1!==except&&__defProp$4(to,key$1,{get:(k$1=>from[k$1]).bind(null,key$1),enumerable:!(desc=__getOwnPropDesc(from,key$1))||desc.enumerable});return to},__toESM=(mod,isNodeMode,target)=>(target=mod==null?{}:__create(__getProtoOf(mod)),__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp$4(target,`default`,{value:mod,enumerable:!0}):target,mod));(function(){let relList=document.createElement(`link`).relList;if(relList&&relList.supports&&relList.supports(`modulepreload`))return;for(let link of document.querySelectorAll(`link[rel="modulepreload"]`))processPreload(link);new MutationObserver(mutations=>{for(let mutation of mutations)if(mutation.type===`childList`)for(let node of mutation.addedNodes)node.tagName===`LINK`&&node.rel===`modulepreload`&&processPreload(node)}).observe(document,{childList:!0,subtree:!0});function getFetchOpts(link){let fetchOpts={};return link.integrity&&(fetchOpts.integrity=link.integrity),link.referrerPolicy&&(fetchOpts.referrerPolicy=link.referrerPolicy),link.crossOrigin===`use-credentials`?fetchOpts.credentials=`include`:link.crossOrigin===`anonymous`?fetchOpts.credentials=`omit`:fetchOpts.credentials=`same-origin`,fetchOpts}function processPreload(link){if(link.ep)return;link.ep=!0;let fetchOpts=getFetchOpts(link);fetch(link.href,fetchOpts)}})();
/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
function makeMap(str){let map$2=Object.create(null);for(let key$1 of str.split(`,`))map$2[key$1]=1;return val=>val in map$2}var EMPTY_OBJ$1={},EMPTY_ARR=[],NOOP$1=()=>{},NO=()=>!1,isOn=key$1=>key$1.charCodeAt(0)===111&&key$1.charCodeAt(1)===110&&(key$1.charCodeAt(2)>122||key$1.charCodeAt(2)<97),isModelListener=key$1=>key$1.startsWith(`onUpdate:`),extend$1=Object.assign,remove=(arr,el)=>{let i$1=arr.indexOf(el);i$1>-1&&arr.splice(i$1,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn$1=(val,key$1)=>hasOwnProperty$1.call(val,key$1),isArray$2=Array.isArray,isMap=val=>toTypeString(val)===`[object Map]`,isSet=val=>toTypeString(val)===`[object Set]`,isDate=val=>toTypeString(val)===`[object Date]`,isFunction$1=val=>typeof val==`function`,isString$1=val=>typeof val==`string`,isSymbol=val=>typeof val==`symbol`,isObject$3=val=>typeof val==`object`&&!!val,isPromise=val=>(isObject$3(val)||isFunction$1(val))&&isFunction$1(val.then)&&isFunction$1(val.catch),objectToString=Object.prototype.toString,toTypeString=value=>objectToString.call(value),toRawType=value=>toTypeString(value).slice(8,-1),isPlainObject=val=>toTypeString(val)===`[object Object]`,isIntegerKey=key$1=>isString$1(key$1)&&key$1!==`NaN`&&key$1[0]!==`-`&&``+parseInt(key$1,10)===key$1,isReservedProp=makeMap(`,key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted`),cacheStringFunction=fn=>{let cache=Object.create(null);return(str=>cache[str]||(cache[str]=fn(str)))},camelizeRE=/-\w/g,camelize=cacheStringFunction(str=>str.replace(camelizeRE,c$2=>c$2.slice(1).toUpperCase())),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(str=>str.replace(hyphenateRE,`-$1`).toLowerCase()),capitalize=cacheStringFunction(str=>str.charAt(0).toUpperCase()+str.slice(1)),toHandlerKey=cacheStringFunction(str=>str?`on${capitalize(str)}`:``),hasChanged=(value,oldValue)=>!Object.is(value,oldValue),invokeArrayFns=(fns,...arg)=>{for(let i$1=0;i$1<fns.length;i$1++)fns[i$1](...arg)},def=(obj,key$1,value,writable=!1)=>{Object.defineProperty(obj,key$1,{configurable:!0,enumerable:!1,writable,value})},looseToNumber=val=>{let n$1=parseFloat(val);return isNaN(n$1)?val:n$1},_globalThis,getGlobalThis=()=>_globalThis||=typeof globalThis<`u`?globalThis:typeof self<`u`?self:typeof window<`u`?window:typeof global<`u`?global:{};function normalizeStyle$1(value){if(isArray$2(value)){let res={};for(let i$1=0;i$1<value.length;i$1++){let item=value[i$1],normalized=isString$1(item)?parseStringStyle(item):normalizeStyle$1(item);if(normalized)for(let key$1 in normalized)res[key$1]=normalized[key$1]}return res}else if(isString$1(value)||isObject$3(value))return value}var listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(cssText){let ret={};return cssText.replace(styleCommentRE,``).split(listDelimiterRE).forEach(item=>{if(item){let tmp=item.split(propertyDelimiterRE);tmp.length>1&&(ret[tmp[0].trim()]=tmp[1].trim())}}),ret}function normalizeClass(value){let res=``;if(isString$1(value))res=value;else if(isArray$2(value))for(let i$1=0;i$1<value.length;i$1++){let normalized=normalizeClass(value[i$1]);normalized&&(res+=normalized+` `)}else if(isObject$3(value))for(let name in value)value[name]&&(res+=name+` `);return res.trim()}var specialBooleanAttrs=`itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`,isSpecialBooleanAttr=makeMap(specialBooleanAttrs),isBooleanAttr=makeMap(specialBooleanAttrs+`,async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected`);function includeBooleanAttr(value){return!!value||value===``}function looseCompareArrays(a$1,b$1){if(a$1.length!==b$1.length)return!1;let equal=!0;for(let i$1=0;equal&&i$1<a$1.length;i$1++)equal=looseEqual(a$1[i$1],b$1[i$1]);return equal}function looseEqual(a$1,b$1){if(a$1===b$1)return!0;let aValidType=isDate(a$1),bValidType=isDate(b$1);if(aValidType||bValidType)return aValidType&&bValidType?a$1.getTime()===b$1.getTime():!1;if(aValidType=isSymbol(a$1),bValidType=isSymbol(b$1),aValidType||bValidType)return a$1===b$1;if(aValidType=isArray$2(a$1),bValidType=isArray$2(b$1),aValidType||bValidType)return aValidType&&bValidType?looseCompareArrays(a$1,b$1):!1;if(aValidType=isObject$3(a$1),bValidType=isObject$3(b$1),aValidType||bValidType){if(!aValidType||!bValidType)return!1;let aKeysCount=Object.keys(a$1).length,bKeysCount=Object.keys(b$1).length;if(aKeysCount!==bKeysCount)return!1;for(let key$1 in a$1){let aHasKey=a$1.hasOwnProperty(key$1),bHasKey=b$1.hasOwnProperty(key$1);if(aHasKey&&!bHasKey||!aHasKey&&bHasKey||!looseEqual(a$1[key$1],b$1[key$1]))return!1}}return String(a$1)===String(b$1)}function looseIndexOf(arr,val){return arr.findIndex(item=>looseEqual(item,val))}var isRef$1=val=>!!(val&&val.__v_isRef===!0),toDisplayString=val=>isString$1(val)?val:val==null?``:isArray$2(val)||isObject$3(val)&&(val.toString===objectToString||!isFunction$1(val.toString))?isRef$1(val)?toDisplayString(val.value):JSON.stringify(val,replacer,2):String(val),replacer=(_key,val)=>isRef$1(val)?replacer(_key,val.value):isMap(val)?{[`Map(${val.size})`]:[...val.entries()].reduce((entries,[key$1,val2],i$1)=>(entries[stringifySymbol(key$1,i$1)+` =>`]=val2,entries),{})}:isSet(val)?{[`Set(${val.size})`]:[...val.values()].map(v$1=>stringifySymbol(v$1))}:isSymbol(val)?stringifySymbol(val):isObject$3(val)&&!isArray$2(val)&&!isPlainObject(val)?String(val):val,stringifySymbol=(v$1,i$1=``)=>{var _a$1;return isSymbol(v$1)?`Symbol(${v$1.description??i$1})`:v$1},activeEffectScope,EffectScope=class{constructor(detached=!1){this.detached=detached,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!detached&&activeEffectScope&&(this.index=(activeEffectScope.scopes||=[]).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let i$1,l$1;if(this.scopes)for(i$1=0,l$1=this.scopes.length;i$1<l$1;i$1++)this.scopes[i$1].pause();for(i$1=0,l$1=this.effects.length;i$1<l$1;i$1++)this.effects[i$1].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let i$1,l$1;if(this.scopes)for(i$1=0,l$1=this.scopes.length;i$1<l$1;i$1++)this.scopes[i$1].resume();for(i$1=0,l$1=this.effects.length;i$1<l$1;i$1++)this.effects[i$1].resume()}}run(fn){if(this._active){let currentEffectScope=activeEffectScope;try{return activeEffectScope=this,fn()}finally{activeEffectScope=currentEffectScope}}}on(){++this._on===1&&(this.prevScope=activeEffectScope,activeEffectScope=this)}off(){this._on>0&&--this._on===0&&(activeEffectScope=this.prevScope,this.prevScope=void 0)}stop(fromParent){if(this._active){this._active=!1;let i$1,l$1;for(i$1=0,l$1=this.effects.length;i$1<l$1;i$1++)this.effects[i$1].stop();for(this.effects.length=0,i$1=0,l$1=this.cleanups.length;i$1<l$1;i$1++)this.cleanups[i$1]();if(this.cleanups.length=0,this.scopes){for(i$1=0,l$1=this.scopes.length;i$1<l$1;i$1++)this.scopes[i$1].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!fromParent){let last=this.parent.scopes.pop();last&&last!==this&&(this.parent.scopes[this.index]=last,last.index=this.index)}this.parent=void 0}}};function getCurrentScope(){return activeEffectScope}var activeSub,pausedQueueEffects=new WeakSet,ReactiveEffect=class{constructor(fn){this.fn=fn,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||batch(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);let prevEffect=activeSub,prevShouldTrack=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=prevEffect,shouldTrack=prevShouldTrack,this.flags&=-3}}stop(){if(this.flags&1){for(let link=this.deps;link;link=link.nextDep)removeSub(link);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}},batchDepth=0,batchedSub,batchedComputed;function batch(sub$1,isComputed=!1){if(sub$1.flags|=8,isComputed){sub$1.next=batchedComputed,batchedComputed=sub$1;return}sub$1.next=batchedSub,batchedSub=sub$1}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let e$2=batchedComputed;for(batchedComputed=void 0;e$2;){let next=e$2.next;e$2.next=void 0,e$2.flags&=-9,e$2=next}}let error$1;for(;batchedSub;){let e$2=batchedSub;for(batchedSub=void 0;e$2;){let next=e$2.next;if(e$2.next=void 0,e$2.flags&=-9,e$2.flags&1)try{e$2.trigger()}catch(err$1){error$1||=err$1}e$2=next}}if(error$1)throw error$1}function prepareDeps(sub$1){for(let link=sub$1.deps;link;link=link.nextDep)link.version=-1,link.prevActiveLink=link.dep.activeLink,link.dep.activeLink=link}function cleanupDeps(sub$1){let head,tail=sub$1.depsTail,link=tail;for(;link;){let prev=link.prevDep;link.version===-1?(link===tail&&(tail=prev),removeSub(link),removeDep(link)):head=link,link.dep.activeLink=link.prevActiveLink,link.prevActiveLink=void 0,link=prev}sub$1.deps=head,sub$1.depsTail=tail}function isDirty(sub$1){for(let link=sub$1.deps;link;link=link.nextDep)if(link.dep.version!==link.version||link.dep.computed&&(refreshComputed(link.dep.computed)||link.dep.version!==link.version))return!0;return!!sub$1._dirty}function refreshComputed(computed$2){if(computed$2.flags&4&&!(computed$2.flags&16)||(computed$2.flags&=-17,computed$2.globalVersion===globalVersion)||(computed$2.globalVersion=globalVersion,!computed$2.isSSR&&computed$2.flags&128&&(!computed$2.deps&&!computed$2._dirty||!isDirty(computed$2))))return;computed$2.flags|=2;let dep=computed$2.dep,prevSub=activeSub,prevShouldTrack=shouldTrack;activeSub=computed$2,shouldTrack=!0;try{prepareDeps(computed$2);let value=computed$2.fn(computed$2._value);(dep.version===0||hasChanged(value,computed$2._value))&&(computed$2.flags|=128,computed$2._value=value,dep.version++)}catch(err$1){throw dep.version++,err$1}finally{activeSub=prevSub,shouldTrack=prevShouldTrack,cleanupDeps(computed$2),computed$2.flags&=-3}}function removeSub(link,soft=!1){let{dep,prevSub,nextSub}=link;if(prevSub&&(prevSub.nextSub=nextSub,link.prevSub=void 0),nextSub&&(nextSub.prevSub=prevSub,link.nextSub=void 0),dep.subs===link&&(dep.subs=prevSub,!prevSub&&dep.computed)){dep.computed.flags&=-5;for(let l$1=dep.computed.deps;l$1;l$1=l$1.nextDep)removeSub(l$1,!0)}!soft&&!--dep.sc&&dep.map&&dep.map.delete(dep.key)}function removeDep(link){let{prevDep,nextDep}=link;prevDep&&(prevDep.nextDep=nextDep,link.prevDep=void 0),nextDep&&(nextDep.prevDep=prevDep,link.nextDep=void 0)}var shouldTrack=!0,trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){let last=trackStack.pop();shouldTrack=last===void 0?!0:last}function cleanupEffect(e$2){let{cleanup}=e$2;if(e$2.cleanup=void 0,cleanup){let prevSub=activeSub;activeSub=void 0;try{cleanup()}finally{activeSub=prevSub}}}var globalVersion=0,Link=class{constructor(sub$1,dep){this.sub=sub$1,this.dep=dep,this.version=dep.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}},Dep=class{constructor(computed$2){this.computed=computed$2,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(debugInfo){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let link=this.activeLink;if(link===void 0||link.sub!==activeSub)link=this.activeLink=new Link(activeSub,this),activeSub.deps?(link.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=link,activeSub.depsTail=link):activeSub.deps=activeSub.depsTail=link,addSub(link);else if(link.version===-1&&(link.version=this.version,link.nextDep)){let next=link.nextDep;next.prevDep=link.prevDep,link.prevDep&&(link.prevDep.nextDep=next),link.prevDep=activeSub.depsTail,link.nextDep=void 0,activeSub.depsTail.nextDep=link,activeSub.depsTail=link,activeSub.deps===link&&(activeSub.deps=next)}return link}trigger(debugInfo){this.version++,globalVersion++,this.notify(debugInfo)}notify(debugInfo){startBatch();try{for(let link=this.subs;link;link=link.prevSub)link.sub.notify()&&link.sub.dep.notify()}finally{endBatch()}}};function addSub(link){if(link.dep.sc++,link.sub.flags&4){let computed$2=link.dep.computed;if(computed$2&&!link.dep.subs){computed$2.flags|=20;for(let l$1=computed$2.deps;l$1;l$1=l$1.nextDep)addSub(l$1)}let currentTail=link.dep.subs;currentTail!==link&&(link.prevSub=currentTail,currentTail&&(currentTail.nextSub=link)),link.dep.subs=link}}var targetMap=new WeakMap,ITERATE_KEY=Symbol(``),MAP_KEY_ITERATE_KEY=Symbol(``),ARRAY_ITERATE_KEY=Symbol(``);function track(target,type,key$1){if(shouldTrack&&activeSub){let depsMap=targetMap.get(target);depsMap||targetMap.set(target,depsMap=new Map);let dep=depsMap.get(key$1);dep||(depsMap.set(key$1,dep=new Dep),dep.map=depsMap,dep.key=key$1),dep.track()}}function trigger$1(target,type,key$1,newValue,oldValue,oldTarget){let depsMap=targetMap.get(target);if(!depsMap){globalVersion++;return}let run=dep=>{dep&&dep.trigger()};if(startBatch(),type===`clear`)depsMap.forEach(run);else{let targetIsArray=isArray$2(target),isArrayIndex=targetIsArray&&isIntegerKey(key$1);if(targetIsArray&&key$1===`length`){let newLength=Number(newValue);depsMap.forEach((dep,key2)=>{(key2===`length`||key2===ARRAY_ITERATE_KEY||!isSymbol(key2)&&key2>=newLength)&&run(dep)})}else switch((key$1!==void 0||depsMap.has(void 0))&&run(depsMap.get(key$1)),isArrayIndex&&run(depsMap.get(ARRAY_ITERATE_KEY)),type){case`add`:targetIsArray?isArrayIndex&&run(depsMap.get(`length`)):(run(depsMap.get(ITERATE_KEY)),isMap(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case`delete`:targetIsArray||(run(depsMap.get(ITERATE_KEY)),isMap(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case`set`:isMap(target)&&run(depsMap.get(ITERATE_KEY));break}}endBatch()}function reactiveReadArray(array){let raw=toRaw(array);return raw===array?raw:(track(raw,`iterate`,ARRAY_ITERATE_KEY),isShallow(array)?raw:raw.map(toReactive))}function shallowReadArray(arr){return track(arr=toRaw(arr),`iterate`,ARRAY_ITERATE_KEY),arr}var arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator$1(this,Symbol.iterator,toReactive)},concat(...args){return reactiveReadArray(this).concat(...args.map(x$1=>isArray$2(x$1)?reactiveReadArray(x$1):x$1))},entries(){return iterator$1(this,`entries`,value=>(value[1]=toReactive(value[1]),value))},every(fn,thisArg){return apply(this,`every`,fn,thisArg,void 0,arguments)},filter(fn,thisArg){return apply(this,`filter`,fn,thisArg,v$1=>v$1.map(toReactive),arguments)},find(fn,thisArg){return apply(this,`find`,fn,thisArg,toReactive,arguments)},findIndex(fn,thisArg){return apply(this,`findIndex`,fn,thisArg,void 0,arguments)},findLast(fn,thisArg){return apply(this,`findLast`,fn,thisArg,toReactive,arguments)},findLastIndex(fn,thisArg){return apply(this,`findLastIndex`,fn,thisArg,void 0,arguments)},forEach(fn,thisArg){return apply(this,`forEach`,fn,thisArg,void 0,arguments)},includes(...args){return searchProxy(this,`includes`,args)},indexOf(...args){return searchProxy(this,`indexOf`,args)},join(separator){return reactiveReadArray(this).join(separator)},lastIndexOf(...args){return searchProxy(this,`lastIndexOf`,args)},map(fn,thisArg){return apply(this,`map`,fn,thisArg,void 0,arguments)},pop(){return noTracking(this,`pop`)},push(...args){return noTracking(this,`push`,args)},reduce(fn,...args){return reduce$1(this,`reduce`,fn,args)},reduceRight(fn,...args){return reduce$1(this,`reduceRight`,fn,args)},shift(){return noTracking(this,`shift`)},some(fn,thisArg){return apply(this,`some`,fn,thisArg,void 0,arguments)},splice(...args){return noTracking(this,`splice`,args)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(comparer){return reactiveReadArray(this).toSorted(comparer)},toSpliced(...args){return reactiveReadArray(this).toSpliced(...args)},unshift(...args){return noTracking(this,`unshift`,args)},values(){return iterator$1(this,`values`,toReactive)}};function iterator$1(self$1,method,wrapValue){let arr=shallowReadArray(self$1),iter=arr[method]();return arr!==self$1&&!isShallow(self$1)&&(iter._next=iter.next,iter.next=()=>{let result=iter._next();return result.done||(result.value=wrapValue(result.value)),result}),iter}var arrayProto$1=Array.prototype;function apply(self$1,method,fn,thisArg,wrappedRetFn,args){let arr=shallowReadArray(self$1),needsWrap=arr!==self$1&&!isShallow(self$1),methodFn=arr[method];if(methodFn!==arrayProto$1[method]){let result2=methodFn.apply(self$1,args);return needsWrap?toReactive(result2):result2}let wrappedFn=fn;arr!==self$1&&(needsWrap?wrappedFn=function(item,index){return fn.call(this,toReactive(item),index,self$1)}:fn.length>2&&(wrappedFn=function(item,index){return fn.call(this,item,index,self$1)}));let result=methodFn.call(arr,wrappedFn,thisArg);return needsWrap&&wrappedRetFn?wrappedRetFn(result):result}function reduce$1(self$1,method,fn,args){let arr=shallowReadArray(self$1),wrappedFn=fn;return arr!==self$1&&(isShallow(self$1)?fn.length>3&&(wrappedFn=function(acc,item,index){return fn.call(this,acc,item,index,self$1)}):wrappedFn=function(acc,item,index){return fn.call(this,acc,toReactive(item),index,self$1)}),arr[method](wrappedFn,...args)}function searchProxy(self$1,method,args){let arr=toRaw(self$1);track(arr,`iterate`,ARRAY_ITERATE_KEY);let res=arr[method](...args);return(res===-1||res===!1)&&isProxy(args[0])?(args[0]=toRaw(args[0]),arr[method](...args)):res}function noTracking(self$1,method,args=[]){pauseTracking(),startBatch();let res=toRaw(self$1)[method].apply(self$1,args);return endBatch(),resetTracking(),res}var isNonTrackableKeys=makeMap(`__proto__,__v_isRef,__isVue`),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(key$1=>key$1!==`arguments`&&key$1!==`caller`).map(key$1=>Symbol[key$1]).filter(isSymbol));function hasOwnProperty(key$1){isSymbol(key$1)||(key$1=String(key$1));let obj=toRaw(this);return track(obj,`has`,key$1),obj.hasOwnProperty(key$1)}var BaseReactiveHandler=class{constructor(_isReadonly=!1,_isShallow=!1){this._isReadonly=_isReadonly,this._isShallow=_isShallow}get(target,key$1,receiver){if(key$1===`__v_skip`)return target.__v_skip;let isReadonly2=this._isReadonly,isShallow2=this._isShallow;if(key$1===`__v_isReactive`)return!isReadonly2;if(key$1===`__v_isReadonly`)return isReadonly2;if(key$1===`__v_isShallow`)return isShallow2;if(key$1===`__v_raw`)return receiver===(isReadonly2?isShallow2?shallowReadonlyMap:readonlyMap:isShallow2?shallowReactiveMap:reactiveMap).get(target)||Object.getPrototypeOf(target)===Object.getPrototypeOf(receiver)?target:void 0;let targetIsArray=isArray$2(target);if(!isReadonly2){let fn;if(targetIsArray&&(fn=arrayInstrumentations[key$1]))return fn;if(key$1===`hasOwnProperty`)return hasOwnProperty}let res=Reflect.get(target,key$1,isRef(target)?target:receiver);if((isSymbol(key$1)?builtInSymbols.has(key$1):isNonTrackableKeys(key$1))||(isReadonly2||track(target,`get`,key$1),isShallow2))return res;if(isRef(res)){let value=targetIsArray&&isIntegerKey(key$1)?res:res.value;return isReadonly2&&isObject$3(value)?readonly(value):value}return isObject$3(res)?isReadonly2?readonly(res):reactive(res):res}},MutableReactiveHandler=class extends BaseReactiveHandler{constructor(isShallow2=!1){super(!1,isShallow2)}set(target,key$1,value,receiver){let oldValue=target[key$1];if(!this._isShallow){let isOldValueReadonly=isReadonly(oldValue);if(!isShallow(value)&&!isReadonly(value)&&(oldValue=toRaw(oldValue),value=toRaw(value)),!isArray$2(target)&&isRef(oldValue)&&!isRef(value))return isOldValueReadonly||(oldValue.value=value),!0}let hadKey=isArray$2(target)&&isIntegerKey(key$1)?Number(key$1)<target.length:hasOwn$1(target,key$1),result=Reflect.set(target,key$1,value,isRef(target)?target:receiver);return target===toRaw(receiver)&&(hadKey?hasChanged(value,oldValue)&&trigger$1(target,`set`,key$1,value,oldValue):trigger$1(target,`add`,key$1,value)),result}deleteProperty(target,key$1){let hadKey=hasOwn$1(target,key$1),oldValue=target[key$1],result=Reflect.deleteProperty(target,key$1);return result&&hadKey&&trigger$1(target,`delete`,key$1,void 0,oldValue),result}has(target,key$1){let result=Reflect.has(target,key$1);return(!isSymbol(key$1)||!builtInSymbols.has(key$1))&&track(target,`has`,key$1),result}ownKeys(target){return track(target,`iterate`,isArray$2(target)?`length`:ITERATE_KEY),Reflect.ownKeys(target)}},ReadonlyReactiveHandler=class extends BaseReactiveHandler{constructor(isShallow2=!1){super(!0,isShallow2)}set(target,key$1){return!0}deleteProperty(target,key$1){return!0}},mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=value=>value,getProto=v$1=>Reflect.getPrototypeOf(v$1);function createIterableMethod(method,isReadonly2,isShallow2){return function(...args){let target=this.__v_raw,rawTarget=toRaw(target),targetIsMap=isMap(rawTarget),isPair=method===`entries`||method===Symbol.iterator&&targetIsMap,isKeyOnly=method===`keys`&&targetIsMap,innerIterator=target[method](...args),wrap=isShallow2?toShallow:isReadonly2?toReadonly:toReactive;return!isReadonly2&&track(rawTarget,`iterate`,isKeyOnly?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){let{value,done}=innerIterator.next();return done?{value,done}:{value:isPair?[wrap(value[0]),wrap(value[1])]:wrap(value),done}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(type){return function(...args){return type===`delete`?!1:type===`clear`?void 0:this}}function createInstrumentations(readonly$1,shallow){let instrumentations={get(key$1){let target=this.__v_raw,rawTarget=toRaw(target),rawKey=toRaw(key$1);readonly$1||(hasChanged(key$1,rawKey)&&track(rawTarget,`get`,key$1),track(rawTarget,`get`,rawKey));let{has:has$1}=getProto(rawTarget),wrap=shallow?toShallow:readonly$1?toReadonly:toReactive;if(has$1.call(rawTarget,key$1))return wrap(target.get(key$1));if(has$1.call(rawTarget,rawKey))return wrap(target.get(rawKey));target!==rawTarget&&target.get(key$1)},get size(){let target=this.__v_raw;return!readonly$1&&track(toRaw(target),`iterate`,ITERATE_KEY),target.size},has(key$1){let target=this.__v_raw,rawTarget=toRaw(target),rawKey=toRaw(key$1);return readonly$1||(hasChanged(key$1,rawKey)&&track(rawTarget,`has`,key$1),track(rawTarget,`has`,rawKey)),key$1===rawKey?target.has(key$1):target.has(key$1)||target.has(rawKey)},forEach(callback,thisArg){let observed=this,target=observed.__v_raw,rawTarget=toRaw(target),wrap=shallow?toShallow:readonly$1?toReadonly:toReactive;return!readonly$1&&track(rawTarget,`iterate`,ITERATE_KEY),target.forEach((value,key$1)=>callback.call(thisArg,wrap(value),wrap(key$1),observed))}};return extend$1(instrumentations,readonly$1?{add:createReadonlyMethod(`add`),set:createReadonlyMethod(`set`),delete:createReadonlyMethod(`delete`),clear:createReadonlyMethod(`clear`)}:{add(value){!shallow&&!isShallow(value)&&!isReadonly(value)&&(value=toRaw(value));let target=toRaw(this);return getProto(target).has.call(target,value)||(target.add(value),trigger$1(target,`add`,value,value)),this},set(key$1,value){!shallow&&!isShallow(value)&&!isReadonly(value)&&(value=toRaw(value));let target=toRaw(this),{has:has$1,get:get$1}=getProto(target),hadKey=has$1.call(target,key$1);hadKey||=(key$1=toRaw(key$1),has$1.call(target,key$1));let oldValue=get$1.call(target,key$1);return target.set(key$1,value),hadKey?hasChanged(value,oldValue)&&trigger$1(target,`set`,key$1,value,oldValue):trigger$1(target,`add`,key$1,value),this},delete(key$1){let target=toRaw(this),{has:has$1,get:get$1}=getProto(target),hadKey=has$1.call(target,key$1);hadKey||=(key$1=toRaw(key$1),has$1.call(target,key$1));let oldValue=get$1?get$1.call(target,key$1):void 0,result=target.delete(key$1);return hadKey&&trigger$1(target,`delete`,key$1,void 0,oldValue),result},clear(){let target=toRaw(this),hadItems=target.size!==0,oldTarget,result=target.clear();return hadItems&&trigger$1(target,`clear`,void 0,void 0,void 0),result}}),[`keys`,`values`,`entries`,Symbol.iterator].forEach(method=>{instrumentations[method]=createIterableMethod(method,readonly$1,shallow)}),instrumentations}function createInstrumentationGetter(isReadonly2,shallow){let instrumentations=createInstrumentations(isReadonly2,shallow);return(target,key$1,receiver)=>key$1===`__v_isReactive`?!isReadonly2:key$1===`__v_isReadonly`?isReadonly2:key$1===`__v_raw`?target:Reflect.get(hasOwn$1(instrumentations,key$1)&&key$1 in target?instrumentations:target,key$1,receiver)}var mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(rawType){switch(rawType){case`Object`:case`Array`:return 1;case`Map`:case`Set`:case`WeakMap`:case`WeakSet`:return 2;default:return 0}}function getTargetType(value){return value.__v_skip||!Object.isExtensible(value)?0:targetTypeMap(toRawType(value))}function reactive(target){return isReadonly(target)?target:createReactiveObject(target,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(target){return createReactiveObject(target,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(target){return createReactiveObject(target,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(target,isReadonly2,baseHandlers,collectionHandlers,proxyMap){if(!isObject$3(target)||target.__v_raw&&!(isReadonly2&&target.__v_isReactive))return target;let targetType=getTargetType(target);if(targetType===0)return target;let existingProxy=proxyMap.get(target);if(existingProxy)return existingProxy;let proxy=new Proxy(target,targetType===2?collectionHandlers:baseHandlers);return proxyMap.set(target,proxy),proxy}function isReactive(value){return isReadonly(value)?isReactive(value.__v_raw):!!(value&&value.__v_isReactive)}function isReadonly(value){return!!(value&&value.__v_isReadonly)}function isShallow(value){return!!(value&&value.__v_isShallow)}function isProxy(value){return value?!!value.__v_raw:!1}function toRaw(observed){let raw=observed&&observed.__v_raw;return raw?toRaw(raw):observed}function markRaw(value){return!hasOwn$1(value,`__v_skip`)&&Object.isExtensible(value)&&def(value,`__v_skip`,!0),value}var toReactive=value=>isObject$3(value)?reactive(value):value,toReadonly=value=>isObject$3(value)?readonly(value):value;function isRef(r$1){return r$1?r$1.__v_isRef===!0:!1}function ref(value){return createRef(value,!1)}function shallowRef(value){return createRef(value,!0)}function createRef(rawValue,shallow){return isRef(rawValue)?rawValue:new RefImpl(rawValue,shallow)}var RefImpl=class{constructor(value,isShallow2){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=isShallow2?value:toRaw(value),this._value=isShallow2?value:toReactive(value),this.__v_isShallow=isShallow2}get value(){return this.dep.track(),this._value}set value(newValue){let oldValue=this._rawValue,useDirectValue=this.__v_isShallow||isShallow(newValue)||isReadonly(newValue);newValue=useDirectValue?newValue:toRaw(newValue),hasChanged(newValue,oldValue)&&(this._rawValue=newValue,this._value=useDirectValue?newValue:toReactive(newValue),this.dep.trigger())}};function unref(ref2){return isRef(ref2)?ref2.value:ref2}var shallowUnwrapHandlers={get:(target,key$1,receiver)=>key$1===`__v_raw`?target:unref(Reflect.get(target,key$1,receiver)),set:(target,key$1,value,receiver)=>{let oldValue=target[key$1];return isRef(oldValue)&&!isRef(value)?(oldValue.value=value,!0):Reflect.set(target,key$1,value,receiver)}};function proxyRefs(objectWithRefs){return isReactive(objectWithRefs)?objectWithRefs:new Proxy(objectWithRefs,shallowUnwrapHandlers)}var ComputedRefImpl=class{constructor(fn,setter,isSSR){this.fn=fn,this.setter=setter,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!setter,this.isSSR=isSSR}notify(){if(this.flags|=16,!(this.flags&8)&&activeSub!==this)return batch(this,!0),!0}get value(){let link=this.dep.track();return refreshComputed(this),link&&(link.version=this.dep.version),this._value}set value(newValue){this.setter&&this.setter(newValue)}};function computed$1(getterOrOptions,debugOptions,isSSR=!1){let getter,setter;return isFunction$1(getterOrOptions)?getter=getterOrOptions:(getter=getterOrOptions.get,setter=getterOrOptions.set),new ComputedRefImpl(getter,setter,isSSR)}var INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap,activeWatcher=void 0;function onWatcherCleanup(cleanupFn,failSilently=!1,owner=activeWatcher){if(owner){let cleanups=cleanupMap.get(owner);cleanups||cleanupMap.set(owner,cleanups=[]),cleanups.push(cleanupFn)}}function watch$1(source$2,cb,options=EMPTY_OBJ$1){let{immediate,deep,once,scheduler,augmentJob,call}=options,reactiveGetter=source2=>deep?source2:isShallow(source2)||deep===!1||deep===0?traverse(source2,1):traverse(source2),effect$1,getter,cleanup,boundCleanup,forceTrigger=!1,isMultiSource=!1;if(isRef(source$2)?(getter=()=>source$2.value,forceTrigger=isShallow(source$2)):isReactive(source$2)?(getter=()=>reactiveGetter(source$2),forceTrigger=!0):isArray$2(source$2)?(isMultiSource=!0,forceTrigger=source$2.some(s$1=>isReactive(s$1)||isShallow(s$1)),getter=()=>source$2.map(s$1=>{if(isRef(s$1))return s$1.value;if(isReactive(s$1))return reactiveGetter(s$1);if(isFunction$1(s$1))return call?call(s$1,2):s$1()})):getter=isFunction$1(source$2)?cb?call?()=>call(source$2,2):source$2:()=>{if(cleanup){pauseTracking();try{cleanup()}finally{resetTracking()}}let currentEffect=activeWatcher;activeWatcher=effect$1;try{return call?call(source$2,3,[boundCleanup]):source$2(boundCleanup)}finally{activeWatcher=currentEffect}}:NOOP$1,cb&&deep){let baseGetter=getter,depth=deep===!0?1/0:deep;getter=()=>traverse(baseGetter(),depth)}let scope=getCurrentScope(),watchHandle=()=>{effect$1.stop(),scope&&scope.active&&remove(scope.effects,effect$1)};if(once&&cb){let _cb=cb;cb=(...args)=>{_cb(...args),watchHandle()}}let oldValue=isMultiSource?Array(source$2.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE,job=immediateFirstRun=>{if(!(!(effect$1.flags&1)||!effect$1.dirty&&!immediateFirstRun))if(cb){let newValue=effect$1.run();if(deep||forceTrigger||(isMultiSource?newValue.some((v$1,i$1)=>hasChanged(v$1,oldValue[i$1])):hasChanged(newValue,oldValue))){cleanup&&cleanup();let currentWatcher=activeWatcher;activeWatcher=effect$1;try{let args=[newValue,oldValue===INITIAL_WATCHER_VALUE?void 0:isMultiSource&&oldValue[0]===INITIAL_WATCHER_VALUE?[]:oldValue,boundCleanup];oldValue=newValue,call?call(cb,3,args):cb(...args)}finally{activeWatcher=currentWatcher}}}else effect$1.run()};return augmentJob&&augmentJob(job),effect$1=new ReactiveEffect(getter),effect$1.scheduler=scheduler?()=>scheduler(job,!1):job,boundCleanup=fn=>onWatcherCleanup(fn,!1,effect$1),cleanup=effect$1.onStop=()=>{let cleanups=cleanupMap.get(effect$1);if(cleanups){if(call)call(cleanups,4);else for(let cleanup2 of cleanups)cleanup2();cleanupMap.delete(effect$1)}},cb?immediate?job(!0):oldValue=effect$1.run():scheduler?scheduler(job.bind(null,!0),!0):effect$1.run(),watchHandle.pause=effect$1.pause.bind(effect$1),watchHandle.resume=effect$1.resume.bind(effect$1),watchHandle.stop=watchHandle,watchHandle}function traverse(value,depth=1/0,seen$1){if(depth<=0||!isObject$3(value)||value.__v_skip||(seen$1||=new Map,(seen$1.get(value)||0)>=depth))return value;if(seen$1.set(value,depth),depth--,isRef(value))traverse(value.value,depth,seen$1);else if(isArray$2(value))for(let i$1=0;i$1<value.length;i$1++)traverse(value[i$1],depth,seen$1);else if(isSet(value)||isMap(value))value.forEach(v$1=>{traverse(v$1,depth,seen$1)});else if(isPlainObject(value)){for(let key$1 in value)traverse(value[key$1],depth,seen$1);for(let key$1 of Object.getOwnPropertySymbols(value))Object.prototype.propertyIsEnumerable.call(value,key$1)&&traverse(value[key$1],depth,seen$1)}return value}function callWithErrorHandling(fn,instance,type,args){try{return args?fn(...args):fn()}catch(err$1){handleError(err$1,instance,type)}}function callWithAsyncErrorHandling(fn,instance,type,args){if(isFunction$1(fn)){let res=callWithErrorHandling(fn,instance,type,args);return res&&isPromise(res)&&res.catch(err$1=>{handleError(err$1,instance,type)}),res}if(isArray$2(fn)){let values=[];for(let i$1=0;i$1<fn.length;i$1++)values.push(callWithAsyncErrorHandling(fn[i$1],instance,type,args));return values}}function handleError(err$1,instance,type,throwInDev=!0){let contextVNode=instance?instance.vnode:null,{errorHandler,throwUnhandledErrorInProduction}=instance&&instance.appContext.config||EMPTY_OBJ$1;if(instance){let cur=instance.parent,exposedInstance=instance.proxy,errorInfo=`https://vuejs.org/error-reference/#runtime-${type}`;for(;cur;){let errorCapturedHooks=cur.ec;if(errorCapturedHooks){for(let i$1=0;i$1<errorCapturedHooks.length;i$1++)if(errorCapturedHooks[i$1](err$1,exposedInstance,errorInfo)===!1)return}cur=cur.parent}if(errorHandler){pauseTracking(),callWithErrorHandling(errorHandler,null,10,[err$1,exposedInstance,errorInfo]),resetTracking();return}}logError$1(err$1,type,contextVNode,throwInDev,throwUnhandledErrorInProduction)}function logError$1(err$1,type,contextVNode,throwInDev=!0,throwInProd=!1){if(throwInProd)throw err$1;console.error(err$1)}var queue=[],flushIndex=-1,pendingPostFlushCbs=[],activePostFlushCbs=null,postFlushIndex=0,resolvedPromise=Promise.resolve(),currentFlushPromise=null;function nextTick(fn){let p$2=currentFlushPromise||resolvedPromise;return fn?p$2.then(this?fn.bind(this):fn):p$2}function findInsertionIndex$1(id){let start$1=flushIndex+1,end$1=queue.length;for(;start$1<end$1;){let middle=start$1+end$1>>>1,middleJob=queue[middle],middleJobId=getId$1(middleJob);middleJobId<id||middleJobId===id&&middleJob.flags&2?start$1=middle+1:end$1=middle}return start$1}function queueJob(job){if(!(job.flags&1)){let jobId=getId$1(job),lastJob=queue[queue.length-1];!lastJob||!(job.flags&2)&&jobId>=getId$1(lastJob)?queue.push(job):queue.splice(findInsertionIndex$1(jobId),0,job),job.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||=resolvedPromise.then(flushJobs)}function queuePostFlushCb(cb){isArray$2(cb)?pendingPostFlushCbs.push(...cb):activePostFlushCbs&&cb.id===-1?activePostFlushCbs.splice(postFlushIndex+1,0,cb):cb.flags&1||(pendingPostFlushCbs.push(cb),cb.flags|=1),queueFlush()}function flushPreFlushCbs(instance,seen$1,i$1=flushIndex+1){for(;i$1<queue.length;i$1++){let cb=queue[i$1];if(cb&&cb.flags&2){if(instance&&cb.id!==instance.uid)continue;queue.splice(i$1,1),i$1--,cb.flags&4&&(cb.flags&=-2),cb(),cb.flags&4||(cb.flags&=-2)}}}function flushPostFlushCbs(seen$1){if(pendingPostFlushCbs.length){let deduped=[...new Set(pendingPostFlushCbs)].sort((a$1,b$1)=>getId$1(a$1)-getId$1(b$1));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...deduped);return}for(activePostFlushCbs=deduped,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){let cb=activePostFlushCbs[postFlushIndex];cb.flags&4&&(cb.flags&=-2),cb.flags&8||cb(),cb.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}var getId$1=job=>job.id==null?job.flags&2?-1:1/0:job.id;function flushJobs(seen$1){try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){let job=queue[flushIndex];job&&!(job.flags&8)&&(job.flags&4&&(job.flags&=-2),callWithErrorHandling(job,job.i,job.i?15:14),job.flags&4||(job.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){let job=queue[flushIndex];job&&(job.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(seen$1),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs(seen$1)}}var currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(instance){let prev=currentRenderingInstance;return currentRenderingInstance=instance,currentScopeId=instance&&instance.type.__scopeId||null,prev}function withCtx(fn,ctx=currentRenderingInstance,isNonScopedSlot){if(!ctx||fn._n)return fn;let renderFnWithContext=(...args)=>{renderFnWithContext._d&&setBlockTracking(-1);let prevInstance=setCurrentRenderingInstance(ctx),res;try{res=fn(...args)}finally{setCurrentRenderingInstance(prevInstance),renderFnWithContext._d&&setBlockTracking(1)}return res};return renderFnWithContext._n=!0,renderFnWithContext._c=!0,renderFnWithContext._d=!0,renderFnWithContext}function withDirectives(vnode,directives){if(currentRenderingInstance===null)return vnode;let instance=getComponentPublicInstance(currentRenderingInstance),bindings=vnode.dirs||=[];for(let i$1=0;i$1<directives.length;i$1++){let[dir,value,arg,modifiers=EMPTY_OBJ$1]=directives[i$1];dir&&(isFunction$1(dir)&&(dir={mounted:dir,updated:dir}),dir.deep&&traverse(value),bindings.push({dir,instance,value,oldValue:void 0,arg,modifiers}))}return vnode}function invokeDirectiveHook(vnode,prevVNode,instance,name){let bindings=vnode.dirs,oldBindings=prevVNode&&prevVNode.dirs;for(let i$1=0;i$1<bindings.length;i$1++){let binding=bindings[i$1];oldBindings&&(binding.oldValue=oldBindings[i$1].value);let hook=binding.dir[name];hook&&(pauseTracking(),callWithAsyncErrorHandling(hook,instance,8,[vnode.el,binding,vnode,prevVNode]),resetTracking())}}var TeleportEndKey=Symbol(`_vte`),isTeleport=type=>type.__isTeleport,leaveCbKey=Symbol(`_leaveCb`),enterCbKey$1=Symbol(`_enterCb`);function setTransitionHooks(vnode,hooks){vnode.shapeFlag&6&&vnode.component?(vnode.transition=hooks,setTransitionHooks(vnode.component.subTree,hooks)):vnode.shapeFlag&128?(vnode.ssContent.transition=hooks.clone(vnode.ssContent),vnode.ssFallback.transition=hooks.clone(vnode.ssFallback)):vnode.transition=hooks}function defineComponent(options,extraOptions){return isFunction$1(options)?(()=>extend$1({name:options.name},extraOptions,{setup:options}))():options}function markAsyncBoundary(instance){instance.ids=[instance.ids[0]+ instance.ids[2]+++`-`,0,0]}var pendingSetRefMap=new WeakMap;function setRef(rawRef,oldRawRef,parentSuspense,vnode,isUnmount=!1){if(isArray$2(rawRef)){rawRef.forEach((r$1,i$1)=>setRef(r$1,oldRawRef&&(isArray$2(oldRawRef)?oldRawRef[i$1]:oldRawRef),parentSuspense,vnode,isUnmount));return}if(isAsyncWrapper(vnode)&&!isUnmount){vnode.shapeFlag&512&&vnode.type.__asyncResolved&&vnode.component.subTree.component&&setRef(rawRef,oldRawRef,parentSuspense,vnode.component.subTree);return}let refValue=vnode.shapeFlag&4?getComponentPublicInstance(vnode.component):vnode.el,value=isUnmount?null:refValue,{i:owner,r:ref$1}=rawRef,oldRef=oldRawRef&&oldRawRef.r,refs=owner.refs===EMPTY_OBJ$1?owner.refs={}:owner.refs,setupState=owner.setupState,rawSetupState=toRaw(setupState),canSetSetupRef=setupState===EMPTY_OBJ$1?NO:key$1=>hasOwn$1(rawSetupState,key$1),canSetRef=ref2=>!0;if(oldRef!=null&&oldRef!==ref$1){if(invalidatePendingSetRef(oldRawRef),isString$1(oldRef))refs[oldRef]=null,canSetSetupRef(oldRef)&&(setupState[oldRef]=null);else if(isRef(oldRef)){canSetRef(oldRef)&&(oldRef.value=null);let oldRawRefAtom=oldRawRef;oldRawRefAtom.k&&(refs[oldRawRefAtom.k]=null)}}if(isFunction$1(ref$1))callWithErrorHandling(ref$1,owner,12,[value,refs]);else{let _isString=isString$1(ref$1),_isRef=isRef(ref$1);if(_isString||_isRef){let doSet=()=>{if(rawRef.f){let existing=_isString?canSetSetupRef(ref$1)?setupState[ref$1]:refs[ref$1]:canSetRef(ref$1)||!rawRef.k?ref$1.value:refs[rawRef.k];if(isUnmount)isArray$2(existing)&&remove(existing,refValue);else if(isArray$2(existing))existing.includes(refValue)||existing.push(refValue);else if(_isString)refs[ref$1]=[refValue],canSetSetupRef(ref$1)&&(setupState[ref$1]=refs[ref$1]);else{let newVal=[refValue];canSetRef(ref$1)&&(ref$1.value=newVal),rawRef.k&&(refs[rawRef.k]=newVal)}}else _isString?(refs[ref$1]=value,canSetSetupRef(ref$1)&&(setupState[ref$1]=value)):_isRef&&(canSetRef(ref$1)&&(ref$1.value=value),rawRef.k&&(refs[rawRef.k]=value))};if(value){let job=()=>{doSet(),pendingSetRefMap.delete(rawRef)};job.id=-1,pendingSetRefMap.set(rawRef,job),queuePostRenderEffect(job,parentSuspense)}else invalidatePendingSetRef(rawRef),doSet()}}}function invalidatePendingSetRef(rawRef){let pendingSetRef=pendingSetRefMap.get(rawRef);pendingSetRef&&(pendingSetRef.flags|=8,pendingSetRefMap.delete(rawRef))}var requestIdleCallback=getGlobalThis().requestIdleCallback||(cb=>setTimeout(cb,1)),cancelIdleCallback=getGlobalThis().cancelIdleCallback||(id=>clearTimeout(id)),isAsyncWrapper=i$1=>!!i$1.type.__asyncLoader,isKeepAlive=vnode=>vnode.type.__isKeepAlive;function onActivated(hook,target){registerKeepAliveHook(hook,`a`,target)}function onDeactivated(hook,target){registerKeepAliveHook(hook,`da`,target)}function registerKeepAliveHook(hook,type,target=currentInstance){let wrappedHook=hook.__wdc||=()=>{let current=target;for(;current;){if(current.isDeactivated)return;current=current.parent}return hook()};if(injectHook(type,wrappedHook,target),target){let current=target.parent;for(;current&&current.parent;)isKeepAlive(current.parent.vnode)&&injectToKeepAliveRoot(wrappedHook,type,target,current),current=current.parent}}function injectToKeepAliveRoot(hook,type,target,keepAliveRoot){let injected=injectHook(type,hook,keepAliveRoot,!0);onUnmounted(()=>{remove(keepAliveRoot[type],injected)},target)}function injectHook(type,hook,target=currentInstance,prepend=!1){if(target){let hooks=target[type]||(target[type]=[]),wrappedHook=hook.__weh||=(...args)=>{pauseTracking();let reset=setCurrentInstance(target),res=callWithAsyncErrorHandling(hook,target,type,args);return reset(),resetTracking(),res};return prepend?hooks.unshift(wrappedHook):hooks.push(wrappedHook),wrappedHook}}var createHook=lifecycle$1=>(hook,target=currentInstance)=>{(!isInSSRComponentSetup||lifecycle$1===`sp`)&&injectHook(lifecycle$1,(...args)=>hook(...args),target)},onBeforeMount=createHook(`bm`),onMounted=createHook(`m`),onBeforeUpdate=createHook(`bu`),onUpdated=createHook(`u`),onBeforeUnmount=createHook(`bum`),onUnmounted=createHook(`um`),onServerPrefetch=createHook(`sp`),onRenderTriggered=createHook(`rtg`),onRenderTracked=createHook(`rtc`);function onErrorCaptured(hook,target=currentInstance){injectHook(`ec`,hook,target)}var COMPONENTS=`components`;function resolveComponent(name,maybeSelfReference){return resolveAsset(COMPONENTS,name,!0,maybeSelfReference)||name}var NULL_DYNAMIC_COMPONENT=Symbol.for(`v-ndc`);function resolveAsset(type,name,warnMissing=!0,maybeSelfReference=!1){let instance=currentRenderingInstance||currentInstance;if(instance){let Component=instance.type;if(type===COMPONENTS){let selfName=getComponentName(Component,!1);if(selfName&&(selfName===name||selfName===camelize(name)||selfName===capitalize(camelize(name))))return Component}let res=resolve(instance[type]||Component[type],name)||resolve(instance.appContext[type],name);return!res&&maybeSelfReference?Component:res}}function resolve(registry,name){return registry&&(registry[name]||registry[camelize(name)]||registry[capitalize(camelize(name))])}var getPublicInstance=i$1=>i$1?isStatefulComponent(i$1)?getComponentPublicInstance(i$1):getPublicInstance(i$1.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:i$1=>i$1,$el:i$1=>i$1.vnode.el,$data:i$1=>i$1.data,$props:i$1=>i$1.props,$attrs:i$1=>i$1.attrs,$slots:i$1=>i$1.slots,$refs:i$1=>i$1.refs,$parent:i$1=>getPublicInstance(i$1.parent),$root:i$1=>getPublicInstance(i$1.root),$host:i$1=>i$1.ce,$emit:i$1=>i$1.emit,$options:i$1=>resolveMergedOptions(i$1),$forceUpdate:i$1=>i$1.f||=()=>{queueJob(i$1.update)},$nextTick:i$1=>i$1.n||=nextTick.bind(i$1.proxy),$watch:i$1=>instanceWatch.bind(i$1)}),hasSetupBinding=(state,key$1)=>state!==EMPTY_OBJ$1&&!state.__isScriptSetup&&hasOwn$1(state,key$1),PublicInstanceProxyHandlers={get({_:instance},key$1){if(key$1===`__v_skip`)return!0;let{ctx,setupState,data,props,accessCache,type,appContext}=instance,normalizedProps;if(key$1[0]!==`$`){let n$1=accessCache[key$1];if(n$1!==void 0)switch(n$1){case 1:return setupState[key$1];case 2:return data[key$1];case 4:return ctx[key$1];case 3:return props[key$1]}else if(hasSetupBinding(setupState,key$1))return accessCache[key$1]=1,setupState[key$1];else if(data!==EMPTY_OBJ$1&&hasOwn$1(data,key$1))return accessCache[key$1]=2,data[key$1];else if((normalizedProps=instance.propsOptions[0])&&hasOwn$1(normalizedProps,key$1))return accessCache[key$1]=3,props[key$1];else if(ctx!==EMPTY_OBJ$1&&hasOwn$1(ctx,key$1))return accessCache[key$1]=4,ctx[key$1];else shouldCacheAccess&&(accessCache[key$1]=0)}let publicGetter=publicPropertiesMap[key$1],cssModule,globalProperties;if(publicGetter)return key$1===`$attrs`&&track(instance.attrs,`get`,``),publicGetter(instance);if((cssModule=type.__cssModules)&&(cssModule=cssModule[key$1]))return cssModule;if(ctx!==EMPTY_OBJ$1&&hasOwn$1(ctx,key$1))return accessCache[key$1]=4,ctx[key$1];if(globalProperties=appContext.config.globalProperties,hasOwn$1(globalProperties,key$1))return globalProperties[key$1]},set({_:instance},key$1,value){let{data,setupState,ctx}=instance;return hasSetupBinding(setupState,key$1)?(setupState[key$1]=value,!0):data!==EMPTY_OBJ$1&&hasOwn$1(data,key$1)?(data[key$1]=value,!0):hasOwn$1(instance.props,key$1)||key$1[0]===`$`&&key$1.slice(1)in instance?!1:(ctx[key$1]=value,!0)},has({_:{data,setupState,accessCache,ctx,appContext,propsOptions,type}},key$1){let normalizedProps,cssModules;return!!(accessCache[key$1]||data!==EMPTY_OBJ$1&&key$1[0]!==`$`&&hasOwn$1(data,key$1)||hasSetupBinding(setupState,key$1)||(normalizedProps=propsOptions[0])&&hasOwn$1(normalizedProps,key$1)||hasOwn$1(ctx,key$1)||hasOwn$1(publicPropertiesMap,key$1)||hasOwn$1(appContext.config.globalProperties,key$1)||(cssModules=type.__cssModules)&&cssModules[key$1])},defineProperty(target,key$1,descriptor){return descriptor.get==null?hasOwn$1(descriptor,`value`)&&this.set(target,key$1,descriptor.value,null):target._.accessCache[key$1]=0,Reflect.defineProperty(target,key$1,descriptor)}};function normalizePropsOrEmits(props){return isArray$2(props)?props.reduce((normalized,p$2)=>(normalized[p$2]=null,normalized),{}):props}var shouldCacheAccess=!0;function applyOptions(instance){let options=resolveMergedOptions(instance),publicThis=instance.proxy,ctx=instance.ctx;shouldCacheAccess=!1,options.beforeCreate&&callHook(options.beforeCreate,instance,`bc`);let{data:dataOptions,computed:computedOptions,methods,watch:watchOptions,provide:provideOptions,inject:injectOptions,created,beforeMount,mounted,beforeUpdate,updated,activated,deactivated,beforeDestroy,beforeUnmount,destroyed,unmounted,render:render$1,renderTracked,renderTriggered,errorCaptured,serverPrefetch,expose,inheritAttrs,components,directives,filters}=options,checkDuplicateProperties=null;if(injectOptions&&resolveInjections(injectOptions,ctx,null),methods)for(let key$1 in methods){let methodHandler=methods[key$1];isFunction$1(methodHandler)&&(ctx[key$1]=methodHandler.bind(publicThis))}if(dataOptions){let data=dataOptions.call(publicThis,publicThis);isObject$3(data)&&(instance.data=reactive(data))}if(shouldCacheAccess=!0,computedOptions)for(let key$1 in computedOptions){let opt=computedOptions[key$1],get$1=isFunction$1(opt)?opt.bind(publicThis,publicThis):isFunction$1(opt.get)?opt.get.bind(publicThis,publicThis):NOOP$1,set$1=!isFunction$1(opt)&&isFunction$1(opt.set)?opt.set.bind(publicThis):NOOP$1,c$2=computed({get:get$1,set:set$1});Object.defineProperty(ctx,key$1,{enumerable:!0,configurable:!0,get:()=>c$2.value,set:v$1=>c$2.value=v$1})}if(watchOptions)for(let key$1 in watchOptions)createWatcher(watchOptions[key$1],ctx,publicThis,key$1);if(provideOptions){let provides=isFunction$1(provideOptions)?provideOptions.call(publicThis):provideOptions;Reflect.ownKeys(provides).forEach(key$1=>{provide(key$1,provides[key$1])})}created&&callHook(created,instance,`c`);function registerLifecycleHook(register$1,hook){isArray$2(hook)?hook.forEach(_hook=>register$1(_hook.bind(publicThis))):hook&&register$1(hook.bind(publicThis))}if(registerLifecycleHook(onBeforeMount,beforeMount),registerLifecycleHook(onMounted,mounted),registerLifecycleHook(onBeforeUpdate,beforeUpdate),registerLifecycleHook(onUpdated,updated),registerLifecycleHook(onActivated,activated),registerLifecycleHook(onDeactivated,deactivated),registerLifecycleHook(onErrorCaptured,errorCaptured),registerLifecycleHook(onRenderTracked,renderTracked),registerLifecycleHook(onRenderTriggered,renderTriggered),registerLifecycleHook(onBeforeUnmount,beforeUnmount),registerLifecycleHook(onUnmounted,unmounted),registerLifecycleHook(onServerPrefetch,serverPrefetch),isArray$2(expose))if(expose.length){let exposed=instance.exposed||={};expose.forEach(key$1=>{Object.defineProperty(exposed,key$1,{get:()=>publicThis[key$1],set:val=>publicThis[key$1]=val,enumerable:!0})})}else instance.exposed||={};render$1&&instance.render===NOOP$1&&(instance.render=render$1),inheritAttrs!=null&&(instance.inheritAttrs=inheritAttrs),components&&(instance.components=components),directives&&(instance.directives=directives),serverPrefetch&&markAsyncBoundary(instance)}function resolveInjections(injectOptions,ctx,checkDuplicateProperties=NOOP$1){for(let key$1 in isArray$2(injectOptions)&&(injectOptions=normalizeInject(injectOptions)),injectOptions){let opt=injectOptions[key$1],injected;injected=isObject$3(opt)?`default`in opt?inject(opt.from||key$1,opt.default,!0):inject(opt.from||key$1):inject(opt),isRef(injected)?Object.defineProperty(ctx,key$1,{enumerable:!0,configurable:!0,get:()=>injected.value,set:v$1=>injected.value=v$1}):ctx[key$1]=injected}}function callHook(hook,instance,type){callWithAsyncErrorHandling(isArray$2(hook)?hook.map(h$2=>h$2.bind(instance.proxy)):hook.bind(instance.proxy),instance,type)}function createWatcher(raw,ctx,publicThis,key$1){let getter=key$1.includes(`.`)?createPathGetter(publicThis,key$1):()=>publicThis[key$1];if(isString$1(raw)){let handler=ctx[raw];isFunction$1(handler)&&watch(getter,handler)}else if(isFunction$1(raw))watch(getter,raw.bind(publicThis));else if(isObject$3(raw))if(isArray$2(raw))raw.forEach(r$1=>createWatcher(r$1,ctx,publicThis,key$1));else{let handler=isFunction$1(raw.handler)?raw.handler.bind(publicThis):ctx[raw.handler];isFunction$1(handler)&&watch(getter,handler,raw)}}function resolveMergedOptions(instance){let base$1=instance.type,{mixins,extends:extendsOptions}=base$1,{mixins:globalMixins,optionsCache:cache,config:{optionMergeStrategies}}=instance.appContext,cached=cache.get(base$1),resolved;return cached?resolved=cached:!globalMixins.length&&!mixins&&!extendsOptions?resolved=base$1:(resolved={},globalMixins.length&&globalMixins.forEach(m$2=>mergeOptions$1(resolved,m$2,optionMergeStrategies,!0)),mergeOptions$1(resolved,base$1,optionMergeStrategies)),isObject$3(base$1)&&cache.set(base$1,resolved),resolved}function mergeOptions$1(to,from,strats,asMixin=!1){let{mixins,extends:extendsOptions}=from;for(let key$1 in extendsOptions&&mergeOptions$1(to,extendsOptions,strats,!0),mixins&&mixins.forEach(m$2=>mergeOptions$1(to,m$2,strats,!0)),from)if(!(asMixin&&key$1===`expose`)){let strat=internalOptionMergeStrats[key$1]||strats&&strats[key$1];to[key$1]=strat?strat(to[key$1],from[key$1]):from[key$1]}return to}var internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(to,from){return from?to?function(){return extend$1(isFunction$1(to)?to.call(this,this):to,isFunction$1(from)?from.call(this,this):from)}:from:to}function mergeInject(to,from){return mergeObjectOptions(normalizeInject(to),normalizeInject(from))}function normalizeInject(raw){if(isArray$2(raw)){let res={};for(let i$1=0;i$1<raw.length;i$1++)res[raw[i$1]]=raw[i$1];return res}return raw}function mergeAsArray(to,from){return to?[...new Set([].concat(to,from))]:from}function mergeObjectOptions(to,from){return to?extend$1(Object.create(null),to,from):from}function mergeEmitsOrPropsOptions(to,from){return to?isArray$2(to)&&isArray$2(from)?[...new Set([...to,...from])]:extend$1(Object.create(null),normalizePropsOrEmits(to),normalizePropsOrEmits(from??{})):from}function mergeWatchOptions(to,from){if(!to)return from;if(!from)return to;let merged=extend$1(Object.create(null),to);for(let key$1 in from)merged[key$1]=mergeAsArray(to[key$1],from[key$1]);return merged}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}var uid$1$1=0;function createAppAPI(render$1,hydrate){return function(rootComponent,rootProps=null){isFunction$1(rootComponent)||(rootComponent=extend$1({},rootComponent)),rootProps!=null&&!isObject$3(rootProps)&&(rootProps=null);let context$1=createAppContext(),installedPlugins=new WeakSet,pluginCleanupFns=[],isMounted=!1,app$1=context$1.app={_uid:uid$1$1++,_component:rootComponent,_props:rootProps,_container:null,_context:context$1,_instance:null,version,get config(){return context$1.config},set config(v$1){},use(plugin,...options){return installedPlugins.has(plugin)||(plugin&&isFunction$1(plugin.install)?(installedPlugins.add(plugin),plugin.install(app$1,...options)):isFunction$1(plugin)&&(installedPlugins.add(plugin),plugin(app$1,...options))),app$1},mixin(mixin$1){return context$1.mixins.includes(mixin$1)||context$1.mixins.push(mixin$1),app$1},component(name,component){return component?(context$1.components[name]=component,app$1):context$1.components[name]},directive(name,directive){return directive?(context$1.directives[name]=directive,app$1):context$1.directives[name]},mount(rootContainer,isHydrate,namespace){if(!isMounted){let vnode=app$1._ceVNode||createVNode(rootComponent,rootProps);return vnode.appContext=context$1,namespace===!0?namespace=`svg`:namespace===!1&&(namespace=void 0),isHydrate&&hydrate?hydrate(vnode,rootContainer):render$1(vnode,rootContainer,namespace),isMounted=!0,app$1._container=rootContainer,rootContainer.__vue_app__=app$1,getComponentPublicInstance(vnode.component)}},onUnmount(cleanupFn){pluginCleanupFns.push(cleanupFn)},unmount(){isMounted&&(callWithAsyncErrorHandling(pluginCleanupFns,app$1._instance,16),render$1(null,app$1._container),delete app$1._container.__vue_app__)},provide(key$1,value){return context$1.provides[key$1]=value,app$1},runWithContext(fn){let lastApp=currentApp;currentApp=app$1;try{return fn()}finally{currentApp=lastApp}}};return app$1}}var currentApp=null;function provide(key$1,value){if(currentInstance){let provides=currentInstance.provides,parentProvides=currentInstance.parent&&currentInstance.parent.provides;parentProvides===provides&&(provides=currentInstance.provides=Object.create(parentProvides)),provides[key$1]=value}}function inject(key$1,defaultValue$1,treatDefaultAsFactory=!1){let instance=getCurrentInstance();if(instance||currentApp){let provides=currentApp?currentApp._context.provides:instance?instance.parent==null||instance.ce?instance.vnode.appContext&&instance.vnode.appContext.provides:instance.parent.provides:void 0;if(provides&&key$1 in provides)return provides[key$1];if(arguments.length>1)return treatDefaultAsFactory&&isFunction$1(defaultValue$1)?defaultValue$1.call(instance&&instance.proxy):defaultValue$1}}var internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=obj=>Object.getPrototypeOf(obj)===internalObjectProto;function initProps$1(instance,rawProps,isStateful,isSSR=!1){let props={},attrs=createInternalObject();for(let key$1 in instance.propsDefaults=Object.create(null),setFullProps(instance,rawProps,props,attrs),instance.propsOptions[0])key$1 in props||(props[key$1]=void 0);isStateful?instance.props=isSSR?props:shallowReactive(props):instance.type.props?instance.props=props:instance.props=attrs,instance.attrs=attrs}function updateProps$2(instance,rawProps,rawPrevProps,optimized){let{props,attrs,vnode:{patchFlag}}=instance,rawCurrentProps=toRaw(props),[options]=instance.propsOptions,hasAttrsChanged=!1;if((optimized||patchFlag>0)&&!(patchFlag&16)){if(patchFlag&8){let propsToUpdate=instance.vnode.dynamicProps;for(let i$1=0;i$1<propsToUpdate.length;i$1++){let key$1=propsToUpdate[i$1];if(isEmitListener(instance.emitsOptions,key$1))continue;let value=rawProps[key$1];if(options)if(hasOwn$1(attrs,key$1))value!==attrs[key$1]&&(attrs[key$1]=value,hasAttrsChanged=!0);else{let camelizedKey=camelize(key$1);props[camelizedKey]=resolvePropValue(options,rawCurrentProps,camelizedKey,value,instance,!1)}else value!==attrs[key$1]&&(attrs[key$1]=value,hasAttrsChanged=!0)}}}else{setFullProps(instance,rawProps,props,attrs)&&(hasAttrsChanged=!0);let kebabKey;for(let key$1 in rawCurrentProps)(!rawProps||!hasOwn$1(rawProps,key$1)&&((kebabKey=hyphenate(key$1))===key$1||!hasOwn$1(rawProps,kebabKey)))&&(options?rawPrevProps&&(rawPrevProps[key$1]!==void 0||rawPrevProps[kebabKey]!==void 0)&&(props[key$1]=resolvePropValue(options,rawCurrentProps,key$1,void 0,instance,!0)):delete props[key$1]);if(attrs!==rawCurrentProps)for(let key$1 in attrs)(!rawProps||!hasOwn$1(rawProps,key$1))&&(delete attrs[key$1],hasAttrsChanged=!0)}hasAttrsChanged&&trigger$1(instance.attrs,`set`,``)}function setFullProps(instance,rawProps,props,attrs){let[options,needCastKeys]=instance.propsOptions,hasAttrsChanged=!1,rawCastValues;if(rawProps)for(let key$1 in rawProps){if(isReservedProp(key$1))continue;let value=rawProps[key$1],camelKey;options&&hasOwn$1(options,camelKey=camelize(key$1))?!needCastKeys||!needCastKeys.includes(camelKey)?props[camelKey]=value:(rawCastValues||={})[camelKey]=value:isEmitListener(instance.emitsOptions,key$1)||(!(key$1 in attrs)||value!==attrs[key$1])&&(attrs[key$1]=value,hasAttrsChanged=!0)}if(needCastKeys){let rawCurrentProps=toRaw(props),castValues=rawCastValues||EMPTY_OBJ$1;for(let i$1=0;i$1<needCastKeys.length;i$1++){let key$1=needCastKeys[i$1];props[key$1]=resolvePropValue(options,rawCurrentProps,key$1,castValues[key$1],instance,!hasOwn$1(castValues,key$1))}}return hasAttrsChanged}function resolvePropValue(options,props,key$1,value,instance,isAbsent){let opt=options[key$1];if(opt!=null){let hasDefault=hasOwn$1(opt,`default`);if(hasDefault&&value===void 0){let defaultValue$1=opt.default;if(opt.type!==Function&&!opt.skipFactory&&isFunction$1(defaultValue$1)){let{propsDefaults}=instance;if(key$1 in propsDefaults)value=propsDefaults[key$1];else{let reset=setCurrentInstance(instance);value=propsDefaults[key$1]=defaultValue$1.call(null,props),reset()}}else value=defaultValue$1;instance.ce&&instance.ce._setProp(key$1,value)}opt[0]&&(isAbsent&&!hasDefault?value=!1:opt[1]&&(value===``||value===hyphenate(key$1))&&(value=!0))}return value}var mixinPropsCache=new WeakMap;function normalizePropsOptions(comp,appContext,asMixin=!1){let cache=asMixin?mixinPropsCache:appContext.propsCache,cached=cache.get(comp);if(cached)return cached;let raw=comp.props,normalized={},needCastKeys=[],hasExtends=!1;if(!isFunction$1(comp)){let extendProps=raw2=>{hasExtends=!0;let[props,keys$1]=normalizePropsOptions(raw2,appContext,!0);extend$1(normalized,props),keys$1&&needCastKeys.push(...keys$1)};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendProps),comp.extends&&extendProps(comp.extends),comp.mixins&&comp.mixins.forEach(extendProps)}if(!raw&&!hasExtends)return isObject$3(comp)&&cache.set(comp,EMPTY_ARR),EMPTY_ARR;if(isArray$2(raw))for(let i$1=0;i$1<raw.length;i$1++){let normalizedKey=camelize(raw[i$1]);validatePropName(normalizedKey)&&(normalized[normalizedKey]=EMPTY_OBJ$1)}else if(raw)for(let key$1 in raw){let normalizedKey=camelize(key$1);if(validatePropName(normalizedKey)){let opt=raw[key$1],prop=normalized[normalizedKey]=isArray$2(opt)||isFunction$1(opt)?{type:opt}:extend$1({},opt),propType=prop.type,shouldCast=!1,shouldCastTrue=!0;if(isArray$2(propType))for(let index=0;index<propType.length;++index){let type=propType[index],typeName=isFunction$1(type)&&type.name;if(typeName===`Boolean`){shouldCast=!0;break}else typeName===`String`&&(shouldCastTrue=!1)}else shouldCast=isFunction$1(propType)&&propType.name===`Boolean`;prop[0]=shouldCast,prop[1]=shouldCastTrue,(shouldCast||hasOwn$1(prop,`default`))&&needCastKeys.push(normalizedKey)}}let res=[normalized,needCastKeys];return isObject$3(comp)&&cache.set(comp,res),res}function validatePropName(key$1){return key$1[0]!==`$`&&!isReservedProp(key$1)}var isInternalKey=key$1=>key$1===`_`||key$1===`_ctx`||key$1===`$stable`,normalizeSlotValue=value=>isArray$2(value)?value.map(normalizeVNode):[normalizeVNode(value)],normalizeSlot$1=(key$1,rawSlot,ctx)=>{if(rawSlot._n)return rawSlot;let normalized=withCtx((...args)=>normalizeSlotValue(rawSlot(...args)),ctx);return normalized._c=!1,normalized},normalizeObjectSlots=(rawSlots,slots,instance)=>{let ctx=rawSlots._ctx;for(let key$1 in rawSlots){if(isInternalKey(key$1))continue;let value=rawSlots[key$1];if(isFunction$1(value))slots[key$1]=normalizeSlot$1(key$1,value,ctx);else if(value!=null){let normalized=normalizeSlotValue(value);slots[key$1]=()=>normalized}}},normalizeVNodeSlots=(instance,children)=>{let normalized=normalizeSlotValue(children);instance.slots.default=()=>normalized},assignSlots=(slots,children,optimized)=>{for(let key$1 in children)(optimized||!isInternalKey(key$1))&&(slots[key$1]=children[key$1])},initSlots=(instance,children,optimized)=>{let slots=instance.slots=createInternalObject();if(instance.vnode.shapeFlag&32){let type=children._;type?(assignSlots(slots,children,optimized),optimized&&def(slots,`_`,type,!0)):normalizeObjectSlots(children,slots)}else children&&normalizeVNodeSlots(instance,children)},updateSlots=(instance,children,optimized)=>{let{vnode,slots}=instance,needDeletionCheck=!0,deletionComparisonTarget=EMPTY_OBJ$1;if(vnode.shapeFlag&32){let type=children._;type?optimized&&type===1?needDeletionCheck=!1:assignSlots(slots,children,optimized):(needDeletionCheck=!children.$stable,normalizeObjectSlots(children,slots)),deletionComparisonTarget=children}else children&&(normalizeVNodeSlots(instance,children),deletionComparisonTarget={default:1});if(needDeletionCheck)for(let key$1 in slots)!isInternalKey(key$1)&&deletionComparisonTarget[key$1]==null&&delete slots[key$1]},queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(options){return baseCreateRenderer(options)}function baseCreateRenderer(options,createHydrationFns){let target=getGlobalThis();target.__VUE__=!0;let{insert:hostInsert,remove:hostRemove,patchProp:hostPatchProp,createElement:hostCreateElement,createText:hostCreateText,createComment:hostCreateComment,setText:hostSetText,setElementText:hostSetElementText,parentNode:hostParentNode,nextSibling:hostNextSibling,setScopeId:hostSetScopeId=NOOP$1,insertStaticContent:hostInsertStaticContent}=options,patch=(n1,n2,container,anchor=null,parentComponent=null,parentSuspense=null,namespace=void 0,slotScopeIds=null,optimized=!!n2.dynamicChildren)=>{if(n1===n2)return;n1&&!isSameVNodeType(n1,n2)&&(anchor=getNextHostNode(n1),unmount(n1,parentComponent,parentSuspense,!0),n1=null),n2.patchFlag===-2&&(optimized=!1,n2.dynamicChildren=null);let{type,ref:ref$1,shapeFlag}=n2;switch(type){case Text$1:processText(n1,n2,container,anchor);break;case Comment:processCommentNode(n1,n2,container,anchor);break;case Static:n1??mountStaticNode(n2,container,anchor,namespace);break;case Fragment:processFragment(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);break;default:shapeFlag&1?processElement(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):shapeFlag&6?processComponent(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):(shapeFlag&64||shapeFlag&128)&&type.process(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,internals)}ref$1!=null&&parentComponent?setRef(ref$1,n1&&n1.ref,parentSuspense,n2||n1,!n2):ref$1==null&&n1&&n1.ref!=null&&setRef(n1.ref,null,parentSuspense,n1,!0)},processText=(n1,n2,container,anchor)=>{if(n1==null)hostInsert(n2.el=hostCreateText(n2.children),container,anchor);else{let el=n2.el=n1.el;n2.children!==n1.children&&hostSetText(el,n2.children)}},processCommentNode=(n1,n2,container,anchor)=>{n1==null?hostInsert(n2.el=hostCreateComment(n2.children||``),container,anchor):n2.el=n1.el},mountStaticNode=(n2,container,anchor,namespace)=>{[n2.el,n2.anchor]=hostInsertStaticContent(n2.children,container,anchor,namespace,n2.el,n2.anchor)},moveStaticNode=({el,anchor},container,nextSibling)=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostInsert(el,container,nextSibling),el=next;hostInsert(anchor,container,nextSibling)},removeStaticNode=({el,anchor})=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostRemove(el),el=next;hostRemove(anchor)},processElement=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{n2.type===`svg`?namespace=`svg`:n2.type===`math`&&(namespace=`mathml`),n1==null?mountElement(n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):patchElement(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},mountElement=(vnode,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let el,vnodeHook,{props,shapeFlag,transition,dirs}=vnode;if(el=vnode.el=hostCreateElement(vnode.type,namespace,props&&props.is,props),shapeFlag&8?hostSetElementText(el,vnode.children):shapeFlag&16&&mountChildren(vnode.children,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(vnode,namespace),slotScopeIds,optimized),dirs&&invokeDirectiveHook(vnode,null,parentComponent,`created`),setScopeId(el,vnode,vnode.scopeId,slotScopeIds,parentComponent),props){for(let key$1 in props)key$1!==`value`&&!isReservedProp(key$1)&&hostPatchProp(el,key$1,null,props[key$1],namespace,parentComponent);`value`in props&&hostPatchProp(el,`value`,null,props.value,namespace),(vnodeHook=props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode)}dirs&&invokeDirectiveHook(vnode,null,parentComponent,`beforeMount`);let needCallTransitionHooks=needTransition(parentSuspense,transition);needCallTransitionHooks&&transition.beforeEnter(el),hostInsert(el,container,anchor),((vnodeHook=props&&props.onVnodeMounted)||needCallTransitionHooks||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),needCallTransitionHooks&&transition.enter(el),dirs&&invokeDirectiveHook(vnode,null,parentComponent,`mounted`)},parentSuspense)},setScopeId=(el,vnode,scopeId,slotScopeIds,parentComponent)=>{if(scopeId&&hostSetScopeId(el,scopeId),slotScopeIds)for(let i$1=0;i$1<slotScopeIds.length;i$1++)hostSetScopeId(el,slotScopeIds[i$1]);if(parentComponent){let subTree=parentComponent.subTree;if(vnode===subTree||isSuspense(subTree.type)&&(subTree.ssContent===vnode||subTree.ssFallback===vnode)){let parentVNode=parentComponent.vnode;setScopeId(el,parentVNode,parentVNode.scopeId,parentVNode.slotScopeIds,parentComponent.parent)}}},mountChildren=(children,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,start$1=0)=>{for(let i$1=start$1;i$1<children.length;i$1++){let child=children[i$1]=optimized?cloneIfMounted(children[i$1]):normalizeVNode(children[i$1]);patch(null,child,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}},patchElement=(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let el=n2.el=n1.el,{patchFlag,dynamicChildren,dirs}=n2;patchFlag|=n1.patchFlag&16;let oldProps=n1.props||EMPTY_OBJ$1,newProps=n2.props||EMPTY_OBJ$1,vnodeHook;if(parentComponent&&toggleRecurse(parentComponent,!1),(vnodeHook=newProps.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,`beforeUpdate`),parentComponent&&toggleRecurse(parentComponent,!0),(oldProps.innerHTML&&newProps.innerHTML==null||oldProps.textContent&&newProps.textContent==null)&&hostSetElementText(el,``),dynamicChildren?patchBlockChildren(n1.dynamicChildren,dynamicChildren,el,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds):optimized||patchChildren(n1,n2,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds,!1),patchFlag>0){if(patchFlag&16)patchProps(el,oldProps,newProps,parentComponent,namespace);else if(patchFlag&2&&oldProps.class!==newProps.class&&hostPatchProp(el,`class`,null,newProps.class,namespace),patchFlag&4&&hostPatchProp(el,`style`,oldProps.style,newProps.style,namespace),patchFlag&8){let propsToUpdate=n2.dynamicProps;for(let i$1=0;i$1<propsToUpdate.length;i$1++){let key$1=propsToUpdate[i$1],prev=oldProps[key$1],next=newProps[key$1];(next!==prev||key$1===`value`)&&hostPatchProp(el,key$1,prev,next,namespace,parentComponent)}}patchFlag&1&&n1.children!==n2.children&&hostSetElementText(el,n2.children)}else !optimized&&dynamicChildren==null&&patchProps(el,oldProps,newProps,parentComponent,namespace);((vnodeHook=newProps.onVnodeUpdated)||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,`updated`)},parentSuspense)},patchBlockChildren=(oldChildren,newChildren,fallbackContainer,parentComponent,parentSuspense,namespace,slotScopeIds)=>{for(let i$1=0;i$1<newChildren.length;i$1++){let oldVNode=oldChildren[i$1],newVNode=newChildren[i$1],container=oldVNode.el&&(oldVNode.type===Fragment||!isSameVNodeType(oldVNode,newVNode)||oldVNode.shapeFlag&198)?hostParentNode(oldVNode.el):fallbackContainer;patch(oldVNode,newVNode,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,!0)}},patchProps=(el,oldProps,newProps,parentComponent,namespace)=>{if(oldProps!==newProps){if(oldProps!==EMPTY_OBJ$1)for(let key$1 in oldProps)!isReservedProp(key$1)&&!(key$1 in newProps)&&hostPatchProp(el,key$1,oldProps[key$1],null,namespace,parentComponent);for(let key$1 in newProps){if(isReservedProp(key$1))continue;let next=newProps[key$1],prev=oldProps[key$1];next!==prev&&key$1!==`value`&&hostPatchProp(el,key$1,prev,next,namespace,parentComponent)}`value`in newProps&&hostPatchProp(el,`value`,oldProps.value,newProps.value,namespace)}},processFragment=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let fragmentStartAnchor=n2.el=n1?n1.el:hostCreateText(``),fragmentEndAnchor=n2.anchor=n1?n1.anchor:hostCreateText(``),{patchFlag,dynamicChildren,slotScopeIds:fragmentSlotScopeIds}=n2;fragmentSlotScopeIds&&(slotScopeIds=slotScopeIds?slotScopeIds.concat(fragmentSlotScopeIds):fragmentSlotScopeIds),n1==null?(hostInsert(fragmentStartAnchor,container,anchor),hostInsert(fragmentEndAnchor,container,anchor),mountChildren(n2.children||[],container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)):patchFlag>0&&patchFlag&64&&dynamicChildren&&n1.dynamicChildren?(patchBlockChildren(n1.dynamicChildren,dynamicChildren,container,parentComponent,parentSuspense,namespace,slotScopeIds),(n2.key!=null||parentComponent&&n2===parentComponent.subTree)&&traverseStaticChildren(n1,n2,!0)):patchChildren(n1,n2,container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},processComponent=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{n2.slotScopeIds=slotScopeIds,n1==null?n2.shapeFlag&512?parentComponent.ctx.activate(n2,container,anchor,namespace,optimized):mountComponent(n2,container,anchor,parentComponent,parentSuspense,namespace,optimized):updateComponent(n1,n2,optimized)},mountComponent=(initialVNode,container,anchor,parentComponent,parentSuspense,namespace,optimized)=>{let instance=initialVNode.component=createComponentInstance(initialVNode,parentComponent,parentSuspense);if(isKeepAlive(initialVNode)&&(instance.ctx.renderer=internals),setupComponent(instance,!1,optimized),instance.asyncDep){if(parentSuspense&&parentSuspense.registerDep(instance,setupRenderEffect,optimized),!initialVNode.el){let placeholder=instance.subTree=createVNode(Comment);processCommentNode(null,placeholder,container,anchor),initialVNode.placeholder=placeholder.el}}else setupRenderEffect(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)},updateComponent=(n1,n2,optimized)=>{let instance=n2.component=n1.component;if(shouldUpdateComponent(n1,n2,optimized))if(instance.asyncDep&&!instance.asyncResolved){updateComponentPreRender(instance,n2,optimized);return}else instance.next=n2,instance.update();else n2.el=n1.el,instance.vnode=n2},setupRenderEffect=(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)=>{let componentUpdateFn=()=>{if(instance.isMounted){let{next,bu,u:u$1,parent,vnode}=instance;{let nonHydratedAsyncRoot=locateNonHydratedAsyncRoot(instance);if(nonHydratedAsyncRoot){next&&(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)),nonHydratedAsyncRoot.asyncDep.then(()=>{instance.isUnmounted||componentUpdateFn()});return}}let originNext=next,vnodeHook;toggleRecurse(instance,!1),next?(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)):next=vnode,bu&&invokeArrayFns(bu),(vnodeHook=next.props&&next.props.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parent,next,vnode),toggleRecurse(instance,!0);let nextTree=renderComponentRoot(instance),prevTree=instance.subTree;instance.subTree=nextTree,patch(prevTree,nextTree,hostParentNode(prevTree.el),getNextHostNode(prevTree),instance,parentSuspense,namespace),next.el=nextTree.el,originNext===null&&updateHOCHostEl(instance,nextTree.el),u$1&&queuePostRenderEffect(u$1,parentSuspense),(vnodeHook=next.props&&next.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,next,vnode),parentSuspense)}else{let vnodeHook,{el,props}=initialVNode,{bm,m:m$2,parent,root,type}=instance,isAsyncWrapperVNode=isAsyncWrapper(initialVNode);if(toggleRecurse(instance,!1),bm&&invokeArrayFns(bm),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parent,initialVNode),toggleRecurse(instance,!0),el&&hydrateNode){let hydrateSubTree=()=>{instance.subTree=renderComponentRoot(instance),hydrateNode(el,instance.subTree,instance,parentSuspense,null)};isAsyncWrapperVNode&&type.__asyncHydrate?type.__asyncHydrate(el,instance,hydrateSubTree):hydrateSubTree()}else{root.ce&&root.ce._def.shadowRoot!==!1&&root.ce._injectChildStyle(type);let subTree=instance.subTree=renderComponentRoot(instance);patch(null,subTree,container,anchor,instance,parentSuspense,namespace),initialVNode.el=subTree.el}if(m$2&&queuePostRenderEffect(m$2,parentSuspense),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeMounted)){let scopedInitialVNode=initialVNode;queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,scopedInitialVNode),parentSuspense)}(initialVNode.shapeFlag&256||parent&&isAsyncWrapper(parent.vnode)&&parent.vnode.shapeFlag&256)&&instance.a&&queuePostRenderEffect(instance.a,parentSuspense),instance.isMounted=!0,initialVNode=container=anchor=null}};instance.scope.on();let effect$1=instance.effect=new ReactiveEffect(componentUpdateFn);instance.scope.off();let update=instance.update=effect$1.run.bind(effect$1),job=instance.job=effect$1.runIfDirty.bind(effect$1);job.i=instance,job.id=instance.uid,effect$1.scheduler=()=>queueJob(job),toggleRecurse(instance,!0),update()},updateComponentPreRender=(instance,nextVNode,optimized)=>{nextVNode.component=instance;let prevProps=instance.vnode.props;instance.vnode=nextVNode,instance.next=null,updateProps$2(instance,nextVNode.props,prevProps,optimized),updateSlots(instance,nextVNode.children,optimized),pauseTracking(),flushPreFlushCbs(instance),resetTracking()},patchChildren=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized=!1)=>{let c1=n1&&n1.children,prevShapeFlag=n1?n1.shapeFlag:0,c2=n2.children,{patchFlag,shapeFlag}=n2;if(patchFlag>0){if(patchFlag&128){patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);return}else if(patchFlag&256){patchUnkeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);return}}shapeFlag&8?(prevShapeFlag&16&&unmountChildren(c1,parentComponent,parentSuspense),c2!==c1&&hostSetElementText(container,c2)):prevShapeFlag&16?shapeFlag&16?patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):unmountChildren(c1,parentComponent,parentSuspense,!0):(prevShapeFlag&8&&hostSetElementText(container,``),shapeFlag&16&&mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized))},patchUnkeyedChildren=(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{c1||=EMPTY_ARR,c2||=EMPTY_ARR;let oldLength=c1.length,newLength=c2.length,commonLength=Math.min(oldLength,newLength),i$1;for(i$1=0;i$1<commonLength;i$1++){let nextChild=c2[i$1]=optimized?cloneIfMounted(c2[i$1]):normalizeVNode(c2[i$1]);patch(c1[i$1],nextChild,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}oldLength>newLength?unmountChildren(c1,parentComponent,parentSuspense,!0,!1,commonLength):mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,commonLength)},patchKeyedChildren=(c1,c2,container,parentAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let i$1=0,l2=c2.length,e1=c1.length-1,e2=l2-1;for(;i$1<=e1&&i$1<=e2;){let n1=c1[i$1],n2=c2[i$1]=optimized?cloneIfMounted(c2[i$1]):normalizeVNode(c2[i$1]);if(isSameVNodeType(n1,n2))patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);else break;i$1++}for(;i$1<=e1&&i$1<=e2;){let n1=c1[e1],n2=c2[e2]=optimized?cloneIfMounted(c2[e2]):normalizeVNode(c2[e2]);if(isSameVNodeType(n1,n2))patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);else break;e1--,e2--}if(i$1>e1){if(i$1<=e2){let nextPos=e2+1,anchor=nextPos<l2?c2[nextPos].el:parentAnchor;for(;i$1<=e2;)patch(null,c2[i$1]=optimized?cloneIfMounted(c2[i$1]):normalizeVNode(c2[i$1]),container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),i$1++}}else if(i$1>e2)for(;i$1<=e1;)unmount(c1[i$1],parentComponent,parentSuspense,!0),i$1++;else{let s1=i$1,s2=i$1,keyToNewIndexMap=new Map;for(i$1=s2;i$1<=e2;i$1++){let nextChild=c2[i$1]=optimized?cloneIfMounted(c2[i$1]):normalizeVNode(c2[i$1]);nextChild.key!=null&&keyToNewIndexMap.set(nextChild.key,i$1)}let j$1,patched=0,toBePatched=e2-s2+1,moved=!1,maxNewIndexSoFar=0,newIndexToOldIndexMap=Array(toBePatched);for(i$1=0;i$1<toBePatched;i$1++)newIndexToOldIndexMap[i$1]=0;for(i$1=s1;i$1<=e1;i$1++){let prevChild=c1[i$1];if(patched>=toBePatched){unmount(prevChild,parentComponent,parentSuspense,!0);continue}let newIndex;if(prevChild.key!=null)newIndex=keyToNewIndexMap.get(prevChild.key);else for(j$1=s2;j$1<=e2;j$1++)if(newIndexToOldIndexMap[j$1-s2]===0&&isSameVNodeType(prevChild,c2[j$1])){newIndex=j$1;break}newIndex===void 0?unmount(prevChild,parentComponent,parentSuspense,!0):(newIndexToOldIndexMap[newIndex-s2]=i$1+1,newIndex>=maxNewIndexSoFar?maxNewIndexSoFar=newIndex:moved=!0,patch(prevChild,c2[newIndex],container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),patched++)}let increasingNewIndexSequence=moved?getSequence(newIndexToOldIndexMap):EMPTY_ARR;for(j$1=increasingNewIndexSequence.length-1,i$1=toBePatched-1;i$1>=0;i$1--){let nextIndex=s2+i$1,nextChild=c2[nextIndex],anchorVNode=c2[nextIndex+1],anchor=nextIndex+1<l2?anchorVNode.el||anchorVNode.placeholder:parentAnchor;newIndexToOldIndexMap[i$1]===0?patch(null,nextChild,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):moved&&(j$1<0||i$1!==increasingNewIndexSequence[j$1]?move(nextChild,container,anchor,2):j$1--)}}},move=(vnode,container,anchor,moveType,parentSuspense=null)=>{let{el,type,transition,children,shapeFlag}=vnode;if(shapeFlag&6){move(vnode.component.subTree,container,anchor,moveType);return}if(shapeFlag&128){vnode.suspense.move(container,anchor,moveType);return}if(shapeFlag&64){type.move(vnode,container,anchor,internals);return}if(type===Fragment){hostInsert(el,container,anchor);for(let i$1=0;i$1<children.length;i$1++)move(children[i$1],container,anchor,moveType);hostInsert(vnode.anchor,container,anchor);return}if(type===Static){moveStaticNode(vnode,container,anchor);return}if(moveType!==2&&shapeFlag&1&&transition)if(moveType===0)transition.beforeEnter(el),hostInsert(el,container,anchor),queuePostRenderEffect(()=>transition.enter(el),parentSuspense);else{let{leave,delayLeave,afterLeave}=transition,remove2=()=>{vnode.ctx.isUnmounted?hostRemove(el):hostInsert(el,container,anchor)},performLeave=()=>{el._isLeaving&&el[leaveCbKey](!0),leave(el,()=>{remove2(),afterLeave&&afterLeave()})};delayLeave?delayLeave(el,remove2,performLeave):performLeave()}else hostInsert(el,container,anchor)},unmount=(vnode,parentComponent,parentSuspense,doRemove=!1,optimized=!1)=>{let{type,props,ref:ref$1,children,dynamicChildren,shapeFlag,patchFlag,dirs,cacheIndex}=vnode;if(patchFlag===-2&&(optimized=!1),ref$1!=null&&(pauseTracking(),setRef(ref$1,null,parentSuspense,vnode,!0),resetTracking()),cacheIndex!=null&&(parentComponent.renderCache[cacheIndex]=void 0),shapeFlag&256){parentComponent.ctx.deactivate(vnode);return}let shouldInvokeDirs=shapeFlag&1&&dirs,shouldInvokeVnodeHook=!isAsyncWrapper(vnode),vnodeHook;if(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeBeforeUnmount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode),shapeFlag&6)unmountComponent(vnode.component,parentSuspense,doRemove);else{if(shapeFlag&128){vnode.suspense.unmount(parentSuspense,doRemove);return}shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,`beforeUnmount`),shapeFlag&64?vnode.type.remove(vnode,parentComponent,parentSuspense,internals,doRemove):dynamicChildren&&!dynamicChildren.hasOnce&&(type!==Fragment||patchFlag>0&&patchFlag&64)?unmountChildren(dynamicChildren,parentComponent,parentSuspense,!1,!0):(type===Fragment&&patchFlag&384||!optimized&&shapeFlag&16)&&unmountChildren(children,parentComponent,parentSuspense),doRemove&&remove$1(vnode)}(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeUnmounted)||shouldInvokeDirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,`unmounted`)},parentSuspense)},remove$1=vnode=>{let{type,el,anchor,transition}=vnode;if(type===Fragment){removeFragment(el,anchor);return}if(type===Static){removeStaticNode(vnode);return}let performRemove=()=>{hostRemove(el),transition&&!transition.persisted&&transition.afterLeave&&transition.afterLeave()};if(vnode.shapeFlag&1&&transition&&!transition.persisted){let{leave,delayLeave}=transition,performLeave=()=>leave(el,performRemove);delayLeave?delayLeave(vnode.el,performRemove,performLeave):performLeave()}else performRemove()},removeFragment=(cur,end$1)=>{let next;for(;cur!==end$1;)next=hostNextSibling(cur),hostRemove(cur),cur=next;hostRemove(end$1)},unmountComponent=(instance,parentSuspense,doRemove)=>{let{bum,scope,job,subTree,um,m:m$2,a:a$1}=instance;invalidateMount(m$2),invalidateMount(a$1),bum&&invokeArrayFns(bum),scope.stop(),job&&(job.flags|=8,unmount(subTree,instance,parentSuspense,doRemove)),um&&queuePostRenderEffect(um,parentSuspense),queuePostRenderEffect(()=>{instance.isUnmounted=!0},parentSuspense)},unmountChildren=(children,parentComponent,parentSuspense,doRemove=!1,optimized=!1,start$1=0)=>{for(let i$1=start$1;i$1<children.length;i$1++)unmount(children[i$1],parentComponent,parentSuspense,doRemove,optimized)},getNextHostNode=vnode=>{if(vnode.shapeFlag&6)return getNextHostNode(vnode.component.subTree);if(vnode.shapeFlag&128)return vnode.suspense.next();let el=hostNextSibling(vnode.anchor||vnode.el),teleportEnd=el&&el[TeleportEndKey];return teleportEnd?hostNextSibling(teleportEnd):el},isFlushing=!1,render$1=(vnode,container,namespace)=>{vnode==null?container._vnode&&unmount(container._vnode,null,null,!0):patch(container._vnode||null,vnode,container,null,null,null,namespace),container._vnode=vnode,isFlushing||=(isFlushing=!0,flushPreFlushCbs(),flushPostFlushCbs(),!1)},internals={p:patch,um:unmount,m:move,r:remove$1,mt:mountComponent,mc:mountChildren,pc:patchChildren,pbc:patchBlockChildren,n:getNextHostNode,o:options},hydrate,hydrateNode;return createHydrationFns&&([hydrate,hydrateNode]=createHydrationFns(internals)),{render:render$1,hydrate,createApp:createAppAPI(render$1,hydrate)}}function resolveChildrenNamespace({type,props},currentNamespace){return currentNamespace===`svg`&&type===`foreignObject`||currentNamespace===`mathml`&&type===`annotation-xml`&&props&&props.encoding&&props.encoding.includes(`html`)?void 0:currentNamespace}function toggleRecurse({effect:effect$1,job},allowed){allowed?(effect$1.flags|=32,job.flags|=4):(effect$1.flags&=-33,job.flags&=-5)}function needTransition(parentSuspense,transition){return(!parentSuspense||parentSuspense&&!parentSuspense.pendingBranch)&&transition&&!transition.persisted}function traverseStaticChildren(n1,n2,shallow=!1){let ch1=n1.children,ch2=n2.children;if(isArray$2(ch1)&&isArray$2(ch2))for(let i$1=0;i$1<ch1.length;i$1++){let c1=ch1[i$1],c2=ch2[i$1];c2.shapeFlag&1&&!c2.dynamicChildren&&((c2.patchFlag<=0||c2.patchFlag===32)&&(c2=ch2[i$1]=cloneIfMounted(ch2[i$1]),c2.el=c1.el),!shallow&&c2.patchFlag!==-2&&traverseStaticChildren(c1,c2)),c2.type===Text$1&&c2.patchFlag!==-1&&(c2.el=c1.el),c2.type===Comment&&!c2.el&&(c2.el=c1.el)}}function getSequence(arr){let p$2=arr.slice(),result=[0],i$1,j$1,u$1,v$1,c$2,len$1=arr.length;for(i$1=0;i$1<len$1;i$1++){let arrI=arr[i$1];if(arrI!==0){if(j$1=result[result.length-1],arr[j$1]<arrI){p$2[i$1]=j$1,result.push(i$1);continue}for(u$1=0,v$1=result.length-1;u$1<v$1;)c$2=u$1+v$1>>1,arr[result[c$2]]<arrI?u$1=c$2+1:v$1=c$2;arrI<arr[result[u$1]]&&(u$1>0&&(p$2[i$1]=result[u$1-1]),result[u$1]=i$1)}}for(u$1=result.length,v$1=result[u$1-1];u$1-- >0;)result[u$1]=v$1,v$1=p$2[v$1];return result}function locateNonHydratedAsyncRoot(instance){let subComponent=instance.subTree.component;if(subComponent)return subComponent.asyncDep&&!subComponent.asyncResolved?subComponent:locateNonHydratedAsyncRoot(subComponent)}function invalidateMount(hooks){if(hooks)for(let i$1=0;i$1<hooks.length;i$1++)hooks[i$1].flags|=8}var ssrContextKey=Symbol.for(`v-scx`),useSSRContext=()=>inject(ssrContextKey);function watch(source$2,cb,options){return doWatch(source$2,cb,options)}function doWatch(source$2,cb,options=EMPTY_OBJ$1){let{immediate,deep,flush,once}=options,baseWatchOptions=extend$1({},options),runsImmediately=cb&&immediate||!cb&&flush!==`post`,ssrCleanup;if(isInSSRComponentSetup){if(flush===`sync`){let ctx=useSSRContext();ssrCleanup=ctx.__watcherHandles||=[]}else if(!runsImmediately){let watchStopHandle=()=>{};return watchStopHandle.stop=NOOP$1,watchStopHandle.resume=NOOP$1,watchStopHandle.pause=NOOP$1,watchStopHandle}}let instance=currentInstance;baseWatchOptions.call=(fn,type,args)=>callWithAsyncErrorHandling(fn,instance,type,args);let isPre=!1;flush===`post`?baseWatchOptions.scheduler=job=>{queuePostRenderEffect(job,instance&&instance.suspense)}:flush!==`sync`&&(isPre=!0,baseWatchOptions.scheduler=(job,isFirstRun)=>{isFirstRun?job():queueJob(job)}),baseWatchOptions.augmentJob=job=>{cb&&(job.flags|=4),isPre&&(job.flags|=2,instance&&(job.id=instance.uid,job.i=instance))};let watchHandle=watch$1(source$2,cb,baseWatchOptions);return isInSSRComponentSetup&&(ssrCleanup?ssrCleanup.push(watchHandle):runsImmediately&&watchHandle()),watchHandle}function instanceWatch(source$2,value,options){let publicThis=this.proxy,getter=isString$1(source$2)?source$2.includes(`.`)?createPathGetter(publicThis,source$2):()=>publicThis[source$2]:source$2.bind(publicThis,publicThis),cb;isFunction$1(value)?cb=value:(cb=value.handler,options=value);let reset=setCurrentInstance(this),res=doWatch(getter,cb.bind(publicThis),options);return reset(),res}function createPathGetter(ctx,path$1){let segments=path$1.split(`.`);return()=>{let cur=ctx;for(let i$1=0;i$1<segments.length&&cur;i$1++)cur=cur[segments[i$1]];return cur}}var getModelModifiers=(props,modelName)=>modelName===`modelValue`||modelName===`model-value`?props.modelModifiers:props[`${modelName}Modifiers`]||props[`${camelize(modelName)}Modifiers`]||props[`${hyphenate(modelName)}Modifiers`];function emit(instance,event,...rawArgs){if(instance.isUnmounted)return;let props=instance.vnode.props||EMPTY_OBJ$1,args=rawArgs,isModelListener$1=event.startsWith(`update:`),modifiers=isModelListener$1&&getModelModifiers(props,event.slice(7));modifiers&&(modifiers.trim&&(args=rawArgs.map(a$1=>isString$1(a$1)?a$1.trim():a$1)),modifiers.number&&(args=rawArgs.map(looseToNumber)));let handlerName,handler=props[handlerName=toHandlerKey(event)]||props[handlerName=toHandlerKey(camelize(event))];!handler&&isModelListener$1&&(handler=props[handlerName=toHandlerKey(hyphenate(event))]),handler&&callWithAsyncErrorHandling(handler,instance,6,args);let onceHandler=props[handlerName+`Once`];if(onceHandler){if(!instance.emitted)instance.emitted={};else if(instance.emitted[handlerName])return;instance.emitted[handlerName]=!0,callWithAsyncErrorHandling(onceHandler,instance,6,args)}}var mixinEmitsCache=new WeakMap;function normalizeEmitsOptions(comp,appContext,asMixin=!1){let cache=asMixin?mixinEmitsCache:appContext.emitsCache,cached=cache.get(comp);if(cached!==void 0)return cached;let raw=comp.emits,normalized={},hasExtends=!1;if(!isFunction$1(comp)){let extendEmits=raw2=>{let normalizedFromExtend=normalizeEmitsOptions(raw2,appContext,!0);normalizedFromExtend&&(hasExtends=!0,extend$1(normalized,normalizedFromExtend))};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendEmits),comp.extends&&extendEmits(comp.extends),comp.mixins&&comp.mixins.forEach(extendEmits)}return!raw&&!hasExtends?(isObject$3(comp)&&cache.set(comp,null),null):(isArray$2(raw)?raw.forEach(key$1=>normalized[key$1]=null):extend$1(normalized,raw),isObject$3(comp)&&cache.set(comp,normalized),normalized)}function isEmitListener(options,key$1){return!options||!isOn(key$1)?!1:(key$1=key$1.slice(2).replace(/Once$/,``),hasOwn$1(options,key$1[0].toLowerCase()+key$1.slice(1))||hasOwn$1(options,hyphenate(key$1))||hasOwn$1(options,key$1))}function renderComponentRoot(instance){let{type:Component,vnode,proxy,withProxy,propsOptions:[propsOptions],slots,attrs,emit:emit$1,render:render$1,renderCache,props,data,setupState,ctx,inheritAttrs}=instance,prev=setCurrentRenderingInstance(instance),result,fallthroughAttrs;try{if(vnode.shapeFlag&4){let proxyToUse=withProxy||proxy,thisProxy=proxyToUse;result=normalizeVNode(render$1.call(thisProxy,proxyToUse,renderCache,props,setupState,data,ctx)),fallthroughAttrs=attrs}else{let render2=Component;result=normalizeVNode(render2.length>1?render2(props,{attrs,slots,emit:emit$1}):render2(props,null)),fallthroughAttrs=Component.props?attrs:getFunctionalFallthrough(attrs)}}catch(err$1){blockStack.length=0,handleError(err$1,instance,1),result=createVNode(Comment)}let root=result;if(fallthroughAttrs&&inheritAttrs!==!1){let keys$1=Object.keys(fallthroughAttrs),{shapeFlag}=root;keys$1.length&&shapeFlag&7&&(propsOptions&&keys$1.some(isModelListener)&&(fallthroughAttrs=filterModelListeners(fallthroughAttrs,propsOptions)),root=cloneVNode(root,fallthroughAttrs,!1,!0))}return vnode.dirs&&(root=cloneVNode(root,null,!1,!0),root.dirs=root.dirs?root.dirs.concat(vnode.dirs):vnode.dirs),vnode.transition&&setTransitionHooks(root,vnode.transition),result=root,setCurrentRenderingInstance(prev),result}var getFunctionalFallthrough=attrs=>{let res;for(let key$1 in attrs)(key$1===`class`||key$1===`style`||isOn(key$1))&&((res||={})[key$1]=attrs[key$1]);return res},filterModelListeners=(attrs,props)=>{let res={};for(let key$1 in attrs)(!isModelListener(key$1)||!(key$1.slice(9)in props))&&(res[key$1]=attrs[key$1]);return res};function shouldUpdateComponent(prevVNode,nextVNode,optimized){let{props:prevProps,children:prevChildren,component}=prevVNode,{props:nextProps,children:nextChildren,patchFlag}=nextVNode,emits=component.emitsOptions;if(nextVNode.dirs||nextVNode.transition)return!0;if(optimized&&patchFlag>=0){if(patchFlag&1024)return!0;if(patchFlag&16)return prevProps?hasPropsChanged(prevProps,nextProps,emits):!!nextProps;if(patchFlag&8){let dynamicProps=nextVNode.dynamicProps;for(let i$1=0;i$1<dynamicProps.length;i$1++){let key$1=dynamicProps[i$1];if(nextProps[key$1]!==prevProps[key$1]&&!isEmitListener(emits,key$1))return!0}}}else return(prevChildren||nextChildren)&&(!nextChildren||!nextChildren.$stable)?!0:prevProps===nextProps?!1:prevProps?nextProps?hasPropsChanged(prevProps,nextProps,emits):!0:!!nextProps;return!1}function hasPropsChanged(prevProps,nextProps,emitsOptions){let nextKeys=Object.keys(nextProps);if(nextKeys.length!==Object.keys(prevProps).length)return!0;for(let i$1=0;i$1<nextKeys.length;i$1++){let key$1=nextKeys[i$1];if(nextProps[key$1]!==prevProps[key$1]&&!isEmitListener(emitsOptions,key$1))return!0}return!1}function updateHOCHostEl({vnode,parent},el){for(;parent;){let root=parent.subTree;if(root.suspense&&root.suspense.activeBranch===vnode&&(root.el=vnode.el),root===vnode)(vnode=parent.vnode).el=el,parent=parent.parent;else break}}var isSuspense=type=>type.__isSuspense;function queueEffectWithSuspense(fn,suspense){suspense&&suspense.pendingBranch?isArray$2(fn)?suspense.effects.push(...fn):suspense.effects.push(fn):queuePostFlushCb(fn)}var Fragment=Symbol.for(`v-fgt`),Text$1=Symbol.for(`v-txt`),Comment=Symbol.for(`v-cmt`),Static=Symbol.for(`v-stc`),blockStack=[],currentBlock=null;function openBlock(disableTracking=!1){blockStack.push(currentBlock=disableTracking?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}var isBlockTreeEnabled=1;function setBlockTracking(value,inVOnce=!1){isBlockTreeEnabled+=value,value<0&&currentBlock&&inVOnce&&(currentBlock.hasOnce=!0)}function setupBlock(vnode){return vnode.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(vnode),vnode}function createElementBlock(type,props,children,patchFlag,dynamicProps,shapeFlag){return setupBlock(createBaseVNode(type,props,children,patchFlag,dynamicProps,shapeFlag,!0))}function createBlock(type,props,children,patchFlag,dynamicProps){return setupBlock(createVNode(type,props,children,patchFlag,dynamicProps,!0))}function isVNode(value){return value?value.__v_isVNode===!0:!1}function isSameVNodeType(n1,n2){return n1.type===n2.type&&n1.key===n2.key}var normalizeKey=({key:key$1})=>key$1??null,normalizeRef=({ref:ref$1,ref_key,ref_for})=>(typeof ref$1==`number`&&(ref$1=``+ref$1),ref$1==null?null:isString$1(ref$1)||isRef(ref$1)||isFunction$1(ref$1)?{i:currentRenderingInstance,r:ref$1,k:ref_key,f:!!ref_for}:ref$1);function createBaseVNode(type,props=null,children=null,patchFlag=0,dynamicProps=null,shapeFlag=type===Fragment?0:1,isBlockNode=!1,needFullChildrenNormalization=!1){let vnode={__v_isVNode:!0,__v_skip:!0,type,props,key:props&&normalizeKey(props),ref:props&&normalizeRef(props),scopeId:currentScopeId,slotScopeIds:null,children,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag,patchFlag,dynamicProps,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return needFullChildrenNormalization?(normalizeChildren(vnode,children),shapeFlag&128&&type.normalize(vnode)):children&&(vnode.shapeFlag|=isString$1(children)?8:16),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(vnode.patchFlag>0||shapeFlag&6)&&vnode.patchFlag!==32&&currentBlock.push(vnode),vnode}var createVNode=_createVNode;function _createVNode(type,props=null,children=null,patchFlag=0,dynamicProps=null,isBlockNode=!1){if((!type||type===NULL_DYNAMIC_COMPONENT)&&(type=Comment),isVNode(type)){let cloned=cloneVNode(type,props,!0);return children&&normalizeChildren(cloned,children),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(cloned.shapeFlag&6?currentBlock[currentBlock.indexOf(type)]=cloned:currentBlock.push(cloned)),cloned.patchFlag=-2,cloned}if(isClassComponent(type)&&(type=type.__vccOpts),props){props=guardReactiveProps(props);let{class:klass,style}=props;klass&&!isString$1(klass)&&(props.class=normalizeClass(klass)),isObject$3(style)&&(isProxy(style)&&!isArray$2(style)&&(style=extend$1({},style)),props.style=normalizeStyle$1(style))}let shapeFlag=isString$1(type)?1:isSuspense(type)?128:isTeleport(type)?64:isObject$3(type)?4:isFunction$1(type)?2:0;return createBaseVNode(type,props,children,patchFlag,dynamicProps,shapeFlag,isBlockNode,!0)}function guardReactiveProps(props){return props?isProxy(props)||isInternalObject(props)?extend$1({},props):props:null}function cloneVNode(vnode,extraProps,mergeRef=!1,cloneTransition=!1){let{props,ref:ref$1,patchFlag,children,transition}=vnode,mergedProps=extraProps?mergeProps(props||{},extraProps):props,cloned={__v_isVNode:!0,__v_skip:!0,type:vnode.type,props:mergedProps,key:mergedProps&&normalizeKey(mergedProps),ref:extraProps&&extraProps.ref?mergeRef&&ref$1?isArray$2(ref$1)?ref$1.concat(normalizeRef(extraProps)):[ref$1,normalizeRef(extraProps)]:normalizeRef(extraProps):ref$1,scopeId:vnode.scopeId,slotScopeIds:vnode.slotScopeIds,children,target:vnode.target,targetStart:vnode.targetStart,targetAnchor:vnode.targetAnchor,staticCount:vnode.staticCount,shapeFlag:vnode.shapeFlag,patchFlag:extraProps&&vnode.type!==Fragment?patchFlag===-1?16:patchFlag|16:patchFlag,dynamicProps:vnode.dynamicProps,dynamicChildren:vnode.dynamicChildren,appContext:vnode.appContext,dirs:vnode.dirs,transition,component:vnode.component,suspense:vnode.suspense,ssContent:vnode.ssContent&&cloneVNode(vnode.ssContent),ssFallback:vnode.ssFallback&&cloneVNode(vnode.ssFallback),placeholder:vnode.placeholder,el:vnode.el,anchor:vnode.anchor,ctx:vnode.ctx,ce:vnode.ce};return transition&&cloneTransition&&setTransitionHooks(cloned,transition.clone(cloned)),cloned}function createTextVNode(text=` `,flag=0){return createVNode(Text$1,null,text,flag)}function createStaticVNode(content,numberOfNodes){let vnode=createVNode(Static,null,content);return vnode.staticCount=numberOfNodes,vnode}function createCommentVNode(text=``,asBlock=!1){return asBlock?(openBlock(),createBlock(Comment,null,text)):createVNode(Comment,null,text)}function normalizeVNode(child){return child==null||typeof child==`boolean`?createVNode(Comment):isArray$2(child)?createVNode(Fragment,null,child.slice()):isVNode(child)?cloneIfMounted(child):createVNode(Text$1,null,String(child))}function cloneIfMounted(child){return child.el===null&&child.patchFlag!==-1||child.memo?child:cloneVNode(child)}function normalizeChildren(vnode,children){let type=0,{shapeFlag}=vnode;if(children==null)children=null;else if(isArray$2(children))type=16;else if(typeof children==`object`)if(shapeFlag&65){let slot=children.default;slot&&(slot._c&&(slot._d=!1),normalizeChildren(vnode,slot()),slot._c&&(slot._d=!0));return}else{type=32;let slotFlag=children._;!slotFlag&&!isInternalObject(children)?children._ctx=currentRenderingInstance:slotFlag===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?children._=1:(children._=2,vnode.patchFlag|=1024))}else isFunction$1(children)?(children={default:children,_ctx:currentRenderingInstance},type=32):(children=String(children),shapeFlag&64?(type=16,children=[createTextVNode(children)]):type=8);vnode.children=children,vnode.shapeFlag|=type}function mergeProps(...args){let ret={};for(let i$1=0;i$1<args.length;i$1++){let toMerge=args[i$1];for(let key$1 in toMerge)if(key$1===`class`)ret.class!==toMerge.class&&(ret.class=normalizeClass([ret.class,toMerge.class]));else if(key$1===`style`)ret.style=normalizeStyle$1([ret.style,toMerge.style]);else if(isOn(key$1)){let existing=ret[key$1],incoming=toMerge[key$1];incoming&&existing!==incoming&&!(isArray$2(existing)&&existing.includes(incoming))&&(ret[key$1]=existing?[].concat(existing,incoming):incoming)}else key$1!==``&&(ret[key$1]=toMerge[key$1])}return ret}function invokeVNodeHook(hook,instance,vnode,prevVNode=null){callWithAsyncErrorHandling(hook,instance,7,[vnode,prevVNode])}var emptyAppContext=createAppContext(),uid$2=0;function createComponentInstance(vnode,parent,suspense){let type=vnode.type,appContext=(parent?parent.appContext:vnode.appContext)||emptyAppContext,instance={uid:uid$2++,vnode,type,parent,appContext,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:parent?parent.provides:Object.create(appContext.provides),ids:parent?parent.ids:[``,0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(type,appContext),emitsOptions:normalizeEmitsOptions(type,appContext),emit:null,emitted:null,propsDefaults:EMPTY_OBJ$1,inheritAttrs:type.inheritAttrs,ctx:EMPTY_OBJ$1,data:EMPTY_OBJ$1,props:EMPTY_OBJ$1,attrs:EMPTY_OBJ$1,slots:EMPTY_OBJ$1,refs:EMPTY_OBJ$1,setupState:EMPTY_OBJ$1,setupContext:null,suspense,suspenseId:suspense?suspense.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return instance.ctx={_:instance},instance.root=parent?parent.root:instance,instance.emit=emit.bind(null,instance),vnode.ce&&vnode.ce(instance),instance}var currentInstance=null,getCurrentInstance=()=>currentInstance||currentRenderingInstance,internalSetCurrentInstance,setInSSRSetupState;{let g$1=getGlobalThis(),registerGlobalSetter=(key$1,setter)=>{let setters;return(setters=g$1[key$1])||(setters=g$1[key$1]=[]),setters.push(setter),v$1=>{setters.length>1?setters.forEach(set$1=>set$1(v$1)):setters[0](v$1)}};internalSetCurrentInstance=registerGlobalSetter(`__VUE_INSTANCE_SETTERS__`,v$1=>currentInstance=v$1),setInSSRSetupState=registerGlobalSetter(`__VUE_SSR_SETTERS__`,v$1=>isInSSRComponentSetup=v$1)}var setCurrentInstance=instance=>{let prev=currentInstance;return internalSetCurrentInstance(instance),instance.scope.on(),()=>{instance.scope.off(),internalSetCurrentInstance(prev)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(instance){return instance.vnode.shapeFlag&4}var isInSSRComponentSetup=!1;function setupComponent(instance,isSSR=!1,optimized=!1){isSSR&&setInSSRSetupState(isSSR);let{props,children}=instance.vnode,isStateful=isStatefulComponent(instance);initProps$1(instance,props,isStateful,isSSR),initSlots(instance,children,optimized||isSSR);let setupResult=isStateful?setupStatefulComponent(instance,isSSR):void 0;return isSSR&&setInSSRSetupState(!1),setupResult}function setupStatefulComponent(instance,isSSR){let Component=instance.type;instance.accessCache=Object.create(null),instance.proxy=new Proxy(instance.ctx,PublicInstanceProxyHandlers);let{setup}=Component;if(setup){pauseTracking();let setupContext=instance.setupContext=setup.length>1?createSetupContext(instance):null,reset=setCurrentInstance(instance),setupResult=callWithErrorHandling(setup,instance,0,[instance.props,setupContext]),isAsyncSetup=isPromise(setupResult);if(resetTracking(),reset(),(isAsyncSetup||instance.sp)&&!isAsyncWrapper(instance)&&markAsyncBoundary(instance),isAsyncSetup){if(setupResult.then(unsetCurrentInstance,unsetCurrentInstance),isSSR)return setupResult.then(resolvedResult=>{handleSetupResult(instance,resolvedResult,isSSR)}).catch(e$2=>{handleError(e$2,instance,0)});instance.asyncDep=setupResult}else handleSetupResult(instance,setupResult,isSSR)}else finishComponentSetup(instance,isSSR)}function handleSetupResult(instance,setupResult,isSSR){isFunction$1(setupResult)?instance.type.__ssrInlineRender?instance.ssrRender=setupResult:instance.render=setupResult:isObject$3(setupResult)&&(instance.setupState=proxyRefs(setupResult)),finishComponentSetup(instance,isSSR)}var compile,installWithProxy;function finishComponentSetup(instance,isSSR,skipOptions){let Component=instance.type;if(!instance.render){if(!isSSR&&compile&&!Component.render){let template=Component.template||resolveMergedOptions(instance).template;if(template){let{isCustomElement,compilerOptions}=instance.appContext.config,{delimiters,compilerOptions:componentCompilerOptions}=Component,finalCompilerOptions=extend$1(extend$1({isCustomElement,delimiters},compilerOptions),componentCompilerOptions);Component.render=compile(template,finalCompilerOptions)}}instance.render=Component.render||NOOP$1,installWithProxy&&installWithProxy(instance)}{let reset=setCurrentInstance(instance);pauseTracking();try{applyOptions(instance)}finally{resetTracking(),reset()}}}var attrsProxyHandlers={get(target,key$1){return track(target,`get`,``),target[key$1]}};function createSetupContext(instance){return{attrs:new Proxy(instance.attrs,attrsProxyHandlers),slots:instance.slots,emit:instance.emit,expose:exposed=>{instance.exposed=exposed||{}}}}function getComponentPublicInstance(instance){return instance.exposed?instance.exposeProxy||=new Proxy(proxyRefs(markRaw(instance.exposed)),{get(target,key$1){if(key$1 in target)return target[key$1];if(key$1 in publicPropertiesMap)return publicPropertiesMap[key$1](instance)},has(target,key$1){return key$1 in target||key$1 in publicPropertiesMap}}):instance.proxy}function getComponentName(Component,includeInferred=!0){return isFunction$1(Component)?Component.displayName||Component.name:Component.name||includeInferred&&Component.__name}function isClassComponent(value){return isFunction$1(value)&&`__vccOpts`in value}var computed=(getterOrOptions,debugOptions)=>computed$1(getterOrOptions,debugOptions,isInSSRComponentSetup);function h$1(type,propsOrChildren,children){try{setBlockTracking(-1);let l$1=arguments.length;return l$1===2?isObject$3(propsOrChildren)&&!isArray$2(propsOrChildren)?isVNode(propsOrChildren)?createVNode(type,null,[propsOrChildren]):createVNode(type,propsOrChildren):createVNode(type,null,propsOrChildren):(l$1>3?children=Array.prototype.slice.call(arguments,2):l$1===3&&isVNode(children)&&(children=[children]),createVNode(type,propsOrChildren,children))}finally{setBlockTracking(1)}}var version=`3.5.22`,policy=void 0,tt=typeof window<`u`&&window.trustedTypes;if(tt)try{policy=tt.createPolicy(`vue`,{createHTML:val=>val})}catch{}var unsafeToTrustedHTML=policy?val=>policy.createHTML(val):val=>val,svgNS=`http://www.w3.org/2000/svg`,mathmlNS=`http://www.w3.org/1998/Math/MathML`,doc=typeof document<`u`?document:null,templateContainer=doc&&doc.createElement(`template`),nodeOps={insert:(child,parent,anchor)=>{parent.insertBefore(child,anchor||null)},remove:child=>{let parent=child.parentNode;parent&&parent.removeChild(child)},createElement:(tag,namespace,is,props)=>{let el=namespace===`svg`?doc.createElementNS(svgNS,tag):namespace===`mathml`?doc.createElementNS(mathmlNS,tag):is?doc.createElement(tag,{is}):doc.createElement(tag);return tag===`select`&&props&&props.multiple!=null&&el.setAttribute(`multiple`,props.multiple),el},createText:text=>doc.createTextNode(text),createComment:text=>doc.createComment(text),setText:(node,text)=>{node.nodeValue=text},setElementText:(el,text)=>{el.textContent=text},parentNode:node=>node.parentNode,nextSibling:node=>node.nextSibling,querySelector:selector=>doc.querySelector(selector),setScopeId(el,id){el.setAttribute(id,``)},insertStaticContent(content,parent,anchor,namespace,start$1,end$1){let before=anchor?anchor.previousSibling:parent.lastChild;if(start$1&&(start$1===end$1||start$1.nextSibling))for(;parent.insertBefore(start$1.cloneNode(!0),anchor),!(start$1===end$1||!(start$1=start$1.nextSibling)););else{templateContainer.innerHTML=unsafeToTrustedHTML(namespace===`svg`?`<svg>${content}</svg>`:namespace===`mathml`?`<math>${content}</math>`:content);let template=templateContainer.content;if(namespace===`svg`||namespace===`mathml`){let wrapper=template.firstChild;for(;wrapper.firstChild;)template.appendChild(wrapper.firstChild);template.removeChild(wrapper)}parent.insertBefore(template,anchor)}return[before?before.nextSibling:parent.firstChild,anchor?anchor.previousSibling:parent.lastChild]}},vtcKey=Symbol(`_vtc`);function patchClass(el,value,isSVG){let transitionClasses=el[vtcKey];transitionClasses&&(value=(value?[value,...transitionClasses]:[...transitionClasses]).join(` `)),value==null?el.removeAttribute(`class`):isSVG?el.setAttribute(`class`,value):el.className=value}var vShowOriginalDisplay=Symbol(`_vod`),vShowHidden=Symbol(`_vsh`),CSS_VAR_TEXT=Symbol(``),displayRE=/(?:^|;)\s*display\s*:/;function patchStyle(el,prev,next){let style=el.style,isCssString=isString$1(next),hasControlledDisplay=!1;if(next&&!isCssString){if(prev)if(isString$1(prev))for(let prevStyle of prev.split(`;`)){let key$1=prevStyle.slice(0,prevStyle.indexOf(`:`)).trim();next[key$1]??setStyle(style,key$1,``)}else for(let key$1 in prev)next[key$1]??setStyle(style,key$1,``);for(let key$1 in next)key$1===`display`&&(hasControlledDisplay=!0),setStyle(style,key$1,next[key$1])}else if(isCssString){if(prev!==next){let cssVarText=style[CSS_VAR_TEXT];cssVarText&&(next+=`;`+cssVarText),style.cssText=next,hasControlledDisplay=displayRE.test(next)}}else prev&&el.removeAttribute(`style`);vShowOriginalDisplay in el&&(el[vShowOriginalDisplay]=hasControlledDisplay?style.display:``,el[vShowHidden]&&(style.display=`none`))}var importantRE=/\s*!important$/;function setStyle(style,name,val){if(isArray$2(val))val.forEach(v$1=>setStyle(style,name,v$1));else if(val??=``,name.startsWith(`--`))style.setProperty(name,val);else{let prefixed=autoPrefix(style,name);importantRE.test(val)?style.setProperty(hyphenate(prefixed),val.replace(importantRE,``),`important`):style[prefixed]=val}}var prefixes=[`Webkit`,`Moz`,`ms`],prefixCache={};function autoPrefix(style,rawName){let cached=prefixCache[rawName];if(cached)return cached;let name=camelize(rawName);if(name!==`filter`&&name in style)return prefixCache[rawName]=name;name=capitalize(name);for(let i$1=0;i$1<prefixes.length;i$1++){let prefixed=prefixes[i$1]+name;if(prefixed in style)return prefixCache[rawName]=prefixed}return rawName}var xlinkNS=`http://www.w3.org/1999/xlink`;function patchAttr(el,key$1,value,isSVG,instance,isBoolean=isSpecialBooleanAttr(key$1)){isSVG&&key$1.startsWith(`xlink:`)?value==null?el.removeAttributeNS(xlinkNS,key$1.slice(6,key$1.length)):el.setAttributeNS(xlinkNS,key$1,value):value==null||isBoolean&&!includeBooleanAttr(value)?el.removeAttribute(key$1):el.setAttribute(key$1,isBoolean?``:isSymbol(value)?String(value):value)}function patchDOMProp(el,key$1,value,parentComponent,attrName){if(key$1===`innerHTML`||key$1===`textContent`){value!=null&&(el[key$1]=key$1===`innerHTML`?unsafeToTrustedHTML(value):value);return}let tag=el.tagName;if(key$1===`value`&&tag!==`PROGRESS`&&!tag.includes(`-`)){let oldValue=tag===`OPTION`?el.getAttribute(`value`)||``:el.value,newValue=value==null?el.type===`checkbox`?`on`:``:String(value);(oldValue!==newValue||!(`_value`in el))&&(el.value=newValue),value??el.removeAttribute(key$1),el._value=value;return}let needRemove=!1;if(value===``||value==null){let type=typeof el[key$1];type===`boolean`?value=includeBooleanAttr(value):value==null&&type===`string`?(value=``,needRemove=!0):type===`number`&&(value=0,needRemove=!0)}try{el[key$1]=value}catch{}needRemove&&el.removeAttribute(attrName||key$1)}function addEventListener$1(el,event,handler,options){el.addEventListener(event,handler,options)}function removeEventListener$1(el,event,handler,options){el.removeEventListener(event,handler,options)}var veiKey=Symbol(`_vei`);function patchEvent(el,rawName,prevValue,nextValue,instance=null){let invokers=el[veiKey]||(el[veiKey]={}),existingInvoker=invokers[rawName];if(nextValue&&existingInvoker)existingInvoker.value=nextValue;else{let[name,options]=parseName(rawName);if(nextValue){let invoker=invokers[rawName]=createInvoker(nextValue,instance);addEventListener$1(el,name,invoker,options)}else existingInvoker&&(removeEventListener$1(el,name,existingInvoker,options),invokers[rawName]=void 0)}}var optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(name){let options;if(optionsModifierRE.test(name)){options={};let m$2;for(;m$2=name.match(optionsModifierRE);)name=name.slice(0,name.length-m$2[0].length),options[m$2[0].toLowerCase()]=!0}return[name[2]===`:`?name.slice(3):hyphenate(name.slice(2)),options]}var cachedNow=0,p$1=Promise.resolve(),getNow=()=>cachedNow||=(p$1.then(()=>cachedNow=0),Date.now());function createInvoker(initialValue,instance){let invoker=e$2=>{if(!e$2._vts)e$2._vts=Date.now();else if(e$2._vts<=invoker.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(e$2,invoker.value),instance,5,[e$2])};return invoker.value=initialValue,invoker.attached=getNow(),invoker}function patchStopImmediatePropagation(e$2,value){if(isArray$2(value)){let originalStop=e$2.stopImmediatePropagation;return e$2.stopImmediatePropagation=()=>{originalStop.call(e$2),e$2._stopped=!0},value.map(fn=>e2=>!e2._stopped&&fn&&fn(e2))}else return value}var isNativeOn=key$1=>key$1.charCodeAt(0)===111&&key$1.charCodeAt(1)===110&&key$1.charCodeAt(2)>96&&key$1.charCodeAt(2)<123,patchProp=(el,key$1,prevValue,nextValue,namespace,parentComponent)=>{let isSVG=namespace===`svg`;key$1===`class`?patchClass(el,nextValue,isSVG):key$1===`style`?patchStyle(el,prevValue,nextValue):isOn(key$1)?isModelListener(key$1)||patchEvent(el,key$1,prevValue,nextValue,parentComponent):(key$1[0]===`.`?(key$1=key$1.slice(1),!0):key$1[0]===`^`?(key$1=key$1.slice(1),!1):shouldSetAsProp(el,key$1,nextValue,isSVG))?(patchDOMProp(el,key$1,nextValue),!el.tagName.includes(`-`)&&(key$1===`value`||key$1===`checked`||key$1===`selected`)&&patchAttr(el,key$1,nextValue,isSVG,parentComponent,key$1!==`value`)):el._isVueCE&&(/[A-Z]/.test(key$1)||!isString$1(nextValue))?patchDOMProp(el,camelize(key$1),nextValue,parentComponent,key$1):(key$1===`true-value`?el._trueValue=nextValue:key$1===`false-value`&&(el._falseValue=nextValue),patchAttr(el,key$1,nextValue,isSVG))};function shouldSetAsProp(el,key$1,value,isSVG){if(isSVG)return!!(key$1===`innerHTML`||key$1===`textContent`||key$1 in el&&isNativeOn(key$1)&&isFunction$1(value));if(key$1===`spellcheck`||key$1===`draggable`||key$1===`translate`||key$1===`autocorrect`||key$1===`form`||key$1===`list`&&el.tagName===`INPUT`||key$1===`type`&&el.tagName===`TEXTAREA`)return!1;if(key$1===`width`||key$1===`height`){let tag=el.tagName;if(tag===`IMG`||tag===`VIDEO`||tag===`CANVAS`||tag===`SOURCE`)return!1}return isNativeOn(key$1)&&isString$1(value)?!1:key$1 in el}var moveCbKey=Symbol(`_moveCb`),enterCbKey=Symbol(`_enterCb`),getModelAssigner=vnode=>{let fn=vnode.props[`onUpdate:modelValue`]||!1;return isArray$2(fn)?value=>invokeArrayFns(fn,value):fn};function onCompositionStart(e$2){e$2.target.composing=!0}function onCompositionEnd(e$2){let target=e$2.target;target.composing&&(target.composing=!1,target.dispatchEvent(new Event(`input`)))}var assignKey=Symbol(`_assign`),vModelText={created(el,{modifiers:{lazy,trim:trim$1,number:number$1}},vnode){el[assignKey]=getModelAssigner(vnode);let castToNumber=number$1||vnode.props&&vnode.props.type===`number`;addEventListener$1(el,lazy?`change`:`input`,e$2=>{if(e$2.target.composing)return;let domValue=el.value;trim$1&&(domValue=domValue.trim()),castToNumber&&(domValue=looseToNumber(domValue)),el[assignKey](domValue)}),trim$1&&addEventListener$1(el,`change`,()=>{el.value=el.value.trim()}),lazy||(addEventListener$1(el,`compositionstart`,onCompositionStart),addEventListener$1(el,`compositionend`,onCompositionEnd),addEventListener$1(el,`change`,onCompositionEnd))},mounted(el,{value}){el.value=value??``},beforeUpdate(el,{value,oldValue,modifiers:{lazy,trim:trim$1,number:number$1}},vnode){if(el[assignKey]=getModelAssigner(vnode),el.composing)return;let elValue=(number$1||el.type===`number`)&&!/^0\d/.test(el.value)?looseToNumber(el.value):el.value,newValue=value??``;elValue!==newValue&&(document.activeElement===el&&el.type!==`range`&&(lazy&&value===oldValue||trim$1&&el.value.trim()===newValue)||(el.value=newValue))}},vModelSelect={deep:!0,created(el,{value,modifiers:{number:number$1}},vnode){let isSetModel=isSet(value);addEventListener$1(el,`change`,()=>{let selectedVal=Array.prototype.filter.call(el.options,o$1=>o$1.selected).map(o$1=>number$1?looseToNumber(getValue(o$1)):getValue(o$1));el[assignKey](el.multiple?isSetModel?new Set(selectedVal):selectedVal:selectedVal[0]),el._assigning=!0,nextTick(()=>{el._assigning=!1})}),el[assignKey]=getModelAssigner(vnode)},mounted(el,{value}){setSelected(el,value)},beforeUpdate(el,_binding,vnode){el[assignKey]=getModelAssigner(vnode)},updated(el,{value}){el._assigning||setSelected(el,value)}};function setSelected(el,value){let isMultiple=el.multiple,isArrayValue=isArray$2(value);if(!(isMultiple&&!isArrayValue&&!isSet(value))){for(let i$1=0,l$1=el.options.length;i$1<l$1;i$1++){let option=el.options[i$1],optionValue=getValue(option);if(isMultiple)if(isArrayValue){let optionType=typeof optionValue;optionType===`string`||optionType===`number`?option.selected=value.some(v$1=>String(v$1)===String(optionValue)):option.selected=looseIndexOf(value,optionValue)>-1}else option.selected=value.has(optionValue);else if(looseEqual(getValue(option),value)){el.selectedIndex!==i$1&&(el.selectedIndex=i$1);return}}!isMultiple&&el.selectedIndex!==-1&&(el.selectedIndex=-1)}}function getValue(el){return`_value`in el?el._value:el.value}var systemModifiers=[`ctrl`,`shift`,`alt`,`meta`],modifierGuards={stop:e$2=>e$2.stopPropagation(),prevent:e$2=>e$2.preventDefault(),self:e$2=>e$2.target!==e$2.currentTarget,ctrl:e$2=>!e$2.ctrlKey,shift:e$2=>!e$2.shiftKey,alt:e$2=>!e$2.altKey,meta:e$2=>!e$2.metaKey,left:e$2=>`button`in e$2&&e$2.button!==0,middle:e$2=>`button`in e$2&&e$2.button!==1,right:e$2=>`button`in e$2&&e$2.button!==2,exact:(e$2,modifiers)=>systemModifiers.some(m$2=>e$2[`${m$2}Key`]&&!modifiers.includes(m$2))},withModifiers=(fn,modifiers)=>{let cache=fn._withMods||={},cacheKey=modifiers.join(`.`);return cache[cacheKey]||(cache[cacheKey]=((event,...args)=>{for(let i$1=0;i$1<modifiers.length;i$1++){let guard=modifierGuards[modifiers[i$1]];if(guard&&guard(event,modifiers))return}return fn(event,...args)}))},rendererOptions=extend$1({patchProp},nodeOps),renderer;function ensureRenderer(){return renderer||=createRenderer(rendererOptions)}var createApp=((...args)=>{let app$1=ensureRenderer().createApp(...args),{mount}=app$1;return app$1.mount=containerOrSelector=>{let container=normalizeContainer(containerOrSelector);if(!container)return;let component=app$1._component;!isFunction$1(component)&&!component.render&&!component.template&&(component.template=container.innerHTML),container.nodeType===1&&(container.textContent=``);let proxy=mount(container,!1,resolveRootNamespace(container));return container instanceof Element&&(container.removeAttribute(`v-cloak`),container.setAttribute(`data-v-app`,``)),proxy},app$1});function resolveRootNamespace(container){if(container instanceof SVGElement)return`svg`;if(typeof MathMLElement==`function`&&container instanceof MathMLElement)return`mathml`}function normalizeContainer(container){return isString$1(container)?document.querySelector(container):container}var _hoisted_1$6={class:`navbar`},_hoisted_2$6={class:`nav-content`},_hoisted_3$6={class:`nav-links`},NavBar_vue_vue_type_script_setup_true_lang_default=defineComponent({__name:`NavBar`,setup(__props){return(_ctx,_cache)=>{let _component_router_link=resolveComponent(`router-link`);return openBlock(),createElementBlock(`nav`,_hoisted_1$6,[createBaseVNode(`div`,_hoisted_2$6,[createVNode(_component_router_link,{to:`/`,class:`nav-logo`},{default:withCtx(()=>[..._cache[0]||=[createTextVNode(`JS Chart`,-1)]]),_:1}),createBaseVNode(`div`,_hoisted_3$6,[createVNode(_component_router_link,{to:`/canvas`,class:`nav-link`},{default:withCtx(()=>[..._cache[1]||=[createTextVNode(`Canvas2D`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/pixi-graphics`,class:`nav-link`},{default:withCtx(()=>[..._cache[2]||=[createTextVNode(`PixiJS Graphics`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/pixi-mesh`,class:`nav-link`},{default:withCtx(()=>[..._cache[3]||=[createTextVNode(`PixiJS Mesh`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/echarts`,class:`nav-link`},{default:withCtx(()=>[..._cache[4]||=[createTextVNode(`ECharts`,-1)]]),_:1})])])])}}}),__plugin_vue_export_helper_default=(sfc,props)=>{let target=sfc.__vccOpts||sfc;for(let[key$1,val]of props)target[key$1]=val;return target},NavBar_default=__plugin_vue_export_helper_default(NavBar_vue_vue_type_script_setup_true_lang_default,[[`__scopeId`,`data-v-99557579`]]),App_default=defineComponent({__name:`App`,setup(__props){return(_ctx,_cache)=>{let _component_RouterView=resolveComponent(`RouterView`);return openBlock(),createElementBlock(Fragment,null,[createVNode(NavBar_default),createVNode(_component_RouterView)],64)}}}),isBrowser=typeof document<`u`;function isRouteComponent(component){return typeof component==`object`||`displayName`in component||`props`in component||`__vccOpts`in component}function isESModule(obj){return obj.__esModule||obj[Symbol.toStringTag]===`Module`||obj.default&&isRouteComponent(obj.default)}var assign$1=Object.assign;function applyToParams(fn,params){let newParams={};for(let key$1 in params){let value=params[key$1];newParams[key$1]=isArray$1(value)?value.map(fn):fn(value)}return newParams}var noop$1=()=>{},isArray$1=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(text){return encodeURI(``+text).replace(ENC_PIPE_RE,`|`).replace(ENC_BRACKET_OPEN_RE,`[`).replace(ENC_BRACKET_CLOSE_RE,`]`)}function encodeHash(text){return commonEncode(text).replace(ENC_CURLY_OPEN_RE,`{`).replace(ENC_CURLY_CLOSE_RE,`}`).replace(ENC_CARET_RE,`^`)}function encodeQueryValue(text){return commonEncode(text).replace(PLUS_RE,`%2B`).replace(ENC_SPACE_RE,`+`).replace(HASH_RE,`%23`).replace(AMPERSAND_RE,`%26`).replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,`{`).replace(ENC_CURLY_CLOSE_RE,`}`).replace(ENC_CARET_RE,`^`)}function encodeQueryKey(text){return encodeQueryValue(text).replace(EQUAL_RE,`%3D`)}function encodePath(text){return commonEncode(text).replace(HASH_RE,`%23`).replace(IM_RE,`%3F`)}function encodeParam(text){return text==null?``:encodePath(text).replace(SLASH_RE,`%2F`)}function decode(text){try{return decodeURIComponent(``+text)}catch{}return``+text}var TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=path$1=>path$1.replace(TRAILING_SLASH_RE,``);function parseURL(parseQuery$1,location$1,currentLocation=`/`){let path$1,query={},searchString=``,hash=``,hashPos=location$1.indexOf(`#`),searchPos=location$1.indexOf(`?`);return hashPos<searchPos&&hashPos>=0&&(searchPos=-1),searchPos>-1&&(path$1=location$1.slice(0,searchPos),searchString=location$1.slice(searchPos+1,hashPos>-1?hashPos:location$1.length),query=parseQuery$1(searchString)),hashPos>-1&&(path$1||=location$1.slice(0,hashPos),hash=location$1.slice(hashPos,location$1.length)),path$1=resolveRelativePath(path$1??location$1,currentLocation),{fullPath:path$1+(searchString&&`?`)+searchString+hash,path:path$1,query,hash:decode(hash)}}function stringifyURL(stringifyQuery$1,location$1){let query=location$1.query?stringifyQuery$1(location$1.query):``;return location$1.path+(query&&`?`)+query+(location$1.hash||``)}function stripBase(pathname,base$1){return!base$1||!pathname.toLowerCase().startsWith(base$1.toLowerCase())?pathname:pathname.slice(base$1.length)||`/`}function isSameRouteLocation(stringifyQuery$1,a$1,b$1){let aLastIndex=a$1.matched.length-1,bLastIndex=b$1.matched.length-1;return aLastIndex>-1&&aLastIndex===bLastIndex&&isSameRouteRecord(a$1.matched[aLastIndex],b$1.matched[bLastIndex])&&isSameRouteLocationParams(a$1.params,b$1.params)&&stringifyQuery$1(a$1.query)===stringifyQuery$1(b$1.query)&&a$1.hash===b$1.hash}function isSameRouteRecord(a$1,b$1){return(a$1.aliasOf||a$1)===(b$1.aliasOf||b$1)}function isSameRouteLocationParams(a$1,b$1){if(Object.keys(a$1).length!==Object.keys(b$1).length)return!1;for(let key$1 in a$1)if(!isSameRouteLocationParamsValue(a$1[key$1],b$1[key$1]))return!1;return!0}function isSameRouteLocationParamsValue(a$1,b$1){return isArray$1(a$1)?isEquivalentArray(a$1,b$1):isArray$1(b$1)?isEquivalentArray(b$1,a$1):a$1===b$1}function isEquivalentArray(a$1,b$1){return isArray$1(b$1)?a$1.length===b$1.length&&a$1.every((value,i$1)=>value===b$1[i$1]):a$1.length===1&&a$1[0]===b$1}function resolveRelativePath(to,from){if(to.startsWith(`/`))return to;if(!to)return from;let fromSegments=from.split(`/`),toSegments=to.split(`/`),lastToSegment=toSegments[toSegments.length-1];(lastToSegment===`..`||lastToSegment===`.`)&&toSegments.push(``);let position=fromSegments.length-1,toPosition,segment$1;for(toPosition=0;toPosition<toSegments.length;toPosition++)if(segment$1=toSegments[toPosition],segment$1!==`.`)if(segment$1===`..`)position>1&&position--;else break;return fromSegments.slice(0,position).join(`/`)+`/`+toSegments.slice(toPosition).join(`/`)}var START_LOCATION_NORMALIZED={path:`/`,name:void 0,params:{},query:{},hash:``,fullPath:`/`,matched:[],meta:{},redirectedFrom:void 0},NavigationType;(function(NavigationType$1){NavigationType$1.pop=`pop`,NavigationType$1.push=`push`})(NavigationType||={});var NavigationDirection;(function(NavigationDirection$1){NavigationDirection$1.back=`back`,NavigationDirection$1.forward=`forward`,NavigationDirection$1.unknown=``})(NavigationDirection||={});function normalizeBase(base$1){if(!base$1)if(isBrowser){let baseEl=document.querySelector(`base`);base$1=baseEl&&baseEl.getAttribute(`href`)||`/`,base$1=base$1.replace(/^\w+:\/\/[^\/]+/,``)}else base$1=`/`;return base$1[0]!==`/`&&base$1[0]!==`#`&&(base$1=`/`+base$1),removeTrailingSlash(base$1)}var BEFORE_HASH_RE=/^[^#]+#/;function createHref(base$1,location$1){return base$1.replace(BEFORE_HASH_RE,`#`)+location$1}function getElementPosition(el,offset){let docRect=document.documentElement.getBoundingClientRect(),elRect=el.getBoundingClientRect();return{behavior:offset.behavior,left:elRect.left-docRect.left-(offset.left||0),top:elRect.top-docRect.top-(offset.top||0)}}var computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(position){let scrollToOptions;if(`el`in position){let positionEl=position.el,isIdSelector=typeof positionEl==`string`&&positionEl.startsWith(`#`),el=typeof positionEl==`string`?isIdSelector?document.getElementById(positionEl.slice(1)):document.querySelector(positionEl):positionEl;if(!el)return;scrollToOptions=getElementPosition(el,position)}else scrollToOptions=position;`scrollBehavior`in document.documentElement.style?window.scrollTo(scrollToOptions):window.scrollTo(scrollToOptions.left==null?window.scrollX:scrollToOptions.left,scrollToOptions.top==null?window.scrollY:scrollToOptions.top)}function getScrollKey(path$1,delta){return(history.state?history.state.position-delta:-1)+path$1}var scrollPositions=new Map;function saveScrollPosition(key$1,scrollPosition){scrollPositions.set(key$1,scrollPosition)}function getSavedScrollPosition(key$1){let scroll=scrollPositions.get(key$1);return scrollPositions.delete(key$1),scroll}var createBaseLocation=()=>location.protocol+`//`+location.host;function createCurrentLocation(base$1,location$1){let{pathname,search,hash}=location$1,hashPos=base$1.indexOf(`#`);if(hashPos>-1){let slicePos=hash.includes(base$1.slice(hashPos))?base$1.slice(hashPos).length:1,pathFromHash=hash.slice(slicePos);return pathFromHash[0]!==`/`&&(pathFromHash=`/`+pathFromHash),stripBase(pathFromHash,``)}return stripBase(pathname,base$1)+search+hash}function useHistoryListeners(base$1,historyState,currentLocation,replace){let listeners=[],teardowns=[],pauseState=null,popStateHandler=({state})=>{let to=createCurrentLocation(base$1,location),from=currentLocation.value,fromState=historyState.value,delta=0;if(state){if(currentLocation.value=to,historyState.value=state,pauseState&&pauseState===from){pauseState=null;return}delta=fromState?state.position-fromState.position:0}else replace(to);listeners.forEach(listener=>{listener(currentLocation.value,from,{delta,type:NavigationType.pop,direction:delta?delta>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function pauseListeners(){pauseState=currentLocation.value}function listen(callback){listeners.push(callback);let teardown=()=>{let index=listeners.indexOf(callback);index>-1&&listeners.splice(index,1)};return teardowns.push(teardown),teardown}function beforeUnloadListener(){let{history:history$1}=window;history$1.state&&history$1.replaceState(assign$1({},history$1.state,{scroll:computeScrollPosition()}),``)}function destroy(){for(let teardown of teardowns)teardown();teardowns=[],window.removeEventListener(`popstate`,popStateHandler),window.removeEventListener(`beforeunload`,beforeUnloadListener)}return window.addEventListener(`popstate`,popStateHandler),window.addEventListener(`beforeunload`,beforeUnloadListener,{passive:!0}),{pauseListeners,listen,destroy}}function buildState(back,current,forward,replaced=!1,computeScroll=!1){return{back,current,forward,replaced,position:window.history.length,scroll:computeScroll?computeScrollPosition():null}}function useHistoryStateNavigation(base$1){let{history:history$1,location:location$1}=window,currentLocation={value:createCurrentLocation(base$1,location$1)},historyState={value:history$1.state};historyState.value||changeLocation(currentLocation.value,{back:null,current:currentLocation.value,forward:null,position:history$1.length-1,replaced:!0,scroll:null},!0);function changeLocation(to,state,replace$1){let hashIndex=base$1.indexOf(`#`),url=hashIndex>-1?(location$1.host&&document.querySelector(`base`)?base$1:base$1.slice(hashIndex))+to:createBaseLocation()+base$1+to;try{history$1[replace$1?`replaceState`:`pushState`](state,``,url),historyState.value=state}catch(err$1){console.error(err$1),location$1[replace$1?`replace`:`assign`](url)}}function replace(to,data){let state=assign$1({},history$1.state,buildState(historyState.value.back,to,historyState.value.forward,!0),data,{position:historyState.value.position});changeLocation(to,state,!0),currentLocation.value=to}function push(to,data){let currentState=assign$1({},historyState.value,history$1.state,{forward:to,scroll:computeScrollPosition()});changeLocation(currentState.current,currentState,!0);let state=assign$1({},buildState(currentLocation.value,to,null),{position:currentState.position+1},data);changeLocation(to,state,!1),currentLocation.value=to}return{location:currentLocation,state:historyState,push,replace}}function createWebHistory(base$1){base$1=normalizeBase(base$1);let historyNavigation=useHistoryStateNavigation(base$1),historyListeners=useHistoryListeners(base$1,historyNavigation.state,historyNavigation.location,historyNavigation.replace);function go(delta,triggerListeners=!0){triggerListeners||historyListeners.pauseListeners(),history.go(delta)}let routerHistory=assign$1({location:``,base:base$1,go,createHref:createHref.bind(null,base$1)},historyNavigation,historyListeners);return Object.defineProperty(routerHistory,`location`,{enumerable:!0,get:()=>historyNavigation.location.value}),Object.defineProperty(routerHistory,`state`,{enumerable:!0,get:()=>historyNavigation.state.value}),routerHistory}function isRouteLocation(route){return typeof route==`string`||route&&typeof route==`object`}function isRouteName(name){return typeof name==`string`||typeof name==`symbol`}var NavigationFailureSymbol=Symbol(``),NavigationFailureType;(function(NavigationFailureType$1){NavigationFailureType$1[NavigationFailureType$1.aborted=4]=`aborted`,NavigationFailureType$1[NavigationFailureType$1.cancelled=8]=`cancelled`,NavigationFailureType$1[NavigationFailureType$1.duplicated=16]=`duplicated`})(NavigationFailureType||={});function createRouterError(type,params){return assign$1(Error(),{type,[NavigationFailureSymbol]:!0},params)}function isNavigationFailure(error$1,type){return error$1 instanceof Error&&NavigationFailureSymbol in error$1&&(type==null||!!(error$1.type&type))}var BASE_PARAM_PATTERN=`[^/]+?`,BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(segments,extraOptions){let options=assign$1({},BASE_PATH_PARSER_OPTIONS,extraOptions),score=[],pattern=options.start?`^`:``,keys$1=[];for(let segment$1 of segments){let segmentScores=segment$1.length?[]:[90];options.strict&&!segment$1.length&&(pattern+=`/`);for(let tokenIndex=0;tokenIndex<segment$1.length;tokenIndex++){let token=segment$1[tokenIndex],subSegmentScore=40+(options.sensitive?.25:0);if(token.type===0)tokenIndex||(pattern+=`/`),pattern+=token.value.replace(REGEX_CHARS_RE,`\\$&`),subSegmentScore+=40;else if(token.type===1){let{value,repeatable,optional,regexp:regexp$1}=token;keys$1.push({name:value,repeatable,optional});let re$1=regexp$1||BASE_PARAM_PATTERN;if(re$1!==BASE_PARAM_PATTERN){subSegmentScore+=10;try{`${re$1}`}catch(err$1){throw Error(`Invalid custom RegExp for param "${value}" (${re$1}): `+err$1.message)}}let subPattern=repeatable?`((?:${re$1})(?:/(?:${re$1}))*)`:`(${re$1})`;tokenIndex||(subPattern=optional&&segment$1.length<2?`(?:/${subPattern})`:`/`+subPattern),optional&&(subPattern+=`?`),pattern+=subPattern,subSegmentScore+=20,optional&&(subSegmentScore+=-8),repeatable&&(subSegmentScore+=-20),re$1===`.*`&&(subSegmentScore+=-50)}segmentScores.push(subSegmentScore)}score.push(segmentScores)}if(options.strict&&options.end){let i$1=score.length-1;score[i$1][score[i$1].length-1]+=.7000000000000001}options.strict||(pattern+=`/?`),options.end?pattern+=`$`:options.strict&&!pattern.endsWith(`/`)&&(pattern+=`(?:/|$)`);let re=new RegExp(pattern,options.sensitive?``:`i`);function parse$3(path$1){let match=path$1.match(re),params={};if(!match)return null;for(let i$1=1;i$1<match.length;i$1++){let value=match[i$1]||``,key$1=keys$1[i$1-1];params[key$1.name]=value&&key$1.repeatable?value.split(`/`):value}return params}function stringify$1(params){let path$1=``,avoidDuplicatedSlash=!1;for(let segment$1 of segments){(!avoidDuplicatedSlash||!path$1.endsWith(`/`))&&(path$1+=`/`),avoidDuplicatedSlash=!1;for(let token of segment$1)if(token.type===0)path$1+=token.value;else if(token.type===1){let{value,repeatable,optional}=token,param=value in params?params[value]:``;if(isArray$1(param)&&!repeatable)throw Error(`Provided param "${value}" is an array but it is not repeatable (* or + modifiers)`);let text=isArray$1(param)?param.join(`/`):param;if(!text)if(optional)segment$1.length<2&&(path$1.endsWith(`/`)?path$1=path$1.slice(0,-1):avoidDuplicatedSlash=!0);else throw Error(`Missing required param "${value}"`);path$1+=text}}return path$1||`/`}return{re,score,keys:keys$1,parse:parse$3,stringify:stringify$1}}function compareScoreArray(a$1,b$1){let i$1=0;for(;i$1<a$1.length&&i$1<b$1.length;){let diff=b$1[i$1]-a$1[i$1];if(diff)return diff;i$1++}return a$1.length<b$1.length?a$1.length===1&&a$1[0]===80?-1:1:a$1.length>b$1.length?b$1.length===1&&b$1[0]===80?1:-1:0}function comparePathParserScore(a$1,b$1){let i$1=0,aScore=a$1.score,bScore=b$1.score;for(;i$1<aScore.length&&i$1<bScore.length;){let comp=compareScoreArray(aScore[i$1],bScore[i$1]);if(comp)return comp;i$1++}if(Math.abs(bScore.length-aScore.length)===1){if(isLastScoreNegative(aScore))return 1;if(isLastScoreNegative(bScore))return-1}return bScore.length-aScore.length}function isLastScoreNegative(score){let last=score[score.length-1];return score.length>0&&last[last.length-1]<0}var ROOT_TOKEN={type:0,value:``},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(path$1){if(!path$1)return[[]];if(path$1===`/`)return[[ROOT_TOKEN]];if(!path$1.startsWith(`/`))throw Error(`Invalid path "${path$1}"`);function crash(message){throw Error(`ERR (${state})/"${buffer}": ${message}`)}let state=0,previousState=state,tokens$1=[],segment$1;function finalizeSegment(){segment$1&&tokens$1.push(segment$1),segment$1=[]}let i$1=0,char,buffer=``,customRe=``;function consumeBuffer(){buffer&&=(state===0?segment$1.push({type:0,value:buffer}):state===1||state===2||state===3?(segment$1.length>1&&(char===`*`||char===`+`)&&crash(`A repeatable param (${buffer}) must be alone in its segment. eg: '/:ids+.`),segment$1.push({type:1,value:buffer,regexp:customRe,repeatable:char===`*`||char===`+`,optional:char===`*`||char===`?`})):crash(`Invalid state to consume buffer`),``)}function addCharToBuffer(){buffer+=char}for(;i$1<path$1.length;){if(char=path$1[i$1++],char===`\\`&&state!==2){previousState=state,state=4;continue}switch(state){case 0:char===`/`?(buffer&&consumeBuffer(),finalizeSegment()):char===`:`?(consumeBuffer(),state=1):addCharToBuffer();break;case 4:addCharToBuffer(),state=previousState;break;case 1:char===`(`?state=2:VALID_PARAM_RE.test(char)?addCharToBuffer():(consumeBuffer(),state=0,char!==`*`&&char!==`?`&&char!==`+`&&i$1--);break;case 2:char===`)`?customRe[customRe.length-1]==`\\`?customRe=customRe.slice(0,-1)+char:state=3:customRe+=char;break;case 3:consumeBuffer(),state=0,char!==`*`&&char!==`?`&&char!==`+`&&i$1--,customRe=``;break;default:crash(`Unknown state`);break}}return state===2&&crash(`Unfinished custom RegExp for param "${buffer}"`),consumeBuffer(),finalizeSegment(),tokens$1}function createRouteRecordMatcher(record,parent,options){let parser=tokensToParser(tokenizePath(record.path),options),matcher=assign$1(parser,{record,parent,children:[],alias:[]});return parent&&!matcher.record.aliasOf==!parent.record.aliasOf&&parent.children.push(matcher),matcher}function createRouterMatcher(routes,globalOptions){let matchers=[],matcherMap=new Map;globalOptions=mergeOptions({strict:!1,end:!0,sensitive:!1},globalOptions);function getRecordMatcher(name){return matcherMap.get(name)}function addRoute(record,parent,originalRecord){let isRootAdd=!originalRecord,mainNormalizedRecord=normalizeRouteRecord(record);mainNormalizedRecord.aliasOf=originalRecord&&originalRecord.record;let options=mergeOptions(globalOptions,record),normalizedRecords=[mainNormalizedRecord];if(`alias`in record){let aliases=typeof record.alias==`string`?[record.alias]:record.alias;for(let alias of aliases)normalizedRecords.push(normalizeRouteRecord(assign$1({},mainNormalizedRecord,{components:originalRecord?originalRecord.record.components:mainNormalizedRecord.components,path:alias,aliasOf:originalRecord?originalRecord.record:mainNormalizedRecord})))}let matcher,originalMatcher;for(let normalizedRecord of normalizedRecords){let{path:path$1}=normalizedRecord;if(parent&&path$1[0]!==`/`){let parentPath=parent.record.path,connectingSlash=parentPath[parentPath.length-1]===`/`?``:`/`;normalizedRecord.path=parent.record.path+(path$1&&connectingSlash+path$1)}if(matcher=createRouteRecordMatcher(normalizedRecord,parent,options),originalRecord?originalRecord.alias.push(matcher):(originalMatcher||=matcher,originalMatcher!==matcher&&originalMatcher.alias.push(matcher),isRootAdd&&record.name&&!isAliasRecord(matcher)&&removeRoute(record.name)),isMatchable(matcher)&&insertMatcher(matcher),mainNormalizedRecord.children){let children=mainNormalizedRecord.children;for(let i$1=0;i$1<children.length;i$1++)addRoute(children[i$1],matcher,originalRecord&&originalRecord.children[i$1])}originalRecord||=matcher}return originalMatcher?()=>{removeRoute(originalMatcher)}:noop$1}function removeRoute(matcherRef){if(isRouteName(matcherRef)){let matcher=matcherMap.get(matcherRef);matcher&&(matcherMap.delete(matcherRef),matchers.splice(matchers.indexOf(matcher),1),matcher.children.forEach(removeRoute),matcher.alias.forEach(removeRoute))}else{let index=matchers.indexOf(matcherRef);index>-1&&(matchers.splice(index,1),matcherRef.record.name&&matcherMap.delete(matcherRef.record.name),matcherRef.children.forEach(removeRoute),matcherRef.alias.forEach(removeRoute))}}function getRoutes(){return matchers}function insertMatcher(matcher){let index=findInsertionIndex(matcher,matchers);matchers.splice(index,0,matcher),matcher.record.name&&!isAliasRecord(matcher)&&matcherMap.set(matcher.record.name,matcher)}function resolve$1(location$1,currentLocation){let matcher,params={},path$1,name;if(`name`in location$1&&location$1.name){if(matcher=matcherMap.get(location$1.name),!matcher)throw createRouterError(1,{location:location$1});name=matcher.record.name,params=assign$1(paramsFromLocation(currentLocation.params,matcher.keys.filter(k$1=>!k$1.optional).concat(matcher.parent?matcher.parent.keys.filter(k$1=>k$1.optional):[]).map(k$1=>k$1.name)),location$1.params&&paramsFromLocation(location$1.params,matcher.keys.map(k$1=>k$1.name))),path$1=matcher.stringify(params)}else if(location$1.path!=null)path$1=location$1.path,matcher=matchers.find(m$2=>m$2.re.test(path$1)),matcher&&(params=matcher.parse(path$1),name=matcher.record.name);else{if(matcher=currentLocation.name?matcherMap.get(currentLocation.name):matchers.find(m$2=>m$2.re.test(currentLocation.path)),!matcher)throw createRouterError(1,{location:location$1,currentLocation});name=matcher.record.name,params=assign$1({},currentLocation.params,location$1.params),path$1=matcher.stringify(params)}let matched=[],parentMatcher=matcher;for(;parentMatcher;)matched.unshift(parentMatcher.record),parentMatcher=parentMatcher.parent;return{name,path:path$1,params,matched,meta:mergeMetaFields(matched)}}routes.forEach(route=>addRoute(route));function clearRoutes(){matchers.length=0,matcherMap.clear()}return{addRoute,resolve:resolve$1,removeRoute,clearRoutes,getRoutes,getRecordMatcher}}function paramsFromLocation(params,keys$1){let newParams={};for(let key$1 of keys$1)key$1 in params&&(newParams[key$1]=params[key$1]);return newParams}function normalizeRouteRecord(record){let normalized={path:record.path,redirect:record.redirect,name:record.name,meta:record.meta||{},aliasOf:record.aliasOf,beforeEnter:record.beforeEnter,props:normalizeRecordProps(record),children:record.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:`components`in record?record.components||null:record.component&&{default:record.component}};return Object.defineProperty(normalized,`mods`,{value:{}}),normalized}function normalizeRecordProps(record){let propsObject={},props=record.props||!1;if(`component`in record)propsObject.default=props;else for(let name in record.components)propsObject[name]=typeof props==`object`?props[name]:props;return propsObject}function isAliasRecord(record){for(;record;){if(record.record.aliasOf)return!0;record=record.parent}return!1}function mergeMetaFields(matched){return matched.reduce((meta,record)=>assign$1(meta,record.meta),{})}function mergeOptions(defaults$1,partialOptions){let options={};for(let key$1 in defaults$1)options[key$1]=key$1 in partialOptions?partialOptions[key$1]:defaults$1[key$1];return options}function findInsertionIndex(matcher,matchers){let lower=0,upper=matchers.length;for(;lower!==upper;){let mid=lower+upper>>1;comparePathParserScore(matcher,matchers[mid])<0?upper=mid:lower=mid+1}let insertionAncestor=getInsertionAncestor(matcher);return insertionAncestor&&(upper=matchers.lastIndexOf(insertionAncestor,upper-1)),upper}function getInsertionAncestor(matcher){let ancestor=matcher;for(;ancestor=ancestor.parent;)if(isMatchable(ancestor)&&comparePathParserScore(matcher,ancestor)===0)return ancestor}function isMatchable({record}){return!!(record.name||record.components&&Object.keys(record.components).length||record.redirect)}function parseQuery(search){let query={};if(search===``||search===`?`)return query;let searchParams=(search[0]===`?`?search.slice(1):search).split(`&`);for(let i$1=0;i$1<searchParams.length;++i$1){let searchParam=searchParams[i$1].replace(PLUS_RE,` `),eqPos=searchParam.indexOf(`=`),key$1=decode(eqPos<0?searchParam:searchParam.slice(0,eqPos)),value=eqPos<0?null:decode(searchParam.slice(eqPos+1));if(key$1 in query){let currentValue=query[key$1];isArray$1(currentValue)||(currentValue=query[key$1]=[currentValue]),currentValue.push(value)}else query[key$1]=value}return query}function stringifyQuery(query){let search=``;for(let key$1 in query){let value=query[key$1];if(key$1=encodeQueryKey(key$1),value==null){value!==void 0&&(search+=(search.length?`&`:``)+key$1);continue}(isArray$1(value)?value.map(v$1=>v$1&&encodeQueryValue(v$1)):[value&&encodeQueryValue(value)]).forEach(value$1=>{value$1!==void 0&&(search+=(search.length?`&`:``)+key$1,value$1!=null&&(search+=`=`+value$1))})}return search}function normalizeQuery(query){let normalizedQuery={};for(let key$1 in query){let value=query[key$1];value!==void 0&&(normalizedQuery[key$1]=isArray$1(value)?value.map(v$1=>v$1==null?null:``+v$1):value==null?value:``+value)}return normalizedQuery}var matchedRouteKey=Symbol(``),viewDepthKey=Symbol(``),routerKey=Symbol(``),routeLocationKey=Symbol(``),routerViewLocationKey=Symbol(``);function useCallbacks(){let handlers=[];function add$1(handler){return handlers.push(handler),()=>{let i$1=handlers.indexOf(handler);i$1>-1&&handlers.splice(i$1,1)}}function reset(){handlers=[]}return{add:add$1,list:()=>handlers.slice(),reset}}function guardToPromiseFn(guard,to,from,record,name,runWithContext=fn=>fn()){let enterCallbackArray=record&&(record.enterCallbacks[name]=record.enterCallbacks[name]||[]);return()=>new Promise((resolve$1,reject)=>{let next=valid=>{valid===!1?reject(createRouterError(4,{from,to})):valid instanceof Error?reject(valid):isRouteLocation(valid)?reject(createRouterError(2,{from:to,to:valid})):(enterCallbackArray&&record.enterCallbacks[name]===enterCallbackArray&&typeof valid==`function`&&enterCallbackArray.push(valid),resolve$1())},guardReturn=runWithContext(()=>guard.call(record&&record.instances[name],to,from,next)),guardCall=Promise.resolve(guardReturn);guard.length<3&&(guardCall=guardCall.then(next)),guardCall.catch(err$1=>reject(err$1))})}function extractComponentsGuards(matched,guardType,to,from,runWithContext=fn=>fn()){let guards=[];for(let record of matched)for(let name in record.components){let rawComponent=record.components[name];if(!(guardType!==`beforeRouteEnter`&&!record.instances[name]))if(isRouteComponent(rawComponent)){let guard=(rawComponent.__vccOpts||rawComponent)[guardType];guard&&guards.push(guardToPromiseFn(guard,to,from,record,name,runWithContext))}else{let componentPromise=rawComponent();guards.push(()=>componentPromise.then(resolved=>{if(!resolved)throw Error(`Couldn't resolve component "${name}" at "${record.path}"`);let resolvedComponent=isESModule(resolved)?resolved.default:resolved;record.mods[name]=resolved,record.components[name]=resolvedComponent;let guard=(resolvedComponent.__vccOpts||resolvedComponent)[guardType];return guard&&guardToPromiseFn(guard,to,from,record,name,runWithContext)()}))}}return guards}function useLink(props){let router$1=inject(routerKey),currentRoute=inject(routeLocationKey),route=computed(()=>{let to=unref(props.to);return router$1.resolve(to)}),activeRecordIndex=computed(()=>{let{matched}=route.value,{length:length$1}=matched,routeMatched=matched[length$1-1],currentMatched=currentRoute.matched;if(!routeMatched||!currentMatched.length)return-1;let index=currentMatched.findIndex(isSameRouteRecord.bind(null,routeMatched));if(index>-1)return index;let parentRecordPath=getOriginalPath(matched[length$1-2]);return length$1>1&&getOriginalPath(routeMatched)===parentRecordPath&&currentMatched[currentMatched.length-1].path!==parentRecordPath?currentMatched.findIndex(isSameRouteRecord.bind(null,matched[length$1-2])):index}),isActive=computed(()=>activeRecordIndex.value>-1&&includesParams(currentRoute.params,route.value.params)),isExactActive=computed(()=>activeRecordIndex.value>-1&&activeRecordIndex.value===currentRoute.matched.length-1&&isSameRouteLocationParams(currentRoute.params,route.value.params));function navigate(e$2={}){if(guardEvent(e$2)){let p$2=router$1[unref(props.replace)?`replace`:`push`](unref(props.to)).catch(noop$1);return props.viewTransition&&typeof document<`u`&&`startViewTransition`in document&&document.startViewTransition(()=>p$2),p$2}return Promise.resolve()}return{route,href:computed(()=>route.value.href),isActive,isExactActive,navigate}}function preferSingleVNode(vnodes){return vnodes.length===1?vnodes[0]:vnodes}var RouterLink=defineComponent({name:`RouterLink`,compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:`page`},viewTransition:Boolean},useLink,setup(props,{slots}){let link=reactive(useLink(props)),{options}=inject(routerKey),elClass=computed(()=>({[getLinkClass(props.activeClass,options.linkActiveClass,`router-link-active`)]:link.isActive,[getLinkClass(props.exactActiveClass,options.linkExactActiveClass,`router-link-exact-active`)]:link.isExactActive}));return()=>{let children=slots.default&&preferSingleVNode(slots.default(link));return props.custom?children:h$1(`a`,{"aria-current":link.isExactActive?props.ariaCurrentValue:null,href:link.href,onClick:link.navigate,class:elClass.value},children)}}});function guardEvent(e$2){if(!(e$2.metaKey||e$2.altKey||e$2.ctrlKey||e$2.shiftKey)&&!e$2.defaultPrevented&&!(e$2.button!==void 0&&e$2.button!==0)){if(e$2.currentTarget&&e$2.currentTarget.getAttribute){let target=e$2.currentTarget.getAttribute(`target`);if(/\b_blank\b/i.test(target))return}return e$2.preventDefault&&e$2.preventDefault(),!0}}function includesParams(outer,inner$11){for(let key$1 in inner$11){let innerValue=inner$11[key$1],outerValue=outer[key$1];if(typeof innerValue==`string`){if(innerValue!==outerValue)return!1}else if(!isArray$1(outerValue)||outerValue.length!==innerValue.length||innerValue.some((value,i$1)=>value!==outerValue[i$1]))return!1}return!0}function getOriginalPath(record){return record?record.aliasOf?record.aliasOf.path:record.path:``}var getLinkClass=(propClass,globalClass,defaultClass)=>propClass??globalClass??defaultClass,RouterViewImpl=defineComponent({name:`RouterView`,inheritAttrs:!1,props:{name:{type:String,default:`default`},route:Object},compatConfig:{MODE:3},setup(props,{attrs,slots}){let injectedRoute=inject(routerViewLocationKey),routeToDisplay=computed(()=>props.route||injectedRoute.value),injectedDepth=inject(viewDepthKey,0),depth=computed(()=>{let initialDepth=unref(injectedDepth),{matched}=routeToDisplay.value,matchedRoute;for(;(matchedRoute=matched[initialDepth])&&!matchedRoute.components;)initialDepth++;return initialDepth}),matchedRouteRef=computed(()=>routeToDisplay.value.matched[depth.value]);provide(viewDepthKey,computed(()=>depth.value+1)),provide(matchedRouteKey,matchedRouteRef),provide(routerViewLocationKey,routeToDisplay);let viewRef=ref();return watch(()=>[viewRef.value,matchedRouteRef.value,props.name],([instance,to,name],[oldInstance,from,oldName])=>{to&&(to.instances[name]=instance,from&&from!==to&&instance&&instance===oldInstance&&(to.leaveGuards.size||(to.leaveGuards=from.leaveGuards),to.updateGuards.size||(to.updateGuards=from.updateGuards))),instance&&to&&(!from||!isSameRouteRecord(to,from)||!oldInstance)&&(to.enterCallbacks[name]||[]).forEach(callback=>callback(instance))},{flush:`post`}),()=>{let route=routeToDisplay.value,currentName=props.name,matchedRoute=matchedRouteRef.value,ViewComponent=matchedRoute&&matchedRoute.components[currentName];if(!ViewComponent)return normalizeSlot(slots.default,{Component:ViewComponent,route});let routePropsOption=matchedRoute.props[currentName],routeProps=routePropsOption?routePropsOption===!0?route.params:typeof routePropsOption==`function`?routePropsOption(route):routePropsOption:null,component=h$1(ViewComponent,assign$1({},routeProps,attrs,{onVnodeUnmounted:vnode=>{vnode.component.isUnmounted&&(matchedRoute.instances[currentName]=null)},ref:viewRef}));return normalizeSlot(slots.default,{Component:component,route})||component}}});function normalizeSlot(slot,data){if(!slot)return null;let slotContent=slot(data);return slotContent.length===1?slotContent[0]:slotContent}var RouterView=RouterViewImpl;function createRouter(options){let matcher=createRouterMatcher(options.routes,options),parseQuery$1=options.parseQuery||parseQuery,stringifyQuery$1=options.stringifyQuery||stringifyQuery,routerHistory=options.history,beforeGuards=useCallbacks(),beforeResolveGuards=useCallbacks(),afterGuards=useCallbacks(),currentRoute=shallowRef(START_LOCATION_NORMALIZED),pendingLocation=START_LOCATION_NORMALIZED;isBrowser&&options.scrollBehavior&&`scrollRestoration`in history&&(history.scrollRestoration=`manual`);let normalizeParams=applyToParams.bind(null,paramValue=>``+paramValue),encodeParams=applyToParams.bind(null,encodeParam),decodeParams=applyToParams.bind(null,decode);function addRoute(parentOrRoute,route){let parent,record;return isRouteName(parentOrRoute)?(parent=matcher.getRecordMatcher(parentOrRoute),record=route):record=parentOrRoute,matcher.addRoute(record,parent)}function removeRoute(name){let recordMatcher=matcher.getRecordMatcher(name);recordMatcher&&matcher.removeRoute(recordMatcher)}function getRoutes(){return matcher.getRoutes().map(routeMatcher=>routeMatcher.record)}function hasRoute(name){return!!matcher.getRecordMatcher(name)}function resolve$1(rawLocation,currentLocation){if(currentLocation=assign$1({},currentLocation||currentRoute.value),typeof rawLocation==`string`){let locationNormalized=parseURL(parseQuery$1,rawLocation,currentLocation.path),matchedRoute$1=matcher.resolve({path:locationNormalized.path},currentLocation),href$1=routerHistory.createHref(locationNormalized.fullPath);return assign$1(locationNormalized,matchedRoute$1,{params:decodeParams(matchedRoute$1.params),hash:decode(locationNormalized.hash),redirectedFrom:void 0,href:href$1})}let matcherLocation;if(rawLocation.path!=null)matcherLocation=assign$1({},rawLocation,{path:parseURL(parseQuery$1,rawLocation.path,currentLocation.path).path});else{let targetParams=assign$1({},rawLocation.params);for(let key$1 in targetParams)targetParams[key$1]??delete targetParams[key$1];matcherLocation=assign$1({},rawLocation,{params:encodeParams(targetParams)}),currentLocation.params=encodeParams(currentLocation.params)}let matchedRoute=matcher.resolve(matcherLocation,currentLocation),hash=rawLocation.hash||``;matchedRoute.params=normalizeParams(decodeParams(matchedRoute.params));let fullPath=stringifyURL(stringifyQuery$1,assign$1({},rawLocation,{hash:encodeHash(hash),path:matchedRoute.path})),href=routerHistory.createHref(fullPath);return assign$1({fullPath,hash,query:stringifyQuery$1===stringifyQuery?normalizeQuery(rawLocation.query):rawLocation.query||{}},matchedRoute,{redirectedFrom:void 0,href})}function locationAsObject(to){return typeof to==`string`?parseURL(parseQuery$1,to,currentRoute.value.path):assign$1({},to)}function checkCanceledNavigation(to,from){if(pendingLocation!==to)return createRouterError(8,{from,to})}function push(to){return pushWithRedirect(to)}function replace(to){return push(assign$1(locationAsObject(to),{replace:!0}))}function handleRedirectRecord(to){let lastMatched=to.matched[to.matched.length-1];if(lastMatched&&lastMatched.redirect){let{redirect}=lastMatched,newTargetLocation=typeof redirect==`function`?redirect(to):redirect;return typeof newTargetLocation==`string`&&(newTargetLocation=newTargetLocation.includes(`?`)||newTargetLocation.includes(`#`)?newTargetLocation=locationAsObject(newTargetLocation):{path:newTargetLocation},newTargetLocation.params={}),assign$1({query:to.query,hash:to.hash,params:newTargetLocation.path==null?to.params:{}},newTargetLocation)}}function pushWithRedirect(to,redirectedFrom){let targetLocation=pendingLocation=resolve$1(to),from=currentRoute.value,data=to.state,force=to.force,replace$1=to.replace===!0,shouldRedirect=handleRedirectRecord(targetLocation);if(shouldRedirect)return pushWithRedirect(assign$1(locationAsObject(shouldRedirect),{state:typeof shouldRedirect==`object`?assign$1({},data,shouldRedirect.state):data,force,replace:replace$1}),redirectedFrom||targetLocation);let toLocation=targetLocation;toLocation.redirectedFrom=redirectedFrom;let failure;return!force&&isSameRouteLocation(stringifyQuery$1,from,targetLocation)&&(failure=createRouterError(16,{to:toLocation,from}),handleScroll(from,from,!0,!1)),(failure?Promise.resolve(failure):navigate(toLocation,from)).catch(error$1=>isNavigationFailure(error$1)?isNavigationFailure(error$1,2)?error$1:markAsReady(error$1):triggerError(error$1,toLocation,from)).then(failure$1=>{if(failure$1){if(isNavigationFailure(failure$1,2))return pushWithRedirect(assign$1({replace:replace$1},locationAsObject(failure$1.to),{state:typeof failure$1.to==`object`?assign$1({},data,failure$1.to.state):data,force}),redirectedFrom||toLocation)}else failure$1=finalizeNavigation(toLocation,from,!0,replace$1,data);return triggerAfterEach(toLocation,from,failure$1),failure$1})}function checkCanceledNavigationAndReject(to,from){let error$1=checkCanceledNavigation(to,from);return error$1?Promise.reject(error$1):Promise.resolve()}function runWithContext(fn){let app$1=installedApps.values().next().value;return app$1&&typeof app$1.runWithContext==`function`?app$1.runWithContext(fn):fn()}function navigate(to,from){let guards,[leavingRecords,updatingRecords,enteringRecords]=extractChangingRecords(to,from);guards=extractComponentsGuards(leavingRecords.reverse(),`beforeRouteLeave`,to,from);for(let record of leavingRecords)record.leaveGuards.forEach(guard=>{guards.push(guardToPromiseFn(guard,to,from))});let canceledNavigationCheck=checkCanceledNavigationAndReject.bind(null,to,from);return guards.push(canceledNavigationCheck),runGuardQueue(guards).then(()=>{guards=[];for(let guard of beforeGuards.list())guards.push(guardToPromiseFn(guard,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>{guards=extractComponentsGuards(updatingRecords,`beforeRouteUpdate`,to,from);for(let record of updatingRecords)record.updateGuards.forEach(guard=>{guards.push(guardToPromiseFn(guard,to,from))});return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>{guards=[];for(let record of enteringRecords)if(record.beforeEnter)if(isArray$1(record.beforeEnter))for(let beforeEnter of record.beforeEnter)guards.push(guardToPromiseFn(beforeEnter,to,from));else guards.push(guardToPromiseFn(record.beforeEnter,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>(to.matched.forEach(record=>record.enterCallbacks={}),guards=extractComponentsGuards(enteringRecords,`beforeRouteEnter`,to,from,runWithContext),guards.push(canceledNavigationCheck),runGuardQueue(guards))).then(()=>{guards=[];for(let guard of beforeResolveGuards.list())guards.push(guardToPromiseFn(guard,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).catch(err$1=>isNavigationFailure(err$1,8)?err$1:Promise.reject(err$1))}function triggerAfterEach(to,from,failure){afterGuards.list().forEach(guard=>runWithContext(()=>guard(to,from,failure)))}function finalizeNavigation(toLocation,from,isPush,replace$1,data){let error$1=checkCanceledNavigation(toLocation,from);if(error$1)return error$1;let isFirstNavigation=from===START_LOCATION_NORMALIZED,state=isBrowser?history.state:{};isPush&&(replace$1||isFirstNavigation?routerHistory.replace(toLocation.fullPath,assign$1({scroll:isFirstNavigation&&state&&state.scroll},data)):routerHistory.push(toLocation.fullPath,data)),currentRoute.value=toLocation,handleScroll(toLocation,from,isPush,isFirstNavigation),markAsReady()}let removeHistoryListener;function setupListeners(){removeHistoryListener||=routerHistory.listen((to,_from,info)=>{if(!router$1.listening)return;let toLocation=resolve$1(to),shouldRedirect=handleRedirectRecord(toLocation);if(shouldRedirect){pushWithRedirect(assign$1(shouldRedirect,{replace:!0,force:!0}),toLocation).catch(noop$1);return}pendingLocation=toLocation;let from=currentRoute.value;isBrowser&&saveScrollPosition(getScrollKey(from.fullPath,info.delta),computeScrollPosition()),navigate(toLocation,from).catch(error$1=>isNavigationFailure(error$1,12)?error$1:isNavigationFailure(error$1,2)?(pushWithRedirect(assign$1(locationAsObject(error$1.to),{force:!0}),toLocation).then(failure=>{isNavigationFailure(failure,20)&&!info.delta&&info.type===NavigationType.pop&&routerHistory.go(-1,!1)}).catch(noop$1),Promise.reject()):(info.delta&&routerHistory.go(-info.delta,!1),triggerError(error$1,toLocation,from))).then(failure=>{failure||=finalizeNavigation(toLocation,from,!1),failure&&(info.delta&&!isNavigationFailure(failure,8)?routerHistory.go(-info.delta,!1):info.type===NavigationType.pop&&isNavigationFailure(failure,20)&&routerHistory.go(-1,!1)),triggerAfterEach(toLocation,from,failure)}).catch(noop$1)})}let readyHandlers=useCallbacks(),errorListeners=useCallbacks(),ready;function triggerError(error$1,to,from){markAsReady(error$1);let list=errorListeners.list();return list.length?list.forEach(handler=>handler(error$1,to,from)):console.error(error$1),Promise.reject(error$1)}function isReady(){return ready&&currentRoute.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((resolve$2,reject)=>{readyHandlers.add([resolve$2,reject])})}function markAsReady(err$1){return ready||(ready=!err$1,setupListeners(),readyHandlers.list().forEach(([resolve$2,reject])=>err$1?reject(err$1):resolve$2()),readyHandlers.reset()),err$1}function handleScroll(to,from,isPush,isFirstNavigation){let{scrollBehavior}=options;if(!isBrowser||!scrollBehavior)return Promise.resolve();let scrollPosition=!isPush&&getSavedScrollPosition(getScrollKey(to.fullPath,0))||(isFirstNavigation||!isPush)&&history.state&&history.state.scroll||null;return nextTick().then(()=>scrollBehavior(to,from,scrollPosition)).then(position=>position&&scrollToPosition(position)).catch(err$1=>triggerError(err$1,to,from))}let go=delta=>routerHistory.go(delta),started,installedApps=new Set,router$1={currentRoute,listening:!0,addRoute,removeRoute,clearRoutes:matcher.clearRoutes,hasRoute,getRoutes,resolve:resolve$1,options,push,replace,go,back:()=>go(-1),forward:()=>go(1),beforeEach:beforeGuards.add,beforeResolve:beforeResolveGuards.add,afterEach:afterGuards.add,onError:errorListeners.add,isReady,install(app$1){let router$2=this;app$1.component(`RouterLink`,RouterLink),app$1.component(`RouterView`,RouterView),app$1.config.globalProperties.$router=router$2,Object.defineProperty(app$1.config.globalProperties,`$route`,{enumerable:!0,get:()=>unref(currentRoute)}),isBrowser&&!started&&currentRoute.value===START_LOCATION_NORMALIZED&&(started=!0,push(routerHistory.location).catch(err$1=>{}));let reactiveRoute={};for(let key$1 in START_LOCATION_NORMALIZED)Object.defineProperty(reactiveRoute,key$1,{get:()=>currentRoute.value[key$1],enumerable:!0});app$1.provide(routerKey,router$2),app$1.provide(routeLocationKey,shallowReactive(reactiveRoute)),app$1.provide(routerViewLocationKey,currentRoute);let unmountApp=app$1.unmount;installedApps.add(app$1),app$1.unmount=function(){installedApps.delete(app$1),installedApps.size<1&&(pendingLocation=START_LOCATION_NORMALIZED,removeHistoryListener&&removeHistoryListener(),removeHistoryListener=null,currentRoute.value=START_LOCATION_NORMALIZED,started=!1,ready=!1),unmountApp()}}};function runGuardQueue(guards){return guards.reduce((promise$1,guard)=>promise$1.then(()=>runWithContext(guard)),Promise.resolve())}return router$1}function extractChangingRecords(to,from){let leavingRecords=[],updatingRecords=[],enteringRecords=[],len$1=Math.max(from.matched.length,to.matched.length);for(let i$1=0;i$1<len$1;i$1++){let recordFrom=from.matched[i$1];recordFrom&&(to.matched.find(record=>isSameRouteRecord(record,recordFrom))?updatingRecords.push(recordFrom):leavingRecords.push(recordFrom));let recordTo=to.matched[i$1];recordTo&&(from.matched.find(record=>isSameRouteRecord(record,recordTo))||enteringRecords.push(recordTo))}return[leavingRecords,updatingRecords,enteringRecords]}var _hoisted_1$5={class:`home`},_hoisted_2$5={class:`hero`},_hoisted_3$5={class:`actions`},HomeComponent_default=__plugin_vue_export_helper_default(defineComponent({__name:`HomeComponent`,setup(__props){return(_ctx,_cache)=>{let _component_router_link=resolveComponent(`router-link`);return openBlock(),createElementBlock(`div`,_hoisted_1$5,[createBaseVNode(`div`,_hoisted_2$5,[_cache[4]||=createBaseVNode(`h1`,null,`JS Chart Library`,-1),_cache[5]||=createBaseVNode(`p`,{class:`subtitle`},` A demo chart library for OHLC charts and indicators `,-1),createBaseVNode(`div`,_hoisted_3$5,[createVNode(_component_router_link,{to:`/canvas`,class:`btn-primary`},{default:withCtx(()=>[..._cache[0]||=[createTextVNode(`Canvas2D`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/pixi-graphics`,class:`btn-primary`},{default:withCtx(()=>[..._cache[1]||=[createTextVNode(`PixiJS Graphics (WebGL)`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/pixi-mesh`,class:`btn-primary`},{default:withCtx(()=>[..._cache[2]||=[createTextVNode(`PixiJS Mesh (Vertex Buffers)`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/echarts`,class:`btn-primary`},{default:withCtx(()=>[..._cache[3]||=[createTextVNode(`ECharts (High-Level Library)`,-1)]]),_:1})])])])}}}),[[`__scopeId`,`data-v-29e19d83`]]),ExtensionType=(ExtensionType2=>(ExtensionType2.Application=`application`,ExtensionType2.WebGLPipes=`webgl-pipes`,ExtensionType2.WebGLPipesAdaptor=`webgl-pipes-adaptor`,ExtensionType2.WebGLSystem=`webgl-system`,ExtensionType2.WebGPUPipes=`webgpu-pipes`,ExtensionType2.WebGPUPipesAdaptor=`webgpu-pipes-adaptor`,ExtensionType2.WebGPUSystem=`webgpu-system`,ExtensionType2.CanvasSystem=`canvas-system`,ExtensionType2.CanvasPipesAdaptor=`canvas-pipes-adaptor`,ExtensionType2.CanvasPipes=`canvas-pipes`,ExtensionType2.Asset=`asset`,ExtensionType2.LoadParser=`load-parser`,ExtensionType2.ResolveParser=`resolve-parser`,ExtensionType2.CacheParser=`cache-parser`,ExtensionType2.DetectionParser=`detection-parser`,ExtensionType2.MaskEffect=`mask-effect`,ExtensionType2.BlendMode=`blend-mode`,ExtensionType2.TextureSource=`texture-source`,ExtensionType2.Environment=`environment`,ExtensionType2.ShapeBuilder=`shape-builder`,ExtensionType2.Batcher=`batcher`,ExtensionType2))(ExtensionType||{}),normalizeExtension=ext=>{if(typeof ext==`function`||typeof ext==`object`&&ext.extension){if(!ext.extension)throw Error(`Extension class must have an extension object`);ext={...typeof ext.extension==`object`?ext.extension:{type:ext.extension},ref:ext}}if(typeof ext==`object`)ext={...ext};else throw Error(`Invalid extension type`);return typeof ext.type==`string`&&(ext.type=[ext.type]),ext},normalizeExtensionPriority=(ext,defaultPriority)=>normalizeExtension(ext).priority??defaultPriority,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...extensions2){return extensions2.map(normalizeExtension).forEach(ext=>{ext.type.forEach(type=>this._removeHandlers[type]?.(ext))}),this},add(...extensions2){return extensions2.map(normalizeExtension).forEach(ext=>{ext.type.forEach(type=>{let handlers=this._addHandlers,queue$1=this._queue;handlers[type]?handlers[type]?.(ext):(queue$1[type]=queue$1[type]||[],queue$1[type]?.push(ext))})}),this},handle(type,onAdd,onRemove){let addHandlers=this._addHandlers,removeHandlers=this._removeHandlers;if(addHandlers[type]||removeHandlers[type])throw Error(`Extension type ${type} already has a handler`);addHandlers[type]=onAdd,removeHandlers[type]=onRemove;let queue$1=this._queue;return queue$1[type]&&(queue$1[type]?.forEach(ext=>onAdd(ext)),delete queue$1[type]),this},handleByMap(type,map$2){return this.handle(type,extension=>{extension.name&&(map$2[extension.name]=extension.ref)},extension=>{extension.name&&delete map$2[extension.name]})},handleByNamedList(type,map$2,defaultPriority=-1){return this.handle(type,extension=>{map$2.findIndex(item=>item.name===extension.name)>=0||(map$2.push({name:extension.name,value:extension.ref}),map$2.sort((a$1,b$1)=>normalizeExtensionPriority(b$1.value,defaultPriority)-normalizeExtensionPriority(a$1.value,defaultPriority)))},extension=>{let index=map$2.findIndex(item=>item.name===extension.name);index!==-1&&map$2.splice(index,1)})},handleByList(type,list,defaultPriority=-1){return this.handle(type,extension=>{list.includes(extension.ref)||(list.push(extension.ref),list.sort((a$1,b$1)=>normalizeExtensionPriority(b$1,defaultPriority)-normalizeExtensionPriority(a$1,defaultPriority)))},extension=>{let index=list.indexOf(extension.ref);index!==-1&&list.splice(index,1)})},mixin(Target,...sources$1){for(let source$2 of sources$1)Object.defineProperties(Target.prototype,Object.getOwnPropertyDescriptors(source$2))}},scriptRel=`modulepreload`,assetsURL=function(dep){return`/chart-poc/`+dep},seen={};const __vitePreload=function(baseModule,deps,importerUrl){let promise$1=Promise.resolve();if(deps&&deps.length>0){let links=document.getElementsByTagName(`link`),cspNonceMeta=document.querySelector(`meta[property=csp-nonce]`),cspNonce=cspNonceMeta?.nonce||cspNonceMeta?.getAttribute(`nonce`);function allSettled(promises$2){return Promise.all(promises$2.map(p$2=>Promise.resolve(p$2).then(value$1=>({status:`fulfilled`,value:value$1}),reason=>({status:`rejected`,reason}))))}promise$1=allSettled(deps.map(dep=>{if(dep=assetsURL(dep,importerUrl),dep in seen)return;seen[dep]=!0;let isCss=dep.endsWith(`.css`),cssSelector=isCss?`[rel="stylesheet"]`:``;if(importerUrl)for(let i$1=links.length-1;i$1>=0;i$1--){let link$1=links[i$1];if(link$1.href===dep&&(!isCss||link$1.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${dep}"]${cssSelector}`))return;let link=document.createElement(`link`);if(link.rel=isCss?`stylesheet`:scriptRel,isCss||(link.as=`script`),link.crossOrigin=``,link.href=dep,cspNonce&&link.setAttribute(`nonce`,cspNonce),document.head.appendChild(link),isCss)return new Promise((res,rej)=>{link.addEventListener(`load`,res),link.addEventListener(`error`,()=>rej(Error(`Unable to preload CSS for ${dep}`)))})}))}function handlePreloadError(err$2){let e$1$1=new Event(`vite:preloadError`,{cancelable:!0});if(e$1$1.payload=err$2,window.dispatchEvent(e$1$1),!e$1$1.defaultPrevented)throw err$2}return promise$1.then(res=>{for(let item of res||[])item.status===`rejected`&&handlePreloadError(item.reason);return baseModule().catch(handlePreloadError)})};var browserExt={extension:{type:ExtensionType.Environment,name:`browser`,priority:-1},test:()=>!0,load:async()=>{await __vitePreload(()=>import(`./browserAll-DSzfLmrU.js`),__vite__mapDeps([0,1]))}},webworkerExt={extension:{type:ExtensionType.Environment,name:`webworker`,priority:0},test:()=>typeof self<`u`&&self.WorkerGlobalScope!==void 0,load:async()=>{await __vitePreload(()=>import(`./webworkerAll-3j39heQg.js`),__vite__mapDeps([2,1]))}},ObservablePoint=class ObservablePoint{constructor(observer,x$1,y$1){this._x=x$1||0,this._y=y$1||0,this._observer=observer}clone(observer){return new ObservablePoint(observer??this._observer,this._x,this._y)}set(x$1=0,y$1=x$1){return(this._x!==x$1||this._y!==y$1)&&(this._x=x$1,this._y=y$1,this._observer._onUpdate(this)),this}copyFrom(p$2){return(this._x!==p$2.x||this._y!==p$2.y)&&(this._x=p$2.x,this._y=p$2.y,this._observer._onUpdate(this)),this}copyTo(p$2){return p$2.set(this._x,this._y),p$2}equals(p$2){return p$2.x===this._x&&p$2.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(value){this._x!==value&&(this._x=value,this._observer._onUpdate(this))}get y(){return this._y}set y(value){this._y!==value&&(this._y=value,this._observer._onUpdate(this))}},eventemitter3_default=__toESM(__commonJSMin(((exports,module)=>{var has=Object.prototype.hasOwnProperty,prefix=`~`;function Events(){}Object.create&&(Events.prototype=Object.create(null),new Events().__proto__||(prefix=!1));function EE(fn,context$1,once){this.fn=fn,this.context=context$1,this.once=once||!1}function addListener(emitter,event,fn,context$1,once){if(typeof fn!=`function`)throw TypeError(`The listener must be a function`);var listener=new EE(fn,context$1||emitter,once),evt=prefix?prefix+event:event;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){--emitter._eventsCount===0?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter$1(){this._events=new Events,this._eventsCount=0}EventEmitter$1.prototype.eventNames=function(){var names=[],events,name;if(this._eventsCount===0)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter$1.prototype.listeners=function(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i$1=0,l$1=handlers.length,ee=Array(l$1);i$1<l$1;i$1++)ee[i$1]=handlers[i$1].fn;return ee},EventEmitter$1.prototype.listenerCount=function(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];return listeners?listeners.fn?1:listeners.length:0},EventEmitter$1.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var listeners=this._events[evt],len$1=arguments.length,args,i$1;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len$1){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i$1=1,args=Array(len$1-1);i$1<len$1;i$1++)args[i$1-1]=arguments[i$1];listeners.fn.apply(listeners.context,args)}else{var length$1=listeners.length,j$1;for(i$1=0;i$1<length$1;i$1++)switch(listeners[i$1].once&&this.removeListener(event,listeners[i$1].fn,void 0,!0),len$1){case 1:listeners[i$1].fn.call(listeners[i$1].context);break;case 2:listeners[i$1].fn.call(listeners[i$1].context,a1);break;case 3:listeners[i$1].fn.call(listeners[i$1].context,a1,a2);break;case 4:listeners[i$1].fn.call(listeners[i$1].context,a1,a2,a3);break;default:if(!args)for(j$1=1,args=Array(len$1-1);j$1<len$1;j$1++)args[j$1-1]=arguments[j$1];listeners[i$1].fn.apply(listeners[i$1].context,args)}}return!0},EventEmitter$1.prototype.on=function(event,fn,context$1){return addListener(this,event,fn,context$1,!1)},EventEmitter$1.prototype.once=function(event,fn,context$1){return addListener(this,event,fn,context$1,!0)},EventEmitter$1.prototype.removeListener=function(event,fn,context$1,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn===fn&&(!once||listeners.once)&&(!context$1||listeners.context===context$1)&&clearEvent(this,evt);else{for(var i$1=0,events=[],length$1=listeners.length;i$1<length$1;i$1++)(listeners[i$1].fn!==fn||once&&!listeners[i$1].once||context$1&&listeners[i$1].context!==context$1)&&events.push(listeners[i$1]);events.length?this._events[evt]=events.length===1?events[0]:events:clearEvent(this,evt)}return this},EventEmitter$1.prototype.removeAllListeners=function(event){var evt;return event?(evt=prefix?prefix+event:event,this._events[evt]&&clearEvent(this,evt)):(this._events=new Events,this._eventsCount=0),this},EventEmitter$1.prototype.off=EventEmitter$1.prototype.removeListener,EventEmitter$1.prototype.addListener=EventEmitter$1.prototype.on,EventEmitter$1.prefixed=prefix,EventEmitter$1.EventEmitter=EventEmitter$1,module!==void 0&&(module.exports=EventEmitter$1)}))(),1).default,PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180,Point$1=class Point$1{constructor(x$1=0,y$1=0){this.x=0,this.y=0,this.x=x$1,this.y=y$1}clone(){return new Point$1(this.x,this.y)}copyFrom(p$2){return this.set(p$2.x,p$2.y),this}copyTo(p$2){return p$2.set(this.x,this.y),p$2}equals(p$2){return p$2.x===this.x&&p$2.y===this.y}set(x$1=0,y$1=x$1){return this.x=x$1,this.y=y$1,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return tempPoint.x=0,tempPoint.y=0,tempPoint}},tempPoint=new Point$1,Matrix=class Matrix{constructor(a$1=1,b$1=0,c$2=0,d$1=1,tx=0,ty=0){this.array=null,this.a=a$1,this.b=b$1,this.c=c$2,this.d=d$1,this.tx=tx,this.ty=ty}fromArray(array){this.a=array[0],this.b=array[1],this.c=array[3],this.d=array[4],this.tx=array[2],this.ty=array[5]}set(a$1,b$1,c$2,d$1,tx,ty){return this.a=a$1,this.b=b$1,this.c=c$2,this.d=d$1,this.tx=tx,this.ty=ty,this}toArray(transpose,out$2){this.array||=new Float32Array(9);let array=out$2||this.array;return transpose?(array[0]=this.a,array[1]=this.b,array[2]=0,array[3]=this.c,array[4]=this.d,array[5]=0,array[6]=this.tx,array[7]=this.ty,array[8]=1):(array[0]=this.a,array[1]=this.c,array[2]=this.tx,array[3]=this.b,array[4]=this.d,array[5]=this.ty,array[6]=0,array[7]=0,array[8]=1),array}apply(pos,newPos){newPos||=new Point$1;let x$1=pos.x,y$1=pos.y;return newPos.x=this.a*x$1+this.c*y$1+this.tx,newPos.y=this.b*x$1+this.d*y$1+this.ty,newPos}applyInverse(pos,newPos){newPos||=new Point$1;let a$1=this.a,b$1=this.b,c$2=this.c,d$1=this.d,tx=this.tx,ty=this.ty,id=1/(a$1*d$1+c$2*-b$1),x$1=pos.x,y$1=pos.y;return newPos.x=d$1*id*x$1+-c$2*id*y$1+(ty*c$2-tx*d$1)*id,newPos.y=a$1*id*y$1+-b$1*id*x$1+(-ty*a$1+tx*b$1)*id,newPos}translate(x$1,y$1){return this.tx+=x$1,this.ty+=y$1,this}scale(x$1,y$1){return this.a*=x$1,this.d*=y$1,this.c*=x$1,this.b*=y$1,this.tx*=x$1,this.ty*=y$1,this}rotate(angle){let cos=Math.cos(angle),sin=Math.sin(angle),a1=this.a,c1=this.c,tx1=this.tx;return this.a=a1*cos-this.b*sin,this.b=a1*sin+this.b*cos,this.c=c1*cos-this.d*sin,this.d=c1*sin+this.d*cos,this.tx=tx1*cos-this.ty*sin,this.ty=tx1*sin+this.ty*cos,this}append(matrix){let a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=matrix.a*a1+matrix.b*c1,this.b=matrix.a*b1+matrix.b*d1,this.c=matrix.c*a1+matrix.d*c1,this.d=matrix.c*b1+matrix.d*d1,this.tx=matrix.tx*a1+matrix.ty*c1+this.tx,this.ty=matrix.tx*b1+matrix.ty*d1+this.ty,this}appendFrom(a$1,b$1){let a1=a$1.a,b1=a$1.b,c1=a$1.c,d1=a$1.d,tx=a$1.tx,ty=a$1.ty,a2=b$1.a,b2=b$1.b,c2=b$1.c,d2=b$1.d;return this.a=a1*a2+b1*c2,this.b=a1*b2+b1*d2,this.c=c1*a2+d1*c2,this.d=c1*b2+d1*d2,this.tx=tx*a2+ty*c2+b$1.tx,this.ty=tx*b2+ty*d2+b$1.ty,this}setTransform(x$1,y$1,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){return this.a=Math.cos(rotation+skewY)*scaleX,this.b=Math.sin(rotation+skewY)*scaleX,this.c=-Math.sin(rotation-skewX)*scaleY,this.d=Math.cos(rotation-skewX)*scaleY,this.tx=x$1-(pivotX*this.a+pivotY*this.c),this.ty=y$1-(pivotX*this.b+pivotY*this.d),this}prepend(matrix){let tx1=this.tx;if(matrix.a!==1||matrix.b!==0||matrix.c!==0||matrix.d!==1){let a1=this.a,c1=this.c;this.a=a1*matrix.a+this.b*matrix.c,this.b=a1*matrix.b+this.b*matrix.d,this.c=c1*matrix.a+this.d*matrix.c,this.d=c1*matrix.b+this.d*matrix.d}return this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx,this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty,this}decompose(transform){let a$1=this.a,b$1=this.b,c$2=this.c,d$1=this.d,pivot=transform.pivot,skewX=-Math.atan2(-c$2,d$1),skewY=Math.atan2(b$1,a$1),delta=Math.abs(skewX+skewY);return delta<1e-5||Math.abs(PI_2-delta)<1e-5?(transform.rotation=skewY,transform.skew.x=transform.skew.y=0):(transform.rotation=0,transform.skew.x=skewX,transform.skew.y=skewY),transform.scale.x=Math.sqrt(a$1*a$1+b$1*b$1),transform.scale.y=Math.sqrt(c$2*c$2+d$1*d$1),transform.position.x=this.tx+(pivot.x*a$1+pivot.y*c$2),transform.position.y=this.ty+(pivot.x*b$1+pivot.y*d$1),transform}invert(){let a1=this.a,b1=this.b,c1=this.c,d1=this.d,tx1=this.tx,n$1=a1*d1-b1*c1;return this.a=d1/n$1,this.b=-b1/n$1,this.c=-c1/n$1,this.d=a1/n$1,this.tx=(c1*this.ty-d1*tx1)/n$1,this.ty=-(a1*this.ty-b1*tx1)/n$1,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let matrix=new Matrix;return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix}copyTo(matrix){return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix}copyFrom(matrix){return this.a=matrix.a,this.b=matrix.b,this.c=matrix.c,this.d=matrix.d,this.tx=matrix.tx,this.ty=matrix.ty,this}equals(matrix){return matrix.a===this.a&&matrix.b===this.b&&matrix.c===this.c&&matrix.d===this.d&&matrix.tx===this.tx&&matrix.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return identityMatrix$1.identity()}static get shared(){return tempMatrix$5.identity()}},tempMatrix$5=new Matrix,identityMatrix$1=new Matrix,ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init$2(){for(let i$1=0;i$1<16;i$1++){let row=[];rotationCayley.push(row);for(let j$1=0;j$1<16;j$1++){let _ux=signum(ux[i$1]*ux[j$1]+vx[i$1]*uy[j$1]),_uy=signum(uy[i$1]*ux[j$1]+vy[i$1]*uy[j$1]),_vx=signum(ux[i$1]*vx[j$1]+vx[i$1]*vy[j$1]),_vy=signum(uy[i$1]*vx[j$1]+vy[i$1]*vy[j$1]);for(let k$1=0;k$1<16;k$1++)if(ux[k$1]===_ux&&uy[k$1]===_uy&&vx[k$1]===_vx&&vy[k$1]===_vy){row.push(k$1);break}}}for(let i$1=0;i$1<16;i$1++){let mat=new Matrix;mat.set(ux[i$1],uy[i$1],vx[i$1],vy[i$1],0,0),rotationMatrices.push(mat)}}init$2();var groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:ind=>ux[ind],uY:ind=>uy[ind],vX:ind=>vx[ind],vY:ind=>vy[ind],inv:rotation=>rotation&8?rotation&15:-rotation&7,add:(rotationSecond,rotationFirst)=>rotationCayley[rotationSecond][rotationFirst],sub:(rotationSecond,rotationFirst)=>rotationCayley[rotationSecond][groupD8.inv(rotationFirst)],rotate180:rotation=>rotation^4,isVertical:rotation=>(rotation&3)==2,byDirection:(dx,dy)=>Math.abs(dx)*2<=Math.abs(dy)?dy>=0?groupD8.S:groupD8.N:Math.abs(dy)*2<=Math.abs(dx)?dx>0?groupD8.E:groupD8.W:dy>0?dx>0?groupD8.SE:groupD8.SW:dx>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(matrix,rotation,tx=0,ty=0)=>{let mat=rotationMatrices[groupD8.inv(rotation)];mat.tx=tx,mat.ty=ty,matrix.append(mat)},transformRectCoords:(rect,sourceFrame,rotation,out$2)=>{let{x:x$1,y:y$1,width,height}=rect,{x:frameX,y:frameY,width:frameWidth,height:frameHeight}=sourceFrame;return rotation===groupD8.E?(out$2.set(x$1+frameX,y$1+frameY,width,height),out$2):rotation===groupD8.S?out$2.set(frameWidth-y$1-height+frameX,x$1+frameY,height,width):rotation===groupD8.W?out$2.set(frameWidth-x$1-width+frameX,frameHeight-y$1-height+frameY,width,height):rotation===groupD8.N?out$2.set(y$1+frameX,frameHeight-x$1-width+frameY,height,width):out$2.set(x$1+frameX,y$1+frameY,width,height)}},tempPoints=[new Point$1,new Point$1,new Point$1,new Point$1],Rectangle=class Rectangle{constructor(x$1=0,y$1=0,width=0,height=0){this.type=`rectangle`,this.x=Number(x$1),this.y=Number(y$1),this.width=Number(width),this.height=Number(height)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFromBounds(bounds){return this.x=bounds.minX,this.y=bounds.minY,this.width=bounds.maxX-bounds.minX,this.height=bounds.maxY-bounds.minY,this}copyFrom(rectangle){return this.x=rectangle.x,this.y=rectangle.y,this.width=rectangle.width,this.height=rectangle.height,this}copyTo(rectangle){return rectangle.copyFrom(this),rectangle}contains(x$1,y$1){return this.width<=0||this.height<=0?!1:x$1>=this.x&&x$1<this.x+this.width&&y$1>=this.y&&y$1<this.y+this.height}strokeContains(x$1,y$1,strokeWidth,alignment=.5){let{width,height}=this;if(width<=0||height<=0)return!1;let _x=this.x,_y=this.y,strokeWidthOuter=strokeWidth*(1-alignment),strokeWidthInner=strokeWidth-strokeWidthOuter,outerLeft=_x-strokeWidthOuter,outerRight=_x+width+strokeWidthOuter,outerTop=_y-strokeWidthOuter,outerBottom=_y+height+strokeWidthOuter,innerLeft=_x+strokeWidthInner,innerRight=_x+width-strokeWidthInner,innerTop=_y+strokeWidthInner,innerBottom=_y+height-strokeWidthInner;return x$1>=outerLeft&&x$1<=outerRight&&y$1>=outerTop&&y$1<=outerBottom&&!(x$1>innerLeft&&x$1<innerRight&&y$1>innerTop&&y$1<innerBottom)}intersects(other,transform){if(!transform){let x02=this.x<other.x?other.x:this.x;if((this.right>other.right?other.right:this.right)<=x02)return!1;let y02=this.y<other.y?other.y:this.y;return(this.bottom>other.bottom?other.bottom:this.bottom)>y02}let x0=this.left,x1=this.right,y0=this.top,y1=this.bottom;if(x1<=x0||y1<=y0)return!1;let lt$1=tempPoints[0].set(other.left,other.top),lb$1=tempPoints[1].set(other.left,other.bottom),rt$1=tempPoints[2].set(other.right,other.top),rb$1=tempPoints[3].set(other.right,other.bottom);if(rt$1.x<=lt$1.x||lb$1.y<=lt$1.y)return!1;let s$1=Math.sign(transform.a*transform.d-transform.b*transform.c);if(s$1===0||(transform.apply(lt$1,lt$1),transform.apply(lb$1,lb$1),transform.apply(rt$1,rt$1),transform.apply(rb$1,rb$1),Math.max(lt$1.x,lb$1.x,rt$1.x,rb$1.x)<=x0||Math.min(lt$1.x,lb$1.x,rt$1.x,rb$1.x)>=x1||Math.max(lt$1.y,lb$1.y,rt$1.y,rb$1.y)<=y0||Math.min(lt$1.y,lb$1.y,rt$1.y,rb$1.y)>=y1))return!1;let nx=s$1*(lb$1.y-lt$1.y),ny=s$1*(lt$1.x-lb$1.x),n00=nx*x0+ny*y0,n10=nx*x1+ny*y0,n01=nx*x0+ny*y1,n11=nx*x1+ny*y1;if(Math.max(n00,n10,n01,n11)<=nx*lt$1.x+ny*lt$1.y||Math.min(n00,n10,n01,n11)>=nx*rb$1.x+ny*rb$1.y)return!1;let mx=s$1*(lt$1.y-rt$1.y),my=s$1*(rt$1.x-lt$1.x),m00=mx*x0+my*y0,m10=mx*x1+my*y0,m01=mx*x0+my*y1,m11=mx*x1+my*y1;return!(Math.max(m00,m10,m01,m11)<=mx*lt$1.x+my*lt$1.y||Math.min(m00,m10,m01,m11)>=mx*rb$1.x+my*rb$1.y)}pad(paddingX=0,paddingY=paddingX){return this.x-=paddingX,this.y-=paddingY,this.width+=paddingX*2,this.height+=paddingY*2,this}fit(rectangle){let x1=Math.max(this.x,rectangle.x),x2=Math.min(this.x+this.width,rectangle.x+rectangle.width),y1=Math.max(this.y,rectangle.y),y2=Math.min(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=Math.max(x2-x1,0),this.y=y1,this.height=Math.max(y2-y1,0),this}ceil(resolution=1,eps=.001){let x2=Math.ceil((this.x+this.width-eps)*resolution)/resolution,y2=Math.ceil((this.y+this.height-eps)*resolution)/resolution;return this.x=Math.floor((this.x+eps)*resolution)/resolution,this.y=Math.floor((this.y+eps)*resolution)/resolution,this.width=x2-this.x,this.height=y2-this.y,this}scale(x$1,y$1=x$1){return this.x*=x$1,this.y*=y$1,this.width*=x$1,this.height*=y$1,this}enlarge(rectangle){let x1=Math.min(this.x,rectangle.x),x2=Math.max(this.x+this.width,rectangle.x+rectangle.width),y1=Math.min(this.y,rectangle.y),y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);return this.x=x1,this.width=x2-x1,this.y=y1,this.height=y2-y1,this}getBounds(out$2){return out$2||=new Rectangle,out$2.copyFrom(this),out$2}containsRect(other){if(this.width<=0||this.height<=0)return!1;let x1=other.x,y1=other.y,x2=other.x+other.width,y2=other.y+other.height;return x1>=this.x&&x1<this.x+this.width&&y1>=this.y&&y1<this.y+this.height&&x2>=this.x&&x2<this.x+this.width&&y2>=this.y&&y2<this.y+this.height}set(x$1,y$1,width,height){return this.x=x$1,this.y=y$1,this.width=width,this.height=height,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}},uidCache={default:-1};function uid$1(name=`default`){return uidCache[name]===void 0&&(uidCache[name]=-1),++uidCache[name]}var warnings=new Set,v8_0_0=`8.0.0`,v8_3_4=`8.3.4`,deprecationState={quiet:!1,noColor:!1},deprecation=(version$1,message,ignoreDepth=3)=>{if(deprecationState.quiet||warnings.has(message))return;let stack=Error().stack,deprecationMessage=`${message}
Deprecated since v${version$1}`,useGroup=typeof console.groupCollapsed==`function`&&!deprecationState.noColor;stack===void 0?console.warn(`PixiJS Deprecation Warning: `,deprecationMessage):(stack=stack.split(`
`).splice(ignoreDepth).join(`
`),useGroup?(console.groupCollapsed(`%cPixiJS Deprecation Warning: %c%s`,`color:#614108;background:#fffbe6`,`font-weight:normal;color:#614108;background:#fffbe6`,deprecationMessage),console.warn(stack),console.groupEnd()):(console.warn(`PixiJS Deprecation Warning: `,deprecationMessage),console.warn(stack))),warnings.add(message)};Object.defineProperties(deprecation,{quiet:{get:()=>deprecationState.quiet,set:value=>{deprecationState.quiet=value},enumerable:!0,configurable:!1},noColor:{get:()=>deprecationState.noColor,set:value=>{deprecationState.noColor=value},enumerable:!0,configurable:!1}});var NOOP=()=>{};function nextPow2(v$1){return v$1+=v$1===0?1:0,--v$1,v$1|=v$1>>>1,v$1|=v$1>>>2,v$1|=v$1>>>4,v$1|=v$1>>>8,v$1|=v$1>>>16,v$1+1}function isPow2(v$1){return!(v$1&v$1-1)&&!!v$1}function definedProps(obj){let result={};for(let key$1 in obj)obj[key$1]!==void 0&&(result[key$1]=obj[key$1]);return result}var idHash$1=Object.create(null);function createResourceIdFromString(value){let id=idHash$1[value];return id===void 0&&(idHash$1[value]=uid$1(`resource`)),id}var _TextureStyle=class _TextureStyle$1 extends eventemitter3_default{constructor(options={}){super(),this._resourceType=`textureSampler`,this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,options={..._TextureStyle$1.defaultOptions,...options},this.addressMode=options.addressMode,this.addressModeU=options.addressModeU??this.addressModeU,this.addressModeV=options.addressModeV??this.addressModeV,this.addressModeW=options.addressModeW??this.addressModeW,this.scaleMode=options.scaleMode,this.magFilter=options.magFilter??this.magFilter,this.minFilter=options.minFilter??this.minFilter,this.mipmapFilter=options.mipmapFilter??this.mipmapFilter,this.lodMinClamp=options.lodMinClamp,this.lodMaxClamp=options.lodMaxClamp,this.compare=options.compare,this.maxAnisotropy=options.maxAnisotropy??1}set addressMode(value){this.addressModeU=value,this.addressModeV=value,this.addressModeW=value}get addressMode(){return this.addressModeU}set wrapMode(value){deprecation(v8_0_0,`TextureStyle.wrapMode is now TextureStyle.addressMode`),this.addressMode=value}get wrapMode(){return this.addressMode}set scaleMode(value){this.magFilter=value,this.minFilter=value,this.mipmapFilter=value}get scaleMode(){return this.magFilter}set maxAnisotropy(value){this._maxAnisotropy=Math.min(value,16),this._maxAnisotropy>1&&(this.scaleMode=`linear`)}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit(`change`,this),this._sharedResourceId=null}_generateResourceId(){let bigKey=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=createResourceIdFromString(bigKey),this._resourceId}destroy(){this.destroyed=!0,this.emit(`destroy`,this),this.emit(`change`,this),this.removeAllListeners()}};_TextureStyle.defaultOptions={addressMode:`clamp-to-edge`,scaleMode:`linear`};var TextureStyle=_TextureStyle,_TextureSource=class _TextureSource$1 extends eventemitter3_default{constructor(options={}){super(),this.options=options,this.uid=uid$1(`textureSource`),this._resourceType=`textureSource`,this._resourceId=uid$1(`resource`),this.uploadMethodId=`unknown`,this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format=`rgba8unorm`,this.dimension=`2d`,this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,options={..._TextureSource$1.defaultOptions,...options},this.label=options.label??``,this.resource=options.resource,this.autoGarbageCollect=options.autoGarbageCollect,this._resolution=options.resolution,options.width?this.pixelWidth=options.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,options.height?this.pixelHeight=options.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=options.format,this.dimension=options.dimensions,this.mipLevelCount=options.mipLevelCount,this.autoGenerateMipmaps=options.autoGenerateMipmaps,this.sampleCount=options.sampleCount,this.antialias=options.antialias,this.alphaMode=options.alphaMode,this.style=new TextureStyle(definedProps(options)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(value){this.style!==value&&(this._style?.off(`change`,this._onStyleChange,this),this._style=value,this._style?.on(`change`,this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(value){this._style.maxAnisotropy=value}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(value){this._style.addressMode=value}get repeatMode(){return this._style.addressMode}set repeatMode(value){this._style.addressMode=value}get magFilter(){return this._style.magFilter}set magFilter(value){this._style.magFilter=value}get minFilter(){return this._style.minFilter}set minFilter(value){this._style.minFilter=value}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(value){this._style.mipmapFilter=value}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(value){this._style.lodMinClamp=value}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(value){this._style.lodMaxClamp=value}_onStyleChange(){this.emit(`styleChange`,this)}update(){if(this.resource){let resolution=this._resolution;if(this.resize(this.resourceWidth/resolution,this.resourceHeight/resolution))return}this.emit(`update`,this)}destroy(){this.destroyed=!0,this.emit(`destroy`,this),this.emit(`change`,this),this._style&&=(this._style.destroy(),null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=uid$1(`resource`),this.emit(`change`,this),this.emit(`unload`,this)}get resourceWidth(){let{resource}=this;return resource.naturalWidth||resource.videoWidth||resource.displayWidth||resource.width}get resourceHeight(){let{resource}=this;return resource.naturalHeight||resource.videoHeight||resource.displayHeight||resource.height}get resolution(){return this._resolution}set resolution(resolution){this._resolution!==resolution&&(this._resolution=resolution,this.width=this.pixelWidth/resolution,this.height=this.pixelHeight/resolution)}resize(width,height,resolution){resolution||=this._resolution,width||=this.width,height||=this.height;let newPixelWidth=Math.round(width*resolution),newPixelHeight=Math.round(height*resolution);return this.width=newPixelWidth/resolution,this.height=newPixelHeight/resolution,this._resolution=resolution,this.pixelWidth===newPixelWidth&&this.pixelHeight===newPixelHeight?!1:(this._refreshPOT(),this.pixelWidth=newPixelWidth,this.pixelHeight=newPixelHeight,this.emit(`resize`,this),this._resourceId=uid$1(`resource`),this.emit(`change`,this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit(`updateMipmaps`,this)}set wrapMode(value){this._style.wrapMode=value}get wrapMode(){return this._style.wrapMode}set scaleMode(value){this._style.scaleMode=value}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=isPow2(this.pixelWidth)&&isPow2(this.pixelHeight)}static test(_resource){throw Error(`Unimplemented`)}};_TextureSource.defaultOptions={resolution:1,format:`bgra8unorm`,alphaMode:`premultiply-alpha-on-upload`,dimensions:`2d`,mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};var TextureSource=_TextureSource,BufferImageSource=class extends TextureSource{constructor(options){let buffer=options.resource||new Float32Array(options.width*options.height*4),format$1=options.format;format$1||=buffer instanceof Float32Array?`rgba32float`:buffer instanceof Int32Array||buffer instanceof Uint32Array?`rgba32uint`:buffer instanceof Int16Array||buffer instanceof Uint16Array?`rgba16uint`:(buffer instanceof Int8Array,`bgra8unorm`),super({...options,resource:buffer,format:format$1}),this.uploadMethodId=`buffer`}static test(resource){return resource instanceof Int8Array||resource instanceof Uint8Array||resource instanceof Uint8ClampedArray||resource instanceof Int16Array||resource instanceof Uint16Array||resource instanceof Int32Array||resource instanceof Uint32Array||resource instanceof Float32Array}};BufferImageSource.extension=ExtensionType.TextureSource;var tempMat=new Matrix,TextureMatrix=class{constructor(texture,clampMargin){this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,clampMargin===void 0?this.clampMargin=texture.width<10?0:.5:this.clampMargin=clampMargin,this.isSimple=!1,this.texture=texture}get texture(){return this._texture}set texture(value){this.texture!==value&&(this._texture?.removeListener(`update`,this.update,this),this._texture=value,this._texture.addListener(`update`,this.update,this),this.update())}multiplyUvs(uvs,out$2){out$2===void 0&&(out$2=uvs);let mat=this.mapCoord;for(let i$1=0;i$1<uvs.length;i$1+=2){let x$1=uvs[i$1],y$1=uvs[i$1+1];out$2[i$1]=x$1*mat.a+y$1*mat.c+mat.tx,out$2[i$1+1]=x$1*mat.b+y$1*mat.d+mat.ty}return out$2}update(){let tex=this._texture;this._updateID++;let uvs=tex.uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);let orig=tex.orig,trim$1=tex.trim;trim$1&&(tempMat.set(orig.width/trim$1.width,0,0,orig.height/trim$1.height,-trim$1.x/trim$1.width,-trim$1.y/trim$1.height),this.mapCoord.append(tempMat));let texBase=tex.source,frame=this.uClampFrame,margin=this.clampMargin/texBase._resolution,offset=this.clampOffset/texBase._resolution;return frame[0]=(tex.frame.x+margin+offset)/texBase.width,frame[1]=(tex.frame.y+margin+offset)/texBase.height,frame[2]=(tex.frame.x+tex.frame.width-margin+offset)/texBase.width,frame[3]=(tex.frame.y+tex.frame.height-margin+offset)/texBase.height,this.uClampOffset[0]=this.clampOffset/texBase.pixelWidth,this.uClampOffset[1]=this.clampOffset/texBase.pixelHeight,this.isSimple=tex.frame.width===texBase.width&&tex.frame.height===texBase.height&&tex.rotate===0,!0}},Texture=class extends eventemitter3_default{constructor({source:source$2,label,frame,orig,trim:trim$1,defaultAnchor,defaultBorders,rotate:rotate$1,dynamic}={}){if(super(),this.uid=uid$1(`texture`),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Rectangle,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=label,this.source=source$2?.source??new TextureSource,this.noFrame=!frame,frame)this.frame.copyFrom(frame);else{let{width,height}=this._source;this.frame.width=width,this.frame.height=height}this.orig=orig||this.frame,this.trim=trim$1,this.rotate=rotate$1??0,this.defaultAnchor=defaultAnchor,this.defaultBorders=defaultBorders,this.destroyed=!1,this.dynamic=dynamic||!1,this.updateUvs()}set source(value){this._source&&this._source.off(`resize`,this.update,this),this._source=value,value.on(`resize`,this.update,this),this.emit(`update`,this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||=new TextureMatrix(this),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){let{uvs,frame}=this,{width,height}=this._source,nX=frame.x/width,nY=frame.y/height,nW=frame.width/width,nH=frame.height/height,rotate$1=this.rotate;if(rotate$1){let w2=nW/2,h2=nH/2,cX=nX+w2,cY=nY+h2;rotate$1=groupD8.add(rotate$1,groupD8.NW),uvs.x0=cX+w2*groupD8.uX(rotate$1),uvs.y0=cY+h2*groupD8.uY(rotate$1),rotate$1=groupD8.add(rotate$1,2),uvs.x1=cX+w2*groupD8.uX(rotate$1),uvs.y1=cY+h2*groupD8.uY(rotate$1),rotate$1=groupD8.add(rotate$1,2),uvs.x2=cX+w2*groupD8.uX(rotate$1),uvs.y2=cY+h2*groupD8.uY(rotate$1),rotate$1=groupD8.add(rotate$1,2),uvs.x3=cX+w2*groupD8.uX(rotate$1),uvs.y3=cY+h2*groupD8.uY(rotate$1)}else uvs.x0=nX,uvs.y0=nY,uvs.x1=nX+nW,uvs.y1=nY,uvs.x2=nX+nW,uvs.y2=nY+nH,uvs.x3=nX,uvs.y3=nY+nH}destroy(destroySource=!1){this._source&&destroySource&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit(`destroy`,this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit(`update`,this)}get baseTexture(){return deprecation(v8_0_0,`Texture.baseTexture is now Texture.source`),this._source}};Texture.EMPTY=new Texture({label:`EMPTY`,source:new TextureSource({label:`EMPTY`})}),Texture.EMPTY.destroy=NOOP,Texture.WHITE=new Texture({source:new BufferImageSource({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:`premultiply-alpha-on-upload`,label:`WHITE`}),label:`WHITE`}),Texture.WHITE.destroy=NOOP;function updateQuadBounds(bounds,anchor,texture){let{width,height}=texture.orig,trim$1=texture.trim;if(trim$1){let sourceWidth=trim$1.width,sourceHeight=trim$1.height;bounds.minX=trim$1.x-anchor._x*width,bounds.maxX=bounds.minX+sourceWidth,bounds.minY=trim$1.y-anchor._y*height,bounds.maxY=bounds.minY+sourceHeight}else bounds.minX=-anchor._x*width,bounds.maxX=bounds.minX+width,bounds.minY=-anchor._y*height,bounds.maxY=bounds.minY+height}var defaultMatrix=new Matrix,Bounds=class Bounds{constructor(minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||=new Rectangle;let rectangle=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(rectangle.x=0,rectangle.y=0,rectangle.width=0,rectangle.height=0):rectangle.copyFromBounds(this),rectangle}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this}set(x0,y0,x1,y1){this.minX=x0,this.minY=y0,this.maxX=x1,this.maxY=y1}addFrame(x0,y0,x1,y1,matrix){matrix||=this.matrix;let a$1=matrix.a,b$1=matrix.b,c$2=matrix.c,d$1=matrix.d,tx=matrix.tx,ty=matrix.ty,minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,x$1=a$1*x0+c$2*y0+tx,y$1=b$1*x0+d$1*y0+ty;x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1),x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1),x$1=a$1*x1+c$2*y0+tx,y$1=b$1*x1+d$1*y0+ty,x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1),x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1),x$1=a$1*x0+c$2*y1+tx,y$1=b$1*x0+d$1*y1+ty,x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1),x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1),x$1=a$1*x1+c$2*y1+tx,y$1=b$1*x1+d$1*y1+ty,x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1),x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1),this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY}addRect(rect,matrix){this.addFrame(rect.x,rect.y,rect.x+rect.width,rect.y+rect.height,matrix)}addBounds(bounds,matrix){this.addFrame(bounds.minX,bounds.minY,bounds.maxX,bounds.maxY,matrix)}addBoundsMask(mask){this.minX=this.minX>mask.minX?this.minX:mask.minX,this.minY=this.minY>mask.minY?this.minY:mask.minY,this.maxX=this.maxX<mask.maxX?this.maxX:mask.maxX,this.maxY=this.maxY<mask.maxY?this.maxY:mask.maxY}applyMatrix(matrix){let minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,{a:a$1,b:b$1,c:c$2,d:d$1,tx,ty}=matrix,x$1=a$1*minX+c$2*minY+tx,y$1=b$1*minX+d$1*minY+ty;this.minX=x$1,this.minY=y$1,this.maxX=x$1,this.maxY=y$1,x$1=a$1*maxX+c$2*minY+tx,y$1=b$1*maxX+d$1*minY+ty,this.minX=x$1<this.minX?x$1:this.minX,this.minY=y$1<this.minY?y$1:this.minY,this.maxX=x$1>this.maxX?x$1:this.maxX,this.maxY=y$1>this.maxY?y$1:this.maxY,x$1=a$1*minX+c$2*maxY+tx,y$1=b$1*minX+d$1*maxY+ty,this.minX=x$1<this.minX?x$1:this.minX,this.minY=y$1<this.minY?y$1:this.minY,this.maxX=x$1>this.maxX?x$1:this.maxX,this.maxY=y$1>this.maxY?y$1:this.maxY,x$1=a$1*maxX+c$2*maxY+tx,y$1=b$1*maxX+d$1*maxY+ty,this.minX=x$1<this.minX?x$1:this.minX,this.minY=y$1<this.minY?y$1:this.minY,this.maxX=x$1>this.maxX?x$1:this.maxX,this.maxY=y$1>this.maxY?y$1:this.maxY}fit(rect){return this.minX<rect.left&&(this.minX=rect.left),this.maxX>rect.right&&(this.maxX=rect.right),this.minY<rect.top&&(this.minY=rect.top),this.maxY>rect.bottom&&(this.maxY=rect.bottom),this}fitBounds(left,right,top,bottom){return this.minX<left&&(this.minX=left),this.maxX>right&&(this.maxX=right),this.minY<top&&(this.minY=top),this.maxY>bottom&&(this.maxY=bottom),this}pad(paddingX,paddingY=paddingX){return this.minX-=paddingX,this.maxX+=paddingX,this.minY-=paddingY,this.maxY+=paddingY,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Bounds(this.minX,this.minY,this.maxX,this.maxY)}scale(x$1,y$1=x$1){return this.minX*=x$1,this.minY*=y$1,this.maxX*=x$1,this.maxY*=y$1,this}get x(){return this.minX}set x(value){let width=this.maxX-this.minX;this.minX=value,this.maxX=value+width}get y(){return this.minY}set y(value){let height=this.maxY-this.minY;this.minY=value,this.maxY=value+height}get width(){return this.maxX-this.minX}set width(value){this.maxX=this.minX+value}get height(){return this.maxY-this.minY}set height(value){this.maxY=this.minY+value}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(vertexData,beginOffset,endOffset,matrix){let minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;matrix||=this.matrix;let a$1=matrix.a,b$1=matrix.b,c$2=matrix.c,d$1=matrix.d,tx=matrix.tx,ty=matrix.ty;for(let i$1=beginOffset;i$1<endOffset;i$1+=2){let localX=vertexData[i$1],localY=vertexData[i$1+1],x$1=a$1*localX+c$2*localY+tx,y$1=b$1*localX+d$1*localY+ty;minX=x$1<minX?x$1:minX,minY=y$1<minY?y$1:minY,maxX=x$1>maxX?x$1:maxX,maxY=y$1>maxY?y$1:maxY}this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY}containsPoint(x$1,y$1){return this.minX<=x$1&&this.minY<=y$1&&this.maxX>=x$1&&this.maxY>=y$1}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(bounds){return this.minX=bounds.minX,this.minY=bounds.minY,this.maxX=bounds.maxX,this.maxY=bounds.maxY,this}},r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(r$1){return typeof r$1==`string`?r$1.length>0:typeof r$1==`number`},n=function(r$1,t$1,n$1){return t$1===void 0&&(t$1=0),n$1===void 0&&(n$1=10**t$1),Math.round(n$1*r$1)/n$1+0},e$1=function(r$1,t$1,n$1){return t$1===void 0&&(t$1=0),n$1===void 0&&(n$1=1),r$1>n$1?n$1:r$1>t$1?r$1:t$1},u=function(r$1){return(r$1=isFinite(r$1)?r$1%360:0)>0?r$1:r$1+360},a=function(r$1){return{r:e$1(r$1.r,0,255),g:e$1(r$1.g,0,255),b:e$1(r$1.b,0,255),a:e$1(r$1.a)}},o=function(r$1){return{r:n(r$1.r),g:n(r$1.g),b:n(r$1.b),a:n(r$1.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(r$1){var t$1=r$1.toString(16);return t$1.length<2?`0`+t$1:t$1},h=function(r$1){var t$1=r$1.r,n$1=r$1.g,e$2=r$1.b,u$1=r$1.a,a$1=Math.max(t$1,n$1,e$2),o$1=a$1-Math.min(t$1,n$1,e$2),i$1=o$1?a$1===t$1?(n$1-e$2)/o$1:a$1===n$1?2+(e$2-t$1)/o$1:4+(t$1-n$1)/o$1:0;return{h:60*(i$1<0?i$1+6:i$1),s:a$1?o$1/a$1*100:0,v:a$1/255*100,a:u$1}},b=function(r$1){var t$1=r$1.h,n$1=r$1.s,e$2=r$1.v,u$1=r$1.a;t$1=t$1/360*6,n$1/=100,e$2/=100;var a$1=Math.floor(t$1),o$1=e$2*(1-n$1),i$1=e$2*(1-(t$1-a$1)*n$1),s$1=e$2*(1-(1-t$1+a$1)*n$1),h$2=a$1%6;return{r:255*[e$2,i$1,o$1,o$1,s$1,e$2][h$2],g:255*[s$1,e$2,e$2,i$1,o$1,o$1][h$2],b:255*[o$1,o$1,s$1,e$2,e$2,i$1][h$2],a:u$1}},g=function(r$1){return{h:u(r$1.h),s:e$1(r$1.s,0,100),l:e$1(r$1.l,0,100),a:e$1(r$1.a)}},d=function(r$1){return{h:n(r$1.h),s:n(r$1.s),l:n(r$1.l),a:n(r$1.a,3)}},f=function(r$1){return b((n$1=(t$1=r$1).s,{h:t$1.h,s:(n$1*=((e$2=t$1.l)<50?e$2:100-e$2)/100)>0?2*n$1/(e$2+n$1)*100:0,v:e$2+n$1,a:t$1.a}));var t$1,n$1,e$2},c$1=function(r$1){return{h:(t$1=h(r$1)).h,s:(u$1=(200-(n$1=t$1.s))*(e$2=t$1.v)/100)>0&&u$1<200?n$1*e$2/100/(u$1<=100?u$1:200-u$1)*100:0,l:u$1/2,a:t$1.a};var t$1,n$1,e$2,u$1},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(r$1){var t$1=i.exec(r$1);return t$1?(r$1=t$1[1]).length<=4?{r:parseInt(r$1[0]+r$1[0],16),g:parseInt(r$1[1]+r$1[1],16),b:parseInt(r$1[2]+r$1[2],16),a:r$1.length===4?n(parseInt(r$1[3]+r$1[3],16)/255,2):1}:r$1.length===6||r$1.length===8?{r:parseInt(r$1.substr(0,2),16),g:parseInt(r$1.substr(2,2),16),b:parseInt(r$1.substr(4,2),16),a:r$1.length===8?n(parseInt(r$1.substr(6,2),16)/255,2):1}:null:null},`hex`],[function(r$1){var t$1=v.exec(r$1)||m$1.exec(r$1);return t$1?t$1[2]!==t$1[4]||t$1[4]!==t$1[6]?null:a({r:Number(t$1[1])/(t$1[2]?100/255:1),g:Number(t$1[3])/(t$1[4]?100/255:1),b:Number(t$1[5])/(t$1[6]?100/255:1),a:t$1[7]===void 0?1:Number(t$1[7])/(t$1[8]?100:1)}):null},`rgb`],[function(t$1){var n$1=l.exec(t$1)||p.exec(t$1);if(!n$1)return null;var e$2,u$1,a$1=g({h:(e$2=n$1[1],u$1=n$1[2],u$1===void 0&&(u$1=`deg`),Number(e$2)*(r[u$1]||1)),s:Number(n$1[3]),l:Number(n$1[4]),a:n$1[5]===void 0?1:Number(n$1[5])/(n$1[6]?100:1)});return f(a$1)},`hsl`]],object:[[function(r$1){var n$1=r$1.r,e$2=r$1.g,u$1=r$1.b,o$1=r$1.a,i$1=o$1===void 0?1:o$1;return t(n$1)&&t(e$2)&&t(u$1)?a({r:Number(n$1),g:Number(e$2),b:Number(u$1),a:Number(i$1)}):null},`rgb`],[function(r$1){var n$1=r$1.h,e$2=r$1.s,u$1=r$1.l,a$1=r$1.a,o$1=a$1===void 0?1:a$1;if(!t(n$1)||!t(e$2)||!t(u$1))return null;var i$1=g({h:Number(n$1),s:Number(e$2),l:Number(u$1),a:Number(o$1)});return f(i$1)},`hsl`],[function(r$1){var n$1=r$1.h,a$1=r$1.s,o$1=r$1.v,i$1=r$1.a,s$1=i$1===void 0?1:i$1;if(!t(n$1)||!t(a$1)||!t(o$1))return null;var h$2=function(r$2){return{h:u(r$2.h),s:e$1(r$2.s,0,100),v:e$1(r$2.v,0,100),a:e$1(r$2.a)}}({h:Number(n$1),s:Number(a$1),v:Number(o$1),a:Number(s$1)});return b(h$2)},`hsv`]]},N=function(r$1,t$1){for(var n$1=0;n$1<t$1.length;n$1++){var e$2=t$1[n$1][0](r$1);if(e$2)return[e$2,t$1[n$1][1]]}return[null,void 0]},x=function(r$1){return typeof r$1==`string`?N(r$1.trim(),y.string):typeof r$1==`object`&&r$1?N(r$1,y.object):[null,void 0]},I=function(r$1){return x(r$1)[1]},M=function(r$1,t$1){var n$1=c$1(r$1);return{h:n$1.h,s:e$1(n$1.s+100*t$1,0,100),l:n$1.l,a:n$1.a}},H=function(r$1){return(299*r$1.r+587*r$1.g+114*r$1.b)/1e3/255},$=function(r$1,t$1){var n$1=c$1(r$1);return{h:n$1.h,s:n$1.s,l:e$1(n$1.l+100*t$1,0,100),a:n$1.a}},j=function(){function r$1(r$2){this.parsed=x(r$2)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r$1.prototype.isValid=function(){return this.parsed!==null},r$1.prototype.brightness=function(){return n(H(this.rgba),2)},r$1.prototype.isDark=function(){return H(this.rgba)<.5},r$1.prototype.isLight=function(){return H(this.rgba)>=.5},r$1.prototype.toHex=function(){return r$2=o(this.rgba),t$1=r$2.r,e$2=r$2.g,u$1=r$2.b,i$1=(a$1=r$2.a)<1?s(n(255*a$1)):``,`#`+s(t$1)+s(e$2)+s(u$1)+i$1;var r$2,t$1,e$2,u$1,a$1,i$1},r$1.prototype.toRgb=function(){return o(this.rgba)},r$1.prototype.toRgbString=function(){return r$2=o(this.rgba),t$1=r$2.r,n$1=r$2.g,e$2=r$2.b,(u$1=r$2.a)<1?`rgba(`+t$1+`, `+n$1+`, `+e$2+`, `+u$1+`)`:`rgb(`+t$1+`, `+n$1+`, `+e$2+`)`;var r$2,t$1,n$1,e$2,u$1},r$1.prototype.toHsl=function(){return d(c$1(this.rgba))},r$1.prototype.toHslString=function(){return r$2=d(c$1(this.rgba)),t$1=r$2.h,n$1=r$2.s,e$2=r$2.l,(u$1=r$2.a)<1?`hsla(`+t$1+`, `+n$1+`%, `+e$2+`%, `+u$1+`)`:`hsl(`+t$1+`, `+n$1+`%, `+e$2+`%)`;var r$2,t$1,n$1,e$2,u$1},r$1.prototype.toHsv=function(){return r$2=h(this.rgba),{h:n(r$2.h),s:n(r$2.s),v:n(r$2.v),a:n(r$2.a,3)};var r$2},r$1.prototype.invert=function(){return w({r:255-(r$2=this.rgba).r,g:255-r$2.g,b:255-r$2.b,a:r$2.a});var r$2},r$1.prototype.saturate=function(r$2){return r$2===void 0&&(r$2=.1),w(M(this.rgba,r$2))},r$1.prototype.desaturate=function(r$2){return r$2===void 0&&(r$2=.1),w(M(this.rgba,-r$2))},r$1.prototype.grayscale=function(){return w(M(this.rgba,-1))},r$1.prototype.lighten=function(r$2){return r$2===void 0&&(r$2=.1),w($(this.rgba,r$2))},r$1.prototype.darken=function(r$2){return r$2===void 0&&(r$2=.1),w($(this.rgba,-r$2))},r$1.prototype.rotate=function(r$2){return r$2===void 0&&(r$2=15),this.hue(this.hue()+r$2)},r$1.prototype.alpha=function(r$2){return typeof r$2==`number`?w({r:(t$1=this.rgba).r,g:t$1.g,b:t$1.b,a:r$2}):n(this.rgba.a,3);var t$1},r$1.prototype.hue=function(r$2){var t$1=c$1(this.rgba);return typeof r$2==`number`?w({h:r$2,s:t$1.s,l:t$1.l,a:t$1.a}):n(t$1.h)},r$1.prototype.isEqual=function(r$2){return this.toHex()===w(r$2).toHex()},r$1}(),w=function(r$1){return r$1 instanceof j?r$1:new j(r$1)},S=[],k=function(r$1){r$1.forEach(function(r$2){S.indexOf(r$2)<0&&(r$2(j,y),S.push(r$2))})},E=function(){return new j({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};function names_default(e$2,f$1){var a$1={white:`#ffffff`,bisque:`#ffe4c4`,blue:`#0000ff`,cadetblue:`#5f9ea0`,chartreuse:`#7fff00`,chocolate:`#d2691e`,coral:`#ff7f50`,antiquewhite:`#faebd7`,aqua:`#00ffff`,azure:`#f0ffff`,whitesmoke:`#f5f5f5`,papayawhip:`#ffefd5`,plum:`#dda0dd`,blanchedalmond:`#ffebcd`,black:`#000000`,gold:`#ffd700`,goldenrod:`#daa520`,gainsboro:`#dcdcdc`,cornsilk:`#fff8dc`,cornflowerblue:`#6495ed`,burlywood:`#deb887`,aquamarine:`#7fffd4`,beige:`#f5f5dc`,crimson:`#dc143c`,cyan:`#00ffff`,darkblue:`#00008b`,darkcyan:`#008b8b`,darkgoldenrod:`#b8860b`,darkkhaki:`#bdb76b`,darkgray:`#a9a9a9`,darkgreen:`#006400`,darkgrey:`#a9a9a9`,peachpuff:`#ffdab9`,darkmagenta:`#8b008b`,darkred:`#8b0000`,darkorchid:`#9932cc`,darkorange:`#ff8c00`,darkslateblue:`#483d8b`,gray:`#808080`,darkslategray:`#2f4f4f`,darkslategrey:`#2f4f4f`,deeppink:`#ff1493`,deepskyblue:`#00bfff`,wheat:`#f5deb3`,firebrick:`#b22222`,floralwhite:`#fffaf0`,ghostwhite:`#f8f8ff`,darkviolet:`#9400d3`,magenta:`#ff00ff`,green:`#008000`,dodgerblue:`#1e90ff`,grey:`#808080`,honeydew:`#f0fff0`,hotpink:`#ff69b4`,blueviolet:`#8a2be2`,forestgreen:`#228b22`,lawngreen:`#7cfc00`,indianred:`#cd5c5c`,indigo:`#4b0082`,fuchsia:`#ff00ff`,brown:`#a52a2a`,maroon:`#800000`,mediumblue:`#0000cd`,lightcoral:`#f08080`,darkturquoise:`#00ced1`,lightcyan:`#e0ffff`,ivory:`#fffff0`,lightyellow:`#ffffe0`,lightsalmon:`#ffa07a`,lightseagreen:`#20b2aa`,linen:`#faf0e6`,mediumaquamarine:`#66cdaa`,lemonchiffon:`#fffacd`,lime:`#00ff00`,khaki:`#f0e68c`,mediumseagreen:`#3cb371`,limegreen:`#32cd32`,mediumspringgreen:`#00fa9a`,lightskyblue:`#87cefa`,lightblue:`#add8e6`,midnightblue:`#191970`,lightpink:`#ffb6c1`,mistyrose:`#ffe4e1`,moccasin:`#ffe4b5`,mintcream:`#f5fffa`,lightslategray:`#778899`,lightslategrey:`#778899`,navajowhite:`#ffdead`,navy:`#000080`,mediumvioletred:`#c71585`,powderblue:`#b0e0e6`,palegoldenrod:`#eee8aa`,oldlace:`#fdf5e6`,paleturquoise:`#afeeee`,mediumturquoise:`#48d1cc`,mediumorchid:`#ba55d3`,rebeccapurple:`#663399`,lightsteelblue:`#b0c4de`,mediumslateblue:`#7b68ee`,thistle:`#d8bfd8`,tan:`#d2b48c`,orchid:`#da70d6`,mediumpurple:`#9370db`,purple:`#800080`,pink:`#ffc0cb`,skyblue:`#87ceeb`,springgreen:`#00ff7f`,palegreen:`#98fb98`,red:`#ff0000`,yellow:`#ffff00`,slateblue:`#6a5acd`,lavenderblush:`#fff0f5`,peru:`#cd853f`,palevioletred:`#db7093`,violet:`#ee82ee`,teal:`#008080`,slategray:`#708090`,slategrey:`#708090`,aliceblue:`#f0f8ff`,darkseagreen:`#8fbc8f`,darkolivegreen:`#556b2f`,greenyellow:`#adff2f`,seagreen:`#2e8b57`,seashell:`#fff5ee`,tomato:`#ff6347`,silver:`#c0c0c0`,sienna:`#a0522d`,lavender:`#e6e6fa`,lightgreen:`#90ee90`,orange:`#ffa500`,orangered:`#ff4500`,steelblue:`#4682b4`,royalblue:`#4169e1`,turquoise:`#40e0d0`,yellowgreen:`#9acd32`,salmon:`#fa8072`,saddlebrown:`#8b4513`,sandybrown:`#f4a460`,rosybrown:`#bc8f8f`,darksalmon:`#e9967a`,lightgoldenrodyellow:`#fafad2`,snow:`#fffafa`,lightgrey:`#d3d3d3`,lightgray:`#d3d3d3`,dimgray:`#696969`,dimgrey:`#696969`,olivedrab:`#6b8e23`,olive:`#808000`},r$1={};for(var d$1 in a$1)r$1[a$1[d$1]]=d$1;var l$1={};e$2.prototype.toName=function(f$2){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return`transparent`;var d$2,i$1,n$1=r$1[this.toHex()];if(n$1)return n$1;if(f$2?.closest){var o$1=this.toRgb(),t$1=1/0,b$1=`black`;if(!l$1.length)for(var c$2 in a$1)l$1[c$2]=new e$2(a$1[c$2]).toRgb();for(var g$1 in a$1){var u$1=(d$2=o$1,i$1=l$1[g$1],(d$2.r-i$1.r)**2+(d$2.g-i$1.g)**2+(d$2.b-i$1.b)**2);u$1<t$1&&(t$1=u$1,b$1=g$1)}return b$1}},f$1.string.push([function(f$2){var r$2=f$2.toLowerCase(),d$2=r$2===`transparent`?`#0000`:a$1[r$2];return d$2?new e$2(d$2).toRgb():null},`name`])}k([names_default]);var _Color=class _Color$1{constructor(value=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=value}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(value){return this.value=value,this}set value(value){if(value instanceof _Color$1)this._value=this._cloneSource(value._value),this._int=value._int,this._components.set(value._components);else if(value===null)throw Error(`Cannot set Color#value to null`);else (this._value===null||!this._isSourceEqual(this._value,value))&&(this._value=this._cloneSource(value),this._normalize(this._value))}get value(){return this._value}_cloneSource(value){return typeof value==`string`||typeof value==`number`||value instanceof Number||value===null?value:Array.isArray(value)||ArrayBuffer.isView(value)?value.slice(0):typeof value==`object`&&value?{...value}:value}_isSourceEqual(value1,value2){let type1=typeof value1;if(type1!==typeof value2)return!1;if(type1===`number`||type1===`string`||value1 instanceof Number)return value1===value2;if(Array.isArray(value1)&&Array.isArray(value2)||ArrayBuffer.isView(value1)&&ArrayBuffer.isView(value2))return value1.length===value2.length?value1.every((v$1,i$1)=>v$1===value2[i$1]):!1;if(value1!==null&&value2!==null){let keys1=Object.keys(value1),keys2=Object.keys(value2);return keys1.length===keys2.length?keys1.every(key$1=>value1[key$1]===value2[key$1]):!1}return value1===value2}toRgba(){let[r$1,g$1,b$1,a$1]=this._components;return{r:r$1,g:g$1,b:b$1,a:a$1}}toRgb(){let[r$1,g$1,b$1]=this._components;return{r:r$1,g:g$1,b:b$1}}toRgbaString(){let[r$1,g$1,b$1]=this.toUint8RgbArray();return`rgba(${r$1},${g$1},${b$1},${this.alpha})`}toUint8RgbArray(out$2){let[r$1,g$1,b$1]=this._components;return this._arrayRgb||=[],out$2||=this._arrayRgb,out$2[0]=Math.round(r$1*255),out$2[1]=Math.round(g$1*255),out$2[2]=Math.round(b$1*255),out$2}toArray(out$2){this._arrayRgba||=[],out$2||=this._arrayRgba;let[r$1,g$1,b$1,a$1]=this._components;return out$2[0]=r$1,out$2[1]=g$1,out$2[2]=b$1,out$2[3]=a$1,out$2}toRgbArray(out$2){this._arrayRgb||=[],out$2||=this._arrayRgb;let[r$1,g$1,b$1]=this._components;return out$2[0]=r$1,out$2[1]=g$1,out$2[2]=b$1,out$2}toNumber(){return this._int}toBgrNumber(){let[r$1,g$1,b$1]=this.toUint8RgbArray();return(b$1<<16)+(g$1<<8)+r$1}toLittleEndianNumber(){let value=this._int;return(value>>16)+(value&65280)+((value&255)<<16)}multiply(value){let[r$1,g$1,b$1,a$1]=_Color$1._temp.setValue(value)._components;return this._components[0]*=r$1,this._components[1]*=g$1,this._components[2]*=b$1,this._components[3]*=a$1,this._refreshInt(),this._value=null,this}premultiply(alpha,applyToRGB=!0){return applyToRGB&&(this._components[0]*=alpha,this._components[1]*=alpha,this._components[2]*=alpha),this._components[3]=alpha,this._refreshInt(),this._value=null,this}toPremultiplied(alpha,applyToRGB=!0){if(alpha===1)return(255<<24)+this._int;if(alpha===0)return applyToRGB?0:this._int;let r$1=this._int>>16&255,g$1=this._int>>8&255,b$1=this._int&255;return applyToRGB&&(r$1=r$1*alpha+.5|0,g$1=g$1*alpha+.5|0,b$1=b$1*alpha+.5|0),(alpha*255<<24)+(r$1<<16)+(g$1<<8)+b$1}toHex(){let hexString=this._int.toString(16);return`#${`000000`.substring(0,6-hexString.length)+hexString}`}toHexa(){let alphaString=Math.round(this._components[3]*255).toString(16);return this.toHex()+`00`.substring(0,2-alphaString.length)+alphaString}setAlpha(alpha){return this._components[3]=this._clamp(alpha),this}_normalize(value){let r$1,g$1,b$1,a$1;if((typeof value==`number`||value instanceof Number)&&value>=0&&value<=16777215){let int=value;r$1=(int>>16&255)/255,g$1=(int>>8&255)/255,b$1=(int&255)/255,a$1=1}else if((Array.isArray(value)||value instanceof Float32Array)&&value.length>=3&&value.length<=4)value=this._clamp(value),[r$1,g$1,b$1,a$1=1]=value;else if((value instanceof Uint8Array||value instanceof Uint8ClampedArray)&&value.length>=3&&value.length<=4)value=this._clamp(value,0,255),[r$1,g$1,b$1,a$1=255]=value,r$1/=255,g$1/=255,b$1/=255,a$1/=255;else if(typeof value==`string`||typeof value==`object`){if(typeof value==`string`){let match=_Color$1.HEX_PATTERN.exec(value);match&&(value=`#${match[2]}`)}let color$2=w(value);color$2.isValid()&&({r:r$1,g:g$1,b:b$1,a:a$1}=color$2.rgba,r$1/=255,g$1/=255,b$1/=255)}if(r$1!==void 0)this._components[0]=r$1,this._components[1]=g$1,this._components[2]=b$1,this._components[3]=a$1,this._refreshInt();else throw Error(`Unable to convert color ${value}`)}_refreshInt(){this._clamp(this._components);let[r$1,g$1,b$1]=this._components;this._int=(r$1*255<<16)+(g$1*255<<8)+(b$1*255|0)}_clamp(value,min$2=0,max$2=1){return typeof value==`number`?Math.min(Math.max(value,min$2),max$2):(value.forEach((v$1,i$1)=>{value[i$1]=Math.min(Math.max(v$1,min$2),max$2)}),value)}static isColorLike(value){return typeof value==`number`||typeof value==`string`||value instanceof Number||value instanceof _Color$1||Array.isArray(value)||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Float32Array||value.r!==void 0&&value.g!==void 0&&value.b!==void 0||value.r!==void 0&&value.g!==void 0&&value.b!==void 0&&value.a!==void 0||value.h!==void 0&&value.s!==void 0&&value.l!==void 0||value.h!==void 0&&value.s!==void 0&&value.l!==void 0&&value.a!==void 0||value.h!==void 0&&value.s!==void 0&&value.v!==void 0||value.h!==void 0&&value.s!==void 0&&value.v!==void 0&&value.a!==void 0}};_Color.shared=new _Color,_Color._temp=new _Color,_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var Color=_Color,cullingMixin={cullArea:null,cullable:!1,cullableChildren:!0},warnCount=0,maxWarnings=500;function warn$1(...args){warnCount!==maxWarnings&&(warnCount++,warnCount===maxWarnings?console.warn(`PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS.`):console.warn(`PixiJS Warning: `,...args))}var GlobalResourceRegistry={_registeredResources:new Set,register(pool){this._registeredResources.add(pool)},unregister(pool){this._registeredResources.delete(pool)},release(){this._registeredResources.forEach(pool=>pool.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(pool){return this._registeredResources.has(pool)},reset(){this._registeredResources.clear()}},Pool=class{constructor(ClassType,initialSize){this._pool=[],this._count=0,this._index=0,this._classType=ClassType,initialSize&&this.prepopulate(initialSize)}prepopulate(total){for(let i$1=0;i$1<total;i$1++)this._pool[this._index++]=new this._classType;this._count+=total}get(data){let item;return item=this._index>0?this._pool[--this._index]:new this._classType,item.init?.(data),item}return(item){item.reset?.(),this._pool[this._index++]=item}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let i$1=0;i$1<this._index;i$1++)this._pool[i$1].destroy();this._pool.length=0,this._count=0,this._index=0}},BigPool=new class{constructor(){this._poolsByClass=new Map}prepopulate(Class,total){this.getPool(Class).prepopulate(total)}get(Class,data){return this.getPool(Class).get(data)}return(item){this.getPool(item.constructor).return(item)}getPool(ClassType){return this._poolsByClass.has(ClassType)||this._poolsByClass.set(ClassType,new Pool(ClassType)),this._poolsByClass.get(ClassType)}stats(){let stats={};return this._poolsByClass.forEach(pool=>{let name=stats[pool._classType.name]?pool._classType.name+pool._classType.ID:pool._classType.name;stats[name]={free:pool.totalFree,used:pool.totalUsed,size:pool.totalSize}}),stats}clear(){this._poolsByClass.forEach(pool=>pool.clear()),this._poolsByClass.clear()}};GlobalResourceRegistry.register(BigPool);var cacheAsTextureMixin={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(val){typeof val==`boolean`&&val===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(val===!0?{}:val))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(val){deprecation(`v8.6.0`,`cacheAsBitmap is deprecated, use cacheAsTexture instead.`),this.cacheAsTexture(val)}};function removeItems(arr,startIdx,removeCount){let length$1=arr.length,i$1;if(startIdx>=length$1||removeCount===0)return;removeCount=startIdx+removeCount>length$1?length$1-startIdx:removeCount;let len$1=length$1-removeCount;for(i$1=startIdx;i$1<len$1;++i$1)arr[i$1]=arr[i$1+removeCount];arr.length=len$1}var childrenHelperMixin={allowChildren:!0,removeChildren(beginIndex=0,endIndex){let end$1=endIndex??this.children.length,range=end$1-beginIndex,removed=[];if(range>0&&range<=end$1){for(let i$1=end$1-1;i$1>=beginIndex;i$1--){let child=this.children[i$1];child&&(removed.push(child),child.parent=null)}removeItems(this.children,beginIndex,end$1);let renderGroup=this.renderGroup||this.parentRenderGroup;renderGroup&&renderGroup.removeChildren(removed);for(let i$1=0;i$1<removed.length;++i$1){let child=removed[i$1];child.parentRenderLayer?.detach(child),this.emit(`childRemoved`,child,this,i$1),removed[i$1].emit(`removed`,this)}return removed.length>0&&this._didViewChangeTick++,removed}else if(range===0&&this.children.length===0)return removed;throw RangeError(`removeChildren: numeric values are outside the acceptable range.`)},removeChildAt(index){let child=this.getChildAt(index);return this.removeChild(child)},getChildAt(index){if(index<0||index>=this.children.length)throw Error(`getChildAt: Index (${index}) does not exist.`);return this.children[index]},setChildIndex(child,index){if(index<0||index>=this.children.length)throw Error(`The index ${index} supplied is out of bounds ${this.children.length}`);this.getChildIndex(child),this.addChildAt(child,index)},getChildIndex(child){let index=this.children.indexOf(child);if(index===-1)throw Error(`The supplied Container must be a child of the caller`);return index},addChildAt(child,index){this.allowChildren||deprecation(v8_0_0,`addChildAt: Only Containers will be allowed to add children in v8.0.0`);let{children}=this;if(index<0||index>children.length)throw Error(`${child}addChildAt: The index ${index} supplied is out of bounds ${children.length}`);if(child.parent){let currentIndex=child.parent.children.indexOf(child);if(child.parent===this&&currentIndex===index)return child;currentIndex!==-1&&child.parent.children.splice(currentIndex,1)}index===children.length?children.push(child):children.splice(index,0,child),child.parent=this,child.didChange=!0,child._updateFlags=15;let renderGroup=this.renderGroup||this.parentRenderGroup;return renderGroup&&renderGroup.addChild(child),this.sortableChildren&&(this.sortDirty=!0),this.emit(`childAdded`,child,this,index),child.emit(`added`,this),child},swapChildren(child,child2){if(child===child2)return;let index1=this.getChildIndex(child),index2=this.getChildIndex(child2);this.children[index1]=child2,this.children[index2]=child;let renderGroup=this.renderGroup||this.parentRenderGroup;renderGroup&&(renderGroup.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...child){return child.length===1?this.reparentChildAt(child[0],this.children.length):(child.forEach(c$2=>this.reparentChildAt(c$2,this.children.length)),child[0])},reparentChildAt(child,index){if(child.parent===this)return this.setChildIndex(child,index),child;let childMat=child.worldTransform.clone();child.removeFromParent(),this.addChildAt(child,index);let newMatrix=this.worldTransform.clone();return newMatrix.invert(),childMat.prepend(newMatrix),child.setFromMatrix(childMat),child},replaceChild(oldChild,newChild){oldChild.updateLocalTransform(),this.addChildAt(newChild,this.getChildIndex(oldChild)),newChild.setFromMatrix(oldChild.localTransform),newChild.updateLocalTransform(),this.removeChild(oldChild)}},collectRenderablesMixin={collectRenderables(instructionSet,renderer$1,currentLayer){this.parentRenderLayer&&this.parentRenderLayer!==currentLayer||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(instructionSet,renderer$1,currentLayer):this.renderGroup?renderer$1.renderPipes.renderGroup.addRenderGroup(this.renderGroup,instructionSet):this.collectRenderablesWithEffects(instructionSet,renderer$1,currentLayer))},collectRenderablesSimple(instructionSet,renderer$1,currentLayer){let children=this.children,length$1=children.length;for(let i$1=0;i$1<length$1;i$1++)children[i$1].collectRenderables(instructionSet,renderer$1,currentLayer)},collectRenderablesWithEffects(instructionSet,renderer$1,currentLayer){let{renderPipes:renderPipes$2}=renderer$1;for(let i$1=0;i$1<this.effects.length;i$1++){let effect$1=this.effects[i$1];renderPipes$2[effect$1.pipe].push(effect$1,this,instructionSet)}this.collectRenderablesSimple(instructionSet,renderer$1,currentLayer);for(let i$1=this.effects.length-1;i$1>=0;i$1--){let effect$1=this.effects[i$1];renderPipes$2[effect$1.pipe].pop(effect$1,this,instructionSet)}}},FilterEffect=class{constructor(){this.pipe=`filter`,this.priority=1}destroy(){for(let i$1=0;i$1<this.filters.length;i$1++)this.filters[i$1].destroy();this.filters=null,this.filterArea=null}},MaskEffectManager=new class{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(test=>{this.add({test:test.test,maskClass:test})}))}add(test){this._tests.push(test)}getMaskEffect(item){this._initialized||this.init();for(let i$1=0;i$1<this._tests.length;i$1++){let test=this._tests[i$1];if(test.test(item))return BigPool.get(test.maskClass,item)}return item}returnMaskEffect(effect$1){BigPool.return(effect$1)}};extensions$1.handleByList(ExtensionType.MaskEffect,MaskEffectManager._effectClasses);var effectsMixin={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){let renderGroup=this.renderGroup||this.parentRenderGroup;renderGroup&&(renderGroup.structureDidChange=!0)},addEffect(effect$1){this.effects.indexOf(effect$1)===-1&&(this.effects.push(effect$1),this.effects.sort((a$1,b$1)=>a$1.priority-b$1.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(effect$1){let index=this.effects.indexOf(effect$1);index!==-1&&(this.effects.splice(index,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(value){let effect$1=this._maskEffect;effect$1?.mask!==value&&(effect$1&&(this.removeEffect(effect$1),MaskEffectManager.returnMaskEffect(effect$1),this._maskEffect=null),value!=null&&(this._maskEffect=MaskEffectManager.getMaskEffect(value),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(options){this._maskOptions={...this._maskOptions,...options},options.mask&&(this.mask=options.mask),this._markStructureAsChanged()},set filters(value){!Array.isArray(value)&&value&&(value=[value]);let effect$1=this._filterEffect||=new FilterEffect;value=value;let hasFilters=value?.length>0,hadFilters=effect$1.filters?.length>0,didChange=hasFilters!==hadFilters;value=Array.isArray(value)?value.slice(0):value,effect$1.filters=Object.freeze(value),didChange&&(hasFilters?this.addEffect(effect$1):(this.removeEffect(effect$1),effect$1.filters=value??null))},get filters(){return this._filterEffect?.filters},set filterArea(value){this._filterEffect||=new FilterEffect,this._filterEffect.filterArea=value},get filterArea(){return this._filterEffect?.filterArea}},findMixin={label:null,get name(){return deprecation(v8_0_0,`Container.name property has been removed, use Container.label instead`),this.label},set name(value){deprecation(v8_0_0,`Container.name property has been removed, use Container.label instead`),this.label=value},getChildByName(name,deep=!1){return this.getChildByLabel(name,deep)},getChildByLabel(label,deep=!1){let children=this.children;for(let i$1=0;i$1<children.length;i$1++){let child=children[i$1];if(child.label===label||label instanceof RegExp&&label.test(child.label))return child}if(deep)for(let i$1=0;i$1<children.length;i$1++){let found=children[i$1].getChildByLabel(label,!0);if(found)return found}return null},getChildrenByLabel(label,deep=!1,out$2=[]){let children=this.children;for(let i$1=0;i$1<children.length;i$1++){let child=children[i$1];(child.label===label||label instanceof RegExp&&label.test(child.label))&&out$2.push(child)}if(deep)for(let i$1=0;i$1<children.length;i$1++)children[i$1].getChildrenByLabel(label,!0,out$2);return out$2}},matrixPool=BigPool.getPool(Matrix),boundsPool=BigPool.getPool(Bounds),tempMatrix$4=new Matrix,getFastGlobalBoundsMixin={getFastGlobalBounds(factorRenderLayers,bounds){bounds||=new Bounds,bounds.clear(),this._getGlobalBoundsRecursive(!!factorRenderLayers,bounds,this.parentRenderLayer),bounds.isValid||bounds.set(0,0,0,0);let renderGroup=this.renderGroup||this.parentRenderGroup;return bounds.applyMatrix(renderGroup.worldTransform),bounds},_getGlobalBoundsRecursive(factorRenderLayers,bounds,currentLayer){let localBounds=bounds;if(factorRenderLayers&&this.parentRenderLayer&&this.parentRenderLayer!==currentLayer||this.localDisplayStatus!==7||!this.measurable)return;let manageEffects=!!this.effects.length;if((this.renderGroup||manageEffects)&&(localBounds=boundsPool.get().clear()),this.boundsArea)bounds.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){let viewBounds=this.bounds;localBounds.addFrame(viewBounds.minX,viewBounds.minY,viewBounds.maxX,viewBounds.maxY,this.groupTransform)}let children=this.children;for(let i$1=0;i$1<children.length;i$1++)children[i$1]._getGlobalBoundsRecursive(factorRenderLayers,localBounds,currentLayer)}if(manageEffects){let advanced=!1,renderGroup=this.renderGroup||this.parentRenderGroup;for(let i$1=0;i$1<this.effects.length;i$1++)this.effects[i$1].addBounds&&(advanced||(advanced=!0,localBounds.applyMatrix(renderGroup.worldTransform)),this.effects[i$1].addBounds(localBounds,!0));advanced&&localBounds.applyMatrix(renderGroup.worldTransform.copyTo(tempMatrix$4).invert()),bounds.addBounds(localBounds),boundsPool.return(localBounds)}else this.renderGroup&&(bounds.addBounds(localBounds,this.relativeGroupTransform),boundsPool.return(localBounds))}};function getGlobalBounds(target,skipUpdateTransform,bounds){bounds.clear();let parentTransform,pooledMatrix;return target.parent?skipUpdateTransform?parentTransform=target.parent.worldTransform:(pooledMatrix=matrixPool.get().identity(),parentTransform=updateTransformBackwards(target,pooledMatrix)):parentTransform=Matrix.IDENTITY,_getGlobalBounds(target,bounds,parentTransform,skipUpdateTransform),pooledMatrix&&matrixPool.return(pooledMatrix),bounds.isValid||bounds.set(0,0,0,0),bounds}function _getGlobalBounds(target,bounds,parentTransform,skipUpdateTransform){if(!target.visible||!target.measurable)return;let worldTransform;skipUpdateTransform?worldTransform=target.worldTransform:(target.updateLocalTransform(),worldTransform=matrixPool.get(),worldTransform.appendFrom(target.localTransform,parentTransform));let parentBounds=bounds,preserveBounds=!!target.effects.length;if(preserveBounds&&(bounds=boundsPool.get().clear()),target.boundsArea)bounds.addRect(target.boundsArea,worldTransform);else{let renderableBounds=target.bounds;renderableBounds&&!renderableBounds.isEmpty()&&(bounds.matrix=worldTransform,bounds.addBounds(renderableBounds));for(let i$1=0;i$1<target.children.length;i$1++)_getGlobalBounds(target.children[i$1],bounds,worldTransform,skipUpdateTransform)}if(preserveBounds){for(let i$1=0;i$1<target.effects.length;i$1++)target.effects[i$1].addBounds?.(bounds);parentBounds.addBounds(bounds,Matrix.IDENTITY),boundsPool.return(bounds)}skipUpdateTransform||matrixPool.return(worldTransform)}function updateTransformBackwards(target,parentTransform){let parent=target.parent;return parent&&(updateTransformBackwards(parent,parentTransform),parent.updateLocalTransform(),parentTransform.append(parent.localTransform)),parentTransform}function multiplyHexColors(color1,color2){if(color1===16777215||!color2)return color2;if(color2===16777215||!color1)return color1;let r1=color1>>16&255,g1=color1>>8&255,b1=color1&255,r2=color2>>16&255,g2=color2>>8&255,b2=color2&255,r$1=r1*r2/255|0,g$1=g1*g2/255|0,b$1=b1*b2/255|0;return(r$1<<16)+(g$1<<8)+b$1}var WHITE_BGR=16777215;function multiplyColors(localBGRColor,parentBGRColor){return localBGRColor===WHITE_BGR?parentBGRColor:parentBGRColor===WHITE_BGR?localBGRColor:multiplyHexColors(localBGRColor,parentBGRColor)}function bgr2rgb(color$2){return((color$2&255)<<16)+(color$2&65280)+(color$2>>16&255)}var getGlobalMixin={getGlobalAlpha(skipUpdate){if(skipUpdate)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let alpha=this.alpha,current=this.parent;for(;current;)alpha*=current.alpha,current=current.parent;return alpha},getGlobalTransform(matrix=new Matrix,skipUpdate){if(skipUpdate)return matrix.copyFrom(this.worldTransform);this.updateLocalTransform();let parentTransform=updateTransformBackwards(this,matrixPool.get().identity());return matrix.appendFrom(this.localTransform,parentTransform),matrixPool.return(parentTransform),matrix},getGlobalTint(skipUpdate){if(skipUpdate)return this.renderGroup?bgr2rgb(this.renderGroup.worldColor):this.parentRenderGroup?bgr2rgb(multiplyColors(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let color$2=this.localColor,parent=this.parent;for(;parent;)color$2=multiplyColors(color$2,parent.localColor),parent=parent.parent;return bgr2rgb(color$2)}};function getLocalBounds(target,bounds,relativeMatrix){return bounds.clear(),relativeMatrix||=Matrix.IDENTITY,_getLocalBounds(target,bounds,relativeMatrix,target,!0),bounds.isValid||bounds.set(0,0,0,0),bounds}function _getLocalBounds(target,bounds,parentTransform,rootContainer,isRoot){let relativeTransform;if(isRoot)relativeTransform=matrixPool.get(),relativeTransform=parentTransform.copyTo(relativeTransform);else{if(!target.visible||!target.measurable)return;target.updateLocalTransform();let localTransform=target.localTransform;relativeTransform=matrixPool.get(),relativeTransform.appendFrom(localTransform,parentTransform)}let parentBounds=bounds,preserveBounds=!!target.effects.length;if(preserveBounds&&(bounds=boundsPool.get().clear()),target.boundsArea)bounds.addRect(target.boundsArea,relativeTransform);else{target.renderPipeId&&(bounds.matrix=relativeTransform,bounds.addBounds(target.bounds));let children=target.children;for(let i$1=0;i$1<children.length;i$1++)_getLocalBounds(children[i$1],bounds,relativeTransform,rootContainer,!1)}if(preserveBounds){for(let i$1=0;i$1<target.effects.length;i$1++)target.effects[i$1].addLocalBounds?.(bounds,rootContainer);parentBounds.addBounds(bounds,Matrix.IDENTITY),boundsPool.return(bounds)}matrixPool.return(relativeTransform)}function checkChildrenDidChange(container,previousData){let children=container.children;for(let i$1=0;i$1<children.length;i$1++){let child=children[i$1],uid$3=child.uid,didChange=(child._didViewChangeTick&65535)<<16|child._didContainerChangeTick&65535,index=previousData.index;(previousData.data[index]!==uid$3||previousData.data[index+1]!==didChange)&&(previousData.data[previousData.index]=uid$3,previousData.data[previousData.index+1]=didChange,previousData.didChange=!0),previousData.index=index+2,child.children.length&&checkChildrenDidChange(child,previousData)}return previousData.didChange}var tempMatrix$3=new Matrix,measureMixin={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(value,localWidth){let sign$1=Math.sign(this.scale.x)||1;localWidth===0?this.scale.x=sign$1:this.scale.x=value/localWidth*sign$1},_setHeight(value,localHeight){let sign$1=Math.sign(this.scale.y)||1;localHeight===0?this.scale.y=sign$1:this.scale.y=value/localHeight*sign$1},getLocalBounds(){this._localBoundsCacheData||={data:[],index:1,didChange:!1,localBounds:new Bounds};let localBoundsCacheData=this._localBoundsCacheData;return localBoundsCacheData.index=1,localBoundsCacheData.didChange=!1,localBoundsCacheData.data[0]!==this._didViewChangeTick&&(localBoundsCacheData.didChange=!0,localBoundsCacheData.data[0]=this._didViewChangeTick),checkChildrenDidChange(this,localBoundsCacheData),localBoundsCacheData.didChange&&getLocalBounds(this,localBoundsCacheData.localBounds,tempMatrix$3),localBoundsCacheData.localBounds},getBounds(skipUpdate,bounds){return getGlobalBounds(this,skipUpdate,bounds||new Bounds)}},onRenderMixin={_onRender:null,set onRender(func){let renderGroup=this.renderGroup||this.parentRenderGroup;if(!func){this._onRender&&renderGroup?.removeOnRender(this),this._onRender=null;return}this._onRender||renderGroup?.addOnRender(this),this._onRender=func},get onRender(){return this._onRender}},sortMixin={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(value){this._zIndex!==value&&(this._zIndex=value,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(sortChildren))}};function sortChildren(a$1,b$1){return a$1._zIndex-b$1._zIndex}var toLocalGlobalMixin={getGlobalPosition(point=new Point$1,skipUpdate=!1){return this.parent?this.parent.toGlobal(this._position,point,skipUpdate):(point.x=this._position.x,point.y=this._position.y),point},toGlobal(position,point,skipUpdate=!1){let globalMatrix=this.getGlobalTransform(matrixPool.get(),skipUpdate);return point=globalMatrix.apply(position,point),matrixPool.return(globalMatrix),point},toLocal(position,from,point,skipUpdate){from&&(position=from.toGlobal(position,point,skipUpdate));let globalMatrix=this.getGlobalTransform(matrixPool.get(),skipUpdate);return point=globalMatrix.applyInverse(position,point),matrixPool.return(globalMatrix),point}},InstructionSet=class{constructor(){this.uid=uid$1(`instructionSet`),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(instruction){this.instructions[this.instructionSize++]=instruction}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,[`type`,`action`])}},count=0,TexturePool=new class{constructor(textureOptions){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=textureOptions||{},this.enableFullScreen=!1,this.textureStyle=new TextureStyle(this.textureOptions)}createTexture(pixelWidth,pixelHeight,antialias){let textureSource=new TextureSource({...this.textureOptions,width:pixelWidth,height:pixelHeight,resolution:1,antialias,autoGarbageCollect:!1});return new Texture({source:textureSource,label:`texturePool_${count++}`})}getOptimalTexture(frameWidth,frameHeight,resolution=1,antialias){let po2Width=Math.ceil(frameWidth*resolution-1e-6),po2Height=Math.ceil(frameHeight*resolution-1e-6);po2Width=nextPow2(po2Width),po2Height=nextPow2(po2Height);let key$1=(po2Width<<17)+(po2Height<<1)+(antialias?1:0);this._texturePool[key$1]||(this._texturePool[key$1]=[]);let texture=this._texturePool[key$1].pop();return texture||=this.createTexture(po2Width,po2Height,antialias),texture.source._resolution=resolution,texture.source.width=po2Width/resolution,texture.source.height=po2Height/resolution,texture.source.pixelWidth=po2Width,texture.source.pixelHeight=po2Height,texture.frame.x=0,texture.frame.y=0,texture.frame.width=frameWidth,texture.frame.height=frameHeight,texture.updateUvs(),this._poolKeyHash[texture.uid]=key$1,texture}getSameSizeTexture(texture,antialias=!1){let source$2=texture.source;return this.getOptimalTexture(texture.width,texture.height,source$2._resolution,antialias)}returnTexture(renderTexture,resetStyle=!1){let key$1=this._poolKeyHash[renderTexture.uid];resetStyle&&(renderTexture.source.style=this.textureStyle),this._texturePool[key$1].push(renderTexture)}clear(destroyTextures){if(destroyTextures=destroyTextures!==!1,destroyTextures)for(let i$1 in this._texturePool){let textures=this._texturePool[i$1];if(textures)for(let j$1=0;j$1<textures.length;j$1++)textures[j$1].destroy(!0)}this._texturePool={}}};GlobalResourceRegistry.register(TexturePool);var RenderGroup=class{constructor(){this.renderPipeId=`renderGroup`,this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Matrix,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new InstructionSet,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(root){this.root=root,root._onRender&&this.addOnRender(root),root.didChange=!0;let children=root.children;for(let i$1=0;i$1<children.length;i$1++){let child=children[i$1];child._updateFlags=15,this.addChild(child)}}enableCacheAsTexture(options={}){this.textureOptions=options,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&=(TexturePool.returnTexture(this.texture,!0),null)}updateCacheTexture(){this.textureNeedsUpdate=!0;let cachedParent=this._parentCacheAsTextureRenderGroup;cachedParent&&!cachedParent.textureNeedsUpdate&&cachedParent.updateCacheTexture()}reset(){for(let i$1 in this.renderGroupChildren.length=0,this.childrenToUpdate){let childrenAtDepth=this.childrenToUpdate[i$1];childrenAtDepth.list.fill(null),childrenAtDepth.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(renderGroupChild){renderGroupChild.renderGroupParent&&renderGroupChild.renderGroupParent._removeRenderGroupChild(renderGroupChild),renderGroupChild.renderGroupParent=this,this.renderGroupChildren.push(renderGroupChild)}_removeRenderGroupChild(renderGroupChild){let index=this.renderGroupChildren.indexOf(renderGroupChild);index>-1&&this.renderGroupChildren.splice(index,1),renderGroupChild.renderGroupParent=null}addChild(child){if(this.structureDidChange=!0,child.parentRenderGroup=this,child.updateTick=-1,child.parent===this.root?child.relativeRenderGroupDepth=1:child.relativeRenderGroupDepth=child.parent.relativeRenderGroupDepth+1,child.didChange=!0,this.onChildUpdate(child),child.renderGroup){this.addRenderGroupChild(child.renderGroup);return}child._onRender&&this.addOnRender(child);let children=child.children;for(let i$1=0;i$1<children.length;i$1++)this.addChild(children[i$1])}removeChild(child){if(this.structureDidChange=!0,child._onRender&&(child.renderGroup||this.removeOnRender(child)),child.parentRenderGroup=null,child.renderGroup){this._removeRenderGroupChild(child.renderGroup);return}let children=child.children;for(let i$1=0;i$1<children.length;i$1++)this.removeChild(children[i$1])}removeChildren(children){for(let i$1=0;i$1<children.length;i$1++)this.removeChild(children[i$1])}onChildUpdate(child){let childrenToUpdate=this.childrenToUpdate[child.relativeRenderGroupDepth];childrenToUpdate||=this.childrenToUpdate[child.relativeRenderGroupDepth]={index:0,list:[]},childrenToUpdate.list[childrenToUpdate.index++]=child}updateRenderable(renderable){renderable.globalDisplayStatus<7||(this.instructionSet.renderPipes[renderable.renderPipeId].updateRenderable(renderable),renderable.didViewUpdate=!1)}onChildViewUpdate(child){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=child}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(container){this._onRenderContainers.push(container)}removeOnRender(container){this._onRenderContainers.splice(this._onRenderContainers.indexOf(container),1)}runOnRender(renderer$1){for(let i$1=0;i$1<this._onRenderContainers.length;i$1++)this._onRenderContainers[i$1]._onRender(renderer$1)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(out$2=[]){let children=this.root.children;for(let i$1=0;i$1<children.length;i$1++)this._getChildren(children[i$1],out$2);return out$2}_getChildren(container,out$2=[]){if(out$2.push(container),container.renderGroup)return out$2;let children=container.children;for(let i$1=0;i$1<children.length;i$1++)this._getChildren(children[i$1],out$2);return out$2}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return this._matrixDirty&1?(this._matrixDirty&=-2,this._inverseWorldTransform||=new Matrix,this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return this._matrixDirty&2?(this._matrixDirty&=-3,this._textureOffsetInverseTransform||=new Matrix,this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(this._matrixDirty&4))return this._inverseParentTextureTransform;this._matrixDirty&=-5;let parentCacheAsTexture=this._parentCacheAsTextureRenderGroup;return parentCacheAsTexture?(this._inverseParentTextureTransform||=new Matrix,this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(parentCacheAsTexture.inverseWorldTransform).translate(-parentCacheAsTexture._textureBounds.x,-parentCacheAsTexture._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}};function assignWithIgnore(target,options,ignore={}){for(let key$1 in options)!ignore[key$1]&&options[key$1]!==void 0&&(target[key$1]=options[key$1])}var defaultSkew=new ObservablePoint(null),defaultPivot=new ObservablePoint(null),defaultScale=new ObservablePoint(null,1,1),defaultOrigin=new ObservablePoint(null),UPDATE_COLOR=1,UPDATE_BLEND=2,UPDATE_VISIBLE=4,Container=class Container extends eventemitter3_default{constructor(options={}){super(),this.uid=uid$1(`renderable`),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new Matrix,this.relativeGroupTransform=new Matrix,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ObservablePoint(this,0,0),this._scale=defaultScale,this._pivot=defaultPivot,this._origin=defaultOrigin,this._skew=defaultSkew,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode=`inherit`,this.groupBlendMode=`normal`,this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],assignWithIgnore(this,options,{children:!0,parent:!0,effects:!0}),options.children?.forEach(child=>this.addChild(child)),options.parent?.addChild(this)}static mixin(source$2){deprecation(`8.8.0`,`Container.mixin is deprecated, please use extensions.mixin instead.`),extensions$1.mixin(Container,source$2)}set _didChangeId(value){this._didViewChangeTick=value>>12&4095,this._didContainerChangeTick=value&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...children){if(this.allowChildren||deprecation(v8_0_0,`addChild: Only Containers will be allowed to add children in v8.0.0`),children.length>1){for(let i$1=0;i$1<children.length;i$1++)this.addChild(children[i$1]);return children[0]}let child=children[0],renderGroup=this.renderGroup||this.parentRenderGroup;return child.parent===this?(this.children.splice(this.children.indexOf(child),1),this.children.push(child),renderGroup&&(renderGroup.structureDidChange=!0),child):(child.parent&&child.parent.removeChild(child),this.children.push(child),this.sortableChildren&&(this.sortDirty=!0),child.parent=this,child.didChange=!0,child._updateFlags=15,renderGroup&&renderGroup.addChild(child),this.emit(`childAdded`,child,this,this.children.length-1),child.emit(`added`,this),this._didViewChangeTick++,child._zIndex!==0&&child.depthOfChildModified(),child)}removeChild(...children){if(children.length>1){for(let i$1=0;i$1<children.length;i$1++)this.removeChild(children[i$1]);return children[0]}let child=children[0],index=this.children.indexOf(child);return index>-1&&(this._didViewChangeTick++,this.children.splice(index,1),this.renderGroup?this.renderGroup.removeChild(child):this.parentRenderGroup&&this.parentRenderGroup.removeChild(child),child.parentRenderLayer&&child.parentRenderLayer.detach(child),child.parent=null,this.emit(`childRemoved`,child,this,index),child.emit(`removed`,this)),child}_onUpdate(point){point&&point===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(value){!!this.renderGroup!==value&&(value?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;let parentRenderGroup=this.parentRenderGroup;parentRenderGroup?.removeChild(this),this.renderGroup=BigPool.get(RenderGroup,this),this.groupTransform=Matrix.IDENTITY,parentRenderGroup?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;let parentRenderGroup=this.parentRenderGroup;parentRenderGroup?.removeChild(this),BigPool.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,parentRenderGroup?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||=new Matrix,this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(value){this._position.x=value}get y(){return this._position.y}set y(value){this._position.y=value}get position(){return this._position}set position(value){this._position.copyFrom(value)}get rotation(){return this._rotation}set rotation(value){this._rotation!==value&&(this._rotation=value,this._onUpdate(this._skew))}get angle(){return this.rotation*RAD_TO_DEG}set angle(value){this.rotation=value*DEG_TO_RAD}get pivot(){return this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0)),this._pivot}set pivot(value){this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0),this._origin!==defaultOrigin&&warn$1(`Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.`)),typeof value==`number`?this._pivot.set(value):this._pivot.copyFrom(value)}get skew(){return this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew}set skew(value){this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew.copyFrom(value)}get scale(){return this._scale===defaultScale&&(this._scale=new ObservablePoint(this,1,1)),this._scale}set scale(value){this._scale===defaultScale&&(this._scale=new ObservablePoint(this,0,0)),typeof value==`string`&&(value=parseFloat(value)),typeof value==`number`?this._scale.set(value):this._scale.copyFrom(value)}get origin(){return this._origin===defaultOrigin&&(this._origin=new ObservablePoint(this,0,0)),this._origin}set origin(value){this._origin===defaultOrigin&&(this._origin=new ObservablePoint(this,0,0),this._pivot!==defaultPivot&&warn$1(`Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.`)),typeof value==`number`?this._origin.set(value):this._origin.copyFrom(value)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(value){let localWidth=this.getLocalBounds().width;this._setWidth(value,localWidth)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(value){let localHeight=this.getLocalBounds().height;this._setHeight(value,localHeight)}getSize(out$2){out$2||={};let bounds=this.getLocalBounds();return out$2.width=Math.abs(this.scale.x*bounds.width),out$2.height=Math.abs(this.scale.y*bounds.height),out$2}setSize(value,height){let size=this.getLocalBounds();typeof value==`object`?(height=value.height??value.width,value=value.width):height??=value,value!==void 0&&this._setWidth(value,size.width),height!==void 0&&this._setHeight(height,size.height)}_updateSkew(){let rotation=this._rotation,skew=this._skew;this._cx=Math.cos(rotation+skew._y),this._sx=Math.sin(rotation+skew._y),this._cy=-Math.sin(rotation-skew._x),this._sy=Math.cos(rotation-skew._x)}updateTransform(opts){return this.position.set(typeof opts.x==`number`?opts.x:this.position.x,typeof opts.y==`number`?opts.y:this.position.y),this.scale.set(typeof opts.scaleX==`number`?opts.scaleX||1:this.scale.x,typeof opts.scaleY==`number`?opts.scaleY||1:this.scale.y),this.rotation=typeof opts.rotation==`number`?opts.rotation:this.rotation,this.skew.set(typeof opts.skewX==`number`?opts.skewX:this.skew.x,typeof opts.skewY==`number`?opts.skewY:this.skew.y),this.pivot.set(typeof opts.pivotX==`number`?opts.pivotX:this.pivot.x,typeof opts.pivotY==`number`?opts.pivotY:this.pivot.y),this.origin.set(typeof opts.originX==`number`?opts.originX:this.origin.x,typeof opts.originY==`number`?opts.originY:this.origin.y),this}setFromMatrix(matrix){matrix.decompose(this)}updateLocalTransform(){let localTransformChangeId=this._didContainerChangeTick;if(this._didLocalTransformChangeId===localTransformChangeId)return;this._didLocalTransformChangeId=localTransformChangeId;let lt$1=this.localTransform,scale$3=this._scale,pivot=this._pivot,origin=this._origin,position=this._position,sx=scale$3._x,sy=scale$3._y,px=pivot._x,py=pivot._y,ox=-origin._x,oy=-origin._y;lt$1.a=this._cx*sx,lt$1.b=this._sx*sx,lt$1.c=this._cy*sy,lt$1.d=this._sy*sy,lt$1.tx=position._x-(px*lt$1.a+py*lt$1.c)+(ox*lt$1.a+oy*lt$1.c)-ox,lt$1.ty=position._y-(px*lt$1.b+py*lt$1.d)+(ox*lt$1.b+oy*lt$1.d)-oy}set alpha(value){value!==this.localAlpha&&(this.localAlpha=value,this._updateFlags|=1,this._onUpdate())}get alpha(){return this.localAlpha}set tint(value){let bgr=Color.shared.setValue(value??16777215).toBgrNumber();bgr!==this.localColor&&(this.localColor=bgr,this._updateFlags|=1,this._onUpdate())}get tint(){return bgr2rgb(this.localColor)}set blendMode(value){this.localBlendMode!==value&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=2,this.localBlendMode=value,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(value){let valueNumber=value?2:0;(this.localDisplayStatus&2)!==valueNumber&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=4,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(value){let valueNumber=value?0:4;(this.localDisplayStatus&4)!==valueNumber&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=4,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(value){let valueNumber=value?1:0;(this.localDisplayStatus&1)!==valueNumber&&(this._updateFlags|=4,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(options=!1){if(this.destroyed)return;this.destroyed=!0;let oldChildren;if(this.children.length&&(oldChildren=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit(`destroyed`,this),this.removeAllListeners(),(typeof options==`boolean`?options:options?.children)&&oldChildren)for(let i$1=0;i$1<oldChildren.length;++i$1)oldChildren[i$1].destroy(options);this.renderGroup?.destroy(),this.renderGroup=null}};extensions$1.mixin(Container,childrenHelperMixin,getFastGlobalBoundsMixin,toLocalGlobalMixin,onRenderMixin,measureMixin,effectsMixin,findMixin,sortMixin,cullingMixin,cacheAsTextureMixin,getGlobalMixin,collectRenderablesMixin);var ViewContainer=class extends Container{constructor(options){super(options),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Bounds(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(value){this._roundPixels=value?1:0}containsPoint(point){let bounds=this.bounds,{x:x$1,y:y$1}=point;return x$1>=bounds.minX&&x$1<=bounds.maxX&&y$1>=bounds.minY&&y$1<=bounds.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;let renderGroup=this.renderGroup||this.parentRenderGroup;renderGroup&&renderGroup.onChildViewUpdate(this)}destroy(options){for(let key$1 in super.destroy(options),this._bounds=null,this._gpuData)this._gpuData[key$1].destroy?.();this._gpuData=null}collectRenderablesSimple(instructionSet,renderer$1,currentLayer){let{renderPipes:renderPipes$2}=renderer$1;renderPipes$2.blendMode.pushBlendMode(this,this.groupBlendMode,instructionSet),renderPipes$2[this.renderPipeId].addRenderable(this,instructionSet),this.didViewUpdate=!1;let children=this.children,length$1=children.length;for(let i$1=0;i$1<length$1;i$1++)children[i$1].collectRenderables(instructionSet,renderer$1,currentLayer);renderPipes$2.blendMode.popBlendMode(instructionSet)}},Sprite=class Sprite extends ViewContainer{constructor(options=Texture.EMPTY){options instanceof Texture&&(options={texture:options});let{texture=Texture.EMPTY,anchor,roundPixels,width,height,...rest}=options;super({label:`Sprite`,...rest}),this.renderPipeId=`sprite`,this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),anchor?this.anchor=anchor:texture.defaultAnchor&&(this.anchor=texture.defaultAnchor),this.texture=texture,this.allowChildren=!1,this.roundPixels=roundPixels??!1,width!==void 0&&(this.width=width),height!==void 0&&(this.height=height)}static from(source$2,skipCache=!1){return source$2 instanceof Texture?new Sprite(source$2):new Sprite(Texture.from(source$2,skipCache))}set texture(value){value||=Texture.EMPTY;let currentTexture=this._texture;currentTexture!==value&&(currentTexture&&currentTexture.dynamic&&currentTexture.off(`update`,this.onViewUpdate,this),value.dynamic&&value.on(`update`,this.onViewUpdate,this),this._texture=value,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return updateQuadBounds(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return deprecation(`8.6.1`,`Sprite.sourceBounds is deprecated, use visualBounds instead.`),this.visualBounds}updateBounds(){let anchor=this._anchor,texture=this._texture,bounds=this._bounds,{width,height}=texture.orig;bounds.minX=-anchor._x*width,bounds.maxX=bounds.minX+width,bounds.minY=-anchor._y*height,bounds.maxY=bounds.minY+height}destroy(options=!1){if(super.destroy(options),typeof options==`boolean`?options:options?.texture){let destroyTextureSource=typeof options==`boolean`?options:options?.textureSource;this._texture.destroy(destroyTextureSource)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(value){typeof value==`number`?this._anchor.set(value):this._anchor.copyFrom(value)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(value){this._setWidth(value,this._texture.orig.width),this._width=value}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(value){this._setHeight(value,this._texture.orig.height),this._height=value}getSize(out$2){return out$2||={},out$2.width=Math.abs(this.scale.x)*this._texture.orig.width,out$2.height=Math.abs(this.scale.y)*this._texture.orig.height,out$2}setSize(value,height){typeof value==`object`?(height=value.height??value.width,value=value.width):height??=value,value!==void 0&&this._setWidth(value,this._texture.orig.width),height!==void 0&&this._setHeight(height,this._texture.orig.height)}},tempBounds$3=new Bounds;function addMaskBounds(mask,bounds,skipUpdateTransform){let boundsToMask=tempBounds$3;mask.measurable=!0,getGlobalBounds(mask,skipUpdateTransform,boundsToMask),bounds.addBoundsMask(boundsToMask),mask.measurable=!1}function addMaskLocalBounds(mask,bounds,localRoot){let boundsToMask=boundsPool.get();mask.measurable=!0;let tempMatrix$6=matrixPool.get().identity(),relativeMask=getMatrixRelativeToParent(mask,localRoot,tempMatrix$6);getLocalBounds(mask,boundsToMask,relativeMask),mask.measurable=!1,bounds.addBoundsMask(boundsToMask),matrixPool.return(tempMatrix$6),boundsPool.return(boundsToMask)}function getMatrixRelativeToParent(target,root,matrix){return target?(target!==root&&(getMatrixRelativeToParent(target.parent,root,matrix),target.updateLocalTransform(),matrix.append(target.localTransform)),matrix):(warn$1(`Mask bounds, renderable is not inside the root container`),matrix)}var AlphaMask=class{constructor(options){this.priority=0,this.inverse=!1,this.pipe=`alphaMask`,options?.mask&&this.init(options.mask)}init(mask){this.mask=mask,this.renderMaskToTexture=!(mask instanceof Sprite),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(bounds,skipUpdateTransform){this.inverse||addMaskBounds(this.mask,bounds,skipUpdateTransform)}addLocalBounds(bounds,localRoot){addMaskLocalBounds(this.mask,bounds,localRoot)}containsPoint(point,hitTestFn){let mask=this.mask;return hitTestFn(mask,point)}destroy(){this.reset()}static test(mask){return mask instanceof Sprite}};AlphaMask.extension=ExtensionType.MaskEffect;var ColorMask=class{constructor(options){this.priority=0,this.pipe=`colorMask`,options?.mask&&this.init(options.mask)}init(mask){this.mask=mask}destroy(){}static test(mask){return typeof mask==`number`}};ColorMask.extension=ExtensionType.MaskEffect;var StencilMask=class{constructor(options){this.priority=0,this.pipe=`stencilMask`,options?.mask&&this.init(options.mask)}init(mask){this.mask=mask,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(bounds,skipUpdateTransform){addMaskBounds(this.mask,bounds,skipUpdateTransform)}addLocalBounds(bounds,localRoot){addMaskLocalBounds(this.mask,bounds,localRoot)}containsPoint(point,hitTestFn){let mask=this.mask;return hitTestFn(mask,point)}destroy(){this.reset()}static test(mask){return mask instanceof Container}};StencilMask.extension=ExtensionType.MaskEffect;var currentAdapter={createCanvas:(width,height)=>{let canvas=document.createElement(`canvas`);return canvas.width=width,canvas.height=height,canvas},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(url,options)=>fetch(url,options),parseXML:xml=>new DOMParser().parseFromString(xml,`text/xml`)},DOMAdapter={get(){return currentAdapter},set(adapter){currentAdapter=adapter}},CanvasSource=class extends TextureSource{constructor(options){options.resource||=DOMAdapter.get().createCanvas(),options.width||(options.width=options.resource.width,options.autoDensity||(options.width/=options.resolution)),options.height||(options.height=options.resource.height,options.autoDensity||(options.height/=options.resolution)),super(options),this.uploadMethodId=`image`,this.autoDensity=options.autoDensity,this.resizeCanvas(),this.transparent=!!options.transparent}resizeCanvas(){this.autoDensity&&`style`in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(width=this.width,height=this.height,resolution=this._resolution){let didResize=super.resize(width,height,resolution);return didResize&&this.resizeCanvas(),didResize}static test(resource){return globalThis.HTMLCanvasElement&&resource instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&resource instanceof OffscreenCanvas}get context2D(){return this._context2D||=this.resource.getContext(`2d`)}};CanvasSource.extension=ExtensionType.TextureSource;var ImageSource=class extends TextureSource{constructor(options){super(options),this.uploadMethodId=`image`,this.autoGarbageCollect=!0}static test(resource){return globalThis.HTMLImageElement&&resource instanceof HTMLImageElement||typeof ImageBitmap<`u`&&resource instanceof ImageBitmap||globalThis.VideoFrame&&resource instanceof VideoFrame}};ImageSource.extension=ExtensionType.TextureSource;var UPDATE_PRIORITY=(UPDATE_PRIORITY2=>(UPDATE_PRIORITY2[UPDATE_PRIORITY2.INTERACTION=50]=`INTERACTION`,UPDATE_PRIORITY2[UPDATE_PRIORITY2.HIGH=25]=`HIGH`,UPDATE_PRIORITY2[UPDATE_PRIORITY2.NORMAL=0]=`NORMAL`,UPDATE_PRIORITY2[UPDATE_PRIORITY2.LOW=-25]=`LOW`,UPDATE_PRIORITY2[UPDATE_PRIORITY2.UTILITY=-50]=`UTILITY`,UPDATE_PRIORITY2))(UPDATE_PRIORITY||{}),TickerListener=class{constructor(fn,context$1=null,priority=0,once=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=fn,this._context=context$1,this.priority=priority,this._once=once}match(fn,context$1=null){return this._fn===fn&&this._context===context$1}emit(ticker){this._fn&&(this._context?this._fn.call(this._context,ticker):this._fn(ticker));let redirect=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),redirect}connect(previous){this.previous=previous,previous.next&&(previous.next.previous=this),this.next=previous.next,previous.next=this}destroy(hard=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let redirect=this.next;return this.next=hard?null:redirect,this.previous=null,redirect}},_Ticker=class _Ticker$1{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/_Ticker$1.targetFPMS,this.elapsedMS=1/_Ticker$1.targetFPMS,this._tick=time=>{this._requestId=null,this.started&&(this.update(time),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(fn,context$1,priority=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(fn,context$1,priority))}addOnce(fn,context$1,priority=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(fn,context$1,priority,!0))}_addListener(listener){let current=this._head.next,previous=this._head;if(!current)listener.connect(previous);else{for(;current;){if(listener.priority>current.priority){listener.connect(previous);break}previous=current,current=current.next}listener.previous||listener.connect(previous)}return this._startIfPossible(),this}remove(fn,context$1){let listener=this._head.next;for(;listener;)listener=listener.match(fn,context$1)?listener.destroy():listener.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let count$1=0,current=this._head;for(;current=current.next;)count$1++;return count$1}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let listener=this._head.next;for(;listener;)listener=listener.destroy(!0);this._head.destroy(),this._head=null}}update(currentTime=performance.now()){let elapsedMS;if(currentTime>this.lastTime){if(elapsedMS=this.elapsedMS=currentTime-this.lastTime,elapsedMS>this._maxElapsedMS&&(elapsedMS=this._maxElapsedMS),elapsedMS*=this.speed,this._minElapsedMS){let delta=currentTime-this._lastFrame|0;if(delta<this._minElapsedMS)return;this._lastFrame=currentTime-delta%this._minElapsedMS}this.deltaMS=elapsedMS,this.deltaTime=this.deltaMS*_Ticker$1.targetFPMS;let head=this._head,listener=head.next;for(;listener;)listener=listener.emit(this);head.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=currentTime}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(fps){let minFPS=Math.min(this.maxFPS,fps);this._maxElapsedMS=1/Math.min(Math.max(0,minFPS)/1e3,_Ticker$1.targetFPMS)}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(fps){fps===0?this._minElapsedMS=0:this._minElapsedMS=1/(Math.max(this.minFPS,fps)/1e3)}static get shared(){if(!_Ticker$1._shared){let shared=_Ticker$1._shared=new _Ticker$1;shared.autoStart=!0,shared._protected=!0}return _Ticker$1._shared}static get system(){if(!_Ticker$1._system){let system=_Ticker$1._system=new _Ticker$1;system.autoStart=!0,system._protected=!0}return _Ticker$1._system}};_Ticker.targetFPMS=.06;var Ticker=_Ticker,promise;async function detectVideoAlphaMode(){return promise??=(async()=>{let gl=DOMAdapter.get().createCanvas(1,1).getContext(`webgl`);if(!gl)return`premultiply-alpha-on-upload`;let video=await new Promise(resolve$1=>{let video2=document.createElement(`video`);video2.onloadeddata=()=>resolve$1(video2),video2.onerror=()=>resolve$1(null),video2.autoplay=!1,video2.crossOrigin=`anonymous`,video2.preload=`auto`,video2.src=`data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=`,video2.load()});if(!video)return`premultiply-alpha-on-upload`;let texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,texture);let framebuffer=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,texture,0),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,gl.NONE),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,video);let pixel=new Uint8Array(4);return gl.readPixels(0,0,1,1,gl.RGBA,gl.UNSIGNED_BYTE,pixel),gl.deleteFramebuffer(framebuffer),gl.deleteTexture(texture),gl.getExtension(`WEBGL_lose_context`)?.loseContext(),pixel[0]<=pixel[3]?`premultiplied-alpha`:`premultiply-alpha-on-upload`})(),promise}var _VideoSource=class _VideoSource$1 extends TextureSource{constructor(options){super(options),this.isReady=!1,this.uploadMethodId=`video`,options={..._VideoSource$1.defaultOptions,...options},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=options.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=options.autoPlay!==!1,this.alphaMode=options.alphaMode??`premultiply-alpha-on-upload`,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),options.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){let elapsedMS=Ticker.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-elapsedMS)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;let source$2=this.resource,options=this.options;return(source$2.readyState===source$2.HAVE_ENOUGH_DATA||source$2.readyState===source$2.HAVE_FUTURE_DATA)&&source$2.width&&source$2.height&&(source$2.complete=!0),source$2.addEventListener(`play`,this._onPlayStart),source$2.addEventListener(`pause`,this._onPlayStop),source$2.addEventListener(`seeked`,this._onSeeked),this._isSourceReady()?this._mediaReady():(options.preload||source$2.addEventListener(`canplay`,this._onCanPlay),source$2.addEventListener(`canplaythrough`,this._onCanPlayThrough),source$2.addEventListener(`error`,this._onError,!0)),this.alphaMode=await detectVideoAlphaMode(),this._load=new Promise((resolve$1,reject)=>{this.isValid?resolve$1(this):(this._resolve=resolve$1,this._reject=reject,options.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${options.preloadTimeoutMs}ms`))})),source$2.load())}),this._load}_onError(event){this.resource.removeEventListener(`error`,this._onError,!0),this.emit(`error`,event),this._reject&&(this._reject(event),this._reject=null,this._resolve=null)}_isSourcePlaying(){let source$2=this.resource;return!source$2.paused&&!source$2.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener(`canplay`,this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener(`canplaythrough`,this._onCanPlay),this._preloadTimeout&&=(clearTimeout(this._preloadTimeout),void 0),this._mediaReady()}_mediaReady(){let source$2=this.resource;this.isValid&&(this.isReady=!0,this.resize(source$2.videoWidth,source$2.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();let source$2=this.resource;source$2&&(source$2.removeEventListener(`play`,this._onPlayStart),source$2.removeEventListener(`pause`,this._onPlayStop),source$2.removeEventListener(`seeked`,this._onSeeked),source$2.removeEventListener(`canplay`,this._onCanPlay),source$2.removeEventListener(`canplaythrough`,this._onCanPlayThrough),source$2.removeEventListener(`error`,this._onError,!0),source$2.pause(),source$2.src=``,source$2.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(value){value!==this._autoUpdate&&(this._autoUpdate=value,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(value){value!==this._updateFPS&&(this._updateFPS=value,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(resource){return globalThis.HTMLVideoElement&&resource instanceof HTMLVideoElement}};_VideoSource.extension=ExtensionType.TextureSource,_VideoSource.defaultOptions={...TextureSource.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},_VideoSource.MIME_TYPES={ogv:`video/ogg`,mov:`video/quicktime`,m4v:`video/mp4`};var VideoSource=_VideoSource,convertToList=(input,transform,forceTransform=!1)=>(Array.isArray(input)||(input=[input]),transform?input.map(item=>typeof item==`string`||forceTransform?transform(item):item):input),Cache=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(key$1){return this._cache.has(key$1)}get(key$1){let result=this._cache.get(key$1);return result||warn$1(`[Assets] Asset id ${key$1} was not found in the Cache`),result}set(key$1,value){let keys$1=convertToList(key$1),cacheableAssets;for(let i$1=0;i$1<this.parsers.length;i$1++){let parser=this.parsers[i$1];if(parser.test(value)){cacheableAssets=parser.getCacheableAssets(keys$1,value);break}}let cacheableMap=new Map(Object.entries(cacheableAssets||{}));cacheableAssets||keys$1.forEach(key2=>{cacheableMap.set(key2,value)});let cacheKeys=[...cacheableMap.keys()],cachedAssets={cacheKeys,keys:keys$1};keys$1.forEach(key2=>{this._cacheMap.set(key2,cachedAssets)}),cacheKeys.forEach(key2=>{let val=cacheableAssets?cacheableAssets[key2]:value;this._cache.has(key2)&&this._cache.get(key2)!==val&&warn$1(`[Cache] already has key:`,key2),this._cache.set(key2,cacheableMap.get(key2))})}remove(key$1){if(!this._cacheMap.has(key$1)){warn$1(`[Assets] Asset id ${key$1} was not found in the Cache`);return}let cacheMap$1=this._cacheMap.get(key$1);cacheMap$1.cacheKeys.forEach(key2=>{this._cache.delete(key2)}),cacheMap$1.keys.forEach(key2=>{this._cacheMap.delete(key2)})}get parsers(){return this._parsers}},sources=[];extensions$1.handleByList(ExtensionType.TextureSource,sources);function textureSourceFrom(options={}){let hasResource=options&&options.resource,res=hasResource?options.resource:options,opts=hasResource?options:{resource:options};for(let i$1=0;i$1<sources.length;i$1++){let Source=sources[i$1];if(Source.test(res))return new Source(opts)}throw Error(`Could not find a source type for resource: ${opts.resource}`)}function resourceToTexture(options={},skipCache=!1){let hasResource=options&&options.resource,resource=hasResource?options.resource:options,opts=hasResource?options:{resource:options};if(!skipCache&&Cache.has(resource))return Cache.get(resource);let texture=new Texture({source:textureSourceFrom(opts)});return texture.on(`destroy`,()=>{Cache.has(resource)&&Cache.remove(resource)}),skipCache||Cache.set(resource,texture),texture}function textureFrom(id,skipCache=!1){return typeof id==`string`?Cache.get(id):id instanceof TextureSource?new Texture({source:id}):resourceToTexture(id,skipCache)}Texture.from=textureFrom,TextureSource.from=textureSourceFrom,extensions$1.add(AlphaMask,ColorMask,StencilMask,VideoSource,ImageSource,CanvasSource,BufferImageSource);var LoaderParserPriority=(LoaderParserPriority2=>(LoaderParserPriority2[LoaderParserPriority2.Low=0]=`Low`,LoaderParserPriority2[LoaderParserPriority2.Normal=1]=`Normal`,LoaderParserPriority2[LoaderParserPriority2.High=2]=`High`,LoaderParserPriority2))(LoaderParserPriority||{});function assertPath(path2){if(typeof path2!=`string`)throw TypeError(`Path must be a string. Received ${JSON.stringify(path2)}`)}function removeUrlParams(url){return url.split(`?`)[0].split(`#`)[0]}function escapeRegExp(string){return string.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`)}function replaceAll(str,find$1,replace){return str.replace(new RegExp(escapeRegExp(find$1),`g`),replace)}function normalizeStringPosix(path2,allowAboveRoot){let res=``,lastSegmentLength=0,lastSlash=-1,dots=0,code=-1;for(let i$1=0;i$1<=path2.length;++i$1){if(i$1<path2.length)code=path2.charCodeAt(i$1);else if(code===47)break;else code=47;if(code===47){if(!(lastSlash===i$1-1||dots===1))if(lastSlash!==i$1-1&&dots===2){if(res.length<2||lastSegmentLength!==2||res.charCodeAt(res.length-1)!==46||res.charCodeAt(res.length-2)!==46){if(res.length>2){let lastSlashIndex=res.lastIndexOf(`/`);if(lastSlashIndex!==res.length-1){lastSlashIndex===-1?(res=``,lastSegmentLength=0):(res=res.slice(0,lastSlashIndex),lastSegmentLength=res.length-1-res.lastIndexOf(`/`)),lastSlash=i$1,dots=0;continue}}else if(res.length===2||res.length===1){res=``,lastSegmentLength=0,lastSlash=i$1,dots=0;continue}}allowAboveRoot&&(res.length>0?res+=`/..`:res=`..`,lastSegmentLength=2)}else res.length>0?res+=`/${path2.slice(lastSlash+1,i$1)}`:res=path2.slice(lastSlash+1,i$1),lastSegmentLength=i$1-lastSlash-1;lastSlash=i$1,dots=0}else code===46&&dots!==-1?++dots:dots=-1}return res}var path={toPosix(path2){return replaceAll(path2,`\\`,`/`)},isUrl(path2){return/^https?:/.test(this.toPosix(path2))},isDataUrl(path2){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(path2)},isBlobUrl(path2){return path2.startsWith(`blob:`)},hasProtocol(path2){return/^[^/:]+:/.test(this.toPosix(path2))},getProtocol(path2){assertPath(path2),path2=this.toPosix(path2);let matchFile=/^file:\/\/\//.exec(path2);if(matchFile)return matchFile[0];let matchProtocol=/^[^/:]+:\/{0,2}/.exec(path2);return matchProtocol?matchProtocol[0]:``},toAbsolute(url,customBaseUrl,customRootUrl){if(assertPath(url),this.isDataUrl(url)||this.isBlobUrl(url))return url;let baseUrl=removeUrlParams(this.toPosix(customBaseUrl??DOMAdapter.get().getBaseUrl())),rootUrl=removeUrlParams(this.toPosix(customRootUrl??this.rootname(baseUrl)));return url=this.toPosix(url),url.startsWith(`/`)?path.join(rootUrl,url.slice(1)):this.isAbsolute(url)?url:this.join(baseUrl,url)},normalize(path2){if(assertPath(path2),path2.length===0)return`.`;if(this.isDataUrl(path2)||this.isBlobUrl(path2))return path2;path2=this.toPosix(path2);let protocol=``,isAbsolute=path2.startsWith(`/`);this.hasProtocol(path2)&&(protocol=this.rootname(path2),path2=path2.slice(protocol.length));let trailingSeparator=path2.endsWith(`/`);return path2=normalizeStringPosix(path2,!1),path2.length>0&&trailingSeparator&&(path2+=`/`),isAbsolute?`/${path2}`:protocol+path2},isAbsolute(path2){return assertPath(path2),path2=this.toPosix(path2),this.hasProtocol(path2)?!0:path2.startsWith(`/`)},join(...segments){if(segments.length===0)return`.`;let joined;for(let i$1=0;i$1<segments.length;++i$1){let arg=segments[i$1];if(assertPath(arg),arg.length>0)if(joined===void 0)joined=arg;else{let prevArg=segments[i$1-1]??``;this.joinExtensions.includes(this.extname(prevArg).toLowerCase())?joined+=`/../${arg}`:joined+=`/${arg}`}}return joined===void 0?`.`:this.normalize(joined)},dirname(path2){if(assertPath(path2),path2.length===0)return`.`;path2=this.toPosix(path2);let code=path2.charCodeAt(0),hasRoot=code===47,end$1=-1,matchedSlash=!0,proto=this.getProtocol(path2),origpath=path2;path2=path2.slice(proto.length);for(let i$1=path2.length-1;i$1>=1;--i$1)if(code=path2.charCodeAt(i$1),code===47){if(!matchedSlash){end$1=i$1;break}}else matchedSlash=!1;return end$1===-1?hasRoot?`/`:this.isUrl(origpath)?proto+path2:proto:hasRoot&&end$1===1?`//`:proto+path2.slice(0,end$1)},rootname(path2){assertPath(path2),path2=this.toPosix(path2);let root=``;if(root=path2.startsWith(`/`)?`/`:this.getProtocol(path2),this.isUrl(path2)){let index=path2.indexOf(`/`,root.length);root=index===-1?path2:path2.slice(0,index),root.endsWith(`/`)||(root+=`/`)}return root},basename(path2,ext){assertPath(path2),ext&&assertPath(ext),path2=removeUrlParams(this.toPosix(path2));let start$1=0,end$1=-1,matchedSlash=!0,i$1;if(ext!==void 0&&ext.length>0&&ext.length<=path2.length){if(ext.length===path2.length&&ext===path2)return``;let extIdx=ext.length-1,firstNonSlashEnd=-1;for(i$1=path2.length-1;i$1>=0;--i$1){let code=path2.charCodeAt(i$1);if(code===47){if(!matchedSlash){start$1=i$1+1;break}}else firstNonSlashEnd===-1&&(matchedSlash=!1,firstNonSlashEnd=i$1+1),extIdx>=0&&(code===ext.charCodeAt(extIdx)?--extIdx===-1&&(end$1=i$1):(extIdx=-1,end$1=firstNonSlashEnd))}return start$1===end$1?end$1=firstNonSlashEnd:end$1===-1&&(end$1=path2.length),path2.slice(start$1,end$1)}for(i$1=path2.length-1;i$1>=0;--i$1)if(path2.charCodeAt(i$1)===47){if(!matchedSlash){start$1=i$1+1;break}}else end$1===-1&&(matchedSlash=!1,end$1=i$1+1);return end$1===-1?``:path2.slice(start$1,end$1)},extname(path2){assertPath(path2),path2=removeUrlParams(this.toPosix(path2));let startDot=-1,startPart=0,end$1=-1,matchedSlash=!0,preDotState=0;for(let i$1=path2.length-1;i$1>=0;--i$1){let code=path2.charCodeAt(i$1);if(code===47){if(!matchedSlash){startPart=i$1+1;break}continue}end$1===-1&&(matchedSlash=!1,end$1=i$1+1),code===46?startDot===-1?startDot=i$1:preDotState!==1&&(preDotState=1):startDot!==-1&&(preDotState=-1)}return startDot===-1||end$1===-1||preDotState===0||preDotState===1&&startDot===end$1-1&&startDot===startPart+1?``:path2.slice(startDot,end$1)},parse(path2){assertPath(path2);let ret={root:``,dir:``,base:``,ext:``,name:``};if(path2.length===0)return ret;path2=removeUrlParams(this.toPosix(path2));let code=path2.charCodeAt(0),isAbsolute=this.isAbsolute(path2),start$1;ret.root=this.rootname(path2),start$1=isAbsolute||this.hasProtocol(path2)?1:0;let startDot=-1,startPart=0,end$1=-1,matchedSlash=!0,i$1=path2.length-1,preDotState=0;for(;i$1>=start$1;--i$1){if(code=path2.charCodeAt(i$1),code===47){if(!matchedSlash){startPart=i$1+1;break}continue}end$1===-1&&(matchedSlash=!1,end$1=i$1+1),code===46?startDot===-1?startDot=i$1:preDotState!==1&&(preDotState=1):startDot!==-1&&(preDotState=-1)}return startDot===-1||end$1===-1||preDotState===0||preDotState===1&&startDot===end$1-1&&startDot===startPart+1?end$1!==-1&&(startPart===0&&isAbsolute?ret.base=ret.name=path2.slice(1,end$1):ret.base=ret.name=path2.slice(startPart,end$1)):(startPart===0&&isAbsolute?(ret.name=path2.slice(1,startDot),ret.base=path2.slice(1,end$1)):(ret.name=path2.slice(startPart,startDot),ret.base=path2.slice(startPart,end$1)),ret.ext=path2.slice(startDot,end$1)),ret.dir=this.dirname(path2),ret},sep:`/`,delimiter:`:`,joinExtensions:[`.html`]};function processX(base$1,ids,depth,result,tags){let id=ids[depth];for(let i$1=0;i$1<id.length;i$1++){let value=id[i$1];depth<ids.length-1?processX(base$1.replace(result[depth],value),ids,depth+1,result,tags):tags.push(base$1.replace(result[depth],value))}}function createStringVariations(string){let result=string.match(/\{(.*?)\}/g),tags=[];if(result){let ids=[];result.forEach(vars=>{let split=vars.substring(1,vars.length-1).split(`,`);ids.push(split)}),processX(string,ids,0,result,tags)}else tags.push(string);return tags}var isSingleItem=item=>!Array.isArray(item),Resolver=class{constructor(){this._defaultBundleIdentifierOptions={connector:`-`,createBundleAssetId:(bundleId,assetId)=>`${bundleId}${this._bundleIdConnector}${assetId}`,extractAssetIdFromBundle:(bundleId,assetBundleId)=>assetBundleId.replace(`${bundleId}${this._bundleIdConnector}`,``)},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(bundleIdentifier){if(this._bundleIdConnector=bundleIdentifier.connector??this._bundleIdConnector,this._createBundleAssetId=bundleIdentifier.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=bundleIdentifier.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle(`foo`,this._createBundleAssetId(`foo`,`bar`))!==`bar`)throw Error(`[Resolver] GenerateBundleAssetId are not working correctly`)}prefer(...preferOrders){preferOrders.forEach(prefer=>{this._preferredOrder.push(prefer),prefer.priority||=Object.keys(prefer.params)}),this._resolverHash={}}set basePath(basePath){this._basePath=basePath}get basePath(){return this._basePath}set rootPath(rootPath){this._rootPath=rootPath}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(searchParams){if(typeof searchParams==`string`)this._defaultSearchParams=searchParams;else{let queryValues=searchParams;this._defaultSearchParams=Object.keys(queryValues).map(key$1=>`${encodeURIComponent(key$1)}=${encodeURIComponent(queryValues[key$1])}`).join(`&`)}}getAlias(asset){let{alias,src}=asset;return convertToList(alias||src,value=>typeof value==`string`?value:Array.isArray(value)?value.map(v$1=>v$1?.src??v$1):value?.src?value.src:value,!0)}addManifest(manifest){this._manifest&&warn$1(`[Resolver] Manifest already exists, this will be overwritten`),this._manifest=manifest,manifest.bundles.forEach(bundle=>{this.addBundle(bundle.name,bundle.assets)})}addBundle(bundleId,assets){let assetNames=[],convertedAssets=assets;Array.isArray(assets)||(convertedAssets=Object.entries(assets).map(([alias,src])=>typeof src==`string`||Array.isArray(src)?{alias,src}:{alias,...src})),convertedAssets.forEach(asset=>{let srcs=asset.src,aliases=asset.alias,ids;if(typeof aliases==`string`){let bundleAssetId=this._createBundleAssetId(bundleId,aliases);assetNames.push(bundleAssetId),ids=[aliases,bundleAssetId]}else{let bundleIds=aliases.map(name=>this._createBundleAssetId(bundleId,name));assetNames.push(...bundleIds),ids=[...aliases,...bundleIds]}this.add({...asset,alias:ids,src:srcs})}),this._bundles[bundleId]=assetNames}add(aliases){let assets=[];Array.isArray(aliases)?assets.push(...aliases):assets.push(aliases);let keyCheck=key$1=>{this.hasKey(key$1)&&warn$1(`[Resolver] already has key: ${key$1} overwriting`)};convertToList(assets).forEach(asset=>{let{src}=asset,{data,format:format$1,loadParser:userDefinedLoadParser,parser:userDefinedParser}=asset,srcsToUse=convertToList(src).map(src2=>typeof src2==`string`?createStringVariations(src2):Array.isArray(src2)?src2:[src2]),aliasesToUse=this.getAlias(asset);Array.isArray(aliasesToUse)?aliasesToUse.forEach(keyCheck):keyCheck(aliasesToUse);let resolvedAssets=[];srcsToUse.forEach(srcs=>{srcs.forEach(src2=>{let formattedAsset={};if(typeof src2!=`object`){formattedAsset.src=src2;for(let i$1=0;i$1<this._parsers.length;i$1++){let parser=this._parsers[i$1];if(parser.test(src2)){formattedAsset=parser.parse(src2);break}}}else data=src2.data??data,format$1=src2.format??format$1,(src2.loadParser||src2.parser)&&(userDefinedLoadParser=src2.loadParser??userDefinedLoadParser,userDefinedParser=src2.parser??userDefinedParser),formattedAsset={...formattedAsset,...src2};if(!aliasesToUse)throw Error(`[Resolver] alias is undefined for this asset: ${formattedAsset.src}`);formattedAsset=this._buildResolvedAsset(formattedAsset,{aliases:aliasesToUse,data,format:format$1,loadParser:userDefinedLoadParser,parser:userDefinedParser,progressSize:asset.progressSize}),resolvedAssets.push(formattedAsset)})}),aliasesToUse.forEach(alias=>{this._assetMap[alias]=resolvedAssets})})}resolveBundle(bundleIds){let singleAsset=isSingleItem(bundleIds);bundleIds=convertToList(bundleIds);let out$2={};return bundleIds.forEach(bundleId=>{let assetNames=this._bundles[bundleId];if(assetNames){let results=this.resolve(assetNames),assets={};for(let key$1 in results){let asset=results[key$1];assets[this._extractAssetIdFromBundle(bundleId,key$1)]=asset}out$2[bundleId]=assets}}),singleAsset?out$2[bundleIds[0]]:out$2}resolveUrl(key$1){let result=this.resolve(key$1);if(typeof key$1!=`string`){let out$2={};for(let i$1 in result)out$2[i$1]=result[i$1].src;return out$2}return result.src}resolve(keys$1){let singleAsset=isSingleItem(keys$1);keys$1=convertToList(keys$1);let result={};return keys$1.forEach(key$1=>{if(!this._resolverHash[key$1])if(this._assetMap[key$1]){let assets=this._assetMap[key$1],preferredOrder=this._getPreferredOrder(assets);preferredOrder?.priority.forEach(priorityKey=>{preferredOrder.params[priorityKey].forEach(value=>{let filteredAssets=assets.filter(asset=>asset[priorityKey]?asset[priorityKey]===value:!1);filteredAssets.length&&(assets=filteredAssets)})}),this._resolverHash[key$1]=assets[0]}else this._resolverHash[key$1]=this._buildResolvedAsset({alias:[key$1],src:key$1},{});result[key$1]=this._resolverHash[key$1]}),singleAsset?result[keys$1[0]]:result}hasKey(key$1){return!!this._assetMap[key$1]}hasBundle(key$1){return!!this._bundles[key$1]}_getPreferredOrder(assets){for(let i$1=0;i$1<assets.length;i$1++){let asset=assets[i$1],preferred=this._preferredOrder.find(preference=>preference.params.format.includes(asset.format));if(preferred)return preferred}return this._preferredOrder[0]}_appendDefaultSearchParams(url){if(!this._defaultSearchParams)return url;let paramConnector=/\?/.test(url)?`&`:`?`;return`${url}${paramConnector}${this._defaultSearchParams}`}_buildResolvedAsset(formattedAsset,data){let{aliases,data:assetData,loadParser,parser,format:format$1,progressSize}=data;return(this._basePath||this._rootPath)&&(formattedAsset.src=path.toAbsolute(formattedAsset.src,this._basePath,this._rootPath)),formattedAsset.alias=aliases??formattedAsset.alias??[formattedAsset.src],formattedAsset.src=this._appendDefaultSearchParams(formattedAsset.src),formattedAsset.data={...assetData||{},...formattedAsset.data},formattedAsset.loadParser=loadParser??formattedAsset.loadParser,formattedAsset.parser=parser??formattedAsset.parser,formattedAsset.format=format$1??formattedAsset.format??getUrlExtension(formattedAsset.src),progressSize!==void 0&&(formattedAsset.progressSize=progressSize),formattedAsset}};Resolver.RETINA_PREFIX=/@([0-9\.]+)x/;function getUrlExtension(url){return url.split(`.`).pop().split(`?`).shift().split(`#`).shift()}var copySearchParams=(targetUrl,sourceUrl)=>{let searchParams=sourceUrl.split(`?`)[1];return searchParams&&(targetUrl+=`?${searchParams}`),targetUrl},_Spritesheet=class _Spritesheet$1{constructor(optionsOrTexture,arg1){this.linkedSheets=[];let options=optionsOrTexture;optionsOrTexture?.source instanceof TextureSource&&(options={texture:optionsOrTexture,data:arg1});let{texture,data,cachePrefix=``}=options;this.cachePrefix=cachePrefix,this._texture=texture instanceof Texture?texture:null,this.textureSource=texture.source,this.textures={},this.animations={},this.data=data;let metaResolution=parseFloat(data.meta.scale);metaResolution?(this.resolution=metaResolution,texture.source.resolution=this.resolution):this.resolution=texture.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(resolve$1=>{this._callback=resolve$1,this._batchIndex=0,this._frameKeys.length<=_Spritesheet$1.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(initialFrameIndex){let frameIndex=initialFrameIndex,maxFrames=_Spritesheet$1.BATCH_SIZE;for(;frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length;){let i$1=this._frameKeys[frameIndex],data=this._frames[i$1],rect=data.frame;if(rect){let frame=null,trim$1=null,sourceSize=data.trimmed!==!1&&data.sourceSize?data.sourceSize:data.frame,orig=new Rectangle(0,0,Math.floor(sourceSize.w)/this.resolution,Math.floor(sourceSize.h)/this.resolution);frame=data.rotated?new Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.h)/this.resolution,Math.floor(rect.w)/this.resolution):new Rectangle(Math.floor(rect.x)/this.resolution,Math.floor(rect.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution),data.trimmed!==!1&&data.spriteSourceSize&&(trim$1=new Rectangle(Math.floor(data.spriteSourceSize.x)/this.resolution,Math.floor(data.spriteSourceSize.y)/this.resolution,Math.floor(rect.w)/this.resolution,Math.floor(rect.h)/this.resolution)),this.textures[i$1]=new Texture({source:this.textureSource,frame,orig,trim:trim$1,rotate:data.rotated?2:0,defaultAnchor:data.anchor,defaultBorders:data.borders,label:i$1.toString()})}frameIndex++}}_processAnimations(){let animations=this.data.animations||{};for(let animName in animations){this.animations[animName]=[];for(let i$1=0;i$1<animations[animName].length;i$1++){let frameName=animations[animName][i$1];this.animations[animName].push(this.textures[frameName])}}}_parseComplete(){let callback=this._callback;this._callback=null,this._batchIndex=0,callback.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_Spritesheet$1.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_Spritesheet$1.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(destroyBase=!1){for(let i$1 in this.textures)this.textures[i$1].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,destroyBase&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};_Spritesheet.BATCH_SIZE=1e3;var Spritesheet=_Spritesheet,validImages=[`jpg`,`png`,`jpeg`,`avif`,`webp`,`basis`,`etc2`,`bc7`,`bc6h`,`bc5`,`bc4`,`bc3`,`bc2`,`bc1`,`eac`,`astc`];function getCacheableAssets(keys$1,asset,ignoreMultiPack){let out$2={};if(keys$1.forEach(key$1=>{out$2[key$1]=asset}),Object.keys(asset.textures).forEach(key$1=>{out$2[`${asset.cachePrefix}${key$1}`]=asset.textures[key$1]}),!ignoreMultiPack){let basePath=path.dirname(keys$1[0]);asset.linkedSheets.forEach((item,i$1)=>{let out2=getCacheableAssets([`${basePath}/${asset.data.meta.related_multi_packs[i$1]}`],item,!0);Object.assign(out$2,out2)})}return out$2}var spritesheetAsset={extension:ExtensionType.Asset,cache:{test:asset=>asset instanceof Spritesheet,getCacheableAssets:(keys$1,asset)=>getCacheableAssets(keys$1,asset,!1)},resolver:{extension:{type:ExtensionType.ResolveParser,name:`resolveSpritesheet`},test:value=>{let split=value.split(`?`)[0].split(`.`),extension=split.pop(),format$1=split.pop();return extension===`json`&&validImages.includes(format$1)},parse:value=>{let split=value.split(`.`);return{resolution:parseFloat(Resolver.RETINA_PREFIX.exec(value)?.[1]??`1`),format:split[split.length-2],src:value}}},loader:{name:`spritesheetLoader`,id:`spritesheet`,extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal,name:`spritesheetLoader`},async testParse(asset,options){return path.extname(options.src).toLowerCase()===`.json`&&!!asset.frames},async parse(asset,options,loader){let{texture:imageTexture,imageFilename,textureOptions,cachePrefix}=options?.data??{},basePath=path.dirname(options.src);basePath&&basePath.lastIndexOf(`/`)!==basePath.length-1&&(basePath+=`/`);let texture;if(imageTexture instanceof Texture)texture=imageTexture;else{let imagePath=copySearchParams(basePath+(imageFilename??asset.meta.image),options.src);texture=(await loader.load([{src:imagePath,data:textureOptions}]))[imagePath]}let spritesheet=new Spritesheet({texture:texture.source,data:asset,cachePrefix});await spritesheet.parse();let multiPacks=asset?.meta?.related_multi_packs;if(Array.isArray(multiPacks)){let promises=[];for(let item of multiPacks){if(typeof item!=`string`)continue;let itemUrl=basePath+item;options.data?.ignoreMultiPack||(itemUrl=copySearchParams(itemUrl,options.src),promises.push(loader.load({src:itemUrl,data:{textureOptions,ignoreMultiPack:!0}})))}let res=await Promise.all(promises);spritesheet.linkedSheets=res,res.forEach(item=>{item.linkedSheets=[spritesheet].concat(spritesheet.linkedSheets.filter(sp=>sp!==item))})}return spritesheet},async unload(spritesheet,_resolvedAsset,loader){await loader.unload(spritesheet.textureSource._sourceOrigin),spritesheet.destroy(!1)}}};extensions$1.add(spritesheetAsset);var CanvasObserver=class{constructor(options){this._lastTransform=``,this._observer=null,this._tickerAttached=!1,this.updateTranslation=()=>{if(!this._canvas)return;let rect=this._canvas.getBoundingClientRect(),contentWidth=this._canvas.width,contentHeight=this._canvas.height,sx=rect.width/contentWidth*this._renderer.resolution,sy=rect.height/contentHeight*this._renderer.resolution,tx=rect.left,ty=rect.top,newTransform=`translate(${tx}px, ${ty}px) scale(${sx}, ${sy})`;newTransform!==this._lastTransform&&(this._domElement.style.transform=newTransform,this._lastTransform=newTransform)},this._domElement=options.domElement,this._renderer=options.renderer,!(globalThis.OffscreenCanvas&&this._renderer.canvas instanceof OffscreenCanvas)&&(this._canvas=this._renderer.canvas,this._attachObserver())}get canvas(){return this._canvas}ensureAttached(){!this._domElement.parentNode&&this._canvas.parentNode&&(this._canvas.parentNode.appendChild(this._domElement),this.updateTranslation())}_attachObserver(){`ResizeObserver`in globalThis?(this._observer&&=(this._observer.disconnect(),null),this._observer=new ResizeObserver(entries=>{for(let entry of entries){if(entry.target!==this._canvas)continue;let contentWidth=this.canvas.width,contentHeight=this.canvas.height,sx=entry.contentRect.width/contentWidth*this._renderer.resolution,sy=entry.contentRect.height/contentHeight*this._renderer.resolution;(this._lastScaleX!==sx||this._lastScaleY!==sy)&&(this.updateTranslation(),this._lastScaleX=sx,this._lastScaleY=sy)}}),this._observer.observe(this._canvas)):this._tickerAttached||Ticker.shared.add(this.updateTranslation,this,UPDATE_PRIORITY.HIGH)}destroy(){this._observer?(this._observer.disconnect(),this._observer=null):this._tickerAttached&&Ticker.shared.remove(this.updateTranslation),this._domElement=null,this._renderer=null,this._canvas=null,this._tickerAttached=!1,this._lastTransform=``,this._lastScaleX=null,this._lastScaleY=null}},FederatedEvent=class FederatedEvent{constructor(manager){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point$1,this.page=new Point$1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=manager}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(_type,_bubbles,_cancelable){throw Error(`initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.`)}initUIEvent(_typeArg,_bubblesArg,_cancelableArg,_viewArg,_detailArg){throw Error(`initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.`)}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}},appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(navigator$1){return navigator$1!==void 0&&navigator$1.platform===`MacIntel`&&typeof navigator$1.maxTouchPoints==`number`&&navigator$1.maxTouchPoints>1&&typeof MSStream>`u`};function createMatch(userAgent){return function(regex){return regex.test(userAgent)}}function isMobile$1(param){var nav={userAgent:``,platform:``,maxTouchPoints:0};!param&&typeof navigator<`u`?nav={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof param==`string`?nav.userAgent=param:param&&param.userAgent&&(nav={userAgent:param.userAgent,platform:param.platform,maxTouchPoints:param.maxTouchPoints||0});var userAgent=nav.userAgent,tmp=userAgent.split(`[FBAN`);tmp[1]!==void 0&&(userAgent=tmp[0]),tmp=userAgent.split(`Twitter`),tmp[1]!==void 0&&(userAgent=tmp[0]);var match=createMatch(userAgent),result={apple:{phone:match(appleIphone)&&!match(windowsPhone),ipod:match(appleIpod),tablet:!match(appleIphone)&&(match(appleTablet)||isAppleTabletOnIos13(nav))&&!match(windowsPhone),universal:match(appleUniversal),device:(match(appleIphone)||match(appleIpod)||match(appleTablet)||match(appleUniversal)||isAppleTabletOnIos13(nav))&&!match(windowsPhone)},amazon:{phone:match(amazonPhone),tablet:!match(amazonPhone)&&match(amazonTablet),device:match(amazonPhone)||match(amazonTablet)},android:{phone:!match(windowsPhone)&&match(amazonPhone)||!match(windowsPhone)&&match(androidPhone),tablet:!match(windowsPhone)&&!match(amazonPhone)&&!match(androidPhone)&&(match(amazonTablet)||match(androidTablet)),device:!match(windowsPhone)&&(match(amazonPhone)||match(amazonTablet)||match(androidPhone)||match(androidTablet))||match(/\bokhttp\b/i)},windows:{phone:match(windowsPhone),tablet:match(windowsTablet),device:match(windowsPhone)||match(windowsTablet)},other:{blackberry:match(otherBlackBerry),blackberry10:match(otherBlackBerry10),opera:match(otherOpera),firefox:match(otherFirefox),chrome:match(otherChrome),device:match(otherBlackBerry)||match(otherBlackBerry10)||match(otherOpera)||match(otherFirefox)||match(otherChrome)},any:!1,phone:!1,tablet:!1};return result.any=result.apple.device||result.android.device||result.windows.device||result.other.device,result.phone=result.apple.phone||result.android.phone||result.windows.phone,result.tablet=result.apple.tablet||result.android.tablet||result.windows.tablet,result}var isMobile=(isMobile$1.default??isMobile$1)(globalThis.navigator),KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2,_AccessibilitySystem=class _AccessibilitySystem$1{constructor(renderer$1,_mobileInfo=isMobile){this._mobileInfo=_mobileInfo,this.debug=!1,this._activateOnTab=!0,this._deactivateOnMouseMove=!0,this._isActive=!1,this._isMobileAccessibility=!1,this._div=null,this._pools={},this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._isRunningTests=!1,this._boundOnKeyDown=this._onKeyDown.bind(this),this._boundOnMouseMove=this._onMouseMove.bind(this),this._hookDiv=null,(_mobileInfo.tablet||_mobileInfo.phone)&&this._createTouchHook(),this._renderer=renderer$1}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}get div(){return this._div}_createTouchHook(){let hookDiv=document.createElement(`button`);hookDiv.style.width=`${DIV_HOOK_SIZE}px`,hookDiv.style.height=`${DIV_HOOK_SIZE}px`,hookDiv.style.position=`absolute`,hookDiv.style.top=`${DIV_HOOK_POS_X}px`,hookDiv.style.left=`${DIV_HOOK_POS_Y}px`,hookDiv.style.zIndex=DIV_HOOK_ZINDEX.toString(),hookDiv.style.backgroundColor=`#FF0000`,hookDiv.title=`select to enable accessibility for this content`,hookDiv.addEventListener(`focus`,()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(hookDiv),this._hookDiv=hookDiv}_destroyTouchHook(){this._hookDiv&&=(document.body.removeChild(this._hookDiv),null)}_activate(){if(this._isActive)return;this._isActive=!0,this._div||(this._div=document.createElement(`div`),this._div.style.position=`absolute`,this._div.style.top=`${DIV_TOUCH_POS_X}px`,this._div.style.left=`${DIV_TOUCH_POS_Y}px`,this._div.style.pointerEvents=`none`,this._div.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this._canvasObserver=new CanvasObserver({domElement:this._div,renderer:this._renderer})),this._activateOnTab&&globalThis.addEventListener(`keydown`,this._boundOnKeyDown,!1),this._deactivateOnMouseMove&&globalThis.document.addEventListener(`mousemove`,this._boundOnMouseMove,!0);let canvas=this._renderer.view.canvas;if(canvas.parentNode)this._canvasObserver.ensureAttached(),this._initAccessibilitySetup();else{let observer=new MutationObserver(()=>{canvas.parentNode&&(observer.disconnect(),this._canvasObserver.ensureAttached(),this._initAccessibilitySetup())});observer.observe(document.body,{childList:!0,subtree:!0})}}_initAccessibilitySetup(){this._renderer.runners.postrender.add(this),this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered)}_deactivate(){if(!(!this._isActive||this._isMobileAccessibility)){this._isActive=!1,globalThis.document.removeEventListener(`mousemove`,this._boundOnMouseMove,!0),this._activateOnTab&&globalThis.addEventListener(`keydown`,this._boundOnKeyDown,!1),this._renderer.runners.postrender.remove(this);for(let child of this._children)child._accessibleDiv&&child._accessibleDiv.parentNode&&(child._accessibleDiv.parentNode.removeChild(child._accessibleDiv),child._accessibleDiv=null),child._accessibleActive=!1;for(let accessibleType in this._pools)this._pools[accessibleType].forEach(div=>{div.parentNode&&div.parentNode.removeChild(div)}),delete this._pools[accessibleType];this._div&&this._div.parentNode&&this._div.parentNode.removeChild(this._div),this._pools={},this._children=[]}}_updateAccessibleObjects(container){if(!container.visible||!container.accessibleChildren)return;container.accessible&&(container._accessibleActive||this._addChild(container),container._renderId=this._renderId);let children=container.children;if(children)for(let i$1=0;i$1<children.length;i$1++)this._updateAccessibleObjects(children[i$1])}init(options){let mergedOptions={accessibilityOptions:{..._AccessibilitySystem$1.defaultOptions,...options?.accessibilityOptions||{}}};this.debug=mergedOptions.accessibilityOptions.debug,this._activateOnTab=mergedOptions.accessibilityOptions.activateOnTab,this._deactivateOnMouseMove=mergedOptions.accessibilityOptions.deactivateOnMouseMove,mergedOptions.accessibilityOptions.enabledByDefault&&this._activate(),this._renderer.runners.postrender.remove(this)}postrender(){let now=performance.now();if(this._mobileInfo.android.device&&now<this._androidUpdateCount||(this._androidUpdateCount=now+this._androidUpdateFrequency,(!this._renderer.renderingToScreen||!this._renderer.view.canvas)&&!this._isRunningTests))return;let activeIds=new Set;if(this._renderer.lastObjectRendered){this._updateAccessibleObjects(this._renderer.lastObjectRendered);for(let child of this._children)child._renderId===this._renderId&&activeIds.add(this._children.indexOf(child))}for(let i$1=this._children.length-1;i$1>=0;i$1--){let child=this._children[i$1];activeIds.has(i$1)||(child._accessibleDiv&&child._accessibleDiv.parentNode&&(child._accessibleDiv.parentNode.removeChild(child._accessibleDiv),this._getPool(child.accessibleType).push(child._accessibleDiv),child._accessibleDiv=null),child._accessibleActive=!1,removeItems(this._children,i$1,1))}this._renderer.renderingToScreen&&this._canvasObserver.ensureAttached();for(let i$1=0;i$1<this._children.length;i$1++){let child=this._children[i$1];if(!child._accessibleActive||!child._accessibleDiv)continue;let div=child._accessibleDiv,hitArea=child.hitArea||child.getBounds().rectangle;if(child.hitArea){let wt=child.worldTransform;div.style.left=`${wt.tx+hitArea.x*wt.a}px`,div.style.top=`${wt.ty+hitArea.y*wt.d}px`,div.style.width=`${hitArea.width*wt.a}px`,div.style.height=`${hitArea.height*wt.d}px`}else this._capHitArea(hitArea),div.style.left=`${hitArea.x}px`,div.style.top=`${hitArea.y}px`,div.style.width=`${hitArea.width}px`,div.style.height=`${hitArea.height}px`}this._renderId++}_updateDebugHTML(div){div.innerHTML=`type: ${div.type}</br> title : ${div.title}</br> tabIndex: ${div.tabIndex}`}_capHitArea(hitArea){hitArea.x<0&&(hitArea.width+=hitArea.x,hitArea.x=0),hitArea.y<0&&(hitArea.height+=hitArea.y,hitArea.y=0);let{width:viewWidth,height:viewHeight}=this._renderer;hitArea.x+hitArea.width>viewWidth&&(hitArea.width=viewWidth-hitArea.x),hitArea.y+hitArea.height>viewHeight&&(hitArea.height=viewHeight-hitArea.y)}_addChild(container){let div=this._getPool(container.accessibleType).pop();div?(div.innerHTML=``,div.removeAttribute(`title`),div.removeAttribute(`aria-label`),div.tabIndex=0):(container.accessibleType===`button`?div=document.createElement(`button`):(div=document.createElement(container.accessibleType),div.style.cssText=`
                        color: transparent;
                        pointer-events: none;
                        padding: 0;
                        margin: 0;
                        border: 0;
                        outline: 0;
                        background: transparent;
                        box-sizing: border-box;
                        user-select: none;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                    `,container.accessibleText&&(div.innerText=container.accessibleText)),div.style.width=`${DIV_TOUCH_SIZE}px`,div.style.height=`${DIV_TOUCH_SIZE}px`,div.style.backgroundColor=this.debug?`rgba(255,255,255,0.5)`:`transparent`,div.style.position=`absolute`,div.style.zIndex=DIV_TOUCH_ZINDEX.toString(),div.style.borderStyle=`none`,navigator.userAgent.toLowerCase().includes(`chrome`)?div.setAttribute(`aria-live`,`off`):div.setAttribute(`aria-live`,`polite`),navigator.userAgent.match(/rv:.*Gecko\//)?div.setAttribute(`aria-relevant`,`additions`):div.setAttribute(`aria-relevant`,`text`),div.addEventListener(`click`,this._onClick.bind(this)),div.addEventListener(`focus`,this._onFocus.bind(this)),div.addEventListener(`focusout`,this._onFocusOut.bind(this))),div.style.pointerEvents=container.accessiblePointerEvents,div.type=container.accessibleType,container.accessibleTitle&&container.accessibleTitle!==null?div.title=container.accessibleTitle:(!container.accessibleHint||container.accessibleHint===null)&&(div.title=`container ${container.tabIndex}`),container.accessibleHint&&container.accessibleHint!==null&&div.setAttribute(`aria-label`,container.accessibleHint),container.interactive?div.tabIndex=container.tabIndex:div.tabIndex=0,this.debug&&this._updateDebugHTML(div),container._accessibleActive=!0,container._accessibleDiv=div,div.container=container,this._children.push(container),this._div.appendChild(container._accessibleDiv)}_dispatchEvent(e$2,type){let{container:target}=e$2.target,boundary=this._renderer.events.rootBoundary,event=Object.assign(new FederatedEvent(boundary),{target});boundary.rootTarget=this._renderer.lastObjectRendered,type.forEach(type2=>boundary.dispatchEvent(event,type2))}_onClick(e$2){this._dispatchEvent(e$2,[`click`,`pointertap`,`tap`])}_onFocus(e$2){e$2.target.getAttribute(`aria-live`)||e$2.target.setAttribute(`aria-live`,`assertive`),this._dispatchEvent(e$2,[`mouseover`])}_onFocusOut(e$2){e$2.target.getAttribute(`aria-live`)||e$2.target.setAttribute(`aria-live`,`polite`),this._dispatchEvent(e$2,[`mouseout`])}_onKeyDown(e$2){e$2.keyCode!==KEY_CODE_TAB||!this._activateOnTab||this._activate()}_onMouseMove(e$2){e$2.movementX===0&&e$2.movementY===0||this._deactivate()}destroy(){this._deactivate(),this._destroyTouchHook(),this._canvasObserver?.destroy(),this._canvasObserver=null,this._div=null,this._pools=null,this._children=null,this._renderer=null,this._hookDiv=null,globalThis.removeEventListener(`keydown`,this._boundOnKeyDown),this._boundOnKeyDown=null,globalThis.document.removeEventListener(`mousemove`,this._boundOnMouseMove,!0),this._boundOnMouseMove=null}setAccessibilityEnabled(enabled){enabled?this._activate():this._deactivate()}_getPool(accessibleType){return this._pools[accessibleType]||(this._pools[accessibleType]=[]),this._pools[accessibleType]}};_AccessibilitySystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`accessibility`},_AccessibilitySystem.defaultOptions={enabledByDefault:!1,debug:!1,activateOnTab:!0,deactivateOnMouseMove:!0};var AccessibilitySystem=_AccessibilitySystem,accessibilityTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,accessibleType:`button`,accessibleText:null,accessiblePointerEvents:`auto`,accessibleChildren:!0,_accessibleActive:!1,_accessibleDiv:null,_renderId:-1},idCounts=Object.create(null),idHash=Object.create(null);function createIdFromString(value,groupId){let id=idHash[value];return id===void 0&&(idCounts[groupId]===void 0&&(idCounts[groupId]=1),idHash[value]=id=idCounts[groupId]++),id}var context;function getTestContext(){return(!context||context?.isContextLost())&&(context=DOMAdapter.get().createCanvas().getContext(`webgl`,{})),context}var maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=`mediump`;let gl=getTestContext();gl&&gl.getShaderPrecisionFormat&&(maxFragmentPrecision=gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT).precision?`highp`:`mediump`)}return maxFragmentPrecision}function addProgramDefines(src,isES300,isFragment){return isES300?src:isFragment?(src=src.replace(`out vec4 finalColor;`,``),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${src}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${src}
        `}function ensurePrecision(src,options,isFragment){let maxSupportedPrecision=isFragment?options.maxSupportedFragmentPrecision:options.maxSupportedVertexPrecision;if(src.substring(0,9)!==`precision`){let precision=isFragment?options.requestedFragmentPrecision:options.requestedVertexPrecision;return precision===`highp`&&maxSupportedPrecision!==`highp`&&(precision=`mediump`),`precision ${precision} float;
${src}`}else if(maxSupportedPrecision!==`highp`&&src.substring(0,15)===`precision highp`)return src.replace(`precision highp`,`precision mediump`);return src}function insertVersion(src,isES300){return isES300?`#version 300 es
${src}`:src}var fragmentNameCache={},VertexNameCache={};function setProgramName(src,{name=`pixi-program`},isFragment=!0){name=name.replace(/\s+/g,`-`),name+=isFragment?`-fragment`:`-vertex`;let nameCache=isFragment?fragmentNameCache:VertexNameCache;return nameCache[name]?(nameCache[name]++,name+=`-${nameCache[name]}`):nameCache[name]=1,src.indexOf(`#define SHADER_NAME`)===-1?`${`#define SHADER_NAME ${name}`}
${src}`:src}function stripVersion(src,isES300){return isES300?src.replace(`#version 300 es`,``):src}var processes={stripVersion,ensurePrecision,addProgramDefines,setProgramName,insertVersion},programCache$1=Object.create(null),_GlProgram=class _GlProgram$1{constructor(options){options={..._GlProgram$1.defaultOptions,...options};let isES300=options.fragment.indexOf(`#version 300 es`)!==-1,preprocessorOptions={stripVersion:isES300,ensurePrecision:{requestedFragmentPrecision:options.preferredFragmentPrecision,requestedVertexPrecision:options.preferredVertexPrecision,maxSupportedVertexPrecision:`highp`,maxSupportedFragmentPrecision:getMaxFragmentPrecision()},setProgramName:{name:options.name},addProgramDefines:isES300,insertVersion:isES300},fragment$3=options.fragment,vertex$3=options.vertex;Object.keys(processes).forEach(processKey=>{let processOptions=preprocessorOptions[processKey];fragment$3=processes[processKey](fragment$3,processOptions,!0),vertex$3=processes[processKey](vertex$3,processOptions,!1)}),this.fragment=fragment$3,this.vertex=vertex$3,this.transformFeedbackVaryings=options.transformFeedbackVaryings,this._key=createIdFromString(`${this.vertex}:${this.fragment}`,`gl-program`)}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,programCache$1[this._cacheKey]=null}static from(options){let key$1=`${options.vertex}:${options.fragment}`;return programCache$1[key$1]||(programCache$1[key$1]=new _GlProgram$1(options),programCache$1[key$1]._cacheKey=key$1),programCache$1[key$1]}};_GlProgram.defaultOptions={preferredVertexPrecision:`highp`,preferredFragmentPrecision:`mediump`};var GlProgram=_GlProgram,attributeFormatData={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function getAttributeInfoFromFormat(format$1){return attributeFormatData[format$1]??attributeFormatData.float32}var WGSL_TO_VERTEX_TYPES={f32:`float32`,"vec2<f32>":`float32x2`,"vec3<f32>":`float32x3`,"vec4<f32>":`float32x4`,vec2f:`float32x2`,vec3f:`float32x3`,vec4f:`float32x4`,i32:`sint32`,"vec2<i32>":`sint32x2`,"vec3<i32>":`sint32x3`,"vec4<i32>":`sint32x4`,u32:`uint32`,"vec2<u32>":`uint32x2`,"vec3<u32>":`uint32x3`,"vec4<u32>":`uint32x4`,bool:`uint32`,"vec2<bool>":`uint32x2`,"vec3<bool>":`uint32x3`,"vec4<bool>":`uint32x4`};function extractAttributesFromGpuProgram({source:source$2,entryPoint}){let results={},mainVertStart=source$2.indexOf(`fn ${entryPoint}`);if(mainVertStart!==-1){let arrowFunctionStart=source$2.indexOf(`->`,mainVertStart);if(arrowFunctionStart!==-1){let functionArgsSubstring=source$2.substring(mainVertStart,arrowFunctionStart),inputsRegex=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g,match;for(;(match=inputsRegex.exec(functionArgsSubstring))!==null;){let format$1=WGSL_TO_VERTEX_TYPES[match[3]]??`float32`;results[match[2]]={location:parseInt(match[1],10),format:format$1,stride:getAttributeInfoFromFormat(format$1).stride,offset:0,instance:!1,start:0}}}}return results}function extractStructAndGroups(wgsl$1){let linePattern=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,groupPattern=/@group\((\d+)\)/,bindingPattern=/@binding\((\d+)\)/,namePattern=/var(<[^>]+>)? (\w+)/,typePattern=/:\s*(\w+)/,structPattern=/struct\s+(\w+)\s*{([^}]+)}/g,structMemberPattern=/(\w+)\s*:\s*([\w\<\>]+)/g,structName=/struct\s+(\w+)/,groups=wgsl$1.match(linePattern)?.map(item=>({group:parseInt(item.match(groupPattern)[1],10),binding:parseInt(item.match(bindingPattern)[1],10),name:item.match(namePattern)[2],isUniform:item.match(namePattern)[1]===`<uniform>`,type:item.match(typePattern)[1]}));if(!groups)return{groups:[],structs:[]};let structs=wgsl$1.match(structPattern)?.map(struct=>{let name=struct.match(structName)[1],members=struct.match(structMemberPattern).reduce((acc,member)=>{let[name2,type]=member.split(`:`);return acc[name2.trim()]=type.trim(),acc},{});return members?{name,members}:null}).filter(({name})=>groups.some(group=>group.type===name))??[];return{groups,structs}}var ShaderStage=(ShaderStage2=>(ShaderStage2[ShaderStage2.VERTEX=1]=`VERTEX`,ShaderStage2[ShaderStage2.FRAGMENT=2]=`FRAGMENT`,ShaderStage2[ShaderStage2.COMPUTE=4]=`COMPUTE`,ShaderStage2))(ShaderStage||{});function generateGpuLayoutGroups({groups}){let layout$2=[];for(let i$1=0;i$1<groups.length;i$1++){let group=groups[i$1];layout$2[group.group]||(layout$2[group.group]=[]),group.isUniform?layout$2[group.group].push({binding:group.binding,visibility:ShaderStage.VERTEX|ShaderStage.FRAGMENT,buffer:{type:`uniform`}}):group.type===`sampler`?layout$2[group.group].push({binding:group.binding,visibility:ShaderStage.FRAGMENT,sampler:{type:`filtering`}}):group.type===`texture_2d`&&layout$2[group.group].push({binding:group.binding,visibility:ShaderStage.FRAGMENT,texture:{sampleType:`float`,viewDimension:`2d`,multisampled:!1}})}return layout$2}function generateLayoutHash({groups}){let layout$2=[];for(let i$1=0;i$1<groups.length;i$1++){let group=groups[i$1];layout$2[group.group]||(layout$2[group.group]={}),layout$2[group.group][group.name]=group.binding}return layout$2}function removeStructAndGroupDuplicates(vertexStructsAndGroups,fragmentStructsAndGroups){let structNameSet=new Set,dupeGroupKeySet=new Set,structs=[...vertexStructsAndGroups.structs,...fragmentStructsAndGroups.structs].filter(struct=>structNameSet.has(struct.name)?!1:(structNameSet.add(struct.name),!0)),groups=[...vertexStructsAndGroups.groups,...fragmentStructsAndGroups.groups].filter(group=>{let key$1=`${group.name}-${group.binding}`;return dupeGroupKeySet.has(key$1)?!1:(dupeGroupKeySet.add(key$1),!0)});return{structs,groups}}var programCache=Object.create(null),GpuProgram=class GpuProgram{constructor(options){this._layoutKey=0,this._attributeLocationsKey=0;let{fragment:fragment$3,vertex:vertex$3,layout:layout$2,gpuLayout,name}=options;if(this.name=name,this.fragment=fragment$3,this.vertex=vertex$3,fragment$3.source===vertex$3.source)this.structsAndGroups=extractStructAndGroups(fragment$3.source);else{let vertexStructsAndGroups=extractStructAndGroups(vertex$3.source),fragmentStructsAndGroups=extractStructAndGroups(fragment$3.source);this.structsAndGroups=removeStructAndGroupDuplicates(vertexStructsAndGroups,fragmentStructsAndGroups)}this.layout=layout$2??generateLayoutHash(this.structsAndGroups),this.gpuLayout=gpuLayout??generateGpuLayoutGroups(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){let{vertex:vertex$3,fragment:fragment$3}=this,bigKey=vertex$3.source+fragment$3.source+vertex$3.entryPoint+fragment$3.entryPoint;this._layoutKey=createIdFromString(bigKey,`program`)}get attributeData(){return this._attributeData??=extractAttributesFromGpuProgram(this.vertex),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,programCache[this._cacheKey]=null}static from(options){let key$1=`${options.vertex.source}:${options.fragment.source}:${options.fragment.entryPoint}:${options.vertex.entryPoint}`;return programCache[key$1]||(programCache[key$1]=new GpuProgram(options),programCache[key$1]._cacheKey=key$1),programCache[key$1]}},UNIFORM_TYPES_VALUES=[`f32`,`i32`,`vec2<f32>`,`vec3<f32>`,`vec4<f32>`,`mat2x2<f32>`,`mat3x3<f32>`,`mat4x4<f32>`,`mat3x2<f32>`,`mat4x2<f32>`,`mat2x3<f32>`,`mat4x3<f32>`,`mat2x4<f32>`,`mat3x4<f32>`,`vec2<i32>`,`vec3<i32>`,`vec4<i32>`],UNIFORM_TYPES_MAP=UNIFORM_TYPES_VALUES.reduce((acc,type)=>(acc[type]=!0,acc),{});function getDefaultUniformValue(type,size){switch(type){case`f32`:return 0;case`vec2<f32>`:return new Float32Array(2*size);case`vec3<f32>`:return new Float32Array(3*size);case`vec4<f32>`:return new Float32Array(4*size);case`mat2x2<f32>`:return new Float32Array([1,0,0,1]);case`mat3x3<f32>`:return new Float32Array([1,0,0,0,1,0,0,0,1]);case`mat4x4<f32>`:return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var _UniformGroup=class _UniformGroup$1{constructor(uniformStructures,options){this._touched=0,this.uid=uid$1(`uniform`),this._resourceType=`uniformGroup`,this._resourceId=uid$1(`resource`),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,options={..._UniformGroup$1.defaultOptions,...options},this.uniformStructures=uniformStructures;let uniforms={};for(let i$1 in uniformStructures){let uniformData=uniformStructures[i$1];if(uniformData.name=i$1,uniformData.size=uniformData.size??1,!UNIFORM_TYPES_MAP[uniformData.type]){let arrayMatch=uniformData.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(arrayMatch){let[,innerType,size]=arrayMatch;throw Error(`Uniform type ${uniformData.type} is not supported. Use type: '${innerType}', size: ${size} instead.`)}throw Error(`Uniform type ${uniformData.type} is not supported. Supported uniform types are: ${UNIFORM_TYPES_VALUES.join(`, `)}`)}uniformData.value??=getDefaultUniformValue(uniformData.type,uniformData.size),uniforms[i$1]=uniformData.value}this.uniforms=uniforms,this._dirtyId=1,this.ubo=options.ubo,this.isStatic=options.isStatic,this._signature=createIdFromString(Object.keys(uniforms).map(i$1=>`${i$1}-${uniformStructures[i$1].type}`).join(`-`),`uniform-group`)}update(){this._dirtyId++}};_UniformGroup.defaultOptions={ubo:!1,isStatic:!1};var UniformGroup=_UniformGroup,BindGroup=class{constructor(resources){this.resources=Object.create(null),this._dirty=!0;let index=0;for(let i$1 in resources){let resource=resources[i$1];this.setResource(resource,index++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;let keyParts=[],index=0;for(let i$1 in this.resources)keyParts[index++]=this.resources[i$1]._resourceId;this._key=keyParts.join(`|`)}setResource(resource,index){let currentResource=this.resources[index];resource!==currentResource&&(currentResource&&resource.off?.(`change`,this.onResourceChange,this),resource.on?.(`change`,this.onResourceChange,this),this.resources[index]=resource,this._dirty=!0)}getResource(index){return this.resources[index]}_touch(tick){let resources=this.resources;for(let i$1 in resources)resources[i$1]._touched=tick}destroy(){let resources=this.resources;for(let i$1 in resources)resources[i$1]?.off?.(`change`,this.onResourceChange,this);this.resources=null}onResourceChange(resource){if(this._dirty=!0,resource.destroyed){let resources=this.resources;for(let i$1 in resources)resources[i$1]===resource&&(resources[i$1]=null)}else this._updateKey()}},RendererType=(RendererType2=>(RendererType2[RendererType2.WEBGL=1]=`WEBGL`,RendererType2[RendererType2.WEBGPU=2]=`WEBGPU`,RendererType2[RendererType2.BOTH=3]=`BOTH`,RendererType2))(RendererType||{}),Shader=class Shader extends eventemitter3_default{constructor(options){super(),this.uid=uid$1(`shader`),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:gpuProgram$2,glProgram:glProgram$2,groups,resources,compatibleRenderers,groupMap}=options;this.gpuProgram=gpuProgram$2,this.glProgram=glProgram$2,compatibleRenderers===void 0&&(compatibleRenderers=0,gpuProgram$2&&(compatibleRenderers|=RendererType.WEBGPU),glProgram$2&&(compatibleRenderers|=RendererType.WEBGL)),this.compatibleRenderers=compatibleRenderers;let nameHash={};if(!resources&&!groups&&(resources={}),resources&&groups)throw Error(`[Shader] Cannot have both resources and groups`);if(!gpuProgram$2&&groups&&!groupMap)throw Error(`[Shader] No group map or WebGPU shader provided - consider using resources instead.`);if(!gpuProgram$2&&groups&&groupMap)for(let i$1 in groupMap)for(let j$1 in groupMap[i$1]){let uniformName=groupMap[i$1][j$1];nameHash[uniformName]={group:i$1,binding:j$1,name:uniformName}}else if(gpuProgram$2&&groups&&!groupMap){let groupData=gpuProgram$2.structsAndGroups.groups;groupMap={},groupData.forEach(data=>{groupMap[data.group]=groupMap[data.group]||{},groupMap[data.group][data.binding]=data.name,nameHash[data.name]=data})}else if(resources){groups={},groupMap={},gpuProgram$2&&gpuProgram$2.structsAndGroups.groups.forEach(data=>{groupMap[data.group]=groupMap[data.group]||{},groupMap[data.group][data.binding]=data.name,nameHash[data.name]=data});let bindTick=0;for(let i$1 in resources)nameHash[i$1]||(groups[99]||(groups[99]=new BindGroup,this._ownedBindGroups.push(groups[99])),nameHash[i$1]={group:99,binding:bindTick,name:i$1},groupMap[99]=groupMap[99]||{},groupMap[99][bindTick]=i$1,bindTick++);for(let i$1 in resources){let name=i$1,value=resources[i$1];!value.source&&!value._resourceType&&(value=new UniformGroup(value));let data=nameHash[name];data&&(groups[data.group]||(groups[data.group]=new BindGroup,this._ownedBindGroups.push(groups[data.group])),groups[data.group].setResource(value,data.binding))}}this.groups=groups,this._uniformBindMap=groupMap,this.resources=this._buildResourceAccessor(groups,nameHash)}addResource(name,groupIndex,bindIndex){var _a$1,_b$1;(_a$1=this._uniformBindMap)[groupIndex]||(_a$1[groupIndex]={}),(_b$1=this._uniformBindMap[groupIndex])[bindIndex]||(_b$1[bindIndex]=name),this.groups[groupIndex]||(this.groups[groupIndex]=new BindGroup,this._ownedBindGroups.push(this.groups[groupIndex]))}_buildResourceAccessor(groups,nameHash){let uniformsOut={};for(let i$1 in nameHash){let data=nameHash[i$1];Object.defineProperty(uniformsOut,data.name,{get(){return groups[data.group].getResource(data.binding)},set(value){groups[data.group].setResource(value,data.binding)}})}return uniformsOut}destroy(destroyPrograms=!1){this.emit(`destroy`,this),destroyPrograms&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(bindGroup=>{bindGroup.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(options){let{gpu,gl,...rest}=options,gpuProgram$2,glProgram$2;return gpu&&(gpuProgram$2=GpuProgram.from(gpu)),gl&&(glProgram$2=GlProgram.from(gl)),new Shader({gpuProgram:gpuProgram$2,glProgram:glProgram$2,...rest})}},blendModeIds={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},BLEND$1=0,OFFSET$2=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5,_State=class _State$1{constructor(){this.data=0,this.blendMode=`normal`,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(value){!!(this.data&1<<BLEND$1)!==value&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$2)}set offsets(value){!!(this.data&1<<OFFSET$2)!==value&&(this.data^=1<<OFFSET$2)}set cullMode(value){if(value===`none`){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=value===`front`}get cullMode(){return this.culling?this.clockwiseFrontFace?`front`:`back`:`none`}get culling(){return!!(this.data&1<<CULLING$1)}set culling(value){!!(this.data&1<<CULLING$1)!==value&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(value){!!(this.data&1<<DEPTH_TEST$1)!==value&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(value){!!(this.data&1<<DEPTH_MASK$1)!==value&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(value){!!(this.data&1<<WINDING$1)!==value&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(value){this.blend=value!==`none`,this._blendMode=value,this._blendModeId=blendModeIds[value]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(value){this.offsets=!!value,this._polygonOffset=value}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let state=new _State$1;return state.depthTest=!1,state.blend=!0,state}};_State.default2d=_State.for2d();var State=_State,_Filter=class _Filter$1 extends Shader{constructor(options){options={..._Filter$1.defaultOptions,...options},super(options),this.enabled=!0,this._state=State.for2d(),this.blendMode=options.blendMode,this.padding=options.padding,typeof options.antialias==`boolean`?this.antialias=options.antialias?`on`:`off`:this.antialias=options.antialias,this.resolution=options.resolution,this.blendRequired=options.blendRequired,this.clipToViewport=options.clipToViewport,this.addResource(`uTexture`,0,1)}apply(filterManager,input,output,clearMode){filterManager.applyFilter(this,input,output,clearMode)}get blendMode(){return this._state.blendMode}set blendMode(value){this._state.blendMode=value}static from(options){let{gpu,gl,...rest}=options,gpuProgram$2,glProgram$2;return gpu&&(gpuProgram$2=GpuProgram.from(gpu)),gl&&(glProgram$2=GlProgram.from(gl)),new _Filter$1({gpuProgram:gpuProgram$2,glProgram:glProgram$2,...rest})}};_Filter.defaultOptions={blendMode:`normal`,resolution:1,padding:0,antialias:`off`,blendRequired:!1,clipToViewport:!0};var Filter=_Filter,environments=[];extensions$1.handleByNamedList(ExtensionType.Environment,environments);async function loadEnvironmentExtensions(skip){if(!skip)for(let i$1=0;i$1<environments.length;i$1++){let env$1=environments[i$1];if(env$1.value.test()){await env$1.value.load();return}}}var unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval==`boolean`)return unsafeEval;try{unsafeEval=Function(`param1`,`param2`,`param3`,`return param1[param2] === param3;`)({a:`b`},`a`,`b`)===!0}catch{unsafeEval=!1}return unsafeEval}function earcut$1(data,holeIndices,dim=2){let hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,!0),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;let minX,minY,invSize;if(hasHoles&&(outerNode=eliminateHoles(data,holeIndices,outerNode,dim)),data.length>80*dim){minX=data[0],minY=data[1];let maxX=minX,maxY=minY;for(let i$1=dim;i$1<outerLen;i$1+=dim){let x$1=data[i$1],y$1=data[i$1+1];x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1),x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1)}invSize=Math.max(maxX-minX,maxY-minY),invSize=invSize===0?0:32767/invSize}return earcutLinked(outerNode,triangles,dim,minX,minY,invSize,0),triangles}function linkedList(data,start$1,end$1,dim,clockwise){let last;if(clockwise===signedArea(data,start$1,end$1,dim)>0)for(let i$1=start$1;i$1<end$1;i$1+=dim)last=insertNode(i$1/dim|0,data[i$1],data[i$1+1],last);else for(let i$1=end$1-dim;i$1>=start$1;i$1-=dim)last=insertNode(i$1/dim|0,data[i$1],data[i$1+1],last);return last&&equals(last,last.next)&&(removeNode(last),last=last.next),last}function filterPoints(start$1,end$1){if(!start$1)return start$1;end$1||=start$1;let p$2=start$1,again;do if(again=!1,!p$2.steiner&&(equals(p$2,p$2.next)||area(p$2.prev,p$2,p$2.next)===0)){if(removeNode(p$2),p$2=end$1=p$2.prev,p$2===p$2.next)break;again=!0}else p$2=p$2.next;while(again||p$2!==end$1);return end$1}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(!ear)return;!pass&&invSize&&indexCurve(ear,minX,minY,invSize);let stop$2=ear;for(;ear.prev!==ear.next;){let prev=ear.prev,next=ear.next;if(invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear)){triangles.push(prev.i,ear.i,next.i),removeNode(ear),ear=next.next,stop$2=next.next;continue}if(ear=next,ear===stop$2){pass?pass===1?(ear=cureLocalIntersections(filterPoints(ear),triangles),earcutLinked(ear,triangles,dim,minX,minY,invSize,2)):pass===2&&splitEarcut(ear,triangles,dim,minX,minY,invSize):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);break}}}function isEar(ear){let a$1=ear.prev,b$1=ear,c$2=ear.next;if(area(a$1,b$1,c$2)>=0)return!1;let ax=a$1.x,bx=b$1.x,cx=c$2.x,ay=a$1.y,by=b$1.y,cy=c$2.y,x0=Math.min(ax,bx,cx),y0=Math.min(ay,by,cy),x1=Math.max(ax,bx,cx),y1=Math.max(ay,by,cy),p$2=c$2.next;for(;p$2!==a$1;){if(p$2.x>=x0&&p$2.x<=x1&&p$2.y>=y0&&p$2.y<=y1&&pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,p$2.x,p$2.y)&&area(p$2.prev,p$2,p$2.next)>=0)return!1;p$2=p$2.next}return!0}function isEarHashed(ear,minX,minY,invSize){let a$1=ear.prev,b$1=ear,c$2=ear.next;if(area(a$1,b$1,c$2)>=0)return!1;let ax=a$1.x,bx=b$1.x,cx=c$2.x,ay=a$1.y,by=b$1.y,cy=c$2.y,x0=Math.min(ax,bx,cx),y0=Math.min(ay,by,cy),x1=Math.max(ax,bx,cx),y1=Math.max(ay,by,cy),minZ=zOrder(x0,y0,minX,minY,invSize),maxZ=zOrder(x1,y1,minX,minY,invSize),p$2=ear.prevZ,n$1=ear.nextZ;for(;p$2&&p$2.z>=minZ&&n$1&&n$1.z<=maxZ;){if(p$2.x>=x0&&p$2.x<=x1&&p$2.y>=y0&&p$2.y<=y1&&p$2!==a$1&&p$2!==c$2&&pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,p$2.x,p$2.y)&&area(p$2.prev,p$2,p$2.next)>=0||(p$2=p$2.prevZ,n$1.x>=x0&&n$1.x<=x1&&n$1.y>=y0&&n$1.y<=y1&&n$1!==a$1&&n$1!==c$2&&pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,n$1.x,n$1.y)&&area(n$1.prev,n$1,n$1.next)>=0))return!1;n$1=n$1.nextZ}for(;p$2&&p$2.z>=minZ;){if(p$2.x>=x0&&p$2.x<=x1&&p$2.y>=y0&&p$2.y<=y1&&p$2!==a$1&&p$2!==c$2&&pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,p$2.x,p$2.y)&&area(p$2.prev,p$2,p$2.next)>=0)return!1;p$2=p$2.prevZ}for(;n$1&&n$1.z<=maxZ;){if(n$1.x>=x0&&n$1.x<=x1&&n$1.y>=y0&&n$1.y<=y1&&n$1!==a$1&&n$1!==c$2&&pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,n$1.x,n$1.y)&&area(n$1.prev,n$1,n$1.next)>=0)return!1;n$1=n$1.nextZ}return!0}function cureLocalIntersections(start$1,triangles){let p$2=start$1;do{let a$1=p$2.prev,b$1=p$2.next.next;!equals(a$1,b$1)&&intersects(a$1,p$2,p$2.next,b$1)&&locallyInside(a$1,b$1)&&locallyInside(b$1,a$1)&&(triangles.push(a$1.i,p$2.i,b$1.i),removeNode(p$2),removeNode(p$2.next),p$2=start$1=b$1),p$2=p$2.next}while(p$2!==start$1);return filterPoints(p$2)}function splitEarcut(start$1,triangles,dim,minX,minY,invSize){let a$1=start$1;do{let b$1=a$1.next.next;for(;b$1!==a$1.prev;){if(a$1.i!==b$1.i&&isValidDiagonal(a$1,b$1)){let c$2=splitPolygon(a$1,b$1);a$1=filterPoints(a$1,a$1.next),c$2=filterPoints(c$2,c$2.next),earcutLinked(a$1,triangles,dim,minX,minY,invSize,0),earcutLinked(c$2,triangles,dim,minX,minY,invSize,0);return}b$1=b$1.next}a$1=a$1.next}while(a$1!==start$1)}function eliminateHoles(data,holeIndices,outerNode,dim){let queue$1=[];for(let i$1=0,len$1=holeIndices.length;i$1<len$1;i$1++){let start$1=holeIndices[i$1]*dim,end$1=i$1<len$1-1?holeIndices[i$1+1]*dim:data.length,list=linkedList(data,start$1,end$1,dim,!1);list===list.next&&(list.steiner=!0),queue$1.push(getLeftmost(list))}queue$1.sort(compareXYSlope);for(let i$1=0;i$1<queue$1.length;i$1++)outerNode=eliminateHole(queue$1[i$1],outerNode);return outerNode}function compareXYSlope(a$1,b$1){let result=a$1.x-b$1.x;if(result===0&&(result=a$1.y-b$1.y,result===0)){let aSlope=(a$1.next.y-a$1.y)/(a$1.next.x-a$1.x),bSlope=(b$1.next.y-b$1.y)/(b$1.next.x-b$1.x);result=aSlope-bSlope}return result}function eliminateHole(hole,outerNode){let bridge=findHoleBridge(hole,outerNode);if(!bridge)return outerNode;let bridgeReverse=splitPolygon(bridge,hole);return filterPoints(bridgeReverse,bridgeReverse.next),filterPoints(bridge,bridge.next)}function findHoleBridge(hole,outerNode){let p$2=outerNode,hx=hole.x,hy=hole.y,qx=-1/0,m$2;if(equals(hole,p$2))return p$2;do{if(equals(hole,p$2.next))return p$2.next;if(hy<=p$2.y&&hy>=p$2.next.y&&p$2.next.y!==p$2.y){let x$1=p$2.x+(hy-p$2.y)*(p$2.next.x-p$2.x)/(p$2.next.y-p$2.y);if(x$1<=hx&&x$1>qx&&(qx=x$1,m$2=p$2.x<p$2.next.x?p$2:p$2.next,x$1===hx))return m$2}p$2=p$2.next}while(p$2!==outerNode);if(!m$2)return null;let stop$2=m$2,mx=m$2.x,my=m$2.y,tanMin=1/0;p$2=m$2;do{if(hx>=p$2.x&&p$2.x>=mx&&hx!==p$2.x&&pointInTriangle$1(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p$2.x,p$2.y)){let tan=Math.abs(hy-p$2.y)/(hx-p$2.x);locallyInside(p$2,hole)&&(tan<tanMin||tan===tanMin&&(p$2.x>m$2.x||p$2.x===m$2.x&&sectorContainsSector(m$2,p$2)))&&(m$2=p$2,tanMin=tan)}p$2=p$2.next}while(p$2!==stop$2);return m$2}function sectorContainsSector(m$2,p$2){return area(m$2.prev,m$2,p$2.prev)<0&&area(p$2.next,m$2,m$2.next)<0}function indexCurve(start$1,minX,minY,invSize){let p$2=start$1;do p$2.z===0&&(p$2.z=zOrder(p$2.x,p$2.y,minX,minY,invSize)),p$2.prevZ=p$2.prev,p$2.nextZ=p$2.next,p$2=p$2.next;while(p$2!==start$1);p$2.prevZ.nextZ=null,p$2.prevZ=null,sortLinked(p$2)}function sortLinked(list){let numMerges,inSize=1;do{let p$2=list,e$2;list=null;let tail=null;for(numMerges=0;p$2;){numMerges++;let q$1=p$2,pSize=0;for(let i$1=0;i$1<inSize&&(pSize++,q$1=q$1.nextZ,q$1);i$1++);let qSize=inSize;for(;pSize>0||qSize>0&&q$1;)pSize!==0&&(qSize===0||!q$1||p$2.z<=q$1.z)?(e$2=p$2,p$2=p$2.nextZ,pSize--):(e$2=q$1,q$1=q$1.nextZ,qSize--),tail?tail.nextZ=e$2:list=e$2,e$2.prevZ=tail,tail=e$2;p$2=q$1}tail.nextZ=null,inSize*=2}while(numMerges>1);return list}function zOrder(x$1,y$1,minX,minY,invSize){return x$1=(x$1-minX)*invSize|0,y$1=(y$1-minY)*invSize|0,x$1=(x$1|x$1<<8)&16711935,x$1=(x$1|x$1<<4)&252645135,x$1=(x$1|x$1<<2)&858993459,x$1=(x$1|x$1<<1)&1431655765,y$1=(y$1|y$1<<8)&16711935,y$1=(y$1|y$1<<4)&252645135,y$1=(y$1|y$1<<2)&858993459,y$1=(y$1|y$1<<1)&1431655765,x$1|y$1<<1}function getLeftmost(start$1){let p$2=start$1,leftmost=start$1;do(p$2.x<leftmost.x||p$2.x===leftmost.x&&p$2.y<leftmost.y)&&(leftmost=p$2),p$2=p$2.next;while(p$2!==start$1);return leftmost}function pointInTriangle$1(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)>=(ax-px)*(cy-py)&&(ax-px)*(by-py)>=(bx-px)*(ay-py)&&(bx-px)*(cy-py)>=(cx-px)*(by-py)}function pointInTriangleExceptFirst(ax,ay,bx,by,cx,cy,px,py){return!(ax===px&&ay===py)&&pointInTriangle$1(ax,ay,bx,by,cx,cy,px,py)}function isValidDiagonal(a$1,b$1){return a$1.next.i!==b$1.i&&a$1.prev.i!==b$1.i&&!intersectsPolygon(a$1,b$1)&&(locallyInside(a$1,b$1)&&locallyInside(b$1,a$1)&&middleInside(a$1,b$1)&&(area(a$1.prev,a$1,b$1.prev)||area(a$1,b$1.prev,b$1))||equals(a$1,b$1)&&area(a$1.prev,a$1,a$1.next)>0&&area(b$1.prev,b$1,b$1.next)>0)}function area(p$2,q$1,r$1){return(q$1.y-p$2.y)*(r$1.x-q$1.x)-(q$1.x-p$2.x)*(r$1.y-q$1.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){let o1=sign(area(p1,q1,p2)),o2=sign(area(p1,q1,q2)),o3=sign(area(p2,q2,p1)),o4=sign(area(p2,q2,q1));return!!(o1!==o2&&o3!==o4||o1===0&&onSegment(p1,p2,q1)||o2===0&&onSegment(p1,q2,q1)||o3===0&&onSegment(p2,p1,q2)||o4===0&&onSegment(p2,q1,q2))}function onSegment(p$2,q$1,r$1){return q$1.x<=Math.max(p$2.x,r$1.x)&&q$1.x>=Math.min(p$2.x,r$1.x)&&q$1.y<=Math.max(p$2.y,r$1.y)&&q$1.y>=Math.min(p$2.y,r$1.y)}function sign(num){return num>0?1:num<0?-1:0}function intersectsPolygon(a$1,b$1){let p$2=a$1;do{if(p$2.i!==a$1.i&&p$2.next.i!==a$1.i&&p$2.i!==b$1.i&&p$2.next.i!==b$1.i&&intersects(p$2,p$2.next,a$1,b$1))return!0;p$2=p$2.next}while(p$2!==a$1);return!1}function locallyInside(a$1,b$1){return area(a$1.prev,a$1,a$1.next)<0?area(a$1,b$1,a$1.next)>=0&&area(a$1,a$1.prev,b$1)>=0:area(a$1,b$1,a$1.prev)<0||area(a$1,a$1.next,b$1)<0}function middleInside(a$1,b$1){let p$2=a$1,inside=!1,px=(a$1.x+b$1.x)/2,py=(a$1.y+b$1.y)/2;do p$2.y>py!=p$2.next.y>py&&p$2.next.y!==p$2.y&&px<(p$2.next.x-p$2.x)*(py-p$2.y)/(p$2.next.y-p$2.y)+p$2.x&&(inside=!inside),p$2=p$2.next;while(p$2!==a$1);return inside}function splitPolygon(a$1,b$1){let a2=createNode(a$1.i,a$1.x,a$1.y),b2=createNode(b$1.i,b$1.x,b$1.y),an=a$1.next,bp=b$1.prev;return a$1.next=b$1,b$1.prev=a$1,a2.next=an,an.prev=a2,b2.next=a2,a2.prev=b2,bp.next=b2,b2.prev=bp,b2}function insertNode(i$1,x$1,y$1,last){let p$2=createNode(i$1,x$1,y$1);return last?(p$2.next=last.next,p$2.prev=last,last.next.prev=p$2,last.next=p$2):(p$2.prev=p$2,p$2.next=p$2),p$2}function removeNode(p$2){p$2.next.prev=p$2.prev,p$2.prev.next=p$2.next,p$2.prevZ&&(p$2.prevZ.nextZ=p$2.nextZ),p$2.nextZ&&(p$2.nextZ.prevZ=p$2.prevZ)}function createNode(i$1,x$1,y$1){return{i:i$1,x:x$1,y:y$1,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function signedArea(data,start$1,end$1,dim){let sum=0;for(let i$1=start$1,j$1=end$1-dim;i$1<end$1;i$1+=dim)sum+=(data[j$1]-data[i$1])*(data[i$1+1]+data[j$1+1]),j$1=i$1;return sum}var earcut=earcut$1.default||earcut$1,CLEAR=(CLEAR2=>(CLEAR2[CLEAR2.NONE=0]=`NONE`,CLEAR2[CLEAR2.COLOR=16384]=`COLOR`,CLEAR2[CLEAR2.STENCIL=1024]=`STENCIL`,CLEAR2[CLEAR2.DEPTH=256]=`DEPTH`,CLEAR2[CLEAR2.COLOR_DEPTH=16640]=`COLOR_DEPTH`,CLEAR2[CLEAR2.COLOR_STENCIL=17408]=`COLOR_STENCIL`,CLEAR2[CLEAR2.DEPTH_STENCIL=1280]=`DEPTH_STENCIL`,CLEAR2[CLEAR2.ALL=17664]=`ALL`,CLEAR2))(CLEAR||{}),SystemRunner=class{constructor(name){this.items=[],this._name=name}emit(a0,a1,a2,a3,a4,a5,a6,a7){let{name,items}=this;for(let i$1=0,len$1=items.length;i$1<len$1;i$1++)items[i$1][name](a0,a1,a2,a3,a4,a5,a6,a7);return this}add(item){return item[this._name]&&(this.remove(item),this.items.push(item)),this}remove(item){let index=this.items.indexOf(item);return index!==-1&&this.items.splice(index,1),this}contains(item){return this.items.indexOf(item)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}},defaultRunners=[`init`,`destroy`,`contextChange`,`resolutionChange`,`resetState`,`renderEnd`,`renderStart`,`render`,`update`,`postrender`,`prerender`],_AbstractRenderer=class _AbstractRenderer$1 extends eventemitter3_default{constructor(config){super(),this.uid=uid$1(`renderer`),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=config.type,this.name=config.name,this.config=config;let combinedRunners=[...defaultRunners,...this.config.runners??[]];this._addRunners(...combinedRunners),this._unsafeEvalCheck()}async init(options={}){let skip=options.skipExtensionImports===!0?!0:options.manageImports===!1;for(let systemName in await loadEnvironmentExtensions(skip),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors),this._systemsHash)options={...this._systemsHash[systemName].constructor.defaultOptions,...options};options={..._AbstractRenderer$1.defaultOptions,...options},this._roundPixels=options.roundPixels?1:0;for(let i$1=0;i$1<this.runners.init.items.length;i$1++)await this.runners.init.items[i$1].init(options);this._initOptions=options}render(args,deprecated){let options=args;options instanceof Container&&(options={container:options},deprecated&&(deprecation(v8_0_0,`passing a second argument is deprecated, please use render options instead`),options.target=deprecated.renderTexture)),options.target||=this.view.renderTarget,options.target===this.view.renderTarget&&(this._lastObjectRendered=options.container,options.clearColor??=this.background.colorRgba,options.clear??=this.background.clearBeforeRender),options.clearColor&&=Array.isArray(options.clearColor)&&options.clearColor.length===4?options.clearColor:Color.shared.setValue(options.clearColor).toArray(),options.transform||=(options.container.updateLocalTransform(),options.container.localTransform),options.container.visible&&(options.container.enableRenderGroup(),this.runners.prerender.emit(options),this.runners.renderStart.emit(options),this.runners.render.emit(options),this.runners.renderEnd.emit(options),this.runners.postrender.emit(options))}resize(desiredScreenWidth,desiredScreenHeight,resolution){let previousResolution=this.view.resolution;this.view.resize(desiredScreenWidth,desiredScreenHeight,resolution),this.emit(`resize`,this.view.screen.width,this.view.screen.height,this.view.resolution),resolution!==void 0&&resolution!==previousResolution&&this.runners.resolutionChange.emit(resolution)}clear(options={}){let renderer$1=this;options.target||=renderer$1.renderTarget.renderTarget,options.clearColor||=this.background.colorRgba,options.clear??=CLEAR.ALL;let{clear:clear$1,clearColor,target}=options;Color.shared.setValue(clearColor??this.background.colorRgba),renderer$1.renderTarget.clear(target,clear$1,Color.shared.toArray())}get resolution(){return this.view.resolution}set resolution(value){this.view.resolution=value,this.runners.resolutionChange.emit(value)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...runnerIds){runnerIds.forEach(runnerId=>{this.runners[runnerId]=new SystemRunner(runnerId)})}_addSystems(systems$2){let i$1;for(i$1 in systems$2){let val=systems$2[i$1];this._addSystem(val.value,val.name)}}_addSystem(ClassRef,name){let system=new ClassRef(this);if(this[name])throw Error(`Whoops! The name "${name}" is already in use`);for(let i$1 in this[name]=system,this._systemsHash[name]=system,this.runners)this.runners[i$1].add(system);return this}_addPipes(pipes,pipeAdaptors){let adaptors=pipeAdaptors.reduce((acc,adaptor)=>(acc[adaptor.name]=adaptor.value,acc),{});pipes.forEach(pipe=>{let PipeClass=pipe.value,name=pipe.name,Adaptor=adaptors[name];this.renderPipes[name]=new PipeClass(this,Adaptor?new Adaptor:null),this.runners.destroy.add(this.renderPipes[name])})}destroy(options=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(options),Object.values(this.runners).forEach(runner=>{runner.destroy()}),(options===!0||typeof options==`object`&&options.releaseGlobalResources)&&GlobalResourceRegistry.release(),this._systemsHash=null,this.renderPipes=null}generateTexture(options){return this.textureGenerator.generateTexture(options)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!unsafeEvalSupported())throw Error(`Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.`)}resetState(){this.runners.resetState.emit()}};_AbstractRenderer.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};var AbstractRenderer=_AbstractRenderer,_isWebGLSupported;function isWebGLSupported(failIfMajorPerformanceCaveat){return _isWebGLSupported===void 0&&(_isWebGLSupported=(()=>{let contextOptions={stencil:!0,failIfMajorPerformanceCaveat:failIfMajorPerformanceCaveat??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat};try{if(!DOMAdapter.get().getWebGLRenderingContext())return!1;let gl=DOMAdapter.get().createCanvas().getContext(`webgl`,contextOptions),success=!!gl?.getContextAttributes()?.stencil;if(gl){let loseContext=gl.getExtension(`WEBGL_lose_context`);loseContext&&loseContext.loseContext()}return gl=null,success}catch{return!1}})()),_isWebGLSupported}var _isWebGPUSupported;async function isWebGPUSupported(options={}){return _isWebGPUSupported===void 0&&(_isWebGPUSupported=await(async()=>{let gpu=DOMAdapter.get().getNavigator().gpu;if(!gpu)return!1;try{return await(await gpu.requestAdapter(options)).requestDevice(),!0}catch{return!1}})()),_isWebGPUSupported}var renderPriority=[`webgl`,`webgpu`,`canvas`];async function autoDetectRenderer(options){let preferredOrder=[];options.preference?(preferredOrder.push(options.preference),renderPriority.forEach(item=>{item!==options.preference&&preferredOrder.push(item)})):preferredOrder=renderPriority.slice();let RendererClass,finalOptions={};for(let i$1=0;i$1<preferredOrder.length;i$1++){let rendererType=preferredOrder[i$1];if(rendererType===`webgpu`&&await isWebGPUSupported()){let{WebGPURenderer:WebGPURenderer$1}=await __vitePreload(async()=>{let{WebGPURenderer:WebGPURenderer$2}=await import(`./WebGPURenderer-DWW9kQwX.js`);return{WebGPURenderer:WebGPURenderer$2}},[]);RendererClass=WebGPURenderer$1,finalOptions={...options,...options.webgpu};break}else if(rendererType===`webgl`&&isWebGLSupported(options.failIfMajorPerformanceCaveat??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat)){let{WebGLRenderer:WebGLRenderer$1}=await __vitePreload(async()=>{let{WebGLRenderer:WebGLRenderer$2}=await import(`./WebGLRenderer-Dg0nfP2d.js`);return{WebGLRenderer:WebGLRenderer$2}},[]);RendererClass=WebGLRenderer$1,finalOptions={...options,...options.webgl};break}else if(rendererType===`canvas`)throw finalOptions={...options},Error(`CanvasRenderer is not yet implemented`)}if(delete finalOptions.webgpu,delete finalOptions.webgl,!RendererClass)throw Error(`No available renderer for the current environment`);let renderer$1=new RendererClass;return await renderer$1.init(finalOptions),renderer$1}var VERSION=`8.14.0`,ApplicationInitHook=class{static init(){globalThis.__PIXI_APP_INIT__?.(this,VERSION)}static destroy(){}};ApplicationInitHook.extension=ExtensionType.Application;var RendererInitHook=class{constructor(renderer$1){this._renderer=renderer$1}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,VERSION)}destroy(){this._renderer=null}};RendererInitHook.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`initHook`,priority:-10};var _Application=class _Application$1{constructor(...args){this.stage=new Container,args[0]!==void 0&&deprecation(v8_0_0,`Application constructor options are deprecated, please use Application.init() instead.`)}async init(options){options={...options},this.renderer=await autoDetectRenderer(options),_Application$1._plugins.forEach(plugin=>{plugin.init.call(this,options)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return deprecation(v8_0_0,`Application.view is deprecated, please use Application.canvas instead.`),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(rendererDestroyOptions=!1,options=!1){let plugins=_Application$1._plugins.slice(0);plugins.reverse(),plugins.forEach(plugin=>{plugin.destroy.call(this)}),this.stage.destroy(options),this.stage=null,this.renderer.destroy(rendererDestroyOptions),this.renderer=null}};_Application._plugins=[];var Application=_Application;extensions$1.handleByList(ExtensionType.Application,Application._plugins),extensions$1.add(ApplicationInitHook);var ResizePlugin=class{static init(options){Object.defineProperty(this,`resizeTo`,{set(dom){globalThis.removeEventListener(`resize`,this.queueResize),this._resizeTo=dom,dom&&(globalThis.addEventListener(`resize`,this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&=(cancelAnimationFrame(this._resizeId),null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let width,height;if(this._resizeTo===globalThis.window)width=globalThis.innerWidth,height=globalThis.innerHeight;else{let{clientWidth,clientHeight}=this._resizeTo;width=clientWidth,height=clientHeight}this.renderer.resize(width,height),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=options.resizeTo||null}static destroy(){globalThis.removeEventListener(`resize`,this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};ResizePlugin.extension=ExtensionType.Application;var TickerPlugin=class{static init(options){options=Object.assign({autoStart:!0,sharedTicker:!1},options),Object.defineProperty(this,`ticker`,{set(ticker){this._ticker&&this._ticker.remove(this.render,this),this._ticker=ticker,ticker&&ticker.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=options.sharedTicker?Ticker.shared:new Ticker,options.autoStart&&this.start()}static destroy(){if(this._ticker){let oldTicker=this._ticker;this.ticker=null,oldTicker.destroy()}}};TickerPlugin.extension=ExtensionType.Application;var AbstractBitmapFont=class extends eventemitter3_default{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily=``,this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:`none`,range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return deprecation(v8_0_0,`BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead.`),this.fontFamily}get pageTextures(){return deprecation(v8_0_0,`BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.`),this.pages}get size(){return deprecation(v8_0_0,`BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead.`),this.fontMetrics.fontSize}get distanceFieldRange(){return deprecation(v8_0_0,`BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead.`),this.distanceField.range}get distanceFieldType(){return deprecation(v8_0_0,`BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead.`),this.distanceField.type}destroy(destroyTextures=!1){for(let i$1 in this.emit(`destroy`,this),this.removeAllListeners(),this.chars)this.chars[i$1].texture?.destroy();this.chars=null,destroyTextures&&(this.pages.forEach(page=>page.texture.destroy(!0)),this.pages=null)}},LRU$1=class{constructor(max$2=0,ttl=0,resetTtl=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=max$2,this.resetTtl=resetTtl,this.size=0,this.ttl=ttl}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(key$1){if(this.has(key$1)){let item=this.items[key$1];delete this.items[key$1],this.size--,item.prev!==null&&(item.prev.next=item.next),item.next!==null&&(item.next.prev=item.prev),this.first===item&&(this.first=item.next),this.last===item&&(this.last=item.prev)}return this}entries(keys$1=this.keys()){return keys$1.map(key$1=>[key$1,this.get(key$1)])}evict(bypass=!1){if(bypass||this.size>0){let item=this.first;delete this.items[item.key],--this.size===0?(this.first=null,this.last=null):(this.first=item.next,this.first.prev=null)}return this}expiresAt(key$1){let result;return this.has(key$1)&&(result=this.items[key$1].expiry),result}get(key$1){let item=this.items[key$1];if(item!==void 0){if(this.ttl>0&&item.expiry<=Date.now()){this.delete(key$1);return}return this.moveToEnd(item),item.value}}has(key$1){return key$1 in this.items}moveToEnd(item){this.last!==item&&(item.prev!==null&&(item.prev.next=item.next),item.next!==null&&(item.next.prev=item.prev),this.first===item&&(this.first=item.next),item.prev=this.last,item.next=null,this.last!==null&&(this.last.next=item),this.last=item,this.first===null&&(this.first=item))}keys(){let result=[],x$1=this.first;for(;x$1!==null;)result.push(x$1.key),x$1=x$1.next;return result}setWithEvicted(key$1,value,resetTtl=this.resetTtl){let evicted=null;if(this.has(key$1))this.set(key$1,value,!0,resetTtl);else{this.max>0&&this.size===this.max&&(evicted={...this.first},this.evict(!0));let item=this.items[key$1]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:key$1,prev:this.last,next:null,value};++this.size===1?this.first=item:this.last.next=item,this.last=item}return evicted}set(key$1,value,bypass=!1,resetTtl=this.resetTtl){let item=this.items[key$1];return bypass||item!==void 0?(item.value=value,bypass===!1&&resetTtl&&(item.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(item)):(this.max>0&&this.size===this.max&&this.evict(!0),item=this.items[key$1]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:key$1,prev:this.last,next:null,value},++this.size===1?this.first=item:this.last.next=item,this.last=item),this}values(keys$1=this.keys()){return keys$1.map(key$1=>this.get(key$1))}};function lru(max$2=1e3,ttl=0,resetTtl=!1){if(isNaN(max$2)||max$2<0)throw TypeError(`Invalid max value`);if(isNaN(ttl)||ttl<0)throw TypeError(`Invalid ttl value`);if(typeof resetTtl!=`boolean`)throw TypeError(`Invalid resetTtl value`);return new LRU$1(max$2,ttl,resetTtl)}var genericFontFamilies=[`serif`,`sans-serif`,`monospace`,`cursive`,`fantasy`,`system-ui`];function fontStringFromTextStyle(style){let fontSizeString=typeof style.fontSize==`number`?`${style.fontSize}px`:style.fontSize,fontFamilies=style.fontFamily;Array.isArray(style.fontFamily)||(fontFamilies=style.fontFamily.split(`,`));for(let i$1=fontFamilies.length-1;i$1>=0;i$1--){let fontFamily=fontFamilies[i$1].trim();!/([\"\'])[^\'\"]+\1/.test(fontFamily)&&!genericFontFamilies.includes(fontFamily)&&(fontFamily=`"${fontFamily}"`),fontFamilies[i$1]=fontFamily}return`${style.fontStyle} ${style.fontVariant} ${style.fontWeight} ${fontSizeString} ${fontFamilies.join(`,`)}`}var contextSettings={willReadFrequently:!0},_CanvasTextMetrics=class _CanvasTextMetrics$1{static get experimentalLetterSpacingSupported(){let result=_CanvasTextMetrics$1._experimentalLetterSpacingSupported;if(result===void 0){let proto=DOMAdapter.get().getCanvasRenderingContext2D().prototype;result=_CanvasTextMetrics$1._experimentalLetterSpacingSupported=`letterSpacing`in proto||`textLetterSpacing`in proto}return result}constructor(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){this.text=text,this.style=style,this.width=width,this.height=height,this.lines=lines,this.lineWidths=lineWidths,this.lineHeight=lineHeight,this.maxLineWidth=maxLineWidth,this.fontProperties=fontProperties}static measureText(text=` `,style,canvas=_CanvasTextMetrics$1._canvas,wordWrap=style.wordWrap){let textKey=`${text}-${style.styleKey}-wordWrap-${wordWrap}`;if(_CanvasTextMetrics$1._measurementCache.has(textKey))return _CanvasTextMetrics$1._measurementCache.get(textKey);let font=fontStringFromTextStyle(style),fontProperties=_CanvasTextMetrics$1.measureFont(font);fontProperties.fontSize===0&&(fontProperties.fontSize=style.fontSize,fontProperties.ascent=style.fontSize);let context$1=_CanvasTextMetrics$1.__context;context$1.font=font;let lines=(wordWrap?_CanvasTextMetrics$1._wordWrap(text,style,canvas):text).split(/(?:\r\n|\r|\n)/),lineWidths=Array(lines.length),maxLineWidth=0;for(let i$1=0;i$1<lines.length;i$1++){let lineWidth=_CanvasTextMetrics$1._measureText(lines[i$1],style.letterSpacing,context$1);lineWidths[i$1]=lineWidth,maxLineWidth=Math.max(maxLineWidth,lineWidth)}let strokeWidth=style._stroke?.width||0,width=maxLineWidth+strokeWidth;style.dropShadow&&(width+=style.dropShadow.distance);let lineHeight=style.lineHeight||fontProperties.fontSize,height=Math.max(lineHeight,fontProperties.fontSize+strokeWidth)+(lines.length-1)*(lineHeight+style.leading);style.dropShadow&&(height+=style.dropShadow.distance);let measurements=new _CanvasTextMetrics$1(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties);return _CanvasTextMetrics$1._measurementCache.set(textKey,measurements),measurements}static _measureText(text,letterSpacing,context$1){let useExperimentalLetterSpacing=!1;_CanvasTextMetrics$1.experimentalLetterSpacingSupported&&(_CanvasTextMetrics$1.experimentalLetterSpacing?(context$1.letterSpacing=`${letterSpacing}px`,context$1.textLetterSpacing=`${letterSpacing}px`,useExperimentalLetterSpacing=!0):(context$1.letterSpacing=`0px`,context$1.textLetterSpacing=`0px`));let metrics=context$1.measureText(text),metricWidth=metrics.width,actualBoundingBoxLeft=-metrics.actualBoundingBoxLeft,boundsWidth=metrics.actualBoundingBoxRight-actualBoundingBoxLeft;if(metricWidth>0)if(useExperimentalLetterSpacing)metricWidth-=letterSpacing,boundsWidth-=letterSpacing;else{let val=(_CanvasTextMetrics$1.graphemeSegmenter(text).length-1)*letterSpacing;metricWidth+=val,boundsWidth+=val}return Math.max(metricWidth,boundsWidth)}static _wordWrap(text,style,canvas=_CanvasTextMetrics$1._canvas){let context$1=canvas.getContext(`2d`,contextSettings),width=0,line=``,lines=``,cache=Object.create(null),{letterSpacing,whiteSpace}=style,collapseSpaces=_CanvasTextMetrics$1._collapseSpaces(whiteSpace),collapseNewlines=_CanvasTextMetrics$1._collapseNewlines(whiteSpace),canPrependSpaces=!collapseSpaces,wordWrapWidth=style.wordWrapWidth+letterSpacing,tokens$1=_CanvasTextMetrics$1._tokenize(text);for(let i$1=0;i$1<tokens$1.length;i$1++){let token=tokens$1[i$1];if(_CanvasTextMetrics$1._isNewline(token)){if(!collapseNewlines){lines+=_CanvasTextMetrics$1._addLine(line),canPrependSpaces=!collapseSpaces,line=``,width=0;continue}token=` `}if(collapseSpaces){let currIsBreakingSpace=_CanvasTextMetrics$1.isBreakingSpace(token),lastIsBreakingSpace=_CanvasTextMetrics$1.isBreakingSpace(line[line.length-1]);if(currIsBreakingSpace&&lastIsBreakingSpace)continue}let tokenWidth=_CanvasTextMetrics$1._getFromCache(token,letterSpacing,cache,context$1);if(tokenWidth>wordWrapWidth)if(line!==``&&(lines+=_CanvasTextMetrics$1._addLine(line),line=``,width=0),_CanvasTextMetrics$1.canBreakWords(token,style.breakWords)){let characters=_CanvasTextMetrics$1.wordWrapSplit(token);for(let j$1=0;j$1<characters.length;j$1++){let char=characters[j$1],lastChar=char,k$1=1;for(;characters[j$1+k$1];){let nextChar=characters[j$1+k$1];if(!_CanvasTextMetrics$1.canBreakChars(lastChar,nextChar,token,j$1,style.breakWords))char+=nextChar;else break;lastChar=nextChar,k$1++}j$1+=k$1-1;let characterWidth=_CanvasTextMetrics$1._getFromCache(char,letterSpacing,cache,context$1);characterWidth+width>wordWrapWidth&&(lines+=_CanvasTextMetrics$1._addLine(line),canPrependSpaces=!1,line=``,width=0),line+=char,width+=characterWidth}}else{line.length>0&&(lines+=_CanvasTextMetrics$1._addLine(line),line=``,width=0);let isLastToken=i$1===tokens$1.length-1;lines+=_CanvasTextMetrics$1._addLine(token,!isLastToken),canPrependSpaces=!1,line=``,width=0}else tokenWidth+width>wordWrapWidth&&(canPrependSpaces=!1,lines+=_CanvasTextMetrics$1._addLine(line),line=``,width=0),(line.length>0||!_CanvasTextMetrics$1.isBreakingSpace(token)||canPrependSpaces)&&(line+=token,width+=tokenWidth)}return lines+=_CanvasTextMetrics$1._addLine(line,!1),lines}static _addLine(line,newLine=!0){return line=_CanvasTextMetrics$1._trimRight(line),line=newLine?`${line}
`:line,line}static _getFromCache(key$1,letterSpacing,cache,context$1){let width=cache[key$1];return typeof width!=`number`&&(width=_CanvasTextMetrics$1._measureText(key$1,letterSpacing,context$1)+letterSpacing,cache[key$1]=width),width}static _collapseSpaces(whiteSpace){return whiteSpace===`normal`||whiteSpace===`pre-line`}static _collapseNewlines(whiteSpace){return whiteSpace===`normal`}static _trimRight(text){if(typeof text!=`string`)return``;for(let i$1=text.length-1;i$1>=0;i$1--){let char=text[i$1];if(!_CanvasTextMetrics$1.isBreakingSpace(char))break;text=text.slice(0,-1)}return text}static _isNewline(char){return typeof char==`string`?_CanvasTextMetrics$1._newlines.includes(char.charCodeAt(0)):!1}static isBreakingSpace(char,_nextChar){return typeof char==`string`?_CanvasTextMetrics$1._breakingSpaces.includes(char.charCodeAt(0)):!1}static _tokenize(text){let tokens$1=[],token=``;if(typeof text!=`string`)return tokens$1;for(let i$1=0;i$1<text.length;i$1++){let char=text[i$1],nextChar=text[i$1+1];if(_CanvasTextMetrics$1.isBreakingSpace(char,nextChar)||_CanvasTextMetrics$1._isNewline(char)){token!==``&&(tokens$1.push(token),token=``),char===`\r`&&nextChar===`
`?(tokens$1.push(`\r
`),i$1++):tokens$1.push(char);continue}token+=char}return token!==``&&tokens$1.push(token),tokens$1}static canBreakWords(_token,breakWords){return breakWords}static canBreakChars(_char,_nextChar,_token,_index,_breakWords){return!0}static wordWrapSplit(token){return _CanvasTextMetrics$1.graphemeSegmenter(token)}static measureFont(font){if(_CanvasTextMetrics$1._fonts[font])return _CanvasTextMetrics$1._fonts[font];let context$1=_CanvasTextMetrics$1._context;context$1.font=font;let metrics=context$1.measureText(_CanvasTextMetrics$1.METRICS_STRING+_CanvasTextMetrics$1.BASELINE_SYMBOL),properties={ascent:metrics.actualBoundingBoxAscent,descent:metrics.actualBoundingBoxDescent,fontSize:metrics.actualBoundingBoxAscent+metrics.actualBoundingBoxDescent};return _CanvasTextMetrics$1._fonts[font]=properties,properties}static clearMetrics(font=``){font?delete _CanvasTextMetrics$1._fonts[font]:_CanvasTextMetrics$1._fonts={}}static get _canvas(){if(!_CanvasTextMetrics$1.__canvas){let canvas;try{let c$2=new OffscreenCanvas(0,0);if(c$2.getContext(`2d`,contextSettings)?.measureText)return _CanvasTextMetrics$1.__canvas=c$2,c$2;canvas=DOMAdapter.get().createCanvas()}catch{canvas=DOMAdapter.get().createCanvas()}canvas.width=canvas.height=10,_CanvasTextMetrics$1.__canvas=canvas}return _CanvasTextMetrics$1.__canvas}static get _context(){return _CanvasTextMetrics$1.__context||=_CanvasTextMetrics$1._canvas.getContext(`2d`,contextSettings),_CanvasTextMetrics$1.__context}};_CanvasTextMetrics.METRICS_STRING=`|q`,_CanvasTextMetrics.BASELINE_SYMBOL=`M`,_CanvasTextMetrics.BASELINE_MULTIPLIER=1.4,_CanvasTextMetrics.HEIGHT_MULTIPLIER=2,_CanvasTextMetrics.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter==`function`){let segmenter=new Intl.Segmenter;return s$1=>{let segments=segmenter.segment(s$1),result=[],i$1=0;for(let segment$1 of segments)result[i$1++]=segment$1.segment;return result}}return s$1=>[...s$1]})(),_CanvasTextMetrics.experimentalLetterSpacing=!1,_CanvasTextMetrics._fonts={},_CanvasTextMetrics._newlines=[10,13],_CanvasTextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],_CanvasTextMetrics._measurementCache=lru(1e3);var CanvasTextMetrics=_CanvasTextMetrics,emptyColorStops=[{offset:0,color:`white`},{offset:1,color:`black`}],_FillGradient=class _FillGradient$1{constructor(...args){this.uid=uid$1(`fillGradient`),this._tick=0,this.type=`linear`,this.colorStops=[];let options=ensureGradientOptions(args);options={...options.type===`radial`?_FillGradient$1.defaultRadialOptions:_FillGradient$1.defaultLinearOptions,...definedProps(options)},this._textureSize=options.textureSize,this._wrapMode=options.wrapMode,options.type===`radial`?(this.center=options.center,this.outerCenter=options.outerCenter??this.center,this.innerRadius=options.innerRadius,this.outerRadius=options.outerRadius,this.scale=options.scale,this.rotation=options.rotation):(this.start=options.start,this.end=options.end),this.textureSpace=options.textureSpace,this.type=options.type,options.colorStops.forEach(stop$2=>{this.addColorStop(stop$2.offset,stop$2.color)})}addColorStop(offset,color$2){return this.colorStops.push({offset,color:Color.shared.setValue(color$2).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:x0,y:y0}=this.start,{x:x1,y:y1}=this.end,dx=x1-x0,dy=y1-y0,flip=dx<0||dy<0;if(this._wrapMode===`clamp-to-edge`){if(dx<0){let temp=x0;x0=x1,x1=temp,dx*=-1}if(dy<0){let temp=y0;y0=y1,y1=temp,dy*=-1}}let colorStops=this.colorStops.length?this.colorStops:emptyColorStops,defaultSize=this._textureSize,{canvas,context:context$1}=getCanvas(defaultSize,1),gradient=flip?context$1.createLinearGradient(this._textureSize,0,0,0):context$1.createLinearGradient(0,0,this._textureSize,0);addColorStops(gradient,colorStops),context$1.fillStyle=gradient,context$1.fillRect(0,0,defaultSize,1),this.texture=new Texture({source:new ImageSource({resource:canvas,addressMode:this._wrapMode})});let dist$2=Math.sqrt(dx*dx+dy*dy),angle=Math.atan2(dy,dx),m$2=new Matrix;m$2.scale(dist$2/defaultSize,1),m$2.rotate(angle),m$2.translate(x0,y0),this.textureSpace===`local`&&m$2.scale(defaultSize,defaultSize),this.transform=m$2}buildGradient(){this.texture||this._tick++,this.type===`linear`?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;let colorStops=this.colorStops.length?this.colorStops:emptyColorStops,defaultSize=this._textureSize,{canvas,context:context$1}=getCanvas(defaultSize,defaultSize),{x:x0,y:y0}=this.center,{x:x1,y:y1}=this.outerCenter,r0=this.innerRadius,r1=this.outerRadius,ox=x1-r1,oy=y1-r1,scale$3=defaultSize/(r1*2),cx=(x0-ox)*scale$3,cy=(y0-oy)*scale$3,gradient=context$1.createRadialGradient(cx,cy,r0*scale$3,(x1-ox)*scale$3,(y1-oy)*scale$3,r1*scale$3);addColorStops(gradient,colorStops),context$1.fillStyle=colorStops[colorStops.length-1].color,context$1.fillRect(0,0,defaultSize,defaultSize),context$1.fillStyle=gradient,context$1.translate(cx,cy),context$1.rotate(this.rotation),context$1.scale(1,this.scale),context$1.translate(-cx,-cy),context$1.fillRect(0,0,defaultSize,defaultSize),this.texture=new Texture({source:new ImageSource({resource:canvas,addressMode:this._wrapMode})});let m$2=new Matrix;m$2.scale(1/scale$3,1/scale$3),m$2.translate(ox,oy),this.textureSpace===`local`&&m$2.scale(defaultSize,defaultSize),this.transform=m$2}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};_FillGradient.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:`local`,type:`linear`,textureSize:256,wrapMode:`clamp-to-edge`},_FillGradient.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:`local`,type:`radial`,textureSize:256,wrapMode:`clamp-to-edge`};var FillGradient=_FillGradient;function addColorStops(gradient,colorStops){for(let i$1=0;i$1<colorStops.length;i$1++){let stop$2=colorStops[i$1];gradient.addColorStop(stop$2.offset,stop$2.color)}}function getCanvas(width,height){let canvas=DOMAdapter.get().createCanvas(width,height),context$1=canvas.getContext(`2d`);return{canvas,context:context$1}}function ensureGradientOptions(args){let options=args[0]??{};return(typeof options==`number`||args[1])&&(deprecation(`8.5.2`,`use options object instead`),options={type:`linear`,start:{x:args[0],y:args[1]},end:{x:args[2],y:args[3]},textureSpace:args[4],textureSize:args[5]??FillGradient.defaultLinearOptions.textureSize}),options}var repetitionMap={repeat:{addressModeU:`repeat`,addressModeV:`repeat`},"repeat-x":{addressModeU:`repeat`,addressModeV:`clamp-to-edge`},"repeat-y":{addressModeU:`clamp-to-edge`,addressModeV:`repeat`},"no-repeat":{addressModeU:`clamp-to-edge`,addressModeV:`clamp-to-edge`}},FillPattern=class{constructor(texture,repetition){this.uid=uid$1(`fillPattern`),this._tick=0,this.transform=new Matrix,this.texture=texture,this.transform.scale(1/texture.frame.width,1/texture.frame.height),repetition&&(texture.source.style.addressModeU=repetitionMap[repetition].addressModeU,texture.source.style.addressModeV=repetitionMap[repetition].addressModeV)}setTransform(transform){let texture=this.texture;this.transform.copyFrom(transform),this.transform.invert(),this.transform.scale(1/texture.frame.width,1/texture.frame.height),this._tick++}get texture(){return this._texture}set texture(value){this._texture!==value&&(this._texture=value,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}},import_parse_svg_path=__toESM(__commonJSMin(((exports,module)=>{module.exports=parse$2;var length={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},segment=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function parse$2(path$1){var data=[];return path$1.replace(segment,function(_,command,args){var type=command.toLowerCase();for(args=parseValues(args),type==`m`&&args.length>2&&(data.push([command].concat(args.splice(0,2))),type=`l`,command=command==`m`?`l`:`L`);;){if(args.length==length[type])return args.unshift(command),data.push(args);if(args.length<length[type])throw Error(`malformed path data`);data.push([command].concat(args.splice(0,length[type])))}}),data}var number=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function parseValues(args){var numbers=args.match(number);return numbers?numbers.map(Number):[]}}))(),1);function parseSVGPath(svgPath,path$1){let commands=(0,import_parse_svg_path.default)(svgPath),subpaths=[],currentSubPath=null,lastX=0,lastY=0;for(let i$1=0;i$1<commands.length;i$1++){let command=commands[i$1],type=command[0],data=command;switch(type){case`M`:lastX=data[1],lastY=data[2],path$1.moveTo(lastX,lastY);break;case`m`:lastX+=data[1],lastY+=data[2],path$1.moveTo(lastX,lastY);break;case`H`:lastX=data[1],path$1.lineTo(lastX,lastY);break;case`h`:lastX+=data[1],path$1.lineTo(lastX,lastY);break;case`V`:lastY=data[1],path$1.lineTo(lastX,lastY);break;case`v`:lastY+=data[1],path$1.lineTo(lastX,lastY);break;case`L`:lastX=data[1],lastY=data[2],path$1.lineTo(lastX,lastY);break;case`l`:lastX+=data[1],lastY+=data[2],path$1.lineTo(lastX,lastY);break;case`C`:lastX=data[5],lastY=data[6],path$1.bezierCurveTo(data[1],data[2],data[3],data[4],lastX,lastY);break;case`c`:path$1.bezierCurveTo(lastX+data[1],lastY+data[2],lastX+data[3],lastY+data[4],lastX+data[5],lastY+data[6]),lastX+=data[5],lastY+=data[6];break;case`S`:lastX=data[3],lastY=data[4],path$1.bezierCurveToShort(data[1],data[2],lastX,lastY);break;case`s`:path$1.bezierCurveToShort(lastX+data[1],lastY+data[2],lastX+data[3],lastY+data[4]),lastX+=data[3],lastY+=data[4];break;case`Q`:lastX=data[3],lastY=data[4],path$1.quadraticCurveTo(data[1],data[2],lastX,lastY);break;case`q`:path$1.quadraticCurveTo(lastX+data[1],lastY+data[2],lastX+data[3],lastY+data[4]),lastX+=data[3],lastY+=data[4];break;case`T`:lastX=data[1],lastY=data[2],path$1.quadraticCurveToShort(lastX,lastY);break;case`t`:lastX+=data[1],lastY+=data[2],path$1.quadraticCurveToShort(lastX,lastY);break;case`A`:lastX=data[6],lastY=data[7],path$1.arcToSvg(data[1],data[2],data[3],data[4],data[5],lastX,lastY);break;case`a`:lastX+=data[6],lastY+=data[7],path$1.arcToSvg(data[1],data[2],data[3],data[4],data[5],lastX,lastY);break;case`Z`:case`z`:path$1.closePath(),subpaths.length>0&&(currentSubPath=subpaths.pop(),currentSubPath?(lastX=currentSubPath.startX,lastY=currentSubPath.startY):(lastX=0,lastY=0)),currentSubPath=null;break;default:warn$1(`Unknown SVG path command: ${type}`)}type!==`Z`&&type!==`z`&&currentSubPath===null&&(currentSubPath={startX:lastX,startY:lastY},subpaths.push(currentSubPath))}return path$1}var Circle$1=class Circle$1{constructor(x$1=0,y$1=0,radius=0){this.type=`circle`,this.x=x$1,this.y=y$1,this.radius=radius}clone(){return new Circle$1(this.x,this.y,this.radius)}contains(x$1,y$1){if(this.radius<=0)return!1;let r2=this.radius*this.radius,dx=this.x-x$1,dy=this.y-y$1;return dx*=dx,dy*=dy,dx+dy<=r2}strokeContains(x$1,y$1,width,alignment=.5){if(this.radius===0)return!1;let dx=this.x-x$1,dy=this.y-y$1,radius=this.radius,outerWidth=(1-alignment)*width,distance$1=Math.sqrt(dx*dx+dy*dy);return distance$1<=radius+outerWidth&&distance$1>radius-(width-outerWidth)}getBounds(out$2){return out$2||=new Rectangle,out$2.x=this.x-this.radius,out$2.y=this.y-this.radius,out$2.width=this.radius*2,out$2.height=this.radius*2,out$2}copyFrom(circle){return this.x=circle.x,this.y=circle.y,this.radius=circle.radius,this}copyTo(circle){return circle.copyFrom(this),circle}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}},Ellipse$1=class Ellipse$1{constructor(x$1=0,y$1=0,halfWidth=0,halfHeight=0){this.type=`ellipse`,this.x=x$1,this.y=y$1,this.halfWidth=halfWidth,this.halfHeight=halfHeight}clone(){return new Ellipse$1(this.x,this.y,this.halfWidth,this.halfHeight)}contains(x$1,y$1){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let normx=(x$1-this.x)/this.halfWidth,normy=(y$1-this.y)/this.halfHeight;return normx*=normx,normy*=normy,normx+normy<=1}strokeContains(x$1,y$1,strokeWidth,alignment=.5){let{halfWidth,halfHeight}=this;if(halfWidth<=0||halfHeight<=0)return!1;let strokeOuterWidth=strokeWidth*(1-alignment),strokeInnerWidth=strokeWidth-strokeOuterWidth,innerHorizontal=halfWidth-strokeInnerWidth,innerVertical=halfHeight-strokeInnerWidth,outerHorizontal=halfWidth+strokeOuterWidth,outerVertical=halfHeight+strokeOuterWidth,normalizedX=x$1-this.x,normalizedY=y$1-this.y,innerEllipse=normalizedX*normalizedX/(innerHorizontal*innerHorizontal)+normalizedY*normalizedY/(innerVertical*innerVertical),outerEllipse=normalizedX*normalizedX/(outerHorizontal*outerHorizontal)+normalizedY*normalizedY/(outerVertical*outerVertical);return innerEllipse>1&&outerEllipse<=1}getBounds(out$2){return out$2||=new Rectangle,out$2.x=this.x-this.halfWidth,out$2.y=this.y-this.halfHeight,out$2.width=this.halfWidth*2,out$2.height=this.halfHeight*2,out$2}copyFrom(ellipse){return this.x=ellipse.x,this.y=ellipse.y,this.halfWidth=ellipse.halfWidth,this.halfHeight=ellipse.halfHeight,this}copyTo(ellipse){return ellipse.copyFrom(this),ellipse}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}};function squaredDistanceToLineSegment(x$1,y$1,x1,y1,x2,y2){let a$1=x$1-x1,b$1=y$1-y1,c$2=x2-x1,d$1=y2-y1,dot=a$1*c$2+b$1*d$1,lenSq=c$2*c$2+d$1*d$1,param=-1;lenSq!==0&&(param=dot/lenSq);let xx,yy;param<0?(xx=x1,yy=y1):param>1?(xx=x2,yy=y2):(xx=x1+param*c$2,yy=y1+param*d$1);let dx=x$1-xx,dy=y$1-yy;return dx*dx+dy*dy}var tempRect$4,tempRect2,Polygon$1=class Polygon$1{constructor(...points$1){this.type=`polygon`;let flat=Array.isArray(points$1[0])?points$1[0]:points$1;if(typeof flat[0]!=`number`){let p$2=[];for(let i$1=0,il=flat.length;i$1<il;i$1++)p$2.push(flat[i$1].x,flat[i$1].y);flat=p$2}this.points=flat,this.closePath=!0}isClockwise(){let area$1=0,points$1=this.points,length$1=points$1.length;for(let i$1=0;i$1<length$1;i$1+=2){let x1=points$1[i$1],y1=points$1[i$1+1],x2=points$1[(i$1+2)%length$1],y2=points$1[(i$1+3)%length$1];area$1+=(x2-x1)*(y2+y1)}return area$1<0}containsPolygon(polygon){let thisBounds=this.getBounds(tempRect$4),otherBounds=polygon.getBounds(tempRect2);if(!thisBounds.containsRect(otherBounds))return!1;let points$1=polygon.points;for(let i$1=0;i$1<points$1.length;i$1+=2){let x$1=points$1[i$1],y$1=points$1[i$1+1];if(!this.contains(x$1,y$1))return!1}return!0}clone(){let points$1=this.points.slice(),polygon=new Polygon$1(points$1);return polygon.closePath=this.closePath,polygon}contains(x$1,y$1){let inside=!1,length$1=this.points.length/2;for(let i$1=0,j$1=length$1-1;i$1<length$1;j$1=i$1++){let xi=this.points[i$1*2],yi=this.points[i$1*2+1],xj=this.points[j$1*2],yj=this.points[j$1*2+1];yi>y$1!=yj>y$1&&x$1<(xj-xi)*((y$1-yi)/(yj-yi))+xi&&(inside=!inside)}return inside}strokeContains(x$1,y$1,strokeWidth,alignment=.5){let strokeWidthSquared=strokeWidth*strokeWidth,rightWidthSquared=strokeWidthSquared*(1-alignment),leftWidthSquared=strokeWidthSquared-rightWidthSquared,{points:points$1}=this,iterationLength=points$1.length-(this.closePath?0:2);for(let i$1=0;i$1<iterationLength;i$1+=2){let x1=points$1[i$1],y1=points$1[i$1+1],x2=points$1[(i$1+2)%points$1.length],y2=points$1[(i$1+3)%points$1.length],distanceSquared=squaredDistanceToLineSegment(x$1,y$1,x1,y1,x2,y2),sign$1=Math.sign((x2-x1)*(y$1-y1)-(y2-y1)*(x$1-x1));if(distanceSquared<=(sign$1<0?leftWidthSquared:rightWidthSquared))return!0}return!1}getBounds(out$2){out$2||=new Rectangle;let points$1=this.points,minX=1/0,maxX=-1/0,minY=1/0,maxY=-1/0;for(let i$1=0,n$1=points$1.length;i$1<n$1;i$1+=2){let x$1=points$1[i$1],y$1=points$1[i$1+1];minX=x$1<minX?x$1:minX,maxX=x$1>maxX?x$1:maxX,minY=y$1<minY?y$1:minY,maxY=y$1>maxY?y$1:maxY}return out$2.x=minX,out$2.width=maxX-minX,out$2.y=minY,out$2.height=maxY-minY,out$2}copyFrom(polygon){return this.points=polygon.points.slice(),this.closePath=polygon.closePath,this}copyTo(polygon){return polygon.copyFrom(this),polygon}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((pointsDesc,currentPoint)=>`${pointsDesc}, ${currentPoint}`,``)}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return deprecation(`8.11.0`,`Polygon.lastX is deprecated, please use Polygon.lastX instead.`),this.points[this.points.length-2]}get y(){return deprecation(`8.11.0`,`Polygon.y is deprecated, please use Polygon.lastY instead.`),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}},isCornerWithinStroke=(pX,pY,cornerX,cornerY,radius,strokeWidthInner,strokeWidthOuter)=>{let dx=pX-cornerX,dy=pY-cornerY,distance$1=Math.sqrt(dx*dx+dy*dy);return distance$1>=radius-strokeWidthInner&&distance$1<=radius+strokeWidthOuter},RoundedRectangle=class RoundedRectangle{constructor(x$1=0,y$1=0,width=0,height=0,radius=20){this.type=`roundedRectangle`,this.x=x$1,this.y=y$1,this.width=width,this.height=height,this.radius=radius}getBounds(out$2){return out$2||=new Rectangle,out$2.x=this.x,out$2.y=this.y,out$2.width=this.width,out$2.height=this.height,out$2}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}copyFrom(rectangle){return this.x=rectangle.x,this.y=rectangle.y,this.width=rectangle.width,this.height=rectangle.height,this}copyTo(rectangle){return rectangle.copyFrom(this),rectangle}contains(x$1,y$1){if(this.width<=0||this.height<=0)return!1;if(x$1>=this.x&&x$1<=this.x+this.width&&y$1>=this.y&&y$1<=this.y+this.height){let radius=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(y$1>=this.y+radius&&y$1<=this.y+this.height-radius||x$1>=this.x+radius&&x$1<=this.x+this.width-radius)return!0;let dx=x$1-(this.x+radius),dy=y$1-(this.y+radius),radius2=radius*radius;if(dx*dx+dy*dy<=radius2||(dx=x$1-(this.x+this.width-radius),dx*dx+dy*dy<=radius2)||(dy=y$1-(this.y+this.height-radius),dx*dx+dy*dy<=radius2)||(dx=x$1-(this.x+radius),dx*dx+dy*dy<=radius2))return!0}return!1}strokeContains(pX,pY,strokeWidth,alignment=.5){let{x:x$1,y:y$1,width,height,radius}=this,strokeWidthOuter=strokeWidth*(1-alignment),strokeWidthInner=strokeWidth-strokeWidthOuter,innerX=x$1+radius,innerY=y$1+radius,innerWidth=width-radius*2,innerHeight=height-radius*2,rightBound=x$1+width,bottomBound=y$1+height;return(pX>=x$1-strokeWidthOuter&&pX<=x$1+strokeWidthInner||pX>=rightBound-strokeWidthInner&&pX<=rightBound+strokeWidthOuter)&&pY>=innerY&&pY<=innerY+innerHeight||(pY>=y$1-strokeWidthOuter&&pY<=y$1+strokeWidthInner||pY>=bottomBound-strokeWidthInner&&pY<=bottomBound+strokeWidthOuter)&&pX>=innerX&&pX<=innerX+innerWidth?!0:pX<innerX&&pY<innerY&&isCornerWithinStroke(pX,pY,innerX,innerY,radius,strokeWidthInner,strokeWidthOuter)||pX>rightBound-radius&&pY<innerY&&isCornerWithinStroke(pX,pY,rightBound-radius,innerY,radius,strokeWidthInner,strokeWidthOuter)||pX>rightBound-radius&&pY>bottomBound-radius&&isCornerWithinStroke(pX,pY,rightBound-radius,bottomBound-radius,radius,strokeWidthInner,strokeWidthOuter)||pX<innerX&&pY>bottomBound-radius&&isCornerWithinStroke(pX,pY,innerX,bottomBound-radius,radius,strokeWidthInner,strokeWidthOuter)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}},cachedGroups={};function getTextureBatchBindGroup(textures,size,maxTextures){let uid$3=2166136261;for(let i$1=0;i$1<size;i$1++)uid$3^=textures[i$1].uid,uid$3=Math.imul(uid$3,16777619),uid$3>>>=0;return cachedGroups[uid$3]||generateTextureBatchBindGroup(textures,size,uid$3,maxTextures)}function generateTextureBatchBindGroup(textures,size,key$1,maxTextures){let bindGroupResources={},bindIndex=0;for(let i$1=0;i$1<maxTextures;i$1++){let texture=i$1<size?textures[i$1]:Texture.EMPTY.source;bindGroupResources[bindIndex++]=texture.source,bindGroupResources[bindIndex++]=texture.style}let bindGroup=new BindGroup(bindGroupResources);return cachedGroups[key$1]=bindGroup,bindGroup}var ViewableBuffer=class{constructor(sizeOrBuffer){typeof sizeOrBuffer==`number`?this.rawBinaryData=new ArrayBuffer(sizeOrBuffer):sizeOrBuffer instanceof Uint8Array?this.rawBinaryData=sizeOrBuffer.buffer:this.rawBinaryData=sizeOrBuffer,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||=new Int8Array(this.rawBinaryData),this._int8View}get uint8View(){return this._uint8View||=new Uint8Array(this.rawBinaryData),this._uint8View}get int16View(){return this._int16View||=new Int16Array(this.rawBinaryData),this._int16View}get int32View(){return this._int32View||=new Int32Array(this.rawBinaryData),this._int32View}get float64View(){return this._float64Array||=new Float64Array(this.rawBinaryData),this._float64Array}get bigUint64View(){return this._bigUint64Array||=new BigUint64Array(this.rawBinaryData),this._bigUint64Array}view(type){return this[`${type}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(type){switch(type){case`int8`:case`uint8`:return 1;case`int16`:case`uint16`:return 2;case`int32`:case`uint32`:case`float32`:return 4;default:throw Error(`${type} isn't a valid view type`)}}};function fastCopy(sourceBuffer,destinationBuffer){let lengthDouble=sourceBuffer.byteLength/8|0,sourceFloat64View=new Float64Array(sourceBuffer,0,lengthDouble);new Float64Array(destinationBuffer,0,lengthDouble).set(sourceFloat64View);let remainingBytes=sourceBuffer.byteLength-lengthDouble*8;if(remainingBytes>0){let sourceUint8View=new Uint8Array(sourceBuffer,lengthDouble*8,remainingBytes);new Uint8Array(destinationBuffer,lengthDouble*8,remainingBytes).set(sourceUint8View)}}var BLEND_TO_NPM={normal:`normal-npm`,add:`add-npm`,screen:`screen-npm`},STENCIL_MODES=(STENCIL_MODES2=>(STENCIL_MODES2[STENCIL_MODES2.DISABLED=0]=`DISABLED`,STENCIL_MODES2[STENCIL_MODES2.RENDERING_MASK_ADD=1]=`RENDERING_MASK_ADD`,STENCIL_MODES2[STENCIL_MODES2.MASK_ACTIVE=2]=`MASK_ACTIVE`,STENCIL_MODES2[STENCIL_MODES2.INVERSE_MASK_ACTIVE=3]=`INVERSE_MASK_ACTIVE`,STENCIL_MODES2[STENCIL_MODES2.RENDERING_MASK_REMOVE=4]=`RENDERING_MASK_REMOVE`,STENCIL_MODES2[STENCIL_MODES2.NONE=5]=`NONE`,STENCIL_MODES2))(STENCIL_MODES||{});function getAdjustedBlendModeBlend(blendMode,textureSource){return textureSource.alphaMode===`no-premultiply-alpha`&&BLEND_TO_NPM[blendMode]||blendMode}var fragTemplate=[`precision mediump float;`,`void main(void){`,`float test = 0.1;`,`%forloop%`,`gl_FragColor = vec4(0.0);`,`}`].join(`
`);function generateIfTestSrc(maxIfs){let src=``;for(let i$1=0;i$1<maxIfs;++i$1)i$1>0&&(src+=`
else `),i$1<maxIfs-1&&(src+=`if(test == ${i$1}.0){}`);return src}function checkMaxIfStatementsInShader(maxIfs,gl){if(maxIfs===0)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let shader=gl.createShader(gl.FRAGMENT_SHADER);try{for(;;){let fragmentSrc=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(maxIfs));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),!gl.getShaderParameter(shader,gl.COMPILE_STATUS))maxIfs=maxIfs/2|0;else break}}finally{gl.deleteShader(shader)}return maxIfs}var maxTexturesPerBatchCache=null;function getMaxTexturesPerBatch(){if(maxTexturesPerBatchCache)return maxTexturesPerBatchCache;let gl=getTestContext();return maxTexturesPerBatchCache=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),maxTexturesPerBatchCache=checkMaxIfStatementsInShader(maxTexturesPerBatchCache,gl),gl.getExtension(`WEBGL_lose_context`)?.loseContext(),maxTexturesPerBatchCache}var BatchTextureArray=class{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let i$1=0;i$1<this.count;i$1++){let t$1=this.textures[i$1];this.textures[i$1]=null,this.ids[t$1.uid]=null}this.count=0}},Batch=class{constructor(){this.renderPipeId=`batch`,this.action=`startBatch`,this.start=0,this.size=0,this.textures=new BatchTextureArray,this.blendMode=`normal`,this.topology=`triangle-strip`,this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}},batchPool=[],batchPoolIndex=0;GlobalResourceRegistry.register({clear:()=>{if(batchPool.length>0)for(let item of batchPool)item&&item.destroy();batchPool.length=0,batchPoolIndex=0}});function getBatchFromPool(){return batchPoolIndex>0?batchPool[--batchPoolIndex]:new Batch}function returnBatchToPool(batch$1){batchPool[batchPoolIndex++]=batch$1}var BATCH_TICK=0,_Batcher=class _Batcher$1{constructor(options){this.uid=uid$1(`batcher`),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],options={..._Batcher$1.defaultOptions,...options},options.maxTextures||=(deprecation(`v8.8.0`,`maxTextures is a required option for Batcher now, please pass it in the options`),getMaxTexturesPerBatch());let{maxTextures,attributesInitialSize,indicesInitialSize}=options;this.attributeBuffer=new ViewableBuffer(attributesInitialSize*4),this.indexBuffer=new Uint16Array(indicesInitialSize),this.maxTextures=maxTextures}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let i$1=0;i$1<this.batchIndex;i$1++)returnBatchToPool(this.batches[i$1]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(batchableObject){this._elements[this.elementSize++]=batchableObject,batchableObject._indexStart=this.indexSize,batchableObject._attributeStart=this.attributeSize,batchableObject._batcher=this,this.indexSize+=batchableObject.indexSize,this.attributeSize+=batchableObject.attributeSize*this.vertexSize}checkAndUpdateTexture(batchableObject,texture){let textureId=batchableObject._batch.textures.ids[texture._source.uid];return!textureId&&textureId!==0?!1:(batchableObject._textureId=textureId,batchableObject.texture=texture,!0)}updateElement(batchableObject){this.dirty=!0;let attributeBuffer=this.attributeBuffer;batchableObject.packAsQuad?this.packQuadAttributes(batchableObject,attributeBuffer.float32View,attributeBuffer.uint32View,batchableObject._attributeStart,batchableObject._textureId):this.packAttributes(batchableObject,attributeBuffer.float32View,attributeBuffer.uint32View,batchableObject._attributeStart,batchableObject._textureId)}break(instructionSet){let elements=this._elements;if(!elements[this.elementStart])return;let batch$1=getBatchFromPool(),textureBatch=batch$1.textures;textureBatch.clear();let firstElement=elements[this.elementStart],blendMode=getAdjustedBlendModeBlend(firstElement.blendMode,firstElement.texture._source),topology=firstElement.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);let f32=this.attributeBuffer.float32View,u32=this.attributeBuffer.uint32View,indexBuffer=this.indexBuffer,size=this._batchIndexSize,start$1=this._batchIndexStart,action=`startBatch`,maxTextures=this.maxTextures;for(let i$1=this.elementStart;i$1<this.elementSize;++i$1){let element=elements[i$1];elements[i$1]=null;let source$2=element.texture._source,adjustedBlendMode=getAdjustedBlendModeBlend(element.blendMode,source$2),breakRequired=blendMode!==adjustedBlendMode||topology!==element.topology;if(source$2._batchTick===BATCH_TICK&&!breakRequired){element._textureId=source$2._textureBindLocation,size+=element.indexSize,element.packAsQuad?(this.packQuadAttributes(element,f32,u32,element._attributeStart,element._textureId),this.packQuadIndex(indexBuffer,element._indexStart,element._attributeStart/this.vertexSize)):(this.packAttributes(element,f32,u32,element._attributeStart,element._textureId),this.packIndex(element,indexBuffer,element._indexStart,element._attributeStart/this.vertexSize)),element._batch=batch$1;continue}source$2._batchTick=BATCH_TICK,(textureBatch.count>=maxTextures||breakRequired)&&(this._finishBatch(batch$1,start$1,size-start$1,textureBatch,blendMode,topology,instructionSet,action),action=`renderBatch`,start$1=size,blendMode=adjustedBlendMode,topology=element.topology,batch$1=getBatchFromPool(),textureBatch=batch$1.textures,textureBatch.clear(),++BATCH_TICK),element._textureId=source$2._textureBindLocation=textureBatch.count,textureBatch.ids[source$2.uid]=textureBatch.count,textureBatch.textures[textureBatch.count++]=source$2,element._batch=batch$1,size+=element.indexSize,element.packAsQuad?(this.packQuadAttributes(element,f32,u32,element._attributeStart,element._textureId),this.packQuadIndex(indexBuffer,element._indexStart,element._attributeStart/this.vertexSize)):(this.packAttributes(element,f32,u32,element._attributeStart,element._textureId),this.packIndex(element,indexBuffer,element._indexStart,element._attributeStart/this.vertexSize))}textureBatch.count>0&&(this._finishBatch(batch$1,start$1,size-start$1,textureBatch,blendMode,topology,instructionSet,action),start$1=size,++BATCH_TICK),this.elementStart=this.elementSize,this._batchIndexStart=start$1,this._batchIndexSize=size}_finishBatch(batch$1,indexStart,indexSize,textureBatch,blendMode,topology,instructionSet,action){batch$1.gpuBindGroup=null,batch$1.bindGroup=null,batch$1.action=action,batch$1.batcher=this,batch$1.textures=textureBatch,batch$1.blendMode=blendMode,batch$1.topology=topology,batch$1.start=indexStart,batch$1.size=indexSize,++BATCH_TICK,this.batches[this.batchIndex++]=batch$1,instructionSet.add(batch$1)}finish(instructionSet){this.break(instructionSet)}ensureAttributeBuffer(size){size*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(size*4)}ensureIndexBuffer(size){size<=this.indexBuffer.length||this._resizeIndexBuffer(size)}_resizeAttributeBuffer(size){let newSize=Math.max(size,this.attributeBuffer.size*2),newArrayBuffer=new ViewableBuffer(newSize);fastCopy(this.attributeBuffer.rawBinaryData,newArrayBuffer.rawBinaryData),this.attributeBuffer=newArrayBuffer}_resizeIndexBuffer(size){let indexBuffer=this.indexBuffer,newSize=Math.max(size,indexBuffer.length*1.5);newSize+=newSize%2;let newIndexBuffer=newSize>65535?new Uint32Array(newSize):new Uint16Array(newSize);if(newIndexBuffer.BYTES_PER_ELEMENT!==indexBuffer.BYTES_PER_ELEMENT)for(let i$1=0;i$1<indexBuffer.length;i$1++)newIndexBuffer[i$1]=indexBuffer[i$1];else fastCopy(indexBuffer.buffer,newIndexBuffer.buffer);this.indexBuffer=newIndexBuffer}packQuadIndex(indexBuffer,index,indicesOffset){indexBuffer[index]=indicesOffset+0,indexBuffer[index+1]=indicesOffset+1,indexBuffer[index+2]=indicesOffset+2,indexBuffer[index+3]=indicesOffset+0,indexBuffer[index+4]=indicesOffset+2,indexBuffer[index+5]=indicesOffset+3}packIndex(element,indexBuffer,index,indicesOffset){let indices=element.indices,size=element.indexSize,indexOffset=element.indexOffset,attributeOffset=element.attributeOffset;for(let i$1=0;i$1<size;i$1++)indexBuffer[index++]=indicesOffset+indices[i$1+indexOffset]-attributeOffset}destroy(){if(this.batches!==null){for(let i$1=0;i$1<this.batches.length;i$1++)returnBatchToPool(this.batches[i$1]);this.batches=null;for(let i$1=0;i$1<this._elements.length;i$1++)this._elements[i$1]&&(this._elements[i$1]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};_Batcher.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};var Batcher=_Batcher,BufferUsage=(BufferUsage2=>(BufferUsage2[BufferUsage2.MAP_READ=1]=`MAP_READ`,BufferUsage2[BufferUsage2.MAP_WRITE=2]=`MAP_WRITE`,BufferUsage2[BufferUsage2.COPY_SRC=4]=`COPY_SRC`,BufferUsage2[BufferUsage2.COPY_DST=8]=`COPY_DST`,BufferUsage2[BufferUsage2.INDEX=16]=`INDEX`,BufferUsage2[BufferUsage2.VERTEX=32]=`VERTEX`,BufferUsage2[BufferUsage2.UNIFORM=64]=`UNIFORM`,BufferUsage2[BufferUsage2.STORAGE=128]=`STORAGE`,BufferUsage2[BufferUsage2.INDIRECT=256]=`INDIRECT`,BufferUsage2[BufferUsage2.QUERY_RESOLVE=512]=`QUERY_RESOLVE`,BufferUsage2[BufferUsage2.STATIC=1024]=`STATIC`,BufferUsage2))(BufferUsage||{}),Buffer$1=class extends eventemitter3_default{constructor(options){let{data,size}=options,{usage,label,shrinkToFit}=options;super(),this.uid=uid$1(`buffer`),this._resourceType=`buffer`,this._resourceId=uid$1(`resource`),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,data instanceof Array&&(data=new Float32Array(data)),this._data=data,size??=data?.byteLength,this.descriptor={size,usage,mappedAtCreation:!!data,label},this.shrinkToFit=shrinkToFit??!0}get data(){return this._data}set data(value){this.setDataWithSize(value,value.length,!0)}get dataInt32(){return this._dataInt32||=new Int32Array(this.data.buffer),this._dataInt32}get static(){return!!(this.descriptor.usage&BufferUsage.STATIC)}set static(value){value?this.descriptor.usage|=BufferUsage.STATIC:this.descriptor.usage&=~BufferUsage.STATIC}setDataWithSize(value,size,syncGPU){if(this._updateID++,this._updateSize=size*value.BYTES_PER_ELEMENT,this._data===value){syncGPU&&this.emit(`update`,this);return}let oldData=this._data;if(this._data=value,this._dataInt32=null,!oldData||oldData.length!==value.length){!this.shrinkToFit&&oldData&&value.byteLength<oldData.byteLength?syncGPU&&this.emit(`update`,this):(this.descriptor.size=value.byteLength,this._resourceId=uid$1(`resource`),this.emit(`change`,this));return}syncGPU&&this.emit(`update`,this)}update(sizeInBytes){this._updateSize=sizeInBytes??this._updateSize,this._updateID++,this.emit(`update`,this)}destroy(){this.destroyed=!0,this.emit(`destroy`,this),this.emit(`change`,this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function ensureIsBuffer(buffer,index){if(!(buffer instanceof Buffer$1)){let usage=index?BufferUsage.INDEX:BufferUsage.VERTEX;buffer instanceof Array&&(index?(buffer=new Uint32Array(buffer),usage=BufferUsage.INDEX|BufferUsage.COPY_DST):(buffer=new Float32Array(buffer),usage=BufferUsage.VERTEX|BufferUsage.COPY_DST)),buffer=new Buffer$1({data:buffer,label:index?`index-mesh-buffer`:`vertex-mesh-buffer`,usage})}return buffer}function getGeometryBounds(geometry,attributeId,bounds){let attribute=geometry.getAttribute(attributeId);if(!attribute)return bounds.minX=0,bounds.minY=0,bounds.maxX=0,bounds.maxY=0,bounds;let data=attribute.buffer.data,minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,byteSize=data.BYTES_PER_ELEMENT,offset=(attribute.offset||0)/byteSize,stride=(attribute.stride||8)/byteSize;for(let i$1=offset;i$1<data.length;i$1+=stride){let x$1=data[i$1],y$1=data[i$1+1];x$1>maxX&&(maxX=x$1),y$1>maxY&&(maxY=y$1),x$1<minX&&(minX=x$1),y$1<minY&&(minY=y$1)}return bounds.minX=minX,bounds.minY=minY,bounds.maxX=maxX,bounds.maxY=maxY,bounds}function ensureIsAttribute(attribute){return(attribute instanceof Buffer$1||Array.isArray(attribute)||attribute.BYTES_PER_ELEMENT)&&(attribute={buffer:attribute}),attribute.buffer=ensureIsBuffer(attribute.buffer,!1),attribute}var Geometry=class extends eventemitter3_default{constructor(options={}){super(),this.uid=uid$1(`geometry`),this._layoutKey=0,this.instanceCount=1,this._bounds=new Bounds,this._boundsDirty=!0;let{attributes,indexBuffer,topology}=options;if(this.buffers=[],this.attributes={},attributes)for(let i$1 in attributes)this.addAttribute(i$1,attributes[i$1]);this.instanceCount=options.instanceCount??1,indexBuffer&&this.addIndex(indexBuffer),this.topology=topology||`triangle-list`}onBufferUpdate(){this._boundsDirty=!0,this.emit(`update`,this)}getAttribute(id){return this.attributes[id]}getIndex(){return this.indexBuffer}getBuffer(id){return this.getAttribute(id).buffer}getSize(){for(let i$1 in this.attributes){let attribute=this.attributes[i$1];return attribute.buffer.data.length/(attribute.stride/4||attribute.size)}return 0}addAttribute(name,attributeOption){let attribute=ensureIsAttribute(attributeOption);this.buffers.indexOf(attribute.buffer)===-1&&(this.buffers.push(attribute.buffer),attribute.buffer.on(`update`,this.onBufferUpdate,this),attribute.buffer.on(`change`,this.onBufferUpdate,this)),this.attributes[name]=attribute}addIndex(indexBuffer){this.indexBuffer=ensureIsBuffer(indexBuffer,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,getGeometryBounds(this,`aPosition`,this._bounds)):this._bounds}destroy(destroyBuffers=!1){this.emit(`destroy`,this),this.removeAllListeners(),destroyBuffers&&this.buffers.forEach(buffer=>buffer.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}},placeHolderBufferData=new Float32Array(1),placeHolderIndexData=new Uint32Array(1),BatchGeometry=class extends Geometry{constructor(){let vertexSize=6,attributeBuffer=new Buffer$1({data:placeHolderBufferData,label:`attribute-batch-buffer`,usage:BufferUsage.VERTEX|BufferUsage.COPY_DST,shrinkToFit:!1}),indexBuffer=new Buffer$1({data:placeHolderIndexData,label:`index-batch-buffer`,usage:BufferUsage.INDEX|BufferUsage.COPY_DST,shrinkToFit:!1}),stride=24;super({attributes:{aPosition:{buffer:attributeBuffer,format:`float32x2`,stride:24,offset:0},aUV:{buffer:attributeBuffer,format:`float32x2`,stride:24,offset:8},aColor:{buffer:attributeBuffer,format:`unorm8x4`,stride:24,offset:16},aTextureIdAndRound:{buffer:attributeBuffer,format:`uint16x2`,stride:24,offset:20}},indexBuffer})}};function addBits(srcParts,parts,name){if(srcParts)for(let i$1 in srcParts){let id=i$1.toLocaleLowerCase(),part=parts[id];if(part){let sanitisedPart=srcParts[i$1];i$1===`header`&&(sanitisedPart=sanitisedPart.replace(/@in\s+[^;]+;\s*/g,``).replace(/@out\s+[^;]+;\s*/g,``)),name&&part.push(`//----${name}----//`),part.push(sanitisedPart)}else warn$1(`${i$1} placement hook does not exist in shader`)}}var findHooksRx=/\{\{(.*?)\}\}/g;function compileHooks(programSrc){let parts={};return(programSrc.match(findHooksRx)?.map(hook=>hook.replace(/[{()}]/g,``))??[]).forEach(hook=>{parts[hook]=[]}),parts}function extractInputs(fragmentSource,out$2){let match,regex=/@in\s+([^;]+);/g;for(;(match=regex.exec(fragmentSource))!==null;)out$2.push(match[1])}function compileInputs(fragments,template,sort$1=!1){let results=[];extractInputs(template,results),fragments.forEach(fragment$3=>{fragment$3.header&&extractInputs(fragment$3.header,results)});let mainInput=results;sort$1&&mainInput.sort();let finalString=mainInput.map((inValue,i$1)=>`       @location(${i$1}) ${inValue},`).join(`
`),cleanedString=template.replace(/@in\s+[^;]+;\s*/g,``);return cleanedString=cleanedString.replace(`{{in}}`,`
${finalString}
`),cleanedString}function extractOutputs(fragmentSource,out$2){let match,regex=/@out\s+([^;]+);/g;for(;(match=regex.exec(fragmentSource))!==null;)out$2.push(match[1])}function extractVariableName(value){let match=/\b(\w+)\s*:/g.exec(value);return match?match[1]:``}function stripVariable(value){return value.replace(/@.*?\s+/g,``)}function compileOutputs(fragments,template){let results=[];extractOutputs(template,results),fragments.forEach(fragment$3=>{fragment$3.header&&extractOutputs(fragment$3.header,results)});let index=0,mainStruct=results.sort().map(inValue=>inValue.indexOf(`builtin`)>-1?inValue:`@location(${index++}) ${inValue}`).join(`,
`),mainStart=results.sort().map(inValue=>`       var ${stripVariable(inValue)};`).join(`
`),mainEnd=`return VSOutput(
            ${results.sort().map(inValue=>` ${extractVariableName(inValue)}`).join(`,
`)});`,compiledCode=template.replace(/@out\s+[^;]+;\s*/g,``);return compiledCode=compiledCode.replace(`{{struct}}`,`
${mainStruct}
`),compiledCode=compiledCode.replace(`{{start}}`,`
${mainStart}
`),compiledCode=compiledCode.replace(`{{return}}`,`
${mainEnd}
`),compiledCode}function injectBits(templateSrc,fragmentParts){let out$2=templateSrc;for(let i$1 in fragmentParts){let parts=fragmentParts[i$1];out$2=parts.join(`
`).length?out$2.replace(`{{${i$1}}}`,`//-----${i$1} START-----//
${parts.join(`
`)}
//----${i$1} FINISH----//`):out$2.replace(`{{${i$1}}}`,``)}return out$2}var cacheMap=Object.create(null),bitCacheMap=new Map,CACHE_UID=0;function compileHighShader({template,bits}){let cacheId=generateCacheId(template,bits);if(cacheMap[cacheId])return cacheMap[cacheId];let{vertex:vertex$3,fragment:fragment$3}=compileInputsAndOutputs(template,bits);return cacheMap[cacheId]=compileBits(vertex$3,fragment$3,bits),cacheMap[cacheId]}function compileHighShaderGl({template,bits}){let cacheId=generateCacheId(template,bits);return cacheMap[cacheId]||(cacheMap[cacheId]=compileBits(template.vertex,template.fragment,bits)),cacheMap[cacheId]}function compileInputsAndOutputs(template,bits){let vertexFragments=bits.map(shaderBit=>shaderBit.vertex).filter(v$1=>!!v$1),fragmentFragments=bits.map(shaderBit=>shaderBit.fragment).filter(v$1=>!!v$1),compiledVertex=compileInputs(vertexFragments,template.vertex,!0);compiledVertex=compileOutputs(vertexFragments,compiledVertex);let compiledFragment=compileInputs(fragmentFragments,template.fragment,!0);return{vertex:compiledVertex,fragment:compiledFragment}}function generateCacheId(template,bits){return bits.map(highFragment=>(bitCacheMap.has(highFragment)||bitCacheMap.set(highFragment,CACHE_UID++),bitCacheMap.get(highFragment))).sort((a$1,b$1)=>a$1-b$1).join(`-`)+template.vertex+template.fragment}function compileBits(vertex$3,fragment$3,bits){let vertexParts=compileHooks(vertex$3),fragmentParts=compileHooks(fragment$3);return bits.forEach(shaderBit=>{addBits(shaderBit.vertex,vertexParts,shaderBit.name),addBits(shaderBit.fragment,fragmentParts,shaderBit.name)}),{vertex:injectBits(vertex$3,vertexParts),fragment:injectBits(fragment$3,fragmentParts)}}var vertexGPUTemplate=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,fragmentGPUTemplate=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,vertexGlTemplate=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,fragmentGlTemplate=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,globalUniformsBit={name:`global-uniforms-bit`,vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},globalUniformsBitGl={name:`global-uniforms-bit`,vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function compileHighShaderGpuProgram({bits,name}){let source$2=compileHighShader({template:{fragment:fragmentGPUTemplate,vertex:vertexGPUTemplate},bits:[globalUniformsBit,...bits]});return GpuProgram.from({name,vertex:{source:source$2.vertex,entryPoint:`main`},fragment:{source:source$2.fragment,entryPoint:`main`}})}function compileHighShaderGlProgram({bits,name}){return new GlProgram({name,...compileHighShaderGl({template:{vertex:vertexGlTemplate,fragment:fragmentGlTemplate},bits:[globalUniformsBitGl,...bits]})})}var colorBit={name:`color-bit`,vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},colorBitGl={name:`color-bit`,vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},textureBatchBitGpuCache={};function generateBindingSrc(maxTextures){let src=[];if(maxTextures===1)src.push(`@group(1) @binding(0) var textureSource1: texture_2d<f32>;`),src.push(`@group(1) @binding(1) var textureSampler1: sampler;`);else{let bindingIndex=0;for(let i$1=0;i$1<maxTextures;i$1++)src.push(`@group(1) @binding(${bindingIndex++}) var textureSource${i$1+1}: texture_2d<f32>;`),src.push(`@group(1) @binding(${bindingIndex++}) var textureSampler${i$1+1}: sampler;`)}return src.join(`
`)}function generateSampleSrc(maxTextures){let src=[];if(maxTextures===1)src.push(`outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);`);else{src.push(`switch vTextureId {`);for(let i$1=0;i$1<maxTextures;i$1++)i$1===maxTextures-1?src.push(`  default:{`):src.push(`  case ${i$1}:{`),src.push(`      outColor = textureSampleGrad(textureSource${i$1+1}, textureSampler${i$1+1}, vUV, uvDx, uvDy);`),src.push(`      break;}`);src.push(`}`)}return src.join(`
`)}function generateTextureBatchBit(maxTextures){return textureBatchBitGpuCache[maxTextures]||(textureBatchBitGpuCache[maxTextures]={name:`texture-batch-bit`,vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${generateBindingSrc(maxTextures)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${generateSampleSrc(maxTextures)}
            `}}),textureBatchBitGpuCache[maxTextures]}var textureBatchBitGlCache={};function generateSampleGlSrc(maxTextures){let src=[];for(let i$1=0;i$1<maxTextures;i$1++)i$1>0&&src.push(`else`),i$1<maxTextures-1&&src.push(`if(vTextureId < ${i$1}.5)`),src.push(`{`),src.push(`	outColor = texture(uTextures[${i$1}], vUV);`),src.push(`}`);return src.join(`
`)}function generateTextureBatchBitGl(maxTextures){return textureBatchBitGlCache[maxTextures]||(textureBatchBitGlCache[maxTextures]={name:`texture-batch-bit`,vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${maxTextures}];

            `,main:`

                ${generateSampleGlSrc(maxTextures)}
            `}}),textureBatchBitGlCache[maxTextures]}var roundPixelsBit={name:`round-pixels-bit`,vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},roundPixelsBitGl={name:`round-pixels-bit`,vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},batchSamplersUniformGroupHash={};function getBatchSamplersUniformGroup(maxTextures){let batchSamplersUniformGroup=batchSamplersUniformGroupHash[maxTextures];if(batchSamplersUniformGroup)return batchSamplersUniformGroup;let sampleValues=new Int32Array(maxTextures);for(let i$1=0;i$1<maxTextures;i$1++)sampleValues[i$1]=i$1;return batchSamplersUniformGroup=batchSamplersUniformGroupHash[maxTextures]=new UniformGroup({uTextures:{value:sampleValues,type:`i32`,size:maxTextures}},{isStatic:!0}),batchSamplersUniformGroup}var DefaultShader=class extends Shader{constructor(maxTextures){let glProgram$2=compileHighShaderGlProgram({name:`batch`,bits:[colorBitGl,generateTextureBatchBitGl(maxTextures),roundPixelsBitGl]}),gpuProgram$2=compileHighShaderGpuProgram({name:`batch`,bits:[colorBit,generateTextureBatchBit(maxTextures),roundPixelsBit]});super({glProgram:glProgram$2,gpuProgram:gpuProgram$2,resources:{batchSamplers:getBatchSamplersUniformGroup(maxTextures)}})}},defaultShader=null,_DefaultBatcher=class _DefaultBatcher$1 extends Batcher{constructor(options){super(options),this.geometry=new BatchGeometry,this.name=_DefaultBatcher$1.extension.name,this.vertexSize=6,defaultShader??=new DefaultShader(options.maxTextures),this.shader=defaultShader}packAttributes(element,float32View,uint32View,index,textureId){let textureIdAndRound=textureId<<16|element.roundPixels&65535,wt=element.transform,a$1=wt.a,b$1=wt.b,c$2=wt.c,d$1=wt.d,tx=wt.tx,ty=wt.ty,{positions,uvs}=element,argb=element.color,offset=element.attributeOffset,end$1=offset+element.attributeSize;for(let i$1=offset;i$1<end$1;i$1++){let i2=i$1*2,x$1=positions[i2],y$1=positions[i2+1];float32View[index++]=a$1*x$1+c$2*y$1+tx,float32View[index++]=d$1*y$1+b$1*x$1+ty,float32View[index++]=uvs[i2],float32View[index++]=uvs[i2+1],uint32View[index++]=argb,uint32View[index++]=textureIdAndRound}}packQuadAttributes(element,float32View,uint32View,index,textureId){let texture=element.texture,wt=element.transform,a$1=wt.a,b$1=wt.b,c$2=wt.c,d$1=wt.d,tx=wt.tx,ty=wt.ty,bounds=element.bounds,w0=bounds.maxX,w1=bounds.minX,h0=bounds.maxY,h1=bounds.minY,uvs=texture.uvs,argb=element.color,textureIdAndRound=textureId<<16|element.roundPixels&65535;float32View[index+0]=a$1*w1+c$2*h1+tx,float32View[index+1]=d$1*h1+b$1*w1+ty,float32View[index+2]=uvs.x0,float32View[index+3]=uvs.y0,uint32View[index+4]=argb,uint32View[index+5]=textureIdAndRound,float32View[index+6]=a$1*w0+c$2*h1+tx,float32View[index+7]=d$1*h1+b$1*w0+ty,float32View[index+8]=uvs.x1,float32View[index+9]=uvs.y1,uint32View[index+10]=argb,uint32View[index+11]=textureIdAndRound,float32View[index+12]=a$1*w0+c$2*h0+tx,float32View[index+13]=d$1*h0+b$1*w0+ty,float32View[index+14]=uvs.x2,float32View[index+15]=uvs.y2,uint32View[index+16]=argb,uint32View[index+17]=textureIdAndRound,float32View[index+18]=a$1*w1+c$2*h0+tx,float32View[index+19]=d$1*h0+b$1*w1+ty,float32View[index+20]=uvs.x3,float32View[index+21]=uvs.y3,uint32View[index+22]=argb,uint32View[index+23]=textureIdAndRound}};_DefaultBatcher.extension={type:[ExtensionType.Batcher],name:`default`};var DefaultBatcher=_DefaultBatcher;function buildUvs(vertices,verticesStride,verticesOffset,uvs,uvsOffset,uvsStride,size,matrix=null){let index=0;verticesOffset*=verticesStride,uvsOffset*=uvsStride;let a$1=matrix.a,b$1=matrix.b,c$2=matrix.c,d$1=matrix.d,tx=matrix.tx,ty=matrix.ty;for(;index<size;){let x$1=vertices[verticesOffset],y$1=vertices[verticesOffset+1];uvs[uvsOffset]=a$1*x$1+c$2*y$1+tx,uvs[uvsOffset+1]=b$1*x$1+d$1*y$1+ty,uvsOffset+=uvsStride,verticesOffset+=verticesStride,index++}}function buildSimpleUvs(uvs,uvsOffset,uvsStride,size){let index=0;for(uvsOffset*=uvsStride;index<size;)uvs[uvsOffset]=0,uvs[uvsOffset+1]=0,uvsOffset+=uvsStride,index++}function transformVertices(vertices,m$2,offset,stride,size){let a$1=m$2.a,b$1=m$2.b,c$2=m$2.c,d$1=m$2.d,tx=m$2.tx,ty=m$2.ty;offset||=0,stride||=2,size||=vertices.length/stride-offset;let index=offset*stride;for(let i$1=0;i$1<size;i$1++){let x$1=vertices[index],y$1=vertices[index+1];vertices[index]=a$1*x$1+c$2*y$1+tx,vertices[index+1]=b$1*x$1+d$1*y$1+ty,index+=stride}}var identityMatrix=new Matrix,BatchableGraphics=class{constructor(){this.packAsQuad=!1,this.batcherName=`default`,this.topology=`triangle-list`,this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:`normal`}get color(){let rgb=this.baseColor,bgr=rgb>>16|rgb&65280|(rgb&255)<<16,renderable=this.renderable;return renderable?multiplyHexColors(bgr,renderable.groupColor)+(this.alpha*renderable.groupAlpha*255<<24):bgr+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||identityMatrix}copyTo(gpuBuffer){gpuBuffer.indexOffset=this.indexOffset,gpuBuffer.indexSize=this.indexSize,gpuBuffer.attributeOffset=this.attributeOffset,gpuBuffer.attributeSize=this.attributeSize,gpuBuffer.baseColor=this.baseColor,gpuBuffer.alpha=this.alpha,gpuBuffer.texture=this.texture,gpuBuffer.geometryData=this.geometryData,gpuBuffer.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology=`triangle-list`}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}},buildCircle={extension:{type:ExtensionType.ShapeBuilder,name:`circle`},build(shape,points$1){let x$1,y$1,dx,dy,rx,ry;if(shape.type===`circle`){let circle=shape;if(rx=ry=circle.radius,rx<=0)return!1;x$1=circle.x,y$1=circle.y,dx=dy=0}else if(shape.type===`ellipse`){let ellipse=shape;if(rx=ellipse.halfWidth,ry=ellipse.halfHeight,rx<=0||ry<=0)return!1;x$1=ellipse.x,y$1=ellipse.y,dx=dy=0}else{let roundedRect=shape,halfWidth=roundedRect.width/2,halfHeight=roundedRect.height/2;x$1=roundedRect.x+halfWidth,y$1=roundedRect.y+halfHeight,rx=ry=Math.max(0,Math.min(roundedRect.radius,Math.min(halfWidth,halfHeight))),dx=halfWidth-rx,dy=halfHeight-ry}if(dx<0||dy<0)return!1;let n$1=Math.ceil(2.3*Math.sqrt(rx+ry)),m$2=n$1*8+(dx?4:0)+(dy?4:0);if(m$2===0)return!1;if(n$1===0)return points$1[0]=points$1[6]=x$1+dx,points$1[1]=points$1[3]=y$1+dy,points$1[2]=points$1[4]=x$1-dx,points$1[5]=points$1[7]=y$1-dy,!0;let j1=0,j2=n$1*4+(dx?2:0)+2,j3=j2,j4=m$2,x0=dx+rx,y0=dy,x1=x$1+x0,x2=x$1-x0,y1=y$1+y0;if(points$1[j1++]=x1,points$1[j1++]=y1,points$1[--j2]=y1,points$1[--j2]=x2,dy){let y22=y$1-y0;points$1[j3++]=x2,points$1[j3++]=y22,points$1[--j4]=y22,points$1[--j4]=x1}for(let i$1=1;i$1<n$1;i$1++){let a$1=Math.PI/2*(i$1/n$1),x02=dx+Math.cos(a$1)*rx,y02=dy+Math.sin(a$1)*ry,x12=x$1+x02,x22=x$1-x02,y12=y$1+y02,y22=y$1-y02;points$1[j1++]=x12,points$1[j1++]=y12,points$1[--j2]=y12,points$1[--j2]=x22,points$1[j3++]=x22,points$1[j3++]=y22,points$1[--j4]=y22,points$1[--j4]=x12}x0=dx,y0=dy+ry,x1=x$1+x0,x2=x$1-x0,y1=y$1+y0;let y2=y$1-y0;return points$1[j1++]=x1,points$1[j1++]=y1,points$1[--j4]=y2,points$1[--j4]=x1,dx&&(points$1[j1++]=x2,points$1[j1++]=y1,points$1[--j4]=y2,points$1[--j4]=x2),!0},triangulate(points$1,vertices,verticesStride,verticesOffset,indices,indicesOffset){if(points$1.length===0)return;let centerX=0,centerY=0;for(let i$1=0;i$1<points$1.length;i$1+=2)centerX+=points$1[i$1],centerY+=points$1[i$1+1];centerX/=points$1.length/2,centerY/=points$1.length/2;let count$1=verticesOffset;vertices[count$1*verticesStride]=centerX,vertices[count$1*verticesStride+1]=centerY;let centerIndex=count$1++;for(let i$1=0;i$1<points$1.length;i$1+=2)vertices[count$1*verticesStride]=points$1[i$1],vertices[count$1*verticesStride+1]=points$1[i$1+1],i$1>0&&(indices[indicesOffset++]=count$1,indices[indicesOffset++]=centerIndex,indices[indicesOffset++]=count$1-1),count$1++;indices[indicesOffset++]=centerIndex+1,indices[indicesOffset++]=centerIndex,indices[indicesOffset++]=count$1-1}},buildEllipse={...buildCircle,extension:{...buildCircle.extension,name:`ellipse`}},buildRoundedRectangle={...buildCircle,extension:{...buildCircle.extension,name:`roundedRectangle`}},closePointEps=1e-4,curveEps=1e-4;function getOrientationOfPoints(points$1){let m$2=points$1.length;if(m$2<6)return 1;let area$1=0;for(let i$1=0,x1=points$1[m$2-2],y1=points$1[m$2-1];i$1<m$2;i$1+=2){let x2=points$1[i$1],y2=points$1[i$1+1];area$1+=(x2-x1)*(y2+y1),x1=x2,y1=y2}return area$1<0?-1:1}function square(x$1,y$1,nx,ny,innerWeight,outerWeight,clockwise,verts){let ix=x$1-nx*innerWeight,iy=y$1-ny*innerWeight,ox=x$1+nx*outerWeight,oy=y$1+ny*outerWeight,exx,eyy;clockwise?(exx=ny,eyy=-nx):(exx=-ny,eyy=nx);let eix=ix+exx,eiy=iy+eyy,eox=ox+exx,eoy=oy+eyy;return verts.push(eix,eiy),verts.push(eox,eoy),2}function round$2(cx,cy,sx,sy,ex,ey,verts,clockwise){let cx2p0x=sx-cx,cy2p0y=sy-cy,angle0=Math.atan2(cx2p0x,cy2p0y),angle1=Math.atan2(ex-cx,ey-cy);clockwise&&angle0<angle1?angle0+=Math.PI*2:!clockwise&&angle0>angle1&&(angle1+=Math.PI*2);let startAngle=angle0,angleDiff=angle1-angle0,absAngleDiff=Math.abs(angleDiff),radius=Math.sqrt(cx2p0x*cx2p0x+cy2p0y*cy2p0y),segCount=(15*absAngleDiff*Math.sqrt(radius)/Math.PI>>0)+1,angleInc=angleDiff/segCount;if(startAngle+=angleInc,clockwise){verts.push(cx,cy),verts.push(sx,sy);for(let i$1=1,angle=startAngle;i$1<segCount;i$1++,angle+=angleInc)verts.push(cx,cy),verts.push(cx+Math.sin(angle)*radius,cy+Math.cos(angle)*radius);verts.push(cx,cy),verts.push(ex,ey)}else{verts.push(sx,sy),verts.push(cx,cy);for(let i$1=1,angle=startAngle;i$1<segCount;i$1++,angle+=angleInc)verts.push(cx+Math.sin(angle)*radius,cy+Math.cos(angle)*radius),verts.push(cx,cy);verts.push(ex,ey),verts.push(cx,cy)}return segCount*2}function buildLine(points$1,lineStyle,flipAlignment,closed,vertices,indices){let eps=closePointEps;if(points$1.length===0)return;let style=lineStyle,alignment=style.alignment;if(lineStyle.alignment!==.5){let orientation=getOrientationOfPoints(points$1);flipAlignment&&(orientation*=-1),alignment=(alignment-.5)*orientation+.5}let firstPoint=new Point$1(points$1[0],points$1[1]),lastPoint=new Point$1(points$1[points$1.length-2],points$1[points$1.length-1]),closedShape=closed,closedPath=Math.abs(firstPoint.x-lastPoint.x)<eps&&Math.abs(firstPoint.y-lastPoint.y)<eps;if(closedShape){points$1=points$1.slice(),closedPath&&(points$1.pop(),points$1.pop(),lastPoint.set(points$1[points$1.length-2],points$1[points$1.length-1]));let midPointX=(firstPoint.x+lastPoint.x)*.5,midPointY=(lastPoint.y+firstPoint.y)*.5;points$1.unshift(midPointX,midPointY),points$1.push(midPointX,midPointY)}let verts=vertices,length$1=points$1.length/2,indexCount=points$1.length,indexStart=verts.length/2,width=style.width/2,widthSquared=width*width,miterLimitSquared=style.miterLimit*style.miterLimit,x0=points$1[0],y0=points$1[1],x1=points$1[2],y1=points$1[3],x2=0,y2=0,perpX=-(y0-y1),perpY=x0-x1,perp1x=0,perp1y=0,dist$2=Math.sqrt(perpX*perpX+perpY*perpY);perpX/=dist$2,perpY/=dist$2,perpX*=width,perpY*=width;let ratio=alignment,innerWeight=(1-ratio)*2,outerWeight=ratio*2;closedShape||(style.cap===`round`?indexCount+=round$2(x0-perpX*(innerWeight-outerWeight)*.5,y0-perpY*(innerWeight-outerWeight)*.5,x0-perpX*innerWeight,y0-perpY*innerWeight,x0+perpX*outerWeight,y0+perpY*outerWeight,verts,!0)+2:style.cap===`square`&&(indexCount+=square(x0,y0,perpX,perpY,innerWeight,outerWeight,!0,verts))),verts.push(x0-perpX*innerWeight,y0-perpY*innerWeight),verts.push(x0+perpX*outerWeight,y0+perpY*outerWeight);for(let i$1=1;i$1<length$1-1;++i$1){x0=points$1[(i$1-1)*2],y0=points$1[(i$1-1)*2+1],x1=points$1[i$1*2],y1=points$1[i$1*2+1],x2=points$1[(i$1+1)*2],y2=points$1[(i$1+1)*2+1],perpX=-(y0-y1),perpY=x0-x1,dist$2=Math.sqrt(perpX*perpX+perpY*perpY),perpX/=dist$2,perpY/=dist$2,perpX*=width,perpY*=width,perp1x=-(y1-y2),perp1y=x1-x2,dist$2=Math.sqrt(perp1x*perp1x+perp1y*perp1y),perp1x/=dist$2,perp1y/=dist$2,perp1x*=width,perp1y*=width;let dx0=x1-x0,dy0=y0-y1,dx1=x1-x2,dy1=y2-y1,dot=dx0*dx1+dy0*dy1,cross=dy0*dx1-dy1*dx0,clockwise=cross<0;if(Math.abs(cross)<.001*Math.abs(dot)){verts.push(x1-perpX*innerWeight,y1-perpY*innerWeight),verts.push(x1+perpX*outerWeight,y1+perpY*outerWeight),dot>=0&&(style.join===`round`?indexCount+=round$2(x1,y1,x1-perpX*innerWeight,y1-perpY*innerWeight,x1-perp1x*innerWeight,y1-perp1y*innerWeight,verts,!1)+4:indexCount+=2,verts.push(x1-perp1x*outerWeight,y1-perp1y*outerWeight),verts.push(x1+perp1x*innerWeight,y1+perp1y*innerWeight));continue}let c1=(-perpX+x0)*(-perpY+y1)-(-perpX+x1)*(-perpY+y0),c2=(-perp1x+x2)*(-perp1y+y1)-(-perp1x+x1)*(-perp1y+y2),px=(dx0*c2-dx1*c1)/cross,py=(dy1*c1-dy0*c2)/cross,pDist=(px-x1)*(px-x1)+(py-y1)*(py-y1),imx=x1+(px-x1)*innerWeight,imy=y1+(py-y1)*innerWeight,omx=x1-(px-x1)*outerWeight,omy=y1-(py-y1)*outerWeight,smallerInsideSegmentSq=Math.min(dx0*dx0+dy0*dy0,dx1*dx1+dy1*dy1),insideWeight=clockwise?innerWeight:outerWeight,smallerInsideDiagonalSq=smallerInsideSegmentSq+insideWeight*insideWeight*widthSquared;pDist<=smallerInsideDiagonalSq?style.join===`bevel`||pDist/widthSquared>miterLimitSquared?(clockwise?(verts.push(imx,imy),verts.push(x1+perpX*outerWeight,y1+perpY*outerWeight),verts.push(imx,imy),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight)):(verts.push(x1-perpX*innerWeight,y1-perpY*innerWeight),verts.push(omx,omy),verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(omx,omy)),indexCount+=2):style.join===`round`?clockwise?(verts.push(imx,imy),verts.push(x1+perpX*outerWeight,y1+perpY*outerWeight),indexCount+=round$2(x1,y1,x1+perpX*outerWeight,y1+perpY*outerWeight,x1+perp1x*outerWeight,y1+perp1y*outerWeight,verts,!0)+4,verts.push(imx,imy),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight)):(verts.push(x1-perpX*innerWeight,y1-perpY*innerWeight),verts.push(omx,omy),indexCount+=round$2(x1,y1,x1-perpX*innerWeight,y1-perpY*innerWeight,x1-perp1x*innerWeight,y1-perp1y*innerWeight,verts,!1)+4,verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(omx,omy)):(verts.push(imx,imy),verts.push(omx,omy)):(verts.push(x1-perpX*innerWeight,y1-perpY*innerWeight),verts.push(x1+perpX*outerWeight,y1+perpY*outerWeight),style.join===`round`?clockwise?indexCount+=round$2(x1,y1,x1+perpX*outerWeight,y1+perpY*outerWeight,x1+perp1x*outerWeight,y1+perp1y*outerWeight,verts,!0)+2:indexCount+=round$2(x1,y1,x1-perpX*innerWeight,y1-perpY*innerWeight,x1-perp1x*innerWeight,y1-perp1y*innerWeight,verts,!1)+2:style.join===`miter`&&pDist/widthSquared<=miterLimitSquared&&(clockwise?(verts.push(omx,omy),verts.push(omx,omy)):(verts.push(imx,imy),verts.push(imx,imy)),indexCount+=2),verts.push(x1-perp1x*innerWeight,y1-perp1y*innerWeight),verts.push(x1+perp1x*outerWeight,y1+perp1y*outerWeight),indexCount+=2)}x0=points$1[(length$1-2)*2],y0=points$1[(length$1-2)*2+1],x1=points$1[(length$1-1)*2],y1=points$1[(length$1-1)*2+1],perpX=-(y0-y1),perpY=x0-x1,dist$2=Math.sqrt(perpX*perpX+perpY*perpY),perpX/=dist$2,perpY/=dist$2,perpX*=width,perpY*=width,verts.push(x1-perpX*innerWeight,y1-perpY*innerWeight),verts.push(x1+perpX*outerWeight,y1+perpY*outerWeight),closedShape||(style.cap===`round`?indexCount+=round$2(x1-perpX*(innerWeight-outerWeight)*.5,y1-perpY*(innerWeight-outerWeight)*.5,x1-perpX*innerWeight,y1-perpY*innerWeight,x1+perpX*outerWeight,y1+perpY*outerWeight,verts,!1)+2:style.cap===`square`&&(indexCount+=square(x1,y1,perpX,perpY,innerWeight,outerWeight,!1,verts)));let eps2=curveEps*curveEps;for(let i$1=indexStart;i$1<indexCount+indexStart-2;++i$1)x0=verts[i$1*2],y0=verts[i$1*2+1],x1=verts[(i$1+1)*2],y1=verts[(i$1+1)*2+1],x2=verts[(i$1+2)*2],y2=verts[(i$1+2)*2+1],!(Math.abs(x0*(y1-y2)+x1*(y2-y0)+x2*(y0-y1))<eps2)&&indices.push(i$1,i$1+1,i$1+2)}function buildPixelLine(points$1,closed,vertices,indices){let eps=closePointEps;if(points$1.length===0)return;let fx=points$1[0],fy=points$1[1],lx=points$1[points$1.length-2],ly=points$1[points$1.length-1],closePath=closed||Math.abs(fx-lx)<eps&&Math.abs(fy-ly)<eps,verts=vertices,length$1=points$1.length/2,indexStart=verts.length/2;for(let i$1=0;i$1<length$1;i$1++)verts.push(points$1[i$1*2]),verts.push(points$1[i$1*2+1]);for(let i$1=0;i$1<length$1-1;i$1++)indices.push(indexStart+i$1,indexStart+i$1+1);closePath&&indices.push(indexStart+length$1-1,indexStart)}function triangulateWithHoles(points$1,holes,vertices,verticesStride,verticesOffset,indices,indicesOffset){let triangles=earcut(points$1,holes,2);if(!triangles)return;for(let i$1=0;i$1<triangles.length;i$1+=3)indices[indicesOffset++]=triangles[i$1]+verticesOffset,indices[indicesOffset++]=triangles[i$1+1]+verticesOffset,indices[indicesOffset++]=triangles[i$1+2]+verticesOffset;let index=verticesOffset*verticesStride;for(let i$1=0;i$1<points$1.length;i$1+=2)vertices[index]=points$1[i$1],vertices[index+1]=points$1[i$1+1],index+=verticesStride}var emptyArray=[],buildPolygon={extension:{type:ExtensionType.ShapeBuilder,name:`polygon`},build(shape,points$1){for(let i$1=0;i$1<shape.points.length;i$1++)points$1[i$1]=shape.points[i$1];return!0},triangulate(points$1,vertices,verticesStride,verticesOffset,indices,indicesOffset){triangulateWithHoles(points$1,emptyArray,vertices,verticesStride,verticesOffset,indices,indicesOffset)}},buildRectangle={extension:{type:ExtensionType.ShapeBuilder,name:`rectangle`},build(shape,points$1){let rectData=shape,x$1=rectData.x,y$1=rectData.y,width=rectData.width,height=rectData.height;return width>0&&height>0?(points$1[0]=x$1,points$1[1]=y$1,points$1[2]=x$1+width,points$1[3]=y$1,points$1[4]=x$1+width,points$1[5]=y$1+height,points$1[6]=x$1,points$1[7]=y$1+height,!0):!1},triangulate(points$1,vertices,verticesStride,verticesOffset,indices,indicesOffset){let count$1=0;verticesOffset*=verticesStride,vertices[verticesOffset+count$1]=points$1[0],vertices[verticesOffset+count$1+1]=points$1[1],count$1+=verticesStride,vertices[verticesOffset+count$1]=points$1[2],vertices[verticesOffset+count$1+1]=points$1[3],count$1+=verticesStride,vertices[verticesOffset+count$1]=points$1[6],vertices[verticesOffset+count$1+1]=points$1[7],count$1+=verticesStride,vertices[verticesOffset+count$1]=points$1[4],vertices[verticesOffset+count$1+1]=points$1[5],count$1+=verticesStride;let verticesIndex=verticesOffset/verticesStride;indices[indicesOffset++]=verticesIndex,indices[indicesOffset++]=verticesIndex+1,indices[indicesOffset++]=verticesIndex+2,indices[indicesOffset++]=verticesIndex+1,indices[indicesOffset++]=verticesIndex+3,indices[indicesOffset++]=verticesIndex+2}},buildTriangle={extension:{type:ExtensionType.ShapeBuilder,name:`triangle`},build(shape,points$1){return points$1[0]=shape.x,points$1[1]=shape.y,points$1[2]=shape.x2,points$1[3]=shape.y2,points$1[4]=shape.x3,points$1[5]=shape.y3,!0},triangulate(points$1,vertices,verticesStride,verticesOffset,indices,indicesOffset){let count$1=0;verticesOffset*=verticesStride,vertices[verticesOffset+count$1]=points$1[0],vertices[verticesOffset+count$1+1]=points$1[1],count$1+=verticesStride,vertices[verticesOffset+count$1]=points$1[2],vertices[verticesOffset+count$1+1]=points$1[3],count$1+=verticesStride,vertices[verticesOffset+count$1]=points$1[4],vertices[verticesOffset+count$1+1]=points$1[5];let verticesIndex=verticesOffset/verticesStride;indices[indicesOffset++]=verticesIndex,indices[indicesOffset++]=verticesIndex+1,indices[indicesOffset++]=verticesIndex+2}},tempTextureMatrix$1=new Matrix,tempRect$3=new Rectangle;function generateTextureMatrix(out$2,style,shape,matrix){let textureMatrix=style.matrix?out$2.copyFrom(style.matrix).invert():out$2.identity();if(style.textureSpace===`local`){let bounds=shape.getBounds(tempRect$3);style.width&&bounds.pad(style.width);let{x:tx,y:ty}=bounds,sx=1/bounds.width,sy=1/bounds.height,mTx=-tx*sx,mTy=-ty*sy,a1=textureMatrix.a,b1=textureMatrix.b,c1=textureMatrix.c,d1=textureMatrix.d;textureMatrix.a*=sx,textureMatrix.b*=sx,textureMatrix.c*=sy,textureMatrix.d*=sy,textureMatrix.tx=mTx*a1+mTy*c1+textureMatrix.tx,textureMatrix.ty=mTx*b1+mTy*d1+textureMatrix.ty}else textureMatrix.translate(style.texture.frame.x,style.texture.frame.y),textureMatrix.scale(1/style.texture.source.width,1/style.texture.source.height);let sourceStyle=style.texture.source.style;return!(style.fill instanceof FillGradient)&&sourceStyle.addressMode===`clamp-to-edge`&&(sourceStyle.addressMode=`repeat`,sourceStyle.update()),matrix&&textureMatrix.append(tempTextureMatrix$1.copyFrom(matrix).invert()),textureMatrix}var shapeBuilders={};extensions$1.handleByMap(ExtensionType.ShapeBuilder,shapeBuilders),extensions$1.add(buildRectangle,buildPolygon,buildTriangle,buildCircle,buildEllipse,buildRoundedRectangle);var tempRect$2=new Rectangle,tempTextureMatrix=new Matrix;function buildContextBatches(context$1,gpuContext){let{geometryData,batches}=gpuContext;batches.length=0,geometryData.indices.length=0,geometryData.vertices.length=0,geometryData.uvs.length=0;for(let i$1=0;i$1<context$1.instructions.length;i$1++){let instruction=context$1.instructions[i$1];if(instruction.action===`texture`)addTextureToGeometryData(instruction.data,batches,geometryData);else if(instruction.action===`fill`||instruction.action===`stroke`){let isStroke=instruction.action===`stroke`,shapePath=instruction.data.path.shapePath,style=instruction.data.style,hole=instruction.data.hole;isStroke&&hole&&addShapePathToGeometryData(hole.shapePath,style,!0,batches,geometryData),hole&&(shapePath.shapePrimitives[shapePath.shapePrimitives.length-1].holes=hole.shapePath.shapePrimitives),addShapePathToGeometryData(shapePath,style,isStroke,batches,geometryData)}}}function addTextureToGeometryData(data,batches,geometryData){let points$1=[],build$1=shapeBuilders.rectangle,rect=tempRect$2;rect.x=data.dx,rect.y=data.dy,rect.width=data.dw,rect.height=data.dh;let matrix=data.transform;if(!build$1.build(rect,points$1))return;let{vertices,uvs,indices}=geometryData,indexOffset=indices.length,vertOffset=vertices.length/2;matrix&&transformVertices(points$1,matrix),build$1.triangulate(points$1,vertices,2,vertOffset,indices,indexOffset);let texture=data.image,textureUvs=texture.uvs;uvs.push(textureUvs.x0,textureUvs.y0,textureUvs.x1,textureUvs.y1,textureUvs.x3,textureUvs.y3,textureUvs.x2,textureUvs.y2);let graphicsBatch=BigPool.get(BatchableGraphics);graphicsBatch.indexOffset=indexOffset,graphicsBatch.indexSize=indices.length-indexOffset,graphicsBatch.attributeOffset=vertOffset,graphicsBatch.attributeSize=vertices.length/2-vertOffset,graphicsBatch.baseColor=data.style,graphicsBatch.alpha=data.alpha,graphicsBatch.texture=texture,graphicsBatch.geometryData=geometryData,batches.push(graphicsBatch)}function addShapePathToGeometryData(shapePath,style,isStroke,batches,geometryData){let{vertices,uvs,indices}=geometryData;shapePath.shapePrimitives.forEach(({shape,transform:matrix,holes})=>{let points$1=[],build$1=shapeBuilders[shape.type];if(!build$1.build(shape,points$1))return;let indexOffset=indices.length,vertOffset=vertices.length/2,topology=`triangle-list`;if(matrix&&transformVertices(points$1,matrix),isStroke){let close=shape.closePath??!0,lineStyle=style;lineStyle.pixelLine?(buildPixelLine(points$1,close,vertices,indices),topology=`line-list`):buildLine(points$1,lineStyle,!1,close,vertices,indices)}else if(holes){let holeIndices=[],otherPoints=points$1.slice();getHoleArrays(holes).forEach(holePoints=>{holeIndices.push(otherPoints.length/2),otherPoints.push(...holePoints)}),triangulateWithHoles(otherPoints,holeIndices,vertices,2,vertOffset,indices,indexOffset)}else build$1.triangulate(points$1,vertices,2,vertOffset,indices,indexOffset);let uvsOffset=uvs.length/2,texture=style.texture;if(texture!==Texture.WHITE){let textureMatrix=generateTextureMatrix(tempTextureMatrix,style,shape,matrix);buildUvs(vertices,2,vertOffset,uvs,uvsOffset,2,vertices.length/2-vertOffset,textureMatrix)}else buildSimpleUvs(uvs,uvsOffset,2,vertices.length/2-vertOffset);let graphicsBatch=BigPool.get(BatchableGraphics);graphicsBatch.indexOffset=indexOffset,graphicsBatch.indexSize=indices.length-indexOffset,graphicsBatch.attributeOffset=vertOffset,graphicsBatch.attributeSize=vertices.length/2-vertOffset,graphicsBatch.baseColor=style.color,graphicsBatch.alpha=style.alpha,graphicsBatch.texture=texture,graphicsBatch.geometryData=geometryData,graphicsBatch.topology=topology,batches.push(graphicsBatch)})}function getHoleArrays(holePrimitives){let holeArrays=[];for(let k$1=0;k$1<holePrimitives.length;k$1++){let holePrimitive=holePrimitives[k$1].shape,holePoints=[];shapeBuilders[holePrimitive.type].build(holePrimitive,holePoints)&&holeArrays.push(holePoints)}return holeArrays}var GpuGraphicsContext=class{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}},GraphicsContextRenderData=class{constructor(){this.instructions=new InstructionSet}init(maxTextures){this.batcher=new DefaultBatcher({maxTextures}),this.instructions.reset()}get geometry(){return deprecation(v8_3_4,`GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead.`),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}},_GraphicsContextSystem=class _GraphicsContextSystem$1{constructor(renderer$1){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=renderer$1,renderer$1.renderableGC.addManagedHash(this,`_gpuContextHash`),renderer$1.renderableGC.addManagedHash(this,`_graphicsDataContextHash`)}init(options){_GraphicsContextSystem$1.defaultOptions.bezierSmoothness=options?.bezierSmoothness??_GraphicsContextSystem$1.defaultOptions.bezierSmoothness}getContextRenderData(context$1){return this._graphicsDataContextHash[context$1.uid]||this._initContextRenderData(context$1)}updateGpuContext(context$1){let gpuContext=this._gpuContextHash[context$1.uid]||this._initContext(context$1);if(context$1.dirty){gpuContext?this._cleanGraphicsContextData(context$1):gpuContext=this._initContext(context$1),buildContextBatches(context$1,gpuContext);let batchMode=context$1.batchMode;context$1.customShader||batchMode===`no-batch`?gpuContext.isBatchable=!1:batchMode===`auto`?gpuContext.isBatchable=gpuContext.geometryData.vertices.length<400:gpuContext.isBatchable=!0,context$1.dirty=!1}return gpuContext}getGpuContext(context$1){return this._gpuContextHash[context$1.uid]||this._initContext(context$1)}_initContextRenderData(context$1){let graphicsData=BigPool.get(GraphicsContextRenderData,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches,geometryData}=this._gpuContextHash[context$1.uid],vertexSize=geometryData.vertices.length,indexSize=geometryData.indices.length;for(let i$1=0;i$1<batches.length;i$1++)batches[i$1].applyTransform=!1;let batcher=graphicsData.batcher;batcher.ensureAttributeBuffer(vertexSize),batcher.ensureIndexBuffer(indexSize),batcher.begin();for(let i$1=0;i$1<batches.length;i$1++){let batch$1=batches[i$1];batcher.add(batch$1)}batcher.finish(graphicsData.instructions);let geometry=batcher.geometry;geometry.indexBuffer.setDataWithSize(batcher.indexBuffer,batcher.indexSize,!0),geometry.buffers[0].setDataWithSize(batcher.attributeBuffer.float32View,batcher.attributeSize,!0);let drawBatches=batcher.batches;for(let i$1=0;i$1<drawBatches.length;i$1++){let batch$1=drawBatches[i$1];batch$1.bindGroup=getTextureBatchBindGroup(batch$1.textures.textures,batch$1.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[context$1.uid]=graphicsData,graphicsData}_initContext(context$1){let gpuContext=new GpuGraphicsContext;return gpuContext.context=context$1,this._gpuContextHash[context$1.uid]=gpuContext,context$1.on(`destroy`,this.onGraphicsContextDestroy,this),this._gpuContextHash[context$1.uid]}onGraphicsContextDestroy(context$1){this._cleanGraphicsContextData(context$1),context$1.off(`destroy`,this.onGraphicsContextDestroy,this),this._gpuContextHash[context$1.uid]=null}_cleanGraphicsContextData(context$1){let gpuContext=this._gpuContextHash[context$1.uid];gpuContext.isBatchable||this._graphicsDataContextHash[context$1.uid]&&(BigPool.return(this.getContextRenderData(context$1)),this._graphicsDataContextHash[context$1.uid]=null),gpuContext.batches&&gpuContext.batches.forEach(batch$1=>{BigPool.return(batch$1)})}destroy(){for(let i$1 in this._gpuContextHash)this._gpuContextHash[i$1]&&this.onGraphicsContextDestroy(this._gpuContextHash[i$1].context)}};_GraphicsContextSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`graphicsContext`},_GraphicsContextSystem.defaultOptions={bezierSmoothness:.5};var GraphicsContextSystem=_GraphicsContextSystem,RECURSION_LIMIT$1=8,FLT_EPSILON$1=1.1920929e-7,PATH_DISTANCE_EPSILON$1=1,curveAngleToleranceEpsilon$1=.01,mAngleTolerance$1=0,mCuspLimit=0;function buildAdaptiveBezier(points$1,sX,sY,cp1x,cp1y,cp2x,cp2y,eX,eY,smoothness){let scale$3=1,smoothing=Math.min(.99,Math.max(0,smoothness??GraphicsContextSystem.defaultOptions.bezierSmoothness)),distanceTolerance=(PATH_DISTANCE_EPSILON$1-smoothing)/1;return distanceTolerance*=distanceTolerance,begin$1(sX,sY,cp1x,cp1y,cp2x,cp2y,eX,eY,points$1,distanceTolerance),points$1}function begin$1(sX,sY,cp1x,cp1y,cp2x,cp2y,eX,eY,points$1,distanceTolerance){recursive$1(sX,sY,cp1x,cp1y,cp2x,cp2y,eX,eY,points$1,distanceTolerance,0),points$1.push(eX,eY)}function recursive$1(x1,y1,x2,y2,x3,y3,x4,y4,points$1,distanceTolerance,level){if(level>RECURSION_LIMIT$1)return;let pi=Math.PI,x12=(x1+x2)/2,y12=(y1+y2)/2,x23=(x2+x3)/2,y23=(y2+y3)/2,x34=(x3+x4)/2,y34=(y3+y4)/2,x123=(x12+x23)/2,y123=(y12+y23)/2,x234=(x23+x34)/2,y234=(y23+y34)/2,x1234=(x123+x234)/2,y1234=(y123+y234)/2;if(level>0){let dx=x4-x1,dy=y4-y1,d2=Math.abs((x2-x4)*dy-(y2-y4)*dx),d3=Math.abs((x3-x4)*dy-(y3-y4)*dx),da1,da2;if(d2>FLT_EPSILON$1&&d3>FLT_EPSILON$1){if((d2+d3)*(d2+d3)<=distanceTolerance*(dx*dx+dy*dy)){if(mAngleTolerance$1<curveAngleToleranceEpsilon$1){points$1.push(x1234,y1234);return}let a23=Math.atan2(y3-y2,x3-x2);if(da1=Math.abs(a23-Math.atan2(y2-y1,x2-x1)),da2=Math.abs(Math.atan2(y4-y3,x4-x3)-a23),da1>=pi&&(da1=2*pi-da1),da2>=pi&&(da2=2*pi-da2),da1+da2<mAngleTolerance$1){points$1.push(x1234,y1234);return}if(mCuspLimit!==0){if(da1>mCuspLimit){points$1.push(x2,y2);return}if(da2>mCuspLimit){points$1.push(x3,y3);return}}}}else if(d2>FLT_EPSILON$1){if(d2*d2<=distanceTolerance*(dx*dx+dy*dy)){if(mAngleTolerance$1<curveAngleToleranceEpsilon$1){points$1.push(x1234,y1234);return}if(da1=Math.abs(Math.atan2(y3-y2,x3-x2)-Math.atan2(y2-y1,x2-x1)),da1>=pi&&(da1=2*pi-da1),da1<mAngleTolerance$1){points$1.push(x2,y2),points$1.push(x3,y3);return}if(mCuspLimit!==0&&da1>mCuspLimit){points$1.push(x2,y2);return}}}else if(d3>FLT_EPSILON$1){if(d3*d3<=distanceTolerance*(dx*dx+dy*dy)){if(mAngleTolerance$1<curveAngleToleranceEpsilon$1){points$1.push(x1234,y1234);return}if(da1=Math.abs(Math.atan2(y4-y3,x4-x3)-Math.atan2(y3-y2,x3-x2)),da1>=pi&&(da1=2*pi-da1),da1<mAngleTolerance$1){points$1.push(x2,y2),points$1.push(x3,y3);return}if(mCuspLimit!==0&&da1>mCuspLimit){points$1.push(x3,y3);return}}}else if(dx=x1234-(x1+x4)/2,dy=y1234-(y1+y4)/2,dx*dx+dy*dy<=distanceTolerance){points$1.push(x1234,y1234);return}}recursive$1(x1,y1,x12,y12,x123,y123,x1234,y1234,points$1,distanceTolerance,level+1),recursive$1(x1234,y1234,x234,y234,x34,y34,x4,y4,points$1,distanceTolerance,level+1)}var RECURSION_LIMIT=8,FLT_EPSILON=1.1920929e-7,PATH_DISTANCE_EPSILON=1,curveAngleToleranceEpsilon=.01,mAngleTolerance=0;function buildAdaptiveQuadratic(points$1,sX,sY,cp1x,cp1y,eX,eY,smoothness){let scale$3=1,smoothing=Math.min(.99,Math.max(0,smoothness??GraphicsContextSystem.defaultOptions.bezierSmoothness)),distanceTolerance=(PATH_DISTANCE_EPSILON-smoothing)/1;return distanceTolerance*=distanceTolerance,begin(sX,sY,cp1x,cp1y,eX,eY,points$1,distanceTolerance),points$1}function begin(sX,sY,cp1x,cp1y,eX,eY,points$1,distanceTolerance){recursive(points$1,sX,sY,cp1x,cp1y,eX,eY,distanceTolerance,0),points$1.push(eX,eY)}function recursive(points$1,x1,y1,x2,y2,x3,y3,distanceTolerance,level){if(level>RECURSION_LIMIT)return;let pi=Math.PI,x12=(x1+x2)/2,y12=(y1+y2)/2,x23=(x2+x3)/2,y23=(y2+y3)/2,x123=(x12+x23)/2,y123=(y12+y23)/2,dx=x3-x1,dy=y3-y1,d$1=Math.abs((x2-x3)*dy-(y2-y3)*dx);if(d$1>FLT_EPSILON){if(d$1*d$1<=distanceTolerance*(dx*dx+dy*dy)){if(mAngleTolerance<curveAngleToleranceEpsilon){points$1.push(x123,y123);return}let da=Math.abs(Math.atan2(y3-y2,x3-x2)-Math.atan2(y2-y1,x2-x1));if(da>=pi&&(da=2*pi-da),da<mAngleTolerance){points$1.push(x123,y123);return}}}else if(dx=x123-(x1+x3)/2,dy=y123-(y1+y3)/2,dx*dx+dy*dy<=distanceTolerance){points$1.push(x123,y123);return}recursive(points$1,x1,y1,x12,y12,x123,y123,distanceTolerance,level+1),recursive(points$1,x123,y123,x23,y23,x3,y3,distanceTolerance,level+1)}function buildArc(points$1,x$1,y$1,radius,start$1,end$1,clockwise,steps){let dist$2=Math.abs(start$1-end$1);(!clockwise&&start$1>end$1||clockwise&&end$1>start$1)&&(dist$2=2*Math.PI-dist$2),steps||=Math.max(6,Math.floor(6*radius**(1/3)*(dist$2/Math.PI))),steps=Math.max(steps,3);let f$1=dist$2/steps,t$1=start$1;f$1*=clockwise?-1:1;for(let i$1=0;i$1<steps+1;i$1++){let cs=Math.cos(t$1),sn=Math.sin(t$1),nx=x$1+cs*radius,ny=y$1+sn*radius;points$1.push(nx,ny),t$1+=f$1}}function buildArcTo(points$1,x1,y1,x2,y2,radius){let fromX=points$1[points$1.length-2],a1=points$1[points$1.length-1]-y1,b1=fromX-x1,a2=y2-y1,b2=x2-x1,mm=Math.abs(a1*b2-b1*a2);if(mm<1e-8||radius===0){(points$1[points$1.length-2]!==x1||points$1[points$1.length-1]!==y1)&&points$1.push(x1,y1);return}let dd=a1*a1+b1*b1,cc=a2*a2+b2*b2,tt$1=a1*a2+b1*b2,k1=radius*Math.sqrt(dd)/mm,k2=radius*Math.sqrt(cc)/mm,j1=k1*tt$1/dd,j2=k2*tt$1/cc,cx=k1*b2+k2*b1,cy=k1*a2+k2*a1,px=b1*(k2+j1),py=a1*(k2+j1),qx=b2*(k1+j2),qy=a2*(k1+j2),startAngle=Math.atan2(py-cy,px-cx),endAngle=Math.atan2(qy-cy,qx-cx);buildArc(points$1,cx+x1,cy+y1,radius,startAngle,endAngle,b1*a2>b2*a1)}var TAU=Math.PI*2,out$1={centerX:0,centerY:0,ang1:0,ang2:0},mapToEllipse=({x:x$1,y:y$1},rx,ry,cosPhi,sinPhi,centerX,centerY,out2)=>{x$1*=rx,y$1*=ry;let xp=cosPhi*x$1-sinPhi*y$1,yp=sinPhi*x$1+cosPhi*y$1;return out2.x=xp+centerX,out2.y=yp+centerY,out2};function approxUnitArc(ang1,ang2){let a1=ang2===-1.5707963267948966?-.551915024494:4/3*Math.tan(ang2/4),a$1=ang2===1.5707963267948966?.551915024494:a1,x1=Math.cos(ang1),y1=Math.sin(ang1),x2=Math.cos(ang1+ang2),y2=Math.sin(ang1+ang2);return[{x:x1-y1*a$1,y:y1+x1*a$1},{x:x2+y2*a$1,y:y2-x2*a$1},{x:x2,y:y2}]}var vectorAngle=(ux$1,uy$1,vx$1,vy$1)=>{let sign$1=ux$1*vy$1-uy$1*vx$1<0?-1:1,dot=ux$1*vx$1+uy$1*vy$1;return dot>1&&(dot=1),dot<-1&&(dot=-1),sign$1*Math.acos(dot)},getArcCenter=(px,py,cx,cy,rx,ry,largeArcFlag,sweepFlag,sinPhi,cosPhi,pxp,pyp,out2)=>{let rxSq=rx**2,rySq=ry**2,pxpSq=pxp**2,pypSq=pyp**2,radicant=rxSq*rySq-rxSq*pypSq-rySq*pxpSq;radicant<0&&(radicant=0),radicant/=rxSq*pypSq+rySq*pxpSq,radicant=Math.sqrt(radicant)*(largeArcFlag===sweepFlag?-1:1);let centerXp=radicant*rx/ry*pyp,centerYp=radicant*-ry/rx*pxp,centerX=cosPhi*centerXp-sinPhi*centerYp+(px+cx)/2,centerY=sinPhi*centerXp+cosPhi*centerYp+(py+cy)/2,vx1=(pxp-centerXp)/rx,vy1=(pyp-centerYp)/ry,vx2=(-pxp-centerXp)/rx,vy2=(-pyp-centerYp)/ry,ang1=vectorAngle(1,0,vx1,vy1),ang2=vectorAngle(vx1,vy1,vx2,vy2);sweepFlag===0&&ang2>0&&(ang2-=TAU),sweepFlag===1&&ang2<0&&(ang2+=TAU),out2.centerX=centerX,out2.centerY=centerY,out2.ang1=ang1,out2.ang2=ang2};function buildArcToSvg(points$1,px,py,cx,cy,rx,ry,xAxisRotation=0,largeArcFlag=0,sweepFlag=0){if(rx===0||ry===0)return;let sinPhi=Math.sin(xAxisRotation*TAU/360),cosPhi=Math.cos(xAxisRotation*TAU/360),pxp=cosPhi*(px-cx)/2+sinPhi*(py-cy)/2,pyp=-sinPhi*(px-cx)/2+cosPhi*(py-cy)/2;if(pxp===0&&pyp===0)return;rx=Math.abs(rx),ry=Math.abs(ry);let lambda=pxp**2/rx**2+pyp**2/ry**2;lambda>1&&(rx*=Math.sqrt(lambda),ry*=Math.sqrt(lambda)),getArcCenter(px,py,cx,cy,rx,ry,largeArcFlag,sweepFlag,sinPhi,cosPhi,pxp,pyp,out$1);let{ang1,ang2}=out$1,{centerX,centerY}=out$1,ratio=Math.abs(ang2)/(TAU/4);Math.abs(1-ratio)<1e-7&&(ratio=1);let segments=Math.max(Math.ceil(ratio),1);ang2/=segments;let lastX=points$1[points$1.length-2],lastY=points$1[points$1.length-1],outCurvePoint={x:0,y:0};for(let i$1=0;i$1<segments;i$1++){let curve=approxUnitArc(ang1,ang2),{x:x1,y:y1}=mapToEllipse(curve[0],rx,ry,cosPhi,sinPhi,centerX,centerY,outCurvePoint),{x:x2,y:y2}=mapToEllipse(curve[1],rx,ry,cosPhi,sinPhi,centerX,centerY,outCurvePoint),{x:x$1,y:y$1}=mapToEllipse(curve[2],rx,ry,cosPhi,sinPhi,centerX,centerY,outCurvePoint);buildAdaptiveBezier(points$1,lastX,lastY,x1,y1,x2,y2,x$1,y$1),lastX=x$1,lastY=y$1,ang1+=ang2}}function roundedShapeArc(g$1,points$1,radius){let vecFrom=(p$2,pp)=>{let x$1=pp.x-p$2.x,y$1=pp.y-p$2.y,len$1=Math.sqrt(x$1*x$1+y$1*y$1),nx=x$1/len$1,ny=y$1/len$1;return{len:len$1,nx,ny}},sharpCorner=(i$1,p$2)=>{i$1===0?g$1.moveTo(p$2.x,p$2.y):g$1.lineTo(p$2.x,p$2.y)},p1=points$1[points$1.length-1];for(let i$1=0;i$1<points$1.length;i$1++){let p2=points$1[i$1%points$1.length],pRadius=p2.radius??radius;if(pRadius<=0){sharpCorner(i$1,p2),p1=p2;continue}let p3=points$1[(i$1+1)%points$1.length],v1=vecFrom(p2,p1),v2=vecFrom(p2,p3);if(v1.len<1e-4||v2.len<1e-4){sharpCorner(i$1,p2),p1=p2;continue}let angle=Math.asin(v1.nx*v2.ny-v1.ny*v2.nx),radDirection=1,drawDirection=!1;v1.nx*v2.nx-v1.ny*-v2.ny<0?angle<0?angle=Math.PI+angle:(angle=Math.PI-angle,radDirection=-1,drawDirection=!0):angle>0&&(radDirection=-1,drawDirection=!0);let halfAngle=angle/2,cRadius,lenOut=Math.abs(Math.cos(halfAngle)*pRadius/Math.sin(halfAngle));lenOut>Math.min(v1.len/2,v2.len/2)?(lenOut=Math.min(v1.len/2,v2.len/2),cRadius=Math.abs(lenOut*Math.sin(halfAngle)/Math.cos(halfAngle))):cRadius=pRadius;let cX=p2.x+v2.nx*lenOut+-v2.ny*cRadius*radDirection,cY=p2.y+v2.ny*lenOut+v2.nx*cRadius*radDirection,startAngle=Math.atan2(v1.ny,v1.nx)+Math.PI/2*radDirection,endAngle=Math.atan2(v2.ny,v2.nx)-Math.PI/2*radDirection;i$1===0&&g$1.moveTo(cX+Math.cos(startAngle)*cRadius,cY+Math.sin(startAngle)*cRadius),g$1.arc(cX,cY,cRadius,startAngle,endAngle,drawDirection),p1=p2}}function roundedShapeQuadraticCurve(g$1,points$1,radius,smoothness){let distance$1=(p1,p2)=>Math.sqrt((p1.x-p2.x)**2+(p1.y-p2.y)**2),pointLerp=(p1,p2,t$1)=>({x:p1.x+(p2.x-p1.x)*t$1,y:p1.y+(p2.y-p1.y)*t$1}),numPoints=points$1.length;for(let i$1=0;i$1<numPoints;i$1++){let thisPoint=points$1[(i$1+1)%numPoints],pRadius=thisPoint.radius??radius;if(pRadius<=0){i$1===0?g$1.moveTo(thisPoint.x,thisPoint.y):g$1.lineTo(thisPoint.x,thisPoint.y);continue}let lastPoint=points$1[i$1],nextPoint=points$1[(i$1+2)%numPoints],lastEdgeLength=distance$1(lastPoint,thisPoint),start$1;if(lastEdgeLength<1e-4)start$1=thisPoint;else{let lastOffsetDistance=Math.min(lastEdgeLength/2,pRadius);start$1=pointLerp(thisPoint,lastPoint,lastOffsetDistance/lastEdgeLength)}let nextEdgeLength=distance$1(nextPoint,thisPoint),end$1;if(nextEdgeLength<1e-4)end$1=thisPoint;else{let nextOffsetDistance=Math.min(nextEdgeLength/2,pRadius);end$1=pointLerp(thisPoint,nextPoint,nextOffsetDistance/nextEdgeLength)}i$1===0?g$1.moveTo(start$1.x,start$1.y):g$1.lineTo(start$1.x,start$1.y),g$1.quadraticCurveTo(thisPoint.x,thisPoint.y,end$1.x,end$1.y,smoothness)}}var tempRectangle=new Rectangle,ShapePath=class{constructor(graphicsPath2D){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Bounds,this._graphicsPath2D=graphicsPath2D,this.signed=graphicsPath2D.checkForHoles}moveTo(x$1,y$1){return this.startPoly(x$1,y$1),this}lineTo(x$1,y$1){this._ensurePoly();let points$1=this._currentPoly.points,fromX=points$1[points$1.length-2],fromY=points$1[points$1.length-1];return(fromX!==x$1||fromY!==y$1)&&points$1.push(x$1,y$1),this}arc(x$1,y$1,radius,startAngle,endAngle,counterclockwise){this._ensurePoly(!1);let points$1=this._currentPoly.points;return buildArc(points$1,x$1,y$1,radius,startAngle,endAngle,counterclockwise),this}arcTo(x1,y1,x2,y2,radius){this._ensurePoly();let points$1=this._currentPoly.points;return buildArcTo(points$1,x1,y1,x2,y2,radius),this}arcToSvg(rx,ry,xAxisRotation,largeArcFlag,sweepFlag,x$1,y$1){let points$1=this._currentPoly.points;return buildArcToSvg(points$1,this._currentPoly.lastX,this._currentPoly.lastY,x$1,y$1,rx,ry,xAxisRotation,largeArcFlag,sweepFlag),this}bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x$1,y$1,smoothness){this._ensurePoly();let currentPoly=this._currentPoly;return buildAdaptiveBezier(this._currentPoly.points,currentPoly.lastX,currentPoly.lastY,cp1x,cp1y,cp2x,cp2y,x$1,y$1,smoothness),this}quadraticCurveTo(cp1x,cp1y,x$1,y$1,smoothing){this._ensurePoly();let currentPoly=this._currentPoly;return buildAdaptiveQuadratic(this._currentPoly.points,currentPoly.lastX,currentPoly.lastY,cp1x,cp1y,x$1,y$1,smoothing),this}closePath(){return this.endPoly(!0),this}addPath(path$1,transform){this.endPoly(),transform&&!transform.isIdentity()&&(path$1=path$1.clone(!0),path$1.transform(transform));let shapePrimitives=this.shapePrimitives,start$1=shapePrimitives.length;for(let i$1=0;i$1<path$1.instructions.length;i$1++){let instruction=path$1.instructions[i$1];this[instruction.action](...instruction.data)}if(path$1.checkForHoles&&shapePrimitives.length-start$1>1){let mainShape=null;for(let i$1=start$1;i$1<shapePrimitives.length;i$1++){let shapePrimitive=shapePrimitives[i$1];if(shapePrimitive.shape.type===`polygon`){let polygon=shapePrimitive.shape,mainPolygon=mainShape?.shape;mainPolygon&&mainPolygon.containsPolygon(polygon)?(mainShape.holes||=[],mainShape.holes.push(shapePrimitive),shapePrimitives.copyWithin(i$1,i$1+1),shapePrimitives.length--,i$1--):mainShape=shapePrimitive}}}return this}finish(closePath=!1){this.endPoly(closePath)}rect(x$1,y$1,w$1,h$2,transform){return this.drawShape(new Rectangle(x$1,y$1,w$1,h$2),transform),this}circle(x$1,y$1,radius,transform){return this.drawShape(new Circle$1(x$1,y$1,radius),transform),this}poly(points$1,close,transform){let polygon=new Polygon$1(points$1);return polygon.closePath=close,this.drawShape(polygon,transform),this}regularPoly(x$1,y$1,radius,sides,rotation=0,transform){sides=Math.max(sides|0,3);let startAngle=-1*Math.PI/2+rotation,delta=Math.PI*2/sides,polygon=[];for(let i$1=0;i$1<sides;i$1++){let angle=startAngle-i$1*delta;polygon.push(x$1+radius*Math.cos(angle),y$1+radius*Math.sin(angle))}return this.poly(polygon,!0,transform),this}roundPoly(x$1,y$1,radius,sides,corner,rotation=0,smoothness){if(sides=Math.max(sides|0,3),corner<=0)return this.regularPoly(x$1,y$1,radius,sides,rotation);let sideLength=radius*Math.sin(Math.PI/sides)-.001;corner=Math.min(corner,sideLength);let startAngle=-1*Math.PI/2+rotation,delta=Math.PI*2/sides,internalAngle=(sides-2)*Math.PI/sides/2;for(let i$1=0;i$1<sides;i$1++){let angle=i$1*delta+startAngle,x0=x$1+radius*Math.cos(angle),y0=y$1+radius*Math.sin(angle),a1=angle+Math.PI+internalAngle,a2=angle-Math.PI-internalAngle,x1=x0+corner*Math.cos(a1),y1=y0+corner*Math.sin(a1),x3=x0+corner*Math.cos(a2),y3=y0+corner*Math.sin(a2);i$1===0?this.moveTo(x1,y1):this.lineTo(x1,y1),this.quadraticCurveTo(x0,y0,x3,y3,smoothness)}return this.closePath()}roundShape(points$1,radius,useQuadratic=!1,smoothness){return points$1.length<3?this:(useQuadratic?roundedShapeQuadraticCurve(this,points$1,radius,smoothness):roundedShapeArc(this,points$1,radius),this.closePath())}filletRect(x$1,y$1,width,height,fillet){if(fillet===0)return this.rect(x$1,y$1,width,height);let maxFillet=Math.min(width,height)/2,inset=Math.min(maxFillet,Math.max(-maxFillet,fillet)),right=x$1+width,bottom=y$1+height,dir=inset<0?-inset:0,size=Math.abs(inset);return this.moveTo(x$1,y$1+size).arcTo(x$1+dir,y$1+dir,x$1+size,y$1,size).lineTo(right-size,y$1).arcTo(right-dir,y$1+dir,right,y$1+size,size).lineTo(right,bottom-size).arcTo(right-dir,bottom-dir,x$1+width-size,bottom,size).lineTo(x$1+size,bottom).arcTo(x$1+dir,bottom-dir,x$1,bottom-size,size).closePath()}chamferRect(x$1,y$1,width,height,chamfer,transform){if(chamfer<=0)return this.rect(x$1,y$1,width,height);let inset=Math.min(chamfer,Math.min(width,height)/2),right=x$1+width,bottom=y$1+height,points$1=[x$1+inset,y$1,right-inset,y$1,right,y$1+inset,right,bottom-inset,right-inset,bottom,x$1+inset,bottom,x$1,bottom-inset,x$1,y$1+inset];for(let i$1=points$1.length-1;i$1>=2;i$1-=2)points$1[i$1]===points$1[i$1-2]&&points$1[i$1-1]===points$1[i$1-3]&&points$1.splice(i$1-1,2);return this.poly(points$1,!0,transform)}ellipse(x$1,y$1,radiusX,radiusY,transform){return this.drawShape(new Ellipse$1(x$1,y$1,radiusX,radiusY),transform),this}roundRect(x$1,y$1,w$1,h$2,radius,transform){return this.drawShape(new RoundedRectangle(x$1,y$1,w$1,h$2,radius),transform),this}drawShape(shape,matrix){return this.endPoly(),this.shapePrimitives.push({shape,transform:matrix}),this}startPoly(x$1,y$1){let currentPoly=this._currentPoly;return currentPoly&&this.endPoly(),currentPoly=new Polygon$1,currentPoly.points.push(x$1,y$1),this._currentPoly=currentPoly,this}endPoly(closePath=!1){let shape=this._currentPoly;return shape&&shape.points.length>2&&(shape.closePath=closePath,this.shapePrimitives.push({shape})),this._currentPoly=null,this}_ensurePoly(start$1=!0){if(!this._currentPoly&&(this._currentPoly=new Polygon$1,start$1)){let lastShape=this.shapePrimitives[this.shapePrimitives.length-1];if(lastShape){let lx=lastShape.shape.x,ly=lastShape.shape.y;if(lastShape.transform&&!lastShape.transform.isIdentity()){let t$1=lastShape.transform,tempX=lx;lx=t$1.a*lx+t$1.c*ly+t$1.tx,ly=t$1.b*tempX+t$1.d*ly+t$1.ty}this._currentPoly.points.push(lx,ly)}else this._currentPoly.points.push(0,0)}}buildPath(){let path$1=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let i$1=0;i$1<path$1.instructions.length;i$1++){let instruction=path$1.instructions[i$1];this[instruction.action](...instruction.data)}this.finish()}get bounds(){let bounds=this._bounds;bounds.clear();let shapePrimitives=this.shapePrimitives;for(let i$1=0;i$1<shapePrimitives.length;i$1++){let shapePrimitive=shapePrimitives[i$1],boundsRect=shapePrimitive.shape.getBounds(tempRectangle);shapePrimitive.transform?bounds.addRect(boundsRect,shapePrimitive.transform):bounds.addRect(boundsRect)}return bounds}},GraphicsPath=class GraphicsPath{constructor(instructions,signed=!1){this.instructions=[],this.uid=uid$1(`graphicsPath`),this._dirty=!0,this.checkForHoles=signed,typeof instructions==`string`?parseSVGPath(instructions,this):this.instructions=instructions?.slice()??[]}get shapePath(){return this._shapePath||=new ShapePath(this),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(path$1,transform){return path$1=path$1.clone(),this.instructions.push({action:`addPath`,data:[path$1,transform]}),this._dirty=!0,this}arc(...args){return this.instructions.push({action:`arc`,data:args}),this._dirty=!0,this}arcTo(...args){return this.instructions.push({action:`arcTo`,data:args}),this._dirty=!0,this}arcToSvg(...args){return this.instructions.push({action:`arcToSvg`,data:args}),this._dirty=!0,this}bezierCurveTo(...args){return this.instructions.push({action:`bezierCurveTo`,data:args}),this._dirty=!0,this}bezierCurveToShort(cp2x,cp2y,x$1,y$1,smoothness){let last=this.instructions[this.instructions.length-1],lastPoint=this.getLastPoint(Point$1.shared),cp1x=0,cp1y=0;if(!last||last.action!==`bezierCurveTo`)cp1x=lastPoint.x,cp1y=lastPoint.y;else{cp1x=last.data[2],cp1y=last.data[3];let currentX=lastPoint.x,currentY=lastPoint.y;cp1x=currentX+(currentX-cp1x),cp1y=currentY+(currentY-cp1y)}return this.instructions.push({action:`bezierCurveTo`,data:[cp1x,cp1y,cp2x,cp2y,x$1,y$1,smoothness]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:`closePath`,data:[]}),this._dirty=!0,this}ellipse(...args){return this.instructions.push({action:`ellipse`,data:args}),this._dirty=!0,this}lineTo(...args){return this.instructions.push({action:`lineTo`,data:args}),this._dirty=!0,this}moveTo(...args){return this.instructions.push({action:`moveTo`,data:args}),this}quadraticCurveTo(...args){return this.instructions.push({action:`quadraticCurveTo`,data:args}),this._dirty=!0,this}quadraticCurveToShort(x$1,y$1,smoothness){let last=this.instructions[this.instructions.length-1],lastPoint=this.getLastPoint(Point$1.shared),cpx1=0,cpy1=0;if(!last||last.action!==`quadraticCurveTo`)cpx1=lastPoint.x,cpy1=lastPoint.y;else{cpx1=last.data[0],cpy1=last.data[1];let currentX=lastPoint.x,currentY=lastPoint.y;cpx1=currentX+(currentX-cpx1),cpy1=currentY+(currentY-cpy1)}return this.instructions.push({action:`quadraticCurveTo`,data:[cpx1,cpy1,x$1,y$1,smoothness]}),this._dirty=!0,this}rect(x$1,y$1,w$1,h$2,transform){return this.instructions.push({action:`rect`,data:[x$1,y$1,w$1,h$2,transform]}),this._dirty=!0,this}circle(x$1,y$1,radius,transform){return this.instructions.push({action:`circle`,data:[x$1,y$1,radius,transform]}),this._dirty=!0,this}roundRect(...args){return this.instructions.push({action:`roundRect`,data:args}),this._dirty=!0,this}poly(...args){return this.instructions.push({action:`poly`,data:args}),this._dirty=!0,this}regularPoly(...args){return this.instructions.push({action:`regularPoly`,data:args}),this._dirty=!0,this}roundPoly(...args){return this.instructions.push({action:`roundPoly`,data:args}),this._dirty=!0,this}roundShape(...args){return this.instructions.push({action:`roundShape`,data:args}),this._dirty=!0,this}filletRect(...args){return this.instructions.push({action:`filletRect`,data:args}),this._dirty=!0,this}chamferRect(...args){return this.instructions.push({action:`chamferRect`,data:args}),this._dirty=!0,this}star(x$1,y$1,points$1,radius,innerRadius,rotation,transform){innerRadius||=radius/2;let startAngle=-1*Math.PI/2+rotation,len$1=points$1*2,delta=Math.PI*2/len$1,polygon=[];for(let i$1=0;i$1<len$1;i$1++){let r$1=i$1%2?innerRadius:radius,angle=i$1*delta+startAngle;polygon.push(x$1+r$1*Math.cos(angle),y$1+r$1*Math.sin(angle))}return this.poly(polygon,!0,transform),this}clone(deep=!1){let newGraphicsPath2D=new GraphicsPath;if(newGraphicsPath2D.checkForHoles=this.checkForHoles,!deep)newGraphicsPath2D.instructions=this.instructions.slice();else for(let i$1=0;i$1<this.instructions.length;i$1++){let instruction=this.instructions[i$1];newGraphicsPath2D.instructions.push({action:instruction.action,data:instruction.data.slice()})}return newGraphicsPath2D}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(matrix){if(matrix.isIdentity())return this;let a$1=matrix.a,b$1=matrix.b,c$2=matrix.c,d$1=matrix.d,tx=matrix.tx,ty=matrix.ty,x$1=0,y$1=0,cpx1=0,cpy1=0,cpx2=0,cpy2=0,rx=0,ry=0;for(let i$1=0;i$1<this.instructions.length;i$1++){let instruction=this.instructions[i$1],data=instruction.data;switch(instruction.action){case`moveTo`:case`lineTo`:x$1=data[0],y$1=data[1],data[0]=a$1*x$1+c$2*y$1+tx,data[1]=b$1*x$1+d$1*y$1+ty;break;case`bezierCurveTo`:cpx1=data[0],cpy1=data[1],cpx2=data[2],cpy2=data[3],x$1=data[4],y$1=data[5],data[0]=a$1*cpx1+c$2*cpy1+tx,data[1]=b$1*cpx1+d$1*cpy1+ty,data[2]=a$1*cpx2+c$2*cpy2+tx,data[3]=b$1*cpx2+d$1*cpy2+ty,data[4]=a$1*x$1+c$2*y$1+tx,data[5]=b$1*x$1+d$1*y$1+ty;break;case`quadraticCurveTo`:cpx1=data[0],cpy1=data[1],x$1=data[2],y$1=data[3],data[0]=a$1*cpx1+c$2*cpy1+tx,data[1]=b$1*cpx1+d$1*cpy1+ty,data[2]=a$1*x$1+c$2*y$1+tx,data[3]=b$1*x$1+d$1*y$1+ty;break;case`arcToSvg`:x$1=data[5],y$1=data[6],rx=data[0],ry=data[1],data[0]=a$1*rx+c$2*ry,data[1]=b$1*rx+d$1*ry,data[5]=a$1*x$1+c$2*y$1+tx,data[6]=b$1*x$1+d$1*y$1+ty;break;case`circle`:data[4]=adjustTransform(data[3],matrix);break;case`rect`:data[4]=adjustTransform(data[4],matrix);break;case`ellipse`:data[8]=adjustTransform(data[8],matrix);break;case`roundRect`:data[5]=adjustTransform(data[5],matrix);break;case`addPath`:data[0].transform(matrix);break;case`poly`:data[2]=adjustTransform(data[2],matrix);break;default:warn$1(`unknown transform action`,instruction.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(out$2){let index=this.instructions.length-1,lastInstruction=this.instructions[index];if(!lastInstruction)return out$2.x=0,out$2.y=0,out$2;for(;lastInstruction.action===`closePath`;){if(index--,index<0)return out$2.x=0,out$2.y=0,out$2;lastInstruction=this.instructions[index]}switch(lastInstruction.action){case`moveTo`:case`lineTo`:out$2.x=lastInstruction.data[0],out$2.y=lastInstruction.data[1];break;case`quadraticCurveTo`:out$2.x=lastInstruction.data[2],out$2.y=lastInstruction.data[3];break;case`bezierCurveTo`:out$2.x=lastInstruction.data[4],out$2.y=lastInstruction.data[5];break;case`arc`:case`arcToSvg`:out$2.x=lastInstruction.data[5],out$2.y=lastInstruction.data[6];break;case`addPath`:lastInstruction.data[0].getLastPoint(out$2);break}return out$2}};function adjustTransform(currentMatrix,transform){return currentMatrix?currentMatrix.prepend(transform):transform.clone()}function parseSVGFloatAttribute(svg,id,defaultValue$1){let value=svg.getAttribute(id);return value?Number(value):defaultValue$1}function parseSVGDefinitions(svg,session){let definitions=svg.querySelectorAll(`defs`);for(let i$1=0;i$1<definitions.length;i$1++){let definition=definitions[i$1];for(let j$1=0;j$1<definition.children.length;j$1++){let child=definition.children[j$1];switch(child.nodeName.toLowerCase()){case`lineargradient`:session.defs[child.id]=parseLinearGradient(child);break;case`radialgradient`:session.defs[child.id]=parseRadialGradient(child);break;default:break}}}}function parseLinearGradient(child){let x0=parseSVGFloatAttribute(child,`x1`,0),y0=parseSVGFloatAttribute(child,`y1`,0),x1=parseSVGFloatAttribute(child,`x2`,1),y1=parseSVGFloatAttribute(child,`y2`,0),gradientUnit=child.getAttribute(`gradientUnits`)||`objectBoundingBox`,gradient=new FillGradient(x0,y0,x1,y1,gradientUnit===`objectBoundingBox`?`local`:`global`);for(let k$1=0;k$1<child.children.length;k$1++){let stop$2=child.children[k$1],offset=parseSVGFloatAttribute(stop$2,`offset`,0),color$2=Color.shared.setValue(stop$2.getAttribute(`stop-color`)).toNumber();gradient.addColorStop(offset,color$2)}return gradient}function parseRadialGradient(_child){return warn$1(`[SVG Parser] Radial gradients are not yet supported`),new FillGradient(0,0,1,0)}function extractSvgUrlId(url){let match=url.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return match?match[1]:``}var styleAttributes={fill:{type:`paint`,default:0},"fill-opacity":{type:`number`,default:1},stroke:{type:`paint`,default:0},"stroke-width":{type:`number`,default:1},"stroke-opacity":{type:`number`,default:1},"stroke-linecap":{type:`string`,default:`butt`},"stroke-linejoin":{type:`string`,default:`miter`},"stroke-miterlimit":{type:`number`,default:10},"stroke-dasharray":{type:`string`,default:`none`},"stroke-dashoffset":{type:`number`,default:0},opacity:{type:`number`,default:1}};function parseSVGStyle(svg,session){let style=svg.getAttribute(`style`),strokeStyle={},fillStyle={},result={strokeStyle,fillStyle,useFill:!1,useStroke:!1};for(let key$1 in styleAttributes){let attribute=svg.getAttribute(key$1);attribute&&parseAttribute(session,result,key$1,attribute.trim())}if(style){let styleParts=style.split(`;`);for(let i$1=0;i$1<styleParts.length;i$1++){let[key$1,value]=styleParts[i$1].trim().split(`:`);styleAttributes[key$1]&&parseAttribute(session,result,key$1,value.trim())}}return{strokeStyle:result.useStroke?strokeStyle:null,fillStyle:result.useFill?fillStyle:null,useFill:result.useFill,useStroke:result.useStroke}}function parseAttribute(session,result,id,value){switch(id){case`stroke`:if(value!==`none`){if(value.startsWith(`url(`)){let id2=extractSvgUrlId(value);result.strokeStyle.fill=session.defs[id2]}else result.strokeStyle.color=Color.shared.setValue(value).toNumber();result.useStroke=!0}break;case`stroke-width`:result.strokeStyle.width=Number(value);break;case`fill`:if(value!==`none`){if(value.startsWith(`url(`)){let id2=extractSvgUrlId(value);result.fillStyle.fill=session.defs[id2]}else result.fillStyle.color=Color.shared.setValue(value).toNumber();result.useFill=!0}break;case`fill-opacity`:result.fillStyle.alpha=Number(value);break;case`stroke-opacity`:result.strokeStyle.alpha=Number(value);break;case`opacity`:result.fillStyle.alpha=Number(value),result.strokeStyle.alpha=Number(value);break}}function checkForNestedPattern(subpathsWithArea){if(subpathsWithArea.length<=2)return!0;let areas=subpathsWithArea.map(s$1=>s$1.area).sort((a$1,b$1)=>b$1-a$1),[largestArea,secondArea]=areas,smallestArea=areas[areas.length-1],largestToSecondRatio=largestArea/secondArea,secondToSmallestRatio=secondArea/smallestArea;return!(largestToSecondRatio>3&&secondToSmallestRatio<2)}function extractSubpaths(pathData){return pathData.split(/(?=[Mm])/).filter(part=>part.trim().length>0)}function calculatePathArea(pathData){let coords=pathData.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!coords||coords.length<4)return 0;let numbers=coords.map(Number),xs=[],ys=[];for(let i$1=0;i$1<numbers.length;i$1+=2)i$1+1<numbers.length&&(xs.push(numbers[i$1]),ys.push(numbers[i$1+1]));if(xs.length===0||ys.length===0)return 0;let minX=Math.min(...xs),maxX=Math.max(...xs),minY=Math.min(...ys),maxY=Math.max(...ys);return(maxX-minX)*(maxY-minY)}function appendSVGPath(pathData,graphicsPath){let tempPath=new GraphicsPath(pathData,!1);for(let instruction of tempPath.instructions)graphicsPath.instructions.push(instruction)}function SVGParser(svg,graphicsContext){if(typeof svg==`string`){let div=document.createElement(`div`);div.innerHTML=svg.trim(),svg=div.querySelector(`svg`)}let session={context:graphicsContext,defs:{},path:new GraphicsPath};parseSVGDefinitions(svg,session);let children=svg.children,{fillStyle,strokeStyle}=parseSVGStyle(svg,session);for(let i$1=0;i$1<children.length;i$1++){let child=children[i$1];child.nodeName.toLowerCase()!==`defs`&&renderChildren(child,session,fillStyle,strokeStyle)}return graphicsContext}function renderChildren(svg,session,fillStyle,strokeStyle){let children=svg.children,{fillStyle:f1,strokeStyle:s1}=parseSVGStyle(svg,session);f1&&fillStyle?fillStyle={...fillStyle,...f1}:f1&&(fillStyle=f1),s1&&strokeStyle?strokeStyle={...strokeStyle,...s1}:s1&&(strokeStyle=s1);let noStyle=!fillStyle&&!strokeStyle;noStyle&&(fillStyle={color:0});let x$1,y$1,x1,y1,x2,y2,cx,cy,r$1,rx,ry,points$1,pointsString,d$1,graphicsPath,width,height;switch(svg.nodeName.toLowerCase()){case`path`:{d$1=svg.getAttribute(`d`);let fillRule=svg.getAttribute(`fill-rule`),subpaths=extractSubpaths(d$1),hasExplicitEvenodd=fillRule===`evenodd`,hasMultipleSubpaths=subpaths.length>1;if(hasExplicitEvenodd&&hasMultipleSubpaths){let subpathsWithArea=subpaths.map(subpath=>({path:subpath,area:calculatePathArea(subpath)}));if(subpathsWithArea.sort((a$1,b$1)=>b$1.area-a$1.area),subpaths.length>3||!checkForNestedPattern(subpathsWithArea))for(let i$1=0;i$1<subpathsWithArea.length;i$1++){let subpath=subpathsWithArea[i$1],isMainShape=i$1===0;session.context.beginPath();let newPath=new GraphicsPath(void 0,!0);appendSVGPath(subpath.path,newPath),session.context.path(newPath),isMainShape?(fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle)):session.context.cut()}else for(let i$1=0;i$1<subpathsWithArea.length;i$1++){let subpath=subpathsWithArea[i$1],isHole=i$1%2==1;session.context.beginPath();let newPath=new GraphicsPath(void 0,!0);appendSVGPath(subpath.path,newPath),session.context.path(newPath),isHole?session.context.cut():(fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle))}}else graphicsPath=new GraphicsPath(d$1,fillRule?fillRule===`evenodd`:!0),session.context.path(graphicsPath),fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle);break}case`circle`:cx=parseSVGFloatAttribute(svg,`cx`,0),cy=parseSVGFloatAttribute(svg,`cy`,0),r$1=parseSVGFloatAttribute(svg,`r`,0),session.context.ellipse(cx,cy,r$1,r$1),fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle);break;case`rect`:x$1=parseSVGFloatAttribute(svg,`x`,0),y$1=parseSVGFloatAttribute(svg,`y`,0),width=parseSVGFloatAttribute(svg,`width`,0),height=parseSVGFloatAttribute(svg,`height`,0),rx=parseSVGFloatAttribute(svg,`rx`,0),ry=parseSVGFloatAttribute(svg,`ry`,0),rx||ry?session.context.roundRect(x$1,y$1,width,height,rx||ry):session.context.rect(x$1,y$1,width,height),fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle);break;case`ellipse`:cx=parseSVGFloatAttribute(svg,`cx`,0),cy=parseSVGFloatAttribute(svg,`cy`,0),rx=parseSVGFloatAttribute(svg,`rx`,0),ry=parseSVGFloatAttribute(svg,`ry`,0),session.context.beginPath(),session.context.ellipse(cx,cy,rx,ry),fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle);break;case`line`:x1=parseSVGFloatAttribute(svg,`x1`,0),y1=parseSVGFloatAttribute(svg,`y1`,0),x2=parseSVGFloatAttribute(svg,`x2`,0),y2=parseSVGFloatAttribute(svg,`y2`,0),session.context.beginPath(),session.context.moveTo(x1,y1),session.context.lineTo(x2,y2),strokeStyle&&session.context.stroke(strokeStyle);break;case`polygon`:pointsString=svg.getAttribute(`points`),points$1=pointsString.match(/\d+/g).map(n$1=>parseInt(n$1,10)),session.context.poly(points$1,!0),fillStyle&&session.context.fill(fillStyle),strokeStyle&&session.context.stroke(strokeStyle);break;case`polyline`:pointsString=svg.getAttribute(`points`),points$1=pointsString.match(/\d+/g).map(n$1=>parseInt(n$1,10)),session.context.poly(points$1,!1),strokeStyle&&session.context.stroke(strokeStyle);break;case`g`:case`svg`:break;default:warn$1(`[SVG parser] <${svg.nodeName}> elements unsupported`);break}noStyle&&(fillStyle=null);for(let i$1=0;i$1<children.length;i$1++)renderChildren(children[i$1],session,fillStyle,strokeStyle)}function isColorLike(value){return Color.isColorLike(value)}function isFillPattern(value){return value instanceof FillPattern}function isFillGradient(value){return value instanceof FillGradient}function isTexture(value){return value instanceof Texture}function handleColorLike(fill,value,defaultStyle){let temp=Color.shared.setValue(value??0);return fill.color=temp.toNumber(),fill.alpha=temp.alpha===1?defaultStyle.alpha:temp.alpha,fill.texture=Texture.WHITE,{...defaultStyle,...fill}}function handleTexture(fill,value,defaultStyle){return fill.texture=value,{...defaultStyle,...fill}}function handleFillPattern(fill,value,defaultStyle){return fill.fill=value,fill.color=16777215,fill.texture=value.texture,fill.matrix=value.transform,{...defaultStyle,...fill}}function handleFillGradient(fill,value,defaultStyle){return value.buildGradient(),fill.fill=value,fill.color=16777215,fill.texture=value.texture,fill.matrix=value.transform,fill.textureSpace=value.textureSpace,{...defaultStyle,...fill}}function handleFillObject(value,defaultStyle){let style={...defaultStyle,...value},color$2=Color.shared.setValue(style.color);return style.alpha*=color$2.alpha,style.color=color$2.toNumber(),style}function toFillStyle(value,defaultStyle){if(value==null)return null;let fill={},objectStyle=value;return isColorLike(value)?handleColorLike(fill,value,defaultStyle):isTexture(value)?handleTexture(fill,value,defaultStyle):isFillPattern(value)?handleFillPattern(fill,value,defaultStyle):isFillGradient(value)?handleFillGradient(fill,value,defaultStyle):objectStyle.fill&&isFillPattern(objectStyle.fill)?handleFillPattern(objectStyle,objectStyle.fill,defaultStyle):objectStyle.fill&&isFillGradient(objectStyle.fill)?handleFillGradient(objectStyle,objectStyle.fill,defaultStyle):handleFillObject(objectStyle,defaultStyle)}function toStrokeStyle(value,defaultStyle){let{width,alignment,miterLimit,cap,join,pixelLine,...rest}=defaultStyle,fill=toFillStyle(value,rest);return fill?{width,alignment,miterLimit,cap,join,pixelLine,...fill}:null}var tmpPoint=new Point$1,tempMatrix$2=new Matrix,_GraphicsContext=class _GraphicsContext$1 extends eventemitter3_default{constructor(){super(...arguments),this.uid=uid$1(`graphicsContext`),this.dirty=!0,this.batchMode=`auto`,this.instructions=[],this._activePath=new GraphicsPath,this._transform=new Matrix,this._fillStyle={..._GraphicsContext$1.defaultFillStyle},this._strokeStyle={..._GraphicsContext$1.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Bounds,this._boundsDirty=!0}clone(){let clone$3=new _GraphicsContext$1;return clone$3.batchMode=this.batchMode,clone$3.instructions=this.instructions.slice(),clone$3._activePath=this._activePath.clone(),clone$3._transform=this._transform.clone(),clone$3._fillStyle={...this._fillStyle},clone$3._strokeStyle={...this._strokeStyle},clone$3._stateStack=this._stateStack.slice(),clone$3._bounds=this._bounds.clone(),clone$3._boundsDirty=!0,clone$3}get fillStyle(){return this._fillStyle}set fillStyle(value){this._fillStyle=toFillStyle(value,_GraphicsContext$1.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(value){this._strokeStyle=toStrokeStyle(value,_GraphicsContext$1.defaultStrokeStyle)}setFillStyle(style){return this._fillStyle=toFillStyle(style,_GraphicsContext$1.defaultFillStyle),this}setStrokeStyle(style){return this._strokeStyle=toFillStyle(style,_GraphicsContext$1.defaultStrokeStyle),this}texture(texture,tint,dx,dy,dw,dh){return this.instructions.push({action:`texture`,data:{image:texture,dx:dx||0,dy:dy||0,dw:dw||texture.frame.width,dh:dh||texture.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:tint?Color.shared.setValue(tint).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new GraphicsPath,this}fill(style,alpha){let path$1,lastInstruction=this.instructions[this.instructions.length-1];return path$1=this._tick===0&&lastInstruction&&lastInstruction.action===`stroke`?lastInstruction.data.path:this._activePath.clone(),path$1?(style!=null&&(alpha!==void 0&&typeof style==`number`&&(deprecation(v8_0_0,`GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead`),style={color:style,alpha}),this._fillStyle=toFillStyle(style,_GraphicsContext$1.defaultFillStyle)),this.instructions.push({action:`fill`,data:{style:this.fillStyle,path:path$1}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){let{x:x$1,y:y$1}=this._activePath.getLastPoint(Point$1.shared);this._activePath.clear(),this._activePath.moveTo(x$1,y$1)}stroke(style){let path$1,lastInstruction=this.instructions[this.instructions.length-1];return path$1=this._tick===0&&lastInstruction&&lastInstruction.action===`fill`?lastInstruction.data.path:this._activePath.clone(),path$1?(style!=null&&(this._strokeStyle=toStrokeStyle(style,_GraphicsContext$1.defaultStrokeStyle)),this.instructions.push({action:`stroke`,data:{style:this.strokeStyle,path:path$1}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let i$1=0;i$1<2;i$1++){let lastInstruction=this.instructions[this.instructions.length-1-i$1],holePath=this._activePath.clone();if(lastInstruction&&(lastInstruction.action===`stroke`||lastInstruction.action===`fill`))if(lastInstruction.data.hole)lastInstruction.data.hole.addPath(holePath);else{lastInstruction.data.hole=holePath;break}}return this._initNextPathLocation(),this}arc(x$1,y$1,radius,startAngle,endAngle,counterclockwise){this._tick++;let t$1=this._transform;return this._activePath.arc(t$1.a*x$1+t$1.c*y$1+t$1.tx,t$1.b*x$1+t$1.d*y$1+t$1.ty,radius,startAngle,endAngle,counterclockwise),this}arcTo(x1,y1,x2,y2,radius){this._tick++;let t$1=this._transform;return this._activePath.arcTo(t$1.a*x1+t$1.c*y1+t$1.tx,t$1.b*x1+t$1.d*y1+t$1.ty,t$1.a*x2+t$1.c*y2+t$1.tx,t$1.b*x2+t$1.d*y2+t$1.ty,radius),this}arcToSvg(rx,ry,xAxisRotation,largeArcFlag,sweepFlag,x$1,y$1){this._tick++;let t$1=this._transform;return this._activePath.arcToSvg(rx,ry,xAxisRotation,largeArcFlag,sweepFlag,t$1.a*x$1+t$1.c*y$1+t$1.tx,t$1.b*x$1+t$1.d*y$1+t$1.ty),this}bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x$1,y$1,smoothness){this._tick++;let t$1=this._transform;return this._activePath.bezierCurveTo(t$1.a*cp1x+t$1.c*cp1y+t$1.tx,t$1.b*cp1x+t$1.d*cp1y+t$1.ty,t$1.a*cp2x+t$1.c*cp2y+t$1.tx,t$1.b*cp2x+t$1.d*cp2y+t$1.ty,t$1.a*x$1+t$1.c*y$1+t$1.tx,t$1.b*x$1+t$1.d*y$1+t$1.ty,smoothness),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(x$1,y$1,radiusX,radiusY){return this._tick++,this._activePath.ellipse(x$1,y$1,radiusX,radiusY,this._transform.clone()),this}circle(x$1,y$1,radius){return this._tick++,this._activePath.circle(x$1,y$1,radius,this._transform.clone()),this}path(path$1){return this._tick++,this._activePath.addPath(path$1,this._transform.clone()),this}lineTo(x$1,y$1){this._tick++;let t$1=this._transform;return this._activePath.lineTo(t$1.a*x$1+t$1.c*y$1+t$1.tx,t$1.b*x$1+t$1.d*y$1+t$1.ty),this}moveTo(x$1,y$1){this._tick++;let t$1=this._transform,instructions=this._activePath.instructions,transformedX=t$1.a*x$1+t$1.c*y$1+t$1.tx,transformedY=t$1.b*x$1+t$1.d*y$1+t$1.ty;return instructions.length===1&&instructions[0].action===`moveTo`?(instructions[0].data[0]=transformedX,instructions[0].data[1]=transformedY,this):(this._activePath.moveTo(transformedX,transformedY),this)}quadraticCurveTo(cpx,cpy,x$1,y$1,smoothness){this._tick++;let t$1=this._transform;return this._activePath.quadraticCurveTo(t$1.a*cpx+t$1.c*cpy+t$1.tx,t$1.b*cpx+t$1.d*cpy+t$1.ty,t$1.a*x$1+t$1.c*y$1+t$1.tx,t$1.b*x$1+t$1.d*y$1+t$1.ty,smoothness),this}rect(x$1,y$1,w$1,h$2){return this._tick++,this._activePath.rect(x$1,y$1,w$1,h$2,this._transform.clone()),this}roundRect(x$1,y$1,w$1,h$2,radius){return this._tick++,this._activePath.roundRect(x$1,y$1,w$1,h$2,radius,this._transform.clone()),this}poly(points$1,close){return this._tick++,this._activePath.poly(points$1,close,this._transform.clone()),this}regularPoly(x$1,y$1,radius,sides,rotation=0,transform){return this._tick++,this._activePath.regularPoly(x$1,y$1,radius,sides,rotation,transform),this}roundPoly(x$1,y$1,radius,sides,corner,rotation){return this._tick++,this._activePath.roundPoly(x$1,y$1,radius,sides,corner,rotation),this}roundShape(points$1,radius,useQuadratic,smoothness){return this._tick++,this._activePath.roundShape(points$1,radius,useQuadratic,smoothness),this}filletRect(x$1,y$1,width,height,fillet){return this._tick++,this._activePath.filletRect(x$1,y$1,width,height,fillet),this}chamferRect(x$1,y$1,width,height,chamfer,transform){return this._tick++,this._activePath.chamferRect(x$1,y$1,width,height,chamfer,transform),this}star(x$1,y$1,points$1,radius,innerRadius=0,rotation=0){return this._tick++,this._activePath.star(x$1,y$1,points$1,radius,innerRadius,rotation,this._transform.clone()),this}svg(svg){return this._tick++,SVGParser(svg,this),this}restore(){let state=this._stateStack.pop();return state&&(this._transform=state.transform,this._fillStyle=state.fillStyle,this._strokeStyle=state.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(angle){return this._transform.rotate(angle),this}scale(x$1,y$1=x$1){return this._transform.scale(x$1,y$1),this}setTransform(a$1,b$1,c$2,d$1,dx,dy){return a$1 instanceof Matrix?(this._transform.set(a$1.a,a$1.b,a$1.c,a$1.d,a$1.tx,a$1.ty),this):(this._transform.set(a$1,b$1,c$2,d$1,dx,dy),this)}transform(a$1,b$1,c$2,d$1,dx,dy){return a$1 instanceof Matrix?(this._transform.append(a$1),this):(tempMatrix$2.set(a$1,b$1,c$2,d$1,dx,dy),this._transform.append(tempMatrix$2),this)}translate(x$1,y$1=x$1){return this._transform.translate(x$1,y$1),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit(`update`,this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;let bounds=this._bounds;bounds.clear();for(let i$1=0;i$1<this.instructions.length;i$1++){let instruction=this.instructions[i$1],action=instruction.action;if(action===`fill`){let data=instruction.data;bounds.addBounds(data.path.bounds)}else if(action===`texture`){let data=instruction.data;bounds.addFrame(data.dx,data.dy,data.dx+data.dw,data.dy+data.dh,data.transform)}if(action===`stroke`){let data=instruction.data,alignment=data.style.alignment,outerPadding=data.style.width*(1-alignment),_bounds=data.path.bounds;bounds.addFrame(_bounds.minX-outerPadding,_bounds.minY-outerPadding,_bounds.maxX+outerPadding,_bounds.maxY+outerPadding)}}return bounds}containsPoint(point){if(!this.bounds.containsPoint(point.x,point.y))return!1;let instructions=this.instructions,hasHit=!1;for(let k$1=0;k$1<instructions.length;k$1++){let instruction=instructions[k$1],data=instruction.data,path$1=data.path;if(!instruction.action||!path$1)continue;let style=data.style,shapes=path$1.shapePath.shapePrimitives;for(let i$1=0;i$1<shapes.length;i$1++){let shape=shapes[i$1].shape;if(!style||!shape)continue;let transform=shapes[i$1].transform,transformedPoint=transform?transform.applyInverse(point,tmpPoint):point;if(instruction.action===`fill`)hasHit=shape.contains(transformedPoint.x,transformedPoint.y);else{let strokeStyle=style;hasHit=shape.strokeContains(transformedPoint.x,transformedPoint.y,strokeStyle.width,strokeStyle.alignment)}let holes=data.hole;if(holes){let holeShapes=holes.shapePath?.shapePrimitives;if(holeShapes)for(let j$1=0;j$1<holeShapes.length;j$1++)holeShapes[j$1].shape.contains(transformedPoint.x,transformedPoint.y)&&(hasHit=!1)}if(hasHit)return!0}}return hasHit}destroy(options=!1){if(this._stateStack.length=0,this._transform=null,this.emit(`destroy`,this),this.removeAllListeners(),typeof options==`boolean`?options:options?.texture){let destroyTextureSource=typeof options==`boolean`?options:options?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&`uid`in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(destroyTextureSource)),this._strokeStyle.texture&&(this._strokeStyle.fill&&`uid`in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(destroyTextureSource))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};_GraphicsContext.defaultFillStyle={color:16777215,alpha:1,texture:Texture.WHITE,matrix:null,fill:null,textureSpace:`local`},_GraphicsContext.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:`butt`,join:`miter`,texture:Texture.WHITE,matrix:null,fill:null,textureSpace:`local`,pixelLine:!1};var GraphicsContext=_GraphicsContext,_TextStyle=class _TextStyle$1 extends eventemitter3_default{constructor(style={}){super(),this.uid=uid$1(`textStyle`),this._tick=0,convertV7Tov8Style(style);let fullStyle={..._TextStyle$1.defaultTextStyle,...style};for(let key$1 in fullStyle){let thisKey=key$1;this[thisKey]=fullStyle[key$1]}this.update(),this._tick=0}get align(){return this._align}set align(value){this._align!==value&&(this._align=value,this.update())}get breakWords(){return this._breakWords}set breakWords(value){this._breakWords!==value&&(this._breakWords=value,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(value){this._dropShadow!==value&&(typeof value==`object`&&value?this._dropShadow=this._createProxy({..._TextStyle$1.defaultDropShadow,...value}):this._dropShadow=value?this._createProxy({..._TextStyle$1.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(value){this._fontFamily!==value&&(this._fontFamily=value,this.update())}get fontSize(){return this._fontSize}set fontSize(value){this._fontSize!==value&&(typeof value==`string`?this._fontSize=parseInt(value,10):this._fontSize=value,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(value){this._fontStyle!==value&&(this._fontStyle=value.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(value){this._fontVariant!==value&&(this._fontVariant=value,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(value){this._fontWeight!==value&&(this._fontWeight=value,this.update())}get leading(){return this._leading}set leading(value){this._leading!==value&&(this._leading=value,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(value){this._letterSpacing!==value&&(this._letterSpacing=value,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(value){this._lineHeight!==value&&(this._lineHeight=value,this.update())}get padding(){return this._padding}set padding(value){this._padding!==value&&(this._padding=value,this.update())}get filters(){return this._filters}set filters(value){this._filters!==value&&(this._filters=Object.freeze(value),this.update())}get trim(){return this._trim}set trim(value){this._trim!==value&&(this._trim=value,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(value){this._textBaseline!==value&&(this._textBaseline=value,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(value){this._whiteSpace!==value&&(this._whiteSpace=value,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(value){this._wordWrap!==value&&(this._wordWrap=value,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(value){this._wordWrapWidth!==value&&(this._wordWrapWidth=value,this.update())}get fill(){return this._originalFill}set fill(value){value!==this._originalFill&&(this._originalFill=value,this._isFillStyle(value)&&(this._originalFill=this._createProxy({...GraphicsContext.defaultFillStyle,...value},()=>{this._fill=toFillStyle({...this._originalFill},GraphicsContext.defaultFillStyle)})),this._fill=toFillStyle(value===0?`black`:value,GraphicsContext.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(value){value!==this._originalStroke&&(this._originalStroke=value,this._isFillStyle(value)&&(this._originalStroke=this._createProxy({...GraphicsContext.defaultStrokeStyle,...value},()=>{this._stroke=toStrokeStyle({...this._originalStroke},GraphicsContext.defaultStrokeStyle)})),this._stroke=toStrokeStyle(value,GraphicsContext.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit(`update`,this)}reset(){let defaultStyle=_TextStyle$1.defaultTextStyle;for(let key$1 in defaultStyle)this[key$1]=defaultStyle[key$1]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new _TextStyle$1({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let filterPadding=0;if(this._filters)for(let i$1=0;i$1<this._filters.length;i$1++)filterPadding+=this._filters[i$1].padding;return Math.max(this._padding,filterPadding)}destroy(options=!1){if(this.removeAllListeners(),typeof options==`boolean`?options:options?.texture){let destroyTextureSource=typeof options==`boolean`?options:options?.textureSource;this._fill?.texture&&this._fill.texture.destroy(destroyTextureSource),this._originalFill?.texture&&this._originalFill.texture.destroy(destroyTextureSource),this._stroke?.texture&&this._stroke.texture.destroy(destroyTextureSource),this._originalStroke?.texture&&this._originalStroke.texture.destroy(destroyTextureSource)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(value,cb){return new Proxy(value,{set:(target,property,newValue)=>target[property]===newValue?!0:(target[property]=newValue,cb?.(property,newValue),this.update(),!0)})}_isFillStyle(value){return(value??null)!==null&&!(Color.isColorLike(value)||value instanceof FillGradient||value instanceof FillPattern)}};_TextStyle.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:`black`,distance:5},_TextStyle.defaultTextStyle={align:`left`,breakWords:!1,dropShadow:null,fill:`black`,fontFamily:`Arial`,fontSize:26,fontStyle:`normal`,fontVariant:`normal`,fontWeight:`normal`,leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:`alphabetic`,trim:!1,whiteSpace:`pre`,wordWrap:!1,wordWrapWidth:100};var TextStyle=_TextStyle;function convertV7Tov8Style(style){let oldStyle=style;if(typeof oldStyle.dropShadow==`boolean`&&oldStyle.dropShadow){let defaults$1=TextStyle.defaultDropShadow;style.dropShadow={alpha:oldStyle.dropShadowAlpha??defaults$1.alpha,angle:oldStyle.dropShadowAngle??defaults$1.angle,blur:oldStyle.dropShadowBlur??defaults$1.blur,color:oldStyle.dropShadowColor??defaults$1.color,distance:oldStyle.dropShadowDistance??defaults$1.distance}}if(oldStyle.strokeThickness!==void 0){deprecation(v8_0_0,`strokeThickness is now a part of stroke`);let color$2=oldStyle.stroke,obj={};if(Color.isColorLike(color$2))obj.color=color$2;else if(color$2 instanceof FillGradient||color$2 instanceof FillPattern)obj.fill=color$2;else if(Object.hasOwnProperty.call(color$2,`color`)||Object.hasOwnProperty.call(color$2,`fill`))obj=color$2;else throw Error(`Invalid stroke value.`);style.stroke={...obj,width:oldStyle.strokeThickness}}if(Array.isArray(oldStyle.fillGradientStops)){if(deprecation(v8_0_0,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(oldStyle.fill)||oldStyle.fill.length===0)throw Error(`Invalid fill value. Expected an array of colors for gradient fill.`);oldStyle.fill.length!==oldStyle.fillGradientStops.length&&warn$1(`The number of fill colors must match the number of fill gradient stops.`);let gradientFill=new FillGradient({start:{x:0,y:0},end:{x:0,y:1},textureSpace:`local`}),fillGradientStops=oldStyle.fillGradientStops.slice(),fills=oldStyle.fill.map(color$2=>Color.shared.setValue(color$2).toNumber());fillGradientStops.forEach((stop$2,index)=>{gradientFill.addColorStop(stop$2,fills[index])}),style.fill={fill:gradientFill}}}var CanvasPool=new class{constructor(canvasOptions){this._canvasPool=Object.create(null),this.canvasOptions=canvasOptions||{},this.enableFullScreen=!1}_createCanvasAndContext(pixelWidth,pixelHeight){let canvas=DOMAdapter.get().createCanvas();canvas.width=pixelWidth,canvas.height=pixelHeight;let context$1=canvas.getContext(`2d`);return{canvas,context:context$1}}getOptimalCanvasAndContext(minWidth,minHeight,resolution=1){minWidth=Math.ceil(minWidth*resolution-1e-6),minHeight=Math.ceil(minHeight*resolution-1e-6),minWidth=nextPow2(minWidth),minHeight=nextPow2(minHeight);let key$1=(minWidth<<17)+(minHeight<<1);this._canvasPool[key$1]||(this._canvasPool[key$1]=[]);let canvasAndContext=this._canvasPool[key$1].pop();return canvasAndContext||=this._createCanvasAndContext(minWidth,minHeight),canvasAndContext}returnCanvasAndContext(canvasAndContext){let{width,height}=canvasAndContext.canvas,key$1=(width<<17)+(height<<1);canvasAndContext.context.resetTransform(),canvasAndContext.context.clearRect(0,0,width,height),this._canvasPool[key$1].push(canvasAndContext)}clear(){this._canvasPool={}}};GlobalResourceRegistry.register(CanvasPool);var PRECISION=1e5;function getCanvasFillStyle(fillStyle,context$1,textMetrics,padding=0){if(fillStyle.texture===Texture.WHITE&&!fillStyle.fill)return Color.shared.setValue(fillStyle.color).setAlpha(fillStyle.alpha??1).toHexa();if(fillStyle.fill){if(fillStyle.fill instanceof FillPattern){let fillPattern=fillStyle.fill,pattern=context$1.createPattern(fillPattern.texture.source.resource,`repeat`),tempMatrix$6=fillPattern.transform.copyTo(Matrix.shared);return tempMatrix$6.scale(fillPattern.texture.frame.width,fillPattern.texture.frame.height),pattern.setTransform(tempMatrix$6),pattern}else if(fillStyle.fill instanceof FillGradient){let fillGradient=fillStyle.fill,isLinear=fillGradient.type===`linear`,isLocal=fillGradient.textureSpace===`local`,width=1,height=1;isLocal&&textMetrics&&(width=textMetrics.width+padding,height=textMetrics.height+padding);let gradient,isNearlyVertical=!1;if(isLinear){let{start:start$1,end:end$1}=fillGradient;gradient=context$1.createLinearGradient(start$1.x*width,start$1.y*height,end$1.x*width,end$1.y*height),isNearlyVertical=Math.abs(end$1.x-start$1.x)<Math.abs((end$1.y-start$1.y)*.1)}else{let{center:center$1,innerRadius,outerCenter,outerRadius}=fillGradient;gradient=context$1.createRadialGradient(center$1.x*width,center$1.y*height,innerRadius*width,outerCenter.x*width,outerCenter.y*height,outerRadius*width)}if(isNearlyVertical&&isLocal&&textMetrics){let ratio=textMetrics.lineHeight/height;for(let i$1=0;i$1<textMetrics.lines.length;i$1++){let start$1=(i$1*textMetrics.lineHeight+padding/2)/height;fillGradient.colorStops.forEach(stop$2=>{let globalStop=start$1+stop$2.offset*ratio;gradient.addColorStop(Math.floor(globalStop*PRECISION)/PRECISION,Color.shared.setValue(stop$2.color).toHex())})}}else fillGradient.colorStops.forEach(stop$2=>{gradient.addColorStop(stop$2.offset,Color.shared.setValue(stop$2.color).toHex())});return gradient}}else{let pattern=context$1.createPattern(fillStyle.texture.source.resource,`repeat`),tempMatrix$6=fillStyle.matrix.copyTo(Matrix.shared);return tempMatrix$6.scale(fillStyle.texture.frame.width,fillStyle.texture.frame.height),pattern.setTransform(tempMatrix$6),pattern}return warn$1(`FillStyle not recognised`,fillStyle),`red`}var _DynamicBitmapFont=class _DynamicBitmapFont$1 extends AbstractBitmapFont{constructor(options){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;let dynamicOptions={..._DynamicBitmapFont$1.defaultOptions,...options};this._textureSize=dynamicOptions.textureSize,this._mipmap=dynamicOptions.mipmap;let style=dynamicOptions.style.clone();dynamicOptions.overrideFill&&(style._fill.color=16777215,style._fill.alpha=1,style._fill.texture=Texture.WHITE,style._fill.fill=null),this.applyFillAsTint=dynamicOptions.overrideFill;let requestedFontSize=style.fontSize;style.fontSize=this.baseMeasurementFontSize;let font=fontStringFromTextStyle(style);dynamicOptions.overrideSize?style._stroke&&(style._stroke.width*=this.baseRenderedFontSize/requestedFontSize):style.fontSize=this.baseRenderedFontSize=requestedFontSize,this._style=style,this._skipKerning=dynamicOptions.skipKerning??!1,this.resolution=dynamicOptions.resolution??1,this._padding=dynamicOptions.padding??4,dynamicOptions.textureStyle&&(this._textureStyle=dynamicOptions.textureStyle instanceof TextureStyle?dynamicOptions.textureStyle:new TextureStyle(dynamicOptions.textureStyle)),this.fontMetrics=CanvasTextMetrics.measureFont(font),this.lineHeight=style.lineHeight||this.fontMetrics.fontSize||style.fontSize}ensureCharacters(chars){let charList=CanvasTextMetrics.graphemeSegmenter(chars).filter(char=>!this._currentChars.includes(char)).filter((char,index,self$1)=>self$1.indexOf(char)===index);if(!charList.length)return;this._currentChars=[...this._currentChars,...charList];let pageData;pageData=this._currentPageIndex===-1?this._nextPage():this.pages[this._currentPageIndex];let{canvas,context:context$1}=pageData.canvasAndContext,textureSource=pageData.texture.source,style=this._style,currentX=this._currentX,currentY=this._currentY,currentMaxCharHeight=this._currentMaxCharHeight,fontScale=this.baseRenderedFontSize/this.baseMeasurementFontSize,padding=this._padding*fontScale,skipTexture=!1,maxTextureWidth=canvas.width/this.resolution,maxTextureHeight=canvas.height/this.resolution;for(let i$1=0;i$1<charList.length;i$1++){let char=charList[i$1],metrics=CanvasTextMetrics.measureText(char,style,canvas,!1);metrics.lineHeight=metrics.height;let width=metrics.width*fontScale,textureGlyphWidth=Math.ceil((style.fontStyle===`italic`?2:1)*width),height=metrics.height*fontScale,paddedWidth=textureGlyphWidth+padding*2,paddedHeight=height+padding*2;if(skipTexture=!1,char!==`
`&&char!==`\r`&&char!==`	`&&char!==` `&&(skipTexture=!0,currentMaxCharHeight=Math.ceil(Math.max(paddedHeight,currentMaxCharHeight))),currentX+paddedWidth>maxTextureWidth&&(currentY+=currentMaxCharHeight,currentMaxCharHeight=paddedHeight,currentX=0,currentY+currentMaxCharHeight>maxTextureHeight)){textureSource.update();let pageData2=this._nextPage();canvas=pageData2.canvasAndContext.canvas,context$1=pageData2.canvasAndContext.context,textureSource=pageData2.texture.source,currentX=0,currentY=0,currentMaxCharHeight=0}let xAdvance=width/fontScale-(style.dropShadow?.distance??0)-(style._stroke?.width??0);if(this.chars[char]={id:char.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance,kerning:{}},skipTexture){this._drawGlyph(context$1,metrics,currentX+padding,currentY+padding,fontScale,style);let px=textureSource.width*fontScale,py=textureSource.height*fontScale,frame=new Rectangle(currentX/px*textureSource.width,currentY/py*textureSource.height,paddedWidth/px*textureSource.width,paddedHeight/py*textureSource.height);this.chars[char].texture=new Texture({source:textureSource,frame}),currentX+=Math.ceil(paddedWidth)}}textureSource.update(),this._currentX=currentX,this._currentY=currentY,this._currentMaxCharHeight=currentMaxCharHeight,this._skipKerning&&this._applyKerning(charList,context$1)}get pageTextures(){return deprecation(v8_0_0,`BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.`),this.pages}_applyKerning(newChars,context$1){let measureCache=this._measureCache;for(let i$1=0;i$1<newChars.length;i$1++){let first=newChars[i$1];for(let j$1=0;j$1<this._currentChars.length;j$1++){let second=this._currentChars[j$1],c1=measureCache[first];c1||=measureCache[first]=context$1.measureText(first).width;let c2=measureCache[second];c2||=measureCache[second]=context$1.measureText(second).width;let total=context$1.measureText(first+second).width,amount=total-(c1+c2);amount&&(this.chars[first].kerning[second]=amount),total=context$1.measureText(first+second).width,amount=total-(c1+c2),amount&&(this.chars[second].kerning[first]=amount)}}}_nextPage(){this._currentPageIndex++;let textureResolution=this.resolution,canvasAndContext=CanvasPool.getOptimalCanvasAndContext(this._textureSize,this._textureSize,textureResolution);this._setupContext(canvasAndContext.context,this._style,textureResolution);let resolution=textureResolution*(this.baseRenderedFontSize/this.baseMeasurementFontSize),texture=new Texture({source:new ImageSource({resource:canvasAndContext.canvas,resolution,alphaMode:`premultiply-alpha-on-upload`,autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(texture.source.style=this._textureStyle);let pageData={canvasAndContext,texture};return this.pages[this._currentPageIndex]=pageData,pageData}_setupContext(context$1,style,resolution){style.fontSize=this.baseRenderedFontSize,context$1.scale(resolution,resolution),context$1.font=fontStringFromTextStyle(style),style.fontSize=this.baseMeasurementFontSize,context$1.textBaseline=style.textBaseline;let stroke=style._stroke,strokeThickness=stroke?.width??0;if(stroke&&(context$1.lineWidth=strokeThickness,context$1.lineJoin=stroke.join,context$1.miterLimit=stroke.miterLimit,context$1.strokeStyle=getCanvasFillStyle(stroke,context$1)),style._fill&&(context$1.fillStyle=getCanvasFillStyle(style._fill,context$1)),style.dropShadow){let shadowOptions=style.dropShadow,rgb=Color.shared.setValue(shadowOptions.color).toArray(),dropShadowBlur=shadowOptions.blur*resolution,dropShadowDistance=shadowOptions.distance*resolution;context$1.shadowColor=`rgba(${rgb[0]*255},${rgb[1]*255},${rgb[2]*255},${shadowOptions.alpha})`,context$1.shadowBlur=dropShadowBlur,context$1.shadowOffsetX=Math.cos(shadowOptions.angle)*dropShadowDistance,context$1.shadowOffsetY=Math.sin(shadowOptions.angle)*dropShadowDistance}else context$1.shadowColor=`black`,context$1.shadowBlur=0,context$1.shadowOffsetX=0,context$1.shadowOffsetY=0}_drawGlyph(context$1,metrics,x$1,y$1,fontScale,style){let char=metrics.text,fontProperties=metrics.fontProperties,strokeThickness=(style._stroke?.width??0)*fontScale,tx=x$1+strokeThickness/2,ty=y$1-strokeThickness/2,descent=fontProperties.descent*fontScale,lineHeight=metrics.lineHeight*fontScale,removeShadow=!1;style.stroke&&strokeThickness&&(removeShadow=!0,context$1.strokeText(char,tx,ty+lineHeight-descent));let{shadowBlur,shadowOffsetX,shadowOffsetY}=context$1;style._fill&&(removeShadow&&(context$1.shadowBlur=0,context$1.shadowOffsetX=0,context$1.shadowOffsetY=0),context$1.fillText(char,tx,ty+lineHeight-descent)),removeShadow&&(context$1.shadowBlur=shadowBlur,context$1.shadowOffsetX=shadowOffsetX,context$1.shadowOffsetY=shadowOffsetY)}destroy(){super.destroy();for(let i$1=0;i$1<this.pages.length;i$1++){let{canvasAndContext,texture}=this.pages[i$1];CanvasPool.returnCanvasAndContext(canvasAndContext),texture.destroy(!0)}this.pages=null}};_DynamicBitmapFont.defaultOptions={textureSize:512,style:new TextStyle,mipmap:!0};var DynamicBitmapFont=_DynamicBitmapFont;function getBitmapTextLayout(chars,style,font,trimEnd){let layoutData={width:0,height:0,offsetY:0,scale:style.fontSize/font.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};layoutData.offsetY=font.baseLineOffset;let currentLine=layoutData.lines[0],previousChar=null,firstWord=!0,currentWord={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},scale$3=font.baseMeasurementFontSize/style.fontSize,adjustedLetterSpacing=style.letterSpacing*scale$3,adjustedWordWrapWidth=style.wordWrapWidth*scale$3,adjustedLineHeight=style.lineHeight?style.lineHeight*scale$3:font.lineHeight,breakWords=style.wordWrap&&style.breakWords,nextWord=word=>{let start$1=currentLine.width;for(let j$1=0;j$1<currentWord.index;j$1++){let position=word.positions[j$1];currentLine.chars.push(word.chars[j$1]),currentLine.charPositions.push(position+start$1)}currentLine.width+=word.width,firstWord=!1,currentWord.width=0,currentWord.index=0,currentWord.chars.length=0},nextLine=()=>{let index=currentLine.chars.length-1;if(trimEnd){let lastChar=currentLine.chars[index];for(;lastChar===` `;)currentLine.width-=font.chars[lastChar].xAdvance,lastChar=currentLine.chars[--index]}layoutData.width=Math.max(layoutData.width,currentLine.width),currentLine={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},firstWord=!0,layoutData.lines.push(currentLine),layoutData.height+=adjustedLineHeight},checkIsOverflow=lineWidth=>lineWidth-adjustedLetterSpacing>adjustedWordWrapWidth;for(let i$1=0;i$1<chars.length+1;i$1++){let char,isEnd=i$1===chars.length;isEnd||(char=chars[i$1]);let charData=font.chars[char]||font.chars[` `];if(/(?:\s)/.test(char)||char===`\r`||char===`
`||isEnd){if(!firstWord&&style.wordWrap&&checkIsOverflow(currentLine.width+currentWord.width)?(nextLine(),nextWord(currentWord),isEnd||currentLine.charPositions.push(0)):(currentWord.start=currentLine.width,nextWord(currentWord),isEnd||currentLine.charPositions.push(0)),char===`\r`||char===`
`)nextLine();else if(!isEnd){let spaceWidth=charData.xAdvance+(charData.kerning[previousChar]||0)+adjustedLetterSpacing;currentLine.width+=spaceWidth,currentLine.spaceWidth=spaceWidth,currentLine.spacesIndex.push(currentLine.charPositions.length),currentLine.chars.push(char)}}else{let kerning=charData.kerning[previousChar]||0,nextCharWidth=charData.xAdvance+kerning+adjustedLetterSpacing;breakWords&&checkIsOverflow(currentLine.width+currentWord.width+nextCharWidth)&&(nextWord(currentWord),nextLine()),currentWord.positions[currentWord.index++]=currentWord.width+kerning,currentWord.chars.push(char),currentWord.width+=nextCharWidth}previousChar=char}return nextLine(),style.align===`center`?alignCenter(layoutData):style.align===`right`?alignRight(layoutData):style.align===`justify`&&alignJustify(layoutData),layoutData}function alignCenter(measurementData){for(let i$1=0;i$1<measurementData.lines.length;i$1++){let line=measurementData.lines[i$1],offset=measurementData.width/2-line.width/2;for(let j$1=0;j$1<line.charPositions.length;j$1++)line.charPositions[j$1]+=offset}}function alignRight(measurementData){for(let i$1=0;i$1<measurementData.lines.length;i$1++){let line=measurementData.lines[i$1],offset=measurementData.width-line.width;for(let j$1=0;j$1<line.charPositions.length;j$1++)line.charPositions[j$1]+=offset}}function alignJustify(measurementData){let width=measurementData.width;for(let i$1=0;i$1<measurementData.lines.length;i$1++){let line=measurementData.lines[i$1],indy=0,spaceIndex=line.spacesIndex[indy++],offset=0,totalSpaces=line.spacesIndex.length,spaceWidth=(width-line.width)/totalSpaces;for(let j$1=0;j$1<line.charPositions.length;j$1++)j$1===spaceIndex&&(spaceIndex=line.spacesIndex[indy++],offset+=spaceWidth),line.charPositions[j$1]+=offset}}function resolveCharacters(chars){if(chars===``)return[];typeof chars==`string`&&(chars=[chars]);let result=[];for(let i$1=0,j$1=chars.length;i$1<j$1;i$1++){let item=chars[i$1];if(Array.isArray(item)){if(item.length!==2)throw Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${item.length}.`);if(item[0].length===0||item[1].length===0)throw Error(`[BitmapFont]: Invalid character delimiter.`);let startCode=item[0].charCodeAt(0),endCode=item[1].charCodeAt(0);if(endCode<startCode)throw Error(`[BitmapFont]: Invalid character range.`);for(let i2=startCode,j2=endCode;i2<=j2;i2++)result.push(String.fromCharCode(i2))}else result.push(...Array.from(item))}if(result.length===0)throw Error(`[BitmapFont]: Empty set when resolving characters.`);return result}var fontCount=0,BitmapFontManager=new class{constructor(){this.ALPHA=[[`a`,`z`],[`A`,`Z`],` `],this.NUMERIC=[[`0`,`9`]],this.ALPHANUMERIC=[[`a`,`z`],[`A`,`Z`],[`0`,`9`],` `],this.ASCII=[[` `,`~`]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=lru(1e3)}getFont(text,style){let fontFamilyKey=`${style.fontFamily}-bitmap`,overrideFill=!0;if(style._fill.fill&&!style._stroke?(fontFamilyKey+=style._fill.fill.styleKey,overrideFill=!1):(style._stroke||style.dropShadow)&&(fontFamilyKey=`${style.styleKey}-bitmap`,overrideFill=!1),!Cache.has(fontFamilyKey)){let styleCopy=Object.create(style);styleCopy.lineHeight=0;let fnt=new DynamicBitmapFont({style:styleCopy,overrideFill,overrideSize:!0,...this.defaultOptions});fontCount++,fontCount>50&&warn$1(`BitmapText`,`You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),fnt.once(`destroy`,()=>{fontCount--,Cache.remove(fontFamilyKey)}),Cache.set(fontFamilyKey,fnt)}let dynamicFont=Cache.get(fontFamilyKey);return dynamicFont.ensureCharacters?.(text),dynamicFont}getLayout(text,style,trimEnd=!0){let bitmapFont=this.getFont(text,style),id=`${text}-${style.styleKey}-${trimEnd}`;if(this.measureCache.has(id))return this.measureCache.get(id);let segments=CanvasTextMetrics.graphemeSegmenter(text),layoutData=getBitmapTextLayout(segments,style,bitmapFont,trimEnd);return this.measureCache.set(id,layoutData),layoutData}measureText(text,style,trimEnd=!0){return this.getLayout(text,style,trimEnd)}install(...args){let options=args[0];typeof options==`string`&&(options={name:options,style:args[1],chars:args[2]?.chars,resolution:args[2]?.resolution,padding:args[2]?.padding,skipKerning:args[2]?.skipKerning},deprecation(v8_0_0,`BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})`));let name=options?.name;if(!name)throw Error("[BitmapFontManager] Property `name` is required.");options={...this.defaultOptions,...options};let textStyle=options.style,style=textStyle instanceof TextStyle?textStyle:new TextStyle(textStyle),overrideFill=options.dynamicFill??this._canUseTintForStyle(style),font=new DynamicBitmapFont({style,overrideFill,skipKerning:options.skipKerning,padding:options.padding,resolution:options.resolution,overrideSize:!1,textureStyle:options.textureStyle}),flatChars=resolveCharacters(options.chars);return font.ensureCharacters(flatChars.join(``)),Cache.set(`${name}-bitmap`,font),font.once(`destroy`,()=>Cache.remove(`${name}-bitmap`)),font}uninstall(name){let cacheKey=`${name}-bitmap`,font=Cache.get(cacheKey);font&&font.destroy()}_canUseTintForStyle(style){return!style._stroke&&(!style.dropShadow||style.dropShadow.color===0)&&!style._fill.fill&&style._fill.color===16777215}},DOMPipe=class{constructor(renderer$1){this._attachedDomElements=[],this._renderer=renderer$1,this._renderer.runners.postrender.add(this),this._renderer.runners.init.add(this),this._domElement=document.createElement(`div`),this._domElement.style.position=`absolute`,this._domElement.style.top=`0`,this._domElement.style.left=`0`,this._domElement.style.pointerEvents=`none`,this._domElement.style.zIndex=`1000`}init(){this._canvasObserver=new CanvasObserver({domElement:this._domElement,renderer:this._renderer})}addRenderable(domContainer,_instructionSet){this._attachedDomElements.includes(domContainer)||this._attachedDomElements.push(domContainer)}updateRenderable(_domContainer){}validateRenderable(_domContainer){return!0}postrender(){let attachedDomElements=this._attachedDomElements;if(attachedDomElements.length===0){this._domElement.remove();return}this._canvasObserver.ensureAttached();for(let i$1=0;i$1<attachedDomElements.length;i$1++){let domContainer=attachedDomElements[i$1],element=domContainer.element;if(!domContainer.parent||domContainer.globalDisplayStatus<7)element?.remove(),attachedDomElements.splice(i$1,1),i$1--;else{this._domElement.contains(element)||(element.style.position=`absolute`,element.style.pointerEvents=`auto`,this._domElement.appendChild(element));let wt=domContainer.worldTransform,anchor=domContainer._anchor,ax=domContainer.width*anchor.x,ay=domContainer.height*anchor.y;element.style.transformOrigin=`${ax}px ${ay}px`,element.style.transform=`matrix(${wt.a}, ${wt.b}, ${wt.c}, ${wt.d}, ${wt.tx-ax}, ${wt.ty-ay})`,element.style.opacity=domContainer.groupAlpha.toString()}}}destroy(){this._renderer.runners.postrender.remove(this);for(let i$1=0;i$1<this._attachedDomElements.length;i$1++)this._attachedDomElements[i$1].element?.remove();this._attachedDomElements.length=0,this._domElement.remove(),this._canvasObserver.destroy(),this._renderer=null}};DOMPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`dom`};var EventsTicker=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(events){this.removeTickerListener(),this.events=events,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(paused){this._pauseUpdate=paused}addTickerListener(){this._tickerAdded||!this.domElement||(Ticker.system.add(this._tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&=(Ticker.system.remove(this._tickerUpdate,this),!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let rootPointerEvent=this.events._rootPointerEvent;this.events.supportsTouchEvents&&rootPointerEvent.pointerType===`touch`||globalThis.document.dispatchEvent(this.events.supportsPointerEvents?new PointerEvent(`pointermove`,{clientX:rootPointerEvent.clientX,clientY:rootPointerEvent.clientY,pointerType:rootPointerEvent.pointerType,pointerId:rootPointerEvent.pointerId}):new MouseEvent(`mousemove`,{clientX:rootPointerEvent.clientX,clientY:rootPointerEvent.clientY}))}_tickerUpdate(ticker){this._deltaTime+=ticker.deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this._update())}destroy(){this.removeTickerListener(),this.events=null,this.domElement=null,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}},FederatedMouseEvent=class extends FederatedEvent{constructor(){super(...arguments),this.client=new Point$1,this.movement=new Point$1,this.offset=new Point$1,this.global=new Point$1,this.screen=new Point$1}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(container,point,globalPos){return container.worldTransform.applyInverse(globalPos||this.global,point)}getModifierState(key$1){return`getModifierState`in this.nativeEvent&&this.nativeEvent.getModifierState(key$1)}initMouseEvent(_typeArg,_canBubbleArg,_cancelableArg,_viewArg,_detailArg,_screenXArg,_screenYArg,_clientXArg,_clientYArg,_ctrlKeyArg,_altKeyArg,_shiftKeyArg,_metaKeyArg,_buttonArg,_relatedTargetArg){throw Error(`Method not implemented.`)}},FederatedPointerEvent=class extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type===`pointermove`||this.type===`mousemove`||this.type===`touchmove`?[this]:[]}getPredictedEvents(){throw Error(`getPredictedEvents is not supported!`)}},FederatedWheelEvent=class extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;var PROPAGATION_LIMIT=2048,tempHitLocation=new Point$1,tempLocalMapping=new Point$1,EventBoundary=class{constructor(rootTarget){this.dispatch=new eventemitter3_default,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=rootTarget,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping(`pointerdown`,this.mapPointerDown),this.addEventMapping(`pointermove`,this.mapPointerMove),this.addEventMapping(`pointerout`,this.mapPointerOut),this.addEventMapping(`pointerleave`,this.mapPointerOut),this.addEventMapping(`pointerover`,this.mapPointerOver),this.addEventMapping(`pointerup`,this.mapPointerUp),this.addEventMapping(`pointerupoutside`,this.mapPointerUpOutside),this.addEventMapping(`wheel`,this.mapWheel)}addEventMapping(type,fn){this.mappingTable[type]||(this.mappingTable[type]=[]),this.mappingTable[type].push({fn,priority:0}),this.mappingTable[type].sort((a$1,b$1)=>a$1.priority-b$1.priority)}dispatchEvent(e$2,type){e$2.propagationStopped=!1,e$2.propagationImmediatelyStopped=!1,this.propagate(e$2,type),this.dispatch.emit(type||e$2.type,e$2)}mapEvent(e$2){if(!this.rootTarget)return;let mappers=this.mappingTable[e$2.type];if(mappers)for(let i$1=0,j$1=mappers.length;i$1<j$1;i$1++)mappers[i$1].fn(e$2);else warn$1(`[EventBoundary]: Event mapping not defined for ${e$2.type}`)}hitTest(x$1,y$1){EventsTicker.pauseUpdate=!0;let fn=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?`hitTestMoveRecursive`:`hitTestRecursive`,invertedPath=this[fn](this.rootTarget,this.rootTarget.eventMode,tempHitLocation.set(x$1,y$1),this.hitTestFn,this.hitPruneFn);return invertedPath&&invertedPath[0]}propagate(e$2,type){if(!e$2.target)return;let composedPath=e$2.composedPath();e$2.eventPhase=e$2.CAPTURING_PHASE;for(let i$1=0,j$1=composedPath.length-1;i$1<j$1;i$1++)if(e$2.currentTarget=composedPath[i$1],this.notifyTarget(e$2,type),e$2.propagationStopped||e$2.propagationImmediatelyStopped)return;if(e$2.eventPhase=e$2.AT_TARGET,e$2.currentTarget=e$2.target,this.notifyTarget(e$2,type),!(e$2.propagationStopped||e$2.propagationImmediatelyStopped)){e$2.eventPhase=e$2.BUBBLING_PHASE;for(let i$1=composedPath.length-2;i$1>=0;i$1--)if(e$2.currentTarget=composedPath[i$1],this.notifyTarget(e$2,type),e$2.propagationStopped||e$2.propagationImmediatelyStopped)return}}all(e$2,type,targets=this._allInteractiveElements){if(targets.length===0)return;e$2.eventPhase=e$2.BUBBLING_PHASE;let events=Array.isArray(type)?type:[type];for(let i$1=targets.length-1;i$1>=0;i$1--)events.forEach(event=>{e$2.currentTarget=targets[i$1],this.notifyTarget(e$2,event)})}propagationPath(target){let propagationPath=[target];for(let i$1=0;i$1<PROPAGATION_LIMIT&&target!==this.rootTarget&&target.parent;i$1++){if(!target.parent)throw Error(`Cannot find propagation path to disconnected target`);propagationPath.push(target.parent),target=target.parent}return propagationPath.reverse(),propagationPath}hitTestMoveRecursive(currentTarget,eventMode,location$1,testFn,pruneFn,ignore=!1){let shouldReturn=!1;if(this._interactivePrune(currentTarget))return null;if((currentTarget.eventMode===`dynamic`||eventMode===`dynamic`)&&(EventsTicker.pauseUpdate=!1),currentTarget.interactiveChildren&&currentTarget.children){let children=currentTarget.children;for(let i$1=children.length-1;i$1>=0;i$1--){let child=children[i$1],nestedHit=this.hitTestMoveRecursive(child,this._isInteractive(eventMode)?eventMode:child.eventMode,location$1,testFn,pruneFn,ignore||pruneFn(currentTarget,location$1));if(nestedHit){if(nestedHit.length>0&&!nestedHit[nestedHit.length-1].parent)continue;let isInteractive=currentTarget.isInteractive();(nestedHit.length>0||isInteractive)&&(isInteractive&&this._allInteractiveElements.push(currentTarget),nestedHit.push(currentTarget)),this._hitElements.length===0&&(this._hitElements=nestedHit),shouldReturn=!0}}}let isInteractiveMode=this._isInteractive(eventMode),isInteractiveTarget=currentTarget.isInteractive();return isInteractiveTarget&&isInteractiveTarget&&this._allInteractiveElements.push(currentTarget),ignore||this._hitElements.length>0?null:shouldReturn?this._hitElements:isInteractiveMode&&!pruneFn(currentTarget,location$1)&&testFn(currentTarget,location$1)?isInteractiveTarget?[currentTarget]:[]:null}hitTestRecursive(currentTarget,eventMode,location$1,testFn,pruneFn){if(this._interactivePrune(currentTarget)||pruneFn(currentTarget,location$1))return null;if((currentTarget.eventMode===`dynamic`||eventMode===`dynamic`)&&(EventsTicker.pauseUpdate=!1),currentTarget.interactiveChildren&&currentTarget.children){let children=currentTarget.children,relativeLocation=location$1;for(let i$1=children.length-1;i$1>=0;i$1--){let child=children[i$1],nestedHit=this.hitTestRecursive(child,this._isInteractive(eventMode)?eventMode:child.eventMode,relativeLocation,testFn,pruneFn);if(nestedHit){if(nestedHit.length>0&&!nestedHit[nestedHit.length-1].parent)continue;let isInteractive=currentTarget.isInteractive();return(nestedHit.length>0||isInteractive)&&nestedHit.push(currentTarget),nestedHit}}}let isInteractiveMode=this._isInteractive(eventMode),isInteractiveTarget=currentTarget.isInteractive();return isInteractiveMode&&testFn(currentTarget,location$1)?isInteractiveTarget?[currentTarget]:[]:null}_isInteractive(int){return int===`static`||int===`dynamic`}_interactivePrune(container){return!container||!container.visible||!container.renderable||!container.measurable||container.eventMode===`none`||container.eventMode===`passive`&&!container.interactiveChildren}hitPruneFn(container,location$1){if(container.hitArea&&(container.worldTransform.applyInverse(location$1,tempLocalMapping),!container.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(container.effects&&container.effects.length)for(let i$1=0;i$1<container.effects.length;i$1++){let effect$1=container.effects[i$1];if(effect$1.containsPoint&&!effect$1.containsPoint(location$1,this.hitTestFn))return!0}return!1}hitTestFn(container,location$1){return container.hitArea?!0:container?.containsPoint?(container.worldTransform.applyInverse(location$1,tempLocalMapping),container.containsPoint(tempLocalMapping)):!1}notifyTarget(e$2,type){if(!e$2.currentTarget.isInteractive())return;type??=e$2.type;let handlerKey=`on${type}`;e$2.currentTarget[handlerKey]?.(e$2);let key$1=e$2.eventPhase===e$2.CAPTURING_PHASE||e$2.eventPhase===e$2.AT_TARGET?`${type}capture`:type;this._notifyListeners(e$2,key$1),e$2.eventPhase===e$2.AT_TARGET&&this._notifyListeners(e$2,type)}mapPointerDown(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}let e$2=this.createPointerEvent(from);if(this.dispatchEvent(e$2,`pointerdown`),e$2.pointerType===`touch`)this.dispatchEvent(e$2,`touchstart`);else if(e$2.pointerType===`mouse`||e$2.pointerType===`pen`){let isRightButton=e$2.button===2;this.dispatchEvent(e$2,isRightButton?`rightdown`:`mousedown`)}let trackingData=this.trackingData(from.pointerId);trackingData.pressTargetsByButton[from.button]=e$2.composedPath(),this.freeEvent(e$2)}mapPointerMove(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let e$2=this.createPointerEvent(from);this._isPointerMoveEvent=!1;let isMouse=e$2.pointerType===`mouse`||e$2.pointerType===`pen`,trackingData=this.trackingData(from.pointerId),outTarget=this.findMountedTarget(trackingData.overTargets);if(trackingData.overTargets?.length>0&&outTarget!==e$2.target){let outType=from.type===`mousemove`?`mouseout`:`pointerout`,outEvent=this.createPointerEvent(from,outType,outTarget);if(this.dispatchEvent(outEvent,`pointerout`),isMouse&&this.dispatchEvent(outEvent,`mouseout`),!e$2.composedPath().includes(outTarget)){let leaveEvent=this.createPointerEvent(from,`pointerleave`,outTarget);for(leaveEvent.eventPhase=leaveEvent.AT_TARGET;leaveEvent.target&&!e$2.composedPath().includes(leaveEvent.target);)leaveEvent.currentTarget=leaveEvent.target,this.notifyTarget(leaveEvent),isMouse&&this.notifyTarget(leaveEvent,`mouseleave`),leaveEvent.target=leaveEvent.target.parent;this.freeEvent(leaveEvent)}this.freeEvent(outEvent)}if(outTarget!==e$2.target){let overType=from.type===`mousemove`?`mouseover`:`pointerover`,overEvent=this.clonePointerEvent(e$2,overType);this.dispatchEvent(overEvent,`pointerover`),isMouse&&this.dispatchEvent(overEvent,`mouseover`);let overTargetAncestor=outTarget?.parent;for(;overTargetAncestor&&overTargetAncestor!==this.rootTarget.parent&&overTargetAncestor!==e$2.target;)overTargetAncestor=overTargetAncestor.parent;if(!overTargetAncestor||overTargetAncestor===this.rootTarget.parent){let enterEvent=this.clonePointerEvent(e$2,`pointerenter`);for(enterEvent.eventPhase=enterEvent.AT_TARGET;enterEvent.target&&enterEvent.target!==outTarget&&enterEvent.target!==this.rootTarget.parent;)enterEvent.currentTarget=enterEvent.target,this.notifyTarget(enterEvent),isMouse&&this.notifyTarget(enterEvent,`mouseenter`),enterEvent.target=enterEvent.target.parent;this.freeEvent(enterEvent)}this.freeEvent(overEvent)}let allMethods=[],allowGlobalPointerEvents=this.enableGlobalMoveEvents??!0;this.moveOnAll?allMethods.push(`pointermove`):this.dispatchEvent(e$2,`pointermove`),allowGlobalPointerEvents&&allMethods.push(`globalpointermove`),e$2.pointerType===`touch`&&(this.moveOnAll?allMethods.splice(1,0,`touchmove`):this.dispatchEvent(e$2,`touchmove`),allowGlobalPointerEvents&&allMethods.push(`globaltouchmove`)),isMouse&&(this.moveOnAll?allMethods.splice(1,0,`mousemove`):this.dispatchEvent(e$2,`mousemove`),allowGlobalPointerEvents&&allMethods.push(`globalmousemove`),this.cursor=e$2.target?.cursor),allMethods.length>0&&this.all(e$2,allMethods),this._allInteractiveElements.length=0,this._hitElements.length=0,trackingData.overTargets=e$2.composedPath(),this.freeEvent(e$2)}mapPointerOver(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}let trackingData=this.trackingData(from.pointerId),e$2=this.createPointerEvent(from),isMouse=e$2.pointerType===`mouse`||e$2.pointerType===`pen`;this.dispatchEvent(e$2,`pointerover`),isMouse&&this.dispatchEvent(e$2,`mouseover`),e$2.pointerType===`mouse`&&(this.cursor=e$2.target?.cursor);let enterEvent=this.clonePointerEvent(e$2,`pointerenter`);for(enterEvent.eventPhase=enterEvent.AT_TARGET;enterEvent.target&&enterEvent.target!==this.rootTarget.parent;)enterEvent.currentTarget=enterEvent.target,this.notifyTarget(enterEvent),isMouse&&this.notifyTarget(enterEvent,`mouseenter`),enterEvent.target=enterEvent.target.parent;trackingData.overTargets=e$2.composedPath(),this.freeEvent(e$2),this.freeEvent(enterEvent)}mapPointerOut(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}let trackingData=this.trackingData(from.pointerId);if(trackingData.overTargets){let isMouse=from.pointerType===`mouse`||from.pointerType===`pen`,outTarget=this.findMountedTarget(trackingData.overTargets),outEvent=this.createPointerEvent(from,`pointerout`,outTarget);this.dispatchEvent(outEvent),isMouse&&this.dispatchEvent(outEvent,`mouseout`);let leaveEvent=this.createPointerEvent(from,`pointerleave`,outTarget);for(leaveEvent.eventPhase=leaveEvent.AT_TARGET;leaveEvent.target&&leaveEvent.target!==this.rootTarget.parent;)leaveEvent.currentTarget=leaveEvent.target,this.notifyTarget(leaveEvent),isMouse&&this.notifyTarget(leaveEvent,`mouseleave`),leaveEvent.target=leaveEvent.target.parent;trackingData.overTargets=null,this.freeEvent(outEvent),this.freeEvent(leaveEvent)}this.cursor=null}mapPointerUp(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}let now=performance.now(),e$2=this.createPointerEvent(from);if(this.dispatchEvent(e$2,`pointerup`),e$2.pointerType===`touch`)this.dispatchEvent(e$2,`touchend`);else if(e$2.pointerType===`mouse`||e$2.pointerType===`pen`){let isRightButton=e$2.button===2;this.dispatchEvent(e$2,isRightButton?`rightup`:`mouseup`)}let trackingData=this.trackingData(from.pointerId),pressTarget=this.findMountedTarget(trackingData.pressTargetsByButton[from.button]),clickTarget=pressTarget;if(pressTarget&&!e$2.composedPath().includes(pressTarget)){let currentTarget=pressTarget;for(;currentTarget&&!e$2.composedPath().includes(currentTarget);){if(e$2.currentTarget=currentTarget,this.notifyTarget(e$2,`pointerupoutside`),e$2.pointerType===`touch`)this.notifyTarget(e$2,`touchendoutside`);else if(e$2.pointerType===`mouse`||e$2.pointerType===`pen`){let isRightButton=e$2.button===2;this.notifyTarget(e$2,isRightButton?`rightupoutside`:`mouseupoutside`)}currentTarget=currentTarget.parent}delete trackingData.pressTargetsByButton[from.button],clickTarget=currentTarget}if(clickTarget){let clickEvent=this.clonePointerEvent(e$2,`click`);clickEvent.target=clickTarget,clickEvent.path=null,trackingData.clicksByButton[from.button]||(trackingData.clicksByButton[from.button]={clickCount:0,target:clickEvent.target,timeStamp:now});let clickHistory=trackingData.clicksByButton[from.button];if(clickHistory.target===clickEvent.target&&now-clickHistory.timeStamp<200?++clickHistory.clickCount:clickHistory.clickCount=1,clickHistory.target=clickEvent.target,clickHistory.timeStamp=now,clickEvent.detail=clickHistory.clickCount,clickEvent.pointerType===`mouse`){let isRightButton=clickEvent.button===2;this.dispatchEvent(clickEvent,isRightButton?`rightclick`:`click`)}else clickEvent.pointerType===`touch`&&this.dispatchEvent(clickEvent,`tap`);this.dispatchEvent(clickEvent,`pointertap`),this.freeEvent(clickEvent)}this.freeEvent(e$2)}mapPointerUpOutside(from){if(!(from instanceof FederatedPointerEvent)){warn$1(`EventBoundary cannot map a non-pointer event as a pointer event`);return}let trackingData=this.trackingData(from.pointerId),pressTarget=this.findMountedTarget(trackingData.pressTargetsByButton[from.button]),e$2=this.createPointerEvent(from);if(pressTarget){let currentTarget=pressTarget;for(;currentTarget;)e$2.currentTarget=currentTarget,this.notifyTarget(e$2,`pointerupoutside`),e$2.pointerType===`touch`?this.notifyTarget(e$2,`touchendoutside`):(e$2.pointerType===`mouse`||e$2.pointerType===`pen`)&&this.notifyTarget(e$2,e$2.button===2?`rightupoutside`:`mouseupoutside`),currentTarget=currentTarget.parent;delete trackingData.pressTargetsByButton[from.button]}this.freeEvent(e$2)}mapWheel(from){if(!(from instanceof FederatedWheelEvent)){warn$1(`EventBoundary cannot map a non-wheel event as a wheel event`);return}let wheelEvent=this.createWheelEvent(from);this.dispatchEvent(wheelEvent),this.freeEvent(wheelEvent)}findMountedTarget(propagationPath){if(!propagationPath)return null;let currentTarget=propagationPath[0];for(let i$1=1;i$1<propagationPath.length&&propagationPath[i$1].parent===currentTarget;i$1++)currentTarget=propagationPath[i$1];return currentTarget}createPointerEvent(from,type,target){let event=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(from,event),this.copyMouseData(from,event),this.copyData(from,event),event.nativeEvent=from.nativeEvent,event.originalEvent=from,event.target=target??this.hitTest(event.global.x,event.global.y)??this._hitElements[0],typeof type==`string`&&(event.type=type),event}createWheelEvent(from){let event=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(from,event),this.copyMouseData(from,event),this.copyData(from,event),event.nativeEvent=from.nativeEvent,event.originalEvent=from,event.target=this.hitTest(event.global.x,event.global.y),event}clonePointerEvent(from,type){let event=this.allocateEvent(FederatedPointerEvent);return event.nativeEvent=from.nativeEvent,event.originalEvent=from.originalEvent,this.copyPointerData(from,event),this.copyMouseData(from,event),this.copyData(from,event),event.target=from.target,event.path=from.composedPath().slice(),event.type=type??event.type,event}copyWheelData(from,to){to.deltaMode=from.deltaMode,to.deltaX=from.deltaX,to.deltaY=from.deltaY,to.deltaZ=from.deltaZ}copyPointerData(from,to){from instanceof FederatedPointerEvent&&to instanceof FederatedPointerEvent&&(to.pointerId=from.pointerId,to.width=from.width,to.height=from.height,to.isPrimary=from.isPrimary,to.pointerType=from.pointerType,to.pressure=from.pressure,to.tangentialPressure=from.tangentialPressure,to.tiltX=from.tiltX,to.tiltY=from.tiltY,to.twist=from.twist)}copyMouseData(from,to){from instanceof FederatedMouseEvent&&to instanceof FederatedMouseEvent&&(to.altKey=from.altKey,to.button=from.button,to.buttons=from.buttons,to.client.copyFrom(from.client),to.ctrlKey=from.ctrlKey,to.metaKey=from.metaKey,to.movement.copyFrom(from.movement),to.screen.copyFrom(from.screen),to.shiftKey=from.shiftKey,to.global.copyFrom(from.global))}copyData(from,to){to.isTrusted=from.isTrusted,to.srcElement=from.srcElement,to.timeStamp=performance.now(),to.type=from.type,to.detail=from.detail,to.view=from.view,to.which=from.which,to.layer.copyFrom(from.layer),to.page.copyFrom(from.page)}trackingData(id){return this.mappingState.trackingData[id]||(this.mappingState.trackingData[id]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[id]}allocateEvent(constructor){this.eventPool.has(constructor)||this.eventPool.set(constructor,[]);let event=this.eventPool.get(constructor).pop()||new constructor(this);return event.eventPhase=event.NONE,event.currentTarget=null,event.defaultPrevented=!1,event.path=null,event.target=null,event}freeEvent(event){if(event.manager!==this)throw Error(`It is illegal to free an event not managed by this EventBoundary!`);let constructor=event.constructor;this.eventPool.has(constructor)||this.eventPool.set(constructor,[]),this.eventPool.get(constructor).push(event)}_notifyListeners(e$2,type){let listeners=e$2.currentTarget._events[type];if(listeners)if(`fn`in listeners)listeners.once&&e$2.currentTarget.removeListener(type,listeners.fn,void 0,!0),listeners.fn.call(listeners.context,e$2);else for(let i$1=0,j$1=listeners.length;i$1<j$1&&!e$2.propagationImmediatelyStopped;i$1++)listeners[i$1].once&&e$2.currentTarget.removeListener(type,listeners[i$1].fn,void 0,!0),listeners[i$1].fn.call(listeners[i$1].context,e$2)}},MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:`pointerdown`,touchend:`pointerup`,touchendoutside:`pointerupoutside`,touchmove:`pointermove`,touchcancel:`pointercancel`},_EventSystem=class _EventSystem$1{constructor(renderer$1){this.supportsTouchEvents=`ontouchstart`in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=renderer$1,this.rootBoundary=new EventBoundary(null),EventsTicker.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new FederatedPointerEvent(null),this._rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:`inherit`,pointer:`pointer`},this.features=new Proxy({..._EventSystem$1.defaultEventFeatures},{set:(target,key$1,value)=>(key$1===`globalMove`&&(this.rootBoundary.enableGlobalMoveEvents=value),target[key$1]=value,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(options){let{canvas,resolution}=this.renderer;this.setTargetElement(canvas),this.resolution=resolution,_EventSystem$1._defaultEventMode=options.eventMode??`passive`,Object.assign(this.features,options.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(resolution){this.resolution=resolution}destroy(){EventsTicker.destroy(),this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(mode){mode||=`default`;let applyStyles=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(applyStyles=!1),this._currentCursor===mode)return;this._currentCursor=mode;let style=this.cursorStyles[mode];if(style)switch(typeof style){case`string`:applyStyles&&(this.domElement.style.cursor=style);break;case`function`:style(mode);break;case`object`:applyStyles&&Object.assign(this.domElement.style,style);break}else applyStyles&&typeof mode==`string`&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,mode)&&(this.domElement.style.cursor=mode)}get pointer(){return this._rootPointerEvent}_onPointerDown(nativeEvent){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let events=this._normalizeToPointerData(nativeEvent);this.autoPreventDefault&&events[0].isNormalized&&(nativeEvent.cancelable||!(`cancelable`in nativeEvent))&&nativeEvent.preventDefault();for(let i$1=0,j$1=events.length;i$1<j$1;i$1++){let nativeEvent2=events[i$1],federatedEvent=this._bootstrapEvent(this._rootPointerEvent,nativeEvent2);this.rootBoundary.mapEvent(federatedEvent)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(nativeEvent){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,EventsTicker.pointerMoved();let normalizedEvents=this._normalizeToPointerData(nativeEvent);for(let i$1=0,j$1=normalizedEvents.length;i$1<j$1;i$1++){let event=this._bootstrapEvent(this._rootPointerEvent,normalizedEvents[i$1]);this.rootBoundary.mapEvent(event)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(nativeEvent){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let target=nativeEvent.target;nativeEvent.composedPath&&nativeEvent.composedPath().length>0&&(target=nativeEvent.composedPath()[0]);let outside=target===this.domElement?``:`outside`,normalizedEvents=this._normalizeToPointerData(nativeEvent);for(let i$1=0,j$1=normalizedEvents.length;i$1<j$1;i$1++){let event=this._bootstrapEvent(this._rootPointerEvent,normalizedEvents[i$1]);event.type+=outside,this.rootBoundary.mapEvent(event)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(nativeEvent){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let normalizedEvents=this._normalizeToPointerData(nativeEvent);for(let i$1=0,j$1=normalizedEvents.length;i$1<j$1;i$1++){let event=this._bootstrapEvent(this._rootPointerEvent,normalizedEvents[i$1]);this.rootBoundary.mapEvent(event)}this.setCursor(this.rootBoundary.cursor)}onWheel(nativeEvent){if(!this.features.wheel)return;let wheelEvent=this.normalizeWheelEvent(nativeEvent);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(wheelEvent)}setTargetElement(element){this._removeEvents(),this.domElement=element,EventsTicker.domElement=element,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;EventsTicker.addTickerListener();let style=this.domElement.style;style&&(globalThis.navigator.msPointerEnabled?(style.msContentZooming=`none`,style.msTouchAction=`none`):this.supportsPointerEvents&&(style.touchAction=`none`)),this.supportsPointerEvents?(globalThis.document.addEventListener(`pointermove`,this._onPointerMove,!0),this.domElement.addEventListener(`pointerdown`,this._onPointerDown,!0),this.domElement.addEventListener(`pointerleave`,this._onPointerOverOut,!0),this.domElement.addEventListener(`pointerover`,this._onPointerOverOut,!0),globalThis.addEventListener(`pointerup`,this._onPointerUp,!0)):(globalThis.document.addEventListener(`mousemove`,this._onPointerMove,!0),this.domElement.addEventListener(`mousedown`,this._onPointerDown,!0),this.domElement.addEventListener(`mouseout`,this._onPointerOverOut,!0),this.domElement.addEventListener(`mouseover`,this._onPointerOverOut,!0),globalThis.addEventListener(`mouseup`,this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener(`touchstart`,this._onPointerDown,!0),this.domElement.addEventListener(`touchend`,this._onPointerUp,!0),this.domElement.addEventListener(`touchmove`,this._onPointerMove,!0))),this.domElement.addEventListener(`wheel`,this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;EventsTicker.removeTickerListener();let style=this.domElement.style;style&&(globalThis.navigator.msPointerEnabled?(style.msContentZooming=``,style.msTouchAction=``):this.supportsPointerEvents&&(style.touchAction=``)),this.supportsPointerEvents?(globalThis.document.removeEventListener(`pointermove`,this._onPointerMove,!0),this.domElement.removeEventListener(`pointerdown`,this._onPointerDown,!0),this.domElement.removeEventListener(`pointerleave`,this._onPointerOverOut,!0),this.domElement.removeEventListener(`pointerover`,this._onPointerOverOut,!0),globalThis.removeEventListener(`pointerup`,this._onPointerUp,!0)):(globalThis.document.removeEventListener(`mousemove`,this._onPointerMove,!0),this.domElement.removeEventListener(`mousedown`,this._onPointerDown,!0),this.domElement.removeEventListener(`mouseout`,this._onPointerOverOut,!0),this.domElement.removeEventListener(`mouseover`,this._onPointerOverOut,!0),globalThis.removeEventListener(`mouseup`,this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener(`touchstart`,this._onPointerDown,!0),this.domElement.removeEventListener(`touchend`,this._onPointerUp,!0),this.domElement.removeEventListener(`touchmove`,this._onPointerMove,!0))),this.domElement.removeEventListener(`wheel`,this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(point,x$1,y$1){let rect=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},resolutionMultiplier=1/this.resolution;point.x=(x$1-rect.left)*(this.domElement.width/rect.width)*resolutionMultiplier,point.y=(y$1-rect.top)*(this.domElement.height/rect.height)*resolutionMultiplier}_normalizeToPointerData(event){let normalizedEvents=[];if(this.supportsTouchEvents&&event instanceof TouchEvent)for(let i$1=0,li=event.changedTouches.length;i$1<li;i$1++){let touch=event.changedTouches[i$1];touch.button===void 0&&(touch.button=0),touch.buttons===void 0&&(touch.buttons=1),touch.isPrimary===void 0&&(touch.isPrimary=event.touches.length===1&&event.type===`touchstart`),touch.width===void 0&&(touch.width=touch.radiusX||1),touch.height===void 0&&(touch.height=touch.radiusY||1),touch.tiltX===void 0&&(touch.tiltX=0),touch.tiltY===void 0&&(touch.tiltY=0),touch.pointerType===void 0&&(touch.pointerType=`touch`),touch.pointerId===void 0&&(touch.pointerId=touch.identifier||0),touch.pressure===void 0&&(touch.pressure=touch.force||.5),touch.twist===void 0&&(touch.twist=0),touch.tangentialPressure===void 0&&(touch.tangentialPressure=0),touch.layerX===void 0&&(touch.layerX=touch.offsetX=touch.clientX),touch.layerY===void 0&&(touch.layerY=touch.offsetY=touch.clientY),touch.isNormalized=!0,touch.type=event.type,normalizedEvents.push(touch)}else if(!globalThis.MouseEvent||event instanceof MouseEvent&&(!this.supportsPointerEvents||!(event instanceof globalThis.PointerEvent))){let tempEvent=event;tempEvent.isPrimary===void 0&&(tempEvent.isPrimary=!0),tempEvent.width===void 0&&(tempEvent.width=1),tempEvent.height===void 0&&(tempEvent.height=1),tempEvent.tiltX===void 0&&(tempEvent.tiltX=0),tempEvent.tiltY===void 0&&(tempEvent.tiltY=0),tempEvent.pointerType===void 0&&(tempEvent.pointerType=`mouse`),tempEvent.pointerId===void 0&&(tempEvent.pointerId=MOUSE_POINTER_ID),tempEvent.pressure===void 0&&(tempEvent.pressure=.5),tempEvent.twist===void 0&&(tempEvent.twist=0),tempEvent.tangentialPressure===void 0&&(tempEvent.tangentialPressure=0),tempEvent.isNormalized=!0,normalizedEvents.push(tempEvent)}else normalizedEvents.push(event);return normalizedEvents}normalizeWheelEvent(nativeEvent){let event=this._rootWheelEvent;return this._transferMouseData(event,nativeEvent),event.deltaX=nativeEvent.deltaX,event.deltaY=nativeEvent.deltaY,event.deltaZ=nativeEvent.deltaZ,event.deltaMode=nativeEvent.deltaMode,this.mapPositionToPoint(event.screen,nativeEvent.clientX,nativeEvent.clientY),event.global.copyFrom(event.screen),event.offset.copyFrom(event.screen),event.nativeEvent=nativeEvent,event.type=nativeEvent.type,event}_bootstrapEvent(event,nativeEvent){return event.originalEvent=null,event.nativeEvent=nativeEvent,event.pointerId=nativeEvent.pointerId,event.width=nativeEvent.width,event.height=nativeEvent.height,event.isPrimary=nativeEvent.isPrimary,event.pointerType=nativeEvent.pointerType,event.pressure=nativeEvent.pressure,event.tangentialPressure=nativeEvent.tangentialPressure,event.tiltX=nativeEvent.tiltX,event.tiltY=nativeEvent.tiltY,event.twist=nativeEvent.twist,this._transferMouseData(event,nativeEvent),this.mapPositionToPoint(event.screen,nativeEvent.clientX,nativeEvent.clientY),event.global.copyFrom(event.screen),event.offset.copyFrom(event.screen),event.isTrusted=nativeEvent.isTrusted,event.type===`pointerleave`&&(event.type=`pointerout`),event.type.startsWith(`mouse`)&&(event.type=event.type.replace(`mouse`,`pointer`)),event.type.startsWith(`touch`)&&(event.type=TOUCH_TO_POINTER[event.type]||event.type),event}_transferMouseData(event,nativeEvent){event.isTrusted=nativeEvent.isTrusted,event.srcElement=nativeEvent.srcElement,event.timeStamp=performance.now(),event.type=nativeEvent.type,event.altKey=nativeEvent.altKey,event.button=nativeEvent.button,event.buttons=nativeEvent.buttons,event.client.x=nativeEvent.clientX,event.client.y=nativeEvent.clientY,event.ctrlKey=nativeEvent.ctrlKey,event.metaKey=nativeEvent.metaKey,event.movement.x=nativeEvent.movementX,event.movement.y=nativeEvent.movementY,event.page.x=nativeEvent.pageX,event.page.y=nativeEvent.pageY,event.relatedTarget=null,event.shiftKey=nativeEvent.shiftKey}};_EventSystem.extension={name:`events`,type:[ExtensionType.WebGLSystem,ExtensionType.CanvasSystem,ExtensionType.WebGPUSystem],priority:-1},_EventSystem.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var EventSystem=_EventSystem,FederatedContainer={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode===`dynamic`||this.eventMode===`static`},set interactive(value){this.eventMode=value?`static`:`passive`},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??EventSystem.defaultEventMode},set eventMode(value){this._internalEventMode=value},isInteractive(){return this.eventMode===`static`||this.eventMode===`dynamic`},interactiveChildren:!0,hitArea:null,addEventListener(type,listener,options){let capture=typeof options==`boolean`&&options||typeof options==`object`&&options.capture,signal=typeof options==`object`?options.signal:void 0,once=typeof options==`object`?options.once===!0:!1,context$1=typeof listener==`function`?void 0:listener;type=capture?`${type}capture`:type;let listenerFn=typeof listener==`function`?listener:listener.handleEvent,emitter=this;signal&&signal.addEventListener(`abort`,()=>{emitter.off(type,listenerFn,context$1)}),once?emitter.once(type,listenerFn,context$1):emitter.on(type,listenerFn,context$1)},removeEventListener(type,listener,options){let capture=typeof options==`boolean`&&options||typeof options==`object`&&options.capture,context$1=typeof listener==`function`?void 0:listener;type=capture?`${type}capture`:type,listener=typeof listener==`function`?listener:listener.handleEvent,this.off(type,listener,context$1)},dispatchEvent(e$2){if(!(e$2 instanceof FederatedEvent))throw Error(`Container cannot propagate events outside of the Federated Events API`);return e$2.defaultPrevented=!1,e$2.path=null,e$2.target=this,e$2.manager.dispatchEvent(e$2),!e$2.defaultPrevented}},vertex$2=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,fragment$2=`in vec2 vTextureCoord;
out vec4 finalColor;
uniform sampler2D uTexture;
void main() {
    finalColor = texture(uTexture, vTextureCoord);
}
`,source$1=`struct GlobalFilterUniforms {
  uInputSize: vec4<f32>,
  uInputPixel: vec4<f32>,
  uInputClamp: vec4<f32>,
  uOutputFrame: vec4<f32>,
  uGlobalFrame: vec4<f32>,
  uOutputTexture: vec4<f32>,
};

@group(0) @binding(0) var <uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler: sampler;

struct VSOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) uv: vec2<f32>
};

fn filterVertexPosition(aPosition: vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0 * gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord(aPosition: vec2<f32>) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

@vertex
fn mainVertex(
  @location(0) aPosition: vec2<f32>,
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
) -> @location(0) vec4<f32> {
    return textureSample(uTexture, uSampler, uv);
}
`,PassthroughFilter=class extends Filter{constructor(){let gpuProgram$2=GpuProgram.from({vertex:{source:source$1,entryPoint:`mainVertex`},fragment:{source:source$1,entryPoint:`mainFragment`},name:`passthrough-filter`}),glProgram$2=GlProgram.from({vertex:vertex$2,fragment:fragment$2,name:`passthrough-filter`});super({gpuProgram:gpuProgram$2,glProgram:glProgram$2})}},FilterPipe=class{constructor(renderer$1){this._renderer=renderer$1}push(filterEffect,container,instructionSet){this._renderer.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`filter`,canBundle:!1,action:`pushFilter`,container,filterEffect})}pop(_filterEffect,_container,instructionSet){this._renderer.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`filter`,action:`popFilter`,canBundle:!1})}execute(instruction){instruction.action===`pushFilter`?this._renderer.filter.push(instruction):instruction.action===`popFilter`&&this._renderer.filter.pop()}destroy(){this._renderer=null}};FilterPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`filter`};function pointInTriangle(px,py,x1,y1,x2,y2,x3,y3){let v2x=x3-x1,v2y=y3-y1,v1x=x2-x1,v1y=y2-y1,v0x=px-x1,v0y=py-y1,dot00=v2x*v2x+v2y*v2y,dot01=v2x*v1x+v2y*v1y,dot02=v2x*v0x+v2y*v0y,dot11=v1x*v1x+v1y*v1y,dot12=v1x*v0x+v1y*v0y,invDenom=1/(dot00*dot11-dot01*dot01),u$1=(dot11*dot02-dot01*dot12)*invDenom,v$1=(dot00*dot12-dot01*dot02)*invDenom;return u$1>=0&&v$1>=0&&u$1+v$1<1}var tempProjectionMatrix=new Matrix;function getGlobalRenderableBounds(renderables,bounds){bounds.clear();let actualMatrix=bounds.matrix;for(let i$1=0;i$1<renderables.length;i$1++){let renderable=renderables[i$1];if(renderable.globalDisplayStatus<7)continue;let renderGroup=renderable.renderGroup??renderable.parentRenderGroup;renderGroup?.isCachedAsTexture?bounds.matrix=tempProjectionMatrix.copyFrom(renderGroup.textureOffsetInverseTransform).append(renderable.worldTransform):renderGroup?._parentCacheAsTextureRenderGroup?bounds.matrix=tempProjectionMatrix.copyFrom(renderGroup._parentCacheAsTextureRenderGroup.inverseWorldTransform).append(renderable.groupTransform):bounds.matrix=renderable.worldTransform,bounds.addBounds(renderable.bounds)}return bounds.matrix=actualMatrix,bounds}var quadGeometry=new Geometry({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:`float32x2`,stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])}),FilterData=class{constructor(){this.skip=!1,this.inputTexture=null,this.backTexture=null,this.filters=null,this.bounds=new Bounds,this.container=null,this.blendRequired=!1,this.outputRenderSurface=null,this.globalFrame={x:0,y:0,width:0,height:0},this.firstEnabledIndex=-1,this.lastEnabledIndex=-1}},FilterSystem=class{constructor(renderer$1){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new UniformGroup({uInputSize:{value:new Float32Array(4),type:`vec4<f32>`},uInputPixel:{value:new Float32Array(4),type:`vec4<f32>`},uInputClamp:{value:new Float32Array(4),type:`vec4<f32>`},uOutputFrame:{value:new Float32Array(4),type:`vec4<f32>`},uGlobalFrame:{value:new Float32Array(4),type:`vec4<f32>`},uOutputTexture:{value:new Float32Array(4),type:`vec4<f32>`}}),this._globalFilterBindGroup=new BindGroup({}),this.renderer=renderer$1}get activeBackTexture(){return this._activeFilterData?.backTexture}push(instruction){let renderer$1=this.renderer,filters=instruction.filterEffect.filters,filterData=this._pushFilterData();filterData.skip=!1,filterData.filters=filters,filterData.container=instruction.container,filterData.outputRenderSurface=renderer$1.renderTarget.renderSurface;let colorTextureSource=renderer$1.renderTarget.renderTarget.colorTexture.source,rootResolution=colorTextureSource.resolution,rootAntialias=colorTextureSource.antialias;if(filters.every(filter$1=>!filter$1.enabled)){filterData.skip=!0;return}let bounds=filterData.bounds;if(this._calculateFilterArea(instruction,bounds),this._calculateFilterBounds(filterData,renderer$1.renderTarget.rootViewPort,rootAntialias,rootResolution,1),filterData.skip)return;let previousFilterData=this._getPreviousFilterData(),globalResolution=this._findFilterResolution(rootResolution),offsetX=0,offsetY=0;previousFilterData&&(offsetX=previousFilterData.bounds.minX,offsetY=previousFilterData.bounds.minY),this._calculateGlobalFrame(filterData,offsetX,offsetY,globalResolution,colorTextureSource.width,colorTextureSource.height),this._setupFilterTextures(filterData,bounds,renderer$1,previousFilterData)}generateFilteredTexture({texture,filters}){let filterData=this._pushFilterData();this._activeFilterData=filterData,filterData.skip=!1,filterData.filters=filters;let colorTextureSource=texture.source,rootResolution=colorTextureSource.resolution,rootAntialias=colorTextureSource.antialias;if(filters.every(filter$1=>!filter$1.enabled))return filterData.skip=!0,texture;let bounds=filterData.bounds;if(bounds.addRect(texture.frame),this._calculateFilterBounds(filterData,bounds.rectangle,rootAntialias,rootResolution,0),filterData.skip)return texture;let globalResolution=rootResolution;this._calculateGlobalFrame(filterData,0,0,globalResolution,colorTextureSource.width,colorTextureSource.height),filterData.outputRenderSurface=TexturePool.getOptimalTexture(bounds.width,bounds.height,filterData.resolution,filterData.antialias),filterData.backTexture=Texture.EMPTY,filterData.inputTexture=texture,this.renderer.renderTarget.finishRenderPass(),this._applyFiltersToTexture(filterData,!0);let outputTexture=filterData.outputRenderSurface;return outputTexture.source.alphaMode=`premultiplied-alpha`,outputTexture}pop(){let renderer$1=this.renderer,filterData=this._popFilterData();filterData.skip||(renderer$1.globalUniforms.pop(),renderer$1.renderTarget.finishRenderPass(),this._activeFilterData=filterData,this._applyFiltersToTexture(filterData,!1),filterData.blendRequired&&TexturePool.returnTexture(filterData.backTexture),TexturePool.returnTexture(filterData.inputTexture))}getBackTexture(lastRenderSurface,bounds,previousBounds){let backgroundResolution=lastRenderSurface.colorTexture.source._resolution,backTexture=TexturePool.getOptimalTexture(bounds.width,bounds.height,backgroundResolution,!1),x$1=bounds.minX,y$1=bounds.minY;previousBounds&&(x$1-=previousBounds.minX,y$1-=previousBounds.minY),x$1=Math.floor(x$1*backgroundResolution),y$1=Math.floor(y$1*backgroundResolution);let width=Math.ceil(bounds.width*backgroundResolution),height=Math.ceil(bounds.height*backgroundResolution);return this.renderer.renderTarget.copyToTexture(lastRenderSurface,backTexture,{x:x$1,y:y$1},{width,height},{x:0,y:0}),backTexture}applyFilter(filter$1,input,output,clear$1){let renderer$1=this.renderer,filterData=this._activeFilterData,isFinalTarget=filterData.outputRenderSurface===output,rootResolution=renderer$1.renderTarget.rootRenderTarget.colorTexture.source._resolution,resolution=this._findFilterResolution(rootResolution),offsetX=0,offsetY=0;if(isFinalTarget){let offset=this._findPreviousFilterOffset();offsetX=offset.x,offsetY=offset.y}this._updateFilterUniforms(input,output,filterData,offsetX,offsetY,resolution,isFinalTarget,clear$1);let filterToApply=filter$1.enabled?filter$1:this._getPassthroughFilter();this._setupBindGroupsAndRender(filterToApply,input,renderer$1)}calculateSpriteMatrix(outputMatrix,sprite){let data=this._activeFilterData,mappedMatrix=outputMatrix.set(data.inputTexture._source.width,0,0,data.inputTexture._source.height,data.bounds.minX,data.bounds.minY),worldTransform=sprite.worldTransform.copyTo(Matrix.shared),renderGroup=sprite.renderGroup||sprite.parentRenderGroup;return renderGroup&&renderGroup.cacheToLocalTransform&&worldTransform.prepend(renderGroup.cacheToLocalTransform),worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1/sprite.texture.orig.width,1/sprite.texture.orig.height),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix}destroy(){this._passthroughFilter?.destroy(!0),this._passthroughFilter=null}_getPassthroughFilter(){return this._passthroughFilter??=new PassthroughFilter,this._passthroughFilter}_setupBindGroupsAndRender(filter$1,input,renderer$1){if(renderer$1.renderPipes.uniformBatch){let batchUniforms=renderer$1.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);this._globalFilterBindGroup.setResource(batchUniforms,0)}else this._globalFilterBindGroup.setResource(this._filterGlobalUniforms,0);this._globalFilterBindGroup.setResource(input.source,1),this._globalFilterBindGroup.setResource(input.source.style,2),filter$1.groups[0]=this._globalFilterBindGroup,renderer$1.encoder.draw({geometry:quadGeometry,shader:filter$1,state:filter$1._state,topology:`triangle-list`}),renderer$1.type===RendererType.WEBGL&&renderer$1.renderTarget.finishRenderPass()}_setupFilterTextures(filterData,bounds,renderer$1,previousFilterData){if(filterData.backTexture=Texture.EMPTY,filterData.inputTexture=TexturePool.getOptimalTexture(bounds.width,bounds.height,filterData.resolution,filterData.antialias),filterData.blendRequired){renderer$1.renderTarget.finishRenderPass();let renderTarget=renderer$1.renderTarget.getRenderTarget(filterData.outputRenderSurface);filterData.backTexture=this.getBackTexture(renderTarget,bounds,previousFilterData?.bounds)}renderer$1.renderTarget.bind(filterData.inputTexture,!0),renderer$1.globalUniforms.push({offset:bounds})}_calculateGlobalFrame(filterData,offsetX,offsetY,globalResolution,sourceWidth,sourceHeight){let globalFrame=filterData.globalFrame;globalFrame.x=offsetX*globalResolution,globalFrame.y=offsetY*globalResolution,globalFrame.width=sourceWidth*globalResolution,globalFrame.height=sourceHeight*globalResolution}_updateFilterUniforms(input,output,filterData,offsetX,offsetY,resolution,isFinalTarget,clear$1){let uniforms=this._filterGlobalUniforms.uniforms,outputFrame=uniforms.uOutputFrame,inputSize=uniforms.uInputSize,inputPixel=uniforms.uInputPixel,inputClamp=uniforms.uInputClamp,globalFrame=uniforms.uGlobalFrame,outputTexture=uniforms.uOutputTexture;isFinalTarget?(outputFrame[0]=filterData.bounds.minX-offsetX,outputFrame[1]=filterData.bounds.minY-offsetY):(outputFrame[0]=0,outputFrame[1]=0),outputFrame[2]=input.frame.width,outputFrame[3]=input.frame.height,inputSize[0]=input.source.width,inputSize[1]=input.source.height,inputSize[2]=1/inputSize[0],inputSize[3]=1/inputSize[1],inputPixel[0]=input.source.pixelWidth,inputPixel[1]=input.source.pixelHeight,inputPixel[2]=1/inputPixel[0],inputPixel[3]=1/inputPixel[1],inputClamp[0]=.5*inputPixel[2],inputClamp[1]=.5*inputPixel[3],inputClamp[2]=input.frame.width*inputSize[2]-.5*inputPixel[2],inputClamp[3]=input.frame.height*inputSize[3]-.5*inputPixel[3];let rootTexture=this.renderer.renderTarget.rootRenderTarget.colorTexture;globalFrame[0]=offsetX*resolution,globalFrame[1]=offsetY*resolution,globalFrame[2]=rootTexture.source.width*resolution,globalFrame[3]=rootTexture.source.height*resolution,output instanceof Texture&&(output.source.resource=null);let renderTarget=this.renderer.renderTarget.getRenderTarget(output);this.renderer.renderTarget.bind(output,!!clear$1),output instanceof Texture?(outputTexture[0]=output.frame.width,outputTexture[1]=output.frame.height):(outputTexture[0]=renderTarget.width,outputTexture[1]=renderTarget.height),outputTexture[2]=renderTarget.isRoot?-1:1,this._filterGlobalUniforms.update()}_findFilterResolution(rootResolution){let currentIndex=this._filterStackIndex-1;for(;currentIndex>0&&this._filterStack[currentIndex].skip;)--currentIndex;return currentIndex>0&&this._filterStack[currentIndex].inputTexture?this._filterStack[currentIndex].inputTexture.source._resolution:rootResolution}_findPreviousFilterOffset(){let offsetX=0,offsetY=0,lastIndex=this._filterStackIndex;for(;lastIndex>0;){lastIndex--;let prevFilterData=this._filterStack[lastIndex];if(!prevFilterData.skip){offsetX=prevFilterData.bounds.minX,offsetY=prevFilterData.bounds.minY;break}}return{x:offsetX,y:offsetY}}_calculateFilterArea(instruction,bounds){if(instruction.renderables?getGlobalRenderableBounds(instruction.renderables,bounds):instruction.filterEffect.filterArea?(bounds.clear(),bounds.addRect(instruction.filterEffect.filterArea),bounds.applyMatrix(instruction.container.worldTransform)):instruction.container.getFastGlobalBounds(!0,bounds),instruction.container){let filterFrameTransform=(instruction.container.renderGroup||instruction.container.parentRenderGroup).cacheToLocalTransform;filterFrameTransform&&bounds.applyMatrix(filterFrameTransform)}}_applyFiltersToTexture(filterData,clear$1){let inputTexture=filterData.inputTexture,bounds=filterData.bounds,filters=filterData.filters,firstEnabled=filterData.firstEnabledIndex,lastEnabled=filterData.lastEnabledIndex;if(this._globalFilterBindGroup.setResource(inputTexture.source.style,2),this._globalFilterBindGroup.setResource(filterData.backTexture.source,3),firstEnabled===lastEnabled)filters[firstEnabled].apply(this,inputTexture,filterData.outputRenderSurface,clear$1);else{let flip=filterData.inputTexture,tempTexture=TexturePool.getOptimalTexture(bounds.width,bounds.height,flip.source._resolution,!1),flop=tempTexture;for(let i$1=firstEnabled;i$1<lastEnabled;i$1++){let filter$1=filters[i$1];if(!filter$1.enabled)continue;filter$1.apply(this,flip,flop,!0);let t$1=flip;flip=flop,flop=t$1}filters[lastEnabled].apply(this,flip,filterData.outputRenderSurface,clear$1),TexturePool.returnTexture(tempTexture)}}_calculateFilterBounds(filterData,viewPort,rootAntialias,rootResolution,paddingMultiplier){let renderer$1=this.renderer,bounds=filterData.bounds,filters=filterData.filters,resolution=1/0,padding=0,antialias=!0,blendRequired=!1,enabled=!1,clipToViewport=!0,firstEnabledIndex=-1,lastEnabledIndex=-1;for(let i$1=0;i$1<filters.length;i$1++){let filter$1=filters[i$1];if(filter$1.enabled){if(firstEnabledIndex===-1&&(firstEnabledIndex=i$1),lastEnabledIndex=i$1,resolution=Math.min(resolution,filter$1.resolution===`inherit`?rootResolution:filter$1.resolution),padding+=filter$1.padding,filter$1.antialias===`off`?antialias=!1:filter$1.antialias===`inherit`&&(antialias&&=rootAntialias),filter$1.clipToViewport||(clipToViewport=!1),!(filter$1.compatibleRenderers&renderer$1.type)){enabled=!1;break}if(filter$1.blendRequired&&!(renderer$1.backBuffer?.useBackBuffer??!0)){warn$1("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),enabled=!1;break}enabled=!0,blendRequired||=filter$1.blendRequired}}if(!enabled){filterData.skip=!0;return}if(clipToViewport&&bounds.fitBounds(0,viewPort.width/rootResolution,0,viewPort.height/rootResolution),bounds.scale(resolution).ceil().scale(1/resolution).pad((padding|0)*paddingMultiplier),!bounds.isPositive){filterData.skip=!0;return}filterData.antialias=antialias,filterData.resolution=resolution,filterData.blendRequired=blendRequired,filterData.firstEnabledIndex=firstEnabledIndex,filterData.lastEnabledIndex=lastEnabledIndex}_popFilterData(){return this._filterStackIndex--,this._filterStack[this._filterStackIndex]}_getPreviousFilterData(){let previousFilterData,index=this._filterStackIndex-1;for(;index>0&&(index--,previousFilterData=this._filterStack[index],previousFilterData.skip););return previousFilterData}_pushFilterData(){let filterData=this._filterStack[this._filterStackIndex];return filterData||=this._filterStack[this._filterStackIndex]=new FilterData,this._filterStackIndex++,filterData}};FilterSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`filter`};var fragment$1=`in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;
uniform float uInverse;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha;
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    float a = alphaMul * masky.r * npmAlpha * clip;

    if (uInverse == 1.0) {
        a = 1.0 - a;
    }

    finalColor = original * a;
}
`,vertex$1=`in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`,source=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
  uInverse:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>,
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;
    var uAlpha = filterUniforms.uAlpha;

    var clip = step(3.5,
      step(maskClamp.x, filterUv.x) +
      step(maskClamp.y, filterUv.y) +
      step(filterUv.x, maskClamp.z) +
      step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    var alphaMul = 1.0 - uAlpha * (1.0 - mask.a);

    var a: f32 = alphaMul * mask.r * uAlpha * clip;

    if (filterUniforms.uInverse == 1.0) {
        a = 1.0 - a;
    }

    return source * a;
}
`,MaskFilter=class extends Filter{constructor(options){let{sprite,...rest}=options,textureMatrix=new TextureMatrix(sprite.texture),filterUniforms=new UniformGroup({uFilterMatrix:{value:new Matrix,type:`mat3x3<f32>`},uMaskClamp:{value:textureMatrix.uClampFrame,type:`vec4<f32>`},uAlpha:{value:1,type:`f32`},uInverse:{value:options.inverse?1:0,type:`f32`}}),gpuProgram$2=GpuProgram.from({vertex:{source,entryPoint:`mainVertex`},fragment:{source,entryPoint:`mainFragment`}}),glProgram$2=GlProgram.from({vertex:vertex$1,fragment:fragment$1,name:`mask-filter`});super({...rest,gpuProgram:gpuProgram$2,glProgram:glProgram$2,clipToViewport:!1,resources:{filterUniforms,uMaskTexture:sprite.texture.source}}),this.sprite=sprite,this._textureMatrix=textureMatrix}set inverse(value){this.resources.filterUniforms.uniforms.uInverse=value?1:0}get inverse(){return this.resources.filterUniforms.uniforms.uInverse===1}apply(filterManager,input,output,clearMode){this._textureMatrix.texture=this.sprite.texture,filterManager.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,filterManager.applyFilter(this,input,output,clearMode)}},Graphics=class Graphics extends ViewContainer{constructor(options){options instanceof GraphicsContext&&(options={context:options});let{context:context$1,roundPixels,...rest}=options||{};super({label:`Graphics`,...rest}),this.renderPipeId=`graphics`,context$1?this._context=context$1:this._context=this._ownedContext=new GraphicsContext,this._context.on(`update`,this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=roundPixels??!1}set context(context$1){context$1!==this._context&&(this._context.off(`update`,this.onViewUpdate,this),this._context=context$1,this._context.on(`update`,this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(point){return this._context.containsPoint(point)}destroy(options){this._ownedContext&&!options?this._ownedContext.destroy(options):(options===!0||options?.context===!0)&&this._context.destroy(options),this._ownedContext=null,this._context=null,super.destroy(options)}_callContextMethod(method,args){return this.context[method](...args),this}setFillStyle(...args){return this._callContextMethod(`setFillStyle`,args)}setStrokeStyle(...args){return this._callContextMethod(`setStrokeStyle`,args)}fill(...args){return this._callContextMethod(`fill`,args)}stroke(...args){return this._callContextMethod(`stroke`,args)}texture(...args){return this._callContextMethod(`texture`,args)}beginPath(){return this._callContextMethod(`beginPath`,[])}cut(){return this._callContextMethod(`cut`,[])}arc(...args){return this._callContextMethod(`arc`,args)}arcTo(...args){return this._callContextMethod(`arcTo`,args)}arcToSvg(...args){return this._callContextMethod(`arcToSvg`,args)}bezierCurveTo(...args){return this._callContextMethod(`bezierCurveTo`,args)}closePath(){return this._callContextMethod(`closePath`,[])}ellipse(...args){return this._callContextMethod(`ellipse`,args)}circle(...args){return this._callContextMethod(`circle`,args)}path(...args){return this._callContextMethod(`path`,args)}lineTo(...args){return this._callContextMethod(`lineTo`,args)}moveTo(...args){return this._callContextMethod(`moveTo`,args)}quadraticCurveTo(...args){return this._callContextMethod(`quadraticCurveTo`,args)}rect(...args){return this._callContextMethod(`rect`,args)}roundRect(...args){return this._callContextMethod(`roundRect`,args)}poly(...args){return this._callContextMethod(`poly`,args)}regularPoly(...args){return this._callContextMethod(`regularPoly`,args)}roundPoly(...args){return this._callContextMethod(`roundPoly`,args)}roundShape(...args){return this._callContextMethod(`roundShape`,args)}filletRect(...args){return this._callContextMethod(`filletRect`,args)}chamferRect(...args){return this._callContextMethod(`chamferRect`,args)}star(...args){return this._callContextMethod(`star`,args)}svg(...args){return this._callContextMethod(`svg`,args)}restore(...args){return this._callContextMethod(`restore`,args)}save(){return this._callContextMethod(`save`,[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod(`resetTransform`,[])}rotateTransform(...args){return this._callContextMethod(`rotate`,args)}scaleTransform(...args){return this._callContextMethod(`scale`,args)}setTransform(...args){return this._callContextMethod(`setTransform`,args)}transform(...args){return this._callContextMethod(`transform`,args)}translateTransform(...args){return this._callContextMethod(`translate`,args)}clear(){return this._callContextMethod(`clear`,[])}get fillStyle(){return this._context.fillStyle}set fillStyle(value){this._context.fillStyle=value}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(value){this._context.strokeStyle=value}clone(deep=!1){return deep?new Graphics(this._context.clone()):(this._ownedContext=null,new Graphics(this._context))}lineStyle(width,color$2,alpha){deprecation(v8_0_0,`Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.`);let strokeStyle={};return width&&(strokeStyle.width=width),color$2&&(strokeStyle.color=color$2),alpha&&(strokeStyle.alpha=alpha),this.context.strokeStyle=strokeStyle,this}beginFill(color$2,alpha){deprecation(v8_0_0,`Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.`);let fillStyle={};return color$2!==void 0&&(fillStyle.color=color$2),alpha!==void 0&&(fillStyle.alpha=alpha),this.context.fillStyle=fillStyle,this}endFill(){deprecation(v8_0_0,`Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.`),this.context.fill();let strokeStyle=this.context.strokeStyle;return(strokeStyle.width!==GraphicsContext.defaultStrokeStyle.width||strokeStyle.color!==GraphicsContext.defaultStrokeStyle.color||strokeStyle.alpha!==GraphicsContext.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...args){return deprecation(v8_0_0,`Graphics#drawCircle has been renamed to Graphics#circle`),this._callContextMethod(`circle`,args)}drawEllipse(...args){return deprecation(v8_0_0,`Graphics#drawEllipse has been renamed to Graphics#ellipse`),this._callContextMethod(`ellipse`,args)}drawPolygon(...args){return deprecation(v8_0_0,`Graphics#drawPolygon has been renamed to Graphics#poly`),this._callContextMethod(`poly`,args)}drawRect(...args){return deprecation(v8_0_0,`Graphics#drawRect has been renamed to Graphics#rect`),this._callContextMethod(`rect`,args)}drawRoundedRect(...args){return deprecation(v8_0_0,`Graphics#drawRoundedRect has been renamed to Graphics#roundRect`),this._callContextMethod(`roundRect`,args)}drawStar(...args){return deprecation(v8_0_0,`Graphics#drawStar has been renamed to Graphics#star`),this._callContextMethod(`star`,args)}},_MeshGeometry=class _MeshGeometry$1 extends Geometry{constructor(...args){let options=args[0]??{};options instanceof Float32Array&&(deprecation(v8_0_0,`use new MeshGeometry({ positions, uvs, indices }) instead`),options={positions:options,uvs:args[1],indices:args[2]}),options={..._MeshGeometry$1.defaultOptions,...options};let positions=options.positions||new Float32Array([0,0,1,0,1,1,0,1]),uvs=options.uvs;uvs||=options.positions?new Float32Array(positions.length):new Float32Array([0,0,1,0,1,1,0,1]);let indices=options.indices||new Uint32Array([0,1,2,0,2,3]),shrinkToFit=options.shrinkBuffersToFit,positionBuffer=new Buffer$1({data:positions,label:`attribute-mesh-positions`,shrinkToFit,usage:BufferUsage.VERTEX|BufferUsage.COPY_DST}),uvBuffer=new Buffer$1({data:uvs,label:`attribute-mesh-uvs`,shrinkToFit,usage:BufferUsage.VERTEX|BufferUsage.COPY_DST}),indexBuffer=new Buffer$1({data:indices,label:`index-mesh-buffer`,shrinkToFit,usage:BufferUsage.INDEX|BufferUsage.COPY_DST});super({attributes:{aPosition:{buffer:positionBuffer,format:`float32x2`,stride:8,offset:0},aUV:{buffer:uvBuffer,format:`float32x2`,stride:8,offset:0}},indexBuffer,topology:options.topology}),this.batchMode=`auto`}get positions(){return this.attributes.aPosition.buffer.data}set positions(value){this.attributes.aPosition.buffer.data=value}get uvs(){return this.attributes.aUV.buffer.data}set uvs(value){this.attributes.aUV.buffer.data=value}get indices(){return this.indexBuffer.data}set indices(value){this.indexBuffer.data=value}};_MeshGeometry.defaultOptions={topology:`triangle-list`,shrinkBuffersToFit:!1};var MeshGeometry=_MeshGeometry,Mesh=class extends ViewContainer{constructor(...args){let options=args[0];options instanceof Geometry&&(deprecation(v8_0_0,`Mesh: use new Mesh({ geometry, shader }) instead`),options={geometry:options,shader:args[1]},args[3]&&(deprecation(v8_0_0,`Mesh: drawMode argument has been removed, use geometry.topology instead`),options.geometry.topology=args[3]));let{geometry,shader,texture,roundPixels,state,...rest}=options;super({label:`Mesh`,...rest}),this.renderPipeId=`mesh`,this._shader=null,this.allowChildren=!1,this.shader=shader??null,this.texture=texture??shader?.texture??Texture.WHITE,this.state=state??State.for2d(),this._geometry=geometry,this._geometry.on(`update`,this.onViewUpdate,this),this.roundPixels=roundPixels??!1}get material(){return deprecation(v8_0_0,`mesh.material property has been removed, use mesh.shader instead`),this._shader}set shader(value){this._shader!==value&&(this._shader=value,this.onViewUpdate())}get shader(){return this._shader}set geometry(value){this._geometry!==value&&(this._geometry?.off(`update`,this.onViewUpdate,this),value.on(`update`,this.onViewUpdate,this),this._geometry=value,this.onViewUpdate())}get geometry(){return this._geometry}set texture(value){value||=Texture.EMPTY;let currentTexture=this._texture;currentTexture!==value&&(currentTexture&&currentTexture.dynamic&&currentTexture.off(`update`,this.onViewUpdate,this),value.dynamic&&value.on(`update`,this.onViewUpdate,this),this.shader&&(this.shader.texture=value),this._texture=value,this.onViewUpdate())}get texture(){return this._texture}get batched(){return this._shader||this.state.data&12?!1:this._geometry instanceof MeshGeometry?this._geometry.batchMode===`auto`?this._geometry.positions.length/2<=100:this._geometry.batchMode===`batch`:!1}get bounds(){return this._geometry.bounds}updateBounds(){this._bounds=this._geometry.bounds}containsPoint(point){let{x:x$1,y:y$1}=point;if(!this.bounds.containsPoint(x$1,y$1))return!1;let vertices=this.geometry.getBuffer(`aPosition`).data,step=this.geometry.topology===`triangle-strip`?3:1;if(this.geometry.getIndex()){let indices=this.geometry.getIndex().data,len$1=indices.length;for(let i$1=0;i$1+2<len$1;i$1+=step){let ind0=indices[i$1]*2,ind1=indices[i$1+1]*2,ind2=indices[i$1+2]*2;if(pointInTriangle(x$1,y$1,vertices[ind0],vertices[ind0+1],vertices[ind1],vertices[ind1+1],vertices[ind2],vertices[ind2+1]))return!0}}else{let len$1=vertices.length/2;for(let i$1=0;i$1+2<len$1;i$1+=step){let ind0=i$1*2,ind1=(i$1+1)*2,ind2=(i$1+2)*2;if(pointInTriangle(x$1,y$1,vertices[ind0],vertices[ind0+1],vertices[ind1],vertices[ind1+1],vertices[ind2],vertices[ind2+1]))return!0}}return!1}destroy(options){if(super.destroy(options),typeof options==`boolean`?options:options?.texture){let destroyTextureSource=typeof options==`boolean`?options:options?.textureSource;this._texture.destroy(destroyTextureSource)}this._geometry?.off(`update`,this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null,this._gpuData=null}},AbstractText=class extends ViewContainer{constructor(options,styleClass){let{text,resolution,style,anchor,width,height,roundPixels,...rest}=options;super({...rest}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=styleClass,this.text=text??``,this.style=style,this.resolution=resolution??null,this.allowChildren=!1,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),anchor&&(this.anchor=anchor),this.roundPixels=roundPixels??!1,width!==void 0&&(this.width=width),height!==void 0&&(this.height=height)}get anchor(){return this._anchor}set anchor(value){typeof value==`number`?this._anchor.set(value):this._anchor.copyFrom(value)}set text(value){value=value.toString(),this._text!==value&&(this._text=value,this.onViewUpdate())}get text(){return this._text}set resolution(value){this._autoResolution=value===null,this._resolution=value,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(style){style||={},this._style?.off(`update`,this.onViewUpdate,this),style instanceof this._styleClass?this._style=style:this._style=new this._styleClass(style),this._style.on(`update`,this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(value){this._setWidth(value,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(value){this._setHeight(value,this.bounds.height)}getSize(out$2){return out$2||={},out$2.width=Math.abs(this.scale.x)*this.bounds.width,out$2.height=Math.abs(this.scale.y)*this.bounds.height,out$2}setSize(value,height){typeof value==`object`?(height=value.height??value.width,value=value.width):height??=value,value!==void 0&&this._setWidth(value,this.bounds.width),height!==void 0&&this._setHeight(height,this.bounds.height)}containsPoint(point){let width=this.bounds.width,height=this.bounds.height,x1=-width*this.anchor.x,y1=0;return point.x>=x1&&point.x<=x1+width&&(y1=-height*this.anchor.y,point.y>=y1&&point.y<=y1+height)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(options=!1){super.destroy(options),this.owner=null,this._bounds=null,this._anchor=null,(typeof options==`boolean`?options:options?.style)&&this._style.destroy(options),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}};function ensureTextOptions(args,name){let options=args[0]??{};return(typeof options==`string`||args[1])&&(deprecation(v8_0_0,`use new ${name}({ text: "hi!", style }) instead`),options={text:options,style:args[1]}),options}var _internalCanvas=null,_internalContext=null;function ensureInternalCanvas(width,height){_internalCanvas||(_internalCanvas=DOMAdapter.get().createCanvas(256,128),_internalContext=_internalCanvas.getContext(`2d`,{willReadFrequently:!0}),_internalContext.globalCompositeOperation=`copy`,_internalContext.globalAlpha=1),(_internalCanvas.width<width||_internalCanvas.height<height)&&(_internalCanvas.width=nextPow2(width),_internalCanvas.height=nextPow2(height))}function checkRow(data,width,y$1){for(let x$1=0,index=4*y$1*width;x$1<width;++x$1,index+=4)if(data[index+3]!==0)return!1;return!0}function checkColumn(data,width,x$1,top,bottom){let stride=4*width;for(let y$1=top,index=top*stride+4*x$1;y$1<=bottom;++y$1,index+=stride)if(data[index+3]!==0)return!1;return!0}function getCanvasBoundingBox(...args){let options=args[0];options.canvas||(options={canvas:args[0],resolution:args[1]});let{canvas}=options,resolution=Math.min(options.resolution??1,1),width=options.width??canvas.width,height=options.height??canvas.height,output=options.output;if(ensureInternalCanvas(width,height),!_internalContext)throw TypeError(`Failed to get canvas 2D context`);_internalContext.drawImage(canvas,0,0,width,height,0,0,width*resolution,height*resolution);let data=_internalContext.getImageData(0,0,width,height).data,left=0,top=0,right=width-1,bottom=height-1;for(;top<height&&checkRow(data,width,top);)++top;if(top===height)return Rectangle.EMPTY;for(;checkRow(data,width,bottom);)--bottom;for(;checkColumn(data,width,left,top,bottom);)++left;for(;checkColumn(data,width,right,top,bottom);)--right;return++right,++bottom,_internalContext.globalCompositeOperation=`source-over`,_internalContext.strokeRect(left,top,right-left,bottom-top),_internalContext.globalCompositeOperation=`copy`,output??=new Rectangle,output.set(left/resolution,top/resolution,(right-left)/resolution,(bottom-top)/resolution),output}var tempRect$1=new Rectangle,CanvasTextGenerator=new class{getCanvasAndContext(options){let{text,style,resolution=1}=options,padding=style._getFinalPadding(),measured=CanvasTextMetrics.measureText(text||` `,style),width=Math.ceil(Math.ceil(Math.max(1,measured.width)+padding*2)*resolution),height=Math.ceil(Math.ceil(Math.max(1,measured.height)+padding*2)*resolution),canvasAndContext=CanvasPool.getOptimalCanvasAndContext(width,height);this._renderTextToCanvas(text,style,padding,resolution,canvasAndContext);let frame=style.trim?getCanvasBoundingBox({canvas:canvasAndContext.canvas,width,height,resolution:1,output:tempRect$1}):tempRect$1.set(0,0,width,height);return{canvasAndContext,frame}}returnCanvasAndContext(canvasAndContext){CanvasPool.returnCanvasAndContext(canvasAndContext)}_renderTextToCanvas(text,style,padding,resolution,canvasAndContext){let{canvas,context:context$1}=canvasAndContext,font=fontStringFromTextStyle(style),measured=CanvasTextMetrics.measureText(text||` `,style),lines=measured.lines,lineHeight=measured.lineHeight,lineWidths=measured.lineWidths,maxLineWidth=measured.maxLineWidth,fontProperties=measured.fontProperties,height=canvas.height;if(context$1.resetTransform(),context$1.scale(resolution,resolution),context$1.textBaseline=style.textBaseline,style._stroke?.width){let strokeStyle=style._stroke;context$1.lineWidth=strokeStyle.width,context$1.miterLimit=strokeStyle.miterLimit,context$1.lineJoin=strokeStyle.join,context$1.lineCap=strokeStyle.cap}context$1.font=font;let linePositionX,linePositionY,passesCount=style.dropShadow?2:1;for(let i$1=0;i$1<passesCount;++i$1){let isShadowPass=style.dropShadow&&i$1===0,dsOffsetText=isShadowPass?Math.ceil(Math.max(1,height)+padding*2):0,dsOffsetShadow=dsOffsetText*resolution;if(isShadowPass){context$1.fillStyle=`black`,context$1.strokeStyle=`black`;let shadowOptions=style.dropShadow,dropShadowColor=shadowOptions.color,dropShadowAlpha=shadowOptions.alpha;context$1.shadowColor=Color.shared.setValue(dropShadowColor).setAlpha(dropShadowAlpha).toRgbaString();let dropShadowBlur=shadowOptions.blur*resolution,dropShadowDistance=shadowOptions.distance*resolution;context$1.shadowBlur=dropShadowBlur,context$1.shadowOffsetX=Math.cos(shadowOptions.angle)*dropShadowDistance,context$1.shadowOffsetY=Math.sin(shadowOptions.angle)*dropShadowDistance+dsOffsetShadow}else{if(context$1.fillStyle=style._fill?getCanvasFillStyle(style._fill,context$1,measured,padding*2):null,style._stroke?.width){let strokePadding=style._stroke.width*.5+padding*2;context$1.strokeStyle=getCanvasFillStyle(style._stroke,context$1,measured,strokePadding)}context$1.shadowColor=`black`}let linePositionYShift=(lineHeight-fontProperties.fontSize)/2;lineHeight-fontProperties.fontSize<0&&(linePositionYShift=0);let strokeWidth=style._stroke?.width??0;for(let i2=0;i2<lines.length;i2++)linePositionX=strokeWidth/2,linePositionY=strokeWidth/2+i2*lineHeight+fontProperties.ascent+linePositionYShift,style.align===`right`?linePositionX+=maxLineWidth-lineWidths[i2]:style.align===`center`&&(linePositionX+=(maxLineWidth-lineWidths[i2])/2),style._stroke?.width&&this._drawLetterSpacing(lines[i2],style,canvasAndContext,linePositionX+padding,linePositionY+padding-dsOffsetText,!0),style._fill!==void 0&&this._drawLetterSpacing(lines[i2],style,canvasAndContext,linePositionX+padding,linePositionY+padding-dsOffsetText)}}_drawLetterSpacing(text,style,canvasAndContext,x$1,y$1,isStroke=!1){let{context:context$1}=canvasAndContext,letterSpacing=style.letterSpacing,useExperimentalLetterSpacing=!1;if(CanvasTextMetrics.experimentalLetterSpacingSupported&&(CanvasTextMetrics.experimentalLetterSpacing?(context$1.letterSpacing=`${letterSpacing}px`,context$1.textLetterSpacing=`${letterSpacing}px`,useExperimentalLetterSpacing=!0):(context$1.letterSpacing=`0px`,context$1.textLetterSpacing=`0px`)),letterSpacing===0||useExperimentalLetterSpacing){isStroke?context$1.strokeText(text,x$1,y$1):context$1.fillText(text,x$1,y$1);return}let currentPosition=x$1,stringArray=CanvasTextMetrics.graphemeSegmenter(text),previousWidth=context$1.measureText(text).width,currentWidth=0;for(let i$1=0;i$1<stringArray.length;++i$1){let currentChar=stringArray[i$1];isStroke?context$1.strokeText(currentChar,currentPosition,y$1):context$1.fillText(currentChar,currentPosition,y$1);let textStr=``;for(let j$1=i$1+1;j$1<stringArray.length;++j$1)textStr+=stringArray[j$1];currentWidth=context$1.measureText(textStr).width,currentPosition+=previousWidth-currentWidth+letterSpacing,previousWidth=currentWidth}}},Text=class extends AbstractText{constructor(...args){let options=ensureTextOptions(args,`Text`);super(options,TextStyle),this.renderPipeId=`text`,options.textureStyle&&(this.textureStyle=options.textureStyle instanceof TextureStyle?options.textureStyle:new TextureStyle(options.textureStyle))}updateBounds(){let bounds=this._bounds,anchor=this._anchor,width=0,height=0;if(this._style.trim){let{frame,canvasAndContext}=CanvasTextGenerator.getCanvasAndContext({text:this.text,style:this._style,resolution:1});CanvasTextGenerator.returnCanvasAndContext(canvasAndContext),width=frame.width,height=frame.height}else{let canvasMeasurement=CanvasTextMetrics.measureText(this._text,this._style);width=canvasMeasurement.width,height=canvasMeasurement.height}bounds.minX=-anchor._x*width,bounds.maxX=bounds.minX+width,bounds.minY=-anchor._y*height,bounds.maxY=bounds.minY+height}},nssvg=`http://www.w3.org/2000/svg`,nsxhtml=`http://www.w3.org/1999/xhtml`,HTMLTextRenderData=class{constructor(){this.svgRoot=document.createElementNS(nssvg,`svg`),this.foreignObject=document.createElementNS(nssvg,`foreignObject`),this.domElement=document.createElementNS(nsxhtml,`div`),this.styleElement=document.createElementNS(nsxhtml,`style`);let{foreignObject,svgRoot,styleElement,domElement}=this;foreignObject.setAttribute(`width`,`10000`),foreignObject.setAttribute(`height`,`10000`),foreignObject.style.overflow=`hidden`,svgRoot.appendChild(foreignObject),foreignObject.appendChild(styleElement),foreignObject.appendChild(domElement),this.image=DOMAdapter.get().createImage()}destroy(){this.svgRoot.remove(),this.foreignObject.remove(),this.styleElement.remove(),this.domElement.remove(),this.image.src=``,this.image.remove(),this.svgRoot=null,this.foreignObject=null,this.styleElement=null,this.domElement=null,this.image=null,this.canvasAndContext=null}},tempHTMLTextRenderData;function measureHtmlText(text,style,fontStyleCSS,htmlTextRenderData){htmlTextRenderData||=tempHTMLTextRenderData||=new HTMLTextRenderData;let{domElement,styleElement,svgRoot}=htmlTextRenderData;domElement.innerHTML=`<style>${style.cssStyle};</style><div style='padding:0'>${text}</div>`,domElement.setAttribute(`style`,`transform-origin: top left; display: inline-block`),fontStyleCSS&&(styleElement.textContent=fontStyleCSS),document.body.appendChild(svgRoot);let contentBounds=domElement.getBoundingClientRect();svgRoot.remove();let doublePadding=style.padding*2;return{width:contentBounds.width-doublePadding,height:contentBounds.height-doublePadding}}var GlBatchAdaptor=class{constructor(){this._tempState=State.for2d(),this._didUploadHash={}}init(batcherPipe){batcherPipe.renderer.runners.contextChange.add(this)}contextChange(){this._didUploadHash={}}start(batchPipe,geometry,shader){let renderer$1=batchPipe.renderer,didUpload=this._didUploadHash[shader.uid];renderer$1.shader.bind(shader,didUpload),didUpload||(this._didUploadHash[shader.uid]=!0),renderer$1.shader.updateUniformGroup(renderer$1.globalUniforms.uniformGroup),renderer$1.geometry.bind(geometry,shader.glProgram)}execute(batchPipe,batch$1){let renderer$1=batchPipe.renderer;this._tempState.blendMode=batch$1.blendMode,renderer$1.state.set(this._tempState);let textures=batch$1.textures.textures;for(let i$1=0;i$1<batch$1.textures.count;i$1++)renderer$1.texture.bind(textures[i$1],i$1);renderer$1.geometry.draw(batch$1.topology,batch$1.size,batch$1.start)}};GlBatchAdaptor.extension={type:[ExtensionType.WebGLPipesAdaptor],name:`batch`};var tempState=State.for2d(),GpuBatchAdaptor=class{start(batchPipe,geometry,shader){let renderer$1=batchPipe.renderer,encoder=renderer$1.encoder,program=shader.gpuProgram;this._shader=shader,this._geometry=geometry,encoder.setGeometry(geometry,program),tempState.blendMode=`normal`,renderer$1.pipeline.getPipeline(geometry,program,tempState);let globalUniformsBindGroup=renderer$1.globalUniforms.bindGroup;encoder.resetBindGroup(1),encoder.setBindGroup(0,globalUniformsBindGroup,program)}execute(batchPipe,batch$1){let program=this._shader.gpuProgram,renderer$1=batchPipe.renderer,encoder=renderer$1.encoder;if(!batch$1.bindGroup){let textureBatch=batch$1.textures;batch$1.bindGroup=getTextureBatchBindGroup(textureBatch.textures,textureBatch.count,renderer$1.limits.maxBatchableTextures)}tempState.blendMode=batch$1.blendMode;let gpuBindGroup=renderer$1.bindGroup.getBindGroup(batch$1.bindGroup,program,1),pipeline=renderer$1.pipeline.getPipeline(this._geometry,program,tempState,batch$1.topology);batch$1.bindGroup._touch(renderer$1.textureGC.count),encoder.setPipeline(pipeline),encoder.renderPassEncoder.setBindGroup(1,gpuBindGroup),encoder.renderPassEncoder.drawIndexed(batch$1.size,1,batch$1.start)}};GpuBatchAdaptor.extension={type:[ExtensionType.WebGPUPipesAdaptor],name:`batch`};var _BatcherPipe=class _BatcherPipe$1{constructor(renderer$1,adaptor){this.state=State.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=renderer$1,this._adaptor=adaptor,this._adaptor.init?.(this)}static getBatcher(name){return new this._availableBatchers[name]}buildStart(instructionSet){let batchers=this._batchersByInstructionSet[instructionSet.uid];for(let i$1 in batchers||(batchers=this._batchersByInstructionSet[instructionSet.uid]=Object.create(null),batchers.default||=new DefaultBatcher({maxTextures:this.renderer.limits.maxBatchableTextures})),this._activeBatches=batchers,this._activeBatch=this._activeBatches.default,this._activeBatches)this._activeBatches[i$1].begin()}addToBatch(batchableObject,instructionSet){if(this._activeBatch.name!==batchableObject.batcherName){this._activeBatch.break(instructionSet);let batch$1=this._activeBatches[batchableObject.batcherName];batch$1||(batch$1=this._activeBatches[batchableObject.batcherName]=_BatcherPipe$1.getBatcher(batchableObject.batcherName),batch$1.begin()),this._activeBatch=batch$1}this._activeBatch.add(batchableObject)}break(instructionSet){this._activeBatch.break(instructionSet)}buildEnd(instructionSet){this._activeBatch.break(instructionSet);let batches=this._activeBatches;for(let i$1 in batches){let batch$1=batches[i$1],geometry=batch$1.geometry;geometry.indexBuffer.setDataWithSize(batch$1.indexBuffer,batch$1.indexSize,!0),geometry.buffers[0].setDataWithSize(batch$1.attributeBuffer.float32View,batch$1.attributeSize,!1)}}upload(instructionSet){let batchers=this._batchersByInstructionSet[instructionSet.uid];for(let i$1 in batchers){let batcher=batchers[i$1],geometry=batcher.geometry;batcher.dirty&&(batcher.dirty=!1,geometry.buffers[0].update(batcher.attributeSize*4))}}execute(batch$1){if(batch$1.action===`startBatch`){let batcher=batch$1.batcher,geometry=batcher.geometry,shader=batcher.shader;this._adaptor.start(this,geometry,shader)}this._adaptor.execute(this,batch$1)}destroy(){for(let i$1 in this.state=null,this.renderer=null,this._adaptor=null,this._activeBatches)this._activeBatches[i$1].destroy();this._activeBatches=null}};_BatcherPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`batch`},_BatcherPipe._availableBatchers=Object.create(null);var BatcherPipe=_BatcherPipe;extensions$1.handleByMap(ExtensionType.Batcher,BatcherPipe._availableBatchers),extensions$1.add(DefaultBatcher);var localUniformBit={name:`local-uniform-bit`,vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}},localUniformBitGroup2={...localUniformBit,vertex:{...localUniformBit.vertex,header:localUniformBit.vertex.header.replace(`group(1)`,`group(2)`)}},localUniformBitGl={name:`local-uniform-bit`,vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}},textureBit={name:`texture-bit`,vertex:{header:`

        struct TextureUniforms {
            uTextureMatrix:mat3x3<f32>,
        }

        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;
        `,main:`
            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
            @group(2) @binding(0) var uTexture: texture_2d<f32>;
            @group(2) @binding(1) var uSampler: sampler;


        `,main:`
            outColor = textureSample(uTexture, uSampler, vUV);
        `}},textureBitGl={name:`texture-bit`,vertex:{header:`
            uniform mat3 uTextureMatrix;
        `,main:`
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `},fragment:{header:`
        uniform sampler2D uTexture;


        `,main:`
            outColor = texture(uTexture, vUV);
        `}},tempBounds$2=new Bounds,AlphaMaskEffect=class extends FilterEffect{constructor(){super(),this.filters=[new MaskFilter({sprite:new Sprite(Texture.EMPTY),inverse:!1,resolution:`inherit`,antialias:`inherit`})]}get sprite(){return this.filters[0].sprite}set sprite(value){this.filters[0].sprite=value}get inverse(){return this.filters[0].inverse}set inverse(value){this.filters[0].inverse=value}},AlphaMaskPipe=class{constructor(renderer$1){this._activeMaskStage=[],this._renderer=renderer$1}push(mask,maskedContainer,instructionSet){let renderer$1=this._renderer;if(renderer$1.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`alphaMask`,action:`pushMaskBegin`,mask,inverse:maskedContainer._maskOptions.inverse,canBundle:!1,maskedContainer}),mask.inverse=maskedContainer._maskOptions.inverse,mask.renderMaskToTexture){let maskContainer=mask.mask;maskContainer.includeInBuild=!0,maskContainer.collectRenderables(instructionSet,renderer$1,null),maskContainer.includeInBuild=!1}renderer$1.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`alphaMask`,action:`pushMaskEnd`,mask,maskedContainer,inverse:maskedContainer._maskOptions.inverse,canBundle:!1})}pop(mask,_maskedContainer,instructionSet){this._renderer.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`alphaMask`,action:`popMaskEnd`,mask,inverse:_maskedContainer._maskOptions.inverse,canBundle:!1})}execute(instruction){let renderer$1=this._renderer,renderMask=instruction.mask.renderMaskToTexture;if(instruction.action===`pushMaskBegin`){let filterEffect=BigPool.get(AlphaMaskEffect);if(filterEffect.inverse=instruction.inverse,renderMask){instruction.mask.mask.measurable=!0;let bounds=getGlobalBounds(instruction.mask.mask,!0,tempBounds$2);instruction.mask.mask.measurable=!1,bounds.ceil();let colorTextureSource=renderer$1.renderTarget.renderTarget.colorTexture.source,filterTexture=TexturePool.getOptimalTexture(bounds.width,bounds.height,colorTextureSource._resolution,colorTextureSource.antialias);renderer$1.renderTarget.push(filterTexture,!0),renderer$1.globalUniforms.push({offset:bounds,worldColor:4294967295});let sprite=filterEffect.sprite;sprite.texture=filterTexture,sprite.worldTransform.tx=bounds.minX,sprite.worldTransform.ty=bounds.minY,this._activeMaskStage.push({filterEffect,maskedContainer:instruction.maskedContainer,filterTexture})}else filterEffect.sprite=instruction.mask.mask,this._activeMaskStage.push({filterEffect,maskedContainer:instruction.maskedContainer})}else if(instruction.action===`pushMaskEnd`){let maskData=this._activeMaskStage[this._activeMaskStage.length-1];renderMask&&(renderer$1.type===RendererType.WEBGL&&renderer$1.renderTarget.finishRenderPass(),renderer$1.renderTarget.pop(),renderer$1.globalUniforms.pop()),renderer$1.filter.push({renderPipeId:`filter`,action:`pushFilter`,container:maskData.maskedContainer,filterEffect:maskData.filterEffect,canBundle:!1})}else if(instruction.action===`popMaskEnd`){renderer$1.filter.pop();let maskData=this._activeMaskStage.pop();renderMask&&TexturePool.returnTexture(maskData.filterTexture),BigPool.return(maskData.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}};AlphaMaskPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`alphaMask`};var ColorMaskPipe=class{constructor(renderer$1){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=renderer$1}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(mask,_container,instructionSet){this._renderer.renderPipes.batch.break(instructionSet);let colorStack=this._colorStack;colorStack[this._colorStackIndex]=colorStack[this._colorStackIndex-1]&mask.mask;let currentColor=this._colorStack[this._colorStackIndex];currentColor!==this._currentColor&&(this._currentColor=currentColor,instructionSet.add({renderPipeId:`colorMask`,colorMask:currentColor,canBundle:!1})),this._colorStackIndex++}pop(_mask,_container,instructionSet){this._renderer.renderPipes.batch.break(instructionSet);let colorStack=this._colorStack;this._colorStackIndex--;let currentColor=colorStack[this._colorStackIndex-1];currentColor!==this._currentColor&&(this._currentColor=currentColor,instructionSet.add({renderPipeId:`colorMask`,colorMask:currentColor,canBundle:!1}))}execute(instruction){this._renderer.colorMask.setMask(instruction.colorMask)}destroy(){this._renderer=null,this._colorStack=null}};ColorMaskPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`colorMask`};var StencilMaskPipe=class{constructor(renderer$1){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=renderer$1}push(mask,_container,instructionSet){var _a$1;let effect$1=mask,renderer$1=this._renderer;renderer$1.renderPipes.batch.break(instructionSet),renderer$1.renderPipes.blendMode.setBlendMode(effect$1.mask,`none`,instructionSet),instructionSet.add({renderPipeId:`stencilMask`,action:`pushMaskBegin`,mask,inverse:_container._maskOptions.inverse,canBundle:!1});let maskContainer=effect$1.mask;maskContainer.includeInBuild=!0,this._maskHash.has(effect$1)||this._maskHash.set(effect$1,{instructionsStart:0,instructionsLength:0});let maskData=this._maskHash.get(effect$1);maskData.instructionsStart=instructionSet.instructionSize,maskContainer.collectRenderables(instructionSet,renderer$1,null),maskContainer.includeInBuild=!1,renderer$1.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`stencilMask`,action:`pushMaskEnd`,mask,inverse:_container._maskOptions.inverse,canBundle:!1}),maskData.instructionsLength=instructionSet.instructionSize-maskData.instructionsStart-1;let renderTargetUid=renderer$1.renderTarget.renderTarget.uid;(_a$1=this._maskStackHash)[renderTargetUid]??(_a$1[renderTargetUid]=0)}pop(mask,_container,instructionSet){let effect$1=mask,renderer$1=this._renderer;renderer$1.renderPipes.batch.break(instructionSet),renderer$1.renderPipes.blendMode.setBlendMode(effect$1.mask,`none`,instructionSet),instructionSet.add({renderPipeId:`stencilMask`,action:`popMaskBegin`,inverse:_container._maskOptions.inverse,canBundle:!1});let maskData=this._maskHash.get(mask);for(let i$1=0;i$1<maskData.instructionsLength;i$1++)instructionSet.instructions[instructionSet.instructionSize++]=instructionSet.instructions[maskData.instructionsStart++];instructionSet.add({renderPipeId:`stencilMask`,action:`popMaskEnd`,canBundle:!1})}execute(instruction){var _a$1;let renderer$1=this._renderer,renderTargetUid=renderer$1.renderTarget.renderTarget.uid,maskStackIndex=(_a$1=this._maskStackHash)[renderTargetUid]??(_a$1[renderTargetUid]=0);instruction.action===`pushMaskBegin`?(renderer$1.renderTarget.ensureDepthStencil(),renderer$1.stencil.setStencilMode(STENCIL_MODES.RENDERING_MASK_ADD,maskStackIndex),maskStackIndex++,renderer$1.colorMask.setMask(0)):instruction.action===`pushMaskEnd`?(instruction.inverse?renderer$1.stencil.setStencilMode(STENCIL_MODES.INVERSE_MASK_ACTIVE,maskStackIndex):renderer$1.stencil.setStencilMode(STENCIL_MODES.MASK_ACTIVE,maskStackIndex),renderer$1.colorMask.setMask(15)):instruction.action===`popMaskBegin`?(renderer$1.colorMask.setMask(0),maskStackIndex===0?(renderer$1.renderTarget.clear(null,CLEAR.STENCIL),renderer$1.stencil.setStencilMode(STENCIL_MODES.DISABLED,maskStackIndex)):renderer$1.stencil.setStencilMode(STENCIL_MODES.RENDERING_MASK_REMOVE,maskStackIndex),maskStackIndex--):instruction.action===`popMaskEnd`&&(instruction.inverse?renderer$1.stencil.setStencilMode(STENCIL_MODES.INVERSE_MASK_ACTIVE,maskStackIndex):renderer$1.stencil.setStencilMode(STENCIL_MODES.MASK_ACTIVE,maskStackIndex),renderer$1.colorMask.setMask(15)),this._maskStackHash[renderTargetUid]=maskStackIndex}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}};StencilMaskPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`stencilMask`};var BUFFER_TYPE=(BUFFER_TYPE2=>(BUFFER_TYPE2[BUFFER_TYPE2.ELEMENT_ARRAY_BUFFER=34963]=`ELEMENT_ARRAY_BUFFER`,BUFFER_TYPE2[BUFFER_TYPE2.ARRAY_BUFFER=34962]=`ARRAY_BUFFER`,BUFFER_TYPE2[BUFFER_TYPE2.UNIFORM_BUFFER=35345]=`UNIFORM_BUFFER`,BUFFER_TYPE2))(BUFFER_TYPE||{}),GlBuffer=class{constructor(buffer,type){this._lastBindBaseLocation=-1,this._lastBindCallId=-1,this.buffer=buffer||null,this.updateID=-1,this.byteLength=-1,this.type=type}},GlBufferSystem=class{constructor(renderer$1){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._minBaseLocation=0,this._nextBindBaseIndex=this._minBaseLocation,this._bindCallId=0,this._renderer=renderer$1,this._renderer.renderableGC.addManagedHash(this,`_gpuBuffers`)}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gl=this._renderer.gl,this._gpuBuffers=Object.create(null),this._maxBindings=this._renderer.limits.maxUniformBindings}getGlBuffer(buffer){return this._gpuBuffers[buffer.uid]||this.createGLBuffer(buffer)}bind(buffer){let{_gl:gl}=this,glBuffer=this.getGlBuffer(buffer);gl.bindBuffer(glBuffer.type,glBuffer.buffer)}bindBufferBase(glBuffer,index){let{_gl:gl}=this;this._boundBufferBases[index]!==glBuffer&&(this._boundBufferBases[index]=glBuffer,glBuffer._lastBindBaseLocation=index,gl.bindBufferBase(gl.UNIFORM_BUFFER,index,glBuffer.buffer))}nextBindBase(hasTransformFeedback){this._bindCallId++,this._minBaseLocation=0,hasTransformFeedback&&(this._boundBufferBases[0]=null,this._minBaseLocation=1,this._nextBindBaseIndex<1&&(this._nextBindBaseIndex=1))}freeLocationForBufferBase(glBuffer){let freeIndex=this.getLastBindBaseLocation(glBuffer);if(freeIndex>=this._minBaseLocation)return glBuffer._lastBindCallId=this._bindCallId,freeIndex;let loop=0,nextIndex=this._nextBindBaseIndex;for(;loop<2;){nextIndex>=this._maxBindings&&(nextIndex=this._minBaseLocation,loop++);let curBuf=this._boundBufferBases[nextIndex];if(curBuf&&curBuf._lastBindCallId===this._bindCallId){nextIndex++;continue}break}return freeIndex=nextIndex,this._nextBindBaseIndex=nextIndex+1,loop>=2?-1:(glBuffer._lastBindCallId=this._bindCallId,this._boundBufferBases[freeIndex]=null,freeIndex)}getLastBindBaseLocation(glBuffer){let index=glBuffer._lastBindBaseLocation;return this._boundBufferBases[index]===glBuffer?index:-1}bindBufferRange(glBuffer,index,offset,size){let{_gl:gl}=this;offset||=0,index||=0,this._boundBufferBases[index]=null,gl.bindBufferRange(gl.UNIFORM_BUFFER,index||0,glBuffer.buffer,offset*256,size||256)}updateBuffer(buffer){let{_gl:gl}=this,glBuffer=this.getGlBuffer(buffer);if(buffer._updateID===glBuffer.updateID)return glBuffer;glBuffer.updateID=buffer._updateID,gl.bindBuffer(glBuffer.type,glBuffer.buffer);let data=buffer.data,drawType=buffer.descriptor.usage&BufferUsage.STATIC?gl.STATIC_DRAW:gl.DYNAMIC_DRAW;return data?glBuffer.byteLength>=data.byteLength?gl.bufferSubData(glBuffer.type,0,data,0,buffer._updateSize/data.BYTES_PER_ELEMENT):(glBuffer.byteLength=data.byteLength,gl.bufferData(glBuffer.type,data,drawType)):(glBuffer.byteLength=buffer.descriptor.size,gl.bufferData(glBuffer.type,glBuffer.byteLength,drawType)),glBuffer}destroyAll(){let gl=this._gl;for(let id in this._gpuBuffers)gl.deleteBuffer(this._gpuBuffers[id].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(buffer,contextLost){let glBuffer=this._gpuBuffers[buffer.uid],gl=this._gl;contextLost||gl.deleteBuffer(glBuffer.buffer),this._gpuBuffers[buffer.uid]=null}createGLBuffer(buffer){let{_gl:gl}=this,type=BUFFER_TYPE.ARRAY_BUFFER;buffer.descriptor.usage&BufferUsage.INDEX?type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:buffer.descriptor.usage&BufferUsage.UNIFORM&&(type=BUFFER_TYPE.UNIFORM_BUFFER);let glBuffer=new GlBuffer(gl.createBuffer(),type);return this._gpuBuffers[buffer.uid]=glBuffer,buffer.on(`destroy`,this.onBufferDestroy,this),glBuffer}resetState(){this._boundBufferBases=Object.create(null)}};GlBufferSystem.extension={type:[ExtensionType.WebGLSystem],name:`buffer`};var _GlContextSystem=class _GlContextSystem$1{constructor(renderer$1){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=renderer$1,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(gl){this.gl=gl,this._renderer.gl=gl}init(options){options={..._GlContextSystem$1.defaultOptions,...options};let multiView=this.multiView=options.multiView;if(options.context&&multiView&&(warn$1(`Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together.`),multiView=!1),multiView?this.canvas=DOMAdapter.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this.canvas=this._renderer.view.canvas,options.context)this.initFromContext(options.context);else{let alpha=this._renderer.background.alpha<1,premultipliedAlpha=options.premultipliedAlpha??!0,antialias=options.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(options.preferWebGLVersion,{alpha,premultipliedAlpha,antialias,stencil:!0,preserveDrawingBuffer:options.preserveDrawingBuffer,powerPreference:options.powerPreference??`default`})}}ensureCanvasSize(targetCanvas){if(!this.multiView){targetCanvas!==this.canvas&&warn$1(`multiView is disabled, but targetCanvas is not the main canvas`);return}let{canvas}=this;(canvas.width<targetCanvas.width||canvas.height<targetCanvas.height)&&(canvas.width=Math.max(targetCanvas.width,targetCanvas.width),canvas.height=Math.max(targetCanvas.height,targetCanvas.height))}initFromContext(gl){this.gl=gl,this.webGLVersion=gl instanceof DOMAdapter.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(gl),this._renderer.runners.contextChange.emit(gl);let element=this._renderer.view.canvas;element.addEventListener(`webglcontextlost`,this.handleContextLost,!1),element.addEventListener(`webglcontextrestored`,this.handleContextRestored,!1)}createContext(preferWebGLVersion,options){let gl,canvas=this.canvas;if(preferWebGLVersion===2&&(gl=canvas.getContext(`webgl2`,options)),!gl&&(gl=canvas.getContext(`webgl`,options),!gl))throw Error(`This browser does not support WebGL. Try using the canvas renderer`);this.gl=gl,this.initFromContext(this.gl)}getExtensions(){let{gl}=this,common={anisotropicFiltering:gl.getExtension(`EXT_texture_filter_anisotropic`),floatTextureLinear:gl.getExtension(`OES_texture_float_linear`),s3tc:gl.getExtension(`WEBGL_compressed_texture_s3tc`),s3tc_sRGB:gl.getExtension(`WEBGL_compressed_texture_s3tc_srgb`),etc:gl.getExtension(`WEBGL_compressed_texture_etc`),etc1:gl.getExtension(`WEBGL_compressed_texture_etc1`),pvrtc:gl.getExtension(`WEBGL_compressed_texture_pvrtc`)||gl.getExtension(`WEBKIT_WEBGL_compressed_texture_pvrtc`),atc:gl.getExtension(`WEBGL_compressed_texture_atc`),astc:gl.getExtension(`WEBGL_compressed_texture_astc`),bptc:gl.getExtension(`EXT_texture_compression_bptc`),rgtc:gl.getExtension(`EXT_texture_compression_rgtc`),loseContext:gl.getExtension(`WEBGL_lose_context`)};if(this.webGLVersion===1)this.extensions={...common,drawBuffers:gl.getExtension(`WEBGL_draw_buffers`),depthTexture:gl.getExtension(`WEBGL_depth_texture`),vertexArrayObject:gl.getExtension(`OES_vertex_array_object`)||gl.getExtension(`MOZ_OES_vertex_array_object`)||gl.getExtension(`WEBKIT_OES_vertex_array_object`),uint32ElementIndex:gl.getExtension(`OES_element_index_uint`),floatTexture:gl.getExtension(`OES_texture_float`),floatTextureLinear:gl.getExtension(`OES_texture_float_linear`),textureHalfFloat:gl.getExtension(`OES_texture_half_float`),textureHalfFloatLinear:gl.getExtension(`OES_texture_half_float_linear`),vertexAttribDivisorANGLE:gl.getExtension(`ANGLE_instanced_arrays`),srgb:gl.getExtension(`EXT_sRGB`)};else{this.extensions={...common,colorBufferFloat:gl.getExtension(`EXT_color_buffer_float`)};let provokeExt=gl.getExtension(`WEBGL_provoking_vertex`);provokeExt&&provokeExt.provokingVertexWEBGL(provokeExt.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(event){event.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this.getExtensions(),this._renderer.runners.contextChange.emit(this.gl)}destroy(){let element=this._renderer.view.canvas;this._renderer=null,element.removeEventListener(`webglcontextlost`,this.handleContextLost),element.removeEventListener(`webglcontextrestored`,this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(gl){let attributes=gl.getContextAttributes();attributes&&!attributes.stencil&&warn$1(`Provided WebGL context does not have a stencil buffer, masks may not render correctly`);let supports=this.supports,isWebGl2=this.webGLVersion===2,extensions$2=this.extensions;supports.uint32Indices=isWebGl2||!!extensions$2.uint32ElementIndex,supports.uniformBufferObject=isWebGl2,supports.vertexArrayObject=isWebGl2||!!extensions$2.vertexArrayObject,supports.srgbTextures=isWebGl2||!!extensions$2.srgb,supports.nonPowOf2wrapping=isWebGl2,supports.nonPowOf2mipmaps=isWebGl2,supports.msaa=isWebGl2,supports.uint32Indices||warn$1(`Provided WebGL context does not support 32 index buffer, large scenes may not render correctly`)}};_GlContextSystem.extension={type:[ExtensionType.WebGLSystem],name:`context`},_GlContextSystem.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};var GlContextSystem=_GlContextSystem;function ensureAttributes(geometry,extractedData){for(let i$1 in geometry.attributes){let attribute=geometry.attributes[i$1],attributeData=extractedData[i$1];attributeData?(attribute.format??=attributeData.format,attribute.offset??=attributeData.offset,attribute.instance??=attributeData.instance):warn$1(`Attribute ${i$1} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}ensureStartAndStride(geometry)}function ensureStartAndStride(geometry){let{buffers,attributes}=geometry,tempStride={},tempStart={};for(let j$1 in buffers){let buffer=buffers[j$1];tempStride[buffer.uid]=0,tempStart[buffer.uid]=0}for(let j$1 in attributes){let attribute=attributes[j$1];tempStride[attribute.buffer.uid]+=getAttributeInfoFromFormat(attribute.format).stride}for(let j$1 in attributes){let attribute=attributes[j$1];attribute.stride??=tempStride[attribute.buffer.uid],attribute.start??=tempStart[attribute.buffer.uid],tempStart[attribute.buffer.uid]+=getAttributeInfoFromFormat(attribute.format).stride}}var GL_FORMATS=(GL_FORMATS2=>(GL_FORMATS2[GL_FORMATS2.RGBA=6408]=`RGBA`,GL_FORMATS2[GL_FORMATS2.RGB=6407]=`RGB`,GL_FORMATS2[GL_FORMATS2.RG=33319]=`RG`,GL_FORMATS2[GL_FORMATS2.RED=6403]=`RED`,GL_FORMATS2[GL_FORMATS2.RGBA_INTEGER=36249]=`RGBA_INTEGER`,GL_FORMATS2[GL_FORMATS2.RGB_INTEGER=36248]=`RGB_INTEGER`,GL_FORMATS2[GL_FORMATS2.RG_INTEGER=33320]=`RG_INTEGER`,GL_FORMATS2[GL_FORMATS2.RED_INTEGER=36244]=`RED_INTEGER`,GL_FORMATS2[GL_FORMATS2.ALPHA=6406]=`ALPHA`,GL_FORMATS2[GL_FORMATS2.LUMINANCE=6409]=`LUMINANCE`,GL_FORMATS2[GL_FORMATS2.LUMINANCE_ALPHA=6410]=`LUMINANCE_ALPHA`,GL_FORMATS2[GL_FORMATS2.DEPTH_COMPONENT=6402]=`DEPTH_COMPONENT`,GL_FORMATS2[GL_FORMATS2.DEPTH_STENCIL=34041]=`DEPTH_STENCIL`,GL_FORMATS2))(GL_FORMATS||{}),GL_TARGETS=(GL_TARGETS2=>(GL_TARGETS2[GL_TARGETS2.TEXTURE_2D=3553]=`TEXTURE_2D`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP=34067]=`TEXTURE_CUBE_MAP`,GL_TARGETS2[GL_TARGETS2.TEXTURE_2D_ARRAY=35866]=`TEXTURE_2D_ARRAY`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_X=34069]=`TEXTURE_CUBE_MAP_POSITIVE_X`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]=`TEXTURE_CUBE_MAP_NEGATIVE_X`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]=`TEXTURE_CUBE_MAP_POSITIVE_Y`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]=`TEXTURE_CUBE_MAP_NEGATIVE_Y`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]=`TEXTURE_CUBE_MAP_POSITIVE_Z`,GL_TARGETS2[GL_TARGETS2.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]=`TEXTURE_CUBE_MAP_NEGATIVE_Z`,GL_TARGETS2))(GL_TARGETS||{}),GL_TYPES=(GL_TYPES2=>(GL_TYPES2[GL_TYPES2.UNSIGNED_BYTE=5121]=`UNSIGNED_BYTE`,GL_TYPES2[GL_TYPES2.UNSIGNED_SHORT=5123]=`UNSIGNED_SHORT`,GL_TYPES2[GL_TYPES2.UNSIGNED_SHORT_5_6_5=33635]=`UNSIGNED_SHORT_5_6_5`,GL_TYPES2[GL_TYPES2.UNSIGNED_SHORT_4_4_4_4=32819]=`UNSIGNED_SHORT_4_4_4_4`,GL_TYPES2[GL_TYPES2.UNSIGNED_SHORT_5_5_5_1=32820]=`UNSIGNED_SHORT_5_5_5_1`,GL_TYPES2[GL_TYPES2.UNSIGNED_INT=5125]=`UNSIGNED_INT`,GL_TYPES2[GL_TYPES2.UNSIGNED_INT_10F_11F_11F_REV=35899]=`UNSIGNED_INT_10F_11F_11F_REV`,GL_TYPES2[GL_TYPES2.UNSIGNED_INT_2_10_10_10_REV=33640]=`UNSIGNED_INT_2_10_10_10_REV`,GL_TYPES2[GL_TYPES2.UNSIGNED_INT_24_8=34042]=`UNSIGNED_INT_24_8`,GL_TYPES2[GL_TYPES2.UNSIGNED_INT_5_9_9_9_REV=35902]=`UNSIGNED_INT_5_9_9_9_REV`,GL_TYPES2[GL_TYPES2.BYTE=5120]=`BYTE`,GL_TYPES2[GL_TYPES2.SHORT=5122]=`SHORT`,GL_TYPES2[GL_TYPES2.INT=5124]=`INT`,GL_TYPES2[GL_TYPES2.FLOAT=5126]=`FLOAT`,GL_TYPES2[GL_TYPES2.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]=`FLOAT_32_UNSIGNED_INT_24_8_REV`,GL_TYPES2[GL_TYPES2.HALF_FLOAT=36193]=`HALF_FLOAT`,GL_TYPES2))(GL_TYPES||{}),infoMap={uint8x2:GL_TYPES.UNSIGNED_BYTE,uint8x4:GL_TYPES.UNSIGNED_BYTE,sint8x2:GL_TYPES.BYTE,sint8x4:GL_TYPES.BYTE,unorm8x2:GL_TYPES.UNSIGNED_BYTE,unorm8x4:GL_TYPES.UNSIGNED_BYTE,snorm8x2:GL_TYPES.BYTE,snorm8x4:GL_TYPES.BYTE,uint16x2:GL_TYPES.UNSIGNED_SHORT,uint16x4:GL_TYPES.UNSIGNED_SHORT,sint16x2:GL_TYPES.SHORT,sint16x4:GL_TYPES.SHORT,unorm16x2:GL_TYPES.UNSIGNED_SHORT,unorm16x4:GL_TYPES.UNSIGNED_SHORT,snorm16x2:GL_TYPES.SHORT,snorm16x4:GL_TYPES.SHORT,float16x2:GL_TYPES.HALF_FLOAT,float16x4:GL_TYPES.HALF_FLOAT,float32:GL_TYPES.FLOAT,float32x2:GL_TYPES.FLOAT,float32x3:GL_TYPES.FLOAT,float32x4:GL_TYPES.FLOAT,uint32:GL_TYPES.UNSIGNED_INT,uint32x2:GL_TYPES.UNSIGNED_INT,uint32x3:GL_TYPES.UNSIGNED_INT,uint32x4:GL_TYPES.UNSIGNED_INT,sint32:GL_TYPES.INT,sint32x2:GL_TYPES.INT,sint32x3:GL_TYPES.INT,sint32x4:GL_TYPES.INT};function getGlTypeFromFormat(format$1){return infoMap[format$1]??infoMap.float32}var topologyToGlMap={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5},GlGeometrySystem=class{constructor(renderer$1){this._geometryVaoHash=Object.create(null),this._renderer=renderer$1,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this._renderer.renderableGC.addManagedHash(this,`_geometryVaoHash`)}contextChange(){let gl=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw Error(`[PixiJS] Vertex Array Objects are not supported on this device`);let nativeVaoExtension=this._renderer.context.extensions.vertexArrayObject;nativeVaoExtension&&(gl.createVertexArray=()=>nativeVaoExtension.createVertexArrayOES(),gl.bindVertexArray=vao=>nativeVaoExtension.bindVertexArrayOES(vao),gl.deleteVertexArray=vao=>nativeVaoExtension.deleteVertexArrayOES(vao));let nativeInstancedExtension=this._renderer.context.extensions.vertexAttribDivisorANGLE;nativeInstancedExtension&&(gl.drawArraysInstanced=(a$1,b$1,c$2,d$1)=>{nativeInstancedExtension.drawArraysInstancedANGLE(a$1,b$1,c$2,d$1)},gl.drawElementsInstanced=(a$1,b$1,c$2,d$1,e$2)=>{nativeInstancedExtension.drawElementsInstancedANGLE(a$1,b$1,c$2,d$1,e$2)},gl.vertexAttribDivisor=(a$1,b$1)=>nativeInstancedExtension.vertexAttribDivisorANGLE(a$1,b$1)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(geometry,program){let gl=this.gl;this._activeGeometry=geometry;let vao=this.getVao(geometry,program);this._activeVao!==vao&&(this._activeVao=vao,gl.bindVertexArray(vao)),this.updateBuffers()}resetState(){this.unbind()}updateBuffers(){let geometry=this._activeGeometry,bufferSystem=this._renderer.buffer;for(let i$1=0;i$1<geometry.buffers.length;i$1++){let buffer=geometry.buffers[i$1];bufferSystem.updateBuffer(buffer)}}checkCompatibility(geometry,program){let geometryAttributes=geometry.attributes,shaderAttributes=program._attributeData;for(let j$1 in shaderAttributes)if(!geometryAttributes[j$1])throw Error(`shader and geometry incompatible, geometry missing the "${j$1}" attribute`)}getSignature(geometry,program){let attribs=geometry.attributes,shaderAttributes=program._attributeData,strings$2=[`g`,geometry.uid];for(let i$1 in attribs)shaderAttributes[i$1]&&strings$2.push(i$1,shaderAttributes[i$1].location);return strings$2.join(`-`)}getVao(geometry,program){return this._geometryVaoHash[geometry.uid]?.[program._key]||this.initGeometryVao(geometry,program)}initGeometryVao(geometry,program,_incRefCount=!0){let gl=this._renderer.gl,bufferSystem=this._renderer.buffer;this._renderer.shader._getProgramData(program),this.checkCompatibility(geometry,program);let signature=this.getSignature(geometry,program);this._geometryVaoHash[geometry.uid]||(this._geometryVaoHash[geometry.uid]=Object.create(null),geometry.on(`destroy`,this.onGeometryDestroy,this));let vaoObjectHash=this._geometryVaoHash[geometry.uid],vao=vaoObjectHash[signature];if(vao)return vaoObjectHash[program._key]=vao,vao;ensureAttributes(geometry,program._attributeData);let buffers=geometry.buffers;vao=gl.createVertexArray(),gl.bindVertexArray(vao);for(let i$1=0;i$1<buffers.length;i$1++){let buffer=buffers[i$1];bufferSystem.bind(buffer)}return this.activateVao(geometry,program),vaoObjectHash[program._key]=vao,vaoObjectHash[signature]=vao,gl.bindVertexArray(null),vao}onGeometryDestroy(geometry,contextLost){let vaoObjectHash=this._geometryVaoHash[geometry.uid],gl=this.gl;if(vaoObjectHash){if(contextLost)for(let i$1 in vaoObjectHash)this._activeVao!==vaoObjectHash[i$1]&&this.unbind(),gl.deleteVertexArray(vaoObjectHash[i$1]);this._geometryVaoHash[geometry.uid]=null}}destroyAll(contextLost=!1){let gl=this.gl;for(let i$1 in this._geometryVaoHash){if(contextLost)for(let j$1 in this._geometryVaoHash[i$1]){let vaoObjectHash=this._geometryVaoHash[i$1];this._activeVao!==vaoObjectHash&&this.unbind(),gl.deleteVertexArray(vaoObjectHash[j$1])}this._geometryVaoHash[i$1]=null}}activateVao(geometry,program){let gl=this._renderer.gl,bufferSystem=this._renderer.buffer,attributes=geometry.attributes;geometry.indexBuffer&&bufferSystem.bind(geometry.indexBuffer);let lastBuffer=null;for(let j$1 in attributes){let attribute=attributes[j$1],buffer=attribute.buffer,glBuffer=bufferSystem.getGlBuffer(buffer),programAttrib=program._attributeData[j$1];if(programAttrib){lastBuffer!==glBuffer&&(bufferSystem.bind(buffer),lastBuffer=glBuffer);let location$1=programAttrib.location;gl.enableVertexAttribArray(location$1);let attributeInfo=getAttributeInfoFromFormat(attribute.format),type=getGlTypeFromFormat(attribute.format);if(programAttrib.format?.substring(1,4)===`int`?gl.vertexAttribIPointer(location$1,attributeInfo.size,type,attribute.stride,attribute.offset):gl.vertexAttribPointer(location$1,attributeInfo.size,type,attributeInfo.normalised,attribute.stride,attribute.offset),attribute.instance)if(this.hasInstance){let divisor=attribute.divisor??1;gl.vertexAttribDivisor(location$1,divisor)}else throw Error(`geometry error, GPU Instancing is not supported on this device`)}}}draw(topology,size,start$1,instanceCount){let{gl}=this._renderer,geometry=this._activeGeometry,glTopology=topologyToGlMap[topology||geometry.topology];if(instanceCount??=geometry.instanceCount,geometry.indexBuffer){let byteSize=geometry.indexBuffer.data.BYTES_PER_ELEMENT,glType=byteSize===2?gl.UNSIGNED_SHORT:gl.UNSIGNED_INT;instanceCount===1?gl.drawElements(glTopology,size||geometry.indexBuffer.data.length,glType,(start$1||0)*byteSize):gl.drawElementsInstanced(glTopology,size||geometry.indexBuffer.data.length,glType,(start$1||0)*byteSize,instanceCount)}else instanceCount===1?gl.drawArrays(glTopology,start$1||0,size||geometry.getSize()):gl.drawArraysInstanced(glTopology,start$1||0,size||geometry.getSize(),instanceCount);return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null,this._geometryVaoHash=null}};GlGeometrySystem.extension={type:[ExtensionType.WebGLSystem],name:`geometry`};var bigTriangleGeometry=new Geometry({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),_GlBackBufferSystem=class _GlBackBufferSystem$1{constructor(renderer$1){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=renderer$1}init(options={}){let{useBackBuffer,antialias}={..._GlBackBufferSystem$1.defaultOptions,...options};this.useBackBuffer=useBackBuffer,this._antialias=antialias,this._renderer.context.supports.msaa||(warn$1(`antialiasing, is not supported on when using the back buffer`),this._antialias=!1),this._state=State.for2d();let bigTriangleProgram=new GlProgram({vertex:`
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,fragment:`
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,name:`big-triangle`});this._bigTriangleShader=new Shader({glProgram:bigTriangleProgram,resources:{uTexture:Texture.WHITE.source}})}renderStart(options){let renderTarget=this._renderer.renderTarget.getRenderTarget(options.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!renderTarget.isRoot,this._useBackBufferThisRender){let renderTarget2=this._renderer.renderTarget.getRenderTarget(options.target);this._targetTexture=renderTarget2.colorTexture,options.target=this._getBackBufferTexture(renderTarget2.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){let renderer$1=this._renderer;renderer$1.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(renderer$1.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,renderer$1.encoder.draw({geometry:bigTriangleGeometry,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(targetSourceTexture){return this._backBufferTexture=this._backBufferTexture||new Texture({source:new TextureSource({width:targetSourceTexture.width,height:targetSourceTexture.height,resolution:targetSourceTexture._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(targetSourceTexture.width,targetSourceTexture.height,targetSourceTexture._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&=(this._backBufferTexture.destroy(),null)}};_GlBackBufferSystem.extension={type:[ExtensionType.WebGLSystem],name:`backBuffer`,priority:1},_GlBackBufferSystem.defaultOptions={useBackBuffer:!1};var GlBackBufferSystem=_GlBackBufferSystem,GlColorMaskSystem=class{constructor(renderer$1){this._colorMaskCache=15,this._renderer=renderer$1}setMask(colorMask){this._colorMaskCache!==colorMask&&(this._colorMaskCache=colorMask,this._renderer.gl.colorMask(!!(colorMask&8),!!(colorMask&4),!!(colorMask&2),!!(colorMask&1)))}};GlColorMaskSystem.extension={type:[ExtensionType.WebGLSystem],name:`colorMask`};var GlEncoderSystem=class{constructor(renderer$1){this.commandFinished=Promise.resolve(),this._renderer=renderer$1}setGeometry(geometry,shader){this._renderer.geometry.bind(geometry,shader.glProgram)}finishRenderPass(){}draw(options){let renderer$1=this._renderer,{geometry,shader,state,skipSync,topology:type,size,start:start$1,instanceCount}=options;renderer$1.shader.bind(shader,skipSync),renderer$1.geometry.bind(geometry,renderer$1.shader._activeProgram),state&&renderer$1.state.set(state),renderer$1.geometry.draw(type,size,start$1,instanceCount??geometry.instanceCount)}destroy(){this._renderer=null}};GlEncoderSystem.extension={type:[ExtensionType.WebGLSystem],name:`encoder`};var GlLimitsSystem=class{constructor(renderer$1){this._renderer=renderer$1}contextChange(){let gl=this._renderer.gl;this.maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),this.maxBatchableTextures=checkMaxIfStatementsInShader(this.maxTextures,gl),this.maxUniformBindings=this._renderer.context.webGLVersion===2?gl.getParameter(gl.MAX_UNIFORM_BUFFER_BINDINGS):0}destroy(){}};GlLimitsSystem.extension={type:[ExtensionType.WebGLSystem],name:`limits`};var GlRenderTarget=class{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}},GpuStencilModesToPixi=[];GpuStencilModesToPixi[STENCIL_MODES.NONE]=void 0,GpuStencilModesToPixi[STENCIL_MODES.DISABLED]={stencilWriteMask:0,stencilReadMask:0},GpuStencilModesToPixi[STENCIL_MODES.RENDERING_MASK_ADD]={stencilFront:{compare:`equal`,passOp:`increment-clamp`},stencilBack:{compare:`equal`,passOp:`increment-clamp`}},GpuStencilModesToPixi[STENCIL_MODES.RENDERING_MASK_REMOVE]={stencilFront:{compare:`equal`,passOp:`decrement-clamp`},stencilBack:{compare:`equal`,passOp:`decrement-clamp`}},GpuStencilModesToPixi[STENCIL_MODES.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:`equal`,passOp:`keep`},stencilBack:{compare:`equal`,passOp:`keep`}},GpuStencilModesToPixi[STENCIL_MODES.INVERSE_MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:`not-equal`,passOp:`keep`},stencilBack:{compare:`not-equal`,passOp:`keep`}};var GlStencilSystem=class{constructor(renderer$1){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:STENCIL_MODES.NONE},this._renderTargetStencilState=Object.create(null),renderer$1.renderTarget.onRenderTargetChange.add(this)}contextChange(gl){this._gl=gl,this._comparisonFuncMapping={always:gl.ALWAYS,never:gl.NEVER,equal:gl.EQUAL,"not-equal":gl.NOTEQUAL,less:gl.LESS,"less-equal":gl.LEQUAL,greater:gl.GREATER,"greater-equal":gl.GEQUAL},this._stencilOpsMapping={keep:gl.KEEP,zero:gl.ZERO,replace:gl.REPLACE,invert:gl.INVERT,"increment-clamp":gl.INCR,"decrement-clamp":gl.DECR,"increment-wrap":gl.INCR_WRAP,"decrement-wrap":gl.DECR_WRAP},this.resetState()}onRenderTargetChange(renderTarget){if(this._activeRenderTarget===renderTarget)return;this._activeRenderTarget=renderTarget;let stencilState=this._renderTargetStencilState[renderTarget.uid];stencilState||=this._renderTargetStencilState[renderTarget.uid]={stencilMode:STENCIL_MODES.DISABLED,stencilReference:0},this.setStencilMode(stencilState.stencilMode,stencilState.stencilReference)}resetState(){this._stencilCache.enabled=!1,this._stencilCache.stencilMode=STENCIL_MODES.NONE,this._stencilCache.stencilReference=0}setStencilMode(stencilMode,stencilReference){let stencilState=this._renderTargetStencilState[this._activeRenderTarget.uid],gl=this._gl,mode=GpuStencilModesToPixi[stencilMode],_stencilCache=this._stencilCache;if(stencilState.stencilMode=stencilMode,stencilState.stencilReference=stencilReference,stencilMode===STENCIL_MODES.DISABLED){this._stencilCache.enabled&&(this._stencilCache.enabled=!1,gl.disable(gl.STENCIL_TEST));return}this._stencilCache.enabled||(this._stencilCache.enabled=!0,gl.enable(gl.STENCIL_TEST)),(stencilMode!==_stencilCache.stencilMode||_stencilCache.stencilReference!==stencilReference)&&(_stencilCache.stencilMode=stencilMode,_stencilCache.stencilReference=stencilReference,gl.stencilFunc(this._comparisonFuncMapping[mode.stencilBack.compare],stencilReference,255),gl.stencilOp(gl.KEEP,gl.KEEP,this._stencilOpsMapping[mode.stencilBack.passOp]))}};GlStencilSystem.extension={type:[ExtensionType.WebGLSystem],name:`stencil`};var UboSystem=class{constructor(adaptor){this._syncFunctionHash=Object.create(null),this._adaptor=adaptor,this._systemCheck()}_systemCheck(){if(!unsafeEvalSupported())throw Error(`Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.`)}ensureUniformGroup(uniformGroup){let uniformData=this.getUniformGroupData(uniformGroup);uniformGroup.buffer||=new Buffer$1({data:new Float32Array(uniformData.layout.size/4),usage:BufferUsage.UNIFORM|BufferUsage.COPY_DST})}getUniformGroupData(uniformGroup){return this._syncFunctionHash[uniformGroup._signature]||this._initUniformGroup(uniformGroup)}_initUniformGroup(uniformGroup){let uniformGroupSignature=uniformGroup._signature,uniformData=this._syncFunctionHash[uniformGroupSignature];if(!uniformData){let elements=Object.keys(uniformGroup.uniformStructures).map(i$1=>uniformGroup.uniformStructures[i$1]),layout$2=this._adaptor.createUboElements(elements),syncFunction=this._generateUboSync(layout$2.uboElements);uniformData=this._syncFunctionHash[uniformGroupSignature]={layout:layout$2,syncFunction}}return this._syncFunctionHash[uniformGroupSignature]}_generateUboSync(uboElements){return this._adaptor.generateUboSync(uboElements)}syncUniformGroup(uniformGroup,data,offset){let uniformGroupData=this.getUniformGroupData(uniformGroup);uniformGroup.buffer||=new Buffer$1({data:new Float32Array(uniformGroupData.layout.size/4),usage:BufferUsage.UNIFORM|BufferUsage.COPY_DST});let dataInt32=null;return data||(data=uniformGroup.buffer.data,dataInt32=uniformGroup.buffer.dataInt32),offset||=0,uniformGroupData.syncFunction(uniformGroup.uniforms,data,dataInt32,offset),!0}updateUniformGroup(uniformGroup){if(uniformGroup.isStatic&&!uniformGroup._dirtyId)return!1;uniformGroup._dirtyId=0;let synced=this.syncUniformGroup(uniformGroup);return uniformGroup.buffer.update(),synced}destroy(){this._syncFunctionHash=null}},WGSL_TO_STD40_SIZE={f32:4,i32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"vec2<i32>":8,"vec3<i32>":12,"vec4<i32>":16,"mat2x2<f32>":32,"mat3x3<f32>":48,"mat4x4<f32>":64};function createUboElementsSTD40(uniformData){let uboElements=uniformData.map(data=>({data,offset:0,size:0})),chunkSize=16,size=0,offset=0;for(let i$1=0;i$1<uboElements.length;i$1++){let uboElement=uboElements[i$1];if(size=WGSL_TO_STD40_SIZE[uboElement.data.type],!size)throw Error(`Unknown type ${uboElement.data.type}`);uboElement.data.size>1&&(size=Math.max(size,16)*uboElement.data.size);let boundary=size===12?16:size;uboElement.size=size;let curOffset=offset%16;curOffset>0&&16-curOffset<boundary?offset+=(16-curOffset)%16:offset+=(size-curOffset%size)%size,uboElement.offset=offset,offset+=size}return offset=Math.ceil(offset/16)*16,{uboElements,size:offset}}var uniformParsers=[{type:`mat3x3<f32>`,test:data=>data.value.a!==void 0,ubo:`
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,uniform:`
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `},{type:`vec4<f32>`,test:data=>data.type===`vec4<f32>`&&data.size===1&&data.value.width!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `},{type:`vec2<f32>`,test:data=>data.type===`vec2<f32>`&&data.size===1&&data.value.x!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `},{type:`vec4<f32>`,test:data=>data.type===`vec4<f32>`&&data.size===1&&data.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `},{type:`vec3<f32>`,test:data=>data.type===`vec3<f32>`&&data.size===1&&data.value.red!==void 0,ubo:`
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,uniform:`
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `}];function createUboSyncFunction(uboElements,parserCode,arrayGenerationFunction,singleSettersMap){let funcFragments=[`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `],prev=0;for(let i$1=0;i$1<uboElements.length;i$1++){let uboElement=uboElements[i$1],name=uboElement.data.name,parsed=!1,offset=0;for(let j$1=0;j$1<uniformParsers.length;j$1++)if(uniformParsers[j$1].test(uboElement.data)){offset=uboElement.offset/4,funcFragments.push(`name = "${name}";`,`offset += ${offset-prev};`,uniformParsers[j$1][parserCode]||uniformParsers[j$1].ubo),parsed=!0;break}if(!parsed)if(uboElement.data.size>1)offset=uboElement.offset/4,funcFragments.push(arrayGenerationFunction(uboElement,offset-prev));else{let template=singleSettersMap[uboElement.data.type];offset=uboElement.offset/4,funcFragments.push(`
                    v = uv.${name};
                    offset += ${offset-prev};
                    ${template};
                `)}prev=offset}let fragmentSrc=funcFragments.join(`
`);return Function(`uv`,`data`,`dataInt32`,`offset`,fragmentSrc)}function loopMatrix(col,row){return`
        for (let i = 0; i < ${col*row}; i++) {
            data[offset + (((i / ${col})|0) * 4) + (i % ${col})] = v[i];
        }
    `}var uboSyncFunctionsSTD40={f32:`
        data[offset] = v;`,i32:`
        dataInt32[offset] = v;`,"vec2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];`,"vec3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,"vec4<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,"vec2<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];`,"vec3<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];`,"vec4<i32>":`
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];
        dataInt32[offset + 3] = v[3];`,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,"mat3x3<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,"mat4x4<f32>":`
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,"mat3x2<f32>":loopMatrix(3,2),"mat4x2<f32>":loopMatrix(4,2),"mat2x3<f32>":loopMatrix(2,3),"mat4x3<f32>":loopMatrix(4,3),"mat2x4<f32>":loopMatrix(2,4),"mat3x4<f32>":loopMatrix(3,4)},uboSyncFunctionsWGSL={...uboSyncFunctionsSTD40,"mat2x2<f32>":`
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];
    `};function generateArraySyncSTD40(uboElement,offsetToAdd){let rowSize=Math.max(WGSL_TO_STD40_SIZE[uboElement.data.type]/16,1),elementSize=uboElement.data.value.length/uboElement.data.size,remainder=(4-elementSize%4)%4,data=uboElement.data.type.indexOf(`i32`)>=0?`dataInt32`:`data`;return`
        v = uv.${uboElement.data.name};
        offset += ${offsetToAdd};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${uboElement.data.size*rowSize}; i++)
        {
            for(var j = 0; j < ${elementSize}; j++)
            {
                ${data}[arrayOffset++] = v[t++];
            }
            ${remainder===0?``:`arrayOffset += ${remainder};`}
        }
    `}function createUboSyncFunctionSTD40(uboElements){return createUboSyncFunction(uboElements,`uboStd40`,generateArraySyncSTD40,uboSyncFunctionsSTD40)}var GlUboSystem=class extends UboSystem{constructor(){super({createUboElements:createUboElementsSTD40,generateUboSync:createUboSyncFunctionSTD40})}};GlUboSystem.extension={type:[ExtensionType.WebGLSystem],name:`ubo`};var GlRenderTargetAdaptor=class{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Rectangle}init(renderer$1,renderTargetSystem){this._renderer=renderer$1,this._renderTargetSystem=renderTargetSystem,renderer$1.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new Rectangle}copyToTexture(sourceRenderSurfaceTexture,destinationTexture,originSrc,size,originDest){let renderTargetSystem=this._renderTargetSystem,renderer$1=this._renderer,glRenderTarget=renderTargetSystem.getGpuRenderTarget(sourceRenderSurfaceTexture),gl=renderer$1.gl;return this.finishRenderPass(sourceRenderSurfaceTexture),gl.bindFramebuffer(gl.FRAMEBUFFER,glRenderTarget.resolveTargetFramebuffer),renderer$1.texture.bind(destinationTexture,0),gl.copyTexSubImage2D(gl.TEXTURE_2D,0,originDest.x,originDest.y,originSrc.x,originSrc.y,size.width,size.height),destinationTexture}startRenderPass(renderTarget,clear$1=!0,clearColor,viewport){let renderTargetSystem=this._renderTargetSystem,source$2=renderTarget.colorTexture,gpuRenderTarget=renderTargetSystem.getGpuRenderTarget(renderTarget),viewPortY=viewport.y;renderTarget.isRoot&&(viewPortY=source$2.pixelHeight-viewport.height),renderTarget.colorTextures.forEach(texture=>{this._renderer.texture.unbind(texture)});let gl=this._renderer.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,gpuRenderTarget.framebuffer);let viewPortCache=this._viewPortCache;(viewPortCache.x!==viewport.x||viewPortCache.y!==viewPortY||viewPortCache.width!==viewport.width||viewPortCache.height!==viewport.height)&&(viewPortCache.x=viewport.x,viewPortCache.y=viewPortY,viewPortCache.width=viewport.width,viewPortCache.height=viewport.height,gl.viewport(viewport.x,viewPortY,viewport.width,viewport.height)),!gpuRenderTarget.depthStencilRenderBuffer&&(renderTarget.stencil||renderTarget.depth)&&this._initStencil(gpuRenderTarget),this.clear(renderTarget,clear$1,clearColor)}finishRenderPass(renderTarget){let glRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);if(!glRenderTarget.msaa)return;let gl=this._renderer.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,glRenderTarget.resolveTargetFramebuffer),gl.bindFramebuffer(gl.READ_FRAMEBUFFER,glRenderTarget.framebuffer),gl.blitFramebuffer(0,0,glRenderTarget.width,glRenderTarget.height,0,0,glRenderTarget.width,glRenderTarget.height,gl.COLOR_BUFFER_BIT,gl.NEAREST),gl.bindFramebuffer(gl.FRAMEBUFFER,glRenderTarget.framebuffer)}initGpuRenderTarget(renderTarget){let gl=this._renderer.gl,glRenderTarget=new GlRenderTarget;return renderTarget.colorTexture instanceof CanvasSource?(this._renderer.context.ensureCanvasSize(renderTarget.colorTexture.resource),glRenderTarget.framebuffer=null,glRenderTarget):(this._initColor(renderTarget,glRenderTarget),gl.bindFramebuffer(gl.FRAMEBUFFER,null),glRenderTarget)}destroyGpuRenderTarget(gpuRenderTarget){let gl=this._renderer.gl;gpuRenderTarget.framebuffer&&=(gl.deleteFramebuffer(gpuRenderTarget.framebuffer),null),gpuRenderTarget.resolveTargetFramebuffer&&=(gl.deleteFramebuffer(gpuRenderTarget.resolveTargetFramebuffer),null),gpuRenderTarget.depthStencilRenderBuffer&&=(gl.deleteRenderbuffer(gpuRenderTarget.depthStencilRenderBuffer),null),gpuRenderTarget.msaaRenderBuffer.forEach(renderBuffer=>{gl.deleteRenderbuffer(renderBuffer)}),gpuRenderTarget.msaaRenderBuffer=null}clear(_renderTarget,clear$1,clearColor){if(!clear$1)return;let renderTargetSystem=this._renderTargetSystem;typeof clear$1==`boolean`&&(clear$1=clear$1?CLEAR.ALL:CLEAR.NONE);let gl=this._renderer.gl;if(clear$1&CLEAR.COLOR){clearColor??=renderTargetSystem.defaultClearColor;let clearColorCache=this._clearColorCache,clearColorArray=clearColor;(clearColorCache[0]!==clearColorArray[0]||clearColorCache[1]!==clearColorArray[1]||clearColorCache[2]!==clearColorArray[2]||clearColorCache[3]!==clearColorArray[3])&&(clearColorCache[0]=clearColorArray[0],clearColorCache[1]=clearColorArray[1],clearColorCache[2]=clearColorArray[2],clearColorCache[3]=clearColorArray[3],gl.clearColor(clearColorArray[0],clearColorArray[1],clearColorArray[2],clearColorArray[3]))}gl.clear(clear$1)}resizeGpuRenderTarget(renderTarget){if(renderTarget.isRoot)return;let glRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);this._resizeColor(renderTarget,glRenderTarget),(renderTarget.stencil||renderTarget.depth)&&this._resizeStencil(glRenderTarget)}_initColor(renderTarget,glRenderTarget){let renderer$1=this._renderer,gl=renderer$1.gl,resolveTargetFramebuffer=gl.createFramebuffer();if(glRenderTarget.resolveTargetFramebuffer=resolveTargetFramebuffer,gl.bindFramebuffer(gl.FRAMEBUFFER,resolveTargetFramebuffer),glRenderTarget.width=renderTarget.colorTexture.source.pixelWidth,glRenderTarget.height=renderTarget.colorTexture.source.pixelHeight,renderTarget.colorTextures.forEach((colorTexture,i$1)=>{let source$2=colorTexture.source;source$2.antialias&&(renderer$1.context.supports.msaa?glRenderTarget.msaa=!0:warn$1(`[RenderTexture] Antialiasing on textures is not supported in WebGL1`)),renderer$1.texture.bindSource(source$2,0);let glTexture=renderer$1.texture.getGlSource(source$2).texture;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i$1,3553,glTexture,0)}),glRenderTarget.msaa){let viewFramebuffer=gl.createFramebuffer();glRenderTarget.framebuffer=viewFramebuffer,gl.bindFramebuffer(gl.FRAMEBUFFER,viewFramebuffer),renderTarget.colorTextures.forEach((_,i$1)=>{let msaaRenderBuffer=gl.createRenderbuffer();glRenderTarget.msaaRenderBuffer[i$1]=msaaRenderBuffer})}else glRenderTarget.framebuffer=resolveTargetFramebuffer;this._resizeColor(renderTarget,glRenderTarget)}_resizeColor(renderTarget,glRenderTarget){let source$2=renderTarget.colorTexture.source;if(glRenderTarget.width=source$2.pixelWidth,glRenderTarget.height=source$2.pixelHeight,renderTarget.colorTextures.forEach((colorTexture,i$1)=>{i$1!==0&&colorTexture.source.resize(source$2.width,source$2.height,source$2._resolution)}),glRenderTarget.msaa){let renderer$1=this._renderer,gl=renderer$1.gl,viewFramebuffer=glRenderTarget.framebuffer;gl.bindFramebuffer(gl.FRAMEBUFFER,viewFramebuffer),renderTarget.colorTextures.forEach((colorTexture,i$1)=>{let source2=colorTexture.source;renderer$1.texture.bindSource(source2,0);let glInternalFormat=renderer$1.texture.getGlSource(source2).internalFormat,msaaRenderBuffer=glRenderTarget.msaaRenderBuffer[i$1];gl.bindRenderbuffer(gl.RENDERBUFFER,msaaRenderBuffer),gl.renderbufferStorageMultisample(gl.RENDERBUFFER,4,glInternalFormat,source2.pixelWidth,source2.pixelHeight),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0+i$1,gl.RENDERBUFFER,msaaRenderBuffer)})}}_initStencil(glRenderTarget){if(glRenderTarget.framebuffer===null)return;let gl=this._renderer.gl,depthStencilRenderBuffer=gl.createRenderbuffer();glRenderTarget.depthStencilRenderBuffer=depthStencilRenderBuffer,gl.bindRenderbuffer(gl.RENDERBUFFER,depthStencilRenderBuffer),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,depthStencilRenderBuffer),this._resizeStencil(glRenderTarget)}_resizeStencil(glRenderTarget){let gl=this._renderer.gl;gl.bindRenderbuffer(gl.RENDERBUFFER,glRenderTarget.depthStencilRenderBuffer),glRenderTarget.msaa?gl.renderbufferStorageMultisample(gl.RENDERBUFFER,4,gl.DEPTH24_STENCIL8,glRenderTarget.width,glRenderTarget.height):gl.renderbufferStorage(gl.RENDERBUFFER,this._renderer.context.webGLVersion===2?gl.DEPTH24_STENCIL8:gl.DEPTH_STENCIL,glRenderTarget.width,glRenderTarget.height)}prerender(renderTarget){let resource=renderTarget.colorTexture.resource;this._renderer.context.multiView&&CanvasSource.test(resource)&&this._renderer.context.ensureCanvasSize(resource)}postrender(renderTarget){if(this._renderer.context.multiView&&CanvasSource.test(renderTarget.colorTexture.resource)){let contextCanvas=this._renderer.context.canvas,canvasSource=renderTarget.colorTexture;canvasSource.context2D.drawImage(contextCanvas,0,canvasSource.pixelHeight-contextCanvas.height)}}};function calculateProjection(pm,x$1,y$1,width,height,flipY){let sign$1=flipY?1:-1;return pm.identity(),pm.a=1/width*2,pm.d=sign$1*(1/height*2),pm.tx=-1-x$1*pm.a,pm.ty=-sign$1-y$1*pm.d,pm}var canvasCache=new Map;GlobalResourceRegistry.register(canvasCache);function getCanvasTexture(canvas,options){if(!canvasCache.has(canvas)){let texture=new Texture({source:new CanvasSource({resource:canvas,...options})}),onDestroy=()=>{canvasCache.get(canvas)===texture&&canvasCache.delete(canvas)};texture.once(`destroy`,onDestroy),texture.source.once(`destroy`,onDestroy),canvasCache.set(canvas,texture)}return canvasCache.get(canvas)}function isRenderingToScreen(renderTarget){let resource=renderTarget.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&resource instanceof HTMLCanvasElement&&document.body.contains(resource)}var _RenderTarget=class _RenderTarget$1{constructor(descriptor={}){if(this.uid=uid$1(`renderTarget`),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,descriptor={..._RenderTarget$1.defaultOptions,...descriptor},this.stencil=descriptor.stencil,this.depth=descriptor.depth,this.isRoot=descriptor.isRoot,typeof descriptor.colorTextures==`number`){this._managedColorTextures=!0;for(let i$1=0;i$1<descriptor.colorTextures;i$1++)this.colorTextures.push(new TextureSource({width:descriptor.width,height:descriptor.height,resolution:descriptor.resolution,antialias:descriptor.antialias}))}else{this.colorTextures=[...descriptor.colorTextures.map(texture=>texture.source)];let colorSource=this.colorTexture.source;this.resize(colorSource.width,colorSource.height,colorSource._resolution)}this.colorTexture.source.on(`resize`,this.onSourceResize,this),(descriptor.depthStencilTexture||this.stencil)&&(descriptor.depthStencilTexture instanceof Texture||descriptor.depthStencilTexture instanceof TextureSource?this.depthStencilTexture=descriptor.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){let _size=this._size;return _size[0]=this.pixelWidth,_size[1]=this.pixelHeight,_size}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(source$2){this.resize(source$2.width,source$2.height,source$2._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||=new TextureSource({width:this.width,height:this.height,resolution:this.resolution,format:`depth24plus-stencil8`,autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1})}resize(width,height,resolution=this.resolution,skipColorTexture=!1){this.dirtyId++,this.colorTextures.forEach((colorTexture,i$1)=>{skipColorTexture&&i$1===0||colorTexture.source.resize(width,height,resolution)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(width,height,resolution)}destroy(){this.colorTexture.source.off(`resize`,this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(texture=>{texture.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};_RenderTarget.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};var RenderTarget=_RenderTarget,RenderTargetSystem=class{constructor(renderer$1){this.rootViewPort=new Rectangle,this.viewport=new Rectangle,this.onRenderTargetChange=new SystemRunner(`onRenderTargetChange`),this.projectionMatrix=new Matrix,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=renderer$1,renderer$1.renderableGC.addManagedHash(this,`_gpuRenderTargetHash`)}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target,clear:clear$1,clearColor,frame}){this._renderTargetStack.length=0,this.push(target,clear$1,clearColor,frame),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=isRenderingToScreen(this.rootRenderTarget),this.adaptor.prerender?.(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(renderSurface,clear$1=!0,clearColor,frame){let renderTarget=this.getRenderTarget(renderSurface),didChange=this.renderTarget!==renderTarget;this.renderTarget=renderTarget,this.renderSurface=renderSurface;let gpuRenderTarget=this.getGpuRenderTarget(renderTarget);(renderTarget.pixelWidth!==gpuRenderTarget.width||renderTarget.pixelHeight!==gpuRenderTarget.height)&&(this.adaptor.resizeGpuRenderTarget(renderTarget),gpuRenderTarget.width=renderTarget.pixelWidth,gpuRenderTarget.height=renderTarget.pixelHeight);let source$2=renderTarget.colorTexture,viewport=this.viewport,pixelWidth=source$2.pixelWidth,pixelHeight=source$2.pixelHeight;if(!frame&&renderSurface instanceof Texture&&(frame=renderSurface.frame),frame){let resolution=source$2._resolution;viewport.x=frame.x*resolution+.5|0,viewport.y=frame.y*resolution+.5|0,viewport.width=frame.width*resolution+.5|0,viewport.height=frame.height*resolution+.5|0}else viewport.x=0,viewport.y=0,viewport.width=pixelWidth,viewport.height=pixelHeight;return calculateProjection(this.projectionMatrix,0,0,viewport.width/source$2.resolution,viewport.height/source$2.resolution,!renderTarget.isRoot),this.adaptor.startRenderPass(renderTarget,clear$1,clearColor,viewport),didChange&&this.onRenderTargetChange.emit(renderTarget),renderTarget}clear(target,clear$1=CLEAR.ALL,clearColor){clear$1&&(target&&=this.getRenderTarget(target),this.adaptor.clear(target||this.renderTarget,clear$1,clearColor,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(renderSurface,clear$1=CLEAR.ALL,clearColor,frame){let renderTarget=this.bind(renderSurface,clear$1,clearColor,frame);return this._renderTargetStack.push({renderTarget,frame}),renderTarget}pop(){this._renderTargetStack.pop();let currentRenderTargetData=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(currentRenderTargetData.renderTarget,!1,null,currentRenderTargetData.frame)}getRenderTarget(renderSurface){return renderSurface.isTexture&&(renderSurface=renderSurface.source),this._renderSurfaceToRenderTargetHash.get(renderSurface)??this._initRenderTarget(renderSurface)}copyToTexture(sourceRenderSurfaceTexture,destinationTexture,originSrc,size,originDest){originSrc.x<0&&(size.width+=originSrc.x,originDest.x-=originSrc.x,originSrc.x=0),originSrc.y<0&&(size.height+=originSrc.y,originDest.y-=originSrc.y,originSrc.y=0);let{pixelWidth,pixelHeight}=sourceRenderSurfaceTexture;return size.width=Math.min(size.width,pixelWidth-originSrc.x),size.height=Math.min(size.height,pixelHeight-originSrc.y),this.adaptor.copyToTexture(sourceRenderSurfaceTexture,destinationTexture,originSrc,size,originDest)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((renderTarget,key$1)=>{renderTarget!==key$1&&renderTarget.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(renderSurface){let renderTarget=null;return CanvasSource.test(renderSurface)&&(renderSurface=getCanvasTexture(renderSurface).source),renderSurface instanceof RenderTarget?renderTarget=renderSurface:renderSurface instanceof TextureSource&&(renderTarget=new RenderTarget({colorTextures:[renderSurface]}),renderSurface.source instanceof CanvasSource&&(renderTarget.isRoot=!0),renderSurface.once(`destroy`,()=>{renderTarget.destroy(),this._renderSurfaceToRenderTargetHash.delete(renderSurface);let gpuRenderTarget=this._gpuRenderTargetHash[renderTarget.uid];gpuRenderTarget&&(this._gpuRenderTargetHash[renderTarget.uid]=null,this.adaptor.destroyGpuRenderTarget(gpuRenderTarget))})),this._renderSurfaceToRenderTargetHash.set(renderSurface,renderTarget),renderTarget}getGpuRenderTarget(renderTarget){return this._gpuRenderTargetHash[renderTarget.uid]||(this._gpuRenderTargetHash[renderTarget.uid]=this.adaptor.initGpuRenderTarget(renderTarget))}resetState(){this.renderTarget=null,this.renderSurface=null}},GlRenderTargetSystem=class extends RenderTargetSystem{constructor(renderer$1){super(renderer$1),this.adaptor=new GlRenderTargetAdaptor,this.adaptor.init(renderer$1,this)}};GlRenderTargetSystem.extension={type:[ExtensionType.WebGLSystem],name:`renderTarget`};var BufferResource=class extends eventemitter3_default{constructor({buffer,offset,size}){super(),this.uid=uid$1(`buffer`),this._resourceType=`bufferResource`,this._touched=0,this._resourceId=uid$1(`resource`),this._bufferResource=!0,this.destroyed=!1,this.buffer=buffer,this.offset=offset|0,this.size=size,this.buffer.on(`change`,this.onBufferChange,this)}onBufferChange(){this._resourceId=uid$1(`resource`),this.emit(`change`,this)}destroy(destroyBuffer=!1){this.destroyed=!0,destroyBuffer&&this.buffer.destroy(),this.emit(`change`,this),this.buffer=null}};function generateShaderSyncCode(shader,shaderSystem){let funcFragments=[],headerFragments=[`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `],addedTextreSystem=!1,textureCount=0,programData=shaderSystem._getProgramData(shader.glProgram);for(let i$1 in shader.groups){let group=shader.groups[i$1];for(let j$1 in funcFragments.push(`
            resources = g[${i$1}].resources;
        `),group.resources){let resource=group.resources[j$1];if(resource instanceof UniformGroup)if(resource.ubo){let resName=shader._uniformBindMap[i$1][Number(j$1)];funcFragments.push(`
                        sS.bindUniformBlock(
                            resources[${j$1}],
                            '${resName}',
                            ${shader.glProgram._uniformBlockData[resName].index}
                        );
                    `)}else funcFragments.push(`
                        ugS.updateUniformGroup(resources[${j$1}], p, sD);
                    `);else if(resource instanceof BufferResource){let resName=shader._uniformBindMap[i$1][Number(j$1)];funcFragments.push(`
                    sS.bindUniformBlock(
                        resources[${j$1}],
                        '${resName}',
                        ${shader.glProgram._uniformBlockData[resName].index}
                    );
                `)}else if(resource instanceof TextureSource){let uniformName=shader._uniformBindMap[i$1][j$1],uniformData=programData.uniformData[uniformName];uniformData&&(addedTextreSystem||(addedTextreSystem=!0,headerFragments.push(`
                        var tS = r.texture;
                        `)),shaderSystem._gl.uniform1i(uniformData.location,textureCount),funcFragments.push(`
                        tS.bind(resources[${j$1}], ${textureCount});
                    `),textureCount++)}}}let functionSource=[...headerFragments,...funcFragments].join(`
`);return Function(`r`,`s`,`sD`,functionSource)}var GlProgramData=class{constructor(program,uniformData){this.program=program,this.uniformData=uniformData,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}};function compileShader(gl,type,src){let shader=gl.createShader(type);return gl.shaderSource(shader,src),gl.compileShader(shader),shader}function booleanArray(size){let array=Array(size);for(let i$1=0;i$1<array.length;i$1++)array[i$1]=!1;return array}function defaultValue(type,size){switch(type){case`float`:return 0;case`vec2`:return new Float32Array(2*size);case`vec3`:return new Float32Array(3*size);case`vec4`:return new Float32Array(4*size);case`int`:case`uint`:case`sampler2D`:case`sampler2DArray`:return 0;case`ivec2`:return new Int32Array(2*size);case`ivec3`:return new Int32Array(3*size);case`ivec4`:return new Int32Array(4*size);case`uvec2`:return new Uint32Array(2*size);case`uvec3`:return new Uint32Array(3*size);case`uvec4`:return new Uint32Array(4*size);case`bool`:return!1;case`bvec2`:return booleanArray(2*size);case`bvec3`:return booleanArray(3*size);case`bvec4`:return booleanArray(4*size);case`mat2`:return new Float32Array([1,0,0,1]);case`mat3`:return new Float32Array([1,0,0,0,1,0,0,0,1]);case`mat4`:return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var GL_TABLE=null,GL_TO_GLSL_TYPES={FLOAT:`float`,FLOAT_VEC2:`vec2`,FLOAT_VEC3:`vec3`,FLOAT_VEC4:`vec4`,INT:`int`,INT_VEC2:`ivec2`,INT_VEC3:`ivec3`,INT_VEC4:`ivec4`,UNSIGNED_INT:`uint`,UNSIGNED_INT_VEC2:`uvec2`,UNSIGNED_INT_VEC3:`uvec3`,UNSIGNED_INT_VEC4:`uvec4`,BOOL:`bool`,BOOL_VEC2:`bvec2`,BOOL_VEC3:`bvec3`,BOOL_VEC4:`bvec4`,FLOAT_MAT2:`mat2`,FLOAT_MAT3:`mat3`,FLOAT_MAT4:`mat4`,SAMPLER_2D:`sampler2D`,INT_SAMPLER_2D:`sampler2D`,UNSIGNED_INT_SAMPLER_2D:`sampler2D`,SAMPLER_CUBE:`samplerCube`,INT_SAMPLER_CUBE:`samplerCube`,UNSIGNED_INT_SAMPLER_CUBE:`samplerCube`,SAMPLER_2D_ARRAY:`sampler2DArray`,INT_SAMPLER_2D_ARRAY:`sampler2DArray`,UNSIGNED_INT_SAMPLER_2D_ARRAY:`sampler2DArray`},GLSL_TO_VERTEX_TYPES={float:`float32`,vec2:`float32x2`,vec3:`float32x3`,vec4:`float32x4`,int:`sint32`,ivec2:`sint32x2`,ivec3:`sint32x3`,ivec4:`sint32x4`,uint:`uint32`,uvec2:`uint32x2`,uvec3:`uint32x3`,uvec4:`uint32x4`,bool:`uint32`,bvec2:`uint32x2`,bvec3:`uint32x3`,bvec4:`uint32x4`};function mapType(gl,type){if(!GL_TABLE){let typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let i$1=0;i$1<typeNames.length;++i$1){let tn=typeNames[i$1];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]}function mapGlToVertexFormat(gl,type){let typeValue=mapType(gl,type);return GLSL_TO_VERTEX_TYPES[typeValue]||`float32`}function extractAttributesFromGlProgram(program,gl,sortAttributes=!1){let attributes={},totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(let i$1=0;i$1<totalAttributes;i$1++){let attribData=gl.getActiveAttrib(program,i$1);if(attribData.name.startsWith(`gl_`))continue;let format$1=mapGlToVertexFormat(gl,attribData.type);attributes[attribData.name]={location:0,format:format$1,stride:getAttributeInfoFromFormat(format$1).stride,offset:0,instance:!1,start:0}}let keys$1=Object.keys(attributes);if(sortAttributes){keys$1.sort((a$1,b$1)=>a$1>b$1?1:-1);for(let i$1=0;i$1<keys$1.length;i$1++)attributes[keys$1[i$1]].location=i$1,gl.bindAttribLocation(program,i$1,keys$1[i$1]);gl.linkProgram(program)}else for(let i$1=0;i$1<keys$1.length;i$1++)attributes[keys$1[i$1]].location=gl.getAttribLocation(program,keys$1[i$1]);return attributes}function getUboData(program,gl){if(!gl.ACTIVE_UNIFORM_BLOCKS)return{};let uniformBlocks={},totalUniformsBlocks=gl.getProgramParameter(program,gl.ACTIVE_UNIFORM_BLOCKS);for(let i$1=0;i$1<totalUniformsBlocks;i$1++){let name=gl.getActiveUniformBlockName(program,i$1),uniformBlockIndex=gl.getUniformBlockIndex(program,name),size=gl.getActiveUniformBlockParameter(program,i$1,gl.UNIFORM_BLOCK_DATA_SIZE);uniformBlocks[name]={name,index:uniformBlockIndex,size}}return uniformBlocks}function getUniformData(program,gl){let uniforms={},totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(let i$1=0;i$1<totalUniforms;i$1++){let uniformData=gl.getActiveUniform(program,i$1),name=uniformData.name.replace(/\[.*?\]$/,``),isArray$3=!!uniformData.name.match(/\[.*?\]$/),type=mapType(gl,uniformData.type);uniforms[name]={name,index:i$1,type,size:uniformData.size,isArray:isArray$3,value:defaultValue(type,uniformData.size)}}return uniforms}function logPrettyShaderError(gl,shader){let shaderSrc=gl.getShaderSource(shader).split(`
`).map((line,index)=>`${index}: ${line}`),shaderLog=gl.getShaderInfoLog(shader),splitShader=shaderLog.split(`
`),dedupe={},lineNumbers=splitShader.map(line=>parseFloat(line.replace(/^ERROR\: 0\:([\d]+)\:.*$/,`$1`))).filter(n$1=>n$1&&!dedupe[n$1]?(dedupe[n$1]=!0,!0):!1),logArgs=[``];lineNumbers.forEach(number$1=>{shaderSrc[number$1-1]=`%c${shaderSrc[number$1-1]}%c`,logArgs.push(`background: #FF0000; color:#FFFFFF; font-size: 10px`,`font-size: 10px`)}),logArgs[0]=shaderSrc.join(`
`),console.error(shaderLog),console.groupCollapsed(`click to view full shader code`),console.warn(...logArgs),console.groupEnd()}function logProgramError(gl,program,vertexShader,fragmentShader){gl.getProgramParameter(program,gl.LINK_STATUS)||(gl.getShaderParameter(vertexShader,gl.COMPILE_STATUS)||logPrettyShaderError(gl,vertexShader),gl.getShaderParameter(fragmentShader,gl.COMPILE_STATUS)||logPrettyShaderError(gl,fragmentShader),console.error(`PixiJS Error: Could not initialize shader.`),gl.getProgramInfoLog(program)!==``&&console.warn(`PixiJS Warning: gl.getProgramInfoLog()`,gl.getProgramInfoLog(program)))}function generateProgram(gl,program){let glVertShader=compileShader(gl,gl.VERTEX_SHADER,program.vertex),glFragShader=compileShader(gl,gl.FRAGMENT_SHADER,program.fragment),webGLProgram=gl.createProgram();gl.attachShader(webGLProgram,glVertShader),gl.attachShader(webGLProgram,glFragShader);let transformFeedbackVaryings=program.transformFeedbackVaryings;transformFeedbackVaryings&&(typeof gl.transformFeedbackVaryings==`function`?gl.transformFeedbackVaryings(webGLProgram,transformFeedbackVaryings.names,transformFeedbackVaryings.bufferMode===`separate`?gl.SEPARATE_ATTRIBS:gl.INTERLEAVED_ATTRIBS):warn$1(`TransformFeedback is not supported but TransformFeedbackVaryings are given.`)),gl.linkProgram(webGLProgram),gl.getProgramParameter(webGLProgram,gl.LINK_STATUS)||logProgramError(gl,webGLProgram,glVertShader,glFragShader),program._attributeData=extractAttributesFromGlProgram(webGLProgram,gl,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(program.vertex)),program._uniformData=getUniformData(webGLProgram,gl),program._uniformBlockData=getUboData(webGLProgram,gl),gl.deleteShader(glVertShader),gl.deleteShader(glFragShader);let uniformData={};for(let i$1 in program._uniformData){let data=program._uniformData[i$1];uniformData[i$1]={location:gl.getUniformLocation(webGLProgram,i$1),value:defaultValue(data.type,data.size)}}return new GlProgramData(webGLProgram,uniformData)}var defaultSyncData={textureCount:0,blockIndex:0},GlShaderSystem=class{constructor(renderer$1){this._activeProgram=null,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=renderer$1,this._renderer.renderableGC.addManagedHash(this,`_programDataHash`)}contextChange(gl){this._gl=gl,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null}bind(shader,skipSync){if(this._setProgram(shader.glProgram),skipSync)return;defaultSyncData.textureCount=0,defaultSyncData.blockIndex=0;let syncFunction=this._shaderSyncFunctions[shader.glProgram._key];syncFunction||=this._shaderSyncFunctions[shader.glProgram._key]=this._generateShaderSync(shader,this),this._renderer.buffer.nextBindBase(!!shader.glProgram.transformFeedbackVaryings),syncFunction(this._renderer,shader,defaultSyncData)}updateUniformGroup(uniformGroup){this._renderer.uniformGroup.updateUniformGroup(uniformGroup,this._activeProgram,defaultSyncData)}bindUniformBlock(uniformGroup,name,index=0){let bufferSystem=this._renderer.buffer,programData=this._getProgramData(this._activeProgram),isBufferResource=uniformGroup._bufferResource;isBufferResource||this._renderer.ubo.updateUniformGroup(uniformGroup);let buffer=uniformGroup.buffer,glBuffer=bufferSystem.updateBuffer(buffer),boundLocation=bufferSystem.freeLocationForBufferBase(glBuffer);if(isBufferResource){let{offset,size}=uniformGroup;offset===0&&size===buffer.data.byteLength?bufferSystem.bindBufferBase(glBuffer,boundLocation):bufferSystem.bindBufferRange(glBuffer,boundLocation,offset)}else bufferSystem.getLastBindBaseLocation(glBuffer)!==boundLocation&&bufferSystem.bindBufferBase(glBuffer,boundLocation);let uniformBlockIndex=this._activeProgram._uniformBlockData[name].index;programData.uniformBlockBindings[index]!==boundLocation&&(programData.uniformBlockBindings[index]=boundLocation,this._renderer.gl.uniformBlockBinding(programData.program,uniformBlockIndex,boundLocation))}_setProgram(program){if(this._activeProgram===program)return;this._activeProgram=program;let programData=this._getProgramData(program);this._gl.useProgram(programData.program)}_getProgramData(program){return this._programDataHash[program._key]||this._createProgramData(program)}_createProgramData(program){let key$1=program._key;return this._programDataHash[key$1]=generateProgram(this._gl,program),this._programDataHash[key$1]}destroy(){for(let key$1 of Object.keys(this._programDataHash))this._programDataHash[key$1].destroy(),this._programDataHash[key$1]=null;this._programDataHash=null,this._shaderSyncFunctions=null,this._activeProgram=null,this._renderer=null,this._gl=null}_generateShaderSync(shader,shaderSystem){return generateShaderSyncCode(shader,shaderSystem)}resetState(){this._activeProgram=null}};GlShaderSystem.extension={type:[ExtensionType.WebGLSystem],name:`shader`};var UNIFORM_TO_SINGLE_SETTERS={f32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,"vec2<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,"vec3<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,"vec4<f32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,i32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<i32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,u32:`if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,"vec2<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,"vec3<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,"vec4<u32>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,bool:`if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,"vec2<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,"vec3<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,"vec4<bool>":`if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,"mat2x2<f32>":`gl.uniformMatrix2fv(location, false, v);`,"mat3x3<f32>":`gl.uniformMatrix3fv(location, false, v);`,"mat4x4<f32>":`gl.uniformMatrix4fv(location, false, v);`},UNIFORM_TO_ARRAY_SETTERS={f32:`gl.uniform1fv(location, v);`,"vec2<f32>":`gl.uniform2fv(location, v);`,"vec3<f32>":`gl.uniform3fv(location, v);`,"vec4<f32>":`gl.uniform4fv(location, v);`,"mat2x2<f32>":`gl.uniformMatrix2fv(location, false, v);`,"mat3x3<f32>":`gl.uniformMatrix3fv(location, false, v);`,"mat4x4<f32>":`gl.uniformMatrix4fv(location, false, v);`,i32:`gl.uniform1iv(location, v);`,"vec2<i32>":`gl.uniform2iv(location, v);`,"vec3<i32>":`gl.uniform3iv(location, v);`,"vec4<i32>":`gl.uniform4iv(location, v);`,u32:`gl.uniform1iv(location, v);`,"vec2<u32>":`gl.uniform2iv(location, v);`,"vec3<u32>":`gl.uniform3iv(location, v);`,"vec4<u32>":`gl.uniform4iv(location, v);`,bool:`gl.uniform1iv(location, v);`,"vec2<bool>":`gl.uniform2iv(location, v);`,"vec3<bool>":`gl.uniform3iv(location, v);`,"vec4<bool>":`gl.uniform4iv(location, v);`};function generateUniformsSync(group,uniformData){let funcFragments=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];for(let i$1 in group.uniforms){if(!uniformData[i$1]){group.uniforms[i$1]instanceof UniformGroup?group.uniforms[i$1].ubo?funcFragments.push(`
                        renderer.shader.bindUniformBlock(uv.${i$1}, "${i$1}");
                    `):funcFragments.push(`
                        renderer.shader.updateUniformGroup(uv.${i$1});
                    `):group.uniforms[i$1]instanceof BufferResource&&funcFragments.push(`
                        renderer.shader.bindBufferResource(uv.${i$1}, "${i$1}");
                    `);continue}let uniform=group.uniformStructures[i$1],parsed=!1;for(let j$1=0;j$1<uniformParsers.length;j$1++){let parser=uniformParsers[j$1];if(uniform.type===parser.type&&parser.test(uniform)){funcFragments.push(`name = "${i$1}";`,uniformParsers[j$1].uniform),parsed=!0;break}}if(!parsed){let template=(uniform.size===1?UNIFORM_TO_SINGLE_SETTERS:UNIFORM_TO_ARRAY_SETTERS)[uniform.type].replace(`location`,`ud["${i$1}"].location`);funcFragments.push(`
            cu = ud["${i$1}"];
            cv = cu.value;
            v = uv["${i$1}"];
            ${template};`)}}return Function(`ud`,`uv`,`renderer`,`syncData`,funcFragments.join(`
`))}var GlUniformGroupSystem=class{constructor(renderer$1){this._cache={},this._uniformGroupSyncHash={},this._renderer=renderer$1,this.gl=null,this._cache={}}contextChange(gl){this.gl=gl}updateUniformGroup(group,program,syncData){let programData=this._renderer.shader._getProgramData(program);(!group.isStatic||group._dirtyId!==programData.uniformDirtyGroups[group.uid])&&(programData.uniformDirtyGroups[group.uid]=group._dirtyId,this._getUniformSyncFunction(group,program)(programData.uniformData,group.uniforms,this._renderer,syncData))}_getUniformSyncFunction(group,program){return this._uniformGroupSyncHash[group._signature]?.[program._key]||this._createUniformSyncFunction(group,program)}_createUniformSyncFunction(group,program){let uniformGroupSyncHash=this._uniformGroupSyncHash[group._signature]||(this._uniformGroupSyncHash[group._signature]={}),id=this._getSignature(group,program._uniformData,`u`);return this._cache[id]||(this._cache[id]=this._generateUniformsSync(group,program._uniformData)),uniformGroupSyncHash[program._key]=this._cache[id],uniformGroupSyncHash[program._key]}_generateUniformsSync(group,uniformData){return generateUniformsSync(group,uniformData)}_getSignature(group,uniformData,preFix){let uniforms=group.uniforms,strings$2=[`${preFix}-`];for(let i$1 in uniforms)strings$2.push(i$1),uniformData[i$1]&&strings$2.push(uniformData[i$1].type);return strings$2.join(`-`)}destroy(){this._renderer=null,this._cache=null}};GlUniformGroupSystem.extension={type:[ExtensionType.WebGLSystem],name:`uniformGroup`};function mapWebGLBlendModesToPixi(gl){let blendMap={};if(blendMap.normal=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],blendMap.add=[gl.ONE,gl.ONE],blendMap.multiply=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],blendMap.screen=[gl.ONE,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],blendMap.none=[0,0],blendMap[`normal-npm`]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],blendMap[`add-npm`]=[gl.SRC_ALPHA,gl.ONE,gl.ONE,gl.ONE],blendMap[`screen-npm`]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],blendMap.erase=[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA],!(gl instanceof DOMAdapter.get().getWebGLRenderingContext()))blendMap.min=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,gl.MIN,gl.MIN],blendMap.max=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,gl.MAX,gl.MAX];else{let ext=gl.getExtension(`EXT_blend_minmax`);ext&&(blendMap.min=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,ext.MIN_EXT,ext.MIN_EXT],blendMap.max=[gl.ONE,gl.ONE,gl.ONE,gl.ONE,ext.MAX_EXT,ext.MAX_EXT])}return blendMap}var BLEND=0,OFFSET$1=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_GlStateSystem=class _GlStateSystem$1{constructor(renderer$1){this._invertFrontFace=!1,this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=`none`,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET$1]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=State.for2d(),renderer$1.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(renderTarget){this._invertFrontFace=!renderTarget.isRoot,this._cullFace?this.setFrontFace(this._frontFace):this._frontFaceDirty=!0}contextChange(gl){this.gl=gl,this.blendModesMap=mapWebGLBlendModesToPixi(gl),this.resetState()}set(state){if(state||=this.defaultState,this.stateId!==state.data){let diff=this.stateId^state.data,i$1=0;for(;diff;)diff&1&&this.map[i$1].call(this,!!(state.data&1<<i$1)),diff>>=1,i$1++;this.stateId=state.data}for(let i$1=0;i$1<this.checks.length;i$1++)this.checks[i$1](this,state)}forceState(state){state||=this.defaultState;for(let i$1=0;i$1<this.map.length;i$1++)this.map[i$1].call(this,!!(state.data&1<<i$1));for(let i$1=0;i$1<this.checks.length;i$1++)this.checks[i$1](this,state);this.stateId=state.data}setBlend(value){this._updateCheck(_GlStateSystem$1._checkBlendMode,value),this.gl[value?`enable`:`disable`](this.gl.BLEND)}setOffset(value){this._updateCheck(_GlStateSystem$1._checkPolygonOffset,value),this.gl[value?`enable`:`disable`](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(value){this.gl[value?`enable`:`disable`](this.gl.DEPTH_TEST)}setDepthMask(value){this.gl.depthMask(value)}setCullFace(value){this._cullFace=value,this.gl[value?`enable`:`disable`](this.gl.CULL_FACE),this._cullFace&&this._frontFaceDirty&&this.setFrontFace(this._frontFace)}setFrontFace(value){this._frontFace=value,this._frontFaceDirty=!1;let faceMode=this._invertFrontFace?!value:value;this._glFrontFace!==faceMode&&(this._glFrontFace=faceMode,this.gl.frontFace(this.gl[faceMode?`CW`:`CCW`]))}setBlendMode(value){if(this.blendModesMap[value]||(value=`normal`),value===this.blendMode)return;this.blendMode=value;let mode=this.blendModesMap[value],gl=this.gl;mode.length===2?gl.blendFunc(mode[0],mode[1]):gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3]),mode.length===6?(this._blendEq=!0,gl.blendEquationSeparate(mode[4],mode[5])):this._blendEq&&(this._blendEq=!1,gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD))}setPolygonOffset(value,scale$3){this.gl.polygonOffset(value,scale$3)}resetState(){this._glFrontFace=!1,this._frontFace=!1,this._cullFace=!1,this._frontFaceDirty=!1,this._invertFrontFace=!1,this.gl.frontFace(this.gl.CCW),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=``,this.setBlendMode(`normal`)}_updateCheck(func,value){let index=this.checks.indexOf(func);value&&index===-1?this.checks.push(func):!value&&index!==-1&&this.checks.splice(index,1)}static _checkBlendMode(system,state){system.setBlendMode(state.blendMode)}static _checkPolygonOffset(system,state){system.setPolygonOffset(1,state.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};_GlStateSystem.extension={type:[ExtensionType.WebGLSystem],name:`state`};var GlStateSystem=_GlStateSystem,GlTexture=class{constructor(texture){this.target=GL_TARGETS.TEXTURE_2D,this.texture=texture,this.width=-1,this.height=-1,this.type=GL_TYPES.UNSIGNED_BYTE,this.internalFormat=GL_FORMATS.RGBA,this.format=GL_FORMATS.RGBA,this.samplerType=0}},glUploadBufferImageResource={id:`buffer`,upload(source$2,glTexture,gl){glTexture.width===source$2.width||glTexture.height===source$2.height?gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,source$2.width,source$2.height,glTexture.format,glTexture.type,source$2.resource):gl.texImage2D(glTexture.target,0,glTexture.internalFormat,source$2.width,source$2.height,0,glTexture.format,glTexture.type,source$2.resource),glTexture.width=source$2.width,glTexture.height=source$2.height}},compressedFormatMap={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},glUploadCompressedTextureResource={id:`compressed`,upload(source$2,glTexture,gl){gl.pixelStorei(gl.UNPACK_ALIGNMENT,4);let mipWidth=source$2.pixelWidth,mipHeight=source$2.pixelHeight,compressed=!!compressedFormatMap[source$2.format];for(let i$1=0;i$1<source$2.resource.length;i$1++){let levelBuffer=source$2.resource[i$1];compressed?gl.compressedTexImage2D(gl.TEXTURE_2D,i$1,glTexture.internalFormat,mipWidth,mipHeight,0,levelBuffer):gl.texImage2D(gl.TEXTURE_2D,i$1,glTexture.internalFormat,mipWidth,mipHeight,0,glTexture.format,glTexture.type,levelBuffer),mipWidth=Math.max(mipWidth>>1,1),mipHeight=Math.max(mipHeight>>1,1)}}},glUploadImageResource={id:`image`,upload(source$2,glTexture,gl,webGLVersion){let glWidth=glTexture.width,glHeight=glTexture.height,textureWidth=source$2.pixelWidth,textureHeight=source$2.pixelHeight,resourceWidth=source$2.resourceWidth,resourceHeight=source$2.resourceHeight;resourceWidth<textureWidth||resourceHeight<textureHeight?((glWidth!==textureWidth||glHeight!==textureHeight)&&gl.texImage2D(glTexture.target,0,glTexture.internalFormat,textureWidth,textureHeight,0,glTexture.format,glTexture.type,null),webGLVersion===2?gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,resourceWidth,resourceHeight,glTexture.format,glTexture.type,source$2.resource):gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,glTexture.format,glTexture.type,source$2.resource)):glWidth===textureWidth&&glHeight===textureHeight?gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,glTexture.format,glTexture.type,source$2.resource):webGLVersion===2?gl.texImage2D(glTexture.target,0,glTexture.internalFormat,textureWidth,textureHeight,0,glTexture.format,glTexture.type,source$2.resource):gl.texImage2D(glTexture.target,0,glTexture.internalFormat,glTexture.format,glTexture.type,source$2.resource),glTexture.width=textureWidth,glTexture.height=textureHeight}},glUploadVideoResource={id:`video`,upload(source$2,glTexture,gl,webGLVersion){if(!source$2.isValid){gl.texImage2D(glTexture.target,0,glTexture.internalFormat,1,1,0,glTexture.format,glTexture.type,null);return}glUploadImageResource.upload(source$2,glTexture,gl,webGLVersion)}},scaleModeToGlFilter={linear:9729,nearest:9728},mipmapScaleModeToGlFilter={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},wrapModeToGlAddress={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},compareModeToGlCompare={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function applyStyleParams(style,gl,mipmaps,anisotropicExt,glFunctionName,firstParam,forceClamp,firstCreation){let castParam=firstParam;if(!firstCreation||style.addressModeU!==`repeat`||style.addressModeV!==`repeat`||style.addressModeW!==`repeat`){let wrapModeS=wrapModeToGlAddress[forceClamp?`clamp-to-edge`:style.addressModeU],wrapModeT=wrapModeToGlAddress[forceClamp?`clamp-to-edge`:style.addressModeV],wrapModeR=wrapModeToGlAddress[forceClamp?`clamp-to-edge`:style.addressModeW];gl[glFunctionName](castParam,gl.TEXTURE_WRAP_S,wrapModeS),gl[glFunctionName](castParam,gl.TEXTURE_WRAP_T,wrapModeT),gl.TEXTURE_WRAP_R&&gl[glFunctionName](castParam,gl.TEXTURE_WRAP_R,wrapModeR)}if((!firstCreation||style.magFilter!==`linear`)&&gl[glFunctionName](castParam,gl.TEXTURE_MAG_FILTER,scaleModeToGlFilter[style.magFilter]),mipmaps){if(!firstCreation||style.mipmapFilter!==`linear`){let glFilterMode=mipmapScaleModeToGlFilter[style.minFilter][style.mipmapFilter];gl[glFunctionName](castParam,gl.TEXTURE_MIN_FILTER,glFilterMode)}}else gl[glFunctionName](castParam,gl.TEXTURE_MIN_FILTER,scaleModeToGlFilter[style.minFilter]);if(anisotropicExt&&style.maxAnisotropy>1){let level=Math.min(style.maxAnisotropy,gl.getParameter(anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));gl[glFunctionName](castParam,anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT,level)}style.compare&&gl[glFunctionName](castParam,gl.TEXTURE_COMPARE_FUNC,compareModeToGlCompare[style.compare])}function mapFormatToGlFormat(gl){return{r8unorm:gl.RED,r8snorm:gl.RED,r8uint:gl.RED,r8sint:gl.RED,r16uint:gl.RED,r16sint:gl.RED,r16float:gl.RED,rg8unorm:gl.RG,rg8snorm:gl.RG,rg8uint:gl.RG,rg8sint:gl.RG,r32uint:gl.RED,r32sint:gl.RED,r32float:gl.RED,rg16uint:gl.RG,rg16sint:gl.RG,rg16float:gl.RG,rgba8unorm:gl.RGBA,"rgba8unorm-srgb":gl.RGBA,rgba8snorm:gl.RGBA,rgba8uint:gl.RGBA,rgba8sint:gl.RGBA,bgra8unorm:gl.RGBA,"bgra8unorm-srgb":gl.RGBA,rgb9e5ufloat:gl.RGB,rgb10a2unorm:gl.RGBA,rg11b10ufloat:gl.RGB,rg32uint:gl.RG,rg32sint:gl.RG,rg32float:gl.RG,rgba16uint:gl.RGBA,rgba16sint:gl.RGBA,rgba16float:gl.RGBA,rgba32uint:gl.RGBA,rgba32sint:gl.RGBA,rgba32float:gl.RGBA,stencil8:gl.STENCIL_INDEX8,depth16unorm:gl.DEPTH_COMPONENT,depth24plus:gl.DEPTH_COMPONENT,"depth24plus-stencil8":gl.DEPTH_STENCIL,depth32float:gl.DEPTH_COMPONENT,"depth32float-stencil8":gl.DEPTH_STENCIL}}function mapFormatToGlInternalFormat(gl,extensions$2){let srgb={},bgra8unorm=gl.RGBA;return gl instanceof DOMAdapter.get().getWebGLRenderingContext()?extensions$2.srgb&&(srgb={"rgba8unorm-srgb":extensions$2.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":extensions$2.srgb.SRGB8_ALPHA8_EXT}):(srgb={"rgba8unorm-srgb":gl.SRGB8_ALPHA8,"bgra8unorm-srgb":gl.SRGB8_ALPHA8},bgra8unorm=gl.RGBA8),{r8unorm:gl.R8,r8snorm:gl.R8_SNORM,r8uint:gl.R8UI,r8sint:gl.R8I,r16uint:gl.R16UI,r16sint:gl.R16I,r16float:gl.R16F,rg8unorm:gl.RG8,rg8snorm:gl.RG8_SNORM,rg8uint:gl.RG8UI,rg8sint:gl.RG8I,r32uint:gl.R32UI,r32sint:gl.R32I,r32float:gl.R32F,rg16uint:gl.RG16UI,rg16sint:gl.RG16I,rg16float:gl.RG16F,rgba8unorm:gl.RGBA,...srgb,rgba8snorm:gl.RGBA8_SNORM,rgba8uint:gl.RGBA8UI,rgba8sint:gl.RGBA8I,bgra8unorm,rgb9e5ufloat:gl.RGB9_E5,rgb10a2unorm:gl.RGB10_A2,rg11b10ufloat:gl.R11F_G11F_B10F,rg32uint:gl.RG32UI,rg32sint:gl.RG32I,rg32float:gl.RG32F,rgba16uint:gl.RGBA16UI,rgba16sint:gl.RGBA16I,rgba16float:gl.RGBA16F,rgba32uint:gl.RGBA32UI,rgba32sint:gl.RGBA32I,rgba32float:gl.RGBA32F,stencil8:gl.STENCIL_INDEX8,depth16unorm:gl.DEPTH_COMPONENT16,depth24plus:gl.DEPTH_COMPONENT24,"depth24plus-stencil8":gl.DEPTH24_STENCIL8,depth32float:gl.DEPTH_COMPONENT32F,"depth32float-stencil8":gl.DEPTH32F_STENCIL8,...extensions$2.s3tc?{"bc1-rgba-unorm":extensions$2.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":extensions$2.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":extensions$2.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...extensions$2.s3tc_sRGB?{"bc1-rgba-unorm-srgb":extensions$2.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":extensions$2.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":extensions$2.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...extensions$2.rgtc?{"bc4-r-unorm":extensions$2.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":extensions$2.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":extensions$2.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":extensions$2.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...extensions$2.bptc?{"bc6h-rgb-float":extensions$2.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":extensions$2.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":extensions$2.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":extensions$2.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...extensions$2.etc?{"etc2-rgb8unorm":extensions$2.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":extensions$2.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":extensions$2.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":extensions$2.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":extensions$2.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":extensions$2.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":extensions$2.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":extensions$2.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...extensions$2.astc?{"astc-4x4-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":extensions$2.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":extensions$2.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}function mapFormatToGlType(gl){return{r8unorm:gl.UNSIGNED_BYTE,r8snorm:gl.BYTE,r8uint:gl.UNSIGNED_BYTE,r8sint:gl.BYTE,r16uint:gl.UNSIGNED_SHORT,r16sint:gl.SHORT,r16float:gl.HALF_FLOAT,rg8unorm:gl.UNSIGNED_BYTE,rg8snorm:gl.BYTE,rg8uint:gl.UNSIGNED_BYTE,rg8sint:gl.BYTE,r32uint:gl.UNSIGNED_INT,r32sint:gl.INT,r32float:gl.FLOAT,rg16uint:gl.UNSIGNED_SHORT,rg16sint:gl.SHORT,rg16float:gl.HALF_FLOAT,rgba8unorm:gl.UNSIGNED_BYTE,"rgba8unorm-srgb":gl.UNSIGNED_BYTE,rgba8snorm:gl.BYTE,rgba8uint:gl.UNSIGNED_BYTE,rgba8sint:gl.BYTE,bgra8unorm:gl.UNSIGNED_BYTE,"bgra8unorm-srgb":gl.UNSIGNED_BYTE,rgb9e5ufloat:gl.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:gl.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:gl.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:gl.UNSIGNED_INT,rg32sint:gl.INT,rg32float:gl.FLOAT,rgba16uint:gl.UNSIGNED_SHORT,rgba16sint:gl.SHORT,rgba16float:gl.HALF_FLOAT,rgba32uint:gl.UNSIGNED_INT,rgba32sint:gl.INT,rgba32float:gl.FLOAT,stencil8:gl.UNSIGNED_BYTE,depth16unorm:gl.UNSIGNED_SHORT,depth24plus:gl.UNSIGNED_INT,"depth24plus-stencil8":gl.UNSIGNED_INT_24_8,depth32float:gl.FLOAT,"depth32float-stencil8":gl.FLOAT_32_UNSIGNED_INT_24_8_REV}}var BYTES_PER_PIXEL=4,GlTextureSystem=class{constructor(renderer$1){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:glUploadImageResource,buffer:glUploadBufferImageResource,video:glUploadVideoResource,compressed:glUploadCompressedTextureResource},this._premultiplyAlpha=!1,this._useSeparateSamplers=!1,this._renderer=renderer$1,this._renderer.renderableGC.addManagedHash(this,`_glTextures`),this._renderer.renderableGC.addManagedHash(this,`_glSamplers`)}contextChange(gl){this._gl=gl,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=mapFormatToGlInternalFormat(gl,this._renderer.context.extensions),this._mapFormatToType=mapFormatToGlType(gl),this._mapFormatToFormat=mapFormatToGlFormat(gl)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null),this._premultiplyAlpha=!1;for(let i$1=0;i$1<16;i$1++)this.bind(Texture.EMPTY,i$1)}initSource(source$2){this.bind(source$2)}bind(texture,location$1=0){let source$2=texture.source;texture?(this.bindSource(source$2,location$1),this._useSeparateSamplers&&this._bindSampler(source$2.style,location$1)):(this.bindSource(null,location$1),this._useSeparateSamplers&&this._bindSampler(null,location$1))}bindSource(source$2,location$1=0){let gl=this._gl;if(source$2._touched=this._renderer.textureGC.count,this._boundTextures[location$1]!==source$2){this._boundTextures[location$1]=source$2,this._activateLocation(location$1),source$2||=Texture.EMPTY.source;let glTexture=this.getGlSource(source$2);gl.bindTexture(glTexture.target,glTexture.texture)}}_bindSampler(style,location$1=0){let gl=this._gl;if(!style){this._boundSamplers[location$1]=null,gl.bindSampler(location$1,null);return}let sampler=this._getGlSampler(style);this._boundSamplers[location$1]!==sampler&&(this._boundSamplers[location$1]=sampler,gl.bindSampler(location$1,sampler))}unbind(texture){let source$2=texture.source,boundTextures=this._boundTextures,gl=this._gl;for(let i$1=0;i$1<boundTextures.length;i$1++)if(boundTextures[i$1]===source$2){this._activateLocation(i$1);let glTexture=this.getGlSource(source$2);gl.bindTexture(glTexture.target,null),boundTextures[i$1]=null}}_activateLocation(location$1){this._activeTextureLocation!==location$1&&(this._activeTextureLocation=location$1,this._gl.activeTexture(this._gl.TEXTURE0+location$1))}_initSource(source$2){let gl=this._gl,glTexture=new GlTexture(gl.createTexture());if(glTexture.type=this._mapFormatToType[source$2.format],glTexture.internalFormat=this._mapFormatToInternalFormat[source$2.format],glTexture.format=this._mapFormatToFormat[source$2.format],source$2.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||source$2.isPowerOfTwo)){let biggestDimension=Math.max(source$2.width,source$2.height);source$2.mipLevelCount=Math.floor(Math.log2(biggestDimension))+1}return this._glTextures[source$2.uid]=glTexture,this.managedTextures.includes(source$2)||(source$2.on(`update`,this.onSourceUpdate,this),source$2.on(`resize`,this.onSourceUpdate,this),source$2.on(`styleChange`,this.onStyleChange,this),source$2.on(`destroy`,this.onSourceDestroy,this),source$2.on(`unload`,this.onSourceUnload,this),source$2.on(`updateMipmaps`,this.onUpdateMipmaps,this),this.managedTextures.push(source$2)),this.onSourceUpdate(source$2),this.updateStyle(source$2,!1),glTexture}onStyleChange(source$2){this.updateStyle(source$2,!1)}updateStyle(source$2,firstCreation){let gl=this._gl,glTexture=this.getGlSource(source$2);gl.bindTexture(gl.TEXTURE_2D,glTexture.texture),this._boundTextures[this._activeTextureLocation]=source$2,applyStyleParams(source$2.style,gl,source$2.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,`texParameteri`,gl.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!source$2.isPowerOfTwo,firstCreation)}onSourceUnload(source$2){let glTexture=this._glTextures[source$2.uid];glTexture&&(this.unbind(source$2),this._glTextures[source$2.uid]=null,this._gl.deleteTexture(glTexture.texture))}onSourceUpdate(source$2){let gl=this._gl,glTexture=this.getGlSource(source$2);gl.bindTexture(gl.TEXTURE_2D,glTexture.texture),this._boundTextures[this._activeTextureLocation]=source$2;let premultipliedAlpha=source$2.alphaMode===`premultiply-alpha-on-upload`;this._premultiplyAlpha!==premultipliedAlpha&&(this._premultiplyAlpha=premultipliedAlpha,gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,premultipliedAlpha)),this._uploads[source$2.uploadMethodId]?this._uploads[source$2.uploadMethodId].upload(source$2,glTexture,gl,this._renderer.context.webGLVersion):gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,source$2.pixelWidth,source$2.pixelHeight,0,gl.RGBA,gl.UNSIGNED_BYTE,null),source$2.autoGenerateMipmaps&&source$2.mipLevelCount>1&&this.onUpdateMipmaps(source$2,!1)}onUpdateMipmaps(source$2,bind$2=!0){bind$2&&this.bindSource(source$2,0);let glTexture=this.getGlSource(source$2);this._gl.generateMipmap(glTexture.target)}onSourceDestroy(source$2){source$2.off(`destroy`,this.onSourceDestroy,this),source$2.off(`update`,this.onSourceUpdate,this),source$2.off(`resize`,this.onSourceUpdate,this),source$2.off(`unload`,this.onSourceUnload,this),source$2.off(`styleChange`,this.onStyleChange,this),source$2.off(`updateMipmaps`,this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(source$2),1),this.onSourceUnload(source$2)}_initSampler(style){let gl=this._gl,glSampler=this._gl.createSampler();return this._glSamplers[style._resourceId]=glSampler,applyStyleParams(style,gl,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,`samplerParameteri`,glSampler,!1,!0),this._glSamplers[style._resourceId]}_getGlSampler(sampler){return this._glSamplers[sampler._resourceId]||this._initSampler(sampler)}getGlSource(source$2){return this._glTextures[source$2.uid]||this._initSource(source$2)}generateCanvas(texture){let{pixels,width,height}=this.getPixels(texture),canvas=DOMAdapter.get().createCanvas();canvas.width=width,canvas.height=height;let ctx=canvas.getContext(`2d`);if(ctx){let imageData=ctx.createImageData(width,height);imageData.data.set(pixels),ctx.putImageData(imageData,0,0)}return canvas}getPixels(texture){let resolution=texture.source.resolution,frame=texture.frame,width=Math.max(Math.round(frame.width*resolution),1),height=Math.max(Math.round(frame.height*resolution),1),pixels=new Uint8Array(BYTES_PER_PIXEL*width*height),renderer$1=this._renderer,renderTarget=renderer$1.renderTarget.getRenderTarget(texture),glRenterTarget=renderer$1.renderTarget.getGpuRenderTarget(renderTarget),gl=renderer$1.gl;return gl.bindFramebuffer(gl.FRAMEBUFFER,glRenterTarget.resolveTargetFramebuffer),gl.readPixels(Math.round(frame.x*resolution),Math.round(frame.y*resolution),width,height,gl.RGBA,gl.UNSIGNED_BYTE,pixels),{pixels:new Uint8ClampedArray(pixels.buffer),width,height}}destroy(){this.managedTextures.slice().forEach(source$2=>this.onSourceDestroy(source$2)),this.managedTextures=null,this._glTextures=null,this._glSamplers=null,this._boundTextures=null,this._boundSamplers=null,this._mapFormatToInternalFormat=null,this._mapFormatToType=null,this._mapFormatToFormat=null,this._uploads=null,this._renderer=null}resetState(){this._activeTextureLocation=-1,this._boundTextures.fill(Texture.EMPTY.source),this._boundSamplers=Object.create(null);let gl=this._gl;this._premultiplyAlpha=!1,gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha)}};GlTextureSystem.extension={type:[ExtensionType.WebGLSystem],name:`texture`};var GlGraphicsAdaptor=class{contextChange(renderer$1){let uniforms=new UniformGroup({uColor:{value:new Float32Array([1,1,1,1]),type:`vec4<f32>`},uTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uRound:{value:0,type:`f32`}}),maxTextures=renderer$1.limits.maxBatchableTextures,glProgram$2=compileHighShaderGlProgram({name:`graphics`,bits:[colorBitGl,generateTextureBatchBitGl(maxTextures),localUniformBitGl,roundPixelsBitGl]});this.shader=new Shader({glProgram:glProgram$2,resources:{localUniforms:uniforms,batchSamplers:getBatchSamplersUniformGroup(maxTextures)}})}execute(graphicsPipe,renderable){let context$1=renderable.context,shader=context$1.customShader||this.shader,renderer$1=graphicsPipe.renderer,{batcher,instructions}=renderer$1.graphicsContext.getContextRenderData(context$1);shader.groups[0]=renderer$1.globalUniforms.bindGroup,renderer$1.state.set(graphicsPipe.state),renderer$1.shader.bind(shader),renderer$1.geometry.bind(batcher.geometry,shader.glProgram);let batches=instructions.instructions;for(let i$1=0;i$1<instructions.instructionSize;i$1++){let batch$1=batches[i$1];if(batch$1.size){for(let j$1=0;j$1<batch$1.textures.count;j$1++)renderer$1.texture.bind(batch$1.textures.textures[j$1],j$1);renderer$1.geometry.draw(batch$1.topology,batch$1.size,batch$1.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}};GlGraphicsAdaptor.extension={type:[ExtensionType.WebGLPipesAdaptor],name:`graphics`};var GlMeshAdaptor=class{init(){let glProgram$2=compileHighShaderGlProgram({name:`mesh`,bits:[localUniformBitGl,textureBitGl,roundPixelsBitGl]});this._shader=new Shader({glProgram:glProgram$2,resources:{uTexture:Texture.EMPTY.source,textureUniforms:{uTextureMatrix:{type:`mat3x3<f32>`,value:new Matrix}}}})}execute(meshPipe,mesh){let renderer$1=meshPipe.renderer,shader=mesh._shader;if(shader){if(!shader.glProgram){warn$1(`Mesh shader has no glProgram`,mesh.shader);return}}else{shader=this._shader;let texture=mesh.texture,source$2=texture.source;shader.resources.uTexture=source$2,shader.resources.uSampler=source$2.style,shader.resources.textureUniforms.uniforms.uTextureMatrix=texture.textureMatrix.mapCoord}shader.groups[100]=renderer$1.globalUniforms.bindGroup,shader.groups[101]=meshPipe.localUniformsBindGroup,renderer$1.encoder.draw({geometry:mesh._geometry,shader,state:mesh.state})}destroy(){this._shader.destroy(!0),this._shader=null}};GlMeshAdaptor.extension={type:[ExtensionType.WebGLPipesAdaptor],name:`mesh`};var CustomRenderPipe=class{constructor(renderer$1){this._renderer=renderer$1}updateRenderable(){}destroyRenderable(){}validateRenderable(){return!1}addRenderable(container,instructionSet){this._renderer.renderPipes.batch.break(instructionSet),instructionSet.add(container)}execute(container){container.isRenderable&&container.render(this._renderer)}destroy(){this._renderer=null}};CustomRenderPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`customRender`};var BatchableSprite=class{constructor(){this.batcherName=`default`,this.topology=`triangle-list`,this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}destroy(){}};function executeInstructions(renderGroup,renderer$1){let instructionSet=renderGroup.instructionSet,instructions=instructionSet.instructions;for(let i$1=0;i$1<instructionSet.instructionSize;i$1++){let instruction=instructions[i$1];renderer$1[instruction.renderPipeId].execute(instruction)}}var tempMatrix$1=new Matrix,RenderGroupPipe=class{constructor(renderer$1){this._renderer=renderer$1}addRenderGroup(renderGroup,instructionSet){renderGroup.isCachedAsTexture?this._addRenderableCacheAsTexture(renderGroup,instructionSet):this._addRenderableDirect(renderGroup,instructionSet)}execute(renderGroup){renderGroup.isRenderable&&(renderGroup.isCachedAsTexture?this._executeCacheAsTexture(renderGroup):this._executeDirect(renderGroup))}destroy(){this._renderer=null}_addRenderableDirect(renderGroup,instructionSet){this._renderer.renderPipes.batch.break(instructionSet),renderGroup._batchableRenderGroup&&=(BigPool.return(renderGroup._batchableRenderGroup),null),instructionSet.add(renderGroup)}_addRenderableCacheAsTexture(renderGroup,instructionSet){let batchableRenderGroup=renderGroup._batchableRenderGroup??=BigPool.get(BatchableSprite);batchableRenderGroup.renderable=renderGroup.root,batchableRenderGroup.transform=renderGroup.root.relativeGroupTransform,batchableRenderGroup.texture=renderGroup.texture,batchableRenderGroup.bounds=renderGroup._textureBounds,instructionSet.add(renderGroup),this._renderer.renderPipes.blendMode.pushBlendMode(renderGroup,renderGroup.root.groupBlendMode,instructionSet),this._renderer.renderPipes.batch.addToBatch(batchableRenderGroup,instructionSet),this._renderer.renderPipes.blendMode.popBlendMode(instructionSet)}_executeCacheAsTexture(renderGroup){if(renderGroup.textureNeedsUpdate){renderGroup.textureNeedsUpdate=!1;let worldTransformMatrix=tempMatrix$1.identity().translate(-renderGroup._textureBounds.x,-renderGroup._textureBounds.y);this._renderer.renderTarget.push(renderGroup.texture,!0,null,renderGroup.texture.frame),this._renderer.globalUniforms.push({worldTransformMatrix,worldColor:4294967295,offset:{x:0,y:0}}),executeInstructions(renderGroup,this._renderer.renderPipes),this._renderer.renderTarget.finishRenderPass(),this._renderer.renderTarget.pop(),this._renderer.globalUniforms.pop()}renderGroup._batchableRenderGroup._batcher.updateElement(renderGroup._batchableRenderGroup),renderGroup._batchableRenderGroup._batcher.geometry.buffers[0].update()}_executeDirect(renderGroup){this._renderer.globalUniforms.push({worldTransformMatrix:renderGroup.inverseParentTextureTransform,worldColor:renderGroup.worldColorAlpha}),executeInstructions(renderGroup,this._renderer.renderPipes),this._renderer.globalUniforms.pop()}};RenderGroupPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`renderGroup`};function clearList(list,index){index||=0;for(let j$1=index;j$1<list.length&&list[j$1];j$1++)list[j$1]=null}var tempContainer=new Container,UPDATE_BLEND_COLOR_VISIBLE=7;function updateRenderGroupTransforms(renderGroup,updateChildRenderGroups=!1){updateRenderGroupTransform(renderGroup);let childrenToUpdate=renderGroup.childrenToUpdate,updateTick=renderGroup.updateTick++;for(let j$1 in childrenToUpdate){let renderGroupDepth=Number(j$1),childrenAtDepth=childrenToUpdate[j$1],list=childrenAtDepth.list,index=childrenAtDepth.index;for(let i$1=0;i$1<index;i$1++){let child=list[i$1];child.parentRenderGroup===renderGroup&&child.relativeRenderGroupDepth===renderGroupDepth&&updateTransformAndChildren(child,updateTick,0)}clearList(list,index),childrenAtDepth.index=0}if(updateChildRenderGroups)for(let i$1=0;i$1<renderGroup.renderGroupChildren.length;i$1++)updateRenderGroupTransforms(renderGroup.renderGroupChildren[i$1],updateChildRenderGroups)}function updateRenderGroupTransform(renderGroup){let root=renderGroup.root,worldAlpha;if(renderGroup.renderGroupParent){let renderGroupParent=renderGroup.renderGroupParent;renderGroup.worldTransform.appendFrom(root.relativeGroupTransform,renderGroupParent.worldTransform),renderGroup.worldColor=multiplyColors(root.groupColor,renderGroupParent.worldColor),worldAlpha=root.groupAlpha*renderGroupParent.worldAlpha}else renderGroup.worldTransform.copyFrom(root.localTransform),renderGroup.worldColor=root.localColor,worldAlpha=root.localAlpha;worldAlpha=worldAlpha<0?0:worldAlpha>1?1:worldAlpha,renderGroup.worldAlpha=worldAlpha,renderGroup.worldColorAlpha=renderGroup.worldColor+((worldAlpha*255|0)<<24)}function updateTransformAndChildren(container,updateTick,updateFlags){if(updateTick===container.updateTick)return;container.updateTick=updateTick,container.didChange=!1;let localTransform=container.localTransform;container.updateLocalTransform();let parent=container.parent;if(parent&&!parent.renderGroup?(updateFlags|=container._updateFlags,container.relativeGroupTransform.appendFrom(localTransform,parent.relativeGroupTransform),updateFlags&UPDATE_BLEND_COLOR_VISIBLE&&updateColorBlendVisibility(container,parent,updateFlags)):(updateFlags=container._updateFlags,container.relativeGroupTransform.copyFrom(localTransform),updateFlags&UPDATE_BLEND_COLOR_VISIBLE&&updateColorBlendVisibility(container,tempContainer,updateFlags)),!container.renderGroup){let children=container.children,length$1=children.length;for(let i$1=0;i$1<length$1;i$1++)updateTransformAndChildren(children[i$1],updateTick,updateFlags);let renderGroup=container.parentRenderGroup,renderable=container;renderable.renderPipeId&&!renderGroup.structureDidChange&&renderGroup.updateRenderable(renderable)}}function updateColorBlendVisibility(container,parent,updateFlags){if(updateFlags&1){container.groupColor=multiplyColors(container.localColor,parent.groupColor);let groupAlpha=container.localAlpha*parent.groupAlpha;groupAlpha=groupAlpha<0?0:groupAlpha>1?1:groupAlpha,container.groupAlpha=groupAlpha,container.groupColorAlpha=container.groupColor+((groupAlpha*255|0)<<24)}updateFlags&2&&(container.groupBlendMode=container.localBlendMode===`inherit`?parent.groupBlendMode:container.localBlendMode),updateFlags&4&&(container.globalDisplayStatus=container.localDisplayStatus&parent.globalDisplayStatus),container._updateFlags=0}function validateRenderables(renderGroup,renderPipes$2){let{list}=renderGroup.childrenRenderablesToUpdate,rebuildRequired=!1;for(let i$1=0;i$1<renderGroup.childrenRenderablesToUpdate.index;i$1++){let container=list[i$1];if(rebuildRequired=renderPipes$2[container.renderPipeId].validateRenderable(container),rebuildRequired)break}return renderGroup.structureDidChange=rebuildRequired,rebuildRequired}var tempMatrix=new Matrix,RenderGroupSystem=class{constructor(renderer$1){this._renderer=renderer$1}render({container,transform}){let parent=container.parent,renderGroupParent=container.renderGroup.renderGroupParent;container.parent=null,container.renderGroup.renderGroupParent=null;let renderer$1=this._renderer,originalLocalTransform=tempMatrix;transform&&(originalLocalTransform.copyFrom(container.renderGroup.localTransform),container.renderGroup.localTransform.copyFrom(transform));let renderPipes$2=renderer$1.renderPipes;this._updateCachedRenderGroups(container.renderGroup,null),this._updateRenderGroups(container.renderGroup),renderer$1.globalUniforms.start({worldTransformMatrix:transform?container.renderGroup.localTransform:container.renderGroup.worldTransform,worldColor:container.renderGroup.worldColorAlpha}),executeInstructions(container.renderGroup,renderPipes$2),renderPipes$2.uniformBatch&&renderPipes$2.uniformBatch.renderEnd(),transform&&container.renderGroup.localTransform.copyFrom(originalLocalTransform),container.parent=parent,container.renderGroup.renderGroupParent=renderGroupParent}destroy(){this._renderer=null}_updateCachedRenderGroups(renderGroup,closestCacheAsTexture){if(renderGroup._parentCacheAsTextureRenderGroup=closestCacheAsTexture,renderGroup.isCachedAsTexture){if(!renderGroup.textureNeedsUpdate)return;closestCacheAsTexture=renderGroup}for(let i$1=renderGroup.renderGroupChildren.length-1;i$1>=0;i$1--)this._updateCachedRenderGroups(renderGroup.renderGroupChildren[i$1],closestCacheAsTexture);if(renderGroup.invalidateMatrices(),renderGroup.isCachedAsTexture){if(renderGroup.textureNeedsUpdate){let bounds=renderGroup.root.getLocalBounds();bounds.ceil();let lastTexture=renderGroup.texture;renderGroup.texture&&TexturePool.returnTexture(renderGroup.texture,!0);let renderer$1=this._renderer,resolution=renderGroup.textureOptions.resolution||renderer$1.view.resolution,antialias=renderGroup.textureOptions.antialias??renderer$1.view.antialias,scaleMode=renderGroup.textureOptions.scaleMode??`linear`,texture=TexturePool.getOptimalTexture(bounds.width,bounds.height,resolution,antialias);texture._source.style=new TextureStyle({scaleMode}),renderGroup.texture=texture,renderGroup._textureBounds||=new Bounds,renderGroup._textureBounds.copyFrom(bounds),lastTexture!==renderGroup.texture&&renderGroup.renderGroupParent&&(renderGroup.renderGroupParent.structureDidChange=!0)}}else renderGroup.texture&&=(TexturePool.returnTexture(renderGroup.texture,!0),null)}_updateRenderGroups(renderGroup){let renderer$1=this._renderer,renderPipes$2=renderer$1.renderPipes;if(renderGroup.runOnRender(renderer$1),renderGroup.instructionSet.renderPipes=renderPipes$2,renderGroup.structureDidChange?clearList(renderGroup.childrenRenderablesToUpdate.list,0):validateRenderables(renderGroup,renderPipes$2),updateRenderGroupTransforms(renderGroup),renderGroup.structureDidChange?(renderGroup.structureDidChange=!1,this._buildInstructions(renderGroup,renderer$1)):this._updateRenderables(renderGroup),renderGroup.childrenRenderablesToUpdate.index=0,renderer$1.renderPipes.batch.upload(renderGroup.instructionSet),!(renderGroup.isCachedAsTexture&&!renderGroup.textureNeedsUpdate))for(let i$1=0;i$1<renderGroup.renderGroupChildren.length;i$1++)this._updateRenderGroups(renderGroup.renderGroupChildren[i$1])}_updateRenderables(renderGroup){let{list,index}=renderGroup.childrenRenderablesToUpdate;for(let i$1=0;i$1<index;i$1++){let container=list[i$1];container.didViewUpdate&&renderGroup.updateRenderable(container)}clearList(list,index)}_buildInstructions(renderGroup,rendererOrPipes){let root=renderGroup.root,instructionSet=renderGroup.instructionSet;instructionSet.reset();let renderer$1=rendererOrPipes.renderPipes?rendererOrPipes:rendererOrPipes.batch.renderer,renderPipes$2=renderer$1.renderPipes;renderPipes$2.batch.buildStart(instructionSet),renderPipes$2.blendMode.buildStart(),renderPipes$2.colorMask.buildStart(),root.sortableChildren&&root.sortChildren(),root.collectRenderablesWithEffects(instructionSet,renderer$1,null),renderPipes$2.batch.buildEnd(instructionSet),renderPipes$2.blendMode.buildEnd(instructionSet)}};RenderGroupSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`renderGroup`};var SpritePipe=class{constructor(renderer$1){this._renderer=renderer$1}addRenderable(sprite,instructionSet){let gpuSprite=this._getGpuSprite(sprite);sprite.didViewUpdate&&this._updateBatchableSprite(sprite,gpuSprite),this._renderer.renderPipes.batch.addToBatch(gpuSprite,instructionSet)}updateRenderable(sprite){let gpuSprite=this._getGpuSprite(sprite);sprite.didViewUpdate&&this._updateBatchableSprite(sprite,gpuSprite),gpuSprite._batcher.updateElement(gpuSprite)}validateRenderable(sprite){let gpuSprite=this._getGpuSprite(sprite);return!gpuSprite._batcher.checkAndUpdateTexture(gpuSprite,sprite._texture)}_updateBatchableSprite(sprite,batchableSprite){batchableSprite.bounds=sprite.visualBounds,batchableSprite.texture=sprite._texture}_getGpuSprite(sprite){return sprite._gpuData[this._renderer.uid]||this._initGPUSprite(sprite)}_initGPUSprite(sprite){let batchableSprite=new BatchableSprite;return batchableSprite.renderable=sprite,batchableSprite.transform=sprite.groupTransform,batchableSprite.texture=sprite._texture,batchableSprite.bounds=sprite.visualBounds,batchableSprite.roundPixels=this._renderer._roundPixels|sprite._roundPixels,sprite._gpuData[this._renderer.uid]=batchableSprite,batchableSprite}destroy(){this._renderer=null}};SpritePipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`sprite`};var _BackgroundSystem=class _BackgroundSystem$1{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Color(0),this.color=this._backgroundColor,this.alpha=1}init(options){options={..._BackgroundSystem$1.defaultOptions,...options},this.clearBeforeRender=options.clearBeforeRender,this.color=options.background||options.backgroundColor||this._backgroundColor,this.alpha=options.backgroundAlpha,this._backgroundColor.setAlpha(options.backgroundAlpha)}get color(){return this._backgroundColor}set color(value){Color.shared.setValue(value).alpha<1&&this._backgroundColor.alpha===1&&warn$1(`Cannot set a transparent background on an opaque canvas. To enable transparency, set backgroundAlpha < 1 when initializing your Application.`),this._backgroundColor.setValue(value)}get alpha(){return this._backgroundColor.alpha}set alpha(value){this._backgroundColor.setAlpha(value)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};_BackgroundSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`background`,priority:0},_BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};var BackgroundSystem=_BackgroundSystem,BLEND_MODE_FILTERS={};extensions$1.handle(ExtensionType.BlendMode,value=>{if(!value.name)throw Error(`BlendMode extension must have a name property`);BLEND_MODE_FILTERS[value.name]=value.ref},value=>{delete BLEND_MODE_FILTERS[value.name]});var BlendModePipe=class{constructor(renderer$1){this._blendModeStack=[],this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=renderer$1,this._renderer.runners.prerender.add(this)}prerender(){this._activeBlendMode=`normal`,this._isAdvanced=!1}pushBlendMode(renderable,blendMode,instructionSet){this._blendModeStack.push(blendMode),this.setBlendMode(renderable,blendMode,instructionSet)}popBlendMode(instructionSet){this._blendModeStack.pop();let blendMode=this._blendModeStack[this._activeBlendMode.length-1]??`normal`;this.setBlendMode(null,blendMode,instructionSet)}setBlendMode(renderable,blendMode,instructionSet){let isRenderGroup=renderable instanceof RenderGroup;if(this._activeBlendMode===blendMode){this._isAdvanced&&renderable&&!isRenderGroup&&this._renderableList?.push(renderable);return}this._isAdvanced&&this._endAdvancedBlendMode(instructionSet),this._activeBlendMode=blendMode,renderable&&(this._isAdvanced=!!BLEND_MODE_FILTERS[blendMode],this._isAdvanced&&this._beginAdvancedBlendMode(renderable,instructionSet))}_beginAdvancedBlendMode(renderable,instructionSet){this._renderer.renderPipes.batch.break(instructionSet);let blendMode=this._activeBlendMode;if(!BLEND_MODE_FILTERS[blendMode]){warn$1(`Unable to assign BlendMode: '${blendMode}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);return}let filterEffect=this._ensureFilterEffect(blendMode),isRenderGroup=renderable instanceof RenderGroup,instruction={renderPipeId:`filter`,action:`pushFilter`,filterEffect,renderables:isRenderGroup?null:[renderable],container:isRenderGroup?renderable.root:null,canBundle:!1};this._renderableList=instruction.renderables,instructionSet.add(instruction)}_ensureFilterEffect(blendMode){let filterEffect=this._filterHash[blendMode];return filterEffect||(filterEffect=this._filterHash[blendMode]=new FilterEffect,filterEffect.filters=[new BLEND_MODE_FILTERS[blendMode]]),filterEffect}_endAdvancedBlendMode(instructionSet){this._isAdvanced=!1,this._renderableList=null,this._renderer.renderPipes.batch.break(instructionSet),instructionSet.add({renderPipeId:`filter`,action:`popFilter`,canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(instructionSet){this._isAdvanced&&this._endAdvancedBlendMode(instructionSet)}destroy(){for(let i$1 in this._renderer=null,this._renderableList=null,this._filterHash)this._filterHash[i$1].destroy();this._filterHash=null}};BlendModePipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`blendMode`};var imageTypes={png:`image/png`,jpg:`image/jpeg`,webp:`image/webp`},_ExtractSystem=class _ExtractSystem$1{constructor(renderer$1){this._renderer=renderer$1}_normalizeOptions(options,defaults$1={}){return options instanceof Container||options instanceof Texture?{target:options,...defaults$1}:{...defaults$1,...options}}async image(options){let image=DOMAdapter.get().createImage();return image.src=await this.base64(options),image}async base64(options){options=this._normalizeOptions(options,_ExtractSystem$1.defaultImageOptions);let{format:format$1,quality}=options,canvas=this.canvas(options);if(canvas.toBlob!==void 0)return new Promise((resolve$1,reject)=>{canvas.toBlob(blob=>{if(!blob){reject(Error(`ICanvas.toBlob failed!`));return}let reader=new FileReader;reader.onload=()=>resolve$1(reader.result),reader.onerror=reject,reader.readAsDataURL(blob)},imageTypes[format$1],quality)});if(canvas.toDataURL!==void 0)return canvas.toDataURL(imageTypes[format$1],quality);if(canvas.convertToBlob!==void 0){let blob=await canvas.convertToBlob({type:imageTypes[format$1],quality});return new Promise((resolve$1,reject)=>{let reader=new FileReader;reader.onload=()=>resolve$1(reader.result),reader.onerror=reject,reader.readAsDataURL(blob)})}throw Error(`Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented`)}canvas(options){options=this._normalizeOptions(options);let target=options.target,renderer$1=this._renderer;if(target instanceof Texture)return renderer$1.texture.generateCanvas(target);let texture=renderer$1.textureGenerator.generateTexture(options),canvas=renderer$1.texture.generateCanvas(texture);return texture.destroy(!0),canvas}pixels(options){options=this._normalizeOptions(options);let target=options.target,renderer$1=this._renderer,texture=target instanceof Texture?target:renderer$1.textureGenerator.generateTexture(options),pixelInfo=renderer$1.texture.getPixels(texture);return target instanceof Container&&texture.destroy(!0),pixelInfo}texture(options){return options=this._normalizeOptions(options),options.target instanceof Texture?options.target:this._renderer.textureGenerator.generateTexture(options)}download(options){options=this._normalizeOptions(options);let canvas=this.canvas(options),link=document.createElement(`a`);link.download=options.filename??`image.png`,link.href=canvas.toDataURL(`image/png`),document.body.appendChild(link),link.click(),document.body.removeChild(link)}log(options){let width=options.width??200;options=this._normalizeOptions(options);let canvas=this.canvas(options),base64=canvas.toDataURL();console.log(`[Pixi Texture] ${canvas.width}px ${canvas.height}px`);let style=[`font-size: 1px;`,`padding: ${width}px 300px;`,`background: url(${base64}) no-repeat;`,`background-size: contain;`].join(` `);console.log(`%c `,style)}destroy(){this._renderer=null}};_ExtractSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`extract`},_ExtractSystem.defaultImageOptions={format:`png`,quality:1};var ExtractSystem=_ExtractSystem,RenderTexture=class RenderTexture extends Texture{static create(options){return new RenderTexture({source:new TextureSource(options)})}resize(width,height,resolution){return this.source.resize(width,height,resolution),this}},tempRect=new Rectangle,tempBounds$1=new Bounds,noColor=[0,0,0,0],GenerateTextureSystem=class{constructor(renderer$1){this._renderer=renderer$1}generateTexture(options){options instanceof Container&&(options={target:options,frame:void 0,textureSourceOptions:{},resolution:void 0});let resolution=options.resolution||this._renderer.resolution,antialias=options.antialias||this._renderer.view.antialias,container=options.target,clearColor=options.clearColor;clearColor=clearColor?Array.isArray(clearColor)&&clearColor.length===4?clearColor:Color.shared.setValue(clearColor).toArray():noColor;let region=options.frame?.copyTo(tempRect)||getLocalBounds(container,tempBounds$1).rectangle;region.width=Math.max(region.width,1/resolution)|0,region.height=Math.max(region.height,1/resolution)|0;let target=RenderTexture.create({...options.textureSourceOptions,width:region.width,height:region.height,resolution,antialias}),transform=Matrix.shared.translate(-region.x,-region.y);return this._renderer.render({container,transform,target,clearColor}),target.source.updateMipmaps(),target}destroy(){this._renderer=null}};GenerateTextureSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`textureGenerator`};function color32BitToUniform(abgr,out$2,offset){let alpha=(abgr>>24&255)/255;out$2[offset++]=(abgr&255)/255*alpha,out$2[offset++]=(abgr>>8&255)/255*alpha,out$2[offset++]=(abgr>>16&255)/255*alpha,out$2[offset++]=alpha}var GlobalUniformSystem=class{constructor(renderer$1){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=renderer$1}reset(){this._stackIndex=0;for(let i$1=0;i$1<this._activeUniforms.length;i$1++)this._uniformsPool.push(this._activeUniforms[i$1]);for(let i$1=0;i$1<this._activeBindGroups.length;i$1++)this._bindGroupPool.push(this._activeBindGroups[i$1]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(options){this.reset(),this.push(options)}bind({size,projectionMatrix,worldTransformMatrix,worldColor,offset}){let renderTarget=this._renderer.renderTarget.renderTarget,currentGlobalUniformData=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:renderTarget,worldTransformMatrix:new Matrix,worldColor:4294967295,offset:new Point$1},globalUniformData={projectionMatrix:projectionMatrix||this._renderer.renderTarget.projectionMatrix,resolution:size||renderTarget.size,worldTransformMatrix:worldTransformMatrix||currentGlobalUniformData.worldTransformMatrix,worldColor:worldColor||currentGlobalUniformData.worldColor,offset:offset||currentGlobalUniformData.offset,bindGroup:null},uniformGroup=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(uniformGroup);let uniforms=uniformGroup.uniforms;uniforms.uProjectionMatrix=globalUniformData.projectionMatrix,uniforms.uResolution=globalUniformData.resolution,uniforms.uWorldTransformMatrix.copyFrom(globalUniformData.worldTransformMatrix),uniforms.uWorldTransformMatrix.tx-=globalUniformData.offset.x,uniforms.uWorldTransformMatrix.ty-=globalUniformData.offset.y,color32BitToUniform(globalUniformData.worldColor,uniforms.uWorldColorAlpha,0),uniformGroup.update();let bindGroup;this._renderer.renderPipes.uniformBatch?bindGroup=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(uniformGroup,!1):(bindGroup=this._bindGroupPool.pop()||new BindGroup,this._activeBindGroups.push(bindGroup),bindGroup.setResource(uniformGroup,0)),globalUniformData.bindGroup=bindGroup,this._currentGlobalUniformData=globalUniformData}push(options){this.bind(options),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===RendererType.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get globalUniformData(){return this._currentGlobalUniformData}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new UniformGroup({uProjectionMatrix:{value:new Matrix,type:`mat3x3<f32>`},uWorldTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uWorldColorAlpha:{value:new Float32Array(4),type:`vec4<f32>`},uResolution:{value:[0,0],type:`vec2<f32>`}},{isStatic:!0})}destroy(){this._renderer=null,this._globalUniformDataStack.length=0,this._uniformsPool.length=0,this._activeUniforms.length=0,this._bindGroupPool.length=0,this._activeBindGroups.length=0,this._currentGlobalUniformData=null}};GlobalUniformSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`globalUniforms`};var uid=1,SchedulerSystem=class{constructor(){this._tasks=[],this._offset=0}init(){Ticker.system.add(this._update,this)}repeat(func,duration,useOffset=!0){let id=uid++,offset=0;return useOffset&&(this._offset+=1e3,offset=this._offset),this._tasks.push({func,duration,start:performance.now(),offset,last:performance.now(),repeat:!0,id}),id}cancel(id){for(let i$1=0;i$1<this._tasks.length;i$1++)if(this._tasks[i$1].id===id){this._tasks.splice(i$1,1);return}}_update(){let now=performance.now();for(let i$1=0;i$1<this._tasks.length;i$1++){let task=this._tasks[i$1];if(now-task.offset-task.last>=task.duration){let elapsed=now-task.start;task.func(elapsed),task.last=now}}}destroy(){Ticker.system.remove(this._update,this),this._tasks.length=0}};SchedulerSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`scheduler`,priority:0};var saidHello=!1;function sayHello(type){if(!saidHello){if(DOMAdapter.get().getNavigator().userAgent.toLowerCase().indexOf(`chrome`)>-1){let args=[`%c  %c  %c  %c  %c PixiJS %c v${VERSION} (${type}) http://www.pixijs.com/

`,`background: #E72264; padding:5px 0;`,`background: #6CA2EA; padding:5px 0;`,`background: #B5D33D; padding:5px 0;`,`background: #FED23F; padding:5px 0;`,`color: #FFFFFF; background: #E72264; padding:5px 0;`,`color: #E72264; background: #FFFFFF; padding:5px 0;`];globalThis.console.log(...args)}else globalThis.console&&globalThis.console.log(`PixiJS ${VERSION} - ${type} - http://www.pixijs.com/`);saidHello=!0}}var HelloSystem=class{constructor(renderer$1){this._renderer=renderer$1}init(options){if(options.hello){let name=this._renderer.name;this._renderer.type===RendererType.WEBGL&&(name+=` ${this._renderer.context.webGLVersion}`),sayHello(name)}}};HelloSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`hello`,priority:-2},HelloSystem.defaultOptions={hello:!1};function cleanHash(hash){let clean=!1;for(let i$1 in hash)if(hash[i$1]==null){clean=!0;break}if(!clean)return hash;let cleanHash2=Object.create(null);for(let i$1 in hash){let value=hash[i$1];value&&(cleanHash2[i$1]=value)}return cleanHash2}function cleanArray(arr){let offset=0;for(let i$1=0;i$1<arr.length;i$1++)arr[i$1]==null?offset++:arr[i$1-offset]=arr[i$1];return arr.length-=offset,arr}var renderableGCTick=0,_RenderableGCSystem=class _RenderableGCSystem$1{constructor(renderer$1){this._managedRenderables=[],this._managedHashes=[],this._managedArrays=[],this._renderer=renderer$1}init(options){options={..._RenderableGCSystem$1.defaultOptions,...options},this.maxUnusedTime=options.renderableGCMaxUnusedTime,this._frequency=options.renderableGCFrequency,this.enabled=options.renderableGCActive}get enabled(){return!!this._handler}set enabled(value){this.enabled!==value&&(value?(this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency,!1),this._hashHandler=this._renderer.scheduler.repeat(()=>{for(let hash of this._managedHashes)hash.context[hash.hash]=cleanHash(hash.context[hash.hash])},this._frequency),this._arrayHandler=this._renderer.scheduler.repeat(()=>{for(let array of this._managedArrays)cleanArray(array.context[array.hash])},this._frequency)):(this._renderer.scheduler.cancel(this._handler),this._renderer.scheduler.cancel(this._hashHandler),this._renderer.scheduler.cancel(this._arrayHandler)))}addManagedHash(context$1,hash){this._managedHashes.push({context:context$1,hash})}addManagedArray(context$1,hash){this._managedArrays.push({context:context$1,hash})}prerender({container}){this._now=performance.now(),container.renderGroup.gcTick=renderableGCTick++,this._updateInstructionGCTick(container.renderGroup,container.renderGroup.gcTick)}addRenderable(renderable){this.enabled&&(renderable._lastUsed===-1&&(this._managedRenderables.push(renderable),renderable.once(`destroyed`,this._removeRenderable,this)),renderable._lastUsed=this._now)}run(){let now=this._now,managedRenderables=this._managedRenderables,renderPipes$2=this._renderer.renderPipes,offset=0;for(let i$1=0;i$1<managedRenderables.length;i$1++){let renderable=managedRenderables[i$1];if(renderable===null){offset++;continue}let renderGroup=renderable.renderGroup??renderable.parentRenderGroup,currentTick=renderGroup?.instructionSet?.gcTick??-1;if((renderGroup?.gcTick??0)===currentTick&&(renderable._lastUsed=now),now-renderable._lastUsed>this.maxUnusedTime){if(!renderable.destroyed){let rp=renderPipes$2;renderGroup&&(renderGroup.structureDidChange=!0),rp[renderable.renderPipeId].destroyRenderable(renderable)}renderable._lastUsed=-1,offset++,renderable.off(`destroyed`,this._removeRenderable,this)}else managedRenderables[i$1-offset]=renderable}managedRenderables.length-=offset}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0,this._managedHashes.length=0,this._managedArrays.length=0}_removeRenderable(renderable){let index=this._managedRenderables.indexOf(renderable);index>=0&&(renderable.off(`destroyed`,this._removeRenderable,this),this._managedRenderables[index]=null)}_updateInstructionGCTick(renderGroup,gcTick){renderGroup.instructionSet.gcTick=gcTick;for(let child of renderGroup.renderGroupChildren)this._updateInstructionGCTick(child,gcTick)}};_RenderableGCSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`renderableGC`,priority:0},_RenderableGCSystem.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};var RenderableGCSystem=_RenderableGCSystem,_TextureGCSystem=class _TextureGCSystem$1{constructor(renderer$1){this._renderer=renderer$1,this.count=0,this.checkCount=0}init(options){options={..._TextureGCSystem$1.defaultOptions,...options},this.checkCountMax=options.textureGCCheckCountMax,this.maxIdle=options.textureGCAMaxIdle??options.textureGCMaxIdle,this.active=options.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let managedTextures=this._renderer.texture.managedTextures;for(let i$1=0;i$1<managedTextures.length;i$1++){let texture=managedTextures[i$1];texture.autoGarbageCollect&&texture.resource&&texture._touched>-1&&this.count-texture._touched>this.maxIdle&&(texture._touched=-1,texture.unload())}}destroy(){this._renderer=null}};_TextureGCSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:`textureGC`},_TextureGCSystem.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:3600,textureGCCheckCountMax:600};var TextureGCSystem=_TextureGCSystem,_ViewSystem=class _ViewSystem$1{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(value){this.texture.source.autoDensity=value}get resolution(){return this.texture.source._resolution}set resolution(value){this.texture.source.resize(this.texture.source.width,this.texture.source.height,value)}init(options){options={..._ViewSystem$1.defaultOptions,...options},options.view&&(deprecation(v8_0_0,`ViewSystem.view has been renamed to ViewSystem.canvas`),options.canvas=options.view),this.screen=new Rectangle(0,0,options.width,options.height),this.canvas=options.canvas||DOMAdapter.get().createCanvas(),this.antialias=!!options.antialias,this.texture=getCanvasTexture(this.canvas,options),this.renderTarget=new RenderTarget({colorTextures:[this.texture],depth:!!options.depth,isRoot:!0}),this.texture.source.transparent=options.backgroundAlpha<1,this.resolution=options.resolution}resize(desiredScreenWidth,desiredScreenHeight,resolution){this.texture.source.resize(desiredScreenWidth,desiredScreenHeight,resolution),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(options=!1){(typeof options==`boolean`?options:options?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.texture.destroy()}};_ViewSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`view`,priority:0},_ViewSystem.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};var SharedSystems=[BackgroundSystem,GlobalUniformSystem,HelloSystem,_ViewSystem,RenderGroupSystem,TextureGCSystem,GenerateTextureSystem,ExtractSystem,RendererInitHook,RenderableGCSystem,SchedulerSystem],SharedRenderPipes=[BlendModePipe,BatcherPipe,SpritePipe,RenderGroupPipe,AlphaMaskPipe,StencilMaskPipe,ColorMaskPipe,CustomRenderPipe],DefaultWebGLSystems=[...SharedSystems,GlUboSystem,GlBackBufferSystem,GlContextSystem,GlLimitsSystem,GlBufferSystem,GlTextureSystem,GlRenderTargetSystem,GlGeometrySystem,GlUniformGroupSystem,GlShaderSystem,GlEncoderSystem,GlStateSystem,GlStencilSystem,GlColorMaskSystem],DefaultWebGLPipes=[...SharedRenderPipes],DefaultWebGLAdapters=[GlBatchAdaptor,GlMeshAdaptor,GlGraphicsAdaptor],systems$1=[],renderPipes$1=[],renderPipeAdaptors$1=[];extensions$1.handleByNamedList(ExtensionType.WebGLSystem,systems$1),extensions$1.handleByNamedList(ExtensionType.WebGLPipes,renderPipes$1),extensions$1.handleByNamedList(ExtensionType.WebGLPipesAdaptor,renderPipeAdaptors$1),extensions$1.add(...DefaultWebGLSystems,...DefaultWebGLPipes,...DefaultWebGLAdapters);var WebGLRenderer=class extends AbstractRenderer{constructor(){let systemConfig={name:`webgl`,type:RendererType.WEBGL,systems:systems$1,renderPipes:renderPipes$1,renderPipeAdaptors:renderPipeAdaptors$1};super(systemConfig)}},BindGroupSystem=class{constructor(renderer$1){this._hash=Object.create(null),this._renderer=renderer$1,this._renderer.renderableGC.addManagedHash(this,`_hash`)}contextChange(gpu){this._gpu=gpu}getBindGroup(bindGroup,program,groupIndex){return bindGroup._updateKey(),this._hash[bindGroup._key]||this._createBindGroup(bindGroup,program,groupIndex)}_createBindGroup(group,program,groupIndex){let device=this._gpu.device,groupLayout=program.layout[groupIndex],entries=[],renderer$1=this._renderer;for(let j$1 in groupLayout){let resource=group.resources[j$1]??group.resources[groupLayout[j$1]],gpuResource;if(resource._resourceType===`uniformGroup`){let uniformGroup=resource;renderer$1.ubo.updateUniformGroup(uniformGroup);let buffer=uniformGroup.buffer;gpuResource={buffer:renderer$1.buffer.getGPUBuffer(buffer),offset:0,size:buffer.descriptor.size}}else if(resource._resourceType===`buffer`){let buffer=resource;gpuResource={buffer:renderer$1.buffer.getGPUBuffer(buffer),offset:0,size:buffer.descriptor.size}}else if(resource._resourceType===`bufferResource`){let bufferResource=resource;gpuResource={buffer:renderer$1.buffer.getGPUBuffer(bufferResource.buffer),offset:bufferResource.offset,size:bufferResource.size}}else if(resource._resourceType===`textureSampler`){let sampler=resource;gpuResource=renderer$1.texture.getGpuSampler(sampler)}else if(resource._resourceType===`textureSource`){let texture=resource;gpuResource=renderer$1.texture.getGpuSource(texture).createView({})}entries.push({binding:groupLayout[j$1],resource:gpuResource})}let layout$2=renderer$1.shader.getProgramData(program).bindGroups[groupIndex],gpuBindGroup=device.createBindGroup({layout:layout$2,entries});return this._hash[group._key]=gpuBindGroup,gpuBindGroup}destroy(){for(let key$1 of Object.keys(this._hash))this._hash[key$1]=null;this._hash=null,this._renderer=null}};BindGroupSystem.extension={type:[ExtensionType.WebGPUSystem],name:`bindGroup`};var GpuBufferSystem=class{constructor(renderer$1){this._gpuBuffers=Object.create(null),this._managedBuffers=[],renderer$1.renderableGC.addManagedHash(this,`_gpuBuffers`)}contextChange(gpu){this._gpu=gpu}getGPUBuffer(buffer){return this._gpuBuffers[buffer.uid]||this.createGPUBuffer(buffer)}updateBuffer(buffer){let gpuBuffer=this._gpuBuffers[buffer.uid]||this.createGPUBuffer(buffer),data=buffer.data;return buffer._updateID&&data&&(buffer._updateID=0,this._gpu.device.queue.writeBuffer(gpuBuffer,0,data.buffer,0,(buffer._updateSize||data.byteLength)+3&-4)),gpuBuffer}destroyAll(){for(let id in this._gpuBuffers)this._gpuBuffers[id].destroy();this._gpuBuffers={}}createGPUBuffer(buffer){this._gpuBuffers[buffer.uid]||(buffer.on(`update`,this.updateBuffer,this),buffer.on(`change`,this.onBufferChange,this),buffer.on(`destroy`,this.onBufferDestroy,this),this._managedBuffers.push(buffer));let gpuBuffer=this._gpu.device.createBuffer(buffer.descriptor);return buffer._updateID=0,buffer.data&&(fastCopy(buffer.data.buffer,gpuBuffer.getMappedRange()),gpuBuffer.unmap()),this._gpuBuffers[buffer.uid]=gpuBuffer,gpuBuffer}onBufferChange(buffer){this._gpuBuffers[buffer.uid].destroy(),buffer._updateID=0,this._gpuBuffers[buffer.uid]=this.createGPUBuffer(buffer)}onBufferDestroy(buffer){this._managedBuffers.splice(this._managedBuffers.indexOf(buffer),1),this._destroyBuffer(buffer)}destroy(){this._managedBuffers.forEach(buffer=>this._destroyBuffer(buffer)),this._managedBuffers=null,this._gpuBuffers=null}_destroyBuffer(buffer){this._gpuBuffers[buffer.uid].destroy(),buffer.off(`update`,this.updateBuffer,this),buffer.off(`change`,this.onBufferChange,this),buffer.off(`destroy`,this.onBufferDestroy,this),this._gpuBuffers[buffer.uid]=null}};GpuBufferSystem.extension={type:[ExtensionType.WebGPUSystem],name:`buffer`};var UboBatch=class{constructor({minUniformOffsetAlignment:minUniformOffsetAlignment$1}){this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=minUniformOffsetAlignment$1,this.data=new Float32Array(65535)}clear(){this.byteIndex=0}addEmptyGroup(size){if(size>this._minUniformOffsetAlignment/4)throw Error(`UniformBufferBatch: array is too large: ${size*4}`);let start$1=this.byteIndex,newSize=start$1+size*4;if(newSize=Math.ceil(newSize/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment,newSize>this.data.length*4)throw Error(`UniformBufferBatch: ubo batch got too big`);return this.byteIndex=newSize,start$1}addGroup(array){let offset=this.addEmptyGroup(array.length);for(let i$1=0;i$1<array.length;i$1++)this.data[offset/4+i$1]=array[i$1];return offset}destroy(){this.data=null}},GpuColorMaskSystem=class{constructor(renderer$1){this._colorMaskCache=15,this._renderer=renderer$1}setMask(colorMask){this._colorMaskCache!==colorMask&&(this._colorMaskCache=colorMask,this._renderer.pipeline.setColorMask(colorMask))}destroy(){this._renderer=null,this._colorMaskCache=null}};GpuColorMaskSystem.extension={type:[ExtensionType.WebGPUSystem],name:`colorMask`};var GpuDeviceSystem=class{constructor(renderer$1){this._renderer=renderer$1}async init(options){return this._initPromise||=(options.gpu?Promise.resolve(options.gpu):this._createDeviceAndAdaptor(options)).then(gpu=>{this.gpu=gpu,this._renderer.runners.contextChange.emit(this.gpu)}),this._initPromise}contextChange(gpu){this._renderer.gpu=gpu}async _createDeviceAndAdaptor(options){let adapter=await DOMAdapter.get().getNavigator().gpu.requestAdapter({powerPreference:options.powerPreference,forceFallbackAdapter:options.forceFallbackAdapter}),requiredFeatures=[`texture-compression-bc`,`texture-compression-astc`,`texture-compression-etc2`].filter(feature=>adapter.features.has(feature)),device=await adapter.requestDevice({requiredFeatures});return{adapter,device}}destroy(){this.gpu=null,this._renderer=null}};GpuDeviceSystem.extension={type:[ExtensionType.WebGPUSystem],name:`device`},GpuDeviceSystem.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};var GpuEncoderSystem=class{constructor(renderer$1){this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=renderer$1}renderStart(){this.commandFinished=new Promise(resolve$1=>{this._resolveCommandFinished=resolve$1}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}beginRenderPass(gpuRenderTarget){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(gpuRenderTarget.descriptor)}endRenderPass(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}setViewport(viewport){this.renderPassEncoder.setViewport(viewport.x,viewport.y,viewport.width,viewport.height,0,1)}setPipelineFromGeometryProgramAndState(geometry,program,state,topology){let pipeline=this._renderer.pipeline.getPipeline(geometry,program,state,topology);this.setPipeline(pipeline)}setPipeline(pipeline){this._boundPipeline!==pipeline&&(this._boundPipeline=pipeline,this.renderPassEncoder.setPipeline(pipeline))}_setVertexBuffer(index,buffer){this._boundVertexBuffer[index]!==buffer&&(this._boundVertexBuffer[index]=buffer,this.renderPassEncoder.setVertexBuffer(index,this._renderer.buffer.updateBuffer(buffer)))}_setIndexBuffer(buffer){if(this._boundIndexBuffer===buffer)return;this._boundIndexBuffer=buffer;let indexFormat=buffer.data.BYTES_PER_ELEMENT===2?`uint16`:`uint32`;this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(buffer),indexFormat)}resetBindGroup(index){this._boundBindGroup[index]=null}setBindGroup(index,bindGroup,program){if(this._boundBindGroup[index]===bindGroup)return;this._boundBindGroup[index]=bindGroup,bindGroup._touch(this._renderer.textureGC.count);let gpuBindGroup=this._renderer.bindGroup.getBindGroup(bindGroup,program,index);this.renderPassEncoder.setBindGroup(index,gpuBindGroup)}setGeometry(geometry,program){let buffersToBind=this._renderer.pipeline.getBufferNamesToBind(geometry,program);for(let i$1 in buffersToBind)this._setVertexBuffer(parseInt(i$1,10),geometry.attributes[buffersToBind[i$1]].buffer);geometry.indexBuffer&&this._setIndexBuffer(geometry.indexBuffer)}_setShaderBindGroups(shader,skipSync){for(let i$1 in shader.groups){let bindGroup=shader.groups[i$1];skipSync||this._syncBindGroup(bindGroup),this.setBindGroup(i$1,bindGroup,shader.gpuProgram)}}_syncBindGroup(bindGroup){for(let j$1 in bindGroup.resources){let resource=bindGroup.resources[j$1];resource.isUniformGroup&&this._renderer.ubo.updateUniformGroup(resource)}}draw(options){let{geometry,shader,state,topology,size,start:start$1,instanceCount,skipSync}=options;this.setPipelineFromGeometryProgramAndState(geometry,shader.gpuProgram,state,topology),this.setGeometry(geometry,shader.gpuProgram),this._setShaderBindGroups(shader,skipSync),geometry.indexBuffer?this.renderPassEncoder.drawIndexed(size||geometry.indexBuffer.data.length,instanceCount??geometry.instanceCount,start$1||0):this.renderPassEncoder.draw(size||geometry.getSize(),instanceCount??geometry.instanceCount,start$1||0)}finishRenderPass(){this.renderPassEncoder&&=(this.renderPassEncoder.end(),null)}postrender(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}restoreRenderPass(){let descriptor=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(descriptor);let boundPipeline=this._boundPipeline,boundVertexBuffer={...this._boundVertexBuffer},boundIndexBuffer=this._boundIndexBuffer,boundBindGroup={...this._boundBindGroup};this._clearCache();let viewport=this._renderer.renderTarget.viewport;for(let i$1 in this.renderPassEncoder.setViewport(viewport.x,viewport.y,viewport.width,viewport.height,0,1),this.setPipeline(boundPipeline),boundVertexBuffer)this._setVertexBuffer(i$1,boundVertexBuffer[i$1]);for(let i$1 in boundBindGroup)this.setBindGroup(i$1,boundBindGroup[i$1],null);this._setIndexBuffer(boundIndexBuffer)}_clearCache(){for(let i$1=0;i$1<16;i$1++)this._boundBindGroup[i$1]=null,this._boundVertexBuffer[i$1]=null;this._boundIndexBuffer=null,this._boundPipeline=null}destroy(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}contextChange(gpu){this._gpu=gpu}};GpuEncoderSystem.extension={type:[ExtensionType.WebGPUSystem],name:`encoder`,priority:1};var GpuLimitsSystem=class{constructor(renderer$1){this._renderer=renderer$1}contextChange(){this.maxTextures=this._renderer.device.gpu.device.limits.maxSampledTexturesPerShaderStage,this.maxBatchableTextures=this.maxTextures}destroy(){}};GpuLimitsSystem.extension={type:[ExtensionType.WebGPUSystem],name:`limits`};var GpuStencilSystem=class{constructor(renderer$1){this._renderTargetStencilState=Object.create(null),this._renderer=renderer$1,renderer$1.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(renderTarget){let stencilState=this._renderTargetStencilState[renderTarget.uid];stencilState||=this._renderTargetStencilState[renderTarget.uid]={stencilMode:STENCIL_MODES.DISABLED,stencilReference:0},this._activeRenderTarget=renderTarget,this.setStencilMode(stencilState.stencilMode,stencilState.stencilReference)}setStencilMode(stencilMode,stencilReference){let stencilState=this._renderTargetStencilState[this._activeRenderTarget.uid];stencilState.stencilMode=stencilMode,stencilState.stencilReference=stencilReference;let renderer$1=this._renderer;renderer$1.pipeline.setStencilMode(stencilMode),renderer$1.encoder.renderPassEncoder.setStencilReference(stencilReference)}destroy(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}};GpuStencilSystem.extension={type:[ExtensionType.WebGPUSystem],name:`stencil`};var WGSL_ALIGN_SIZE_DATA={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function createUboElementsWGSL(uniformData){let uboElements=uniformData.map(data=>({data,offset:0,size:0})),offset=0;for(let i$1=0;i$1<uboElements.length;i$1++){let uboElement=uboElements[i$1],size=WGSL_ALIGN_SIZE_DATA[uboElement.data.type].size,align=WGSL_ALIGN_SIZE_DATA[uboElement.data.type].align;if(!WGSL_ALIGN_SIZE_DATA[uboElement.data.type])throw Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${uboElement.data.type}`);uboElement.data.size>1&&(size=Math.max(size,align)*uboElement.data.size),offset=Math.ceil(offset/align)*align,uboElement.size=size,uboElement.offset=offset,offset+=size}return offset=Math.ceil(offset/16)*16,{uboElements,size:offset}}function generateArraySyncWGSL(uboElement,offsetToAdd){let{size,align}=WGSL_ALIGN_SIZE_DATA[uboElement.data.type],remainder=(align-size)/4,data=uboElement.data.type.indexOf(`i32`)>=0?`dataInt32`:`data`;return`
         v = uv.${uboElement.data.name};
         ${offsetToAdd===0?``:`offset += ${offsetToAdd};`}

         arrayOffset = offset;

         t = 0;

         for(var i=0; i < ${uboElement.data.size*(size/4)}; i++)
         {
             for(var j = 0; j < ${size/4}; j++)
             {
                 ${data}[arrayOffset++] = v[t++];
             }
             ${remainder===0?``:`arrayOffset += ${remainder};`}
         }
     `}function createUboSyncFunctionWGSL(uboElements){return createUboSyncFunction(uboElements,`uboWgsl`,generateArraySyncWGSL,uboSyncFunctionsWGSL)}var GpuUboSystem=class extends UboSystem{constructor(){super({createUboElements:createUboElementsWGSL,generateUboSync:createUboSyncFunctionWGSL})}};GpuUboSystem.extension={type:[ExtensionType.WebGPUSystem],name:`ubo`};var minUniformOffsetAlignment=128,GpuUniformBatchPipe=class{constructor(renderer$1){this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=renderer$1,this._renderer.renderableGC.addManagedHash(this,`_bindGroupHash`),this._batchBuffer=new UboBatch({minUniformOffsetAlignment});let totalBuffers=256/minUniformOffsetAlignment;for(let i$1=0;i$1<totalBuffers;i$1++){let usage=BufferUsage.UNIFORM|BufferUsage.COPY_DST;i$1===0&&(usage|=BufferUsage.COPY_SRC),this._buffers.push(new Buffer$1({data:this._batchBuffer.data,usage}))}}renderEnd(){this._uploadBindGroups(),this._resetBindGroups()}_resetBindGroups(){for(let i$1 in this._bindGroupHash)this._bindGroupHash[i$1]=null;this._batchBuffer.clear()}getUniformBindGroup(group,duplicate){if(!duplicate&&this._bindGroupHash[group.uid])return this._bindGroupHash[group.uid];this._renderer.ubo.ensureUniformGroup(group);let data=group.buffer.data,offset=this._batchBuffer.addEmptyGroup(data.length);return this._renderer.ubo.syncUniformGroup(group,this._batchBuffer.data,offset/4),this._bindGroupHash[group.uid]=this._getBindGroup(offset/minUniformOffsetAlignment),this._bindGroupHash[group.uid]}getUboResource(group){this._renderer.ubo.updateUniformGroup(group);let data=group.buffer.data,offset=this._batchBuffer.addGroup(data);return this._getBufferResource(offset/minUniformOffsetAlignment)}getArrayBindGroup(data){let offset=this._batchBuffer.addGroup(data);return this._getBindGroup(offset/minUniformOffsetAlignment)}getArrayBufferResource(data){let index=this._batchBuffer.addGroup(data)/minUniformOffsetAlignment;return this._getBufferResource(index)}_getBufferResource(index){if(!this._bufferResources[index]){let buffer=this._buffers[index%2];this._bufferResources[index]=new BufferResource({buffer,offset:(index/2|0)*256,size:minUniformOffsetAlignment})}return this._bufferResources[index]}_getBindGroup(index){if(!this._bindGroups[index]){let bindGroup=new BindGroup({0:this._getBufferResource(index)});this._bindGroups[index]=bindGroup}return this._bindGroups[index]}_uploadBindGroups(){let bufferSystem=this._renderer.buffer,firstBuffer=this._buffers[0];firstBuffer.update(this._batchBuffer.byteIndex),bufferSystem.updateBuffer(firstBuffer);let commandEncoder=this._renderer.gpu.device.createCommandEncoder();for(let i$1=1;i$1<this._buffers.length;i$1++){let buffer=this._buffers[i$1];commandEncoder.copyBufferToBuffer(bufferSystem.getGPUBuffer(firstBuffer),minUniformOffsetAlignment,bufferSystem.getGPUBuffer(buffer),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([commandEncoder.finish()])}destroy(){for(let i$1=0;i$1<this._bindGroups.length;i$1++)this._bindGroups[i$1]?.destroy();this._bindGroups=null,this._bindGroupHash=null;for(let i$1=0;i$1<this._buffers.length;i$1++)this._buffers[i$1].destroy();this._buffers=null;for(let i$1=0;i$1<this._bufferResources.length;i$1++)this._bufferResources[i$1].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}};GpuUniformBatchPipe.extension={type:[ExtensionType.WebGPUPipes],name:`uniformBatch`};var topologyStringToId={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};function getGraphicsStateKey(geometryLayout,shaderKey,state,blendMode,topology){return geometryLayout<<24|shaderKey<<16|state<<10|blendMode<<5|topology}function getGlobalStateKey(stencilStateId,multiSampleCount,colorMask,renderTarget){return colorMask<<6|stencilStateId<<3|renderTarget<<1|multiSampleCount}var PipelineSystem=class{constructor(renderer$1){this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=renderer$1}contextChange(gpu){this._gpu=gpu,this.setStencilMode(STENCIL_MODES.DISABLED),this._updatePipeHash()}setMultisampleCount(multisampleCount){this._multisampleCount!==multisampleCount&&(this._multisampleCount=multisampleCount,this._updatePipeHash())}setRenderTarget(renderTarget){this._multisampleCount=renderTarget.msaaSamples,this._depthStencilAttachment=renderTarget.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}setColorMask(colorMask){this._colorMask!==colorMask&&(this._colorMask=colorMask,this._updatePipeHash())}setStencilMode(stencilMode){this._stencilMode!==stencilMode&&(this._stencilMode=stencilMode,this._stencilState=GpuStencilModesToPixi[stencilMode],this._updatePipeHash())}setPipeline(geometry,program,state,passEncoder){let pipeline=this.getPipeline(geometry,program,state);passEncoder.setPipeline(pipeline)}getPipeline(geometry,program,state,topology){geometry._layoutKey||(ensureAttributes(geometry,program.attributeData),this._generateBufferKey(geometry)),topology||=geometry.topology;let key$1=getGraphicsStateKey(geometry._layoutKey,program._layoutKey,state.data,state._blendModeId,topologyStringToId[topology]);return this._pipeCache[key$1]||(this._pipeCache[key$1]=this._createPipeline(geometry,program,state,topology)),this._pipeCache[key$1]}_createPipeline(geometry,program,state,topology){let device=this._gpu.device,buffers=this._createVertexBufferLayouts(geometry,program),blendModes=this._renderer.state.getColorTargets(state);blendModes[0].writeMask=this._stencilMode===STENCIL_MODES.RENDERING_MASK_ADD?0:this._colorMask;let layout$2=this._renderer.shader.getProgramData(program).pipeline,descriptor={vertex:{module:this._getModule(program.vertex.source),entryPoint:program.vertex.entryPoint,buffers},fragment:{module:this._getModule(program.fragment.source),entryPoint:program.fragment.entryPoint,targets:blendModes},primitive:{topology,cullMode:state.cullMode},layout:layout$2,multisample:{count:this._multisampleCount},label:`PIXI Pipeline`};return this._depthStencilAttachment&&(descriptor.depthStencil={...this._stencilState,format:`depth24plus-stencil8`,depthWriteEnabled:state.depthTest,depthCompare:state.depthTest?`less`:`always`}),device.createRenderPipeline(descriptor)}_getModule(code){return this._moduleCache[code]||this._createModule(code)}_createModule(code){let device=this._gpu.device;return this._moduleCache[code]=device.createShaderModule({code}),this._moduleCache[code]}_generateBufferKey(geometry){let keyGen=[],index=0,attributeKeys=Object.keys(geometry.attributes).sort();for(let i$1=0;i$1<attributeKeys.length;i$1++){let attribute=geometry.attributes[attributeKeys[i$1]];keyGen[index++]=attribute.offset,keyGen[index++]=attribute.format,keyGen[index++]=attribute.stride,keyGen[index++]=attribute.instance}let stringKey=keyGen.join(`|`);return geometry._layoutKey=createIdFromString(stringKey,`geometry`),geometry._layoutKey}_generateAttributeLocationsKey(program){let keyGen=[],index=0,attributeKeys=Object.keys(program.attributeData).sort();for(let i$1=0;i$1<attributeKeys.length;i$1++){let attribute=program.attributeData[attributeKeys[i$1]];keyGen[index++]=attribute.location}let stringKey=keyGen.join(`|`);return program._attributeLocationsKey=createIdFromString(stringKey,`programAttributes`),program._attributeLocationsKey}getBufferNamesToBind(geometry,program){let key$1=geometry._layoutKey<<16|program._attributeLocationsKey;if(this._bindingNamesCache[key$1])return this._bindingNamesCache[key$1];let data=this._createVertexBufferLayouts(geometry,program),bufferNamesToBind=Object.create(null),attributeData=program.attributeData;for(let i$1=0;i$1<data.length;i$1++){let shaderLocation=Object.values(data[i$1].attributes)[0].shaderLocation;for(let j$1 in attributeData)if(attributeData[j$1].location===shaderLocation){bufferNamesToBind[i$1]=j$1;break}}return this._bindingNamesCache[key$1]=bufferNamesToBind,bufferNamesToBind}_createVertexBufferLayouts(geometry,program){program._attributeLocationsKey||this._generateAttributeLocationsKey(program);let key$1=geometry._layoutKey<<16|program._attributeLocationsKey;if(this._bufferLayoutsCache[key$1])return this._bufferLayoutsCache[key$1];let vertexBuffersLayout=[];return geometry.buffers.forEach(buffer=>{let bufferEntry={arrayStride:0,stepMode:`vertex`,attributes:[]},bufferEntryAttributes=bufferEntry.attributes;for(let i$1 in program.attributeData){let attribute=geometry.attributes[i$1];(attribute.divisor??1)!==1&&warn$1(`Attribute ${i$1} has an invalid divisor value of '${attribute.divisor}'. WebGPU only supports a divisor value of 1`),attribute.buffer===buffer&&(bufferEntry.arrayStride=attribute.stride,bufferEntry.stepMode=attribute.instance?`instance`:`vertex`,bufferEntryAttributes.push({shaderLocation:program.attributeData[i$1].location,offset:attribute.offset,format:attribute.format}))}bufferEntryAttributes.length&&vertexBuffersLayout.push(bufferEntry)}),this._bufferLayoutsCache[key$1]=vertexBuffersLayout,vertexBuffersLayout}_updatePipeHash(){let key$1=getGlobalStateKey(this._stencilMode,this._multisampleCount,this._colorMask,this._depthStencilAttachment);this._pipeStateCaches[key$1]||(this._pipeStateCaches[key$1]=Object.create(null)),this._pipeCache=this._pipeStateCaches[key$1]}destroy(){this._renderer=null,this._bufferLayoutsCache=null}};PipelineSystem.extension={type:[ExtensionType.WebGPUSystem],name:`pipeline`};var GpuRenderTarget=class{constructor(){this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}},GpuRenderTargetAdaptor=class{init(renderer$1,renderTargetSystem){this._renderer=renderer$1,this._renderTargetSystem=renderTargetSystem}copyToTexture(sourceRenderSurfaceTexture,destinationTexture,originSrc,size,originDest){let renderer$1=this._renderer,baseGpuTexture=this._getGpuColorTexture(sourceRenderSurfaceTexture),backGpuTexture=renderer$1.texture.getGpuSource(destinationTexture.source);return renderer$1.encoder.commandEncoder.copyTextureToTexture({texture:baseGpuTexture,origin:originSrc},{texture:backGpuTexture,origin:originDest},size),destinationTexture}startRenderPass(renderTarget,clear$1=!0,clearColor,viewport){let gpuRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);gpuRenderTarget.descriptor=this.getDescriptor(renderTarget,clear$1,clearColor),this._renderer.pipeline.setRenderTarget(gpuRenderTarget),this._renderer.encoder.beginRenderPass(gpuRenderTarget),this._renderer.encoder.setViewport(viewport)}finishRenderPass(){this._renderer.encoder.endRenderPass()}_getGpuColorTexture(renderTarget){let gpuRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);return gpuRenderTarget.contexts[0]?gpuRenderTarget.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(renderTarget.colorTextures[0].source)}getDescriptor(renderTarget,clear$1,clearValue){typeof clear$1==`boolean`&&(clear$1=clear$1?CLEAR.ALL:CLEAR.NONE);let renderTargetSystem=this._renderTargetSystem,gpuRenderTarget=renderTargetSystem.getGpuRenderTarget(renderTarget),colorAttachments=renderTarget.colorTextures.map((texture,i$1)=>{let context$1=gpuRenderTarget.contexts[i$1],view,resolveTarget;view=context$1?context$1.getCurrentTexture().createView():this._renderer.texture.getGpuSource(texture).createView({mipLevelCount:1}),gpuRenderTarget.msaaTextures[i$1]&&(resolveTarget=view,view=this._renderer.texture.getTextureView(gpuRenderTarget.msaaTextures[i$1]));let loadOp=clear$1&CLEAR.COLOR?`clear`:`load`;return clearValue??=renderTargetSystem.defaultClearColor,{view,resolveTarget,clearValue,storeOp:`store`,loadOp}}),depthStencilAttachment;if((renderTarget.stencil||renderTarget.depth)&&!renderTarget.depthStencilTexture&&(renderTarget.ensureDepthStencilTexture(),renderTarget.depthStencilTexture.source.sampleCount=gpuRenderTarget.msaa?4:1),renderTarget.depthStencilTexture){let stencilLoadOp=clear$1&CLEAR.STENCIL?`clear`:`load`,depthLoadOp=clear$1&CLEAR.DEPTH?`clear`:`load`;depthStencilAttachment={view:this._renderer.texture.getGpuSource(renderTarget.depthStencilTexture.source).createView(),stencilStoreOp:`store`,stencilLoadOp,depthClearValue:1,depthLoadOp,depthStoreOp:`store`}}return{colorAttachments,depthStencilAttachment}}clear(renderTarget,clear$1=!0,clearColor,viewport){if(!clear$1)return;let{gpu,encoder}=this._renderer,device=gpu.device;if(encoder.commandEncoder===null){let commandEncoder=device.createCommandEncoder(),renderPassDescriptor=this.getDescriptor(renderTarget,clear$1,clearColor),passEncoder=commandEncoder.beginRenderPass(renderPassDescriptor);passEncoder.setViewport(viewport.x,viewport.y,viewport.width,viewport.height,0,1),passEncoder.end();let gpuCommands=commandEncoder.finish();device.queue.submit([gpuCommands])}else this.startRenderPass(renderTarget,clear$1,clearColor,viewport)}initGpuRenderTarget(renderTarget){renderTarget.isRoot=!0;let gpuRenderTarget=new GpuRenderTarget;return renderTarget.colorTextures.forEach((colorTexture,i$1)=>{if(colorTexture instanceof CanvasSource){let context$1=colorTexture.resource.getContext(`webgpu`),alphaMode=colorTexture.transparent?`premultiplied`:`opaque`;try{context$1.configure({device:this._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:`bgra8unorm`,alphaMode})}catch(e$2){console.error(e$2)}gpuRenderTarget.contexts[i$1]=context$1}if(gpuRenderTarget.msaa=colorTexture.source.antialias,colorTexture.source.antialias){let msaaTexture=new TextureSource({width:0,height:0,sampleCount:4});gpuRenderTarget.msaaTextures[i$1]=msaaTexture}}),gpuRenderTarget.msaa&&(gpuRenderTarget.msaaSamples=4,renderTarget.depthStencilTexture&&(renderTarget.depthStencilTexture.source.sampleCount=4)),gpuRenderTarget}destroyGpuRenderTarget(gpuRenderTarget){gpuRenderTarget.contexts.forEach(context$1=>{context$1.unconfigure()}),gpuRenderTarget.msaaTextures.forEach(texture=>{texture.destroy()}),gpuRenderTarget.msaaTextures.length=0,gpuRenderTarget.contexts.length=0}ensureDepthStencilTexture(renderTarget){let gpuRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);renderTarget.depthStencilTexture&&gpuRenderTarget.msaa&&(renderTarget.depthStencilTexture.source.sampleCount=4)}resizeGpuRenderTarget(renderTarget){let gpuRenderTarget=this._renderTargetSystem.getGpuRenderTarget(renderTarget);gpuRenderTarget.width=renderTarget.width,gpuRenderTarget.height=renderTarget.height,gpuRenderTarget.msaa&&renderTarget.colorTextures.forEach((colorTexture,i$1)=>{gpuRenderTarget.msaaTextures[i$1]?.resize(colorTexture.source.width,colorTexture.source.height,colorTexture.source._resolution)})}},GpuRenderTargetSystem=class extends RenderTargetSystem{constructor(renderer$1){super(renderer$1),this.adaptor=new GpuRenderTargetAdaptor,this.adaptor.init(renderer$1,this)}};GpuRenderTargetSystem.extension={type:[ExtensionType.WebGPUSystem],name:`renderTarget`};var GpuShaderSystem=class{constructor(){this._gpuProgramData=Object.create(null)}contextChange(gpu){this._gpu=gpu}getProgramData(program){return this._gpuProgramData[program._layoutKey]||this._createGPUProgramData(program)}_createGPUProgramData(program){let device=this._gpu.device,bindGroups=program.gpuLayout.map(group=>device.createBindGroupLayout({entries:group})),pipelineLayoutDesc={bindGroupLayouts:bindGroups};return this._gpuProgramData[program._layoutKey]={bindGroups,pipeline:device.createPipelineLayout(pipelineLayoutDesc)},this._gpuProgramData[program._layoutKey]}destroy(){this._gpu=null,this._gpuProgramData=null}};GpuShaderSystem.extension={type:[ExtensionType.WebGPUSystem],name:`shader`};var GpuBlendModesToPixi={};GpuBlendModesToPixi.normal={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`}},GpuBlendModesToPixi.add={alpha:{srcFactor:`src-alpha`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`one`,dstFactor:`one`,operation:`add`}},GpuBlendModesToPixi.multiply={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`dst`,dstFactor:`one-minus-src-alpha`,operation:`add`}},GpuBlendModesToPixi.screen={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`one`,dstFactor:`one-minus-src`,operation:`add`}},GpuBlendModesToPixi.overlay={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`one`,dstFactor:`one-minus-src`,operation:`add`}},GpuBlendModesToPixi.none={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`zero`,dstFactor:`zero`,operation:`add`}},GpuBlendModesToPixi[`normal-npm`]={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`src-alpha`,dstFactor:`one-minus-src-alpha`,operation:`add`}},GpuBlendModesToPixi[`add-npm`]={alpha:{srcFactor:`one`,dstFactor:`one`,operation:`add`},color:{srcFactor:`src-alpha`,dstFactor:`one`,operation:`add`}},GpuBlendModesToPixi[`screen-npm`]={alpha:{srcFactor:`one`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`src-alpha`,dstFactor:`one-minus-src`,operation:`add`}},GpuBlendModesToPixi.erase={alpha:{srcFactor:`zero`,dstFactor:`one-minus-src-alpha`,operation:`add`},color:{srcFactor:`zero`,dstFactor:`one-minus-src`,operation:`add`}},GpuBlendModesToPixi.min={alpha:{srcFactor:`one`,dstFactor:`one`,operation:`min`},color:{srcFactor:`one`,dstFactor:`one`,operation:`min`}},GpuBlendModesToPixi.max={alpha:{srcFactor:`one`,dstFactor:`one`,operation:`max`},color:{srcFactor:`one`,dstFactor:`one`,operation:`max`}};var GpuStateSystem=class{constructor(){this.defaultState=new State,this.defaultState.blend=!0}contextChange(gpu){this.gpu=gpu}getColorTargets(state){return[{format:`bgra8unorm`,writeMask:0,blend:GpuBlendModesToPixi[state.blendMode]||GpuBlendModesToPixi.normal}]}destroy(){this.gpu=null}};GpuStateSystem.extension={type:[ExtensionType.WebGPUSystem],name:`state`};var gpuUploadBufferImageResource={type:`image`,upload(source$2,gpuTexture,gpu){let resource=source$2.resource,total=(source$2.pixelWidth|0)*(source$2.pixelHeight|0),bytesPerPixel=resource.byteLength/total;gpu.device.queue.writeTexture({texture:gpuTexture},resource,{offset:0,rowsPerImage:source$2.pixelHeight,bytesPerRow:source$2.pixelHeight*bytesPerPixel},{width:source$2.pixelWidth,height:source$2.pixelHeight,depthOrArrayLayers:1})}},blockDataMap={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},defaultBlockData={blockBytes:4,blockWidth:1,blockHeight:1},gpuUploadCompressedTextureResource={type:`compressed`,upload(source$2,gpuTexture,gpu){let mipWidth=source$2.pixelWidth,mipHeight=source$2.pixelHeight,blockData=blockDataMap[source$2.format]||defaultBlockData;for(let i$1=0;i$1<source$2.resource.length;i$1++){let levelBuffer=source$2.resource[i$1],bytesPerRow=Math.ceil(mipWidth/blockData.blockWidth)*blockData.blockBytes;gpu.device.queue.writeTexture({texture:gpuTexture,mipLevel:i$1},levelBuffer,{offset:0,bytesPerRow},{width:Math.ceil(mipWidth/blockData.blockWidth)*blockData.blockWidth,height:Math.ceil(mipHeight/blockData.blockHeight)*blockData.blockHeight,depthOrArrayLayers:1}),mipWidth=Math.max(mipWidth>>1,1),mipHeight=Math.max(mipHeight>>1,1)}}},gpuUploadImageResource={type:`image`,upload(source$2,gpuTexture,gpu){let resource=source$2.resource;if(!resource)return;if(globalThis.HTMLImageElement&&resource instanceof HTMLImageElement){let canvas=DOMAdapter.get().createCanvas(resource.width,resource.height);canvas.getContext(`2d`).drawImage(resource,0,0,resource.width,resource.height),source$2.resource=canvas,warn$1(`ImageSource: Image element passed, converting to canvas and replacing resource.`)}let width=Math.min(gpuTexture.width,source$2.resourceWidth||source$2.pixelWidth),height=Math.min(gpuTexture.height,source$2.resourceHeight||source$2.pixelHeight),premultipliedAlpha=source$2.alphaMode===`premultiply-alpha-on-upload`;gpu.device.queue.copyExternalImageToTexture({source:resource},{texture:gpuTexture,premultipliedAlpha},{width,height})}},gpuUploadVideoResource={type:`video`,upload(source$2,gpuTexture,gpu){gpuUploadImageResource.upload(source$2,gpuTexture,gpu)}},GpuMipmapGenerator=class{constructor(device){this.device=device,this.sampler=device.createSampler({minFilter:`linear`}),this.pipelines={}}_getMipmapPipeline(format$1){let pipeline=this.pipelines[format$1];return pipeline||(this.mipmapShaderModule||=this.device.createShaderModule({code:`
                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(
                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));

                        struct VertexOutput {
                        @builtin(position) position : vec4<f32>,
                        @location(0) texCoord : vec2<f32>,
                        };

                        @vertex
                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                        var output : VertexOutput;
                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);
                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);
                        return output;
                        }

                        @group(0) @binding(0) var imgSampler : sampler;
                        @group(0) @binding(1) var img : texture_2d<f32>;

                        @fragment
                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {
                        return textureSample(img, imgSampler, texCoord);
                        }
                    `}),pipeline=this.device.createRenderPipeline({layout:`auto`,vertex:{module:this.mipmapShaderModule,entryPoint:`vertexMain`},fragment:{module:this.mipmapShaderModule,entryPoint:`fragmentMain`,targets:[{format:format$1}]}}),this.pipelines[format$1]=pipeline),pipeline}generateMipmap(texture){let pipeline=this._getMipmapPipeline(texture.format);if(texture.dimension===`3d`||texture.dimension===`1d`)throw Error(`Generating mipmaps for non-2d textures is currently unsupported!`);let mipTexture=texture,arrayLayerCount=texture.depthOrArrayLayers||1,renderToSource=texture.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!renderToSource){let mipTextureDescriptor={size:{width:Math.ceil(texture.width/2),height:Math.ceil(texture.height/2),depthOrArrayLayers:arrayLayerCount},format:texture.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:texture.mipLevelCount-1};mipTexture=this.device.createTexture(mipTextureDescriptor)}let commandEncoder=this.device.createCommandEncoder({}),bindGroupLayout=pipeline.getBindGroupLayout(0);for(let arrayLayer=0;arrayLayer<arrayLayerCount;++arrayLayer){let srcView=texture.createView({baseMipLevel:0,mipLevelCount:1,dimension:`2d`,baseArrayLayer:arrayLayer,arrayLayerCount:1}),dstMipLevel=renderToSource?1:0;for(let i$1=1;i$1<texture.mipLevelCount;++i$1){let dstView=mipTexture.createView({baseMipLevel:dstMipLevel++,mipLevelCount:1,dimension:`2d`,baseArrayLayer:arrayLayer,arrayLayerCount:1}),passEncoder=commandEncoder.beginRenderPass({colorAttachments:[{view:dstView,storeOp:`store`,loadOp:`clear`,clearValue:{r:0,g:0,b:0,a:0}}]}),bindGroup=this.device.createBindGroup({layout:bindGroupLayout,entries:[{binding:0,resource:this.sampler},{binding:1,resource:srcView}]});passEncoder.setPipeline(pipeline),passEncoder.setBindGroup(0,bindGroup),passEncoder.draw(3,1,0,0),passEncoder.end(),srcView=dstView}}if(!renderToSource){let mipLevelSize={width:Math.ceil(texture.width/2),height:Math.ceil(texture.height/2),depthOrArrayLayers:arrayLayerCount};for(let i$1=1;i$1<texture.mipLevelCount;++i$1)commandEncoder.copyTextureToTexture({texture:mipTexture,mipLevel:i$1-1},{texture,mipLevel:i$1},mipLevelSize),mipLevelSize.width=Math.ceil(mipLevelSize.width/2),mipLevelSize.height=Math.ceil(mipLevelSize.height/2)}return this.device.queue.submit([commandEncoder.finish()]),renderToSource||mipTexture.destroy(),texture}},GpuTextureSystem=class{constructor(renderer$1){this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:gpuUploadImageResource,buffer:gpuUploadBufferImageResource,video:gpuUploadVideoResource,compressed:gpuUploadCompressedTextureResource},this._renderer=renderer$1,renderer$1.renderableGC.addManagedHash(this,`_gpuSources`),renderer$1.renderableGC.addManagedHash(this,`_gpuSamplers`),renderer$1.renderableGC.addManagedHash(this,`_bindGroupHash`),renderer$1.renderableGC.addManagedHash(this,`_textureViewHash`)}contextChange(gpu){this._gpu=gpu}initSource(source$2){return this._gpuSources[source$2.uid]?this._gpuSources[source$2.uid]:this._initSource(source$2)}_initSource(source$2){if(source$2.autoGenerateMipmaps){let biggestDimension=Math.max(source$2.pixelWidth,source$2.pixelHeight);source$2.mipLevelCount=Math.floor(Math.log2(biggestDimension))+1}let usage=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;source$2.uploadMethodId!==`compressed`&&(usage|=GPUTextureUsage.RENDER_ATTACHMENT,usage|=GPUTextureUsage.COPY_SRC);let blockData=blockDataMap[source$2.format]||{blockBytes:4,blockWidth:1,blockHeight:1},width=Math.ceil(source$2.pixelWidth/blockData.blockWidth)*blockData.blockWidth,height=Math.ceil(source$2.pixelHeight/blockData.blockHeight)*blockData.blockHeight,textureDescriptor={label:source$2.label,size:{width,height},format:source$2.format,sampleCount:source$2.sampleCount,mipLevelCount:source$2.mipLevelCount,dimension:source$2.dimension,usage},gpuTexture=this._gpuSources[source$2.uid]=this._gpu.device.createTexture(textureDescriptor);return this.managedTextures.includes(source$2)||(source$2.on(`update`,this.onSourceUpdate,this),source$2.on(`resize`,this.onSourceResize,this),source$2.on(`destroy`,this.onSourceDestroy,this),source$2.on(`unload`,this.onSourceUnload,this),source$2.on(`updateMipmaps`,this.onUpdateMipmaps,this),this.managedTextures.push(source$2)),this.onSourceUpdate(source$2),gpuTexture}onSourceUpdate(source$2){let gpuTexture=this.getGpuSource(source$2);gpuTexture&&(this._uploads[source$2.uploadMethodId]&&this._uploads[source$2.uploadMethodId].upload(source$2,gpuTexture,this._gpu),source$2.autoGenerateMipmaps&&source$2.mipLevelCount>1&&this.onUpdateMipmaps(source$2))}onSourceUnload(source$2){let gpuTexture=this._gpuSources[source$2.uid];gpuTexture&&(this._gpuSources[source$2.uid]=null,gpuTexture.destroy())}onUpdateMipmaps(source$2){this._mipmapGenerator||=new GpuMipmapGenerator(this._gpu.device);let gpuTexture=this.getGpuSource(source$2);this._mipmapGenerator.generateMipmap(gpuTexture)}onSourceDestroy(source$2){source$2.off(`update`,this.onSourceUpdate,this),source$2.off(`unload`,this.onSourceUnload,this),source$2.off(`destroy`,this.onSourceDestroy,this),source$2.off(`resize`,this.onSourceResize,this),source$2.off(`updateMipmaps`,this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(source$2),1),this.onSourceUnload(source$2)}onSourceResize(source$2){let gpuTexture=this._gpuSources[source$2.uid];gpuTexture?(gpuTexture.width!==source$2.pixelWidth||gpuTexture.height!==source$2.pixelHeight)&&(this._textureViewHash[source$2.uid]=null,this._bindGroupHash[source$2.uid]=null,this.onSourceUnload(source$2),this.initSource(source$2)):this.initSource(source$2)}_initSampler(sampler){return this._gpuSamplers[sampler._resourceId]=this._gpu.device.createSampler(sampler),this._gpuSamplers[sampler._resourceId]}getGpuSampler(sampler){return this._gpuSamplers[sampler._resourceId]||this._initSampler(sampler)}getGpuSource(source$2){return this._gpuSources[source$2.uid]||this.initSource(source$2)}getTextureBindGroup(texture){return this._bindGroupHash[texture.uid]??this._createTextureBindGroup(texture)}_createTextureBindGroup(texture){let source$2=texture.source;return this._bindGroupHash[texture.uid]=new BindGroup({0:source$2,1:source$2.style,2:new UniformGroup({uTextureMatrix:{type:`mat3x3<f32>`,value:texture.textureMatrix.mapCoord}})}),this._bindGroupHash[texture.uid]}getTextureView(texture){let source$2=texture.source;return this._textureViewHash[source$2.uid]??this._createTextureView(source$2)}_createTextureView(texture){return this._textureViewHash[texture.uid]=this.getGpuSource(texture).createView(),this._textureViewHash[texture.uid]}generateCanvas(texture){let renderer$1=this._renderer,commandEncoder=renderer$1.gpu.device.createCommandEncoder(),canvas=DOMAdapter.get().createCanvas();canvas.width=texture.source.pixelWidth,canvas.height=texture.source.pixelHeight;let context$1=canvas.getContext(`webgpu`);return context$1.configure({device:renderer$1.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:DOMAdapter.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:`premultiplied`}),commandEncoder.copyTextureToTexture({texture:renderer$1.texture.getGpuSource(texture.source),origin:{x:0,y:0}},{texture:context$1.getCurrentTexture()},{width:canvas.width,height:canvas.height}),renderer$1.gpu.device.queue.submit([commandEncoder.finish()]),canvas}getPixels(texture){let webGPUCanvas=this.generateCanvas(texture),canvasAndContext=CanvasPool.getOptimalCanvasAndContext(webGPUCanvas.width,webGPUCanvas.height),context$1=canvasAndContext.context;context$1.drawImage(webGPUCanvas,0,0);let{width,height}=webGPUCanvas,imageData=context$1.getImageData(0,0,width,height),pixels=new Uint8ClampedArray(imageData.data.buffer);return CanvasPool.returnCanvasAndContext(canvasAndContext),{pixels,width,height}}destroy(){this.managedTextures.slice().forEach(source$2=>this.onSourceDestroy(source$2)),this.managedTextures=null;for(let k$1 of Object.keys(this._bindGroupHash)){let key$1=Number(k$1);this._bindGroupHash[key$1]?.destroy(),this._bindGroupHash[key$1]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}};GpuTextureSystem.extension={type:[ExtensionType.WebGPUSystem],name:`texture`};var GpuGraphicsAdaptor=class{constructor(){this._maxTextures=0}contextChange(renderer$1){let localUniforms=new UniformGroup({uTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uColor:{value:new Float32Array([1,1,1,1]),type:`vec4<f32>`},uRound:{value:0,type:`f32`}});this._maxTextures=renderer$1.limits.maxBatchableTextures;let gpuProgram$2=compileHighShaderGpuProgram({name:`graphics`,bits:[colorBit,generateTextureBatchBit(this._maxTextures),localUniformBitGroup2,roundPixelsBit]});this.shader=new Shader({gpuProgram:gpuProgram$2,resources:{localUniforms}})}execute(graphicsPipe,renderable){let context$1=renderable.context,shader=context$1.customShader||this.shader,renderer$1=graphicsPipe.renderer,{batcher,instructions}=renderer$1.graphicsContext.getContextRenderData(context$1),encoder=renderer$1.encoder;encoder.setGeometry(batcher.geometry,shader.gpuProgram);let globalUniformsBindGroup=renderer$1.globalUniforms.bindGroup;encoder.setBindGroup(0,globalUniformsBindGroup,shader.gpuProgram);let localBindGroup=renderer$1.renderPipes.uniformBatch.getUniformBindGroup(shader.resources.localUniforms,!0);encoder.setBindGroup(2,localBindGroup,shader.gpuProgram);let batches=instructions.instructions,topology=null;for(let i$1=0;i$1<instructions.instructionSize;i$1++){let batch$1=batches[i$1];if(batch$1.topology!==topology&&(topology=batch$1.topology,encoder.setPipelineFromGeometryProgramAndState(batcher.geometry,shader.gpuProgram,graphicsPipe.state,batch$1.topology)),shader.groups[1]=batch$1.bindGroup,!batch$1.gpuBindGroup){let textureBatch=batch$1.textures;batch$1.bindGroup=getTextureBatchBindGroup(textureBatch.textures,textureBatch.count,this._maxTextures),batch$1.gpuBindGroup=renderer$1.bindGroup.getBindGroup(batch$1.bindGroup,shader.gpuProgram,1)}encoder.setBindGroup(1,batch$1.bindGroup,shader.gpuProgram),encoder.renderPassEncoder.drawIndexed(batch$1.size,1,batch$1.start)}}destroy(){this.shader.destroy(!0),this.shader=null}};GpuGraphicsAdaptor.extension={type:[ExtensionType.WebGPUPipesAdaptor],name:`graphics`};var GpuMeshAdapter=class{init(){let gpuProgram$2=compileHighShaderGpuProgram({name:`mesh`,bits:[localUniformBit,textureBit,roundPixelsBit]});this._shader=new Shader({gpuProgram:gpuProgram$2,resources:{uTexture:Texture.EMPTY._source,uSampler:Texture.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:`mat3x3<f32>`,value:new Matrix}}}})}execute(meshPipe,mesh){let renderer$1=meshPipe.renderer,shader=mesh._shader;if(!shader)shader=this._shader,shader.groups[2]=renderer$1.texture.getTextureBindGroup(mesh.texture);else if(!shader.gpuProgram){warn$1(`Mesh shader has no gpuProgram`,mesh.shader);return}let gpuProgram$2=shader.gpuProgram;if(gpuProgram$2.autoAssignGlobalUniforms&&(shader.groups[0]=renderer$1.globalUniforms.bindGroup),gpuProgram$2.autoAssignLocalUniforms){let localUniforms=meshPipe.localUniforms;shader.groups[1]=renderer$1.renderPipes.uniformBatch.getUniformBindGroup(localUniforms,!0)}renderer$1.encoder.draw({geometry:mesh._geometry,shader,state:mesh.state})}destroy(){this._shader.destroy(!0),this._shader=null}};GpuMeshAdapter.extension={type:[ExtensionType.WebGPUPipesAdaptor],name:`mesh`};var DefaultWebGPUSystems=[...SharedSystems,GpuUboSystem,GpuEncoderSystem,GpuDeviceSystem,GpuLimitsSystem,GpuBufferSystem,GpuTextureSystem,GpuRenderTargetSystem,GpuShaderSystem,GpuStateSystem,PipelineSystem,GpuColorMaskSystem,GpuStencilSystem,BindGroupSystem],DefaultWebGPUPipes=[...SharedRenderPipes,GpuUniformBatchPipe],DefaultWebGPUAdapters=[GpuBatchAdaptor,GpuMeshAdapter,GpuGraphicsAdaptor],systems=[],renderPipes=[],renderPipeAdaptors=[];extensions$1.handleByNamedList(ExtensionType.WebGPUSystem,systems),extensions$1.handleByNamedList(ExtensionType.WebGPUPipes,renderPipes),extensions$1.handleByNamedList(ExtensionType.WebGPUPipesAdaptor,renderPipeAdaptors),extensions$1.add(...DefaultWebGPUSystems,...DefaultWebGPUPipes,...DefaultWebGPUAdapters);var WebGPURenderer=class extends AbstractRenderer{constructor(){let systemConfig={name:`webgpu`,type:RendererType.WEBGPU,systems,renderPipes,renderPipeAdaptors};super(systemConfig)}},GraphicsGpuData=class{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(batch$1=>{BigPool.return(batch$1)}),this.batches.length=0}},GraphicsPipe=class{constructor(renderer$1,adaptor){this.state=State.for2d(),this.renderer=renderer$1,this._adaptor=adaptor,this.renderer.runners.contextChange.add(this)}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(graphics){let context$1=graphics.context,wasBatched=!!graphics._gpuData,gpuContext=this.renderer.graphicsContext.updateGpuContext(context$1);return!!(gpuContext.isBatchable||wasBatched!==gpuContext.isBatchable)}addRenderable(graphics,instructionSet){let gpuContext=this.renderer.graphicsContext.updateGpuContext(graphics.context);graphics.didViewUpdate&&this._rebuild(graphics),gpuContext.isBatchable?this._addToBatcher(graphics,instructionSet):(this.renderer.renderPipes.batch.break(instructionSet),instructionSet.add(graphics))}updateRenderable(graphics){let batches=this._getGpuDataForRenderable(graphics).batches;for(let i$1=0;i$1<batches.length;i$1++){let batch$1=batches[i$1];batch$1._batcher.updateElement(batch$1)}}execute(graphics){if(!graphics.isRenderable)return;let renderer$1=this.renderer,context$1=graphics.context;if(!renderer$1.graphicsContext.getGpuContext(context$1).batches.length)return;let shader=context$1.customShader||this._adaptor.shader;this.state.blendMode=graphics.groupBlendMode;let localUniforms=shader.resources.localUniforms.uniforms;localUniforms.uTransformMatrix=graphics.groupTransform,localUniforms.uRound=renderer$1._roundPixels|graphics._roundPixels,color32BitToUniform(graphics.groupColorAlpha,localUniforms.uColor,0),this._adaptor.execute(this,graphics)}_rebuild(graphics){let gpuData=this._getGpuDataForRenderable(graphics),gpuContext=this.renderer.graphicsContext.updateGpuContext(graphics.context);gpuData.destroy(),gpuContext.isBatchable&&this._updateBatchesForRenderable(graphics,gpuData)}_addToBatcher(graphics,instructionSet){let batchPipe=this.renderer.renderPipes.batch,batches=this._getGpuDataForRenderable(graphics).batches;for(let i$1=0;i$1<batches.length;i$1++){let batch$1=batches[i$1];batchPipe.addToBatch(batch$1,instructionSet)}}_getGpuDataForRenderable(graphics){return graphics._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(graphics)}_initGpuDataForRenderable(graphics){let gpuData=new GraphicsGpuData;return graphics._gpuData[this.renderer.uid]=gpuData,gpuData}_updateBatchesForRenderable(graphics,gpuData){let context$1=graphics.context,gpuContext=this.renderer.graphicsContext.getGpuContext(context$1),roundPixels=this.renderer._roundPixels|graphics._roundPixels;gpuData.batches=gpuContext.batches.map(batch$1=>{let batchClone=BigPool.get(BatchableGraphics);return batch$1.copyTo(batchClone),batchClone.renderable=graphics,batchClone.roundPixels=roundPixels,batchClone})}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}};GraphicsPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`graphics`};var _PlaneGeometry=class _PlaneGeometry$1 extends MeshGeometry{constructor(...args){super({});let options=args[0]??{};typeof options==`number`&&(deprecation(v8_0_0,`PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead`),options={width:options,height:args[1],verticesX:args[2],verticesY:args[3]}),this.build(options)}build(options){options={..._PlaneGeometry$1.defaultOptions,...options},this.verticesX=this.verticesX??options.verticesX,this.verticesY=this.verticesY??options.verticesY,this.width=this.width??options.width,this.height=this.height??options.height;let total=this.verticesX*this.verticesY,verts=[],uvs=[],indices=[],verticesX=this.verticesX-1,verticesY=this.verticesY-1,sizeX=this.width/verticesX,sizeY=this.height/verticesY;for(let i$1=0;i$1<total;i$1++){let x$1=i$1%this.verticesX,y$1=i$1/this.verticesX|0;verts.push(x$1*sizeX,y$1*sizeY),uvs.push(x$1/verticesX,y$1/verticesY)}let totalSub=verticesX*verticesY;for(let i$1=0;i$1<totalSub;i$1++){let xpos=i$1%verticesX,ypos=i$1/verticesX|0,value=ypos*this.verticesX+xpos,value2=ypos*this.verticesX+xpos+1,value3=(ypos+1)*this.verticesX+xpos,value4=(ypos+1)*this.verticesX+xpos+1;indices.push(value,value2,value3,value2,value4,value3)}this.buffers[0].data=new Float32Array(verts),this.buffers[1].data=new Float32Array(uvs),this.indexBuffer.data=new Uint32Array(indices),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};_PlaneGeometry.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};var PlaneGeometry=_PlaneGeometry,BatchableMesh=class{constructor(){this.batcherName=`default`,this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._textureMatrixUpdateId=-1,this._uvUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}get topology(){return this._topology||this.geometry.topology}set topology(value){this._topology=value}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}setTexture(value){this.texture!==value&&(this.texture=value,this._textureMatrixUpdateId=-1)}get uvs(){let uvBuffer=this.geometry.getBuffer(`aUV`),uvs=uvBuffer.data,transformedUvs=uvs,textureMatrix=this.texture.textureMatrix;return textureMatrix.isSimple||(transformedUvs=this._transformedUvs,(this._textureMatrixUpdateId!==textureMatrix._updateID||this._uvUpdateId!==uvBuffer._updateID)&&((!transformedUvs||transformedUvs.length<uvs.length)&&(transformedUvs=this._transformedUvs=new Float32Array(uvs.length)),this._textureMatrixUpdateId=textureMatrix._updateID,this._uvUpdateId=uvBuffer._updateID,textureMatrix.multiplyUvs(uvs,transformedUvs))),transformedUvs}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}},MeshGpuData=class{destroy(){}},MeshPipe=class{constructor(renderer$1,adaptor){this.localUniforms=new UniformGroup({uTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uColor:{value:new Float32Array([1,1,1,1]),type:`vec4<f32>`},uRound:{value:0,type:`f32`}}),this.localUniformsBindGroup=new BindGroup({0:this.localUniforms}),this.renderer=renderer$1,this._adaptor=adaptor,this._adaptor.init()}validateRenderable(mesh){let meshData=this._getMeshData(mesh),wasBatched=meshData.batched,isBatched=mesh.batched;if(meshData.batched=isBatched,wasBatched!==isBatched)return!0;if(isBatched){let geometry=mesh._geometry;if(geometry.indices.length!==meshData.indexSize||geometry.positions.length!==meshData.vertexSize)return meshData.indexSize=geometry.indices.length,meshData.vertexSize=geometry.positions.length,!0;let batchableMesh=this._getBatchableMesh(mesh);return batchableMesh.texture.uid!==mesh._texture.uid&&(batchableMesh._textureMatrixUpdateId=-1),!batchableMesh._batcher.checkAndUpdateTexture(batchableMesh,mesh._texture)}return!1}addRenderable(mesh,instructionSet){let batcher=this.renderer.renderPipes.batch,meshData=this._getMeshData(mesh);if(mesh.didViewUpdate&&(meshData.indexSize=mesh._geometry.indices?.length,meshData.vertexSize=mesh._geometry.positions?.length),meshData.batched){let gpuBatchableMesh=this._getBatchableMesh(mesh);gpuBatchableMesh.setTexture(mesh._texture),gpuBatchableMesh.geometry=mesh._geometry,batcher.addToBatch(gpuBatchableMesh,instructionSet)}else batcher.break(instructionSet),instructionSet.add(mesh)}updateRenderable(mesh){if(mesh.batched){let gpuBatchableMesh=this._getBatchableMesh(mesh);gpuBatchableMesh.setTexture(mesh._texture),gpuBatchableMesh.geometry=mesh._geometry,gpuBatchableMesh._batcher.updateElement(gpuBatchableMesh)}}execute(mesh){if(!mesh.isRenderable)return;mesh.state.blendMode=getAdjustedBlendModeBlend(mesh.groupBlendMode,mesh.texture._source);let localUniforms=this.localUniforms;localUniforms.uniforms.uTransformMatrix=mesh.groupTransform,localUniforms.uniforms.uRound=this.renderer._roundPixels|mesh._roundPixels,localUniforms.update(),color32BitToUniform(mesh.groupColorAlpha,localUniforms.uniforms.uColor,0),this._adaptor.execute(this,mesh)}_getMeshData(mesh){var _a$1,_b$1;return(_a$1=mesh._gpuData)[_b$1=this.renderer.uid]||(_a$1[_b$1]=new MeshGpuData),mesh._gpuData[this.renderer.uid].meshData||this._initMeshData(mesh)}_initMeshData(mesh){return mesh._gpuData[this.renderer.uid].meshData={batched:mesh.batched,indexSize:0,vertexSize:0},mesh._gpuData[this.renderer.uid].meshData}_getBatchableMesh(mesh){var _a$1,_b$1;return(_a$1=mesh._gpuData)[_b$1=this.renderer.uid]||(_a$1[_b$1]=new MeshGpuData),mesh._gpuData[this.renderer.uid].batchableMesh||this._initBatchableMesh(mesh)}_initBatchableMesh(mesh){let gpuMesh=new BatchableMesh;return gpuMesh.renderable=mesh,gpuMesh.setTexture(mesh._texture),gpuMesh.transform=mesh.groupTransform,gpuMesh.roundPixels=this.renderer._roundPixels|mesh._roundPixels,mesh._gpuData[this.renderer.uid].batchableMesh=gpuMesh,gpuMesh}destroy(){this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}};MeshPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`mesh`};var GlParticleContainerAdaptor=class{execute(particleContainerPipe,container){let state=particleContainerPipe.state,renderer$1=particleContainerPipe.renderer,shader=container.shader||particleContainerPipe.defaultShader;shader.resources.uTexture=container.texture._source,shader.resources.uniforms=particleContainerPipe.localUniforms;let gl=renderer$1.gl,buffer=particleContainerPipe.getBuffers(container);renderer$1.shader.bind(shader),renderer$1.state.set(state),renderer$1.geometry.bind(buffer.geometry,shader.glProgram);let glType=buffer.geometry.indexBuffer.data.BYTES_PER_ELEMENT===2?gl.UNSIGNED_SHORT:gl.UNSIGNED_INT;gl.drawElements(gl.TRIANGLES,container.particleChildren.length*6,glType,0)}},GpuParticleContainerAdaptor=class{execute(particleContainerPipe,container){let renderer$1=particleContainerPipe.renderer,shader=container.shader||particleContainerPipe.defaultShader;shader.groups[0]=renderer$1.renderPipes.uniformBatch.getUniformBindGroup(particleContainerPipe.localUniforms,!0),shader.groups[1]=renderer$1.texture.getTextureBindGroup(container.texture);let state=particleContainerPipe.state,buffer=particleContainerPipe.getBuffers(container);renderer$1.encoder.draw({geometry:buffer.geometry,shader:container.shader||particleContainerPipe.defaultShader,state,size:container.particleChildren.length*6})}};function createIndicesForQuads(size,outBuffer=null){let totalIndices=size*6;if(totalIndices>65535?outBuffer||=new Uint32Array(totalIndices):outBuffer||=new Uint16Array(totalIndices),outBuffer.length!==totalIndices)throw Error(`Out buffer length is incorrect, got ${outBuffer.length} and expected ${totalIndices}`);for(let i$1=0,j$1=0;i$1<totalIndices;i$1+=6,j$1+=4)outBuffer[i$1+0]=j$1+0,outBuffer[i$1+1]=j$1+1,outBuffer[i$1+2]=j$1+2,outBuffer[i$1+3]=j$1+0,outBuffer[i$1+4]=j$1+2,outBuffer[i$1+5]=j$1+3;return outBuffer}function generateParticleUpdateFunction(properties){return{dynamicUpdate:generateUpdateFunction(properties,!0),staticUpdate:generateUpdateFunction(properties,!1)}}function generateUpdateFunction(properties,dynamic){let funcFragments=[];funcFragments.push(`

        var index = 0;

        for (let i = 0; i < ps.length; ++i)
        {
            const p = ps[i];

            `);let offset=0;for(let i$1 in properties){let property=properties[i$1];if(dynamic!==property.dynamic)continue;funcFragments.push(`offset = index + ${offset}`),funcFragments.push(property.code);let attributeInfo=getAttributeInfoFromFormat(property.format);offset+=attributeInfo.stride/4}funcFragments.push(`
            index += stride * 4;
        }
    `),funcFragments.unshift(`
        var stride = ${offset};
    `);let functionSource=funcFragments.join(`
`);return Function(`ps`,`f32v`,`u32v`,functionSource)}var ParticleBuffer=class{constructor(options){this._size=0,this._generateParticleUpdateCache={};let size=this._size=options.size??1e3,properties=options.properties,staticVertexSize=0,dynamicVertexSize=0;for(let i$1 in properties){let property=properties[i$1],attributeInfo=getAttributeInfoFromFormat(property.format);property.dynamic?dynamicVertexSize+=attributeInfo.stride:staticVertexSize+=attributeInfo.stride}this._dynamicStride=dynamicVertexSize/4,this._staticStride=staticVertexSize/4,this.staticAttributeBuffer=new ViewableBuffer(size*4*staticVertexSize),this.dynamicAttributeBuffer=new ViewableBuffer(size*4*dynamicVertexSize),this.indexBuffer=createIndicesForQuads(size);let geometry=new Geometry,dynamicOffset=0,staticOffset=0;for(let i$1 in this._staticBuffer=new Buffer$1({data:new Float32Array(1),label:`static-particle-buffer`,shrinkToFit:!1,usage:BufferUsage.VERTEX|BufferUsage.COPY_DST}),this._dynamicBuffer=new Buffer$1({data:new Float32Array(1),label:`dynamic-particle-buffer`,shrinkToFit:!1,usage:BufferUsage.VERTEX|BufferUsage.COPY_DST}),properties){let property=properties[i$1],attributeInfo=getAttributeInfoFromFormat(property.format);property.dynamic?(geometry.addAttribute(property.attributeName,{buffer:this._dynamicBuffer,stride:this._dynamicStride*4,offset:dynamicOffset*4,format:property.format}),dynamicOffset+=attributeInfo.size):(geometry.addAttribute(property.attributeName,{buffer:this._staticBuffer,stride:this._staticStride*4,offset:staticOffset*4,format:property.format}),staticOffset+=attributeInfo.size)}geometry.addIndex(this.indexBuffer);let uploadFunction=this.getParticleUpdate(properties);this._dynamicUpload=uploadFunction.dynamicUpdate,this._staticUpload=uploadFunction.staticUpdate,this.geometry=geometry}getParticleUpdate(properties){let key$1=getParticleSyncKey(properties);return this._generateParticleUpdateCache[key$1]||(this._generateParticleUpdateCache[key$1]=this.generateParticleUpdate(properties)),this._generateParticleUpdateCache[key$1]}generateParticleUpdate(properties){return generateParticleUpdateFunction(properties)}update(particles,uploadStatic){particles.length>this._size&&(uploadStatic=!0,this._size=Math.max(particles.length,this._size*1.5|0),this.staticAttributeBuffer=new ViewableBuffer(this._size*this._staticStride*4*4),this.dynamicAttributeBuffer=new ViewableBuffer(this._size*this._dynamicStride*4*4),this.indexBuffer=createIndicesForQuads(this._size),this.geometry.indexBuffer.setDataWithSize(this.indexBuffer,this.indexBuffer.byteLength,!0));let dynamicAttributeBuffer=this.dynamicAttributeBuffer;if(this._dynamicUpload(particles,dynamicAttributeBuffer.float32View,dynamicAttributeBuffer.uint32View),this._dynamicBuffer.setDataWithSize(this.dynamicAttributeBuffer.float32View,particles.length*this._dynamicStride*4,!0),uploadStatic){let staticAttributeBuffer=this.staticAttributeBuffer;this._staticUpload(particles,staticAttributeBuffer.float32View,staticAttributeBuffer.uint32View),this._staticBuffer.setDataWithSize(staticAttributeBuffer.float32View,particles.length*this._staticStride*4,!0)}}destroy(){this._staticBuffer.destroy(),this._dynamicBuffer.destroy(),this.geometry.destroy()}};function getParticleSyncKey(properties){let keyGen=[];for(let key$1 in properties){let property=properties[key$1];keyGen.push(key$1,property.code,property.dynamic?`d`:`s`)}return keyGen.join(`_`)}var fragment=`varying vec2 vUV;
varying vec4 vColor;

uniform sampler2D uTexture;

void main(void){
    vec4 color = texture2D(uTexture, vUV) * vColor;
    gl_FragColor = color;
}`,vertex=`attribute vec2 aVertex;
attribute vec2 aUV;
attribute vec4 aColor;

attribute vec2 aPosition;
attribute float aRotation;

uniform mat3 uTranslationMatrix;
uniform float uRound;
uniform vec2 uResolution;
uniform vec4 uColor;

varying vec2 vUV;
varying vec4 vColor;

vec2 roundPixels(vec2 position, vec2 targetSize)
{       
    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
}

void main(void){
    float cosRotation = cos(aRotation);
    float sinRotation = sin(aRotation);
    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;
    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;

    vec2 v = vec2(x, y);
    v = v + aPosition;

    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    if(uRound == 1.0)
    {
        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
    }

    vUV = aUV;
    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;
}
`,wgsl=`
struct ParticleUniforms {
  uTranslationMatrix:mat3x3<f32>,
  uColor:vec4<f32>,
  uRound:f32,
  uResolution:vec2<f32>,
};

fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
{
  return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
}

@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;

@group(1) @binding(0) var uTexture: texture_2d<f32>;
@group(1) @binding(1) var uSampler : sampler;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) color : vec4<f32>,
  };
@vertex
fn mainVertex(
  @location(0) aVertex: vec2<f32>,
  @location(1) aPosition: vec2<f32>,
  @location(2) aUV: vec2<f32>,
  @location(3) aColor: vec4<f32>,
  @location(4) aRotation: f32,
) -> VSOutput {
  
   let v = vec2(
       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),
       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)
   ) + aPosition;

   var position = vec4((uniforms.uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

   if(uniforms.uRound == 1.0) {
       position = vec4(roundPixels(position.xy, uniforms.uResolution), position.zw);
   }

    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;

  return VSOutput(
   position,
   aUV,
   vColor,
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) color: vec4<f32>,
  @builtin(position) position: vec4<f32>,
) -> @location(0) vec4<f32> {

    var sample = textureSample(uTexture, uSampler, uv) * color;
   
    return sample;
}`,ParticleShader=class extends Shader{constructor(){let glProgram$2=GlProgram.from({vertex,fragment}),gpuProgram$2=GpuProgram.from({fragment:{source:wgsl,entryPoint:`mainFragment`},vertex:{source:wgsl,entryPoint:`mainVertex`}});super({glProgram:glProgram$2,gpuProgram:gpuProgram$2,resources:{uTexture:Texture.WHITE.source,uSampler:new TextureStyle({}),uniforms:{uTranslationMatrix:{value:new Matrix,type:`mat3x3<f32>`},uColor:{value:new Color(16777215),type:`vec4<f32>`},uRound:{value:1,type:`f32`},uResolution:{value:[0,0],type:`vec2<f32>`}}}})}},ParticleContainerPipe=class{constructor(renderer$1,adaptor){this.state=State.for2d(),this.localUniforms=new UniformGroup({uTranslationMatrix:{value:new Matrix,type:`mat3x3<f32>`},uColor:{value:new Float32Array(4),type:`vec4<f32>`},uRound:{value:1,type:`f32`},uResolution:{value:[0,0],type:`vec2<f32>`}}),this.renderer=renderer$1,this.adaptor=adaptor,this.defaultShader=new ParticleShader,this.state=State.for2d()}validateRenderable(_renderable){return!1}addRenderable(renderable,instructionSet){this.renderer.renderPipes.batch.break(instructionSet),instructionSet.add(renderable)}getBuffers(renderable){return renderable._gpuData[this.renderer.uid]||this._initBuffer(renderable)}_initBuffer(renderable){return renderable._gpuData[this.renderer.uid]=new ParticleBuffer({size:renderable.particleChildren.length,properties:renderable._properties}),renderable._gpuData[this.renderer.uid]}updateRenderable(_renderable){}execute(container){let children=container.particleChildren;if(children.length===0)return;let renderer$1=this.renderer,buffer=this.getBuffers(container);container.texture||=children[0].texture;let state=this.state;buffer.update(children,container._childrenDirty),container._childrenDirty=!1,state.blendMode=getAdjustedBlendModeBlend(container.blendMode,container.texture._source);let uniforms=this.localUniforms.uniforms,transformationMatrix=uniforms.uTranslationMatrix;container.worldTransform.copyTo(transformationMatrix),transformationMatrix.prepend(renderer$1.globalUniforms.globalUniformData.projectionMatrix),uniforms.uResolution=renderer$1.globalUniforms.globalUniformData.resolution,uniforms.uRound=renderer$1._roundPixels|container._roundPixels,color32BitToUniform(container.groupColorAlpha,uniforms.uColor,0),this.adaptor.execute(this,container)}destroy(){this.renderer=null,this.defaultShader&&=(this.defaultShader.destroy(),null)}},GlParticleContainerPipe=class extends ParticleContainerPipe{constructor(renderer$1){super(renderer$1,new GlParticleContainerAdaptor)}};GlParticleContainerPipe.extension={type:[ExtensionType.WebGLPipes],name:`particle`};var GpuParticleContainerPipe=class extends ParticleContainerPipe{constructor(renderer$1){super(renderer$1,new GpuParticleContainerAdaptor)}};GpuParticleContainerPipe.extension={type:[ExtensionType.WebGPUPipes],name:`particle`};var _NineSliceGeometry=class _NineSliceGeometry$1 extends PlaneGeometry{constructor(options={}){options={..._NineSliceGeometry$1.defaultOptions,...options},super({width:options.width,height:options.height,verticesX:4,verticesY:4}),this.update(options)}update(options){this.width=options.width??this.width,this.height=options.height??this.height,this._originalWidth=options.originalWidth??this._originalWidth,this._originalHeight=options.originalHeight??this._originalHeight,this._leftWidth=options.leftWidth??this._leftWidth,this._rightWidth=options.rightWidth??this._rightWidth,this._topHeight=options.topHeight??this._topHeight,this._bottomHeight=options.bottomHeight??this._bottomHeight,this._anchorX=options.anchor?.x,this._anchorY=options.anchor?.y,this.updateUvs(),this.updatePositions()}updatePositions(){let p$2=this.positions,{width,height,_leftWidth,_rightWidth,_topHeight,_bottomHeight,_anchorX,_anchorY}=this,w$1=_leftWidth+_rightWidth,scaleW=width>w$1?1:width/w$1,h$2=_topHeight+_bottomHeight,scaleH=height>h$2?1:height/h$2,scale$3=Math.min(scaleW,scaleH),anchorOffsetX=_anchorX*width,anchorOffsetY=_anchorY*height;p$2[0]=p$2[8]=p$2[16]=p$2[24]=-anchorOffsetX,p$2[2]=p$2[10]=p$2[18]=p$2[26]=_leftWidth*scale$3-anchorOffsetX,p$2[4]=p$2[12]=p$2[20]=p$2[28]=width-_rightWidth*scale$3-anchorOffsetX,p$2[6]=p$2[14]=p$2[22]=p$2[30]=width-anchorOffsetX,p$2[1]=p$2[3]=p$2[5]=p$2[7]=-anchorOffsetY,p$2[9]=p$2[11]=p$2[13]=p$2[15]=_topHeight*scale$3-anchorOffsetY,p$2[17]=p$2[19]=p$2[21]=p$2[23]=height-_bottomHeight*scale$3-anchorOffsetY,p$2[25]=p$2[27]=p$2[29]=p$2[31]=height-anchorOffsetY,this.getBuffer(`aPosition`).update()}updateUvs(){let uvs=this.uvs;uvs[0]=uvs[8]=uvs[16]=uvs[24]=0,uvs[1]=uvs[3]=uvs[5]=uvs[7]=0,uvs[6]=uvs[14]=uvs[22]=uvs[30]=1,uvs[25]=uvs[27]=uvs[29]=uvs[31]=1;let _uvw=1/this._originalWidth,_uvh=1/this._originalHeight;uvs[2]=uvs[10]=uvs[18]=uvs[26]=_uvw*this._leftWidth,uvs[9]=uvs[11]=uvs[13]=uvs[15]=_uvh*this._topHeight,uvs[4]=uvs[12]=uvs[20]=uvs[28]=1-_uvw*this._rightWidth,uvs[17]=uvs[19]=uvs[21]=uvs[23]=1-_uvh*this._bottomHeight,this.getBuffer(`aUV`).update()}};_NineSliceGeometry.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};var NineSliceGeometry=_NineSliceGeometry,_NineSliceSprite=class _NineSliceSprite$1 extends ViewContainer{constructor(options){options instanceof Texture&&(options={texture:options});let{width,height,anchor,leftWidth,rightWidth,topHeight,bottomHeight,texture,roundPixels,...rest}=options;super({label:`NineSliceSprite`,...rest}),this.renderPipeId=`nineSliceSprite`,this.batched=!0,this._leftWidth=leftWidth??texture?.defaultBorders?.left??NineSliceGeometry.defaultOptions.leftWidth,this._topHeight=topHeight??texture?.defaultBorders?.top??NineSliceGeometry.defaultOptions.topHeight,this._rightWidth=rightWidth??texture?.defaultBorders?.right??NineSliceGeometry.defaultOptions.rightWidth,this._bottomHeight=bottomHeight??texture?.defaultBorders?.bottom??NineSliceGeometry.defaultOptions.bottomHeight,this._width=width??texture.width??NineSliceGeometry.defaultOptions.width,this._height=height??texture.height??NineSliceGeometry.defaultOptions.height,this.allowChildren=!1,this.texture=texture??_NineSliceSprite$1.defaultOptions.texture,this.roundPixels=roundPixels??!1,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),anchor?this.anchor=anchor:this.texture.defaultAnchor&&(this.anchor=this.texture.defaultAnchor)}get anchor(){return this._anchor}set anchor(value){typeof value==`number`?this._anchor.set(value):this._anchor.copyFrom(value)}get width(){return this._width}set width(value){this._width=value,this.onViewUpdate()}get height(){return this._height}set height(value){this._height=value,this.onViewUpdate()}setSize(value,height){typeof value==`object`&&(height=value.height??value.width,value=value.width),this._width=value,this._height=height??value,this.onViewUpdate()}getSize(out$2){return out$2||={},out$2.width=this._width,out$2.height=this._height,out$2}get leftWidth(){return this._leftWidth}set leftWidth(value){this._leftWidth=value,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(value){this._topHeight=value,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(value){this._rightWidth=value,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(value){this._bottomHeight=value,this.onViewUpdate()}get texture(){return this._texture}set texture(value){value||=Texture.EMPTY;let currentTexture=this._texture;currentTexture!==value&&(currentTexture&&currentTexture.dynamic&&currentTexture.off(`update`,this.onViewUpdate,this),value.dynamic&&value.on(`update`,this.onViewUpdate,this),this._texture=value,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}destroy(options){if(super.destroy(options),typeof options==`boolean`?options:options?.texture){let destroyTextureSource=typeof options==`boolean`?options:options?.textureSource;this._texture.destroy(destroyTextureSource)}this._texture=null}updateBounds(){let bounds=this._bounds,anchor=this._anchor,width=this._width,height=this._height;bounds.minX=-anchor._x*width,bounds.maxX=bounds.minX+width,bounds.minY=-anchor._y*height,bounds.maxY=bounds.minY+height}};_NineSliceSprite.defaultOptions={texture:Texture.EMPTY};var NineSliceSprite=_NineSliceSprite,NineSliceSpriteGpuData=class extends BatchableMesh{constructor(){super(),this.geometry=new NineSliceGeometry}destroy(){this.geometry.destroy()}},NineSliceSpritePipe=class{constructor(renderer$1){this._renderer=renderer$1}addRenderable(sprite,instructionSet){let gpuSprite=this._getGpuSprite(sprite);sprite.didViewUpdate&&this._updateBatchableSprite(sprite,gpuSprite),this._renderer.renderPipes.batch.addToBatch(gpuSprite,instructionSet)}updateRenderable(sprite){let gpuSprite=this._getGpuSprite(sprite);sprite.didViewUpdate&&this._updateBatchableSprite(sprite,gpuSprite),gpuSprite._batcher.updateElement(gpuSprite)}validateRenderable(sprite){let gpuSprite=this._getGpuSprite(sprite);return!gpuSprite._batcher.checkAndUpdateTexture(gpuSprite,sprite._texture)}_updateBatchableSprite(sprite,batchableSprite){batchableSprite.geometry.update(sprite),batchableSprite.setTexture(sprite._texture)}_getGpuSprite(sprite){return sprite._gpuData[this._renderer.uid]||this._initGPUSprite(sprite)}_initGPUSprite(sprite){let gpuData=sprite._gpuData[this._renderer.uid]=new NineSliceSpriteGpuData,batchableMesh=gpuData;return batchableMesh.renderable=sprite,batchableMesh.transform=sprite.groupTransform,batchableMesh.texture=sprite._texture,batchableMesh.roundPixels=this._renderer._roundPixels|sprite._roundPixels,sprite.didViewUpdate||this._updateBatchableSprite(sprite,batchableMesh),gpuData}destroy(){this._renderer=null}};NineSliceSpritePipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`nineSliceSprite`};var tilingBit={name:`tiling-bit`,vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            }

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},tilingBitGl={name:`tiling-bit`,vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;

        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0

        `}},gpuProgram$1,glProgram$1,TilingSpriteShader=class extends Shader{constructor(){gpuProgram$1??=compileHighShaderGpuProgram({name:`tiling-sprite-shader`,bits:[localUniformBit,tilingBit,roundPixelsBit]}),glProgram$1??=compileHighShaderGlProgram({name:`tiling-sprite-shader`,bits:[localUniformBitGl,tilingBitGl,roundPixelsBitGl]});let tilingUniforms=new UniformGroup({uMapCoord:{value:new Matrix,type:`mat3x3<f32>`},uClampFrame:{value:new Float32Array([0,0,1,1]),type:`vec4<f32>`},uClampOffset:{value:new Float32Array([0,0]),type:`vec2<f32>`},uTextureTransform:{value:new Matrix,type:`mat3x3<f32>`},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:`vec4<f32>`}});super({glProgram:glProgram$1,gpuProgram:gpuProgram$1,resources:{localUniforms:new UniformGroup({uTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uColor:{value:new Float32Array([1,1,1,1]),type:`vec4<f32>`},uRound:{value:0,type:`f32`}}),tilingUniforms,uTexture:Texture.EMPTY.source,uSampler:Texture.EMPTY.source.style}})}updateUniforms(width,height,matrix,anchorX,anchorY,texture){let tilingUniforms=this.resources.tilingUniforms,textureWidth=texture.width,textureHeight=texture.height,textureMatrix=texture.textureMatrix,uTextureTransform=tilingUniforms.uniforms.uTextureTransform;uTextureTransform.set(matrix.a*textureWidth/width,matrix.b*textureWidth/height,matrix.c*textureHeight/width,matrix.d*textureHeight/height,matrix.tx/width,matrix.ty/height),uTextureTransform.invert(),tilingUniforms.uniforms.uMapCoord=textureMatrix.mapCoord,tilingUniforms.uniforms.uClampFrame=textureMatrix.uClampFrame,tilingUniforms.uniforms.uClampOffset=textureMatrix.uClampOffset,tilingUniforms.uniforms.uTextureTransform=uTextureTransform,tilingUniforms.uniforms.uSizeAnchor[0]=width,tilingUniforms.uniforms.uSizeAnchor[1]=height,tilingUniforms.uniforms.uSizeAnchor[2]=anchorX,tilingUniforms.uniforms.uSizeAnchor[3]=anchorY,texture&&(this.resources.uTexture=texture.source,this.resources.uSampler=texture.source.style)}},QuadGeometry=class extends MeshGeometry{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}};function setPositions(tilingSprite,positions){let anchorX=tilingSprite.anchor.x,anchorY=tilingSprite.anchor.y;positions[0]=-anchorX*tilingSprite.width,positions[1]=-anchorY*tilingSprite.height,positions[2]=(1-anchorX)*tilingSprite.width,positions[3]=-anchorY*tilingSprite.height,positions[4]=(1-anchorX)*tilingSprite.width,positions[5]=(1-anchorY)*tilingSprite.height,positions[6]=-anchorX*tilingSprite.width,positions[7]=(1-anchorY)*tilingSprite.height}function applyMatrix(array,stride,offset,matrix){let index=0,size=array.length/(stride||2),a$1=matrix.a,b$1=matrix.b,c$2=matrix.c,d$1=matrix.d,tx=matrix.tx,ty=matrix.ty;for(offset*=stride;index<size;){let x$1=array[offset],y$1=array[offset+1];array[offset]=a$1*x$1+c$2*y$1+tx,array[offset+1]=b$1*x$1+d$1*y$1+ty,offset+=stride,index++}}function setUvs(tilingSprite,uvs){let texture=tilingSprite.texture,width=texture.frame.width,height=texture.frame.height,anchorX=0,anchorY=0;tilingSprite.applyAnchorToTexture&&(anchorX=tilingSprite.anchor.x,anchorY=tilingSprite.anchor.y),uvs[0]=uvs[6]=-anchorX,uvs[2]=uvs[4]=1-anchorX,uvs[1]=uvs[3]=-anchorY,uvs[5]=uvs[7]=1-anchorY;let textureMatrix=Matrix.shared;textureMatrix.copyFrom(tilingSprite._tileTransform.matrix),textureMatrix.tx/=tilingSprite.width,textureMatrix.ty/=tilingSprite.height,textureMatrix.invert(),textureMatrix.scale(tilingSprite.width/width,tilingSprite.height/height),applyMatrix(uvs,2,0,textureMatrix)}var sharedQuad=new QuadGeometry,TilingSpriteGpuData=class{constructor(){this.canBatch=!0,this.geometry=new MeshGeometry({indices:sharedQuad.indices.slice(),positions:sharedQuad.positions.slice(),uvs:sharedQuad.uvs.slice()})}destroy(){this.geometry.destroy(),this.shader?.destroy()}},TilingSpritePipe=class{constructor(renderer$1){this._state=State.default2d,this._renderer=renderer$1}validateRenderable(renderable){let tilingSpriteData=this._getTilingSpriteData(renderable),couldBatch=tilingSpriteData.canBatch;this._updateCanBatch(renderable);let canBatch=tilingSpriteData.canBatch;if(canBatch&&canBatch===couldBatch){let{batchableMesh}=tilingSpriteData;return!batchableMesh._batcher.checkAndUpdateTexture(batchableMesh,renderable.texture)}return couldBatch!==canBatch}addRenderable(tilingSprite,instructionSet){let batcher=this._renderer.renderPipes.batch;this._updateCanBatch(tilingSprite);let tilingSpriteData=this._getTilingSpriteData(tilingSprite),{geometry,canBatch}=tilingSpriteData;if(canBatch){tilingSpriteData.batchableMesh||=new BatchableMesh;let batchableMesh=tilingSpriteData.batchableMesh;tilingSprite.didViewUpdate&&(this._updateBatchableMesh(tilingSprite),batchableMesh.geometry=geometry,batchableMesh.renderable=tilingSprite,batchableMesh.transform=tilingSprite.groupTransform,batchableMesh.setTexture(tilingSprite._texture)),batchableMesh.roundPixels=this._renderer._roundPixels|tilingSprite._roundPixels,batcher.addToBatch(batchableMesh,instructionSet)}else batcher.break(instructionSet),tilingSpriteData.shader||=new TilingSpriteShader,this.updateRenderable(tilingSprite),instructionSet.add(tilingSprite)}execute(tilingSprite){let{shader}=this._getTilingSpriteData(tilingSprite);shader.groups[0]=this._renderer.globalUniforms.bindGroup;let localUniforms=shader.resources.localUniforms.uniforms;localUniforms.uTransformMatrix=tilingSprite.groupTransform,localUniforms.uRound=this._renderer._roundPixels|tilingSprite._roundPixels,color32BitToUniform(tilingSprite.groupColorAlpha,localUniforms.uColor,0),this._state.blendMode=getAdjustedBlendModeBlend(tilingSprite.groupBlendMode,tilingSprite.texture._source),this._renderer.encoder.draw({geometry:sharedQuad,shader,state:this._state})}updateRenderable(tilingSprite){let tilingSpriteData=this._getTilingSpriteData(tilingSprite),{canBatch}=tilingSpriteData;if(canBatch){let{batchableMesh}=tilingSpriteData;tilingSprite.didViewUpdate&&this._updateBatchableMesh(tilingSprite),batchableMesh._batcher.updateElement(batchableMesh)}else if(tilingSprite.didViewUpdate){let{shader}=tilingSpriteData;shader.updateUniforms(tilingSprite.width,tilingSprite.height,tilingSprite._tileTransform.matrix,tilingSprite.anchor.x,tilingSprite.anchor.y,tilingSprite.texture)}}_getTilingSpriteData(renderable){return renderable._gpuData[this._renderer.uid]||this._initTilingSpriteData(renderable)}_initTilingSpriteData(tilingSprite){let gpuData=new TilingSpriteGpuData;return gpuData.renderable=tilingSprite,tilingSprite._gpuData[this._renderer.uid]=gpuData,gpuData}_updateBatchableMesh(tilingSprite){let{geometry}=this._getTilingSpriteData(tilingSprite),style=tilingSprite.texture.source.style;style.addressMode!==`repeat`&&(style.addressMode=`repeat`,style.update()),setUvs(tilingSprite,geometry.uvs),setPositions(tilingSprite,geometry.positions)}destroy(){this._renderer=null}_updateCanBatch(tilingSprite){let renderableData=this._getTilingSpriteData(tilingSprite),texture=tilingSprite.texture,_nonPowOf2wrapping=!0;return this._renderer.type===RendererType.WEBGL&&(_nonPowOf2wrapping=this._renderer.context.supports.nonPowOf2wrapping),renderableData.canBatch=texture.textureMatrix.isSimple&&(_nonPowOf2wrapping||texture.source.isPowerOfTwo),renderableData.canBatch}};TilingSpritePipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`tilingSprite`};var localUniformMSDFBit={name:`local-uniform-msdf-bit`,vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:`
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `}},localUniformMSDFBitGl={name:`local-uniform-msdf-bit`,vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:`
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `}},mSDFBit={name:`msdf-bit`,fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {

                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;

            }
        `}},mSDFBitGl={name:`msdf-bit`,fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {

                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);

                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);

                return coverage;
            }
        `}},gpuProgram,glProgram,SdfShader=class extends Shader{constructor(maxTextures){let uniforms=new UniformGroup({uColor:{value:new Float32Array([1,1,1,1]),type:`vec4<f32>`},uTransformMatrix:{value:new Matrix,type:`mat3x3<f32>`},uDistance:{value:4,type:`f32`},uRound:{value:0,type:`f32`}});gpuProgram??=compileHighShaderGpuProgram({name:`sdf-shader`,bits:[colorBit,generateTextureBatchBit(maxTextures),localUniformMSDFBit,mSDFBit,roundPixelsBit]}),glProgram??=compileHighShaderGlProgram({name:`sdf-shader`,bits:[colorBitGl,generateTextureBatchBitGl(maxTextures),localUniformMSDFBitGl,mSDFBitGl,roundPixelsBitGl]}),super({glProgram,gpuProgram,resources:{localUniforms:uniforms,batchSamplers:getBatchSamplersUniformGroup(maxTextures)}})}},BitmapTextGraphics=class extends Graphics{destroy(){this.context.customShader&&this.context.customShader.destroy(),super.destroy()}},BitmapTextPipe=class{constructor(renderer$1){this._renderer=renderer$1}validateRenderable(bitmapText){let graphicsRenderable=this._getGpuBitmapText(bitmapText);return this._renderer.renderPipes.graphics.validateRenderable(graphicsRenderable)}addRenderable(bitmapText,instructionSet){let graphicsRenderable=this._getGpuBitmapText(bitmapText);syncWithProxy(bitmapText,graphicsRenderable),bitmapText._didTextUpdate&&(bitmapText._didTextUpdate=!1,this._updateContext(bitmapText,graphicsRenderable)),this._renderer.renderPipes.graphics.addRenderable(graphicsRenderable,instructionSet),graphicsRenderable.context.customShader&&this._updateDistanceField(bitmapText)}updateRenderable(bitmapText){let graphicsRenderable=this._getGpuBitmapText(bitmapText);syncWithProxy(bitmapText,graphicsRenderable),this._renderer.renderPipes.graphics.updateRenderable(graphicsRenderable),graphicsRenderable.context.customShader&&this._updateDistanceField(bitmapText)}_updateContext(bitmapText,proxyGraphics){let{context:context$1}=proxyGraphics,bitmapFont=BitmapFontManager.getFont(bitmapText.text,bitmapText._style);context$1.clear(),bitmapFont.distanceField.type!==`none`&&(context$1.customShader||=new SdfShader(this._renderer.limits.maxBatchableTextures));let chars=CanvasTextMetrics.graphemeSegmenter(bitmapText.text),style=bitmapText._style,currentY=bitmapFont.baseLineOffset,bitmapTextLayout=getBitmapTextLayout(chars,style,bitmapFont,!0),padding=style.padding,scale$3=bitmapTextLayout.scale,tx=bitmapTextLayout.width,ty=bitmapTextLayout.height+bitmapTextLayout.offsetY;style._stroke&&(tx+=style._stroke.width/scale$3,ty+=style._stroke.width/scale$3),context$1.translate(-bitmapText._anchor._x*tx-padding,-bitmapText._anchor._y*ty-padding).scale(scale$3,scale$3);let tint=bitmapFont.applyFillAsTint?style._fill.color:16777215,fontSize=bitmapFont.fontMetrics.fontSize,lineHeight=bitmapFont.lineHeight;style.lineHeight&&(fontSize=style.fontSize/scale$3,lineHeight=style.lineHeight/scale$3);let linePositionYShift=(lineHeight-fontSize)/2;linePositionYShift-bitmapFont.baseLineOffset<0&&(linePositionYShift=0);for(let i$1=0;i$1<bitmapTextLayout.lines.length;i$1++){let line=bitmapTextLayout.lines[i$1];for(let j$1=0;j$1<line.charPositions.length;j$1++){let char=line.chars[j$1],charData=bitmapFont.chars[char];if(charData?.texture){let texture=charData.texture;context$1.texture(texture,tint||`black`,Math.round(line.charPositions[j$1]+charData.xOffset),Math.round(currentY+charData.yOffset+linePositionYShift),texture.orig.width,texture.orig.height)}}currentY+=lineHeight}}_getGpuBitmapText(bitmapText){return bitmapText._gpuData[this._renderer.uid]||this.initGpuText(bitmapText)}initGpuText(bitmapText){let proxyRenderable=new BitmapTextGraphics;return bitmapText._gpuData[this._renderer.uid]=proxyRenderable,this._updateContext(bitmapText,proxyRenderable),proxyRenderable}_updateDistanceField(bitmapText){let context$1=this._getGpuBitmapText(bitmapText).context,fontFamily=bitmapText._style.fontFamily,dynamicFont=Cache.get(`${fontFamily}-bitmap`),{a:a$1,b:b$1,c:c$2,d:d$1}=bitmapText.groupTransform,dx=Math.sqrt(a$1*a$1+b$1*b$1),dy=Math.sqrt(c$2*c$2+d$1*d$1),worldScale=(Math.abs(dx)+Math.abs(dy))/2,fontScale=dynamicFont.baseRenderedFontSize/bitmapText._style.fontSize,distance$1=worldScale*dynamicFont.distanceField.range*(1/fontScale);context$1.customShader.resources.localUniforms.uniforms.uDistance=distance$1}destroy(){this._renderer=null}};BitmapTextPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`bitmapText`};function syncWithProxy(container,proxy){proxy.groupTransform=container.groupTransform,proxy.groupColorAlpha=container.groupColorAlpha,proxy.groupColor=container.groupColor,proxy.groupBlendMode=container.groupBlendMode,proxy.globalDisplayStatus=container.globalDisplayStatus,proxy.groupTransform=container.groupTransform,proxy.localDisplayStatus=container.localDisplayStatus,proxy.groupAlpha=container.groupAlpha,proxy._roundPixels=container._roundPixels}var BatchableHTMLText=class extends BatchableSprite{constructor(renderer$1){super(),this.generatingTexture=!1,this.currentKey=`--`,this._renderer=renderer$1,renderer$1.runners.resolutionChange.add(this)}resolutionChange(){let text=this.renderable;text._autoResolution&&text.onViewUpdate()}destroy(){let{htmlText}=this._renderer;htmlText.getReferenceCount(this.currentKey)===null?htmlText.returnTexturePromise(this.texturePromise):htmlText.decreaseReferenceCount(this.currentKey),this._renderer.runners.resolutionChange.remove(this),this.texturePromise=null,this._renderer=null}};function updateTextBounds(batchableSprite,text){let{texture,bounds}=batchableSprite,padding=text._style._getFinalPadding();updateQuadBounds(bounds,text._anchor,texture);let paddingOffset=text._anchor._x*padding*2,paddingOffsetY=text._anchor._y*padding*2;bounds.minX-=padding-paddingOffset,bounds.minY-=padding-paddingOffsetY,bounds.maxX-=padding-paddingOffset,bounds.maxY-=padding-paddingOffsetY}var HTMLTextPipe=class{constructor(renderer$1){this._renderer=renderer$1}validateRenderable(htmlText){let gpuText=this._getGpuText(htmlText),newKey=htmlText.styleKey;return gpuText.currentKey!==newKey}addRenderable(htmlText,instructionSet){let batchableHTMLText=this._getGpuText(htmlText);if(htmlText._didTextUpdate){let resolution=htmlText._autoResolution?this._renderer.resolution:htmlText.resolution;(batchableHTMLText.currentKey!==htmlText.styleKey||htmlText.resolution!==resolution)&&this._updateGpuText(htmlText).catch(e$2=>{console.error(e$2)}),htmlText._didTextUpdate=!1,updateTextBounds(batchableHTMLText,htmlText)}this._renderer.renderPipes.batch.addToBatch(batchableHTMLText,instructionSet)}updateRenderable(htmlText){let batchableHTMLText=this._getGpuText(htmlText);batchableHTMLText._batcher.updateElement(batchableHTMLText)}async _updateGpuText(htmlText){htmlText._didTextUpdate=!1;let batchableHTMLText=this._getGpuText(htmlText);if(batchableHTMLText.generatingTexture)return;let oldTexturePromise=batchableHTMLText.texturePromise;batchableHTMLText.texturePromise=null,batchableHTMLText.generatingTexture=!0,htmlText._resolution=htmlText._autoResolution?this._renderer.resolution:htmlText.resolution;let texturePromise=this._renderer.htmlText.getTexturePromise(htmlText);oldTexturePromise&&(texturePromise=texturePromise.finally(()=>{this._renderer.htmlText.decreaseReferenceCount(batchableHTMLText.currentKey),this._renderer.htmlText.returnTexturePromise(oldTexturePromise)})),batchableHTMLText.texturePromise=texturePromise,batchableHTMLText.currentKey=htmlText.styleKey,batchableHTMLText.texture=await texturePromise;let renderGroup=htmlText.renderGroup||htmlText.parentRenderGroup;renderGroup&&(renderGroup.structureDidChange=!0),batchableHTMLText.generatingTexture=!1,updateTextBounds(batchableHTMLText,htmlText)}_getGpuText(htmlText){return htmlText._gpuData[this._renderer.uid]||this.initGpuText(htmlText)}initGpuText(htmlText){let batchableHTMLText=new BatchableHTMLText(this._renderer);return batchableHTMLText.renderable=htmlText,batchableHTMLText.transform=htmlText.groupTransform,batchableHTMLText.texture=Texture.EMPTY,batchableHTMLText.bounds={minX:0,maxX:1,minY:0,maxY:0},batchableHTMLText.roundPixels=this._renderer._roundPixels|htmlText._roundPixels,htmlText._resolution=htmlText._autoResolution?this._renderer.resolution:htmlText.resolution,htmlText._gpuData[this._renderer.uid]=batchableHTMLText,batchableHTMLText}destroy(){this._renderer=null}};HTMLTextPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`htmlText`};function isSafari(){let{userAgent}=DOMAdapter.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(userAgent)}var tempBounds=new Bounds;function getPo2TextureFromSource(image,width,height,resolution){let bounds=tempBounds;bounds.minX=0,bounds.minY=0,bounds.maxX=image.width/resolution|0,bounds.maxY=image.height/resolution|0;let texture=TexturePool.getOptimalTexture(bounds.width,bounds.height,resolution,!1);return texture.source.uploadMethodId=`image`,texture.source.resource=image,texture.source.alphaMode=`premultiply-alpha-on-upload`,texture.frame.width=width/resolution,texture.frame.height=height/resolution,texture.source.emit(`update`,texture.source),texture.updateUvs(),texture}function extractFontFamilies(text,style){let fontFamily=style.fontFamily,fontFamilies=[],dedupe={},matches=text.match(/font-family:([^;"\s]+)/g);function addFontFamily(fontFamily2){dedupe[fontFamily2]||(fontFamilies.push(fontFamily2),dedupe[fontFamily2]=!0)}if(Array.isArray(fontFamily))for(let i$1=0;i$1<fontFamily.length;i$1++)addFontFamily(fontFamily[i$1]);else addFontFamily(fontFamily);for(let i$1 in matches&&matches.forEach(match=>{let fontFamily2=match.split(`:`)[1].trim();addFontFamily(fontFamily2)}),style.tagStyles){let fontFamily2=style.tagStyles[i$1].fontFamily;addFontFamily(fontFamily2)}return fontFamilies}async function loadFontAsBase64(url){let blob=await(await DOMAdapter.get().fetch(url)).blob(),reader=new FileReader;return await new Promise((resolve$1,reject)=>{reader.onloadend=()=>resolve$1(reader.result),reader.onerror=reject,reader.readAsDataURL(blob)})}async function loadFontCSS(style,url){let dataSrc=await loadFontAsBase64(url);return`@font-face {
        font-family: "${style.fontFamily}";
        font-weight: ${style.fontWeight};
        font-style: ${style.fontStyle};
        src: url('${dataSrc}');
    }`}var FontStylePromiseCache=new Map;async function getFontCss(fontFamilies){let fontPromises=fontFamilies.filter(fontFamily=>Cache.has(`${fontFamily}-and-url`)).map(fontFamily=>{if(!FontStylePromiseCache.has(fontFamily)){let{entries}=Cache.get(`${fontFamily}-and-url`),promises=[];entries.forEach(entry=>{let url=entry.url,out$2=entry.faces.map(face=>({weight:face.weight,style:face.style}));promises.push(...out$2.map(style=>loadFontCSS({fontWeight:style.weight,fontStyle:style.style,fontFamily},url)))}),FontStylePromiseCache.set(fontFamily,Promise.all(promises).then(css=>css.join(`
`)))}return FontStylePromiseCache.get(fontFamily)});return(await Promise.all(fontPromises)).join(`
`)}function getSVGUrl(text,style,resolution,fontCSS,htmlTextData){let{domElement,styleElement,svgRoot}=htmlTextData;domElement.innerHTML=`<style>${style.cssStyle}</style><div style='padding:0;'>${text}</div>`,domElement.setAttribute(`style`,`transform: scale(${resolution});transform-origin: top left; display: inline-block`),styleElement.textContent=fontCSS;let{width,height}=htmlTextData.image;return svgRoot.setAttribute(`width`,width.toString()),svgRoot.setAttribute(`height`,height.toString()),new XMLSerializer().serializeToString(svgRoot)}function getTemporaryCanvasFromImage(image,resolution){let canvasAndContext=CanvasPool.getOptimalCanvasAndContext(image.width,image.height,resolution),{context:context$1}=canvasAndContext;return context$1.clearRect(0,0,image.width,image.height),context$1.drawImage(image,0,0),canvasAndContext}function loadSVGImage(image,url,delay){return new Promise(async resolve$1=>{delay&&await new Promise(resolve2=>setTimeout(resolve2,100)),image.onload=()=>{resolve$1()},image.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(url)}`,image.crossOrigin=`anonymous`})}var HTMLTextSystem=class{constructor(renderer$1){this._activeTextures={},this._renderer=renderer$1,this._createCanvas=renderer$1.type===RendererType.WEBGPU}getTexture(options){return this.getTexturePromise(options)}getManagedTexture(text){let textKey=text.styleKey;if(this._activeTextures[textKey])return this._increaseReferenceCount(textKey),this._activeTextures[textKey].promise;let promise$1=this._buildTexturePromise(text).then(texture=>(this._activeTextures[textKey].texture=texture,texture));return this._activeTextures[textKey]={texture:null,promise:promise$1,usageCount:1},promise$1}getReferenceCount(textKey){return this._activeTextures[textKey]?.usageCount??null}_increaseReferenceCount(textKey){this._activeTextures[textKey].usageCount++}decreaseReferenceCount(textKey){let activeTexture=this._activeTextures[textKey];activeTexture&&(activeTexture.usageCount--,activeTexture.usageCount===0&&(activeTexture.texture?this._cleanUp(activeTexture.texture):activeTexture.promise.then(texture=>{activeTexture.texture=texture,this._cleanUp(activeTexture.texture)}).catch(()=>{warn$1(`HTMLTextSystem: Failed to clean texture`)}),this._activeTextures[textKey]=null))}getTexturePromise(options){return this._buildTexturePromise(options)}async _buildTexturePromise(options){let{text,style,resolution,textureStyle}=options,htmlTextData=BigPool.get(HTMLTextRenderData),fontFamilies=extractFontFamilies(text,style),fontCSS=await getFontCss(fontFamilies),measured=measureHtmlText(text,style,fontCSS,htmlTextData),width=Math.ceil(Math.ceil(Math.max(1,measured.width)+style.padding*2)*resolution),height=Math.ceil(Math.ceil(Math.max(1,measured.height)+style.padding*2)*resolution),image=htmlTextData.image,uvSafeOffset=2;image.width=(width|0)+2,image.height=(height|0)+2;let svgURL=getSVGUrl(text,style,resolution,fontCSS,htmlTextData);await loadSVGImage(image,svgURL,isSafari()&&fontFamilies.length>0);let resource=image,canvasAndContext;this._createCanvas&&(canvasAndContext=getTemporaryCanvasFromImage(image,resolution));let texture=getPo2TextureFromSource(canvasAndContext?canvasAndContext.canvas:resource,image.width-2,image.height-2,resolution);return textureStyle&&(texture.source.style=textureStyle),this._createCanvas&&(this._renderer.texture.initSource(texture.source),CanvasPool.returnCanvasAndContext(canvasAndContext)),BigPool.return(htmlTextData),texture}returnTexturePromise(texturePromise){texturePromise.then(texture=>{this._cleanUp(texture)}).catch(()=>{warn$1(`HTMLTextSystem: Failed to clean texture`)})}_cleanUp(texture){TexturePool.returnTexture(texture,!0),texture.source.resource=null,texture.source.uploadMethodId=`unknown`}destroy(){for(let key$1 in this._renderer=null,this._activeTextures)this._activeTextures[key$1]&&this.returnTexturePromise(this._activeTextures[key$1].promise);this._activeTextures=null}};HTMLTextSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`htmlText`};var BatchableText=class extends BatchableSprite{constructor(renderer$1){super(),this._renderer=renderer$1,renderer$1.runners.resolutionChange.add(this)}resolutionChange(){let text=this.renderable;text._autoResolution&&text.onViewUpdate()}destroy(){let{canvasText}=this._renderer;canvasText.getReferenceCount(this.currentKey)>0?canvasText.decreaseReferenceCount(this.currentKey):this.texture&&canvasText.returnTexture(this.texture),this._renderer.runners.resolutionChange.remove(this),this._renderer=null}},CanvasTextPipe=class{constructor(renderer$1){this._renderer=renderer$1}validateRenderable(text){let gpuText=this._getGpuText(text),newKey=text.styleKey;return gpuText.currentKey===newKey?text._didTextUpdate:!0}addRenderable(text,instructionSet){let batchableText=this._getGpuText(text);if(text._didTextUpdate){let resolution=text._autoResolution?this._renderer.resolution:text.resolution;(batchableText.currentKey!==text.styleKey||text.resolution!==resolution)&&this._updateGpuText(text),text._didTextUpdate=!1,updateTextBounds(batchableText,text)}this._renderer.renderPipes.batch.addToBatch(batchableText,instructionSet)}updateRenderable(text){let batchableText=this._getGpuText(text);batchableText._batcher.updateElement(batchableText)}_updateGpuText(text){let batchableText=this._getGpuText(text);batchableText.texture&&this._renderer.canvasText.decreaseReferenceCount(batchableText.currentKey),text._resolution=text._autoResolution?this._renderer.resolution:text.resolution,batchableText.texture=this._renderer.canvasText.getManagedTexture(text),batchableText.currentKey=text.styleKey}_getGpuText(text){return text._gpuData[this._renderer.uid]||this.initGpuText(text)}initGpuText(text){let batchableText=new BatchableText(this._renderer);return batchableText.currentKey=`--`,batchableText.renderable=text,batchableText.transform=text.groupTransform,batchableText.bounds={minX:0,maxX:1,minY:0,maxY:0},batchableText.roundPixels=this._renderer._roundPixels|text._roundPixels,text._gpuData[this._renderer.uid]=batchableText,batchableText}destroy(){this._renderer=null}};CanvasTextPipe.extension={type:[ExtensionType.WebGLPipes,ExtensionType.WebGPUPipes,ExtensionType.CanvasPipes],name:`text`};var CanvasTextSystem=class{constructor(_renderer){this._activeTextures={},this._renderer=_renderer}getTexture(options,_resolution,_style,_textKey){typeof options==`string`&&(deprecation(`8.0.0`,`CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments`),options={text:options,style:_style,resolution:_resolution}),options.style instanceof TextStyle||(options.style=new TextStyle(options.style)),options.textureStyle instanceof TextureStyle||(options.textureStyle=new TextureStyle(options.textureStyle)),typeof options.text!=`string`&&(options.text=options.text.toString());let{text,style,textureStyle}=options,resolution=options.resolution??this._renderer.resolution,{frame,canvasAndContext}=CanvasTextGenerator.getCanvasAndContext({text,style,resolution}),texture=getPo2TextureFromSource(canvasAndContext.canvas,frame.width,frame.height,resolution);if(textureStyle&&(texture.source.style=textureStyle),style.trim&&(frame.pad(style.padding),texture.frame.copyFrom(frame),texture.frame.scale(1/resolution),texture.updateUvs()),style.filters){let filteredTexture=this._applyFilters(texture,style.filters);return this.returnTexture(texture),CanvasTextGenerator.returnCanvasAndContext(canvasAndContext),filteredTexture}return this._renderer.texture.initSource(texture._source),CanvasTextGenerator.returnCanvasAndContext(canvasAndContext),texture}returnTexture(texture){let source$2=texture.source;source$2.resource=null,source$2.uploadMethodId=`unknown`,source$2.alphaMode=`no-premultiply-alpha`,TexturePool.returnTexture(texture,!0)}renderTextToCanvas(){deprecation(`8.10.0`,`CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead`)}getManagedTexture(text){text._resolution=text._autoResolution?this._renderer.resolution:text.resolution;let textKey=text.styleKey;if(this._activeTextures[textKey])return this._increaseReferenceCount(textKey),this._activeTextures[textKey].texture;let texture=this.getTexture({text:text.text,style:text.style,resolution:text._resolution,textureStyle:text.textureStyle});return this._activeTextures[textKey]={texture,usageCount:1},texture}decreaseReferenceCount(textKey){let activeTexture=this._activeTextures[textKey];activeTexture.usageCount--,activeTexture.usageCount===0&&(this.returnTexture(activeTexture.texture),this._activeTextures[textKey]=null)}getReferenceCount(textKey){return this._activeTextures[textKey]?.usageCount??0}_increaseReferenceCount(textKey){this._activeTextures[textKey].usageCount++}_applyFilters(texture,filters){let currentRenderTarget=this._renderer.renderTarget.renderTarget,resultTexture=this._renderer.filter.generateFilteredTexture({texture,filters});return this._renderer.renderTarget.bind(currentRenderTarget,!1),resultTexture}destroy(){for(let key$1 in this._renderer=null,this._activeTextures)this._activeTextures[key$1]&&this.returnTexture(this._activeTextures[key$1].texture);this._activeTextures=null}};CanvasTextSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:`canvasText`},extensions$1.add(browserExt,webworkerExt);var require_Collector=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Collector=class{constructor(signal){this.emit=(...args)=>{signal.emitCollecting(this,args)}}}})),require_CollectorArray=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var Collector_1$4=require_Collector();exports.CollectorArray=class extends Collector_1$4.Collector{constructor(){super(...arguments),this.result=[]}handleResult(result){return this.result.push(result),!0}getResult(){return this.result}reset(){this.result.length=0}}})),require_CollectorLast=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var Collector_1$3=require_Collector();exports.CollectorLast=class extends Collector_1$3.Collector{handleResult(result){return this.result=result,!0}getResult(){return this.result}reset(){delete this.result}}})),require_CollectorUntil0=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var Collector_1$2=require_Collector();exports.CollectorUntil0=class extends Collector_1$2.Collector{constructor(){super(...arguments),this.result=!1}handleResult(result){return this.result=result,this.result}getResult(){return this.result}reset(){this.result=!1}}})),require_CollectorWhile0=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var Collector_1$1=require_Collector();exports.CollectorWhile0=class extends Collector_1$1.Collector{constructor(){super(...arguments),this.result=!1}handleResult(result){return this.result=result,!this.result}getResult(){return this.result}reset(){this.result=!1}}})),require_SignalConnection=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SignalConnectionImpl=class{constructor(link,parentCleanup){this.link=link,this.parentCleanup=parentCleanup}disconnect(){return this.link===null?!1:(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0)}set enabled(enable){this.link&&this.link.setEnabled(enable)}get enabled(){return this.link!==null&&this.link.isEnabled()}}})),require_SignalLink=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SignalLink=class SignalLink{constructor(prev=null,next=null,order=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=prev??this,this.next=next??this,this.order=order}isEnabled(){return this.enabled&&!this.newLink}setEnabled(flag){this.enabled=flag}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(callback,order){let after=this.prev;for(;after!==this&&!(after.order<=order);)after=after.prev;let link=new SignalLink(after,after.next,order);return link.callback=callback,after.next=link,link.next.prev=link,link}}})),require_Signal=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var SignalConnection_1=require_SignalConnection(),SignalLink_1=require_SignalLink();exports.Signal=class{constructor(){this.head=new SignalLink_1.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(callback,order=0){this.connectionsCount++;let link=this.head.insert(callback,order);return this.emitDepth>0&&(this.hasNewLinks=!0,link.newLink=!0),new SignalConnection_1.SignalConnectionImpl(link,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(callback){for(let link=this.head.next;link!==this.head;link=link.next)if(link.callback===callback)return this.decrementConnectionCount(),link.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...args){this.emitDepth++;for(let link=this.head.next;link!==this.head;link=link.next)link.isEnabled()&&link.callback&&link.callback.apply(null,args);this.emitDepth--,this.unsetNewLink()}emitCollecting(collector,args){this.emitDepth++;for(let link=this.head.next;link!==this.head;link=link.next)if(link.isEnabled()&&link.callback){let result=link.callback.apply(null,args);if(!collector.handleResult(result))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let link=this.head.next;link!==this.head;link=link.next)link.newLink=!1;this.hasNewLinks=!1}}}})),require_SignalConnections=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SignalConnections=class{constructor(){this.list=[]}add(connection){this.list.push(connection)}disconnectAll(){for(let connection of this.list)connection.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}})),require_dist=__commonJSMin((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SignalConnections=exports.Signal=exports.CollectorWhile0=exports.CollectorUntil0=exports.CollectorLast=exports.CollectorArray=exports.Collector=void 0;var Collector_1=require_Collector();Object.defineProperty(exports,`Collector`,{enumerable:!0,get:function(){return Collector_1.Collector}});var CollectorArray_1=require_CollectorArray();Object.defineProperty(exports,`CollectorArray`,{enumerable:!0,get:function(){return CollectorArray_1.CollectorArray}});var CollectorLast_1=require_CollectorLast();Object.defineProperty(exports,`CollectorLast`,{enumerable:!0,get:function(){return CollectorLast_1.CollectorLast}});var CollectorUntil0_1=require_CollectorUntil0();Object.defineProperty(exports,`CollectorUntil0`,{enumerable:!0,get:function(){return CollectorUntil0_1.CollectorUntil0}});var CollectorWhile0_1=require_CollectorWhile0();Object.defineProperty(exports,`CollectorWhile0`,{enumerable:!0,get:function(){return CollectorWhile0_1.CollectorWhile0}});var Signal_1=require_Signal();Object.defineProperty(exports,`Signal`,{enumerable:!0,get:function(){return Signal_1.Signal}});var SignalConnections_1=require_SignalConnections();Object.defineProperty(exports,`SignalConnections`,{enumerable:!0,get:function(){return SignalConnections_1.SignalConnections}})})),import_dist$1=__toESM(require_dist(),1),__defProp$3=Object.defineProperty,__defNormalProp$3=(obj,key$1,value)=>key$1 in obj?__defProp$3(obj,key$1,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key$1]=value,__publicField$3=(obj,key$1,value)=>__defNormalProp$3(obj,typeof key$1==`symbol`?key$1:key$1+``,value),ButtonEvents=class{constructor(){__publicField$3(this,`_isMouseIn`),__publicField$3(this,`_isDown`),__publicField$3(this,`onDown`),__publicField$3(this,`onUp`),__publicField$3(this,`onUpOut`),__publicField$3(this,`onOut`),__publicField$3(this,`onPress`),__publicField$3(this,`onHover`),this.onPress=new import_dist$1.Signal,this.onDown=new import_dist$1.Signal,this.onUp=new import_dist$1.Signal,this.onHover=new import_dist$1.Signal,this.onOut=new import_dist$1.Signal,this.onUpOut=new import_dist$1.Signal}connectEvents(view){isMobile.any?(view.on(`pointerdown`,this.processDown,this),view.on(`pointerup`,this.processUp,this),view.on(`pointerupoutside`,this.processUpOut,this),view.on(`pointerout`,this.processOut,this),view.on(`pointertap`,this.processPress,this),view.on(`pointerover`,this.processOver,this)):(view.on(`mousedown`,this.processDown,this),view.on(`mouseup`,this.processUp,this),view.on(`mouseupoutside`,this.processUpOut,this),view.on(`mouseout`,this.processOut,this),view.on(`click`,this.processPress,this),view.on(`mouseover`,this.processOver,this))}disconnectEvents(view){isMobile.any?(view.off(`pointerdown`,this.processDown,this),view.off(`pointerup`,this.processUp,this),view.off(`pointerupoutside`,this.processUpOut,this),view.off(`pointerout`,this.processOut,this),view.off(`pointertap`,this.processPress,this),view.off(`pointerover`,this.processOver,this)):(view.off(`mousedown`,this.processDown,this),view.off(`mouseup`,this.processUp,this),view.off(`mouseupoutside`,this.processUpOut,this),view.off(`mouseout`,this.processOut,this),view.off(`click`,this.processPress,this),view.off(`mouseover`,this.processOver,this))}processDown(e$2){this._isDown=!0,this.onDown.emit(this,e$2),this.down(e$2)}processUp(e$2){this._isDown&&(this.onUp.emit(this,e$2),this.up(e$2)),this._isDown=!1}processUpOut(e$2){this._isDown&&(this.onUp.emit(this,e$2),this.onUpOut.emit(this,e$2),this.up(e$2),this.upOut(e$2)),this._isDown=!1}processOut(e$2){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,e$2),this.out(e$2))}processPress(e$2){this._isDown=!1,this.onPress.emit(this,e$2),this.press(e$2)}processOver(e$2){isMobile.any||(this._isMouseIn=!0,this.onHover.emit(this,e$2),this.hover(e$2))}down(_e){}up(_e){}upOut(_e){}out(_e){}press(_e){}hover(_e){}get isDown(){return this._isDown}},__defProp$2=Object.defineProperty,__defNormalProp$2=(obj,key$1,value)=>key$1 in obj?__defProp$2(obj,key$1,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key$1]=value,__publicField$2=(obj,key$1,value)=>__defNormalProp$2(obj,typeof key$1==`symbol`?key$1:key$1+``,value),Button=class extends ButtonEvents{constructor(view){super(),__publicField$2(this,`_view`),view&&(this.view=view,this.enabled=!0)}set view(view){this._view&&this.disconnectEvents(this._view),this._view=view,this.connectEvents(this._view)}get view(){return this._view}set enabled(enabled){if(!this.view){console.error(`Button view is not set. Please set it before enabling the button.`);return}this.view.eventMode=enabled?`static`:`auto`,this.view.cursor=enabled?`pointer`:`default`,!enabled&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode===`static`}},ButtonContainer=class extends Container{constructor(view){super(),__publicField$2(this,`button`),__publicField$2(this,`onDown`),__publicField$2(this,`onUp`),__publicField$2(this,`onUpOut`),__publicField$2(this,`onOut`),__publicField$2(this,`onPress`),__publicField$2(this,`onHover`),this.button=new Button(this),this.button.enabled=!0,view&&this.addChild(view),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(enabled){this.button.enabled=enabled}get enabled(){return this.button.enabled}};function getView(view){return typeof view==`string`?Sprite.from(view):view instanceof Texture?new Sprite(view):view}
/*!
* tweedle.js - v2.1.0
* Compiled Wed, 05 Apr 2023 15:21:25 UTC
*
* tweedle.js is licensed under the MIT License.
* http://www.opensource.org/licenses/mit-license
* 
* Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
*/
var NOW=typeof self>`u`&&typeof process<`u`&&process.hrtime?function(){let time=process.hrtime();return time[0]*1e3+time[1]/1e6}:typeof self<`u`&&self.performance!==void 0&&self.performance.now!==void 0?self.performance.now.bind(self.performance):Date.now===void 0?function(){return new Date().getTime()}:Date.now,Group$1=class Group$1{constructor(){Group$1.prototype.__init.call(this),Group$1.prototype.__init2.call(this),Group$1.prototype.__init3.call(this),Group$1.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Group$1._shared||=new Group$1,Group$1._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=NOW}getAll(){return Object.keys(this._tweens).map(tweenId=>this._tweens[tweenId])}removeAll(){this._tweens={}}add(tween){this._tweens[tween.getId()]=tween}remove(tween){delete this._tweens[tween.getId()]}update(deltaTime,preserve=!1){if(deltaTime??(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),deltaTime=0):deltaTime=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;let tweenIds=Object.keys(this._tweens);if(tweenIds.length==0)return!1;for(let i$1=0;i$1<tweenIds.length;i$1++){let tween=this._tweens[tweenIds[i$1]];tween&&tween.update(deltaTime,!0)==0&&!preserve&&delete this._tweens[tweenIds[i$1]]}return!0}},Easing={Step:{None(amount){return amount<.5?0:1}},Linear:{None(amount){return amount}},Quadratic:{In(amount){return amount*amount},Out(amount){return amount*(2-amount)},InOut(amount){return(amount*=2)<1?.5*amount*amount:-.5*(--amount*(amount-2)-1)}},Cubic:{In(amount){return amount*amount*amount},Out(amount){return--amount*amount*amount+1},InOut(amount){return(amount*=2)<1?.5*amount*amount*amount:.5*((amount-=2)*amount*amount+2)}},Quartic:{In(amount){return amount*amount*amount*amount},Out(amount){return 1- --amount*amount*amount*amount},InOut(amount){return(amount*=2)<1?.5*amount*amount*amount*amount:-.5*((amount-=2)*amount*amount*amount-2)}},Quintic:{In(amount){return amount*amount*amount*amount*amount},Out(amount){return--amount*amount*amount*amount*amount+1},InOut(amount){return(amount*=2)<1?.5*amount*amount*amount*amount*amount:.5*((amount-=2)*amount*amount*amount*amount+2)}},Sinusoidal:{In(amount){return 1-Math.cos(amount*Math.PI/2)},Out(amount){return Math.sin(amount*Math.PI/2)},InOut(amount){return .5*(1-Math.cos(Math.PI*amount))}},Exponential:{In(amount){return amount==0?0:1024**(amount-1)},Out(amount){return amount==1?1:1-2**(-10*amount)},InOut(amount){return amount==0?0:amount==1?1:(amount*=2)<1?.5*1024**(amount-1):.5*(-(2**(-10*(amount-1)))+2)}},Circular:{In(amount){return 1-Math.sqrt(1-amount*amount)},Out(amount){return Math.sqrt(1- --amount*amount)},InOut(amount){return(amount*=2)<1?-.5*(Math.sqrt(1-amount*amount)-1):.5*(Math.sqrt(1-(amount-=2)*amount)+1)}},Elastic:{In(amount){return amount==0?0:amount==1?1:-(2**(10*(amount-1)))*Math.sin((amount-1.1)*5*Math.PI)},Out(amount){return amount==0?0:amount==1?1:2**(-10*amount)*Math.sin((amount-.1)*5*Math.PI)+1},InOut(amount){return amount==0?0:amount==1?1:(amount*=2,amount<1?-.5*2**(10*(amount-1))*Math.sin((amount-1.1)*5*Math.PI):.5*2**(-10*(amount-1))*Math.sin((amount-1.1)*5*Math.PI)+1)}},Back:{In(amount){let s$1=1.70158;return amount*amount*((s$1+1)*amount-s$1)},Out(amount){let s$1=1.70158;return--amount*amount*((s$1+1)*amount+s$1)+1},InOut(amount){let s$1=1.70158*1.525;return(amount*=2)<1?.5*(amount*amount*((s$1+1)*amount-s$1)):.5*((amount-=2)*amount*((s$1+1)*amount+s$1)+2)}},Bounce:{In(amount){return 1-Easing.Bounce.Out(1-amount)},Out(amount){return amount<1/2.75?7.5625*amount*amount:amount<2/2.75?7.5625*(amount-=1.5/2.75)*amount+.75:amount<2.5/2.75?7.5625*(amount-=2.25/2.75)*amount+.9375:7.5625*(amount-=2.625/2.75)*amount+.984375},InOut(amount){return amount<.5?Easing.Bounce.In(amount*2)*.5:Easing.Bounce.Out(amount*2-1)*.5+.5}}},Interpolation={Geom:{Linear(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.Linear;return k$1<0?fn(v$1[0],v$1[1],f$1):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1)},Bezier(v$1,k$1){let b$1=0,n$1=v$1.length-1,pw=Math.pow,bn=Interpolation.Utils.Bernstein;for(let i$1=0;i$1<=n$1;i$1++)b$1+=bn(n$1,i$1)*pw(1-k$1,n$1-i$1)*pw(k$1,i$1)*v$1[i$1];return b$1},QuadraticBezier(v$1,k$1){let b$1=0,n$1=v$1.length-1;if(k$1==1)return v$1[n$1];let pw=Math.pow,bn=Interpolation.Utils.Bernstein,f$1=n$1*k$1,i$1=Math.floor(f$1),t$1=(f$1-i$1)*.5+.5*(i$1%2),i0=i$1-i$1%2,i1=i0+1,i2=i0+2;return b$1+=bn(2,0)*pw(1-t$1,2)*pw(t$1,0)*v$1[i0],b$1+=bn(2,1)*pw(1-t$1,1)*pw(t$1,1)*v$1[i1],b$1+=bn(2,2)*pw(1-t$1,0)*pw(t$1,2)*v$1[i2],b$1},CubicBezier(v$1,k$1){let b$1=0,n$1=v$1.length-1;if(k$1==1)return v$1[n$1];let pw=Math.pow,bn=Interpolation.Utils.Bernstein,f$1=n$1*k$1,i$1=Math.floor(f$1),t$1=(f$1-i$1)*(1/3)+1/3*(i$1%3),i0=i$1-i$1%3,i1=i0+1,i2=i0+2,i3=i0+3;return b$1+=bn(3,0)*pw(1-t$1,3)*pw(t$1,0)*v$1[i0],b$1+=bn(3,1)*pw(1-t$1,2)*pw(t$1,1)*v$1[i1],b$1+=bn(3,2)*pw(1-t$1,1)*pw(t$1,2)*v$1[i2],b$1+=bn(3,3)*pw(1-t$1,0)*pw(t$1,3)*v$1[i3],b$1},CatmullRom(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.CatmullRom;return v$1[0]==v$1[m$2]?(k$1<0&&(i$1=Math.floor(f$1=m$2*(1+k$1))),fn(v$1[(i$1-1+m$2)%m$2],v$1[i$1],v$1[(i$1+1)%m$2],v$1[(i$1+2)%m$2],f$1-i$1)):k$1<0?v$1[0]-(fn(v$1[0],v$1[0],v$1[1],v$1[1],-f$1)-v$1[0]):k$1>1?v$1[m$2]-(fn(v$1[m$2],v$1[m$2],v$1[m$2-1],v$1[m$2-1],f$1-m$2)-v$1[m$2]):fn(v$1[i$1?i$1-1:0],v$1[i$1],v$1[m$2<i$1+1?m$2:i$1+1],v$1[m$2<i$1+2?m$2:i$1+2],f$1-i$1)}},Angle:{Radians(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.WrapLinear;return k$1<0?fn(v$1[0],v$1[1],f$1,2*Math.PI):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1,2*Math.PI):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1,2*Math.PI)},Degrees(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.WrapLinear;return k$1<0?fn(v$1[0],v$1[1],f$1,360):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1,360):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1,360)}},Color:{RGB(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.RGBLinear;return k$1<0?fn(v$1[0],v$1[1],f$1):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1)},HSV(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.HSVLinear;return k$1<0?fn(v$1[0],v$1[1],f$1):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1)},HCL(v$1,k$1){let m$2=v$1.length-1,f$1=m$2*k$1,i$1=Math.floor(f$1),fn=Interpolation.Utils.HCLLinear;return k$1<0?fn(v$1[0],v$1[1],f$1):k$1>1?fn(v$1[m$2],v$1[m$2-1],m$2-f$1):fn(v$1[i$1],v$1[i$1+1>m$2?m$2:i$1+1],f$1-i$1)}},Utils:{RGBsplit(color$2){let a$1=color$2>>24&255,r$1=color$2>>16&255,g$1=color$2>>8&255,b$1=color$2&255;return{a:a$1,r:r$1,g:g$1,b:b$1}},HSVsplit(color$2){let rgb=Interpolation.Utils.RGBsplit(color$2);rgb.r/=255,rgb.g/=255,rgb.b/=255;let max$2=Math.max(rgb.r,rgb.g,rgb.b),min$2=Math.min(rgb.r,rgb.g,rgb.b),h$2,v$1=max$2,d$1=max$2-min$2,s$1=max$2==0?0:d$1/max$2;if(max$2==min$2)h$2=0;else{switch(max$2){case rgb.r:h$2=(rgb.g-rgb.b)/d$1+(rgb.g<rgb.b?6:0);break;case rgb.g:h$2=(rgb.b-rgb.r)/d$1+2;break;case rgb.b:h$2=(rgb.r-rgb.g)/d$1+4;break}h$2/=6}return{a:rgb.a,h:h$2,s:s$1,v:v$1}},HSVJoin(color$2){let r$1,g$1,b$1,i$1=Math.floor(color$2.h*6),f$1=color$2.h*6-i$1,p$2=color$2.v*(1-color$2.s),q$1=color$2.v*(1-f$1*color$2.s),t$1=color$2.v*(1-(1-f$1)*color$2.s);switch(i$1%6){case 0:r$1=color$2.v,g$1=t$1,b$1=p$2;break;case 1:r$1=q$1,g$1=color$2.v,b$1=p$2;break;case 2:r$1=p$2,g$1=color$2.v,b$1=t$1;break;case 3:r$1=p$2,g$1=q$1,b$1=color$2.v;break;case 4:r$1=t$1,g$1=p$2,b$1=color$2.v;break;case 5:r$1=color$2.v,g$1=p$2,b$1=q$1;break}return color$2.a<<24|r$1<<16|g$1<<8|b$1},HCLSplit(color$2){let HCLgamma=3,HCLy0=100,HCLmaxL=.530454533953517,RGB=Interpolation.Utils.RGBsplit(color$2),HCL={a:RGB.a,h:0,c:0,l:0},H$1=0,U=Math.min(RGB.r,Math.min(RGB.g,RGB.b)),V=Math.max(RGB.r,Math.max(RGB.g,RGB.b)),Q=3/100;return HCL.c=V-U,HCL.c!=0&&(H$1=Math.atan2(RGB.g-RGB.b,RGB.r-RGB.g)/Math.PI,Q*=U/V),Q=Math.exp(Q),HCL.h=(H$1/2-Math.min(H$1%1,-H$1%1)/6)%1,HCL.c*=Q,HCL.l=Interpolation.Utils.Linear(-U,V,Q)/(.530454533953517*2),HCL},HCLJoin(HCL){let HCLgamma=3,HCLy0=100,HCLmaxL=.530454533953517,RGB={a:HCL.a,r:0,g:0,b:0};if(HCL.l!=0){let H$1=HCL.h,C=HCL.c,L=HCL.l*.530454533953517,Q=Math.exp((1-C/(2*L))*(3/100)),U=(2*L-C)/(2*Q-1),V=C/Q,A=(H$1+Math.min(2*H$1%1/4,-2*H$1%1/8))*Math.PI*2,T;H$1*=6,H$1<=.999?(T=Math.tan(A),RGB.r=1,RGB.g=T/(1+T)):H$1<=1.001?(RGB.r=1,RGB.g=1):H$1<=2?(T=Math.tan(A),RGB.r=(1+T)/T,RGB.g=1):H$1<=3?(T=Math.tan(A),RGB.g=1,RGB.b=1+T):H$1<=3.999?(T=Math.tan(A),RGB.g=1/(1+T),RGB.b=1):H$1<=4.001?(RGB.g=0,RGB.b=1):H$1<=5?(T=Math.tan(A),RGB.r=-1/T,RGB.b=1):(T=Math.tan(A),RGB.r=1,RGB.b=-T),RGB.r=RGB.r*V+U,RGB.g=RGB.g*V+U,RGB.b=RGB.b*V+U}return RGB.a<<24|RGB.r<<16|RGB.g<<8|RGB.b},WrapLinear(value1,value2,t$1,maxValue){let retval;return value1=(value1+maxValue*Math.trunc(Math.abs(value1/maxValue)))%maxValue,value2=(value2+maxValue*Math.trunc(Math.abs(value2/maxValue)))%maxValue,Math.abs(value1-value2)<=.5*maxValue?retval=Interpolation.Utils.Linear(value1,value2,t$1):(retval=value1<value2?Interpolation.Utils.Linear(value1+maxValue,value2,t$1):Interpolation.Utils.Linear(value1,value2+maxValue,t$1),retval%=maxValue),retval},RGBLinear(color1,color2,t$1){let argb1=Interpolation.Utils.RGBsplit(color1),argb2=Interpolation.Utils.RGBsplit(color2),a$1=Interpolation.Utils.Linear(argb1.a,argb2.a,t$1),r$1=Interpolation.Utils.Linear(argb1.r,argb2.r,t$1),g$1=Interpolation.Utils.Linear(argb1.g,argb2.g,t$1),b$1=Interpolation.Utils.Linear(argb1.b,argb2.b,t$1);return a$1<<24|r$1<<16|g$1<<8|b$1},HSVLinear(color1,color2,t$1){let ahsv1=Interpolation.Utils.HSVsplit(color1),ahsv2=Interpolation.Utils.HSVsplit(color2),h$2;Math.abs(ahsv1.h-ahsv2.h)<=.5?h$2=Interpolation.Utils.Linear(ahsv1.h,ahsv2.h,t$1):(h$2=ahsv1.h<ahsv2.h?Interpolation.Utils.Linear(ahsv1.h+1,ahsv2.h,t$1):Interpolation.Utils.Linear(ahsv1.h,ahsv2.h+1,t$1),h$2%=1);let s$1=Interpolation.Utils.Linear(ahsv1.s,ahsv2.s,t$1),v$1=Interpolation.Utils.Linear(ahsv1.v,ahsv2.v,t$1),a$1=Interpolation.Utils.Linear(ahsv1.a,ahsv2.a,t$1);return Interpolation.Utils.HSVJoin({a:a$1,h:h$2,s:s$1,v:v$1})},HCLLinear(color1,color2,t$1){let ahcl1=Interpolation.Utils.HCLSplit(color1),ahcl2=Interpolation.Utils.HCLSplit(color2),h$2;Math.abs(ahcl1.h-ahcl2.h)<=.5?h$2=Interpolation.Utils.Linear(ahcl1.h,ahcl2.h,t$1):(h$2=ahcl1.h<ahcl2.h?Interpolation.Utils.Linear(ahcl1.h+1,ahcl2.h,t$1):Interpolation.Utils.Linear(ahcl1.h,ahcl2.h+1,t$1),h$2%=1);let s$1=Interpolation.Utils.Linear(ahcl1.c,ahcl2.c,t$1),v$1=Interpolation.Utils.Linear(ahcl1.l,ahcl2.l,t$1),a$1=Interpolation.Utils.Linear(ahcl1.a,ahcl2.a,t$1);return Interpolation.Utils.HSVJoin({a:a$1,h:h$2,s:s$1,v:v$1})},Linear(p0,p1,t$1){return(p1-p0)*t$1+p0},Bernstein(n$1,i$1){let fc=Interpolation.Utils.Factorial;return fc(n$1)/fc(i$1)/fc(n$1-i$1)},Factorial:(function(){let a$1=[1];return function(n$1){let s$1=1;if(a$1[n$1])return a$1[n$1];for(let i$1=n$1;i$1>1;i$1--)s$1*=i$1;return a$1[n$1]=s$1,s$1}})(),CatmullRom(p0,p1,p2,p3,t$1){let v0=(p2-p0)*.5,v1=(p3-p1)*.5,t2=t$1*t$1,t3=t$1*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t$1+p1}}},Sequence=class Sequence{static __initStatic(){this._nextId=0}static nextId(){return Sequence._nextId++}};Sequence.__initStatic();var DEFAULTS={safetyCheckFunction:_=>!0,easingFunction:Easing.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:Interpolation.Geom.Linear},Tween=class Tween{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!=0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=DEFAULTS.safetyCheckFunction}__init15(){this._easingFunction=DEFAULTS.easingFunction}__init16(){this._yoyoEasingFunction=DEFAULTS.yoyoEasingFunction}__init17(){this._interpolationFunction=DEFAULTS.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Sequence.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Group$1.shared}set _group(value){this._groupRef=value}constructor(object,group){Tween.prototype.__init.call(this),Tween.prototype.__init2.call(this),Tween.prototype.__init3.call(this),Tween.prototype.__init4.call(this),Tween.prototype.__init5.call(this),Tween.prototype.__init6.call(this),Tween.prototype.__init7.call(this),Tween.prototype.__init8.call(this),Tween.prototype.__init9.call(this),Tween.prototype.__init10.call(this),Tween.prototype.__init11.call(this),Tween.prototype.__init12.call(this),Tween.prototype.__init13.call(this),Tween.prototype.__init14.call(this),Tween.prototype.__init15.call(this),Tween.prototype.__init16.call(this),Tween.prototype.__init17.call(this),Tween.prototype.__init18.call(this),Tween.prototype.__init19.call(this),Tween.prototype.__init20.call(this),Tween.prototype.__init21.call(this),Tween.prototype.__init22.call(this),this._object=object,this._group=group}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(properties){try{JSON.stringify(properties)}catch{throw Error(`The object you provided to the from() method has a circular reference!`)}return this._setupProperties(properties,this._valuesStart,properties,this._valuesStartRepeat,!0),this}to(properties,duration){try{this._valuesEnd=JSON.parse(JSON.stringify(properties))}catch{return console.warn(`The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting`),this.dynamicTo(properties,duration)}return duration!==void 0&&(this._duration=duration),this}dynamicTo(properties,duration){return this._valuesEnd=properties,duration!==void 0&&(this._duration=duration),this}duration(d$1){return this._duration=d$1,this}start(delay){return this._isPlaying?this:(delay!=null&&(this._delayTime=delay),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(delay){return this.reset(),this.start(delay)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);let value=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,value),this}_setupProperties(_object,_valuesStart,_valuesEnd,_valuesStartRepeat,overwrite){for(let property in _valuesEnd){let startValue=_object[property],startValueIsArray=Array.isArray(startValue),startValueIsNumber=!Number.isNaN(Number(startValue)),propType=startValueIsArray?`array`:typeof startValue,startValueIsObject=propType==`object`,endValueIsObject=typeof _valuesEnd[property]==`object`,isInterpolationList=!startValueIsArray&&Array.isArray(_valuesEnd[property]);propType==`undefined`||propType==`function`||_valuesEnd[property]==null||!startValueIsArray&&!startValueIsNumber&&!startValueIsObject||((startValueIsObject||startValueIsArray||endValueIsObject)&&startValue&&!isInterpolationList?(_valuesStart[property]===void 0&&(_valuesStart[property]=startValueIsArray?[]:{}),_valuesStartRepeat[property]===void 0&&(_valuesStartRepeat[property]=startValueIsArray?[]:{}),this._setupProperties(startValue,_valuesStart[property],_valuesEnd[property],_valuesStartRepeat[property],overwrite)):((_valuesStart[property]===void 0||overwrite)&&(_valuesStart[property]=startValue),(_valuesStartRepeat[property]===void 0||overwrite)&&(isInterpolationList?_valuesStartRepeat[property]=_valuesEnd[property].slice().reverse()[0]:_valuesStartRepeat[property]=_valuesStart[property]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(endChainedTweens=!1){let protectedChainedTweens=[];if(endChainedTweens||(protectedChainedTweens=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!endChainedTweens){this._chainedTweens=protectedChainedTweens;for(let i$1=0,numChainedTweens=this._chainedTweens.length;i$1<numChainedTweens;i$1++)this._chainedTweens[i$1].start()}return this}skip(amount,resetCurrentLoop=!1){return this.resume(),this.update(amount*this._duration-(resetCurrentLoop?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let i$1=0,numChainedTweens=this._chainedTweens.length;i$1<numChainedTweens;i$1++)this._chainedTweens[i$1].stop();return this}startChainedTweens(stopThis=!1){stopThis&&this.stop();for(let i$1=0,numChainedTweens=this._chainedTweens.length;i$1<numChainedTweens;i$1++)this._chainedTweens[i$1].start();return this}group(group){return this._group=group,this}delay(amount){return this._delayTime=amount,this}timescale(multiplier){return this._timescale=multiplier,this}repeat(times=1/0){return this._repeat=times,this}repeatDelay(amount){return this._repeatDelayTime=amount,this}yoyo(yoyo=!0){return this._yoyo=yoyo,this}easing(easingFunction){return this._easingFunction=easingFunction,this}safetyCheck(safetyCheckFunction){return this._safetyCheckFunction=safetyCheckFunction,this}yoyoEasing(easingFunction){return this._yoyoEasingFunction=easingFunction,this}interpolation(interpolationFunction){return this._interpolationFunction=interpolationFunction,this}chain(...tweens){return this._chainedTweens=tweens,this}onStart(callback){return this._onStartCallback=callback,this}onAfterDelay(callback){return this._onAfterDelayCallback=callback,this}onUpdate(callback){return this._onUpdateCallback=callback,this}onRepeat(callback){return this._onRepeatCallback=callback,this}onComplete(callback){return this._onCompleteCallback=callback,this}onStop(callback){return this._onStopCallback=callback,this}update(deltaTime,preserve=!1){let retval=this._internalUpdate(deltaTime);return!retval&&!preserve&&this._group.remove(this),retval}_internalUpdate(deltaTime){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;deltaTime*=this._timescale;let elapsed;this._elapsedTime+=deltaTime;let endTime=this._duration,currentTime=this._startTime+this._elapsedTime;if(currentTime>endTime&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==0&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==0&&currentTime>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),elapsed=currentTime/this._duration,this._duration==0&&(elapsed=currentTime>=0?1:0),elapsed=Math.min(1,elapsed),elapsed=Math.max(0,elapsed);let leftOverTime=Number.isFinite(currentTime)?currentTime%this._duration:currentTime;Number.isNaN(leftOverTime)&&(leftOverTime=0);let loopsMade=Math.floor(currentTime/this._duration),value;if(value=this._reversed&&this._yoyoEasingFunction?this._yoyoEasingFunction(elapsed):this._easingFunction(elapsed),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,value),this._onUpdateCallback&&(elapsed!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,elapsed,this),elapsed==1){if(this._repeat-this._repeatCount>0){let oldCount=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+loopsMade),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||leftOverTime<=0)&&this._onUpdateCallback(this._object,elapsed,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime===void 0?this._startTime=0:this._startTime=-this._repeatDelayTime,this._onRepeatCallback){let callbackCount=1;Number.isFinite(loopsMade)?callbackCount=this._repeatCount-oldCount:Number.isFinite(this._repeat)&&(callbackCount=this._repeat-oldCount);for(let i$1=0;i$1<callbackCount;i$1++)this._onRepeatCallback(this._object,oldCount+1+i$1,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return leftOverTime>0&&Number.isFinite(this._repeat)&&this._internalUpdate(leftOverTime),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let i$1=0,numChainedTweens=this._chainedTweens.length;i$1<numChainedTweens;i$1++)this._chainedTweens[i$1].start(),leftOverTime>0&&this._chainedTweens[i$1].update(leftOverTime);return this._isPlaying=!1,!1}return!0}_updateProperties(_object,_valuesStart,_valuesEnd,value){for(let property in _valuesEnd){if(_valuesStart[property]==null)continue;let start$1=_valuesStart[property],end$1=_valuesEnd[property];!Array.isArray(_object[property])&&Array.isArray(end$1)?this._reversed?_object[property]=this._interpolationFunction(end$1.concat([start$1]),value):_object[property]=this._interpolationFunction([start$1].concat(end$1),value):typeof end$1==`object`&&end$1?this._updateProperties(_object[property],start$1,end$1,value):(end$1=this._handleRelativeValue(start$1,end$1),typeof end$1==`number`&&(typeof start$1==`number`||typeof start$1==`string`)&&(_object[property]=Number(start$1)+(end$1-Number(start$1))*value,typeof start$1==`string`&&(_object[property]=String(_object[property]))))}}_handleRelativeValue(start$1,end$1){return typeof end$1==`string`?end$1.charAt(0)==`+`||end$1.charAt(0)==`-`?start$1+Number(end$1):Number(end$1):end$1}_swapEndStartRepeatValues(_valuesStartRepeat,_valuesEnd){for(let property in _valuesStartRepeat){let isInterpolationList=!Array.isArray(_valuesStartRepeat[property])&&Array.isArray(_valuesEnd[property]);if(typeof _valuesStartRepeat[property]==`object`)this._swapEndStartRepeatValues(_valuesStartRepeat[property],_valuesEnd[property]);else{let tmp=_valuesStartRepeat[property];if(typeof _valuesEnd[property]==`string`)_valuesStartRepeat[property]=Number(_valuesStartRepeat[property])+Number(_valuesEnd[property]),_valuesEnd[property]=tmp;else if(isInterpolationList){let aux=_valuesEnd[property].slice().reverse();_valuesStartRepeat[property]=aux[0],_valuesEnd[property]=aux}else _valuesStartRepeat[property]=_valuesEnd[property],_valuesEnd[property]=tmp}}}_moveForwardStartRepeatValues(_valuesStartRepeat,_valuesEnd){for(let property in _valuesStartRepeat)typeof _valuesEnd[property]==`object`?this._moveForwardStartRepeatValues(_valuesStartRepeat[property],_valuesEnd[property]):typeof _valuesEnd[property]==`string`&&(_valuesStartRepeat[property]=Number(_valuesStartRepeat[property])+Number(_valuesEnd[property]))}};function fitToView(parent,child,padding=0,uniformScaling=!0){let scaleX=child.scale.x,scaleY=child.scale.y;if(!parent)throw Error(`Parent is not defined`);let maxWidth=parent.width-padding*2,maxHeight=parent.height-padding*2,widthOverflow=maxWidth-Math.round(child.width),heightOverflow=maxHeight-Math.round(child.height);if(widthOverflow<0&&(scaleX=maxWidth/(child.width/scaleX)),heightOverflow<0&&(scaleY=maxHeight/(child.height/scaleY)),scaleX<=0||scaleY<=0){child.scale.set(0);return}if(uniformScaling||child.scale.x===child.scale.y){let scale$3=Math.min(scaleX,scaleY);child.scale.set(scale$3,scale$3)}else{let ratio=child.scale.x/child.scale.y;widthOverflow<heightOverflow?child.scale.set(scaleX,scaleX/ratio):child.scale.set(scaleY*ratio,scaleY)}}function getTextView(text){return typeof text==`string`||typeof text==`number`?new Text({text:String(text)}):text}var __defProp$1=Object.defineProperty,__defNormalProp$1=(obj,key$1,value)=>key$1 in obj?__defProp$1(obj,key$1,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key$1]=value,__publicField$1=(obj,key$1,value)=>__defNormalProp$1(obj,typeof key$1==`symbol`?key$1:key$1+``,value),FancyButton=class extends ButtonContainer{constructor(options){super(),__publicField$1(this,`animations`),__publicField$1(this,`originalInnerViewState`),__publicField$1(this,`defaultDuration`,100),__publicField$1(this,`options`),__publicField$1(this,`_padding`),__publicField$1(this,`_offset`),__publicField$1(this,`_textOffset`),__publicField$1(this,`iconOffset`),__publicField$1(this,`innerView`,new Container),__publicField$1(this,`_views`,{}),__publicField$1(this,`state`),__publicField$1(this,`anchor`),__publicField$1(this,`_defaultTextScale`,{x:1,y:1}),__publicField$1(this,`_defaultIconScale`,{x:1,y:1}),__publicField$1(this,`_defaultTextAnchor`,{x:.5,y:.5}),__publicField$1(this,`_defaultIconAnchor`,{x:.5,y:.5}),this.options=options??{};let{defaultView,hoverView,pressedView,disabledView,text,padding,offset,textOffset,iconOffset,defaultTextScale:textScale,defaultIconScale:iconScale,defaultTextAnchor:textAnchor,defaultIconAnchor:iconAnchor,scale:scale$3,anchor,anchorX,anchorY,icon,animations}=options??{};this.addChild(this.innerView),this.anchor=new ObservablePoint({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(anchorX??anchor??0,anchorY??anchor??0),this.padding=padding??0,this.offset=offset,this.textOffset=textOffset,this.iconOffset=iconOffset,this.defaultTextScale=textScale,this.defaultIconScale=iconScale,this.defaultTextAnchor=textAnchor,this.defaultIconAnchor=iconAnchor,this.scale.set(scale$3??1),animations&&(this.animations=animations,Ticker.shared.add(()=>Group$1.shared.update())),this.setState(`default`),this.defaultView=defaultView,this.hoverView=hoverView,this.pressedView=pressedView,this.disabledView=disabledView,this.text=text,this.iconView=icon,this.initStateControl()}set text(text){if(!text||text===0){this.removeView(`textView`);return}if(!this._views.textView){this.createTextView(text);return}this._views.textView.text=text.toString()}get text(){return this._views.textView?.text}set enabled(enabled){this.button.enabled=enabled,this.setState(enabled?`default`:`disabled`)}get enabled(){return this.button.enabled}setState(newState,force=!1){if(!force&&this.state===newState)return;let currentView=this.getStateView(this.state);currentView&&(currentView.visible=!1),this.state=newState;let activeView=this.getStateView(newState);activeView&&(this.setOffset(activeView,newState,this.offset),activeView.visible=!0),this.updateAnchor(),this.playAnimations(newState)}createTextView(text){if(this._views.textView=getTextView(text),this.options?.defaultTextScale===void 0){let{x:x$1,y:y$1}=this._views.textView.scale;this._defaultTextScale={x:x$1,y:y$1}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(view,state,offset){let stateOffset=offset?offset[state]:{x:0,y:0},defaultStateOffset=offset?.default;stateOffset?(view.x+=stateOffset.x??0,view.y+=stateOffset.y??0):defaultStateOffset?(view.x+=defaultStateOffset.x??0,view.y+=defaultStateOffset.y??0):(offset.x||offset.y)&&(view.x+=offset.x??0,view.y+=offset.y??0)}getStateView(state){if(this._views)switch(state){case`hover`:return this._views.hoverView??this._views.defaultView??void 0;case`pressed`:return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case`disabled`:return this._views.disabledView??this._views.defaultView??void 0;case`default`:return this._views.defaultView??void 0;default:return}}adjustTextView(state){if(!this.text)return;let activeView=this.getStateView(this.state),{x:anchorX,y:anchorY}=this._defaultTextAnchor;if(activeView){if(this.options.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),this.contentFittingMode===`default`&&fitToView(activeView,this._views.textView,this.padding,!1),this.contentFittingMode===`fill`){this._views.textView.scale.set(1);let availableWidth=activeView.width-this.padding*2,availableHeight=activeView.height-this.padding*2,targetScaleX=availableWidth/this._views.textView.width,targetScaleY=availableHeight/this._views.textView.height,scale$3=Math.min(targetScaleX,targetScaleY);this._views.textView.scale.set(scale$3*this._defaultTextScale.x,scale$3*this._defaultTextScale.y)}this._views.textView.x=activeView.x+activeView.width/2,this._views.textView.y=activeView.y+activeView.height/2}this._views.textView.anchor.set(anchorX,anchorY),this.setOffset(this._views.textView,state,this.textOffset)}adjustIconView(state){if(!this._views.iconView)return;let activeView=this.getStateView(state);if(!activeView)return;if(this.options.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y),this.contentFittingMode===`default`&&fitToView(activeView,this._views.iconView,this.padding,!1),this.contentFittingMode===`fill`){this._views.iconView.scale.set(1);let availableWidth=activeView.width-this.padding*2,availableHeight=activeView.height-this.padding*2,targetScaleX=availableWidth/this._views.iconView.width,targetScaleY=availableHeight/this._views.iconView.height,scale$3=Math.min(targetScaleX,targetScaleY);this._views.iconView.scale.set(scale$3*this._defaultIconScale.x,scale$3*this._defaultIconScale.y)}let{x:anchorX,y:anchorY}=this._defaultIconAnchor;`anchor`in this._views.iconView?this._views.iconView.anchor.set(anchorX,anchorY):this._views.iconView.pivot.set(anchorX*(this._views.iconView.width/this._views.iconView.scale.x),anchorY*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=activeView.x+activeView.width/2,this._views.iconView.y=activeView.y+activeView.height/2,this.setOffset(this._views.iconView,state,this.iconOffset)}updateAnchor(){if(!this._views)return;let anchorX=this.anchor.x??0,anchorY=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach(view=>{view&&(view.anchor?.set(0),view.x=-view.width*anchorX,view.y=-view.height*anchorY)}),this._views.defaultView){let{x:x$1,y:y$1,width,height}=this._views.defaultView;this.hitArea=new Rectangle(x$1,y$1,width,height)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set contentFittingMode(mode){this.options.contentFittingMode=mode}get contentFittingMode(){return this.options.contentFittingMode??`default`}set defaultView(view){this.updateView(`defaultView`,view),this._views.disabledView&&this.state!==`default`&&(this._views.disabledView.visible=!1)}get defaultView(){return this._views.defaultView}set hoverView(view){this.updateView(`hoverView`,view),this._views.hoverView&&this.state!==`hover`&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(view){this.updateView(`pressedView`,view),this._views.pressedView&&this.state!==`pressed`&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(view){this.updateView(`disabledView`,view),this._views.disabledView&&this.state!==`disabled`&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(viewType,view){view!==void 0&&(this.removeView(viewType),view!==null&&(this.options?.nineSliceSprite&&(typeof view==`string`?this._views[viewType]=new NineSliceSprite({texture:Texture.from(view),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):view instanceof Texture?this._views[viewType]=new NineSliceSprite({texture:view,leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn(`NineSliceSprite can not be used with views set as Container. Pass the texture or texture name as instead of the Container extended instance.`)),this._views[viewType]||(this._views[viewType]=getView(view)),this.setOffset(this._views[viewType],this.state,this.offset),this._views[viewType].parent||this.innerView.addChild(this._views[viewType]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0)))}removeView(viewType){this._views[viewType]&&(this.innerView.removeChild(this._views[viewType]),this._views[viewType]=null)}set textView(textView){textView!==void 0&&(this.removeView(`textView`),textView!==null&&this.createTextView(textView))}get textView(){return this._views.textView}set iconView(view){if(view!==void 0&&(this.removeView(`iconView`),view!==null)){if(this._views.iconView=getView(view),this.options?.defaultIconScale===void 0){let{x:x$1,y:y$1}=this._views.iconView.scale;this._defaultIconScale={x:x$1,y:y$1}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(state){if(!this.animations)return;if(state===`default`&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};let defaultStateAnimation=this.animations?.default;if(defaultStateAnimation){this.innerView.x=defaultStateAnimation.props.x??this.originalInnerViewState.x,this.innerView.y=defaultStateAnimation.props.y??this.originalInnerViewState.y,this.innerView.width=defaultStateAnimation.props.width??this.originalInnerViewState.width,this.innerView.height=defaultStateAnimation.props.height??this.originalInnerViewState.height,this.innerView.scale.x=defaultStateAnimation.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=defaultStateAnimation.props.scale.y??this.originalInnerViewState.scale.y;return}}let stateAnimation=this.animations[state]??this.animations.default;if(stateAnimation){let data=stateAnimation;this.defaultDuration=data.duration,new Tween(this.innerView).to(data.props,data.duration).start();return}new Tween(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}initStateControl(){this.onDown.connect(()=>{this.setState(`pressed`)}),this.onUp.connect(()=>{isMobile.any?this.setState(`default`):this.setState(`hover`)}),this.onUpOut.connect(()=>{this.setState(`default`)}),this.onOut.connect(()=>{this.button.isDown||this.setState(`default`)}),this.onPress.connect(()=>{isMobile.any?this.setState(`default`):this.setState(`hover`)}),this.onHover.connect(()=>{this.button.isDown||(isMobile.any?this.setState(`default`):this.setState(`hover`))})}set padding(padding){this._padding=padding,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(offset){this._offset=offset,this.updateAnchor()}get offset(){return this._offset}set textOffset(textOffset){this._textOffset=textOffset,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(scale$3){if(scale$3===void 0)return;this.options.defaultTextScale=scale$3;let isNumber$1=typeof scale$3==`number`;this._defaultTextScale.x=isNumber$1?scale$3:scale$3.x??1,this._defaultTextScale.y=isNumber$1?scale$3:scale$3.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(scale$3){if(scale$3===void 0)return;this.options.defaultIconScale=scale$3;let isNumber$1=typeof scale$3==`number`;this._defaultIconScale.x=isNumber$1?scale$3:scale$3.x??1,this._defaultIconScale.y=isNumber$1?scale$3:scale$3.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(anchor){if(anchor===void 0)return;this.options.defaultTextAnchor=anchor;let isNumber$1=typeof anchor==`number`;this._defaultTextAnchor.x=isNumber$1?anchor:anchor.x??1,this._defaultTextAnchor.y=isNumber$1?anchor:anchor.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(anchor){if(anchor===void 0)return;this.options.defaultIconAnchor=anchor;let isNumber$1=typeof anchor==`number`;this._defaultIconAnchor.x=isNumber$1?anchor:anchor.x??1,this._defaultIconAnchor.y=isNumber$1?anchor:anchor.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(width){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=width),this._views.hoverView&&(this._views.hoverView.width=width),this._views.pressedView&&(this._views.pressedView.width=width),this._views.disabledView&&(this._views.disabledView.width=width),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=width}get width(){return super.width}set height(height){this.options?.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=height),this._views.hoverView&&(this._views.hoverView.height=height),this._views.pressedView&&(this._views.pressedView.height=height),this._views.disabledView&&(this._views.disabledView.height=height),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=height}get height(){return super.height}setSize(value,height){this.options?.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(value,height),this._views.hoverView&&this._views.hoverView.setSize(value,height),this._views.pressedView&&this._views.pressedView.setSize(value,height),this._views.disabledView&&this._views.disabledView.setSize(value,height),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(value,height)}},import_dist=__toESM(require_dist(),1),__defProp=Object.defineProperty,__defNormalProp=(obj,key$1,value)=>key$1 in obj?__defProp(obj,key$1,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key$1]=value,__publicField=(obj,key$1,value)=>__defNormalProp(obj,typeof key$1==`symbol`?key$1:key$1+``,value),SECURE_CHARACTER=`*`,Input=class extends Container{constructor(options){super(),__publicField(this,`_bg`),__publicField(this,`inputMask`),__publicField(this,`_cursor`),__publicField(this,`_value`,``),__publicField(this,`_secure`),__publicField(this,`inputField`),__publicField(this,`placeholder`),__publicField(this,`editing`,!1),__publicField(this,`tick`,0),__publicField(this,`lastInputData`),__publicField(this,`activation`,!1),__publicField(this,`options`),__publicField(this,`input`),__publicField(this,`handleActivationBinding`,this.handleActivation.bind(this)),__publicField(this,`onKeyUpBinding`,this.onKeyUp.bind(this)),__publicField(this,`stopEditingBinding`,this.stopEditing.bind(this)),__publicField(this,`onInputBinding`,this.onInput.bind(this)),__publicField(this,`onPasteBinding`,this.onPaste.bind(this)),__publicField(this,`onEnter`),__publicField(this,`onChange`),__publicField(this,`paddingTop`,0),__publicField(this,`paddingRight`,0),__publicField(this,`paddingBottom`,0),__publicField(this,`paddingLeft`,0),this.options=options,this.options=options,this.padding=options.padding,this._secure=options.secure??!1,this.cursor=`text`,this.interactive=!0,this.on(`pointertap`,()=>{this.activation=!0,isMobile.any&&this.handleActivation()}),window.addEventListener(isMobile.any?`touchstart`:`click`,this.handleActivationBinding),this.onEnter=new import_dist.Signal,this.onChange=new import_dist.Signal,Ticker.shared.add(ticker=>this.update(ticker.deltaTime)),options.bg?this.bg=options.bg:console.error(`Input: bg is not defined, please define it.`)}onInput(e$2){this.lastInputData=e$2.data}onKeyUp(e$2){let key$1=e$2.key;`Shift.Control.Alt.Meta.ArrowLeft.ArrowRight.ArrowUp.ArrowDown.CapsLock.AltGraph.Tab.ContextMenu.F1.F2.F3.F4.F5.F6.F7.F8.F9.F10.F11.F12.ScrollLock.Pause.Insert.Delete.Home.End.PageUp.PageDown.NumLock.Dead`.split(`.`).includes(key$1)||e$2.metaKey||e$2.ctrlKey||(key$1===`Backspace`?this._delete():key$1===`Escape`||key$1===`Enter`?this.stopEditing():key$1.length===1?this._add(key$1):this.lastInputData&&this.lastInputData.length===1&&this._add(this.lastInputData),this.input&&(this.input.value=``))}init(){let options=this.options,defaultTextStyle={fill:0,align:`center`};this.options.textStyle=options.textStyle??defaultTextStyle,this.options.TextClass=options.TextClass??Text;let textStyle={...defaultTextStyle,...options.textStyle},colorSource=textStyle.fill&&Color.isColorLike(textStyle.fill)?textStyle.fill:0;this.inputField=new this.options.TextClass({text:``,style:textStyle}),this._cursor=new Sprite(Texture.WHITE),this._cursor.tint=colorSource,this._cursor.anchor.set(.5),this._cursor.width=2,this._cursor.height=this.inputField.height*.8,this._cursor.alpha=0,this.placeholder=new this.options.TextClass({text:options.placeholder,style:textStyle??defaultTextStyle}),this.placeholder.visible=!!options.placeholder,this.addChild(this.inputField,this.placeholder,this._cursor),this.value=options.value??``,this.align()}set bg(bg){this._bg&&this._bg.destroy(),this.options?.nineSliceSprite&&(typeof bg==`string`?this._bg=new NineSliceSprite({texture:Texture.from(bg),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):bg instanceof Texture?this._bg=new NineSliceSprite({texture:bg,leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn(`NineSliceSprite can not be used with views set as Container.
                    Pass the texture or texture name as instead of the Container extended instance.`)),this._bg||=getView(bg),this._bg.cursor=`text`,this._bg.interactive=!0,this.addChildAt(this._bg,0),this.inputField||this.init(),this.options.addMask&&this.createInputMask(bg)}get bg(){return this._bg}_add(key$1){this.editing&&(this.options.maxLength&&this.value.length>=this.options.maxLength||(this.value+=key$1,this.onChange.emit(this.value)))}_delete(){let length$1=this.value.length;!this.editing||length$1===0||(this.value=this.value.substring(0,length$1-1),this.onChange.emit(this.value))}_startEditing(){this.options.cleanOnFocus&&(this.value=``),this.tick=0,this.editing=!0,this.placeholder.visible=!1,this._cursor.alpha=1,this.createInputField(),this.align()}createInputField(){this.input&&=(this.input.removeEventListener(`blur`,this.stopEditingBinding),this.input.removeEventListener(`keydown`,this.onKeyUpBinding),this.input.removeEventListener(`input`,this.onInputBinding),this.input.removeEventListener(`paste`,this.onPasteBinding),this.input?.blur(),this.input?.remove(),null);let input=document.createElement(`input`);document.body.appendChild(input),input.style.position=`fixed`,input.style.left=`${this.getGlobalPosition().x}px`,input.style.top=`${this.getGlobalPosition().y}px`,input.style.opacity=`0.0000001`,input.style.width=`${this._bg.width}px`,input.style.height=`${this._bg.height}px`,input.style.border=`none`,input.style.outline=`none`,input.style.background=`white`,isMobile.android.device?setTimeout(()=>{input.focus(),input.click()},100):(input.focus(),input.click()),input.addEventListener(`blur`,this.stopEditingBinding),input.addEventListener(`keydown`,this.onKeyUpBinding),input.addEventListener(`input`,this.onInputBinding),input.addEventListener(`paste`,this.onPasteBinding),this.input=input,this.align()}handleActivation(){this.editing||(this.stopEditing(),this.activation&&=(this._startEditing(),!1))}stopEditing(){this.editing&&(this._cursor.alpha=0,this.editing=!1,this.inputField.text===``&&(this.placeholder.visible=!0),this.value.length===0&&(this.placeholder.visible=!0),this.input?.blur(),this.input?.remove(),this.input=null,this.align(),this.onEnter.emit(this.value))}update(dt){this.editing&&(this.tick+=dt*.1,this._cursor.alpha=Math.round(Math.sin(this.tick)*.5+.5))}align(){if(!this._bg)return;let align=this.getAlign();this.inputField.anchor.set(align,.5),this.inputField.x=this._bg.width*align+(align===1?-this.paddingRight:this.paddingLeft),this.inputField.y=this._bg.height/2+this.paddingTop-this.paddingBottom,this.placeholder.anchor.set(align,.5),this.placeholder.x=this._bg.width*align+(align===1?-this.paddingRight:this.paddingLeft),this.placeholder.y=this._bg.height/2,this._cursor.x=this.getCursorPosX(),this._cursor.y=this.inputField.y}getAlign(){let maxWidth=this._bg.width*.95,paddings=this.paddingLeft+this.paddingRight-10;if(this.inputField.width+paddings>maxWidth)return this.editing?1:0;switch(this.options.align){case`left`:return 0;case`center`:return .5;case`right`:return 1;default:return 0}}getCursorPosX(){switch(this.getAlign()){case 0:return this.inputField.x+this.inputField.width;case .5:return this.inputField.x+this.inputField.width*.5;case 1:return this.inputField.x;default:return 0}}set value(text){let textLength=text.length;this._value=text,this.inputField.text=this.secure?SECURE_CHARACTER.repeat(textLength):text,textLength===0?this.placeholder.visible=!this.editing:this.placeholder.visible=!1,this.align()}get value(){return this._value}set secure(val){this._secure=val,this.value=this._value}get secure(){return this._secure}set padding(value){typeof value==`number`&&(this.paddingTop=value,this.paddingRight=value,this.paddingBottom=value,this.paddingLeft=value),Array.isArray(value)?(this.paddingTop=value[0]??0,this.paddingRight=value[1]??value[0]??0,this.paddingBottom=value[2]??value[0]??0,this.paddingLeft=value[3]??value[1]??value[0]??0):typeof value==`object`&&(this.paddingTop=value.top??0,this.paddingRight=value.right??0,this.paddingBottom=value.bottom??0,this.paddingLeft=value.left??0)}get padding(){return[this.paddingTop,this.paddingRight,this.paddingBottom,this.paddingLeft]}destroy(options){this.off(`pointertap`),window.removeEventListener(isMobile.any?`touchstart`:`click`,this.handleActivationBinding),super.destroy(options)}set width(width){this.options?.nineSliceSprite?(this._bg&&(this._bg.width=width),this.updateInputMaskSize(),this.align()):super.width=width}get width(){return super.width}set height(height){this.options?.nineSliceSprite?(this._bg&&(this._bg.height=height),this.updateInputMaskSize(),this.align()):super.height=height}get height(){return super.height}setSize(value,height){this.options?.nineSliceSprite?(this._bg&&this._bg.setSize(value,height),this.updateInputMaskSize(),this.align()):super.setSize(value,height)}createInputMask(bg){this.inputMask&&(this.inputField.mask=null,this._cursor.mask=null,this.inputMask.destroy()),this.options?.nineSliceSprite&&typeof bg==`string`?this.inputMask=new NineSliceSprite({texture:Texture.from(bg),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):bg instanceof Sprite?this.inputMask=new Sprite(bg.texture):bg instanceof Graphics?this.inputMask=bg.clone(!0):this.inputMask=getView(bg),this.inputField.mask=this.inputMask,this._cursor.mask=this.inputMask,this.updateInputMaskSize(),this.addChildAt(this.inputMask,0)}updateInputMaskSize(){!this.inputMask||!this._bg||(this.inputMask.setSize(this._bg.width-this.paddingLeft-this.paddingRight,this._bg.height-this.paddingTop-this.paddingBottom),this.inputMask.position.set(this.paddingLeft,this.paddingTop))}onPaste(e$2){e$2.preventDefault();let text=(e$2.clipboardData||window.clipboardData).getData(`text`);text&&this._add(text)}};function getDefaultChartPadding(){return{top:60,right:60,bottom:60,left:60}}let AxisPosition=function(AxisPosition$1){return AxisPosition$1.Top=`top`,AxisPosition$1.Right=`right`,AxisPosition$1.Bottom=`bottom`,AxisPosition$1.Left=`left`,AxisPosition$1}({});function getDefaultAxisOptions(){return{tickLength:6,tickLabelOffset:8,showGrid:!0,showLabels:!0}}var Axis$1=class{constructor(context$1,scale$3,position,options={}){this.context=context$1,this.scale=scale$3,this.position=position,this.options={...getDefaultAxisOptions(),...options}}generateGridShapes(bounds){if(!this.options.showGrid)return[];let xRange=[bounds.x,bounds.x+bounds.width],yRange=[bounds.y,bounds.y+bounds.height],ticks=this.generateTicks(),shapes=[];return ticks.forEach(tick=>{this.isHorizontalAxis()?shapes.push({type:`line`,start:{x:tick.scaledPosition,y:yRange[0]},end:{x:tick.scaledPosition,y:yRange[1]},color:this.context.config.theme.colors.gridColor,lineWidth:1}):shapes.push({type:`line`,start:{x:xRange[0],y:tick.scaledPosition},end:{x:xRange[1],y:tick.scaledPosition},color:this.context.config.theme.colors.gridColor,lineWidth:1})}),shapes}generateAxisLineShape(bounds){let baseShape={color:this.context.config.theme.colors.tickColor,lineWidth:1};switch(this.position){case AxisPosition.Bottom:return{type:`line`,start:{x:bounds.x,y:bounds.y+bounds.height},end:{x:bounds.x+bounds.width,y:bounds.y+bounds.height},...baseShape};case AxisPosition.Top:return{type:`line`,start:{x:bounds.x,y:bounds.y},end:{x:bounds.x+bounds.width,y:bounds.y},...baseShape};case AxisPosition.Left:return{type:`line`,start:{x:bounds.x,y:bounds.y},end:{x:bounds.x,y:bounds.y+bounds.height},...baseShape};case AxisPosition.Right:return{type:`line`,start:{x:bounds.x+bounds.width,y:bounds.y},end:{x:bounds.x+bounds.width,y:bounds.y+bounds.height},...baseShape}}}generateLabelShapes(bounds){if(!this.options.showLabels)return[];let xRange=[bounds.x,bounds.x+bounds.width],yRange=[bounds.y,bounds.y+bounds.height],ticks=this.generateTicks(),shapes=[],{textAlign,textBaseline}=this.getTextAlignment();return ticks.forEach(tick=>{if(tick.label){if(this.isHorizontalAxis()){if(tick.scaledPosition<xRange[0]||tick.scaledPosition>xRange[1])return}else if(tick.scaledPosition<yRange[0]||tick.scaledPosition>yRange[1])return;let{x:x$1,y:y$1}=this.getLabelPositionWithBounds(tick.scaledPosition,bounds);shapes.push({type:`text`,position:{x:x$1,y:y$1},text:tick.label,color:this.context.config.theme.colors.tickLabelColor,font:this.context.config.theme.typography.axisFont,align:textAlign,baseline:textBaseline})}}),shapes}updateScale(scale$3){this.scale=scale$3}updateOptions(options){this.options={...this.options,...options}}isHorizontalAxis(){return this.position===AxisPosition.Top||this.position===AxisPosition.Bottom}getLabelPositionWithBounds(scaledPosition,bounds){let xRange=[bounds.x,bounds.x+bounds.width],yRange=[bounds.y,bounds.y+bounds.height],offset=this.options.tickLength+this.options.tickLabelOffset;switch(this.position){case AxisPosition.Bottom:return{x:scaledPosition,y:yRange[1]+offset};case AxisPosition.Top:return{x:scaledPosition,y:yRange[0]-offset};case AxisPosition.Left:return{x:xRange[0]-offset,y:scaledPosition};case AxisPosition.Right:return{x:xRange[1]+offset,y:scaledPosition}}}getTextAlignment(){switch(this.position){case AxisPosition.Bottom:return{textAlign:`center`,textBaseline:`top`};case AxisPosition.Top:return{textAlign:`center`,textBaseline:`bottom`};case AxisPosition.Left:return{textAlign:`right`,textBaseline:`middle`};case AxisPosition.Right:return{textAlign:`left`,textBaseline:`middle`}}}},NumericAxis=class extends Axis$1{constructor(context$1,scale$3,position,tickCount=12,options={}){super(context$1,scale$3,position,options),this.numericScale=scale$3,this.tickCount=tickCount}generateTicks(){let ticks=[],domain=this.numericScale.getDomain(),tickSpacing=domain.tickSpacing,currentValue=domain.min;for(;currentValue<=domain.max+tickSpacing/2;){let scaledPosition=this.numericScale.scaledValue(currentValue),label=this.formatTickLabel(currentValue);ticks.push({value:currentValue,scaledPosition,label}),currentValue+=tickSpacing}return ticks}formatTickLabel(value){let absValue=Math.abs(value);return absValue>=1e9?`${(value/1e9).toFixed(1)}B`:absValue>=1e6?`${(value/1e6).toFixed(1)}M`:absValue>=1e3?`${(value/1e3).toFixed(1)}K`:absValue>=100?`${Math.round(value)}`:absValue<1&&value!==0?value.toFixed(4):value.toFixed(2)}updateTickCount(tickCount){this.tickCount=tickCount}},MainPane=class{constructor(context$1,candleStudy){this.overlayStudies=[],this.bounds={x:0,y:0,width:0,height:0},this.candleStudy=candleStudy,this.priceAxis=new NumericAxis(context$1,context$1.scales.priceScale,AxisPosition.Right,8)}updateBounds(bounds,priceScale){this.bounds=bounds,priceScale.updateRange(bounds.y,bounds.y+bounds.height)}addOverlayStudy(study){this.overlayStudies.push(study)}removeOverlayStudy(studyId){this.overlayStudies=this.overlayStudies.filter(s$1=>s$1.id!==studyId)}get allStudies(){return[this.candleStudy,...this.overlayStudies]}renderTo(compositor,commonScaleManager){this.candleStudy.renderTo(compositor,commonScaleManager,this.bounds);for(let overlay of this.overlayStudies)overlay.renderTo(compositor,commonScaleManager,this.bounds)}renderInfrastructureTo(compositor,commonScaleManager){this.candleStudy.renderInfrastructureTo(compositor,commonScaleManager,this.bounds);for(let overlay of this.overlayStudies)overlay.renderInfrastructureTo(compositor,commonScaleManager,this.bounds)}generatePriceAxisGridShapes(){return this.priceAxis.generateGridShapes(this.bounds)}generatePriceAxisLineShape(){return this.priceAxis.generateAxisLineShape(this.bounds)}generatePriceAxisLabelShapes(){return this.priceAxis.generateLabelShapes(this.bounds)}},SubPane=class{constructor(context$1,id,primaryStudy,heightPercent,otherStudies=[]){this.bounds={x:0,y:0,width:0,height:0},this.id=id,this.primaryStudy=primaryStudy,this.heightPercent=heightPercent,this.otherStudies=otherStudies;let yScale=primaryStudy.getYScale();if(!yScale)throw Error(`SubPane primary study must have a Y-scale`);this.priceAxis=new NumericAxis(context$1,yScale,AxisPosition.Right,6)}get allStudies(){return[this.primaryStudy,...this.otherStudies]}updateLastCandle(allCandles){let updates=this.allStudies.map(study=>study.updateLastCandle(allCandles)).filter(update=>update!==null);return this.mergeUpdates(updates)}appendNewCandle(allCandles){let updates=this.allStudies.map(study=>study.appendNewCandle(allCandles)).filter(update=>update!==null);return this.mergeUpdates(updates)}prependHistoricalCandles(allCandles){let updates=this.allStudies.map(study=>study.prependHistoricalCandles(allCandles)).filter(update=>update!==null);return this.mergeUpdates(updates)}resetCandles(allCandles){let updates=this.allStudies.map(study=>study.resetCandles(allCandles)).filter(update=>update!==null);return this.mergeUpdates(updates)}updateScales(timeScaleChanged,priceScaleChanged){this.allStudies.forEach(study=>study.updateScales(timeScaleChanged,priceScaleChanged))}updateBounds(bounds){this.bounds=bounds,this.applyBoundsToScales()}applyBoundsToScales(){for(let study of this.allStudies)study.updateScaleBounds(this.bounds)}getYScale(){return this.primaryStudy.getYScale()}renderTo(compositor,commonScaleManager){for(let study of this.allStudies)study.renderTo(compositor,commonScaleManager,this.bounds)}renderInfrastructureTo(compositor,commonScaleManager){for(let study of this.allStudies)study.renderInfrastructureTo(compositor,commonScaleManager,this.bounds)}mergeUpdates(updates){if(updates.length===0)return null;let result={},xDomains=updates.filter(u$1=>u$1.xDomain!==void 0).map(u$1=>u$1.xDomain);xDomains.length>0&&(result.xDomain={min:Math.min(...xDomains.map(d$1=>d$1.min)),max:Math.max(...xDomains.map(d$1=>d$1.max))});let yDomains=updates.filter(u$1=>u$1.yDomain!==void 0).map(u$1=>u$1.yDomain);return yDomains.length>0&&(result.yDomain={min:Math.min(...yDomains.map(d$1=>d$1.min)),max:Math.max(...yDomains.map(d$1=>d$1.max))}),Object.keys(result).length>0?result:null}generatePriceAxisGridShapes(){return this.priceAxis.generateGridShapes(this.bounds)}generatePriceAxisLineShape(){return this.priceAxis.generateAxisLineShape(this.bounds)}generatePriceAxisLabelShapes(){return this.priceAxis.generateLabelShapes(this.bounds)}},PaneManager=class{constructor(mainPane){this.subPanes=[],this.mainPane=mainPane}addSubPane(subPane){this.subPanes.push(subPane)}getMainPane(){return this.mainPane}getSubPanes(){return this.subPanes}updateLastCandle(allCandles){let scaleUpdates=new Map,mainUpdate=this.collectMainPaneUpdates(study=>study.updateLastCandle(allCandles));return mainUpdate&&scaleUpdates.set(`main`,mainUpdate),this.subPanes.forEach((subPane,index)=>{let update=subPane.updateLastCandle(allCandles);update&&scaleUpdates.set(`subpane-${index}`,update)}),scaleUpdates}appendNewCandle(allCandles){let scaleUpdates=new Map,mainUpdate=this.collectMainPaneUpdates(study=>study.appendNewCandle(allCandles));return mainUpdate&&scaleUpdates.set(`main`,mainUpdate),this.subPanes.forEach((subPane,index)=>{let update=subPane.appendNewCandle(allCandles);update&&scaleUpdates.set(`subpane-${index}`,update)}),scaleUpdates}prependHistoricalCandles(allCandles){let scaleUpdates=new Map,mainUpdate=this.collectMainPaneUpdates(study=>study.prependHistoricalCandles(allCandles));return mainUpdate&&scaleUpdates.set(`main`,mainUpdate),this.subPanes.forEach((subPane,index)=>{let update=subPane.prependHistoricalCandles(allCandles);update&&scaleUpdates.set(`subpane-${index}`,update)}),scaleUpdates}resetCandles(allCandles){let scaleUpdates=new Map,mainUpdate=this.collectMainPaneUpdates(study=>study.resetCandles(allCandles));return mainUpdate&&scaleUpdates.set(`main`,mainUpdate),this.subPanes.forEach((subPane,index)=>{let update=subPane.resetCandles(allCandles);update&&scaleUpdates.set(`subpane-${index}`,update)}),scaleUpdates}updateScales(timeScaleChanged,priceScaleChanged){this.mainPane.allStudies.forEach(study=>study.updateScales(timeScaleChanged,priceScaleChanged)),this.subPanes.forEach(subPane=>subPane.updateScales(timeScaleChanged,priceScaleChanged))}collectMainPaneUpdates(updateFn){let updates=[];return this.mainPane.allStudies.forEach(study=>{let update=updateFn(study);update&&updates.push(update)}),updates.length===0?null:updates.reduce((merged,update)=>this.mergeDomainUpdates(merged,update),updates[0])}mergeDomainUpdates(a$1,b$1){let result={};if(a$1.xDomain||b$1.xDomain){let xMin=Math.min(a$1.xDomain?.min??1/0,b$1.xDomain?.min??1/0),xMax=Math.max(a$1.xDomain?.max??-1/0,b$1.xDomain?.max??-1/0);xMin!==1/0&&xMax!==-1/0&&(result.xDomain={min:xMin,max:xMax})}if(a$1.yDomain||b$1.yDomain){let yMin=Math.min(a$1.yDomain?.min??1/0,b$1.yDomain?.min??1/0),yMax=Math.max(a$1.yDomain?.max??-1/0,b$1.yDomain?.max??-1/0);yMin!==1/0&&yMax!==-1/0&&(result.yDomain={min:yMin,max:yMax})}return result}},OrdinalTimeScale=class{constructor(fullDomain,rangeMin,rangeMax,startIndex=0,endIndex){this.fullDomain=fullDomain,this.rangeMin=rangeMin,this.rangeMax=rangeMax,this.startIndex=startIndex,this.endIndex=endIndex??fullDomain.length-1;let visibleCount=Math.max(1,this.endIndex-this.startIndex+1);this.step=(this.rangeMax-this.rangeMin)/visibleCount}binarySearchTimestamp(domain,target,startIdx,endIdx){let left=startIdx,right=endIdx,targetTime=target.getTime();for(;left<=right;){let mid=Math.floor((left+right)/2),midTime=domain[mid].getTime();if(midTime===targetTime)return mid;midTime<targetTime?left=mid+1:right=mid-1}if(left>=domain.length)return domain.length-1;if(left===0)return 0;let distLeft=Math.abs(domain[left-1].getTime()-targetTime),distRight=Math.abs(domain[left].getTime()-targetTime);return distLeft<=distRight?left-1:left}scaledValue(value){let buffer=2,searchStart=Math.max(0,Math.floor(this.startIndex-2)),searchEnd=Math.min(this.fullDomain.length-1,Math.ceil(this.endIndex+2)),relativeIndex=this.binarySearchTimestamp(this.fullDomain,value,searchStart,searchEnd)-this.startIndex;return this.rangeMin+this.step/2+relativeIndex*this.step}scaledValueFromIndex(index){let relativeIndex=index-this.startIndex;return this.rangeMin+this.step/2+relativeIndex*this.step}invert(pixel){if(this.fullDomain.length===0)throw Error(`Cannot invert on empty domain`);let fullIndex=(pixel-this.rangeMin-this.step/2)/this.step+this.startIndex,index=Math.round(fullIndex),clampedIndex=Math.max(0,Math.min(this.fullDomain.length-1,index));return this.fullDomain[clampedIndex]}boxWidth(){return this.step}updateVisibleDomainIndices(startIndex,endIndex){this.startIndex=Math.max(0,startIndex),this.endIndex=Math.min(this.fullDomain.length-1,endIndex);let visibleCount=Math.max(1,this.endIndex-this.startIndex+1);this.step=(this.rangeMax-this.rangeMin)/visibleCount}updateRange(rangeMin,rangeMax){this.rangeMin=rangeMin,this.rangeMax=rangeMax;let visibleCount=Math.max(1,this.endIndex-this.startIndex+1);this.step=(this.rangeMax-this.rangeMin)/visibleCount}getVisibleDomainIndices(){return{startIndex:this.startIndex,endIndex:this.endIndex}}updateFullDomain(newDomain){this.fullDomain=newDomain,this.endIndex=Math.min(this.endIndex,newDomain.length-1)}getVisibleDomain(){return this.fullDomain.slice(this.startIndex,this.endIndex+1)}getFullDomain(){return this.fullDomain}};function niceNum(localRange,round$3){let exponent=Math.floor(Math.log10(localRange)),fractions=localRange/10**exponent,niceFraction;return niceFraction=round$3?fractions<1.5?1:fractions<3?2:fractions<7?5:10:fractions<=1?1:fractions<=2?2:fractions<=5?5:10,niceFraction*10**exponent}function scaleNice(minVal,maxVal,tickCount){let range=niceNum(maxVal-minVal,!1),tickSpacing=niceNum(range/(tickCount-1),!0),niceMin=Math.floor(minVal/tickSpacing)*tickSpacing,niceMax=Math.ceil(maxVal/tickSpacing)*tickSpacing;return[niceMin,niceMax,tickSpacing]}var NumericScale=class{constructor(domainMin,domainMax,rangeMin,rangeMax,inverted=!1,tickCount=10){let[niceMin,niceMax,tickSpacing]=scaleNice(domainMin,domainMax,tickCount);this.domainMin=niceMin,this.domainMax=niceMax,this.tickCount=tickCount,this.tickSpacing=tickSpacing,this.rangeMin=rangeMin,this.rangeMax=rangeMax,this.inverted=inverted}updateDomain(domainMin,domainMax){let[niceMin,niceMax,tickSpacing]=scaleNice(domainMin,domainMax,this.tickCount);this.domainMin=niceMin,this.domainMax=niceMax,this.tickSpacing=tickSpacing}updateRange(rangeMin,rangeMax){this.rangeMin=rangeMin,this.rangeMax=rangeMax}setInverted(inverted){this.inverted=inverted}scaledValue(value){if(this.domainMax===this.domainMin)return this.rangeMin;let ratio=(value-this.domainMin)/(this.domainMax-this.domainMin);return this.inverted?this.rangeMax-ratio*(this.rangeMax-this.rangeMin):this.rangeMin+ratio*(this.rangeMax-this.rangeMin)}invert(pixel){let rangeSpan=this.rangeMax-this.rangeMin;if(rangeSpan===0)return this.domainMin;let ratio=this.inverted?(this.rangeMax-pixel)/rangeSpan:(pixel-this.rangeMin)/rangeSpan;return this.domainMin+ratio*(this.domainMax-this.domainMin)}getDomain(){return{min:this.domainMin,max:this.domainMax,tickSpacing:this.tickSpacing}}},ScaleManager=class{constructor(xScale,yScale){this.xScale=xScale,this.yScale=yScale}toPixel(x$1,y$1){return{x:this.xScale.scaledValue(x$1),y:this.yScale.scaledValue(y$1)}}fromPixel(pixelX,pixelY){return{x:this.xScale.invert(pixelX),y:this.yScale.invert(pixelY)}}},CommonScaleManager=class{constructor(timeData,canvasWidth,canvasHeight,priceMin,priceMax,initialVisibleStart=0,initialVisibleEnd){this.timeScale=new OrdinalTimeScale(timeData,0,canvasWidth,initialVisibleStart,initialVisibleEnd),this.priceScale=new NumericScale(priceMin,priceMax,0,canvasHeight,!0)}createMainChartScaleManager(){return new ScaleManager(this.timeScale,this.priceScale)}updateTimeScale(startIndex,endIndex){this.timeScale.updateVisibleDomainIndices(startIndex,endIndex)}updatePriceScale(min$2,max$2){this.priceScale.updateDomain(min$2,max$2)}getVisibleDomainIndices(){return this.timeScale.getVisibleDomainIndices()}updateTimeScaleDomain(newTimeData){this.timeScale.updateFullDomain(newTimeData)}updateCanvasDimensions(width,height){this.timeScale.updateRange(0,width),height!==void 0&&this.priceScale.updateRange(0,height)}},TimeSeriesStore=class{constructor(){this.candles=[],this.onChange=null}setOnChange(callback){this.onChange=callback}add(candle){if(this.candles.length===0){this.candles.push(candle),this.notify(`append`);return}this.candles[this.candles.length-1].timestamp.getTime()===candle.timestamp.getTime()?(this.candles[this.candles.length-1]=candle,this.notify(`update`)):(this.candles.push(candle),this.notify(`append`))}prepend(candles){this.candles=[...candles,...this.candles],this.sort(),this.notify(`prepend`)}reset(candles){this.candles=[...candles],this.sort(),this.notify(`reset`)}getAll(){return this.candles}sort(){this.candles.sort((a$1,b$1)=>a$1.timestamp.getTime()-b$1.timestamp.getTime())}notify(changeType){this.onChange&&this.onChange(changeType)}},TimeAxis=class extends Axis$1{constructor(context$1,scale$3,position,tickStep=1,options={},timezoneOffsetMs=198e5){super(context$1,scale$3,position,options),this.timeScale=scale$3,this.timezoneOffsetMs=timezoneOffsetMs}generateTicks(){let domain=this.timeScale.getVisibleDomain();if(domain.length===0)return[];let firstTime=domain[0],lastTime=domain[domain.length-1],spanSeconds=(lastTime.getTime()-firstTime.getTime())/1e3,tzOffsetMs=this.timezoneOffsetMs,targetTicks;targetTicks=domain.length<=5?domain.length:domain.length<=15?Math.ceil(domain.length/2):10;let{level,subdivision}=this.choosePivotLevel(spanSeconds,targetTicks),{startIndex,endIndex}=this.timeScale.getVisibleDomainIndices(),startIndexFloored=Math.floor(startIndex),endIndexFloored=Math.floor(endIndex),tickInterval=Math.max(1,Math.floor(domain.length/targetTicks)),ticks=[],previousYear=null,previousMonth=null,previousDay=null;for(let i$1=0;i$1<domain.length;i$1+=tickInterval){let searchStart=Math.max(0,i$1-Math.floor(tickInterval/2)),searchEnd=Math.min(domain.length-1,i$1+Math.floor(tickInterval/2)),bestIndex=i$1,foundPivot=!1;for(let j$1=searchStart;j$1<=searchEnd;j$1++)if(this.isPivotPoint(domain[j$1],level,subdivision,tzOffsetMs)){bestIndex=j$1,foundPivot=!0;break}if(!foundPivot)for(let j$1=searchStart;j$1<=searchEnd;j$1++){let t$1=domain[j$1],localDate$1=new Date(t$1.getTime()+tzOffsetMs),currentYear$1=localDate$1.getUTCFullYear(),currentMonth$1=localDate$1.getUTCMonth()+1,currentDay$1=localDate$1.getUTCDate();if(previousYear!==null&&currentYear$1!==previousYear||previousMonth!==null&&currentMonth$1!==previousMonth||previousDay!==null&&currentDay$1!==previousDay&&spanSeconds<86400*7){bestIndex=j$1;break}}let timeValue=domain[bestIndex],absoluteIndex=startIndexFloored+bestIndex,pixelPos=this.timeScale.scaledValueFromIndex(absoluteIndex);if(isNaN(pixelPos))continue;let localDate=new Date(timeValue.getTime()+tzOffsetMs),currentYear=localDate.getUTCFullYear(),currentMonth=localDate.getUTCMonth()+1,currentDay=localDate.getUTCDate(),isYearChange=previousYear!==null&&currentYear!==previousYear,isMonthChange=previousMonth!==null&&currentMonth!==previousMonth,isDayChange=previousDay!==null&&currentDay!==previousDay,label;label=level===`year`||isYearChange?this.formatDateTime(timeValue,`year`,tzOffsetMs):level===`month`||isMonthChange?this.formatDateTime(timeValue,`month`,tzOffsetMs):level===`day`||isDayChange?this.formatDateTime(timeValue,`day`,tzOffsetMs):this.formatDateTime(timeValue,`time`,tzOffsetMs),ticks.push({value:timeValue,scaledPosition:pixelPos,label}),previousYear=currentYear,previousMonth=currentMonth,previousDay=currentDay}if(ticks.length===0){let firstPixel=this.timeScale.scaledValueFromIndex(startIndexFloored),lastPixel=this.timeScale.scaledValueFromIndex(endIndexFloored);return[{value:firstTime,scaledPosition:firstPixel,label:this.formatDateTime(firstTime,`full`,tzOffsetMs)},{value:lastTime,scaledPosition:lastPixel,label:this.formatDateTime(lastTime,`full`,tzOffsetMs)}]}let lastDomainTime=domain[domain.length-1];if(ticks[ticks.length-1].value.getTime()!==lastDomainTime.getTime()){let lastPixel=this.timeScale.scaledValueFromIndex(endIndexFloored);isNaN(lastPixel)||ticks.push({value:lastDomainTime,scaledPosition:lastPixel,label:this.formatDateTime(lastDomainTime,spanSeconds>86400?`day`:`time`,tzOffsetMs)})}if(ticks.length<=2)return ticks;let minPixelGap=this.context.config.size.width<=640?72:56,filtered=[ticks[0]];for(let i$1=1;i$1<ticks.length-1;i$1++){let tick=ticks[i$1],lastFiltered$1=filtered[filtered.length-1];Math.abs(tick.scaledPosition-lastFiltered$1.scaledPosition)>=minPixelGap&&filtered.push(tick)}let lastTick=ticks[ticks.length-1],lastFiltered=filtered[filtered.length-1];return Math.abs(lastTick.scaledPosition-lastFiltered.scaledPosition)>=minPixelGap?filtered.push(lastTick):filtered[filtered.length-1]=lastTick,filtered}choosePivotLevel(spanSeconds,targetTicks){let spanMinutes=spanSeconds/60,spanHours=spanMinutes/60,spanDays=spanHours/24,spanMonths=spanDays/30,spanYears=spanDays/365;if(spanYears>3){let ticksPerYear=targetTicks/spanYears;return ticksPerYear<1?{level:`year`,subdivision:Math.max(1,Math.ceil(1/ticksPerYear))}:{level:`month`,subdivision:Math.max(1,Math.ceil(12/ticksPerYear))}}if(spanMonths>2){let ticksPerMonth=targetTicks/spanMonths;if(ticksPerMonth<1)return{level:`month`,subdivision:Math.max(1,Math.ceil(1/ticksPerMonth))};let daysPerTick=30/ticksPerMonth;return daysPerTick>=15?{level:`day`,subdivision:15}:daysPerTick>=10?{level:`day`,subdivision:10}:daysPerTick>=5?{level:`day`,subdivision:5}:daysPerTick>=3?{level:`day`,subdivision:3}:daysPerTick>=2?{level:`day`,subdivision:2}:{level:`day`,subdivision:1}}if(spanDays>1){let hoursPerTick=24/(targetTicks/spanDays);return hoursPerTick>=12?{level:`hour`,subdivision:12}:hoursPerTick>=6?{level:`hour`,subdivision:6}:hoursPerTick>=4?{level:`hour`,subdivision:4}:hoursPerTick>=3?{level:`hour`,subdivision:3}:hoursPerTick>=2?{level:`hour`,subdivision:2}:{level:`hour`,subdivision:1}}if(spanHours>1){let minutesPerTick=60/(targetTicks/spanHours);return minutesPerTick>=30?{level:`minute`,subdivision:30}:minutesPerTick>=20?{level:`minute`,subdivision:20}:minutesPerTick>=15?{level:`minute`,subdivision:15}:minutesPerTick>=10?{level:`minute`,subdivision:10}:minutesPerTick>=5?{level:`minute`,subdivision:5}:{level:`minute`,subdivision:2}}if(spanMinutes>1){let secondsPerTick=60/(targetTicks/spanMinutes);return secondsPerTick>=30?{level:`second`,subdivision:30}:secondsPerTick>=20?{level:`second`,subdivision:20}:secondsPerTick>=15?{level:`second`,subdivision:15}:secondsPerTick>=10?{level:`second`,subdivision:10}:secondsPerTick>=5?{level:`second`,subdivision:5}:{level:`second`,subdivision:2}}return{level:`second`,subdivision:1}}isPivotPoint(time,level,subdivision,tzOffsetMs){let date=new Date(time.getTime()+tzOffsetMs),year=date.getUTCFullYear(),month=date.getUTCMonth()+1,day=date.getUTCDate(),hour=date.getUTCHours(),minute=date.getUTCMinutes(),second=date.getUTCSeconds();switch(level){case`year`:return month===1&&day===1&&year%subdivision===0;case`month`:return day===1&&(month-1)%subdivision==0;case`day`:return(day-1)%subdivision==0;case`hour`:return hour%subdivision===0&&minute<10;case`minute`:return minute%subdivision===0;case`second`:return second%subdivision===0;default:return!1}}formatDateTime(time,type,tzOffsetMs){let date=new Date(time.getTime()+tzOffsetMs),h$2=date.getUTCHours().toString().padStart(2,`0`),m$2=date.getUTCMinutes().toString().padStart(2,`0`),s$1=date.getUTCSeconds().toString().padStart(2,`0`),month=date.getUTCMonth()+1,day=date.getUTCDate(),year=date.getUTCFullYear(),monthNames=[`Jan`,`Feb`,`Mar`,`Apr`,`May`,`Jun`,`Jul`,`Aug`,`Sep`,`Oct`,`Nov`,`Dec`];switch(type){case`full`:return`${month}/${day} ${h$2}:${m$2}`;case`date`:return`${month}/${day}`;case`time`:return date.getUTCSeconds()===0?`${h$2}:${m$2}`:`${h$2}:${m$2}:${s$1}`;case`day`:return`${day}`;case`month`:return monthNames[month-1];case`year`:return`${year}`;default:return`${h$2}:${m$2}`}}updateTickStep(_tickStep){}},RenderBatcher=class{constructor(){this.onRender=null,this.pendingFrameId=null}setOnRender(callback){this.onRender=callback}requestRender(){this.pendingFrameId===null&&(this.pendingFrameId=requestAnimationFrame(()=>{this.pendingFrameId=null,this.onRender&&this.onRender()}))}cancel(){this.pendingFrameId!==null&&(cancelAnimationFrame(this.pendingFrameId),this.pendingFrameId=null)}destroy(){this.cancel(),this.onRender=null}},require_common=__commonJSMin((exports=>{var TYPED_OK=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Int32Array<`u`;function _has(obj,key$1){return Object.prototype.hasOwnProperty.call(obj,key$1)}exports.assign=function(obj){for(var sources$1=Array.prototype.slice.call(arguments,1);sources$1.length;){var source$2=sources$1.shift();if(source$2){if(typeof source$2!=`object`)throw TypeError(source$2+`must be non-object`);for(var p$2 in source$2)_has(source$2,p$2)&&(obj[p$2]=source$2[p$2])}}return obj},exports.shrinkBuf=function(buf,size){return buf.length===size?buf:buf.subarray?buf.subarray(0,size):(buf.length=size,buf)};var fnTyped={arraySet:function(dest,src,src_offs,len$1,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len$1),dest_offs);return}for(var i$1=0;i$1<len$1;i$1++)dest[dest_offs+i$1]=src[src_offs+i$1]},flattenChunks:function(chunks){var i$1,l$1,len$1=0,pos,chunk,result;for(i$1=0,l$1=chunks.length;i$1<l$1;i$1++)len$1+=chunks[i$1].length;for(result=new Uint8Array(len$1),pos=0,i$1=0,l$1=chunks.length;i$1<l$1;i$1++)chunk=chunks[i$1],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len$1,dest_offs){for(var i$1=0;i$1<len$1;i$1++)dest[dest_offs+i$1]=src[src_offs+i$1]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){on?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped))},exports.setTyped(TYPED_OK)})),require_trees=__commonJSMin((exports=>{var utils$6=require_common(),Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(buf){for(var len$1=buf.length;--len$1>=0;)buf[len$1]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES=29,LITERALS=256,L_CODES$1=LITERALS+1+LENGTH_CODES,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=Array(LENGTH_CODES);zero$1(base_length);var base_dist=Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}function d_code(dist$2){return dist$2<256?_dist_code[dist$2]:_dist_code[256+(dist$2>>>7)]}function put_short(s$1,w$1){s$1.pending_buf[s$1.pending++]=w$1&255,s$1.pending_buf[s$1.pending++]=w$1>>>8&255}function send_bits(s$1,value,length$1){s$1.bi_valid>Buf_size-length$1?(s$1.bi_buf|=value<<s$1.bi_valid&65535,put_short(s$1,s$1.bi_buf),s$1.bi_buf=value>>Buf_size-s$1.bi_valid,s$1.bi_valid+=length$1-Buf_size):(s$1.bi_buf|=value<<s$1.bi_valid&65535,s$1.bi_valid+=length$1)}function send_code(s$1,c$2,tree){send_bits(s$1,tree[c$2*2],tree[c$2*2+1])}function bi_reverse(code,len$1){var res=0;do res|=code&1,code>>>=1,res<<=1;while(--len$1>0);return res>>>1}function bi_flush(s$1){s$1.bi_valid===16?(put_short(s$1,s$1.bi_buf),s$1.bi_buf=0,s$1.bi_valid=0):s$1.bi_valid>=8&&(s$1.pending_buf[s$1.pending++]=s$1.bi_buf&255,s$1.bi_buf>>=8,s$1.bi_valid-=8)}function gen_bitlen(s$1,desc){var tree=desc.dyn_tree,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base$1=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length,h$2,n$1,m$2,bits,xbits,f$1,overflow=0;for(bits=0;bits<=MAX_BITS$1;bits++)s$1.bl_count[bits]=0;for(tree[s$1.heap[s$1.heap_max]*2+1]=0,h$2=s$1.heap_max+1;h$2<HEAP_SIZE$1;h$2++)n$1=s$1.heap[h$2],bits=tree[tree[n$1*2+1]*2+1]+1,bits>max_length&&(bits=max_length,overflow++),tree[n$1*2+1]=bits,!(n$1>max_code)&&(s$1.bl_count[bits]++,xbits=0,n$1>=base$1&&(xbits=extra[n$1-base$1]),f$1=tree[n$1*2],s$1.opt_len+=f$1*(bits+xbits),has_stree&&(s$1.static_len+=f$1*(stree[n$1*2+1]+xbits)));if(overflow!==0){do{for(bits=max_length-1;s$1.bl_count[bits]===0;)bits--;s$1.bl_count[bits]--,s$1.bl_count[bits+1]+=2,s$1.bl_count[max_length]--,overflow-=2}while(overflow>0);for(bits=max_length;bits!==0;bits--)for(n$1=s$1.bl_count[bits];n$1!==0;)m$2=s$1.heap[--h$2],!(m$2>max_code)&&(tree[m$2*2+1]!==bits&&(s$1.opt_len+=(bits-tree[m$2*2+1])*tree[m$2*2],tree[m$2*2+1]=bits),n$1--)}}function gen_codes(tree,max_code,bl_count){var next_code=Array(MAX_BITS$1+1),code=0,bits,n$1;for(bits=1;bits<=MAX_BITS$1;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n$1=0;n$1<=max_code;n$1++){var len$1=tree[n$1*2+1];len$1!==0&&(tree[n$1*2]=bi_reverse(next_code[len$1]++,len$1))}}function tr_static_init(){var n$1,bits,length$1,code,dist$2,bl_count=Array(MAX_BITS$1+1);for(length$1=0,code=0;code<LENGTH_CODES-1;code++)for(base_length[code]=length$1,n$1=0;n$1<1<<extra_lbits[code];n$1++)_length_code[length$1++]=code;for(_length_code[length$1-1]=code,dist$2=0,code=0;code<16;code++)for(base_dist[code]=dist$2,n$1=0;n$1<1<<extra_dbits[code];n$1++)_dist_code[dist$2++]=code;for(dist$2>>=7;code<D_CODES$1;code++)for(base_dist[code]=dist$2<<7,n$1=0;n$1<1<<extra_dbits[code]-7;n$1++)_dist_code[256+ dist$2++]=code;for(bits=0;bits<=MAX_BITS$1;bits++)bl_count[bits]=0;for(n$1=0;n$1<=143;)static_ltree[n$1*2+1]=8,n$1++,bl_count[8]++;for(;n$1<=255;)static_ltree[n$1*2+1]=9,n$1++,bl_count[9]++;for(;n$1<=279;)static_ltree[n$1*2+1]=7,n$1++,bl_count[7]++;for(;n$1<=287;)static_ltree[n$1*2+1]=8,n$1++,bl_count[8]++;for(gen_codes(static_ltree,L_CODES$1+1,bl_count),n$1=0;n$1<D_CODES$1;n$1++)static_dtree[n$1*2+1]=5,static_dtree[n$1*2]=bi_reverse(n$1,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc([],extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(s$1){var n$1;for(n$1=0;n$1<L_CODES$1;n$1++)s$1.dyn_ltree[n$1*2]=0;for(n$1=0;n$1<D_CODES$1;n$1++)s$1.dyn_dtree[n$1*2]=0;for(n$1=0;n$1<BL_CODES$1;n$1++)s$1.bl_tree[n$1*2]=0;s$1.dyn_ltree[END_BLOCK*2]=1,s$1.opt_len=s$1.static_len=0,s$1.last_lit=s$1.matches=0}function bi_windup(s$1){s$1.bi_valid>8?put_short(s$1,s$1.bi_buf):s$1.bi_valid>0&&(s$1.pending_buf[s$1.pending++]=s$1.bi_buf),s$1.bi_buf=0,s$1.bi_valid=0}function copy_block(s$1,buf,len$1,header){bi_windup(s$1),header&&(put_short(s$1,len$1),put_short(s$1,~len$1)),utils$6.arraySet(s$1.pending_buf,s$1.window,buf,len$1,s$1.pending),s$1.pending+=len$1}function smaller(tree,n$1,m$2,depth){var _n2=n$1*2,_m2=m$2*2;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n$1]<=depth[m$2]}function pqdownheap(s$1,tree,k$1){for(var v$1=s$1.heap[k$1],j$1=k$1<<1;j$1<=s$1.heap_len&&(j$1<s$1.heap_len&&smaller(tree,s$1.heap[j$1+1],s$1.heap[j$1],s$1.depth)&&j$1++,!smaller(tree,v$1,s$1.heap[j$1],s$1.depth));)s$1.heap[k$1]=s$1.heap[j$1],k$1=j$1,j$1<<=1;s$1.heap[k$1]=v$1}function compress_block(s$1,ltree,dtree){var dist$2,lc,lx=0,code,extra;if(s$1.last_lit!==0)do dist$2=s$1.pending_buf[s$1.d_buf+lx*2]<<8|s$1.pending_buf[s$1.d_buf+lx*2+1],lc=s$1.pending_buf[s$1.l_buf+lx],lx++,dist$2===0?send_code(s$1,lc,ltree):(code=_length_code[lc],send_code(s$1,code+LITERALS+1,ltree),extra=extra_lbits[code],extra!==0&&(lc-=base_length[code],send_bits(s$1,lc,extra)),dist$2--,code=d_code(dist$2),send_code(s$1,code,dtree),extra=extra_dbits[code],extra!==0&&(dist$2-=base_dist[code],send_bits(s$1,dist$2,extra)));while(lx<s$1.last_lit);send_code(s$1,END_BLOCK,ltree)}function build_tree(s$1,desc){var tree=desc.dyn_tree,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems,n$1,m$2,max_code=-1,node;for(s$1.heap_len=0,s$1.heap_max=HEAP_SIZE$1,n$1=0;n$1<elems;n$1++)tree[n$1*2]===0?tree[n$1*2+1]=0:(s$1.heap[++s$1.heap_len]=max_code=n$1,s$1.depth[n$1]=0);for(;s$1.heap_len<2;)node=s$1.heap[++s$1.heap_len]=max_code<2?++max_code:0,tree[node*2]=1,s$1.depth[node]=0,s$1.opt_len--,has_stree&&(s$1.static_len-=stree[node*2+1]);for(desc.max_code=max_code,n$1=s$1.heap_len>>1;n$1>=1;n$1--)pqdownheap(s$1,tree,n$1);node=elems;do n$1=s$1.heap[1],s$1.heap[1]=s$1.heap[s$1.heap_len--],pqdownheap(s$1,tree,1),m$2=s$1.heap[1],s$1.heap[--s$1.heap_max]=n$1,s$1.heap[--s$1.heap_max]=m$2,tree[node*2]=tree[n$1*2]+tree[m$2*2],s$1.depth[node]=(s$1.depth[n$1]>=s$1.depth[m$2]?s$1.depth[n$1]:s$1.depth[m$2])+1,tree[n$1*2+1]=tree[m$2*2+1]=node,s$1.heap[1]=node++,pqdownheap(s$1,tree,1);while(s$1.heap_len>=2);s$1.heap[--s$1.heap_max]=s$1.heap[1],gen_bitlen(s$1,desc),gen_codes(tree,max_code,s$1.bl_count)}function scan_tree(s$1,tree,max_code){var n$1,prevlen=-1,curlen,nextlen=tree[1],count$1=0,max_count=7,min_count=4;for(nextlen===0&&(max_count=138,min_count=3),tree[(max_code+1)*2+1]=65535,n$1=0;n$1<=max_code;n$1++)curlen=nextlen,nextlen=tree[(n$1+1)*2+1],!(++count$1<max_count&&curlen===nextlen)&&(count$1<min_count?s$1.bl_tree[curlen*2]+=count$1:curlen===0?count$1<=10?s$1.bl_tree[REPZ_3_10*2]++:s$1.bl_tree[REPZ_11_138*2]++:(curlen!==prevlen&&s$1.bl_tree[curlen*2]++,s$1.bl_tree[REP_3_6*2]++),count$1=0,prevlen=curlen,nextlen===0?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4))}function send_tree(s$1,tree,max_code){var n$1,prevlen=-1,curlen,nextlen=tree[1],count$1=0,max_count=7,min_count=4;for(nextlen===0&&(max_count=138,min_count=3),n$1=0;n$1<=max_code;n$1++)if(curlen=nextlen,nextlen=tree[(n$1+1)*2+1],!(++count$1<max_count&&curlen===nextlen)){if(count$1<min_count)do send_code(s$1,curlen,s$1.bl_tree);while(--count$1!==0);else curlen===0?count$1<=10?(send_code(s$1,REPZ_3_10,s$1.bl_tree),send_bits(s$1,count$1-3,3)):(send_code(s$1,REPZ_11_138,s$1.bl_tree),send_bits(s$1,count$1-11,7)):(curlen!==prevlen&&(send_code(s$1,curlen,s$1.bl_tree),count$1--),send_code(s$1,REP_3_6,s$1.bl_tree),send_bits(s$1,count$1-3,2));count$1=0,prevlen=curlen,nextlen===0?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4)}}function build_bl_tree(s$1){var max_blindex;for(scan_tree(s$1,s$1.dyn_ltree,s$1.l_desc.max_code),scan_tree(s$1,s$1.dyn_dtree,s$1.d_desc.max_code),build_tree(s$1,s$1.bl_desc),max_blindex=BL_CODES$1-1;max_blindex>=3&&s$1.bl_tree[bl_order[max_blindex]*2+1]===0;max_blindex--);return s$1.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex}function send_all_trees(s$1,lcodes,dcodes,blcodes){var rank$1;for(send_bits(s$1,lcodes-257,5),send_bits(s$1,dcodes-1,5),send_bits(s$1,blcodes-4,4),rank$1=0;rank$1<blcodes;rank$1++)send_bits(s$1,s$1.bl_tree[bl_order[rank$1]*2+1],3);send_tree(s$1,s$1.dyn_ltree,lcodes-1),send_tree(s$1,s$1.dyn_dtree,dcodes-1)}function detect_data_type(s$1){var black_mask=4093624447,n$1;for(n$1=0;n$1<=31;n$1++,black_mask>>>=1)if(black_mask&1&&s$1.dyn_ltree[n$1*2]!==0)return Z_BINARY;if(s$1.dyn_ltree[18]!==0||s$1.dyn_ltree[20]!==0||s$1.dyn_ltree[26]!==0)return Z_TEXT;for(n$1=32;n$1<LITERALS;n$1++)if(s$1.dyn_ltree[n$1*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(s$1){static_init_done||=(tr_static_init(),!0),s$1.l_desc=new TreeDesc(s$1.dyn_ltree,static_l_desc),s$1.d_desc=new TreeDesc(s$1.dyn_dtree,static_d_desc),s$1.bl_desc=new TreeDesc(s$1.bl_tree,static_bl_desc),s$1.bi_buf=0,s$1.bi_valid=0,init_block(s$1)}function _tr_stored_block(s$1,buf,stored_len,last){send_bits(s$1,(STORED_BLOCK<<1)+(last?1:0),3),copy_block(s$1,buf,stored_len,!0)}function _tr_align(s$1){send_bits(s$1,STATIC_TREES<<1,3),send_code(s$1,END_BLOCK,static_ltree),bi_flush(s$1)}function _tr_flush_block(s$1,buf,stored_len,last){var opt_lenb,static_lenb,max_blindex=0;s$1.level>0?(s$1.strm.data_type===Z_UNKNOWN$1&&(s$1.strm.data_type=detect_data_type(s$1)),build_tree(s$1,s$1.l_desc),build_tree(s$1,s$1.d_desc),max_blindex=build_bl_tree(s$1),opt_lenb=s$1.opt_len+3+7>>>3,static_lenb=s$1.static_len+3+7>>>3,static_lenb<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&buf!==-1?_tr_stored_block(s$1,buf,stored_len,last):s$1.strategy===Z_FIXED$1||static_lenb===opt_lenb?(send_bits(s$1,(STATIC_TREES<<1)+(last?1:0),3),compress_block(s$1,static_ltree,static_dtree)):(send_bits(s$1,(DYN_TREES<<1)+(last?1:0),3),send_all_trees(s$1,s$1.l_desc.max_code+1,s$1.d_desc.max_code+1,max_blindex+1),compress_block(s$1,s$1.dyn_ltree,s$1.dyn_dtree)),init_block(s$1),last&&bi_windup(s$1)}function _tr_tally(s$1,dist$2,lc){return s$1.pending_buf[s$1.d_buf+s$1.last_lit*2]=dist$2>>>8&255,s$1.pending_buf[s$1.d_buf+s$1.last_lit*2+1]=dist$2&255,s$1.pending_buf[s$1.l_buf+s$1.last_lit]=lc&255,s$1.last_lit++,dist$2===0?s$1.dyn_ltree[lc*2]++:(s$1.matches++,dist$2--,s$1.dyn_ltree[(_length_code[lc]+LITERALS+1)*2]++,s$1.dyn_dtree[d_code(dist$2)*2]++),s$1.last_lit===s$1.lit_bufsize-1}exports._tr_init=_tr_init,exports._tr_stored_block=_tr_stored_block,exports._tr_flush_block=_tr_flush_block,exports._tr_tally=_tr_tally,exports._tr_align=_tr_align})),require_adler32=__commonJSMin(((exports,module)=>{function adler32$2(adler,buf,len$1,pos){for(var s1=adler&65535|0,s2=adler>>>16&65535|0,n$1=0;len$1!==0;){n$1=len$1>2e3?2e3:len$1,len$1-=n$1;do s1=s1+buf[pos++]|0,s2=s2+s1|0;while(--n$1);s1%=65521,s2%=65521}return s1|s2<<16|0}module.exports=adler32$2})),require_crc32=__commonJSMin(((exports,module)=>{function makeTable(){for(var c$2,table=[],n$1=0;n$1<256;n$1++){c$2=n$1;for(var k$1=0;k$1<8;k$1++)c$2=c$2&1?3988292384^c$2>>>1:c$2>>>1;table[n$1]=c$2}return table}var crcTable=makeTable();function crc32$2(crc,buf,len$1,pos){var t$1=crcTable,end$1=pos+len$1;crc^=-1;for(var i$1=pos;i$1<end$1;i$1++)crc=crc>>>8^t$1[(crc^buf[i$1])&255];return crc^-1}module.exports=crc32$2})),require_messages=__commonJSMin(((exports,module)=>{module.exports={2:`need dictionary`,1:`stream end`,0:``,"-1":`file error`,"-2":`stream error`,"-3":`data error`,"-4":`insufficient memory`,"-5":`buffer error`,"-6":`incompatible version`}})),require_deflate$1=__commonJSMin((exports=>{var utils$5=require_common(),trees=require_trees(),adler32$1=require_adler32(),crc32$1=require_crc32(),msg$2=require_messages(),Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,L_CODES=286,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(strm,errorCode){return strm.msg=msg$2[errorCode],errorCode}function rank(f$1){return(f$1<<1)-(f$1>4?9:0)}function zero(buf){for(var len$1=buf.length;--len$1>=0;)buf[len$1]=0}function flush_pending(strm){var s$1=strm.state,len$1=s$1.pending;len$1>strm.avail_out&&(len$1=strm.avail_out),len$1!==0&&(utils$5.arraySet(strm.output,s$1.pending_buf,s$1.pending_out,len$1,strm.next_out),strm.next_out+=len$1,s$1.pending_out+=len$1,strm.total_out+=len$1,strm.avail_out-=len$1,s$1.pending-=len$1,s$1.pending===0&&(s$1.pending_out=0))}function flush_block_only(s$1,last){trees._tr_flush_block(s$1,s$1.block_start>=0?s$1.block_start:-1,s$1.strstart-s$1.block_start,last),s$1.block_start=s$1.strstart,flush_pending(s$1.strm)}function put_byte(s$1,b$1){s$1.pending_buf[s$1.pending++]=b$1}function putShortMSB(s$1,b$1){s$1.pending_buf[s$1.pending++]=b$1>>>8&255,s$1.pending_buf[s$1.pending++]=b$1&255}function read_buf(strm,buf,start$1,size){var len$1=strm.avail_in;return len$1>size&&(len$1=size),len$1===0?0:(strm.avail_in-=len$1,utils$5.arraySet(buf,strm.input,strm.next_in,len$1,start$1),strm.state.wrap===1?strm.adler=adler32$1(strm.adler,buf,len$1,start$1):strm.state.wrap===2&&(strm.adler=crc32$1(strm.adler,buf,len$1,start$1)),strm.next_in+=len$1,strm.total_in+=len$1,len$1)}function longest_match(s$1,cur_match){var chain_length=s$1.max_chain_length,scan=s$1.strstart,match,len$1,best_len=s$1.prev_length,nice_match=s$1.nice_match,limit=s$1.strstart>s$1.w_size-MIN_LOOKAHEAD?s$1.strstart-(s$1.w_size-MIN_LOOKAHEAD):0,_win=s$1.window,wmask=s$1.w_mask,prev=s$1.prev,strend=s$1.strstart+MAX_MATCH,scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s$1.prev_length>=s$1.good_match&&(chain_length>>=2),nice_match>s$1.lookahead&&(nice_match=s$1.lookahead);do{if(match=cur_match,_win[match+best_len]!==scan_end||_win[match+best_len-1]!==scan_end1||_win[match]!==_win[scan]||_win[++match]!==_win[scan+1])continue;scan+=2,match++;do;while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len$1=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,len$1>best_len){if(s$1.match_start=cur_match,best_len=len$1,len$1>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}while((cur_match=prev[cur_match&wmask])>limit&&--chain_length!==0);return best_len<=s$1.lookahead?best_len:s$1.lookahead}function fill_window(s$1){var _w_size=s$1.w_size,p$2,n$1,m$2,more,str;do{if(more=s$1.window_size-s$1.lookahead-s$1.strstart,s$1.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){utils$5.arraySet(s$1.window,s$1.window,_w_size,_w_size,0),s$1.match_start-=_w_size,s$1.strstart-=_w_size,s$1.block_start-=_w_size,n$1=s$1.hash_size,p$2=n$1;do m$2=s$1.head[--p$2],s$1.head[p$2]=m$2>=_w_size?m$2-_w_size:0;while(--n$1);n$1=_w_size,p$2=n$1;do m$2=s$1.prev[--p$2],s$1.prev[p$2]=m$2>=_w_size?m$2-_w_size:0;while(--n$1);more+=_w_size}if(s$1.strm.avail_in===0)break;if(n$1=read_buf(s$1.strm,s$1.window,s$1.strstart+s$1.lookahead,more),s$1.lookahead+=n$1,s$1.lookahead+s$1.insert>=MIN_MATCH)for(str=s$1.strstart-s$1.insert,s$1.ins_h=s$1.window[str],s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[str+1])&s$1.hash_mask;s$1.insert&&(s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[str+MIN_MATCH-1])&s$1.hash_mask,s$1.prev[str&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=str,str++,s$1.insert--,!(s$1.lookahead+s$1.insert<MIN_MATCH)););}while(s$1.lookahead<MIN_LOOKAHEAD&&s$1.strm.avail_in!==0)}function deflate_stored(s$1,flush){var max_block_size=65535;for(max_block_size>s$1.pending_buf_size-5&&(max_block_size=s$1.pending_buf_size-5);;){if(s$1.lookahead<=1){if(fill_window(s$1),s$1.lookahead===0&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(s$1.lookahead===0)break}s$1.strstart+=s$1.lookahead,s$1.lookahead=0;var max_start=s$1.block_start+max_block_size;if((s$1.strstart===0||s$1.strstart>=max_start)&&(s$1.lookahead=s$1.strstart-max_start,s$1.strstart=max_start,flush_block_only(s$1,!1),s$1.strm.avail_out===0)||s$1.strstart-s$1.block_start>=s$1.w_size-MIN_LOOKAHEAD&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0))return BS_NEED_MORE}return s$1.insert=0,flush===Z_FINISH$2?(flush_block_only(s$1,!0),s$1.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(s$1.strstart>s$1.block_start&&(flush_block_only(s$1,!1),s$1.strm.avail_out),BS_NEED_MORE)}function deflate_fast(s$1,flush){for(var hash_head,bflush;;){if(s$1.lookahead<MIN_LOOKAHEAD){if(fill_window(s$1),s$1.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(s$1.lookahead===0)break}if(hash_head=0,s$1.lookahead>=MIN_MATCH&&(s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[s$1.strstart+MIN_MATCH-1])&s$1.hash_mask,hash_head=s$1.prev[s$1.strstart&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=s$1.strstart),hash_head!==0&&s$1.strstart-hash_head<=s$1.w_size-MIN_LOOKAHEAD&&(s$1.match_length=longest_match(s$1,hash_head)),s$1.match_length>=MIN_MATCH)if(bflush=trees._tr_tally(s$1,s$1.strstart-s$1.match_start,s$1.match_length-MIN_MATCH),s$1.lookahead-=s$1.match_length,s$1.match_length<=s$1.max_lazy_match&&s$1.lookahead>=MIN_MATCH){s$1.match_length--;do s$1.strstart++,s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[s$1.strstart+MIN_MATCH-1])&s$1.hash_mask,hash_head=s$1.prev[s$1.strstart&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=s$1.strstart;while(--s$1.match_length!==0);s$1.strstart++}else s$1.strstart+=s$1.match_length,s$1.match_length=0,s$1.ins_h=s$1.window[s$1.strstart],s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[s$1.strstart+1])&s$1.hash_mask;else bflush=trees._tr_tally(s$1,0,s$1.window[s$1.strstart]),s$1.lookahead--,s$1.strstart++;if(bflush&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0))return BS_NEED_MORE}return s$1.insert=s$1.strstart<MIN_MATCH-1?s$1.strstart:MIN_MATCH-1,flush===Z_FINISH$2?(flush_block_only(s$1,!0),s$1.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s$1.last_lit&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(s$1,flush){for(var hash_head,bflush,max_insert;;){if(s$1.lookahead<MIN_LOOKAHEAD){if(fill_window(s$1),s$1.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(s$1.lookahead===0)break}if(hash_head=0,s$1.lookahead>=MIN_MATCH&&(s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[s$1.strstart+MIN_MATCH-1])&s$1.hash_mask,hash_head=s$1.prev[s$1.strstart&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=s$1.strstart),s$1.prev_length=s$1.match_length,s$1.prev_match=s$1.match_start,s$1.match_length=MIN_MATCH-1,hash_head!==0&&s$1.prev_length<s$1.max_lazy_match&&s$1.strstart-hash_head<=s$1.w_size-MIN_LOOKAHEAD&&(s$1.match_length=longest_match(s$1,hash_head),s$1.match_length<=5&&(s$1.strategy===Z_FILTERED||s$1.match_length===MIN_MATCH&&s$1.strstart-s$1.match_start>4096)&&(s$1.match_length=MIN_MATCH-1)),s$1.prev_length>=MIN_MATCH&&s$1.match_length<=s$1.prev_length){max_insert=s$1.strstart+s$1.lookahead-MIN_MATCH,bflush=trees._tr_tally(s$1,s$1.strstart-1-s$1.prev_match,s$1.prev_length-MIN_MATCH),s$1.lookahead-=s$1.prev_length-1,s$1.prev_length-=2;do++s$1.strstart<=max_insert&&(s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[s$1.strstart+MIN_MATCH-1])&s$1.hash_mask,hash_head=s$1.prev[s$1.strstart&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=s$1.strstart);while(--s$1.prev_length!==0);if(s$1.match_available=0,s$1.match_length=MIN_MATCH-1,s$1.strstart++,bflush&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0))return BS_NEED_MORE}else if(s$1.match_available){if(bflush=trees._tr_tally(s$1,0,s$1.window[s$1.strstart-1]),bflush&&flush_block_only(s$1,!1),s$1.strstart++,s$1.lookahead--,s$1.strm.avail_out===0)return BS_NEED_MORE}else s$1.match_available=1,s$1.strstart++,s$1.lookahead--}return s$1.match_available&&=(bflush=trees._tr_tally(s$1,0,s$1.window[s$1.strstart-1]),0),s$1.insert=s$1.strstart<MIN_MATCH-1?s$1.strstart:MIN_MATCH-1,flush===Z_FINISH$2?(flush_block_only(s$1,!0),s$1.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s$1.last_lit&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(s$1,flush){for(var bflush,prev,scan,strend,_win=s$1.window;;){if(s$1.lookahead<=MAX_MATCH){if(fill_window(s$1),s$1.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(s$1.lookahead===0)break}if(s$1.match_length=0,s$1.lookahead>=MIN_MATCH&&s$1.strstart>0&&(scan=s$1.strstart-1,prev=_win[scan],prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan])){strend=s$1.strstart+MAX_MATCH;do;while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s$1.match_length=MAX_MATCH-(strend-scan),s$1.match_length>s$1.lookahead&&(s$1.match_length=s$1.lookahead)}if(s$1.match_length>=MIN_MATCH?(bflush=trees._tr_tally(s$1,1,s$1.match_length-MIN_MATCH),s$1.lookahead-=s$1.match_length,s$1.strstart+=s$1.match_length,s$1.match_length=0):(bflush=trees._tr_tally(s$1,0,s$1.window[s$1.strstart]),s$1.lookahead--,s$1.strstart++),bflush&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0))return BS_NEED_MORE}return s$1.insert=0,flush===Z_FINISH$2?(flush_block_only(s$1,!0),s$1.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s$1.last_lit&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(s$1,flush){for(var bflush;;){if(s$1.lookahead===0&&(fill_window(s$1),s$1.lookahead===0)){if(flush===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(s$1.match_length=0,bflush=trees._tr_tally(s$1,0,s$1.window[s$1.strstart]),s$1.lookahead--,s$1.strstart++,bflush&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0))return BS_NEED_MORE}return s$1.insert=0,flush===Z_FINISH$2?(flush_block_only(s$1,!0),s$1.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s$1.last_lit&&(flush_block_only(s$1,!1),s$1.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}var configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(s$1){s$1.window_size=2*s$1.w_size,zero(s$1.head),s$1.max_lazy_match=configuration_table[s$1.level].max_lazy,s$1.good_match=configuration_table[s$1.level].good_length,s$1.nice_match=configuration_table[s$1.level].nice_length,s$1.max_chain_length=configuration_table[s$1.level].max_chain,s$1.strstart=0,s$1.block_start=0,s$1.lookahead=0,s$1.insert=0,s$1.match_length=s$1.prev_length=MIN_MATCH-1,s$1.match_available=0,s$1.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$5.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$5.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$5.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$5.Buf16(MAX_BITS+1),this.heap=new utils$5.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$5.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(strm){var s$1;return!strm||!strm.state?err(strm,Z_STREAM_ERROR$1):(strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN,s$1=strm.state,s$1.pending=0,s$1.pending_out=0,s$1.wrap<0&&(s$1.wrap=-s$1.wrap),s$1.status=s$1.wrap?INIT_STATE:BUSY_STATE,strm.adler=s$1.wrap===2?0:1,s$1.last_flush=Z_NO_FLUSH$1,trees._tr_init(s$1),Z_OK$2)}function deflateReset(strm){var ret=deflateResetKeep(strm);return ret===Z_OK$2&&lm_init(strm.state),ret}function deflateSetHeader(strm,head){return!strm||!strm.state||strm.state.wrap!==2?Z_STREAM_ERROR$1:(strm.state.gzhead=head,Z_OK$2)}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR$1;var wrap=1;if(level===Z_DEFAULT_COMPRESSION$1&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):windowBits>15&&(wrap=2,windowBits-=16),memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED$2||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR$1);windowBits===8&&(windowBits=9);var s$1=new DeflateState;return strm.state=s$1,s$1.strm=strm,s$1.wrap=wrap,s$1.gzhead=null,s$1.w_bits=windowBits,s$1.w_size=1<<s$1.w_bits,s$1.w_mask=s$1.w_size-1,s$1.hash_bits=memLevel+7,s$1.hash_size=1<<s$1.hash_bits,s$1.hash_mask=s$1.hash_size-1,s$1.hash_shift=~~((s$1.hash_bits+MIN_MATCH-1)/MIN_MATCH),s$1.window=new utils$5.Buf8(s$1.w_size*2),s$1.head=new utils$5.Buf16(s$1.hash_size),s$1.prev=new utils$5.Buf16(s$1.w_size),s$1.lit_bufsize=1<<memLevel+6,s$1.pending_buf_size=s$1.lit_bufsize*4,s$1.pending_buf=new utils$5.Buf8(s$1.pending_buf_size),s$1.d_buf=1*s$1.lit_bufsize,s$1.l_buf=3*s$1.lit_bufsize,s$1.level=level,s$1.strategy=strategy,s$1.method=method,deflateReset(strm)}function deflateInit(strm,level){return deflateInit2(strm,level,Z_DEFLATED$2,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(strm,flush){var old_flush,s$1,beg,val;if(!strm||!strm.state||flush>Z_BLOCK$1||flush<0)return strm?err(strm,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(s$1=strm.state,!strm.output||!strm.input&&strm.avail_in!==0||s$1.status===FINISH_STATE&&flush!==Z_FINISH$2)return err(strm,strm.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(s$1.strm=strm,old_flush=s$1.last_flush,s$1.last_flush=flush,s$1.status===INIT_STATE)if(s$1.wrap===2)strm.adler=0,put_byte(s$1,31),put_byte(s$1,139),put_byte(s$1,8),s$1.gzhead?(put_byte(s$1,(s$1.gzhead.text?1:0)+(s$1.gzhead.hcrc?2:0)+(s$1.gzhead.extra?4:0)+(s$1.gzhead.name?8:0)+(s$1.gzhead.comment?16:0)),put_byte(s$1,s$1.gzhead.time&255),put_byte(s$1,s$1.gzhead.time>>8&255),put_byte(s$1,s$1.gzhead.time>>16&255),put_byte(s$1,s$1.gzhead.time>>24&255),put_byte(s$1,s$1.level===9?2:s$1.strategy>=Z_HUFFMAN_ONLY||s$1.level<2?4:0),put_byte(s$1,s$1.gzhead.os&255),s$1.gzhead.extra&&s$1.gzhead.extra.length&&(put_byte(s$1,s$1.gzhead.extra.length&255),put_byte(s$1,s$1.gzhead.extra.length>>8&255)),s$1.gzhead.hcrc&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending,0)),s$1.gzindex=0,s$1.status=EXTRA_STATE):(put_byte(s$1,0),put_byte(s$1,0),put_byte(s$1,0),put_byte(s$1,0),put_byte(s$1,0),put_byte(s$1,s$1.level===9?2:s$1.strategy>=Z_HUFFMAN_ONLY||s$1.level<2?4:0),put_byte(s$1,OS_CODE),s$1.status=BUSY_STATE);else{var header=Z_DEFLATED$2+(s$1.w_bits-8<<4)<<8,level_flags=-1;level_flags=s$1.strategy>=Z_HUFFMAN_ONLY||s$1.level<2?0:s$1.level<6?1:s$1.level===6?2:3,header|=level_flags<<6,s$1.strstart!==0&&(header|=PRESET_DICT),header+=31-header%31,s$1.status=BUSY_STATE,putShortMSB(s$1,header),s$1.strstart!==0&&(putShortMSB(s$1,strm.adler>>>16),putShortMSB(s$1,strm.adler&65535)),strm.adler=1}if(s$1.status===EXTRA_STATE)if(s$1.gzhead.extra){for(beg=s$1.pending;s$1.gzindex<(s$1.gzhead.extra.length&65535)&&!(s$1.pending===s$1.pending_buf_size&&(s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),flush_pending(strm),beg=s$1.pending,s$1.pending===s$1.pending_buf_size));)put_byte(s$1,s$1.gzhead.extra[s$1.gzindex]&255),s$1.gzindex++;s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),s$1.gzindex===s$1.gzhead.extra.length&&(s$1.gzindex=0,s$1.status=NAME_STATE)}else s$1.status=NAME_STATE;if(s$1.status===NAME_STATE)if(s$1.gzhead.name){beg=s$1.pending;do{if(s$1.pending===s$1.pending_buf_size&&(s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),flush_pending(strm),beg=s$1.pending,s$1.pending===s$1.pending_buf_size)){val=1;break}val=s$1.gzindex<s$1.gzhead.name.length?s$1.gzhead.name.charCodeAt(s$1.gzindex++)&255:0,put_byte(s$1,val)}while(val!==0);s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),val===0&&(s$1.gzindex=0,s$1.status=COMMENT_STATE)}else s$1.status=COMMENT_STATE;if(s$1.status===COMMENT_STATE)if(s$1.gzhead.comment){beg=s$1.pending;do{if(s$1.pending===s$1.pending_buf_size&&(s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),flush_pending(strm),beg=s$1.pending,s$1.pending===s$1.pending_buf_size)){val=1;break}val=s$1.gzindex<s$1.gzhead.comment.length?s$1.gzhead.comment.charCodeAt(s$1.gzindex++)&255:0,put_byte(s$1,val)}while(val!==0);s$1.gzhead.hcrc&&s$1.pending>beg&&(strm.adler=crc32$1(strm.adler,s$1.pending_buf,s$1.pending-beg,beg)),val===0&&(s$1.status=HCRC_STATE)}else s$1.status=HCRC_STATE;if(s$1.status===HCRC_STATE&&(s$1.gzhead.hcrc?(s$1.pending+2>s$1.pending_buf_size&&flush_pending(strm),s$1.pending+2<=s$1.pending_buf_size&&(put_byte(s$1,strm.adler&255),put_byte(s$1,strm.adler>>8&255),strm.adler=0,s$1.status=BUSY_STATE)):s$1.status=BUSY_STATE),s$1.pending!==0){if(flush_pending(strm),strm.avail_out===0)return s$1.last_flush=-1,Z_OK$2}else if(strm.avail_in===0&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH$2)return err(strm,Z_BUF_ERROR$1);if(s$1.status===FINISH_STATE&&strm.avail_in!==0)return err(strm,Z_BUF_ERROR$1);if(strm.avail_in!==0||s$1.lookahead!==0||flush!==Z_NO_FLUSH$1&&s$1.status!==FINISH_STATE){var bstate=s$1.strategy===Z_HUFFMAN_ONLY?deflate_huff(s$1,flush):s$1.strategy===Z_RLE?deflate_rle(s$1,flush):configuration_table[s$1.level].func(s$1,flush);if((bstate===BS_FINISH_STARTED||bstate===BS_FINISH_DONE)&&(s$1.status=FINISH_STATE),bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED)return strm.avail_out===0&&(s$1.last_flush=-1),Z_OK$2;if(bstate===BS_BLOCK_DONE&&(flush===Z_PARTIAL_FLUSH?trees._tr_align(s$1):flush!==Z_BLOCK$1&&(trees._tr_stored_block(s$1,0,0,!1),flush===Z_FULL_FLUSH&&(zero(s$1.head),s$1.lookahead===0&&(s$1.strstart=0,s$1.block_start=0,s$1.insert=0))),flush_pending(strm),strm.avail_out===0))return s$1.last_flush=-1,Z_OK$2}return flush===Z_FINISH$2?s$1.wrap<=0?Z_STREAM_END$2:(s$1.wrap===2?(put_byte(s$1,strm.adler&255),put_byte(s$1,strm.adler>>8&255),put_byte(s$1,strm.adler>>16&255),put_byte(s$1,strm.adler>>24&255),put_byte(s$1,strm.total_in&255),put_byte(s$1,strm.total_in>>8&255),put_byte(s$1,strm.total_in>>16&255),put_byte(s$1,strm.total_in>>24&255)):(putShortMSB(s$1,strm.adler>>>16),putShortMSB(s$1,strm.adler&65535)),flush_pending(strm),s$1.wrap>0&&(s$1.wrap=-s$1.wrap),s$1.pending===0?Z_STREAM_END$2:Z_OK$2):Z_OK$2}function deflateEnd(strm){var status;return!strm||!strm.state?Z_STREAM_ERROR$1:(status=strm.state.status,status!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE?err(strm,Z_STREAM_ERROR$1):(strm.state=null,status===BUSY_STATE?err(strm,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(strm,dictionary){var dictLength=dictionary.length,s$1,str,n$1,wrap,avail,next,input,tmpDict;if(!strm||!strm.state||(s$1=strm.state,wrap=s$1.wrap,wrap===2||wrap===1&&s$1.status!==INIT_STATE||s$1.lookahead))return Z_STREAM_ERROR$1;for(wrap===1&&(strm.adler=adler32$1(strm.adler,dictionary,dictLength,0)),s$1.wrap=0,dictLength>=s$1.w_size&&(wrap===0&&(zero(s$1.head),s$1.strstart=0,s$1.block_start=0,s$1.insert=0),tmpDict=new utils$5.Buf8(s$1.w_size),utils$5.arraySet(tmpDict,dictionary,dictLength-s$1.w_size,s$1.w_size,0),dictionary=tmpDict,dictLength=s$1.w_size),avail=strm.avail_in,next=strm.next_in,input=strm.input,strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s$1);s$1.lookahead>=MIN_MATCH;){str=s$1.strstart,n$1=s$1.lookahead-(MIN_MATCH-1);do s$1.ins_h=(s$1.ins_h<<s$1.hash_shift^s$1.window[str+MIN_MATCH-1])&s$1.hash_mask,s$1.prev[str&s$1.w_mask]=s$1.head[s$1.ins_h],s$1.head[s$1.ins_h]=str,str++;while(--n$1);s$1.strstart=str,s$1.lookahead=MIN_MATCH-1,fill_window(s$1)}return s$1.strstart+=s$1.lookahead,s$1.block_start=s$1.strstart,s$1.insert=s$1.lookahead,s$1.lookahead=0,s$1.match_length=s$1.prev_length=MIN_MATCH-1,s$1.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s$1.wrap=wrap,Z_OK$2}exports.deflateInit=deflateInit,exports.deflateInit2=deflateInit2,exports.deflateReset=deflateReset,exports.deflateResetKeep=deflateResetKeep,exports.deflateSetHeader=deflateSetHeader,exports.deflate=deflate$2,exports.deflateEnd=deflateEnd,exports.deflateSetDictionary=deflateSetDictionary,exports.deflateInfo=`pako deflate (from Nodeca project)`})),require_strings=__commonJSMin((exports=>{var utils$4=require_common(),STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch{STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$4.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,exports.string2buf=function(str){var buf,c$2,c2,m_pos,i$1,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)c$2=str.charCodeAt(m_pos),(c$2&64512)==55296&&m_pos+1<str_len&&(c2=str.charCodeAt(m_pos+1),(c2&64512)==56320&&(c$2=65536+(c$2-55296<<10)+(c2-56320),m_pos++)),buf_len+=c$2<128?1:c$2<2048?2:c$2<65536?3:4;for(buf=new utils$4.Buf8(buf_len),i$1=0,m_pos=0;i$1<buf_len;m_pos++)c$2=str.charCodeAt(m_pos),(c$2&64512)==55296&&m_pos+1<str_len&&(c2=str.charCodeAt(m_pos+1),(c2&64512)==56320&&(c$2=65536+(c$2-55296<<10)+(c2-56320),m_pos++)),c$2<128?buf[i$1++]=c$2:c$2<2048?(buf[i$1++]=192|c$2>>>6,buf[i$1++]=128|c$2&63):c$2<65536?(buf[i$1++]=224|c$2>>>12,buf[i$1++]=128|c$2>>>6&63,buf[i$1++]=128|c$2&63):(buf[i$1++]=240|c$2>>>18,buf[i$1++]=128|c$2>>>12&63,buf[i$1++]=128|c$2>>>6&63,buf[i$1++]=128|c$2&63);return buf};function buf2binstring(buf,len$1){if(len$1<65534&&(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$4.shrinkBuf(buf,len$1));for(var result=``,i$1=0;i$1<len$1;i$1++)result+=String.fromCharCode(buf[i$1]);return result}exports.buf2binstring=function(buf){return buf2binstring(buf,buf.length)},exports.binstring2buf=function(str){for(var buf=new utils$4.Buf8(str.length),i$1=0,len$1=buf.length;i$1<len$1;i$1++)buf[i$1]=str.charCodeAt(i$1);return buf},exports.buf2string=function(buf,max$2){var i$1,out$2,c$2,c_len,len$1=max$2||buf.length,utf16buf=Array(len$1*2);for(out$2=0,i$1=0;i$1<len$1;){if(c$2=buf[i$1++],c$2<128){utf16buf[out$2++]=c$2;continue}if(c_len=_utf8len[c$2],c_len>4){utf16buf[out$2++]=65533,i$1+=c_len-1;continue}for(c$2&=c_len===2?31:c_len===3?15:7;c_len>1&&i$1<len$1;)c$2=c$2<<6|buf[i$1++]&63,c_len--;if(c_len>1){utf16buf[out$2++]=65533;continue}c$2<65536?utf16buf[out$2++]=c$2:(c$2-=65536,utf16buf[out$2++]=55296|c$2>>10&1023,utf16buf[out$2++]=56320|c$2&1023)}return buf2binstring(utf16buf,out$2)},exports.utf8border=function(buf,max$2){var pos;for(max$2||=buf.length,max$2>buf.length&&(max$2=buf.length),pos=max$2-1;pos>=0&&(buf[pos]&192)==128;)pos--;return pos<0||pos===0?max$2:pos+_utf8len[buf[pos]]>max$2?pos:max$2}})),require_zstream=__commonJSMin(((exports,module)=>{function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=``,this.state=null,this.data_type=2,this.adler=0}module.exports=ZStream$2})),require_deflate=__commonJSMin((exports=>{var zlib_deflate=require_deflate$1(),utils$3=require_common(),strings$1=require_strings(),msg$1=require_messages(),ZStream$1=require_zstream(),toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(options){if(!(this instanceof Deflate))return new Deflate(options);this.options=utils$3.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:``},options||{});var opt=this.options;opt.raw&&opt.windowBits>0?opt.windowBits=-opt.windowBits:opt.gzip&&opt.windowBits>0&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var status=zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK$1)throw Error(msg$1[status]);if(opt.header&&zlib_deflate.deflateSetHeader(this.strm,opt.header),opt.dictionary){var dict=typeof opt.dictionary==`string`?strings$1.string2buf(opt.dictionary):toString$1.call(opt.dictionary)===`[object ArrayBuffer]`?new Uint8Array(opt.dictionary):opt.dictionary;if(status=zlib_deflate.deflateSetDictionary(this.strm,dict),status!==Z_OK$1)throw Error(msg$1[status]);this._dict_set=!0}}Deflate.prototype.push=function(data,mode){var strm=this.strm,chunkSize=this.options.chunkSize,status,_mode;if(this.ended)return!1;_mode=mode===~~mode?mode:mode===!0?Z_FINISH$1:Z_NO_FLUSH,typeof data==`string`?strm.input=strings$1.string2buf(data):toString$1.call(data)===`[object ArrayBuffer]`?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(strm.avail_out===0&&(strm.output=new utils$3.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),status=zlib_deflate.deflate(strm,_mode),status!==Z_STREAM_END$1&&status!==Z_OK$1)return this.onEnd(status),this.ended=!0,!1;(strm.avail_out===0||strm.avail_in===0&&(_mode===Z_FINISH$1||_mode===Z_SYNC_FLUSH))&&(this.options.to===`string`?this.onData(strings$1.buf2binstring(utils$3.shrinkBuf(strm.output,strm.next_out))):this.onData(utils$3.shrinkBuf(strm.output,strm.next_out)))}while((strm.avail_in>0||strm.avail_out===0)&&status!==Z_STREAM_END$1);return _mode===Z_FINISH$1?(status=zlib_deflate.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK$1):_mode===Z_SYNC_FLUSH?(this.onEnd(Z_OK$1),strm.avail_out=0,!0):!0},Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate.prototype.onEnd=function(status){status===Z_OK$1&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=utils$3.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};function deflate$1(input,options){var deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||msg$1[deflator.err];return deflator.result}function deflateRaw(input,options){return options||={},options.raw=!0,deflate$1(input,options)}function gzip(input,options){return options||={},options.gzip=!0,deflate$1(input,options)}exports.Deflate=Deflate,exports.deflate=deflate$1,exports.deflateRaw=deflateRaw,exports.gzip=gzip})),require_inffast=__commonJSMin(((exports,module)=>{var BAD$1=30,TYPE$1=12;module.exports=function(strm,start$1){var state=strm.state,_in=strm.next_in,last,_out,beg,end$1,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len$1,dist$2,from,from_source,input=strm.input,output;last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start$1-strm.avail_out),end$1=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op===0)output[_out++]=here&65535;else if(op&16){len$1=here&65535,op&=15,op&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len$1+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op&16){if(dist$2=here&65535,op&=15,bits<op&&(hold+=input[_in++]<<bits,bits+=8,bits<op&&(hold+=input[_in++]<<bits,bits+=8)),dist$2+=hold&(1<<op)-1,dist$2>dmax){strm.msg=`invalid distance too far back`,state.mode=BAD$1;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist$2>op){if(op=dist$2-op,op>whave&&state.sane){strm.msg=`invalid distance too far back`,state.mode=BAD$1;break top}if(from=0,from_source=s_window,wnext===0){if(from+=wsize-op,op<len$1){len$1-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist$2,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,op-=wnext,op<len$1){len$1-=op;do output[_out++]=s_window[from++];while(--op);if(from=0,wnext<len$1){op=wnext,len$1-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist$2,from_source=output}}}else if(from+=wnext-op,op<len$1){len$1-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist$2,from_source=output}for(;len$1>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len$1-=3;len$1&&(output[_out++]=from_source[from++],len$1>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist$2;do output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len$1-=3;while(len$1>2);len$1&&(output[_out++]=output[from++],len$1>1&&(output[_out++]=output[from++]))}}else if(op&64){strm.msg=`invalid distance code`,state.mode=BAD$1;break top}else{here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}break}}else if(op&64)if(op&32){state.mode=TYPE$1;break top}else{strm.msg=`invalid literal/length code`,state.mode=BAD$1;break top}else{here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}break}}while(_in<last&&_out<end$1);len$1=bits>>3,_in-=len$1,bits-=len$1<<3,hold&=(1<<bits)-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?5+(last-_in):5-(_in-last),strm.avail_out=_out<end$1?257+(end$1-_out):257-(_out-end$1),state.hold=hold,state.bits=bits}})),require_inftrees=__commonJSMin(((exports,module)=>{var utils$2=require_common(),MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(type,lens,lens_index,codes,table,table_index,work,opts){var bits=opts.bits,len$1=0,sym=0,min$2=0,max$2=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,incr,fill,low,mask,next,base$1=null,base_index=0,end$1,count$1=new utils$2.Buf16(MAXBITS+1),offs=new utils$2.Buf16(MAXBITS+1),extra=null,extra_index=0,here_bits,here_op,here_val;for(len$1=0;len$1<=MAXBITS;len$1++)count$1[len$1]=0;for(sym=0;sym<codes;sym++)count$1[lens[lens_index+sym]]++;for(root=bits,max$2=MAXBITS;max$2>=1&&count$1[max$2]===0;max$2--);if(root>max$2&&(root=max$2),max$2===0)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min$2=1;min$2<max$2&&count$1[min$2]===0;min$2++);for(root<min$2&&(root=min$2),left=1,len$1=1;len$1<=MAXBITS;len$1++)if(left<<=1,left-=count$1[len$1],left<0)return-1;if(left>0&&(type===CODES$1||max$2!==1))return-1;for(offs[1]=0,len$1=1;len$1<MAXBITS;len$1++)offs[len$1+1]=offs[len$1]+count$1[len$1];for(sym=0;sym<codes;sym++)lens[lens_index+sym]!==0&&(work[offs[lens[lens_index+sym]]++]=sym);if(type===CODES$1?(base$1=extra=work,end$1=19):type===LENS$1?(base$1=lbase,base_index-=257,extra=lext,extra_index-=257,end$1=256):(base$1=dbase,extra=dext,end$1=-1),huff=0,sym=0,len$1=min$2,next=table_index,curr=root,drop=0,low=-1,used=1<<root,mask=used-1,type===LENS$1&&used>ENOUGH_LENS$1||type===DISTS$1&&used>ENOUGH_DISTS$1)return 1;for(;;){here_bits=len$1-drop,work[sym]<end$1?(here_op=0,here_val=work[sym]):work[sym]>end$1?(here_op=extra[extra_index+work[sym]],here_val=base$1[base_index+work[sym]]):(here_op=96,here_val=0),incr=1<<len$1-drop,fill=1<<curr,min$2=fill;do fill-=incr,table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0;while(fill!==0);for(incr=1<<len$1-1;huff&incr;)incr>>=1;if(incr===0?huff=0:(huff&=incr-1,huff+=incr),sym++,--count$1[len$1]===0){if(len$1===max$2)break;len$1=lens[lens_index+work[sym]]}if(len$1>root&&(huff&mask)!==low){for(drop===0&&(drop=root),next+=min$2,curr=len$1-drop,left=1<<curr;curr+drop<max$2&&(left-=count$1[curr+drop],!(left<=0));)curr++,left<<=1;if(used+=1<<curr,type===LENS$1&&used>ENOUGH_LENS$1||type===DISTS$1&&used>ENOUGH_DISTS$1)return 1;low=huff&mask,table[low]=root<<24|curr<<16|next-table_index|0}}return huff!==0&&(table[next+huff]=len$1-drop<<24|4194304),opts.bits=root,0}})),require_inflate$1=__commonJSMin((exports=>{var utils$1=require_common(),adler32=require_adler32(),crc32=require_crc32(),inflate_fast=require_inffast(),inflate_table=require_inftrees(),CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,DEF_WBITS=15;function zswap32(q$1){return(q$1>>>24&255)+(q$1>>>8&65280)+((q$1&65280)<<8)+((q$1&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$1.Buf16(320),this.work=new utils$1.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(strm){var state;return!strm||!strm.state?Z_STREAM_ERROR:(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg=``,state.wrap&&(strm.adler=state.wrap&1),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new utils$1.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new utils$1.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK)}function inflateReset(strm){var state;return!strm||!strm.state?Z_STREAM_ERROR:(state=strm.state,state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm))}function inflateReset2(strm,windowBits){var wrap,state;return!strm||!strm.state||(state=strm.state,windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=(windowBits>>4)+1,windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15))?Z_STREAM_ERROR:(state.window!==null&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))}function inflateInit2(strm,windowBits){var ret,state;return strm?(state=new InflateState,strm.state=state,state.window=null,ret=inflateReset2(strm,windowBits),ret!==Z_OK&&(strm.state=null),ret):Z_STREAM_ERROR}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(state){if(virgin){var sym;for(lenfix=new utils$1.Buf32(512),distfix=new utils$1.Buf32(32),sym=0;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end$1,copy$1){var dist$2,state=strm.state;return state.window===null&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new utils$1.Buf8(state.wsize)),copy$1>=state.wsize?(utils$1.arraySet(state.window,src,end$1-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize):(dist$2=state.wsize-state.wnext,dist$2>copy$1&&(dist$2=copy$1),utils$1.arraySet(state.window,src,end$1-copy$1,dist$2,state.wnext),copy$1-=dist$2,copy$1?(utils$1.arraySet(state.window,src,end$1-copy$1,copy$1,0),state.wnext=copy$1,state.whave=state.wsize):(state.wnext+=dist$2,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist$2))),0}function inflate$2(strm,flush){var state,input,output,next,put,have,left,hold,bits,_in,_out,copy$1,from,from_source,here=0,here_bits,here_op,here_val,last_bits,last_op,last_val,len$1,ret,hbuf=new utils$1.Buf8(4),opts,n$1,order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0)return Z_STREAM_ERROR;state=strm.state,state.mode===TYPE&&(state.mode=TYPEDO),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(state.wrap===0){state.mode=TYPEDO;break}for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.wrap&2&&hold===35615){state.check=0,hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.flags=0,state.head&&(state.head.done=!1),!(state.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg=`incorrect header check`,state.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg=`unknown compression method`,state.mode=BAD;break}if(hold>>>=4,bits-=4,len$1=(hold&15)+8,state.wbits===0)state.wbits=len$1;else if(len$1>state.wbits){strm.msg=`invalid window size`,state.mode=BAD;break}state.dmax=1<<len$1,strm.adler=state.check=1,state.mode=hold&512?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(state.flags&255)!==Z_DEFLATED){strm.msg=`unknown compression method`,state.mode=BAD;break}if(state.flags&57344){strm.msg=`unknown header flags set`,state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),state.flags&512&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=TIME;case TIME:for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),state.flags&512&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=OS;case OS:for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=hold&255,state.head.os=hold>>8),state.flags&512&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(state.flags&1024){for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),state.flags&512&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=EXTRA;case EXTRA:if(state.flags&1024&&(copy$1=state.length,copy$1>have&&(copy$1=have),copy$1&&(state.head&&(len$1=state.head.extra_len-state.length,state.head.extra||(state.head.extra=Array(state.head.extra_len)),utils$1.arraySet(state.head.extra,input,next,copy$1,len$1)),state.flags&512&&(state.check=crc32(state.check,input,copy$1,next)),have-=copy$1,next+=copy$1,state.length-=copy$1),state.length))break inf_leave;state.length=0,state.mode=NAME;case NAME:if(state.flags&2048){if(have===0)break inf_leave;copy$1=0;do len$1=input[next+ copy$1++],state.head&&len$1&&state.length<65536&&(state.head.name+=String.fromCharCode(len$1));while(len$1&&copy$1<have);if(state.flags&512&&(state.check=crc32(state.check,input,copy$1,next)),have-=copy$1,next+=copy$1,len$1)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=COMMENT;case COMMENT:if(state.flags&4096){if(have===0)break inf_leave;copy$1=0;do len$1=input[next+ copy$1++],state.head&&len$1&&state.length<65536&&(state.head.comment+=String.fromCharCode(len$1));while(len$1&&copy$1<have);if(state.flags&512&&(state.check=crc32(state.check,input,copy$1,next)),have-=copy$1,next+=copy$1,len$1)break inf_leave}else state.head&&(state.head.comment=null);state.mode=HCRC;case HCRC:if(state.flags&512){for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(state.check&65535)){strm.msg=`header crc mismatch`,state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(state.havedict===0)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=bits&7,bits-=bits&7,state.mode=CHECK;break}for(;bits<3;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=hold&1,hold>>>=1,--bits,hold&3){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg=`invalid block type`,state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:for(hold>>>=bits&7,bits-=bits&7;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((hold&65535)!=(hold>>>16^65535)){strm.msg=`invalid stored block lengths`,state.mode=BAD;break}if(state.length=hold&65535,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy$1=state.length,copy$1){if(copy$1>have&&(copy$1=have),copy$1>left&&(copy$1=left),copy$1===0)break inf_leave;utils$1.arraySet(output,input,next,copy$1,put),have-=copy$1,next+=copy$1,left-=copy$1,put+=copy$1,state.length-=copy$1;break}state.mode=TYPE;break;case TABLE:for(;bits<14;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=(hold&31)+257,hold>>>=5,bits-=5,state.ndist=(hold&31)+1,hold>>>=5,bits-=5,state.ncode=(hold&15)+4,hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg=`too many length or distance symbols`,state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:for(;state.have<state.ncode;){for(;bits<3;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=hold&7,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg=`invalid code lengths set`,state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(here_val===16){for(n$1=here_bits+2;bits<n$1;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,state.have===0){strm.msg=`invalid bit length repeat`,state.mode=BAD;break}len$1=state.lens[state.have-1],copy$1=3+(hold&3),hold>>>=2,bits-=2}else if(here_val===17){for(n$1=here_bits+3;bits<n$1;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len$1=0,copy$1=3+(hold&7),hold>>>=3,bits-=3}else{for(n$1=here_bits+7;bits<n$1;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len$1=0,copy$1=11+(hold&127),hold>>>=7,bits-=7}if(state.have+copy$1>state.nlen+state.ndist){strm.msg=`invalid bit length repeat`,state.mode=BAD;break}for(;copy$1--;)state.lens[state.have++]=len$1}}if(state.mode===BAD)break;if(state.lens[256]===0){strm.msg=`invalid code -- missing end-of-block`,state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg=`invalid literal/lengths set`,state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg=`invalid distances set`,state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&!(here_op&240)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(last_bits+here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,here_op===0){state.mode=LIT;break}if(here_op&32){state.back=-1,state.mode=TYPE;break}if(here_op&64){strm.msg=`invalid literal/length code`,state.mode=BAD;break}state.extra=here_op&15,state.mode=LENEXT;case LENEXT:if(state.extra){for(n$1=state.extra;bits<n$1;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(!(here_op&240)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(last_bits+here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,here_op&64){strm.msg=`invalid distance code`,state.mode=BAD;break}state.offset=here_val,state.extra=here_op&15,state.mode=DISTEXT;case DISTEXT:if(state.extra){for(n$1=state.extra;bits<n$1;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg=`invalid distance too far back`,state.mode=BAD;break}state.mode=MATCH;case MATCH:if(left===0)break inf_leave;if(copy$1=_out-left,state.offset>copy$1){if(copy$1=state.offset-copy$1,copy$1>state.whave&&state.sane){strm.msg=`invalid distance too far back`,state.mode=BAD;break}copy$1>state.wnext?(copy$1-=state.wnext,from=state.wsize-copy$1):from=state.wnext-copy$1,copy$1>state.length&&(copy$1=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy$1=state.length;copy$1>left&&(copy$1=left),left-=copy$1,state.length-=copy$1;do output[put++]=from_source[from++];while(--copy$1);state.length===0&&(state.mode=LEN);break;case LIT:if(left===0)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){for(;bits<32;){if(have===0)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg=`incorrect data check`,state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(state.total&4294967295)){strm.msg=`incorrect length check`,state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=MEM,Z_MEM_ERROR):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK&&(ret=Z_BUF_ERROR),ret)}function inflateEnd(strm){if(!strm||!strm.state)return Z_STREAM_ERROR;var state=strm.state;return state.window&&=null,strm.state=null,Z_OK}function inflateGetHeader(strm,head){var state;return!strm||!strm.state||(state=strm.state,!(state.wrap&2))?Z_STREAM_ERROR:(state.head=head,head.done=!1,Z_OK)}function inflateSetDictionary(strm,dictionary){var dictLength=dictionary.length,state,dictid,ret;return!strm||!strm.state||(state=strm.state,state.wrap!==0&&state.mode!==DICT)?Z_STREAM_ERROR:state.mode===DICT&&(dictid=1,dictid=adler32(dictid,dictionary,dictLength,0),dictid!==state.check)?Z_DATA_ERROR:(ret=updatewindow(strm,dictionary,dictLength,dictLength),ret?(state.mode=MEM,Z_MEM_ERROR):(state.havedict=1,Z_OK))}exports.inflateReset=inflateReset,exports.inflateReset2=inflateReset2,exports.inflateResetKeep=inflateResetKeep,exports.inflateInit=inflateInit,exports.inflateInit2=inflateInit2,exports.inflate=inflate$2,exports.inflateEnd=inflateEnd,exports.inflateGetHeader=inflateGetHeader,exports.inflateSetDictionary=inflateSetDictionary,exports.inflateInfo=`pako inflate (from Nodeca project)`})),require_constants=__commonJSMin(((exports,module)=>{module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}})),require_gzheader=__commonJSMin(((exports,module)=>{function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=``,this.comment=``,this.hcrc=0,this.done=!1}module.exports=GZheader$1})),require_inflate=__commonJSMin((exports=>{var zlib_inflate=require_inflate$1(),utils=require_common(),strings=require_strings(),c=require_constants(),msg=require_messages(),ZStream=require_zstream(),GZheader=require_gzheader(),toString=Object.prototype.toString;function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=utils.assign({chunkSize:16384,windowBits:0,to:``},options||{});var opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,opt.windowBits===0&&(opt.windowBits=-15)),opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits)&&(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&(opt.windowBits&15||(opt.windowBits|=15)),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==c.Z_OK||(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),opt.dictionary&&(typeof opt.dictionary==`string`?opt.dictionary=strings.string2buf(opt.dictionary):toString.call(opt.dictionary)===`[object ArrayBuffer]`&&(opt.dictionary=new Uint8Array(opt.dictionary)),opt.raw&&(status=zlib_inflate.inflateSetDictionary(this.strm,opt.dictionary),status!==c.Z_OK))))throw Error(msg[status])}Inflate.prototype.push=function(data,mode){var strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary,status,_mode,next_out_utf8,tail,utf8str,allowBufError=!1;if(this.ended)return!1;_mode=mode===~~mode?mode:mode===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof data==`string`?strm.input=strings.binstring2buf(data):toString.call(data)===`[object ArrayBuffer]`?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(strm.avail_out===0&&(strm.output=new utils.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),status=zlib_inflate.inflate(strm,c.Z_NO_FLUSH),status===c.Z_NEED_DICT&&dictionary&&(status=zlib_inflate.inflateSetDictionary(this.strm,dictionary)),status===c.Z_BUF_ERROR&&allowBufError===!0&&(status=c.Z_OK,allowBufError=!1),status!==c.Z_STREAM_END&&status!==c.Z_OK)return this.onEnd(status),this.ended=!0,!1;strm.next_out&&(strm.avail_out===0||status===c.Z_STREAM_END||strm.avail_in===0&&(_mode===c.Z_FINISH||_mode===c.Z_SYNC_FLUSH))&&(this.options.to===`string`?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&utils.arraySet(strm.output,strm.output,next_out_utf8,tail,0),this.onData(utf8str)):this.onData(utils.shrinkBuf(strm.output,strm.next_out))),strm.avail_in===0&&strm.avail_out===0&&(allowBufError=!0)}while((strm.avail_in>0||strm.avail_out===0)&&status!==c.Z_STREAM_END);return status===c.Z_STREAM_END&&(_mode=c.Z_FINISH),_mode===c.Z_FINISH?(status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===c.Z_OK):_mode===c.Z_SYNC_FLUSH?(this.onEnd(c.Z_OK),strm.avail_out=0,!0):!0},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===c.Z_OK&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};function inflate$1(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg||msg[inflator.err];return inflator.result}function inflateRaw(input,options){return options||={},options.raw=!0,inflate$1(input,options)}exports.Inflate=Inflate,exports.inflate=inflate$1,exports.inflateRaw=inflateRaw,exports.ungzip=inflate$1})),require_pako=__commonJSMin(((exports,module)=>{var assign=require_common().assign,deflate=require_deflate(),inflate=require_inflate(),constants=require_constants(),pako={};assign(pako,deflate,inflate,constants),module.exports=pako})),import_hdrhistogram_umd=__toESM(__commonJSMin(((exports,module)=>{(function(t$1,e$2){typeof exports==`object`&&module!==void 0?e$2(exports,require_pako()):typeof define==`function`&&define.amd?define([`exports`,`pako`],e$2):e$2((t$1=typeof globalThis<`u`?globalThis:t$1||self).hdr={},t$1.pako)})(exports,(function(exports$1,pako$1){function _interopNamespace(t$1){if(t$1&&t$1.__esModule)return t$1;var e$2=Object.create(null);return t$1&&Object.keys(t$1).forEach((function(r$1){if(r$1!==`default`){var n$1=Object.getOwnPropertyDescriptor(t$1,r$1);Object.defineProperty(e$2,r$1,n$1.get?n$1:{enumerable:!0,get:function(){return t$1[r$1]}})}})),e$2.default=t$1,Object.freeze(e$2)}var pako__namespace=_interopNamespace(pako$1);let{pow:pow$6,floor:floor$5}=Math,TWO_POW_32=pow$6(2,32);class ByteBuffer{static allocate(t$1=16){return new ByteBuffer(new Uint8Array(t$1))}constructor(t$1){this.position=0,this.data=t$1,this.int32ArrayForConvert=new Uint32Array(1),this.int8ArrayForConvert=new Uint8Array(this.int32ArrayForConvert.buffer)}put(t$1){if(this.position===this.data.length){let t$2=this.data;this.data=new Uint8Array(2*this.data.length),this.data.set(t$2)}this.data[this.position]=t$1,this.position++}putInt32(t$1){if(this.data.length-this.position<4){let t$2=this.data;this.data=new Uint8Array(2*this.data.length+4),this.data.set(t$2)}this.int32ArrayForConvert[0]=t$1,this.data.set(this.int8ArrayForConvert.reverse(),this.position),this.position+=4}putInt64(t$1){this.putInt32(floor$5(t$1/TWO_POW_32)),this.putInt32(t$1)}putArray(t$1){if(this.data.length-this.position<t$1.byteLength){let e$2=this.data;this.data=new Uint8Array(this.position+t$1.byteLength),this.data.set(e$2)}this.data.set(t$1,this.position),this.position+=t$1.byteLength}get(){let t$1=this.data[this.position];return this.position++,t$1}getInt32(){this.int8ArrayForConvert.set(this.data.slice(this.position,this.position+4).reverse());let t$1=this.int32ArrayForConvert[0];return this.position+=4,t$1}getInt64(){let t$1=this.getInt32(),e$2=this.getInt32();return t$1*TWO_POW_32+e$2}resetPosition(){this.position=0}}class HistogramIterationValue{constructor(){this.reset()}reset(){this.valueIteratedTo=0,this.valueIteratedFrom=0,this.countAtValueIteratedTo=0,this.countAddedInThisIterationStep=0,this.totalCountToThisValue=0,this.totalValueToThisValue=0,this.percentile=0,this.percentileLevelIteratedTo=0}}class JsHistogramIterator{constructor(){this.currentIterationValue=new HistogramIterationValue}resetIterator(t$1){this.histogram=t$1,this.savedHistogramTotalRawCount=t$1.totalCount,this.arrayTotalCount=t$1.totalCount,this.currentIndex=0,this.currentValueAtIndex=0,this.nextValueAtIndex=2**t$1.unitMagnitude,this.prevValueIteratedTo=0,this.totalCountToPrevIndex=0,this.totalCountToCurrentIndex=0,this.totalValueToCurrentIndex=0,this.countAtThisValue=0,this.freshSubBucket=!0,this.currentIterationValue.reset()}hasNext(){if(this.histogram.totalCount!==this.savedHistogramTotalRawCount)throw`Concurrent Modification Exception`;return this.totalCountToCurrentIndex<this.arrayTotalCount}next(){for(;!this.exhaustedSubBuckets();){if(this.countAtThisValue=this.histogram.getCountAtIndex(this.currentIndex),this.freshSubBucket&&=(this.totalCountToCurrentIndex+=this.countAtThisValue,this.totalValueToCurrentIndex+=this.countAtThisValue*this.histogram.highestEquivalentValue(this.currentValueAtIndex),!1),this.reachedIterationLevel()){let t$1=this.getValueIteratedTo();if(Object.assign(this.currentIterationValue,{valueIteratedTo:t$1,valueIteratedFrom:this.prevValueIteratedTo,countAtValueIteratedTo:this.countAtThisValue,countAddedInThisIterationStep:this.totalCountToCurrentIndex-this.totalCountToPrevIndex,totalCountToThisValue:this.totalCountToCurrentIndex,totalValueToThisValue:this.totalValueToCurrentIndex,percentile:100*this.totalCountToCurrentIndex/this.arrayTotalCount,percentileLevelIteratedTo:this.getPercentileIteratedTo()}),this.prevValueIteratedTo=t$1,this.totalCountToPrevIndex=this.totalCountToCurrentIndex,this.incrementIterationLevel(),this.histogram.totalCount!==this.savedHistogramTotalRawCount)throw Error(`Concurrent Modification Exception`);return this.currentIterationValue}this.incrementSubBucket()}throw Error(`Index Out Of Bounds Exception`)}getPercentileIteratedTo(){return 100*this.totalCountToCurrentIndex/this.arrayTotalCount}getPercentileIteratedFrom(){return 100*this.totalCountToPrevIndex/this.arrayTotalCount}getValueIteratedTo(){return this.histogram.highestEquivalentValue(this.currentValueAtIndex)}exhaustedSubBuckets(){return this.currentIndex>=this.histogram.countsArrayLength}incrementSubBucket(){this.freshSubBucket=!0,this.currentIndex++,this.currentValueAtIndex=this.histogram.valueFromIndex(this.currentIndex),this.nextValueAtIndex=this.histogram.valueFromIndex(this.currentIndex+1)}}class RecordedValuesIterator extends JsHistogramIterator{constructor(t$1){super(),this.doReset(t$1)}reset(){this.doReset(this.histogram)}doReset(t$1){super.resetIterator(t$1),this.visitedIndex=-1}incrementIterationLevel(){this.visitedIndex=this.currentIndex}reachedIterationLevel(){return this.histogram.getCountAtIndex(this.currentIndex)!=0&&this.visitedIndex!==this.currentIndex}}let{pow:pow$5,floor:floor$4,log2:log2$2}=Math;class PercentileIterator extends JsHistogramIterator{constructor(t$1,e$2){super(),this.percentileTicksPerHalfDistance=0,this.percentileLevelToIterateTo=0,this.percentileLevelToIterateFrom=0,this.reachedLastRecordedValue=!1,this.doReset(t$1,e$2)}reset(t$1){this.doReset(this.histogram,t$1)}doReset(t$1,e$2){super.resetIterator(t$1),this.percentileTicksPerHalfDistance=e$2,this.percentileLevelToIterateTo=0,this.percentileLevelToIterateFrom=0,this.reachedLastRecordedValue=!1}hasNext(){return!!super.hasNext()||!this.reachedLastRecordedValue&&this.arrayTotalCount>0&&(this.percentileLevelToIterateTo=100,this.reachedLastRecordedValue=!0,!0)}incrementIterationLevel(){this.percentileLevelToIterateFrom=this.percentileLevelToIterateTo;let t$1=this.percentileTicksPerHalfDistance*pow$5(2,floor$4(log2$2(100/(100-this.percentileLevelToIterateTo)))+1);this.percentileLevelToIterateTo+=100/t$1}reachedIterationLevel(){return this.countAtThisValue===0?!1:100*this.totalCountToCurrentIndex/this.arrayTotalCount>=this.percentileLevelToIterateTo}getPercentileIteratedTo(){return this.percentileLevelToIterateTo}getPercentileIteratedFrom(){return this.percentileLevelToIterateFrom}}let leftPadding=t$1=>e$2=>e$2.length<t$1?` `.repeat(t$1-e$2.length)+e$2:e$2,integerFormatter=t$1=>{let e$2=leftPadding(t$1);return t$2=>e$2(``+t$2)},{floor:floor$3,log10,pow:pow$4}=Math,numberOfDigits=t$1=>floor$3(log10(t$1)+1),keepSignificantDigits=t$1=>e$2=>{let r$1=numberOfDigits(e$2);return r$1>t$1?e$2-e$2%pow$4(10,r$1-t$1):e$2},floatFormatter=(t$1,e$2)=>{let r$1=new Intl.NumberFormat(`en-US`,{maximumFractionDigits:e$2,minimumFractionDigits:e$2,useGrouping:!1}),n$1=leftPadding(t$1);return t$2=>n$1(r$1.format(t$2))},ulp=t$1=>2**(Math.floor(Math.log2(t$1))-52),NO_TAG=`NO TAG`,toSummary=t$1=>{let{totalCount:e$2,maxValue:r$1,numberOfSignificantValueDigits:n$1}=t$1,i$2=keepSignificantDigits(n$1);return{p50:i$2(t$1.getValueAtPercentile(50)),p75:i$2(t$1.getValueAtPercentile(75)),p90:i$2(t$1.getValueAtPercentile(90)),p97_5:i$2(t$1.getValueAtPercentile(97.5)),p99:i$2(t$1.getValueAtPercentile(99)),p99_9:i$2(t$1.getValueAtPercentile(99.9)),p99_99:i$2(t$1.getValueAtPercentile(99.99)),p99_999:i$2(t$1.getValueAtPercentile(99.999)),max:r$1,totalCount:e$2}},{pow:pow$3,floor:floor$2,ceil:ceil$1,log2:log2$1,max:max$2,min:min$2}=Math;class JsHistogram{incrementTotalCount(){this._totalCount++}addToTotalCount(t$1){this._totalCount+=t$1}setTotalCount(t$1){this._totalCount=t$1}get totalCount(){return this._totalCount}updatedMaxValue(t$1){this.maxValue=t$1+this.unitMagnitudeMask}updateMinNonZeroValue(t$1){t$1<=this.unitMagnitudeMask||(this.minNonZeroValue=floor$2(t$1/this.lowestDiscernibleValueRounded)*this.lowestDiscernibleValueRounded)}constructor(t$1,e$2,r$1){if(this.autoResize=!1,this.startTimeStampMsec=2**53-1,this.endTimeStampMsec=0,this.tag=NO_TAG,this.maxValue=0,this.minNonZeroValue=2**53-1,this.identity=0,this.highestTrackableValue=0,this.lowestDiscernibleValue=0,this.numberOfSignificantValueDigits=0,this.bucketCount=0,this.subBucketCount=0,this.countsArrayLength=0,this.wordSizeInBytes=0,t$1<1)throw Error(`lowestDiscernibleValue must be >= 1`);if(e$2<2*t$1)throw Error(`highestTrackableValue must be >= 2 * lowestDiscernibleValue ( 2 * ${t$1} )`);if(r$1<0||r$1>5)throw Error(`numberOfSignificantValueDigits must be between 0 and 5`);this.identity=JsHistogram.identityBuilder++,this.init(t$1,e$2,r$1)}init(t$1,e$2,r$1){this.lowestDiscernibleValue=t$1,this.highestTrackableValue=e$2,this.numberOfSignificantValueDigits=r$1;let n$1=2*floor$2(pow$3(10,r$1));this.unitMagnitude=floor$2(log2$1(t$1)),this.lowestDiscernibleValueRounded=pow$3(2,this.unitMagnitude),this.unitMagnitudeMask=this.lowestDiscernibleValueRounded-1;let i$2=ceil$1(log2$1(n$1));this.subBucketHalfCountMagnitude=(i$2>1?i$2:1)-1,this.subBucketCount=pow$3(2,this.subBucketHalfCountMagnitude+1),this.subBucketHalfCount=this.subBucketCount/2,this.subBucketMask=(floor$2(this.subBucketCount)-1)*pow$3(2,this.unitMagnitude),this.establishSize(e$2),this.leadingZeroCountBase=53-this.unitMagnitude-this.subBucketHalfCountMagnitude-1,this.percentileIterator=new PercentileIterator(this,1),this.recordedValuesIterator=new RecordedValuesIterator(this)}establishSize(t$1){this.countsArrayLength=this.determineArrayLengthNeeded(t$1),this.bucketCount=this.getBucketsNeededToCoverValue(t$1),this.highestTrackableValue=t$1}determineArrayLengthNeeded(t$1){if(t$1<2*this.lowestDiscernibleValue)throw Error(`highestTrackableValue (`+t$1+`) cannot be < (2 * lowestDiscernibleValue)`);return this.getLengthForNumberOfBuckets(this.getBucketsNeededToCoverValue(t$1))}getLengthForNumberOfBuckets(t$1){return(t$1+1)*(this.subBucketCount/2)}getBucketsNeededToCoverValue(t$1){let e$2=this.subBucketCount*pow$3(2,this.unitMagnitude),r$1=1;for(;e$2<=t$1;){if(e$2>(2**53-1)/2)return r$1+1;e$2*=2,r$1++}return r$1}recordValue(t$1){this.recordSingleValue(t$1)}recordSingleValue(t$1){let e$2=this.countsArrayIndex(t$1);e$2>=this.countsArrayLength?this.handleRecordException(1,t$1):this.incrementCountAtIndex(e$2),this.updateMinAndMax(t$1),this.incrementTotalCount()}handleRecordException(t$1,e$2){if(!this.autoResize)throw Error(`Value `+e$2+` is outside of histogram covered range`);this.resize(e$2);var r$1=this.countsArrayIndex(e$2);this.addToCountAtIndex(r$1,t$1),this.highestTrackableValue=this.highestEquivalentValue(this.valueFromIndex(this.countsArrayLength-1))}countsArrayIndex(t$1){if(t$1<0)throw Error(`Histogram recorded value cannot be negative.`);let e$2=this.getBucketIndex(t$1),r$1=this.getSubBucketIndex(t$1,e$2);return this.computeCountsArrayIndex(e$2,r$1)}computeCountsArrayIndex(t$1,e$2){return(t$1+1)*pow$3(2,this.subBucketHalfCountMagnitude)+(e$2-this.subBucketHalfCount)}getBucketIndex(t$1){return max$2(floor$2(log2$1(t$1))-this.subBucketHalfCountMagnitude-this.unitMagnitude,0)}getSubBucketIndex(t$1,e$2){return floor$2(t$1/pow$3(2,e$2+this.unitMagnitude))}updateMinAndMax(t$1){t$1>this.maxValue&&this.updatedMaxValue(t$1),t$1<this.minNonZeroValue&&t$1!==0&&this.updateMinNonZeroValue(t$1)}getValueAtPercentile(t$1){let e$2=min$2(t$1,100)/100*this.totalCount,r$1=max$2(ceil$1(e$2-ulp(e$2)),1),n$1=0;for(let e$3=0;e$3<this.countsArrayLength;e$3++)if(n$1+=this.getCountAtIndex(e$3),n$1>=r$1){var i$2=this.valueFromIndex(e$3);return t$1===0?this.lowestEquivalentValue(i$2):this.highestEquivalentValue(i$2)}return 0}valueFromIndexes(t$1,e$2){return e$2*pow$3(2,t$1+this.unitMagnitude)}valueFromIndex(t$1){let e$2=floor$2(t$1/this.subBucketHalfCount)-1,r$1=t$1%this.subBucketHalfCount+this.subBucketHalfCount;return e$2<0&&(r$1-=this.subBucketHalfCount,e$2=0),this.valueFromIndexes(e$2,r$1)}lowestEquivalentValue(t$1){let e$2=this.getBucketIndex(t$1),r$1=this.getSubBucketIndex(t$1,e$2);return this.valueFromIndexes(e$2,r$1)}highestEquivalentValue(t$1){return this.nextNonEquivalentValue(t$1)-1}nextNonEquivalentValue(t$1){return this.lowestEquivalentValue(t$1)+this.sizeOfEquivalentValueRange(t$1)}sizeOfEquivalentValueRange(t$1){let e$2=this.getBucketIndex(t$1),r$1=this.getSubBucketIndex(t$1,e$2);return pow$3(2,this.unitMagnitude+(r$1>=this.subBucketCount?e$2+1:e$2))}medianEquivalentValue(t$1){return this.lowestEquivalentValue(t$1)+floor$2(this.sizeOfEquivalentValueRange(t$1)/2)}get mean(){if(this.totalCount===0)return 0;this.recordedValuesIterator.reset();let t$1=0;for(;this.recordedValuesIterator.hasNext();){let e$2=this.recordedValuesIterator.next();t$1+=this.medianEquivalentValue(e$2.valueIteratedTo)*e$2.countAtValueIteratedTo}return t$1/this.totalCount}getStdDeviation(t$1=this.mean){if(this.totalCount===0)return 0;let e$2=0;for(this.recordedValuesIterator.reset();this.recordedValuesIterator.hasNext();){let r$1=this.recordedValuesIterator.next(),n$1=this.medianEquivalentValue(r$1.valueIteratedTo)-t$1;e$2+=n$1*n$1*r$1.countAddedInThisIterationStep}return Math.sqrt(e$2/this.totalCount)}get stdDeviation(){if(this.totalCount===0)return 0;let t$1=this.mean,e$2=0;for(this.recordedValuesIterator.reset();this.recordedValuesIterator.hasNext();){let r$1=this.recordedValuesIterator.next(),n$1=this.medianEquivalentValue(r$1.valueIteratedTo)-t$1;e$2+=n$1*n$1*r$1.countAddedInThisIterationStep}return Math.sqrt(e$2/this.totalCount)}outputPercentileDistribution(t$1=5,e$2=1,r$1=!1){let n$1=``;n$1+=r$1?`"Value","Percentile","TotalCount","1/(1-Percentile)"
`:`       Value     Percentile TotalCount 1/(1-Percentile)

`;let i$2=this.percentileIterator,s$1,o$1;if(i$2.reset(t$1),r$1){let t$2=floatFormatter(0,this.numberOfSignificantValueDigits),r$2=floatFormatter(0,12),n$2=floatFormatter(0,2);s$1=i$3=>t$2(i$3.valueIteratedTo/e$2)+`,`+r$2(i$3.percentileLevelIteratedTo/100)+`,`+i$3.totalCountToThisValue+`,`+n$2(1/(1-i$3.percentileLevelIteratedTo/100))+`
`,o$1=n$3=>t$2(n$3.valueIteratedTo/e$2)+`,`+r$2(n$3.percentileLevelIteratedTo/100)+`,`+n$3.totalCountToThisValue+`,Infinity
`}else{let t$2=floatFormatter(12,this.numberOfSignificantValueDigits),r$2=floatFormatter(2,12),n$2=integerFormatter(10),i$3=floatFormatter(14,2);s$1=s$2=>t$2(s$2.valueIteratedTo/e$2)+` `+r$2(s$2.percentileLevelIteratedTo/100)+` `+n$2(s$2.totalCountToThisValue)+` `+i$3(1/(1-s$2.percentileLevelIteratedTo/100))+`
`,o$1=i$4=>t$2(i$4.valueIteratedTo/e$2)+` `+r$2(i$4.percentileLevelIteratedTo/100)+` `+n$2(i$4.totalCountToThisValue)+`
`}for(;i$2.hasNext();){let t$2=i$2.next();t$2.percentileLevelIteratedTo<100?n$1+=s$1(t$2):n$1+=o$1(t$2)}if(!r$1){let t$2=floatFormatter(12,this.numberOfSignificantValueDigits),r$2=this.mean,i$3=t$2(r$2/e$2),s$2=t$2(this.getStdDeviation(r$2)/e$2),o$2=t$2(this.maxValue/e$2),a$1=integerFormatter(12);n$1+=`#[Mean    = ${i$3}, StdDeviation   = ${s$2}]\n#[Max     = ${o$2}, Total count    = ${a$1(this.totalCount)}]\n#[Buckets = ${a$1(this.bucketCount)}, SubBuckets     = ${a$1(this.subBucketCount)}]\n`}return n$1}get summary(){return toSummary(this)}toJSON(){return this.summary}inspect(){return this.toString()}[Symbol.for(`nodejs.util.inspect.custom`)](){return this.toString()}get estimatedFootprintInBytes(){return this._getEstimatedFootprintInBytes()}recordSingleValueWithExpectedInterval(t$1,e$2){if(this.recordSingleValue(t$1),!(e$2<=0))for(let r$1=t$1-e$2;r$1>=e$2;r$1-=e$2)this.recordSingleValue(r$1)}recordCountAtValue(t$1,e$2){let r$1=this.countsArrayIndex(e$2);r$1>=this.countsArrayLength?this.handleRecordException(t$1,e$2):this.addToCountAtIndex(r$1,t$1),this.updateMinAndMax(e$2),this.addToTotalCount(t$1)}recordValueWithCount(t$1,e$2){this.recordCountAtValue(e$2,t$1)}recordValueWithExpectedInterval(t$1,e$2){this.recordSingleValueWithExpectedInterval(t$1,e$2)}recordValueWithCountAndExpectedInterval(t$1,e$2,r$1){if(this.recordCountAtValue(e$2,t$1),!(r$1<=0))for(let n$1=t$1-r$1;n$1>=r$1;n$1-=r$1)this.recordCountAtValue(e$2,n$1)}addWhileCorrectingForCoordinatedOmission(t$1,e$2){let r$1=this,n$1=new RecordedValuesIterator(t$1);for(;n$1.hasNext();){let t$2=n$1.next();r$1.recordValueWithCountAndExpectedInterval(t$2.valueIteratedTo,t$2.countAtValueIteratedTo,e$2)}}add(t$1){if(!(t$1 instanceof JsHistogram))throw Error(`Cannot add a WASM histogram to a regular JS histogram`);if(this.highestEquivalentValue(this.valueFromIndex(this.countsArrayLength-1))<t$1.maxValue){if(!this.autoResize)throw Error(`The other histogram includes values that do not fit in this histogram's range.`);this.resize(t$1.maxValue)}if(this.bucketCount===t$1.bucketCount&&this.subBucketCount===t$1.subBucketCount&&this.unitMagnitude===t$1.unitMagnitude){let e$2=0;for(let r$1=0;r$1<t$1.countsArrayLength;r$1++){let n$1=t$1.getCountAtIndex(r$1);n$1>0&&(this.addToCountAtIndex(r$1,n$1),e$2+=n$1)}this.setTotalCount(this.totalCount+e$2),this.updatedMaxValue(max$2(this.maxValue,t$1.maxValue)),this.updateMinNonZeroValue(min$2(this.minNonZeroValue,t$1.minNonZeroValue))}else{let e$2=t$1.countsArrayIndex(t$1.maxValue),r$1=t$1.getCountAtIndex(e$2);this.recordCountAtValue(r$1,t$1.valueFromIndex(e$2));for(let n$1=0;n$1<e$2;n$1++)r$1=t$1.getCountAtIndex(n$1),r$1>0&&this.recordCountAtValue(r$1,t$1.valueFromIndex(n$1))}this.startTimeStampMsec=min$2(this.startTimeStampMsec,t$1.startTimeStampMsec),this.endTimeStampMsec=max$2(this.endTimeStampMsec,t$1.endTimeStampMsec)}getCountAtValue(t$1){let e$2=min$2(max$2(0,this.countsArrayIndex(t$1)),this.countsArrayLength-1);return this.getCountAtIndex(e$2)}subtract(t$1){let e$2=this.valueFromIndex(this.countsArrayLength-1);if(!(t$1 instanceof JsHistogram))throw Error(`Cannot subtract a WASM histogram to a regular JS histogram`);if(e$2<t$1.maxValue){if(!this.autoResize)throw Error(`The other histogram includes values that do not fit in this histogram's range.`);this.resize(t$1.maxValue)}if(this.bucketCount===t$1.bucketCount&&this.subBucketCount===t$1.subBucketCount&&this.unitMagnitude===t$1.unitMagnitude){let e$3=0;for(let r$1=0;r$1<t$1.countsArrayLength;r$1++){let n$1=t$1.getCountAtIndex(r$1);n$1>0&&(this.addToCountAtIndex(r$1,-n$1),e$3+=n$1)}this.setTotalCount(this.totalCount-e$3)}else for(let e$3=0;e$3<t$1.countsArrayLength;e$3++){let r$1=t$1.getCountAtIndex(e$3);if(r$1>0){let n$1=t$1.valueFromIndex(e$3);if(this.getCountAtValue(n$1)<r$1)throw Error(`otherHistogram count (`+r$1+`) at value `+n$1+` is larger than this one's (`+this.getCountAtValue(n$1)+`)`);this.recordCountAtValue(-r$1,n$1)}}(this.getCountAtValue(this.maxValue)<=0||this.getCountAtValue(this.minNonZeroValue)<=0)&&this.establishInternalTackingValues()}establishInternalTackingValues(t$1=this.countsArrayLength){this.maxValue=0,this.minNonZeroValue=Number.MAX_VALUE;let e$2=-1,r$1=-1,n$1=0;for(let i$2=0;i$2<t$1;i$2++){let t$2=this.getCountAtIndex(i$2);t$2>0&&(n$1+=t$2,e$2=i$2,r$1==-1&&i$2!=0&&(r$1=i$2))}e$2>=0&&this.updatedMaxValue(this.highestEquivalentValue(this.valueFromIndex(e$2))),r$1>=0&&this.updateMinNonZeroValue(this.valueFromIndex(r$1)),this.setTotalCount(n$1)}reset(){this.clearCounts(),this.setTotalCount(0),this.startTimeStampMsec=0,this.endTimeStampMsec=0,this.tag=NO_TAG,this.maxValue=0,this.minNonZeroValue=2**53-1}destroy(){}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __awaiter(t$1,e$2,r$1,n$1){return new(r$1||=Promise)((function(i$2,s$1){function o$1(t$2){try{u$1(n$1.next(t$2))}catch(t$3){s$1(t$3)}}function a$1(t$2){try{u$1(n$1.throw(t$2))}catch(t$3){s$1(t$3)}}function u$1(t$2){var e$3;t$2.done?i$2(t$2.value):(e$3=t$2.value,e$3 instanceof r$1?e$3:new r$1((function(t$3){t$3(e$3)}))).then(o$1,a$1)}u$1((n$1=n$1.apply(t$1,e$2||[])).next())}))}let BINARY=`eNrsfQtgVMXV/8zce3c3uQlclLBIUGdvogQRCUkIQbGbmwKiVaGWWoqvBAjCBoGEBW2/kARRxFelL6vV6iZU8bNY8bOtQsWAWkVbLb79V9uC9VU/W6m11bZ+5u85M/fu3VeygbxdabO798ydmXvmnDNnzpz5XVKz+hJKCKH302OqWXMzqabNtBn+NFbTZgKXaHM1a27Ev00EvzZWe5obGxuRpDQ3NpJqpbkZCzeSagp0pVmUbaLN1WpzU1MzqVaamkT5piYsL2ukTVgFba4mpJrgtWbaBB1oqlabsVoKtbBGqBev0OZqrRlJLJcqtSvWajULVzaEyVHKn9nbLCdPISQ7b5RK1Ozso9TsMfnZNMeTTYYrHkXxU5UQouZSv0I9wz2K+B8lZLia61FUv0qVPEVR8tRhhjKaMq8ndwQZTbVhR2gE7stW1bHkSIL/0VGEeIghClFRwKZ156oKl+nRiYTRw+A/lY6iPkpVSvGPT/7P56OE6fgP/9Ozsrwjxe2id4qvl65q8J+Srap0FVE1hRLq2URHNdIZdhG9mVqH8sddRUx1xPLCHx/8GQl/xsKfQvhzIvzZvZFCDdddw3TvJyc9QHO/evrZ8yqsc86xvn7R6TOUYdmzl60Or7y4oeaSCmW47vyYXK4Y0V+lJcqI6K/yMuWI4XNrFtXVLnauKUdqF120ovZSomsXXbRq2QoS9F500ZoV8K0y66KLFq1cvrx2UZhY+kUXNYTDyy5aWLO6VhnpuaT2kpUN32Bk5EUXra4NWw0Xr7mkdkV49Zm1Ky4OLyUzRkU7V7Bo5YrV4YY1i8IrG8g79CgX5eLa8Mk1a8Irz6ldveybteTPMcTVscR3aWHcnUuXXby0dnV4XkPNorqahctrz61ZvqaW/G9MudUpy71HA3H1rQ7XNITnLbuk9ivhmktWnbW6dhH5S0yh1ckL/ZUeG1dT7YrFsUXejymyOlmRg/SYuFouWbbi7JUrFtQ2rBQ9/hv1x5eouUyQPkhga3hluGb5F1euWREmf6f5CU+6eEbt2mU14WUrV5AP6ZHx1dbWrCD/oEXxT7U6vOySmnDt4lkrV4ZXNSxbET59RdU3wrWryT+pe7wbahetbFgsOvZRzIO7KF9bFl4quvcxPSF1kZmXrapdFK5dfPqKcG3D2prl5F/xzMaiVnhubcOi2hXhZctryb/pOFeRlWvCq9a4yDOWrQ43LFu4Bp/9P/SkGEFd9Y0vrmxowBZnrWz44sqVDYuXrYBHnnPJstWr4Y5P6GjXHTWLo4pUQf4vZhTctMnl5NOUxNIS0pGSWF5GWtjRscQ4DSbrYwqsXrMw3FCzKOzq2OXsmM4KTC4nGzovUVpCrui8RHkZuZKZSUrEd3YjG+EqVbti0crFteQqZsTIwOraMNnE/K4exliRq9kYNynBjMRQE+zIcfH3pjIkx8VXk8qSmPE1JjUlZnx1SW0Jj68riTHh8TUlsSbHxteTaE5GJxSJ2pMEBscYlLGJD+yyKNewkQk1g0m5lo1PeLiUNuW62OF3G5XrGU9BilqVb7EJnZRJMCs3sHi+J9qVzazIXaZTw/JtNilWeLu2LN9hR7lviTUt342V+Djb8r3U1NIS8v3U1PIycqNLrwU1XmN/EFsiiX25iR3baYnJ5eTmLoqUlpAfdlGkvIzcwgqSFYnv8a3sCHcxaWR+5LI8KBJgZW5ziVlpSYyVud3Ft9KSzqxMaUlnVkbe27WVkdV0bWVkjV1YGVldF1ZG1tWplZE1dWplZD2dWRm7SDIrI2kprIzzwC4rE3FZGbtmsDKtLitjP1xKK9MWO/xuK7OF8RSkqJX5scvKJJZJsDJ3sHi+J1qZO11WprSkcyuz1WVlUHi7tjJ3uaxMaUmclfnvWImPszJ3p6aWlpCfpKaWl5FtLhsiqPE6e09siSRW5qfs2E5LTC4n93ZRpLSEbO+iSHkZuc9lZVxF4nv8Py4rU1piW5n7XVYGRQKszM9cYlZeFmNlfu7iW3lZZ1amvKwzKyPv7drKyGq6tjKyxi6sjKyuCysj6+rUysiaOrUysp7OrIxdJJmVkbQUVsZ5YJeV+YXLytg1g5V5wGVl7IdLaWUejB1+t5XZwXgKUtTK7HRZmcQyCVbmlyye74lW5iGXlSkv69zK7HJZGRTerq3Mwy4rU14WZ2XaYyU+zsrsTk0tLSF7UlPLy8gjLhsiqPE6+2hsiSRW5jF2bKclJpeTX3VRpLSEPN5FkfIy8oTLyriKxPd4r8vKlJfZVuZJl5VBkQAr8xTLj7s7xtL8mh0TT06wNgklEizO+GR1pLI645NVl8ryHJ+s5qTW5/hk1Sa1QIXJ6kxihQqT1ZjEEhUkqy/RGo1NWixqkZIORIxV4smZ4bJMv2Gjk7YC1ulpNjHpg6e0UM8kio7bSv2WFXZCjlqqfWxSF+USrNWzLNkYJVqs59iJ8eU6tVrPs9JEZejacr3Ajo6/LdZ6vZioRXEW7KXOS5SWkJc7L1FeRl5hZpIS8bbh/yWWSmLRfscKuiw1uZy8mkax0hLyWhrFysvI79m4VMXin+IPbFR8UWnl/sjyEsUJLN1+ZiyuhSKuxzzARsRdm1xOXk+4WFpC/pRwsbyMvMHyxMX47r3JfHRmVhYlFtUVOuu07B884nub5RJOONlVRa9sb71Zv4SyZiuSbbzFrM058He/D/7uu5LipY34ETkC/u4eg9+RvnkfMd5iBZpJi5hqNdYHiFLJCaenqZWcFDF1DCfWyJDxRfyB9Byq6/ouSpXmAg8ns0Q5X6FHZ5V2IZPOlJfH5FCdU/xqsnLm44wzKKPUc9pQzlS9wBtgQM4xqUXPUpstqsG2QxEjnJ6uVlqRbGt/tjXKGmsQonNqKWHrsY00VMSIxev1gALV+QKUE84KfDMtxpV8qBceAZqjnMrmCF5mnJQzn/40pWozkAj0VrFa2OlqM1csda1mHcsV65OOjg7F/jw931QurjNVy1sXYFzhqqXWrbWM1dA6hdZVbMTU1EqucRXq56payVWuwRNyhTNLDYcsFuYkVMSqOQWmxVyFu6q5Clxj4ooYjyauXFoPzXAFeq8gW4FdxGri7NL6ckZ0Xdd/yagmHsdkUNpSQ5xZjfUhU8VrFq3HG1VDhaqiZKUc+Ay/JS/EHQGmc8VicBO11DqoA+gBD7AV6/DAPYpTh85V6HgDVAfsAeYTpJtMMpdJ5jLJXOYwl11cZyrAXI0z6Jxgrsm4FsM2fDACbEBu+LiCXKTI45jCcK3a5hPlWhj7pUnGEiGllLMwSuBVlFLo3qp61gykSM5nfSaccWodGbJW1VtqnUkto25WPowOsAE6YtQFQLL1OpNZI09XK4fryFlWz5nlg4u0oUEwV3QZPnxYqRoKmcxiQCSclbNIDnJV02+klDUHiUktciYoAqd1lcQiszWL6Gol0a3N1zCohljbbxRfQFUt/+kwthYLAz2EzVkkQBUYOwNolBPJG6dENacWDQUo6DIn8BXVGlv42Y0sSCwjbHjgZ2G2/qhClWZWKf4VKMMUQpmiW7RQsUiharACb6GnQB2uF/hmBliBJ2pHCrycoB0p9AieK/Wc4QXObFPRgN0tVKWZgXpiTY3dhl3xLLWyIE9YKdiYPF0YGmJSeFLjLQbPo8rnSdqZTjoiOxHXg4KsACnwFmZxUujlrNBnUws9FitUdHx0j0kKvE71QHN1T4gAfvi0AirksrHeUkN1hTg4IRMLz1ErC7JnqpWGFx+iDsyaNbzeopzko2UUWkrr9THCsBELjCgpyEb50a3s4XqBFwRcWEBozyKFim4R/Q4Qrs/EUCgjFcpoUSuf04vrwpyGLFoHlVqfdnR00NPzTWprJRMmQ5o8ahsoeM5mTsP1JprSpXFGThNPCYpFQ7IQCDxdaoKswu1LHbnEGywwZS8xSptZJaczYXazyMkEbwKNoXXiJ7XYWTaRig8GnZJkZilOQY9TEK2tc90nr3NSZyn1JgP+E6GQlLM6nMGgSbhDKLF9R3QgObNyJBk03i442imYIz4M8TFSfIzmzBrr3Dba+TbS+WbU2V0hllpvjQ6ZLBQQ/ZJKzeeAUFWRqQoRHz7xYYiP0VBEyA6XeqDrf1NghiDWe2Bz56iV1n6fFcmyrmDWsTCxFtACkD5WabUYAaZUcmb46gKsACacAnpP1V7aVPUGadlqtfhChSyH6ZxZ5IxcuNFkBZ+xvsV3upUd5ixUyHTdFuKC7IDCiWUAK9HYf0k0vF23nlKso3FGV6wczhxDC0w9K9/UjCyTzVQrgzB3qVwBowysCVtq3WlhlFrt4rowiKwW4hrXbKkNWR0dSshqaWmst4y1Jsz36hn5aEVhQpZfiC4mZSMsDR1XuGZkwawH9n0MEA0Vv5seq7GeazD7G8B2xj1g4zUxo4BQhUKmhnOe0EWsStOwYFO9GFKYbu3pVYGnIdY6nLphPgBBQa/EKMgy0Z1QwJUR7hFMiDjVwV3CbDWIGRCcqQJq1wvdKATVHBkyKSdGNqf6L7Op0owCo9TDfAbTFzEVNPacmipOAODOTCRScWhdgMkZQamfqVaCHIjHJmhtpIYUMVV6WEXMB73DbznwINQyQih5BjQCwixrZJavPkU91PKJe3yhALDEUmNLwowZoNKqA51J+iRKTqFoDwSdSbp0dqh4Ln04XOMo3eIfPp5F6+REhg0FtOgd4hsV1oWFHJbB9yRcU+qExlgjHE5RU7F8Ya5Zo9c2OA+rmSpcVMRFyb8sUVIVFyUrc03NVTI1V0EPEztvKhazh5g5ncXHASspO3uE01lmKpYBnTVcnfWAwEMXDFdns0VJVVyUnR1maq6SnXSWRjvbpRRiF490uqiYijUauuhzddFrqnBRERdlF3VRUhUXZReHm5qrZOouopwaMdITLwtSDAYjVZFUReoLV1yFhOb4evvZ0+iDmk4f0qiHxdWTWi2S2Az9GUYZ+CEsgII1KxdmYFLHwSPgqkXDdWeJG7hq5IBoi+Uqp5a3nhPLC24quqheqFidmavCXXVQG7gyoiOKEH7G5eOADCqVILxS8scrOMmrlg/vRAsp7SXKKxRGq56yStkqlNYSOsfVUFz/TBWXT1wNJesR9CNaQnTO3Y9UNei6fgKusbiyPKAosGpTvyQWpFCUGbkwT4dEN/XrMLSQZ6l1hXkFedZ119DZEAe4hln7rmEWtSg6LHnoJaExH1lXxAyLrrVo2ISlmfu3GkJHAqoLFeZZB3NQ0wvyYMgN3cRVGAP5wT4o2HMjVxbXOdN3w+oQZ9HNz5A5qvyyCteAm58hK9AhVnHBh0tPxXqDrICl1ifDQlNwDfwGWRX9XcU3XiG5xqn1BtYIVtm5n7rKOxPgG9AO3JBtl3dKu0tqaD0dUnHoFEp0/XqVqt3h51wXu4ahoHFS1dHR0TF8PlA42WoyK3K9Ryzq3yDiM3uORUPQAWCTpUCA4R3vnJAOl1rueV0VpXZfceocy4PlWr73v68pcywflGx55OVJc0I6GG8axoHB+AHKsWFo0GhVS8sP73z33j/RebCQqGqJfO+O64+W3/e9+uiHbIGVHYIfe++NHLcgpOEdf95w3x9GLbBykbD7qb9fsYUtgC4B7a73rrz32fvs6lqu+PTOPxwYscAy5K2R3+7dv/dP1zQvsI7Au1s2/3LnS/cczF0A3WTuboImVcETLMCxsWWBhsCFR0KLKT6b1m39bAYF8THVODFRk4pJbHV46wqzOxLGyVbODEN3BJrqN+YqWpPSnNXI6c12KnBlLQi286tGRJnaIKYhL+4P4sXb7VsONnNif+1YmO8qebC9Rq20vwc52eKmiVpcVwhxlx6u66yR012mVlW2yVSrOoZvqHrYu66qhS7gZJfJ4KpSRddVfTp8QQNE26roRvjZIf5bucDdMhDn5rIx8srHzZxVtYj/Pg5+OZeNAQsbEXXI66vO5SzmZ0Pc/VHawQ7y5SiREK5VBTfNjS8ybxa0QzltwzVTZ90FhpvkhxCSqApu2qo2s2YLai3bBGwwWVWHd14uGWMxzqru950LX0kVrbrfx9m6jSarouu4tqGKnAMEUBznB9MtOgtW1/km2cJFR7fmi/5AQ5WxDXmiDXniGvKs22h64hrSuCfakOmVAcpWCEJsyVF0rkClAcVqaTEswr0WnZUf8HFm86Cjg2yAdVfMWLvZEjdmUYJ9xzzX1ebocKhVLcY8993nzsJntqW2+Ittu9ydsAtGlHVgdebm42pQVrDv7jv+HlxnOrVdtmGdqeAPXyN+rNrQbmZzVjVxU1UH2bDV0sLW9vyQ6Z2gEFNvczrdGsjhrKrsqh3msBmk4t+fVp30VrCNeycoRsQkPIcr7Ty7lettZnbEHB4JGHw4H24rYHubqbcFRnCD5/Ac18Uj2syciJnLc/mwGcUXP/Hdr/39pFOxztERTrjRyodHIjyb6/yISFuEGzy3ledEInw4H9HGh8/wSO1um1H9VfjvzfYIH8GHz/jmj8fjr7YZZ3/16zfffPOfg+L6o8Hjr51ADgbbZvx55uxbzjv9g/ZIG/4zScTMbuUkUpjDGrkGXKnc0G4Snr3L/q63mTlCibdaHcPrTa/1pLfOCs6JDnd7dHh9+VzQkd9zcukYKa6N9hhvtr8Y3JfvfG/T7K8H7S+rXPRVbTr3Wlf7oEKLBLw6z5nx6eUTak/Lu7jSHqeKL0bMXOgoiAXduBX2HLafEjKzxis+7ruHs8aqiRsbAwrP4bnOLa0mDAoM6dr2tgjPmXHyKbc99MOPcna1RcAMw6hyCuPQWpDz2UDAeJO2AOVZEyCKg2VmTJ8HQ/CrYNuMXf8HUvnHYATvpm2czPDv+/HFI0asD7bN+PYE/2+/+tU7gBggHFSONUpB9W2YC0FxW043Bde1mxTqbovYHGhugxndKXIw2Ggyp5CZ7Rj44CKH1QeDPPtOU+fZETOH6zynlWdDt7JbxU2RCNdbTeKy6I1RxWtpad7QrnGiazxbl0UM0obLQcVpV9f1o9G1R9dFeGUiPGtR422m6xsV6mmG+Lz07tjagPqZM5PTuU9jaiJKpomIHfqnGoaA4F7hEEJHNHQRTRGZNaXTBXROrIM5nOTnUF24rXgrLDtEmJOYHlh6etRK7nH8Tg4uOES2aCigYAA5j1OuWe/lYMR2rUmXh2wHQsUQrXSKtdS1ow+ghrjH1Y7psWgY/VZPCKwVjZaDXlNBpZyFxH6OqztatAkR0nQ1QWJdaiNXl8ziqq7/S1VYE2v2NLJGmJEpDvPB7//3R8F1+DXy/SvoPBi5qM0zPbscG+mdQQivPS3vo2BbwAcP02Zm8ay2AOE+nsU9Mz5STn4t64k/BNukUr7dHmkztYiZzT3c2xq9mXtmkLb3T/pEe/vUtgj3gShqEbB3nhlvnHdw7vJLnwu2zQg2QhUvt0ew6vK3Hztmbc1TwbYZb96w9vdZTzwDlgvvOCP/4Lxnr3gs2Dbjlq2LHwrmPSHvWPLXBUWT7t8dbJsxveLErW9c/Yht6yIYy6gq3gTunFFn7e+gbiOGU/kWTtH/oOhmONMQeA0U5k3FOthB6+HPLA6zI6vPj5k646eq6PSEKwH7t5iWTtpUFdyw1VLDpmJtf4GEAqqYZrg6QfGBqaHcPXe1c8Xa/hoJmcoEhbRyZYLia4WipM3UomPlibLb9EYCEEvxtXJvBKZ891BorqEAotZmEq7NeFi1h3LaBjmU4HzMmH2mIsfnP5NWLcbxwXEgUNNJ//IfOG4hDNJD33m36H4xSDDCEV1/iTLWTJtgtTteGV1FN3J6rlpp7XuDWJFniRWhlhcjyoQ1Q1i0eBv8XbVtY0C1KCoY5Sq46KAI4D04c/+54KOpVXRjQHVpCYctLgzcFlt0zfJyVsaZ2CAs3gZ/D6vmbVOVIgj+TlUMvRW2PNJcn4lt7bGo6ri3CMZRRAruolMVHv1aLfYbisSeQDEnVbhjtGrbxqlKhbgoNxFmi4+54mO++IC9GXoyWWVbxbDYKlaEPVXEroMidh0UseuAH1x8FHHFmQ6mKcUxvyowogu2VRh64qL5Yn4ZYu9mtP4p7S6L1FQs8kW/znY2aMQDuFnExUUX+0g83+YKFs23WXS+jCYIFjHBIiZYxEQLTLCIiapZDItYUhZZzbBPsEllcFQXuo4d5Qx3e7hyMuEuUztNmS+/F1Zy5UHjiPuE6BFOdxp5t95dzlbhQwrpraLrpiqbIHim7jTybrkbFt915Ww5PBZXwuWsWGyhg/iXw3QhZB/8fyK51IJ5F8YoQSsznqUgJhGKW/OwMpXMt5C+qg7+Lq+zgqFytrTr4TQVMaCK9TGxhhm6qYltfLyoxUiNFiM1GkqNKDmWa4LpmlAHTYynJsZTE+OpCT3QxLBqQg/wo1p8LBV1ruKa8Rw+YxgfUXMesRu9Av4afrkiB5MI2/EaMkxzpJUYz2M7i2NZqT/CRHCsK8fHlkLh+AhBFaNkWDQEQi82vmWgZSbu/UXeItb+t4jVSi0O9dgbVCreZ2K2y/I1GKDn+COMMlPPlRBsWolNNkGo+2zJh2kkhCvbUKs4C4HIjLbVRTXFztZMNdpwG5W7gjLfRXbXZLD9JVrGmBC0zLBl8G1AyWfj3pyCLTNIf4CW2Ta4sopTbJlLN0bvYLhjDbUv5WQ8SDG94htb60xkyarQtk1bYd+yiBWPEV5oEQuPgR1D+FKHG9oW3r08vDwkbio7G7dkKafGXK0gzxrdlWQntaOYfULBJySYC4R8gbltn2oVit1SSBRSoQKOmT2qSCrBYCvML6pTiQZjrLkreUW1DFmJVs5GYiUaVKKJSrQQV0VMfTSGish4ZTPlwpuDH5sop41Tlc3ofpBz4NJNlNNz60WKCRQ4N1q2qvlKTjdMVW7C/US4dhetgvvvovpFlDbCtQmKD418ESMPOMEn+eXr0S9YsHWLkXerY+kixhFtGPcHUrQg3RKZpvgOR0lWCSUpQiUpEkoyNkFJ9r1HrJeTKUlRzyhJsa0kY+OUBBp+JVFJinpMSSpsJTkJ+eCzlLWcniXy8A5+QKz1WdZuItysIty7VcKwEaD/rptB+5kxQWaCMXnMx8Dlx7FrTZZvUjvKTGWUmdpRZupEmakdZaZOlJlGo8zUFWWmTpSZiz1dsQBz0j4UwxDabk2EsLkTMSUOK2gsK55W41hBw6FJlOjFYmMc7zkjWvwfw6xJrtLyj8/I1a+D/CqLFuqSf5hmJXiYS0BM7dwSXJWhEOVY3ujuhZBOHFvb3ZFpA0Iwo1MNw2QDubDGkq5mXU3GNIjpg7kUBMOaZOjSEYy2qjitKpiVIHPyoq0qYIriPIIAS6dlxfLaLReLxTLharRl1WlZFc+rxrTMwFiOFDtkXBUlh+vxQmltzsHxeX6YlQW//4yJUjhBofaPtpSQxdZwGpotWWzA/8/IFxqKZM8aE7Kk2Bn5oQBLw/BQYXhkUiDsIClh41Wc8AlsdmA6LJJsxW/5gFj7FGuYqEDYG4VTIwBMxfQ3LO72eUVFPpPKzXHDFBKg2iquV8knHQ0puBB9WWPRkFEgsqBC5Ww0Lm2UM2SinBKymo0L3AsZBsKezExcl8RMgNNKINtSNir4ivvwVDQKEysLl7PRBXmWL03bDVWNlEEMN7O+Qy2PZJat4lXEOA5qBtmg+t8ZU5tpk6Nz8UKIKQiwRPedrlaK1GYykQjDJSRDRoqYu6+5ahp9u1u1cuP6ZhwT8Mi+if1JrF+qGvYDh7XaVC0irILmKqLFdEFxBb5AOHJMJ3nY6cLfidMF0QhYLNU1gndSayIOIKZfoYMRUGzuebhyDwotdOyejY0BD3pFAcgM023TyT2JymZidh8aOH0YowynT/CfxFxEjUWw4cqcMpilQ+1y0gBSPY21A7Pz6XKsCsdU2tdwSJitfbLeL3Eqs9Qa1EqwCts/JtZRMqjA5EihCSCOlRUVYaq5Y3X0O8A8YXyiKnjVlSat8m6aKxRzq7ECU3UwstxCr9hqrOC0aphNrvJuckp4N0UL5DkFhkULDHMVGOsUyIsWyHMVKHAKjI0WGOsqcIJToCBaoMBVYLJT4IRogRNcBSqcApOjBSY7BQgW2Wqs0O3/Bsui9ve9t6gd83lb1P4h6aL2SqU3F2Rr+n5BJiLpk+jhrsmgHliWQZpj7y/LujTOzYNGZ/f3ns6anzedPZBUZzf2qs5eS/tBaRkoLW7RHZ7SMqG0QmJ6W2kLulLa79NBo7V/6j2tPeHzprVvJNXa9QqjTUpSvVWieqtKvVWieqtKvVVi9VaJ09tW1Fuji4FRhd6qQm/VqKKRWEVzFFacpIQ7XYqmWAoo2niFVNHGAHPXo6ZQ2M7qweUp5Lb3t8L+hOrjCScPgFJZSp0dGd0XbLvlbouFTWJBrNJ3Rr5F6/QJhMtVqbX/E7G0+4Vi+cTSm1OjrJxxuWmofwFycGVpeQ0O21k+sdJnlm+2Exq6wF7QiSegxhT9dwPeigATlWQLetPWL0u1JsZbAji6YNxH5WLbrZYxShah8VrWtVnCtt1mqMyJn8mLMQqvxCi8IhReEWbI3l0VZkgRZkgRZkgRZkgRZkgRZkgRZkgRZkgRZkgRZkgBM6QBPzUM4NmP1I1exZshBcxQnN3mxHgrmRlKjAs8D+k9EBUsyLPGJoxe8nleHqczfkE5PQPDyS2f4nYuNY4NEBFbGQnXODGG2xdgmd7SIU/ntXQAhYp4GsGqorfCIStiDLcOdhBrsogCQNo4mA1vORvNKrl3IiHgAxll3FvE+CxxTpd7QVsgQwTKFjEVE5XcQkFdQoH55vdJbwUrrITKxoJjMhaix/taKGr176RWO0d7UVmhrYvw4DkNoDPDAx4Fa+Dcg0fe8Lw6MwpNxbiAYxaCE8KDQ9x1AQ+quMq9IPd4p/EA5prb54P1mHgqwXgqs+OpQByLEpA4qFsV5ukswsZZIAsPF6SKsimuKJuSEGWzpSJVlO2nakIEkDMnAggDlDVXJLTLqQBsgRoNtUGgLRqKc9NND7DHqA54eVZVB92wNaDxrCrfpkAWV/B+z1nYf5+41QO3+hL67xP993EPhOhEppe7/+8Tp/9YgwdCdF5XiO4+O0TnBZoa4trJhNghOjHEOscDVqo7Lpc4UK8yRptY73kFO9EryEnTK5C5elE3Xk3uxhfkSXnkijEOXQAxVklvsl0A102cGdPsUHh/zvePUf00CH4fuxZD6Zj6MbtBDDOEIF8mMgYpts1F0p7V8umGy+ot36WcWB3rP/HWW77LGvTVlDbF1OSLqel2GlvTeIWYrMq3qeqzGq46ePvuDrIBMrOdH1W+jVeYrMrYVNXRsaHlYEcQyfJrlbHxiip+jT6OyMbOija0l1gl7oYmEqJ/F3YIMYAK8VZTwnJYyiwwcldSOI38LBP9g/PfEkgEDu/gPhkCiTD8aiY7EqsXaCYTp2dxP6XBDRThFLUP1VIE6SB6ROxGzET8BuwXsft1GgSBN2K//sgsDYVHsRC6gxiKdmhgJ/KEL+PEOeFLeFxRIruOQCX6NFKgWOQMOLBVoKiVBjai64ZvTMyFxEPa+mR094rYXDc0QhGrjv252MQhgZ/6a26gh67/gesI2CDDphE64ogjjmAjR45QRhw5bLhqaB7vyBE++G6MHJElP7Plpz5ypPiWMyJXH65LwAexnZYDaAAyp045XYw9MSGAwLDH4jAwnicdIe8V0XtOQjgxynN4JPa2KCTEcNc/uT/mZkdO7E8j9ufIKLOcXrvpPjcd1NyoEuXGxpYLd1HP+fF0knhDzAWjSlq+1PfpHsJJoa6vJXjoHfAm6iy6tpBZL2RZ+7IAVuQV+8u+rELN+jDLOoi/Pra/HMwq9FpX6FaLDr822V9a9MKs+PSNEyqNI6IpwIW5+mOMeuycjLjt7ZgsjOjxPU5my+1M+wogEoDrdFAXHkGcUyWwUd7TRZY1ngacGXccEPepwib7UgN6GPIUoCq32binztROlx4xq+PKCpMtD3i5ah3EzW1jGPhJIfilcW+dkasJkmbk4toSTg96RL40TLQFedhTHxSJeQxjH416mTAFoHsqE86HO+nWNHGmnteNPEhqjMApEba+LFaIuR7W5twiRkaoBBsUrrverkJibaNcuMe53nGLdcXaTq2cmFXMUvGxXHysEh9h4aZfJj5aqPjcJD83w2czzJeidERevwtcYzV5ToAiUkbegY1LXYIOuZcmRCxNErJS4WI0KxXqKhYfZdHlU7N7+WRFfOVsLn6ij+u0gmtbcW+1+Fgc34NuNm2PgSo2YeHopbV7n/BYTrXTme1MZxAYY4Qpd/AjzyO6S+R5WCgz40jnEkgdYDHAT2MkVrXb9iDEhrYGMBy7nxfN7JW0AmJq0fSqQsSxmCbca/SbjwLxQMcyUSoXCqn0pZn14CQeqtH8Bsj+O8k6IpreIHbFR0t3Vo9QDFx1MzFAjdv5hlZ+APIrizp73+j0jjYpV8D3Rc9XRdAVpK4ySWibSTc9xuH8Hh5b3raxsYquw8O/Mp+g1cMU0cORSXJ44kJemHcMs5XxEhVrHVX0NzYIBv19gwiIFhm8wlkJlpSmB2JYIt7l49rMXIV7oEQOHO+QKxYIz4BdmkjIPZiwPJHMt73WCvgzt3Gq+FIJwfrxylxcDWNPYn1o6Mm7xNKjPrQBy03JN8ZVh2+aQAmDJSJwTuUeN++gN4J3TVxpxFxq0JL5uuSbzTOWgmc8JZ9OscYcOptsJlWRc1R0mkSq7GmwpMf1+0hUU5xLzwiIdG8IgxHx7TOHvwhTy+WPuVNFWuP5DqOL12HMzL6ECebyRyWmmduUnU42Yxv8nr1zCySHd0quECG5IjmumK6O3XeyiZKNZofMAIGhuwuXNL5zwC68LcgtVAw2No2zxUg5PXFioMtpRd4RRTdS4R4nZFbZi68PVCsfLjzOFKWJNqaVmxl7cgtXVHOdY1uO0R0u1+eLk0R9/2l77XlcSItxulKZuvjHzLYLdvEXKWqmJu7wQD887jv+xaxj3At0jXuML4lysGgWNy7lHlhmKWJVjRriDW0LULgMm1WOZmjcG4J46KbGJs4abdicneLRd24JqNFTWPuYQhtZUx/x8SqlW3zcpHSXj1cr6fNRjeMjeG0qVzY9xpVYJu7ktNVknLXBfaN3tkVsjtoMvT1AHUdLvwoAFOXkEmO4JcoWp8YoJ7oQO6eg7KjWkXYUQ07lsMAH9zAnLhocH+XQ4NCEivlmkIslLZLKNbmsYWdI5qnOeUDNKebDs3+Yux2Fz5FRe8ehBGMdobFpkHJaTZzKH4UFcRpbOHEh2ZR7rq93kbkugULuacRsabmGQQa6a3knuuNK0HS7QoN4oCfE2XRMXcfdm/1MIF507yHIROITPub+PwuAN2OE7abnwDV3HBkMYsu7Eg6u5V0IFENHDziH0DgzzhZOiB1QY2kE1EiKkBqnxhyAsCliZXCGFeEURaq3KG8CBhqt4576UECqCyQKqs0WCUiBCddpXNNlsjc4MDHejuiWqYa2iVxQzjY9xhmolOJ4O1MVQzqB+uL0PD63LzYWPVfO3Kns0x2Pz4bD5GJT4TB8vrFx+gntPJ3S5ys+LJ/vas3t83VjyzPq//3O7f+NjfNroO+30wT/ryiZY+NSF3u+7cohXAoyv8p2COfCn6WNU8WX+cIhXGo7hGPjXAjo2h00uUNYfBgO4XzhEK7CkOzSuSDBGp7ywC7GuT/VO7fU6uiUnSOcsrDjlIWla+VzfiyVTlnYedjZtlMWlk4bd37Ml05ZOEWz0ikLy0Ms0gWzOYlnC42xqTm3k8Y7X9x2voD8S5fzFY53vo52nC8oukc6X28xRWmmTbiMH5mmusgjisKxprfeF9CiO7fgNT5gHAFZyRDVaOPaTu5pazXpLaYHTl/boR0gOhgxrUvy7xNLVAGyi8CWIughpjHFOjgMAF8PDounY1BEFZKEwXmuGsOxJr0gLwCgiiMcMqx1/4J7eCp8MYbbFJiJVM7EjeJgUbIu6NgFPZ7ujsvgnObUpNsjwPTzunMSFaGUMRBjTxsYiIEM4mSBmD9ksSwRiLmVHlLqU9KDuIe6VQwfq7oM48CTYhgHgg4wA+/+X5wV4QJ8N4bLUw04Rhh/9gJ7vW6D9YDHGiVtnCByanwZHBgwUNx4mZo+tGMW+OgvUzML0DLzrGzjFTR/IwvyrGEWA4pH5DJ4jf+HTif3Gl8xs2H/PHuCUuFo8SJwDwIqAAeMV8hOzrYY8+x94DNl2G4up9ZBPbo/PINnxVYC94Dp08vZbE65q+h0WUVlXBVlXIMGufFV+8aK2BtPlDcWx91Y6NI4FyZHTG9atxjztJRPlbpLqZ8q7c7ZT6UHsgvyeDYkKFCeHS0BCrsbFJbD4ay/uDbdVS6OsQghsd1WZ9RpOZvHiXFmIAetUA4+EpjT+fib8BzjLHFNK2fni2uwkSeeHW6vhvpATDzlbDEsMIT7b3wVpHCpfaHI+CpI2HLxGxJMjK+Cb7mqIA+PZeyHzn+PCiNzE4XfYJ5ss3MdrCQ2//UzM7qZchW+RWlXULEQ2oRTXfQ6aPk+uKUFbtnnviUseHMZHGeKsgrksuV9IgSz5X0XE2eAnAsh9MYK4W4oD0O+212+rCCP+8Tw+uKG930ix9ddvlDYriKREOFErgvyrO0HcVAJfHFR4HwIFDWlo3wrFfZtK7hLatJ1VvTAiguC5T7wXRPyaTzCuOLAjYY/hpCX2bjRHust4g1eUbVXHKq2cdPlspQT40sgCyr3jlfgcJ0HnBgvbo3C0lE4MQEvrLTAc/ai646b9sVjuBeAX4TrjpfCdQBxBY67R+6F49487oV7cAthrgZQJlwx5uhQ/WbK2TwkenDTmclNZwabzh7cdGa46cxEgXOjZWHTmdmbzlC5ByQbN525Ohcm0PkNM0WuxjqBqCpQKph4RI9rUYKdXDUonkw8De6BSnPhE1stOIdqEEFQrSiIROIXi3CP8QJO9MKNT5K58p8spjThdtXoNMMrYh7WJAx34jItO9kyzfTCQGTbC7VsCF9EF2pe8JY9PBuWaiidtj8NDjRscyOPY4IfHulKAy+9Yjlr7Tso5tjLNXG+ESZXuNM4G/bZveOVIvhd9GW1GVoshg3XYpHKhBdW4blkmduk4H5sGfcJV8oDv6KZm3ZoVXUtOHxc4z5cboDLcg6mLPlARuA8YSOcffZBxMKHsRlQMm90qL3wYxOFv5upKR8YYjpcmZeP0gSkmyTpJkk6N99kSRM0pEQhiP5SpzLqqLhHpBesAi5ugpQeiorgEZvQoAiaOLXNPUIRqFCEQFYsK3KAFVSwwohjRRayIiDPhUtpyIou2rOc0+OmzxYLn92uEAvsog+EgkVjYdh54u48cTpP7M4Td+ftXB0UOdRir63FmAkGWuyNarE9FjFa7I3RYq/Nc1k2Rouh8ujQWgTT1Dw8a7ZMlKLu1N1chftkan0M9zwxgkTjFAowohzuCZQvni3P2WdbJKDpgsfZkodaPA99Ng99MTz0JfLQNwB4qONIivQ9mXRUKTSh0lYEZ0E6WxBm28ozVZkNtk1GAOOiBldkZ4xfTxk/nzjBNYlm7B/z8awoNzIm8FBMoCdRnDJWMGMFB74VxCNxRSxjBdEKOtzIWMFDs4IJ4pSxgr1jBddnrGAPWkH7vGLGCPIshxkZG3hoNjBemDImsHdM4MXdT3UwkpxG+yFNxHziriCkfi1NryH3sbdkDX0rHvgqCXTdK0mg6zg7hdrd0Zf3zEPfScWhxZiHhlf01bufvIc4fGNXHH5Qpb7mbh9Phx18zs4UxwWMYxELUm7sG8eaciNk34eYjb3vQ8jGppiN7boEmyHRS06C9r4PIUEbuv4hk0e2FfEqN+N8UxFok2AetZniTc8WhWOceDhbABZeoMPMpSAZjn7CacosSwHNy7KUWXjoWjEuBJx4znjWWmt4fdjMBkjIZYi+ng0v+RMmJhsmYa6YHuMiHJ8GM3uZqXDfmZCV8A/B4NvsXkIqmdc4PqCCYnuxW5BXdgHopBczl6CjPNu4QExxFg2FuIq/sNuAum5cKN7bZVxowmEndbXolpery9A82e+wzeYUkta/JA67wlfx3lYV9T1kXGTq8mgxDQl6iOvQFXHwMeYgq13MFzKpcX5A4VlwADZL7iNgdjuDV2QBIkBouH3NatYfg/0ALR3ZiXWDbP9Hi/o/XuH/YGiojmvR2c5rT3Fe266KKU6mQEJeozuLNCC9F8jTB6Kpmo7/ozq+D0nl+xC370Pcvg+J931ICt/HY2cmiulK7KGBLGmwGwn7bR5jnD07wX6d29WJGmvxDt6oq2MfvyRRrwRdHjThwtUh0sWh0uVBI36Iro5muzoaznIe6epoUVfHI10dLdbV8cHmaExmOXVSXrnPGBdgMVOyrz4EY29q0A1fdGb22MMOe2fSs/Hano1HDLrm8mwQasb2bLzwQ3o2mugtXop6NpozJztHcvGlWnPBzmicwZwszr4q7rOvipyTlejZVwXnZCUpk5Xo2Vf3WDqejW92vKjkJBEVltyRybK55vJnXMqSZXMty+aaN55rXptrYvM2S3LNG+ValuSadwBwLaknw4Qno9gOi+PJMOHJKLaLM1tarSSezHv0UGCRuwvxZJHUIE+AfpwvwZ5gGLHXs/MBtMNUXRAuiRnATkojk7kHLghOyABWxMYa5GbKlO7HFaY1s6buw0DLzCYiDqhZzQFmNQdUBwrVzmSPUHGw35O0m2IjGvJJojgzMu8SDv7L1V8jiia8erEZ3gJCTqvPB+Sp2Ne1QMfOluw1KWgFq+eI38CcacWkNq40cXClqXTwAVpazCIA8Wz6XBn0DMZPCi+MtBLaZvo2PcZ9MItQBKOGmUSKtYr9YO6eqNgTKgZO9ESxVVMRzYJqUjmPQQOyB5vofOHV2Nrgi2qDV5wEFEfzf+NlTCSNTO9ejq0IQagiJ04VOXGqyIlTRU4cpuFWONLoTciqhrft0DrurQ/BxCDCDNG0ao/9eB778SBHONm0+34PTrvaGTJfmLplMBfEyC1yqjxeELNlio4JV9a5JmKY1QJajgu4gLN1wH8tdYM5rgZzkjfotuXi1aLo63jQfjpmPIaZNMpM6uSoK8ZCXC2C9/xPPDkJWfkyMakCrrlzpCCHafNHModp80fuHCauRBNIixB1xaGNhUypj+z0NPddI9FDXRjN3xwdmwMFvvzmj+VL3jd/bJ8CuM4js3sVt+1URIp51HZ6pO1UHdtZRThbF2C2ZKEP6zKgarLpSO316SgqIlJGNlNj4Vy1qQoys0XFxkIdzq4SOGVsFIHnPD35HPRcRpsPR5slxnzfKbTmQJlmdDqj0xmd7g2dZuGYvaw+0Gkb6TSj0xmdTq7T+zI6fVg6LV6L04cqrYBKC0CvjEZnNDpRo+92NLqipzXaVmU1Icwtw3hqPSBqC1V2he5UW5VVW5W9faDKnli9im6zqnb0NjZuHa+5MaHrpJorWpD1C5MwE97KYkMPxgc7pZp6RIjYVsmYnVsZGw54xc6tyr3ubdt4XS1262pZvK4W2bp6YryucreuFsbq6mhbV8fG66oRr6sjY3WV2Lqak0pX8eCw6tJVhDuIPSWvJeiqfVReGxC6mhC0TUdXK5Lr6o9o9xCVrBxrqqHL19TZr9ASGLY2qpq4yJ23PVP7LTY2wClQ4J1cOHbjZVw1tqB97P309M/AWi0+41XnVC1AKCxzn3jdTLu590vhNVnUBWzDBFgiwzdhJb74Vaghvh5LPB1owvikb8sSO9+/lQAY6b5fyOkFAQBHgfhaZ8n3hEdpggovnVNDRp3zbi4bK4SYDFA78S1MLA7/81vUeQcRvokJjv/Z4J80Cv4pWoG6LDUklA5fYPevHnkgX+oH8nX9QLEwpD9NeKA4DFIaj0FKYzBIaTwGqYBowUf3uR/93u49Oh7XVhI5ABClyZ/d9eDMeXAFqXOiz9tCJRoqUuB5AalFdpi6O9xtJL7R/YvEd1QGiS/P2v8fTPTY/58oEp+45CR67P9PTyLxTegEiW/rQAWhix5cyODQdcIpDTmFfMpA0WWg6A4Lim5VBoquR6DoVvUtFN0N/QhF9/vOoOggibQLNDoJr+wJYQr+JErgxXWHC0n3ZF9D0kW3vA4HlQ6rISHOTqUDDZhudY8C04UHEjDddYMSkc3tHWVA2YYOKFsG0KsXAL3WZgC9BjugV30ngF4NGUCvDKAXysvKNAC9/pAM0GtVXwJ6rbFhr8JDDdCrb56sZwC9/pgB9DJW9yegVzgD6DUwzzCvsU/fhjOAXod6grlPeJiBshkExi8loFc4A+iVMYFDG9ArYwUzVrALQK9wBtArYwWHNqDX4LaC6zNWsNcBvcIZQK+MDRzKgF6D2wQOXTCf1X0K5hPOgPkMEDCfNTYsTTgD5pM+mE+fcK3XwHzeH7JgPopInMKgkgvP58mBhuejYU9F7CYD6fO5h/RZ3c+QPuHBA+nT1O8Hi5sG6sHiNfZhxXCfHyxuijus2OQ6rDjx8wb/sbr/IX3CgwrSJ6PTGZ3O6HRXkD7hQQXpk9HpoaTT+zI63RuQPuHBBOmT0eihpNFDC9JndV9D+oQHNqRPU79D+jQNVEifPtLVZJA+XepqCkifbkN78P6F9ghkoD3yrJZPENqj5ZMotIe45EB7tHzSk9AeJw1KaA8neScD7dEFtIdcFmagPXoT2uOJoQ/tsZH2BbbHs0Mf2yMlI4cguMf+TsE9WFrgHswB9yhiAi5u0IF7OIGywwP3YALc4wvMAfd4fWCAe1xNexTd4xqagfc4bHgPl4eUgfcYOvAeBzLwHj0P73EdzeB7DHZ8j6toJwAfkCGcQfgYJAgf9/QqwseVNA2IjwPJID420r7E+LiW2lAY19ChhvLRV8/WMzgfr3eO8/G5ON50Ne1PoI9raAbpY2AebgJNFudyQJMzWB+Hdripj7jYa8ebrsmYwD6A+/h8WsFBgvcxkA3hoEL8yNjCjC3sGvTj82oLBwXqx8C2hYMI92Ow28KrMraw96E/Pq+mcDBgfwxsSzh40D8GuyF8asjifwjr12cAIC5jl0EA6V8EENBJAWYBOpnBAEkXA6SP+JZBATkEFBDMsMLl1UBHAbFPe2ZQQLqDAvLCUDyPeDhTcI/AgLgm5QGPA/I92u/HEb9HB+p5RDE1qb0/NSU7kfg9GnfM6XvUdc6puJMzib/LaHXvwIH0mmL3Dh5IRrczup3R7TRhQXpRt3sDFySj20NPt1/J6HavwIP0omr3Aj5IRrOHnmb/z5BCCemBGHc3YUJShbkHCk5InM72B1CIW2cHFlJIn+lsMqyQNHS2p9BCivoXLWR8Bi0kz4oItJCICy0kEosWEulRtJDJnaCF3DFg0ULsje4MWEgXYCHCocxghWSwQg4LK+TWDFZIz2CF3Po5wgr5U6dYIUpaWCGKgxWC1v7wsUL2SqyQnDTP2ovHORysEHuFHQcVonYGFaImQIUoAipE9ClnAEGF3N6zUCGRAQUVcu3ghAqJukcZpJAMUkgGKaQTpJC2DFLIoEcK+VFnSCG3ZZBCMkghQmJuSQcp5I1kSCG39ilSSKuDphEZckghffVsPYMU8mYGKcS4vV+RQiIZpJABehSq1TnCE8kghRzyQag+4mLmdPxgMIEpkUIiGaSQjCEc8kghGVuYsYVdI4VEMkghGVs45JFCBrstvCpjC3sfKSSSQQrJWMIhjhQy2A3h0EUKub1vkUIiGaSQgYIU0uogXkQySCHdQArpI771GlLIX4cwUggmWIFP4QIK2TsQgULkGbEMTsjnHifk9v7GCYkMIpyQu/v/VOLdA/ZUYqtzwinS96cS744/4XS3+4RT6ecNS+D2AYATEhlcOCEZ3c7odka308QJiQwunJCMbg893X4lo9u9ghMSGVQ4IRnNHnqaPbRwQm7vc5yQyADHCbm7/3FC7h6wOCF9prPJcELS0NkUOCG/YJQmP3LhRDULrZMMHSAqMMR5MpGRTtUOeOJHjvgwxMdI8TFafIwFjIqOjg4vjD3j9AGZZ19cecfdWE9BLmdFTH1gCVY+kRBxKAEa0ZFiKWE82JwURIRan3R0dCgAgLE5x2r5B7HKrAny3CK1iKHDSR9iZ/8zECYfp9gCtQ8MQys+Ew8dMU4NE1o3yu3sf5aY/d9tfJWS/sVXKc3gq+RZuwW+ym4XvsruWHyV3T2KrzK1E3yVvzmni42u8FUOD1glepAYsyoUsdXoQ5dNNcZ1F0UlFhwhDkVF7FO4UFScfTRTdY4Ja2JjOm0UFaNzFJVuwqekYgcyIyVWipHBSjEyWCldY6Xcn8FK6RmslPv7GCvldOEGqV1wk0qXw3UOFSAAAuCFqOIY608Z9aYzMB4xMB6JmWIpswJglO2540LTs8yELVyj0MwyLuCEZ3GPcQHMuVyDKelLaqXIqBI/TS8cmQiFODGONz3GBXDcF7fQQ8ZFePSaFLGRdq6NZH7LB8S6SbWyZY90kVChg9M/0tShqO4uerPqjKwujuJ7uM6zjWOM4zTsNZVd8dgNQ2oadgr8E+OBmBWnvTu7nkY90E74lQyzhqG/lhyzhqPDSsQOd5lRAYVhgSUc9higGP2W9LrgICukhMyxAWEA9Ab9L06NcajNTp9To7/IZYwc/2l25wYI1MuDPQv1smNAQb38TXU7Y2lHLg4P4yXWE0mSBJLgqXUP0CXWNMcBusR4asUxnpoHBkEAughfTY311DwZQJeuAV2MDKBLPwC6/DID6DLoAV1+1hmgy88zgC4ZQBchMf+TDqDLW8kAXe7vU0CXnQ7oyY4hB+jSV8/WM4Aub2cAXYwH+xXQZUcG0GWAnljb6Zy02pEBdDnk82p9xMUMiMFgMIEpAV12ZABdMoZwyAO6ZGxhxhZ2DeiyIwPokrGFQx7QZbDbwqsytrD3AV12ZABdMpZwiAO6DHZDOHQBXR7sW0CXHRlAl4EC6LLTASbZkQF06QagSx/xrdcAXX4j34aVVuJVX+C4dJYk5cqJkUlSzBiHCXw+kcB3j8JUAdeSXiJZlygtsiuJCY6x6TkEZ7NxsOl4Dm5meRtRNQ8RkgW8YDRPLCkeSuKEwAQiiteVFqmAnwZysAlzAMGcmd5Nj3EvTAmifLcxWZjdB5YEk4U5PUjAZPFGhdojMVl8QxaT5cH+xmTZMYgwWR7t/xOgjw7YE6A7ndNkO/r+BOij8afJHnWfJjvl84bb8OAAwGTZMbgwWTK6ndHtjG6nicmyY3BhsmR0e+jp9isZ3e4VTJYdgwqTJaPZQ0+zhxYmy4N9jsmyY4Bjsjza/5gsjw5YTJY+09lkmCxp6GwKTJafaow1pXUcWZEwH/DcPgkvgicqjC8IXOYiRiwaEoe1Omg9+IEdZAPAXFe10A0oiiLS2cXd1L6fwv1V3o1XQCDQrqMprTpiahi2kbPDrSOvB+oY2wN1FPRAHSf0QB2TD6eOqgq4W+NMT/X/ANXliYsqwmkV3bAO/m66Ur9SY75o6D05ipDohwAREv2YjidzsR9qSIAL3dBUb2248ztv0FlqpZXFmXWQ1lvqWmtYvSCazLoCyZzJcg35VtZpMGOsp1bkP8S6WR5Zth88tkEtpsGkZcZ0XQSPx3Ze5lTIbxFlfKnL6F2XGRNTRLMOXi6e88fUwWTIhgP7cHhvXj5XjdlwsE3lPtacFJrIHg6ZnoN1hwJeOEWJ38/Aw7lP0a1iMxIMoacuoGhcMRnuXcQCG+QqLsdBAhlwH05/WfAYWe59k9/Lc+5c5VkChF/jWY5Hy7ga4p5t0wngGSAwgDzpIwB0cij8NhbZGz6+xPM7mzJiOGDEcOWgFUMRD+WebafSTiWxuRNJvCYjiQNGEq+kg1cUmRTFL7BORfH7NCOLg0IWbxnEsqhIWRRgUill8SedyeJBlXkyshgrZ740ZDGrR2TRB9lRnPIslEVxfF7lnm7JIoQ6tDhZ9Nqy6I2XRV8KWYRApoiQuGBW3EIYDZkw7t0WxUJKJnGPORLnSZS4bTLHqYuFtA0kSmZzYo2sK2KGRdeabBun25qqWlpaWui5DQJedHeO9TRzkCEJp/kCZQmWRdbBnOE6pxZIpX02XSCrUc6WWzRsUQcEFEGoaJhTY5hdVNHvolEUstjRsHHHLNXKkoCmXFxLhYpKYlBR979JrFeJNd0WeSvb0G24BmycyrQqCE0Boo+ExxK0RL7uo+nhpRG7M7uJNVw2KXKv5Id8X5YhPkaLDy4+ijhxIYUWx/yq6JlanGHSd6UnKdGR2E8sw4WL63yots7YgLiiS0x0iYkuMRFCZQKohwmgHiaAepgA6kGs3fmcGc8hNMr5sZC1CFA72gG11b9NSbpiTqTEWrocEJ3LYdLE3oXrq2gM0d3u4+w+rvzEmG0mFhCQmerJxKdHOXo57T6mnipF241U+RKRUWAag1QpiC/bMK020ubseQES7cOybg0qYoQyuyexr5GDxm6hVsCGeSrj7Ex3S19O72EdSfFZRzjSI3SP2eg5ckjP6B77LIC+s00Dj9Ft/aFDGIqxcUMB4FVX0/ih4GIogHiNnFJFhB4Bu6rnQTbgRDJawoKNV6qryDmIAOZgEE0D7bXoyWR0jhNgstBsiq+0+4NYZA/i2LhBhG4+28kg/lG+47ATA5xjeR1EaVOJx56RybJCw3IsJovq3LkfLQSVaJwJyNVHWtMcE02EfKgwe6B8oG2W0IXioipG2mfPgAp3Q10nsdvfdT1gp5tB2F2LSE8DWj0jPwB7JfiawGZ8tR8wBX6fka8hXBzlbHa+zpW6KMGkxqtUSnkRIIWhagEAYG5U0H+SzrSXl+6092lHRwdNNe3RsDXq8Ga+Q5kn8gf3POE/pHliZbrzRFrDf3S6ww9A8yTV8LOwdUzfD3/BwBn+7xzC8B97SMN/JU13/O9OZ/yP68b4B1MNvxK2ju/74Z8wuId/3CEN/y1pD/+hsHTK4Gbp5ENi6f+kzdLbaaqXeni4BNOD9Ad46QCrLNAttW4Yo4zoRMcsg5TKZfffZ/cftAqnfsyiMF6gbt3qBGqtMk13lNseHWSGuEG2v5Cmtx2tgFN4zwXDCvQvMiqwV7vRg/GKsRP8Snvgg4fQhftgjXpYfajsiT5UHl4fZvdEH2bbfZhxSH24icZ04tAq2dwTldwVW8lVlNHGFPOZvdBLwLgUZow18uhryaNhCgnan0swxmecaZyli5fhuCAQk0xVlxxyP9y9gAbTae391JM4tyfxuMaSYOnTBCxP6jp+mPRg4G1e64TYYUmrJTvMp4YcsxKLKulYU+tnNPRg4gOHaE8wl9P7jPzYFhObuocx1sSSt6aJ1hJhUzU5s4jWcOJgCLCKZ5/vizkSS+wjsUTmSoojsSR6JNYjj8SS2COxBL5hwpUGwBvGXI1jxpUxR4fq7XQrDX7Ep1tpMelWmp1uJcvGpFtB5ZqTbtUVu1qpO33qkNhFHHYR5JWRD/CqClfnIbyqAnCkCr6KAeFVIQsuX17FJLCuuvieoijNrMkxNnHvjxKdVBI6qch1uch/k91UYrZ8iAsvXAQZqBNp+XEU91m+A6Mt4LVoIZwU91q7fUWMjMghrbc4oNN33BfwMEigFKESkUBpv/1ABOiTHYwFTogkaRV6qYj0DgUPEHKtEQBbFthHXxU4EwuHX0P4Jo9k500VO19UcZ83hTOujomsUZvE0K1yJwFrINyhbaa26TGubdS4lkCUZ5hN4pSqAtQBJk/I6gFNvqUiR9HxHLMAoZUXq2xnyY1FuzNxtFelMhWpB9qV1xc1FXdzZpwbIPEGKrHBk9NwSZ13TRhfc0fAGlO+Ds4dpIT4Zbx1c+3f2QoEmapEvFUNGpoftbC+pGrRm41/vT8bX9CfjZ/Xn43X9Gfji/uz8dr+bHxJfzZ+cX82vrSrxm/R4MUbTYfju3nkFk5cIXtH0giZAsikiEFSv9f6LqQgGMvhEAT+xe/cAyj2+GW8Mtq4RHwx4EsVhb9wN8w/+0iKdtLY+ZQnNUS0g4hoBxHRDhsRfjM1s12494RnC9x74QsyiQ1PotjwTGLDkxhseNzzh3iCgNCAOQfBIkwoBisI0ye3/WXuSS6DjAThJ2CiiU+860bihmdDrjxFEHusrgkeXNbgg7cf+Gbmgq/pw1clQFoLCgTUQLEGrQrz7eW0DdvyoQAVKfrMopC+4LUIZ3XbjBMAkyrbOMFOL9hHYManiYn5YkwAoUaVqSheiMTU4SiKyAcUUeUyBYsbr0VR57ueuXcw9wZUusKZzF9gcerF4tQn6euztnjtbBEAZUn0TZgMBeH735h07qAQLqY4FedfogTKlZB4ZWyU/fHRIfEO0zjhjINnySEJLnUC63o76DUyRdDrj+kGvXo9MlBvNPRtZKA+ndY+GKSRAbp2IAQHThw6wYE1dnAgPMSCAyd2GRw4sTvBgQ5FgXd7pggOdKOTmGnZvfeDHl6wQLFDBaoNh0rccKjJQgVJ8FHVKMo5Z40AcOVEC+SxUq4BUJYLnSrm5YBxCFl4uhkcgJhoAUuIFjAZLRBvCtSSve1QjUYLnPcJEud9gjoAmIn3iTKIF8CB4oAaEy/Qd6ZjMXsyXnBpz8cLLuureME3+nMd8c3+bPy/+rPxxv5sfF1Xja/rxcZbaH+2vr5fW7+8X1vf0K+tX9Fl662ZoMEADhpgAqlETjvkuAEFt4NgJYMydNA+mEMHFl2bJHoAIwIBhFPoUAggjE0RQHg93QDC1b0dQLiKGptoWiGEFT0VQriKDuUYAhsQMYRJXa047x00MYRrqR1EuIYOsSjCpC6jCJMyUYTuRBGc9wN9PqMI9T0YRbiephNGOKVbYYRvUXccoTfd+xv6dXGxuV9b/3a/tv6dfm39u/3a+o392voP+rX1m/q19Zv7tfUfZoIJgz6YYEM1H0YwgUEwASrJBBP6PJjAkgYTmAgmyMjCIA8mFKYIJrw5YIIJP6LGbX0cTPjRkA4mKAMimFAydIIJrU4wITLUggklXQYTSroTTPjr5++8AgBeKQCw/nk8sdCTsYMtvRA7+HGfxQ7u6Ne1xJ392vrWfm39rn5t/b/7tfVt/dr6Pf3a+k/7tfV7+7X17V22fnsmdjDAYwfyVTCHETpQIHQwXiGZyEGfRw6UpJEDdAXl6m7QRw5OTBE5eHvARA5+Ro2f93Hk4GdpRQ4eHTiRA6iuiKmw3MeQQNJYgNq7oYCTh04oYKcTCtgx1EIBJ3cZCji5O6GA53o0FJAcPrFnIwBSqxTQKiXFi7wlKC8zxg3C5b4v2XLf10/L/Yd6Ybm/q8+W+w/3q/vf3q+t7+7X1vf0a+uP9Gvrv+rX1h/v19af6NfW9/Zr60922fqHKvMd5nLf2+Vy3wclfLhg5z5nue/D5b4Pl/s+7hXLfR/3iuU+foHlvg+X+3i3pyDP2tvDy30vTIheXOdnwafj+GUBKbrO9zqOn9de53vdjp83us5XnXW+Cu8tcK3x8Z6oq5DLYHGEOMhiljfGmVnuZb2Ky3p5EylnMziZmau5Z65xXa/hfdE1vI9nRdfwe1Ou4X1iDQ9vgRVreAA98NTh8Mg1vM+1hvd1ew1/tULVVGv41CudZOsEmmQNH7faQW2gKdbwqF3xMs7cMm5rVLyMx0QLaBHLiQsWtHxArBeI5ZG+hgNRHVAs/BJFvYaXUEAqKnjJIfheZ2TjW12K2FijPIGpPRsNuJl2uVxLbXiMZXJJL9ZrvxZLSyu68E78ApDfxgsJwpJMSnqya79Jt2t/7POuPZ1u117v8649k27X3uzzrv023a69nVbXOCnwYSKEiVEPpX4Wvn5GKYD06EJV10+HrkPwdGSdSV1FXLeYSoFvJl6EqFe+oWgFikVnccVSZsFKnhqKDv+9dulLjFjX+XQ6llg3+fQjKSEkhxByNplDOJlHLHIasbYJ+oM+PUshhPgIIZRYv/HpdDqxXvHpk+CuInzK5WQ5WUkWkRoSJsvISrKCcBImK8lKwslyUkMayMWklljXZeG9N2Xp4ygGxQhpIsvJMrKQTCINJEwmkWUkTBaRS8hqchIJk9XEui5b3JOtT4B7Cgkhp5MVZDGpJZcRTlaSNSSMn0sIJw2khqwQbf0mW6cnEuuVbD0f7huZ0Jas/1Yd679L14+Dcsck6VOYLCeryRL7jtd05Ms7up4FdzB8EusTHdvblKMXwNWxsp9rSQ3Wthg5UYu9C5OlxNqWg+UfdJWPtruahEkDWYal7VZzRKs5OqXE+kT82pSrZ6lybBixbs3VaSOx7srV66DOxYTgKHzFVVsRGS/5tJgsQw6K0VlDLsHeAS8vIWuwB5wsJLXyb5hcSmqxBCcleNcKfKZSUk6sW4cJHg7TJ0K7x8c8yxqUieVkElmBrUBtDc5TDRNPNSzKy2JifTJMv0EpJvBvMikmJaSYlJJiUkaKyRRSTMpJMZlKikkFKSbTsMRk/FdCJpNSMpmUkclkCplMyslkMpVMJhVkMpmGtZRgKfhXSkpIGSkhU0gJKSclZCopIRWkhEzDlkqxJigF/8pIKZmCT1pKppJSUkFKyTTsTRm2VoIlyvDfFFJGykkZmUrKSAUpI9Owx1OwRyVYyxQsBf/KyRQylUwhFWQKmYZPVY69LsGWyrEmKAX/ppJyUkHKyTR88qn4ZCXYm6nY2hQsMRX/VZCpZBpypwKfvgR7XIE9moK1VGAp+DeNTJNcnCaffprs9TTZ2jRZyrruCJ2NVYl10xH6VT4YLaISku4oFZMaUkwWkmKyiBSTxaSY1JJisiTt0ZtMashkspBMJovIZLKYTCa1ZDJZkvaolpAaUkIWkhKyiJSQxaSE1JISsiTt0S4lNaSULCSlZBEpJYtJKaklpWRJ2lJQRmpIGVlIysgiUkYWkzJSS8rIkrSlYwqpIVPIQjKFLCJTyGIyhdSSKWRJ2lJTTmpIOVlIyskiUk4Wk3JSS8rJkrSlaSqpIVPJQjKVLCJTyWIyldSSqWRJ2lJWQWpIBVlIKsgiUkEWkwpSSyrIkrSlbxqpIdPIQjKNLCLTyGIyjdSSaWQJSlUNSkcJjlANcnoKPm0N9roC76zBfwtJDc5Si0kNqSU1ZAlK5EKUrBIc3YU4SlOQUwvxiSuw1YV4N/xbRBaSxWjFFpIlKM2LUCpLUDIW4QhPQS4vQm5VYI8XYctwN/xbTBaRWrKILEFNWIwSXYJStRilYwqO0GLkdAU+7WLs9UK8czH+qyWLyRLUolrUhhKUyFqUrCk4urU4ShXIqVp84oXYai3eDf+WkCVSC5dIbVgipXKJlI4lcpSWSG4tkb1eIu+2to3R6fnEenCMPgdswmy04JNRm8pQDqfiCNbgsy/Guy4mS8kyEiJ1ZDm5hKwgK8kqUk8acM5ZQ9aSS8ll5Bvkm8S6Ll94KPl6liZnOYVYP8/Xlcg/g8Tak6/79+744PITX2pvOXdqUeHP/j0dva4WIB7I1/2++e27nn2xnX+0/xXfHWN3IbEaiOvH6v75M/2Xrn2x/ZK5v3jxxwsLBLESiK1jdf/HE6+6Z8yL7S9evP22N6546yGxh4dtfka87NLvX/TwC+37vzD+u8vyVXEnwTbH6v7qsY9cW/NC+2+uOHP2pFeOPBVp+/8BbR6t++/auLFYfaH9ZP3yv/y96jXR291AbD1a989e9tUz73y+vfp7X974+H1c3BkB4p6jdX/LTT/8/WnPt3+n5VcvnPX14wSxBYgHjtb9/MDO1995rv2VCQ/cfMx/HS+I1djmMbp/0x+OXHD1c+3B7b/9xcin8lzE1hTESmzzGN1/2W//Y41/rn3t775SVLhglHhOjm0eo/tvWrbnpr3Ptqvz3l760L3HSiZgm8fq/rt+8pPzL362/eBdl5c+fuyxkgkfQpvH6v7ZP/3Xtdqz7UsWaP/32F3Hizt3A3HPsbp/8+rXC7fsax+mfNj017ocQYwA8cCxun/fz753XOW+9uaJH972YPnBh6LE9Tw5sQXb5Lq/8sJLRu/4bftV02/+yQlfy5VMwDa57q9+7df3HHymvfDejbc+cPwEyQRsk+v+gyes8I57pt3oCM6bM8kvmYBtBnT/7jl1gfOfbs9f+tQvv70zIO4k2GZA90d++MRHN/ymveyK25fO+cY4F3FPCuL+v0ObAd2/eWJ44yO/br/hgWsnbz/7KEHcDcT1pu7f3XL2k39/qn3J5qeDi87eKWQoAsRWU/dvf/3Yhwqean93z6zXFl933K4ocU8KYgu2aer+uR/euuCcJ9v/9MIe9f89e4LUFWyzQPfv47WR5r3tWf9+tbl9l80hbLNA9+832NU/eaJ9/hlfadj8qpu4JwWRY5tQ7VFvD3/p8fYlr//PltAbhpQhbLNQ92/euqq441ft0+Yat3/xtmNcxNYUxP0fQJuFun9765/ePP5X7Tec59187R+4FDAgHijU/S2/Xj7hrMfap182pWZPjv/UKHH9ccmJESC2Hqf7Nx/DP6l/tP3keePO2njZ36SpwTaP0/0Hj/34nO8/0u57rN5ffH2hZB+2eZzur5704gkP7Gm/ccuI0T9uOclFXH98cmIltnm87t+8r7Hp5d3tH573zqYbl2WfGiXuSUHk2OZn1e5/dfK332tv/6B0y/nz1sjBJkC8fJw+asIK77iH26eTgyecWHbCqVFaW3La/r9Bi+N0/+7zbph34UPtnocvmv+1nKMlZ4F4YJzu33/GyZd8Z2f73rvPe2fKNGmikLi+KDkxAsTWIt0fmfzSzEcfbF967qSzxjce6SLuSUFswTY/q7b6zWueO/iL9t+tLn1y6g+kLanGNsfrfu4JevN/3v61Cx+vOY9JK4TE1hTESmxzvO7fn3/jy9b97X888l+/+d2FJ7qIB1IQObZ5gu5v2fLX8tr72rO23LD2wsaRkrXYJhBH7C7Ovrf9298q33Db1ye6iHtSEPcfhDaBeFT976t+0n7mqpfe/OblY13E9ROSE3cDsXWC7t9d8s/54a3tf239oGzWJyfuihL3pCBGsE0gfrrjqtu2tN/96fH/eID9Y3qUuP7E5MQWILadqI+6bNgtl9/e/kZWU+PxLeN3RWmPJKdVY4sn6v6WF735O37QPu3Of3933vVFUhWAePlEfdQn2+/afUP7rXc+/8/GY/74UJTWlpzGscGJ+iij7oT9ze1vVP4uN/j6UbuitNeT0wjQbjxJZ/D585N0Zff7UNFJ+qir1+QZLcF3Jvzo5ronpLFqAdqBk3R/y3fnn8s3B5/76HXPea/ZzgQQL5+kj3qy6LjTbwqW5Swo2RmRlpUArXWS7q98++oLrEjwKy//7fzdI6gcu79Ci5P0USe98NMlPw4W/d+uNatHydFpAdqBz27cffvIu793V3Dd8Qv2ff8bsu+VQFxfrPt3//7p1b/eFvQWvXLaB0vHyIcGYisQPbsnv/vT4H+d8uScL4wYJm3nX0AiinV/9axnT/nBfcFbbss994ISewIB4oHPiPuf3fqPXfcHXz771Tsu3CslvxqI6yfr/sgPzlrw558Hjzn6gumeZbK3lUBsnaz7d7+b/Tx5IFjylx/99/XHvCfEhWCbnxErv37BhaU7gr87bdfJ548okDx4D9qcrPur77l+b+iXwTeXfjShZfORskNAXF+i+ysfovM3PRR8ftuCx5+dZTs+QGwt0f08e8O0Jx4O7p/51r1Ld0+UHQLinhIwj9O+/U578P+yW+e8VGabR2wTiOMu/5Z/T/AD78RnLntfTuv7/xfaLNX9BwuaJty9J1h2c8WMb22VTIgAsbVU97dszKl59pFg68/W/3r5jxRprIC4p1T3b87b/knto8GrG75UcNekxwUTKoF4oFT3by/dcOq3Hwte9ov/m/eNDdJAcmyzDGa0N94c96vgE+uWvflOqXzO/e9Cm2W637ju4bO/9njwspOmn3jtb21vAYh7ynT/qjXXHnHw8eCBwK1vXj/CHk8gHijT/XNnXHn91U8EtS9+e5WxxPaPgXj5FH3UtP+99+G9wWdP/PPd8071Su4BrW2KPuqj1xYseDK4siMyv+gDr7Rj2OIU3b//mul/+e5TwWWBc+d+sUEq8f4/Q4tTdP++8772yuRfB+8+sO3s66dI9243ENeX6/79p1Rcte/XwV8cMe/rj31JDlgEiK3lut84+Ph/Vv4m+NyEG3/V8N7fhI5XA3HPZ8TNL2w/9b6ng1O25310QodUsUpsE+58u2PYV54JFn9oVY874hHBdg7Ey6fqo37/xj3/eCY44lu/rM0LPCVqJdjk1M+G5P7lY2/+bbD4jzlPvffrfMnYd6DJqbp//lnVFfX7gt8++y+jXr31Y2kdgXhgqu6vrrl44mP7gn9+d/qoa0dL764FiOsrdP87IF3PBscevGPRsIBUlGogtlbo/o+3/fr8umeD60fd8dHTP7SdKWzzszuXLlh0c/uzwQd2nfblv9xpzzzYZoXuf3DYJTNHPhd8d+esnX+4SnoD+9+GNqfp/s2vNR58+Lngh+rcM/59q5zVdwOxdZrur37+wN9GPh98cHrg+W++LkcsAsQ9n91pPLz24rrng3sv/dv2p1eMkI8CxAPTdH9x6aXnPPJ88Pxdnl/MO2W01D9s82Td/86LBT876oXgj/Zvfq/8DZ98FGzzZN2/t/6R6+tfCK556eKsZ8ZNkhYK2zxZ9xf7b9v/5AvBH7+SnX81ly4RwTZP1v2RCu9PzReDX39i8fpVD58kn/MtaPMU3b9v71c++q8Xg+9XXvDXv9wjZ/XdQGw9RR9e/fU/7nrxxeBrtT/2naBn7yLWw6foHww/GFzRvmnMnFNumT6l9D//feo/3w9e8Nortx5ZXf9QTculX/jhe+8Hn11ylfHNCzc/dGXzinfy/vR+8Mh/XjzlnOeumx6+Mu/57f/v/eC/v/WvgpZnrn3oD//8/fi6fe8Ha/a+VXP2R9XT996yZvTMJ94P3vx86XlvbNk8fcPfH3/qCw+/H7zkvzZccOf/7+VJ4HLMvj5vCvVGREYMJUOSpAXhye2xMzVlEtFQtEmrViSSdmkhQ2Syy0ybvcxjXsZElLRYikrZ2p+ntKe8X899n/Rmme/7f9/v9+mn53fPvffcc+8995xzzzm3o4cJubAOJ/OrDOpiug+MuRpJtC11Vz+QxKD8eE03/b/mE6fyC7XrTjOI7xIdpjtgCzW28GOq3TEGDb2pOfXn1YeolRbyebyDDDKr+SmC8TehcrScbt0MZ9Co5icZE+/HUOUaF1KOBjAo1eyX6teF/sTKyLNZR3YwaNnBszUKY/0p35V+RLo7g/S1y8walKKomv0Reh1bGCQwHYEiwvYRXtmutRbWDJpcO9w7vvhX6vEvkoHlFgyy0pw7v63uKPF7xmatkFUMOq4XnB1QGUWNK+5SMTFi0P475xaRruHE04hNofOWMMhP8k2a1A5/4tcSv5jliEGxiYmvuyN/JfQ2ebns0GOQ3zLP96M3hBDo3CXjXC0Gva9UOqK+1J8o3fnKdrE6gzYM3op803+l9li3VLz8gUFaf0g7V7QFEBVlSi3HxzOoU+A65tgEfSq6+Hne7tEMuiIj6x4wex/BH/DmXJA8g6Kyc8MOjHQhVmvOv5Aqy6Brf6QZeRntJRSua8l8HMggQ8+kV7wFwYRWkWGXG49BK9oL188pjSKEo2wuDe6ikaRF5Dz/08FUY8IBy8xWGm02+TGnfsUBKvvC3NnnG2kUqbFybPugOMquSMo5pY5GBbNi51flb6XaEt7qvqikkcLY3MuKinHU28QRdzRe08jZcOr5ZQlBhIquvOG5MhqFO0zZYSV/kPreP0ly8XMaWYR9tyzqvDk1dXrbBJmnNBp7dLn9sWk7qcOJJsUt+TQanvS3Vb31QkIjbKPV4FwaMTYD50nb/UqsgXH15AMabR9w8nlFjguRR9y+euoujWbIy6FI4UGirPBZw9Q7NEpL3fFnbrQ3oTp11pPnAhr5lK+qvTnuIDGktDvuEkWjyNNbQTc2ijo/7bj3pQwaLT99sCSnLIRaYPfo1PNrNLLUk7t5t2wbFWB8fLX6FRq1/uJbt0Q+mJI7sP7BmYs0inzWPVpq5kHiuerVWUtTaSR1LFzz+hFfovve4cfyyTSSXvX9qwrraEJt1bLSQX/QqOauoknQPV3i+pK14ZMv0GjmLRv1d9qxxLIJyQqu52mU4B23ccWbCEq6xDuj4iyNEo2YeZk6EVSQ2dy0XWdolFKtHrbNNJBSvpOju+Q0jczNV28rzT1ITVIxC9A7RSMbxV3+vw9bQ3hcMHxsdpJGU1Q2CJjLB6mH83bb/XaCRgEZuiHJ8lsowXO+l/wJGtEXnNMZe2tKc4wtcSmBRitDy1fpl/hTgbErO/wSaPRo/rpdNkrbKE/LuiqvBBql+e27tYIOpjz3nF12NIFG4e/MxmsrBlP37Resrk2gUeFj6Q3Z8dEEWl9m7HCCRuPOGmWUaPtSIbxaj5EnaeR4y35Vd10soX17Bq/+JI3MnJ7+UVFrS2z66dGsplM0WvDosmbmyVBKfsz8VapnaKQ7e17jNYeD1Ihcw7iwszQaL1ScG7jBn0q+N3HJmPM0clnjXmTyOJaqP7DoWHEijSB8qIV9cjQRZxdefO93Gl2pabiteX0/8eLE1AVvk2gkrMyMt7pmS0UsujpKO5VGiyyb1u5t9SVm+SjEpVyk0V798eeVpA9Sd4UxfIsrNFIb77Qv/cJ66m3mw7TZ12m0NiN6Z8dEJ0ru56zsRTdo9HtHs8rChQcok5/KEgJu0ujHSLtnTg+CqBuDHrg13qKRam6MelfqViK64XRAzD80+tNDpmJmgTMxceJrRessGlmrbFKRzAyhbN+u97XLodETrVevg7/fR+horKg7lkcjhT+pwvw/Y6j1k+ZfGvCERgVadLxWTjRhfnnGiN+KaXR5nYdLoEMgIejebuZYRqMrxyMPP3wZQO1oKhQ4vqZRiE72AZ8xEURy4bq4hCoadRbnr4jyjabsru1XG0TT6EZKyeriO2bUBwXj9FNNNDJoPac/9Ew0NXft2/3uHTTSPZis1/x0M7V0w4f33kIazQw3d3xFx1ArBp6ckSbFoIelljLPhJ5Ewe0fo8fLMijpyIHODzdjKOnxzyz+lmfQZdnUGSkuHkT8z0GlxxQZFNud8Iv260hiR57Q8g9lBiWtlc6PKg8kfsxfM71RlUH2Y37SS31oTVytHBjrrMmgzYoHnKY52hMO0UyJ8mwGFVzN2Ts63J/qvLPejI8Y5NopROuTo6idYYNWaCxl0PILXnopQ6Kp92FDBocYM+j8IP1zQac9iZAzH0pGmzNITsVA+beYAOrI3vujXlsxKOnA7Scm6yKJIO0XA945MOhHR17S2rmBhNUVXtMEDwYpzb8yaMKTAMrymK/O4Z0Muj9k6byMqWGU2smWkUuCGVQYOtdK8pon0Yr2VU6PZtBW9+Mr6zL3EnsN731YeZRBDTGFUfJtUdTz6DOnUs8wyM9z4qsjKfupRvtIjWWpDBqs/DtJ3YkkVNdtpMfeYJB27YU7seqBxOEbjrPVMxlEB+VrXbAJJwwWu1h45zGo/vW8NzdmR1Ij/4pP7n7BoOMPY4zmhfkQRdG/7bldyaCwHCvytpQp0bg1Sv3vJvbmRWUD9ixnZUNf4FELyBIOXiUO1wayi4OH5ojBdYCMzxHBE8XhukBSHDxLHD4TyBIOXiUOnwVkFwcPfSgGnw1k/EMOvzhcD0iKg2eJw+cAWcLBq8ThG4Hs4uChuWLwTUDG53L4xeHWQFIcPEscbgNkCQevEofbAtnFwUMficHtgIx/BDg6kPQI+AsMei7XboMA8iYBNEwCGDYZYMZkAJPJAG6TAaJ7ymk95byeckNPeZgqwAxVABNVADdVgGhVILtYhGyYPQ/4CgMBYBgApKmK/hvgMpmUJxo0PQ/4RiwxS3qudmx+AhvBZmMMi8ABPHAcxB1ccJSajcyvxpF6Lxzx/jwCPh/0QZllkIh8EKUj5ANfi8U9FS+wB3iALY5tO8F20IRleAQ29m6PY+3OvfHuHLZ/PJBF+cDfx2MRBALgcAgbFBGRtwp3sQZHHDT5n5HGhuSn4hSD/2SaU8R6knUFoj1sLwA+nyeK7rLvloCMKBTVHCkEvvxwLlWkfIrILPdXAzKJbbATyPRC4Hvw8GpDv2i/MdiBKZ4kS4gdOOB4GJtt0EfOIlzvgNfpv89BmCGWgzATyLTHwPcf3J500XHKD20I0h7SltIVgpM5BXZtFa0I8rxvxgaWC8Ifzxiqf7IVQXtVykJeuSDIKU+7bmMrAgP+rMyPZYL2I8MPdU5sRVB+fUxxd6nASeLRGYvKFgTR92RThCWCdOMJ66SSWhCc6B6uJ1kiGO8ySq5+awuC8rna9vwXgpnt/LXSc1oQpGms01R4LihN3lhvzOupt2pft3tCsSDPd1lk+oNmBNFb04xmFAloY50rcw41Iyi/0BFGPhM4PEl9mc2GJaIVr6qbPRWYZrz5yU6jpzzs2KmJjk8E54rGDed9aEJwwlLOdu9jwSxz2euH7rPl1tnVxwsFK7qvrfg+rgmB1X7TkzcKBFfjymUjHZoQGDww2FucL7hUOSLgzdye+nKDuUGdeYKLN4MUFYc0IZhRqR0/Lk/wbOulB5NYN7pV5ym/oFxBwMMRjySvvEfgr2+dVZgjMMneOS0t9D2CEyMNB0zOFrw1irVW2dDTvtxY8/ud9wUXFYL1V+v2tAd/JPH0nkAvdf7rJXy2XmrMeZ27gtLTD7vpV40IYE11S+w/ghlz+OYr/mxEcKL8hzcdfwtAZXegaWwjglvd69Zuui0gnj25NdClp73/Ta+j8QLB32+uL7VcxtZ3WKzxpQT5QZBsPpGtb5a7a5UhUFUxlWv42IAAri19ZXhNEDU3z0f5RQMCA96lbeiyoNh/7dN313vKtxaM8dNLE+w38P04/xDb/urgA66/C/bOy3wwyYMt+xgf2nFG8MvYIW8Or2TLspmJE48LTkUq346ZwZa3qU3eEiOYsOvypGHD2HJVUbuyj8Dx/IOOXay/EEwumn4MRoGNrYW2i3rK/nIVOd+fRLuHBSYMyqER+O+L6DJKQlXrDsfNXUMjMFgzXvv3y+id/s2Gp2/r2fq8E6Mz0GU94Z5rPvUIDCSfV7v/hRZWG7lfla1HYLXbpKDkNrL2Glpy6UwdghNlA/7w/getzH5aFYl6ysqvfBYOuocMZSWM1UtrERhc2FcWeR89ULACJ79aBOUFW9KH5KAonekus1gnU3luqkxgLppjojbZLbMGgb/9FZnteahUS5XiOdcguMXbLJWUj/Y1IqpwVA2C8o+Ph78oQMkf7Zfn/12NwD/zpyUDHyOJuJ3Nb9yqETTMlf5L4wl6TwXM+cC6WvJMlKNXPkWNa9tCeIVVCBpqHhZsfYacWzNq3wZXIYj2C4qPLEKxGebXDhNVCKwqzHiJxUhl2F2hVHMlgrxCl9F/PUcPFEaOVkmuRFB+IuV93gsUIfyto8S+EoGBQP9MeQkCMq2ElQORMhnyoPwOSV1bNPAPyTDinO4aSbB6hy60bao5JtxIZL6fdEeY8A7diCayH+0KICTXZeixPoTJBz1WhwpDidexceVCpUp0McBS1aA7nBg2dK0C69cg90684tXtTj2xsJVnPSTe6j/sfDd4G3Gueq0262u5rtI6+c3gTVTBpSv1QqUqpHn/7PglEoHUna5ODdbFo3T0/anmNmfCxDGiTZhQhboPLZc2lYyk7BTs50B5FVrse++vJslwavF3gldCpWpEKA810O30ofITfskRWlaj9Q4npPyF3pT90hvzWM/YgF11//zT7kac1cioFL6sRhJLIpYW744kUrunPxMq1aBdKQ+NzGS3UIeEkmVCyxrkeKk64oJfMKG+f8MDYUINKhthePV+YABVMyC5VPiyBhHTrWqy5M0JI/0hjUKlWhS/TTW5tDOSWjdqQq7QshbNlr+r+F22KeH5zqRYmFCLIDeWLG7zIFIT40ewDtJbx9ZP+EfGi4h7ucQClOvQ/dvVpudoRyKlLcOA9cs+dVuhmjBoJxXebbaJdeIqGVZ5G/B3UOulDYuFL+vQs6tHO3Q6QolHT706hEr16K8KS7vB08ypg9+vPiW0rEdNhwqOTZH0pWT3qRwXJtSjWafkdFdKhBCjdlG2rAtbtujMqPE8LypmaasE6+8u38RIa/qHEUXnnq0BKxp1tsmae/F3UbK36lXhBI2GH1ksvTcwgtqZ3eIE5TRq9lY4pOofReX4qW8DZQZFmXq6F++JomQWy04GKwaVCFVVYasBpfMkokqYwKC0xO6KkrHmVFiw3BPhSwa5RMZkj+kIIewnqkmyQYY9S7Rtm3YfIzY/ff1aaNmAfA+llA7uDCbWnA+SYUMpMR8K/cteraFykOUYNpwzsiFTSicghmq5kdouVGpEf9/wt/uzcx+VHGP0VmjZiJjK2d/J7z5OVcxKGs4GyIQto6RkIJ5YtiBLkQ3SnVj//M2HgGjKZcNHOTYSuPBDvGFedygVU5QwmQ04BuTHbp/6MYJ4/u6cGhvXzNy3YauHhBs1Z75aufDle9Rx7tLzOTuPEQENJW1CpSa06ucSF51GP8Jq37oGoWUTqtV6aLh6wG9UTsrQ6WxY2edM4Y+VDV7ErEvzJNnotU7o8ZHZfvGEMCRfgg2ST9HXeJQ6eBdxcafeEDbcfi7ONmj24AAiLGG1JBu4L6CMo3/pDKOaFs6UZPMD1Ey/q580fBslt1siR6jUgkpW+QQW7T1CuF4O6RZatqBBU/K0KqVDqBtt494LE1qQhK/75oS2EGKPblet8GULml89Y3q0fwwFJPUG+LwIILPeAH8vtrN2/od2lshAYZNT+owQAttM/xtbSw3InLci07HoLXwtTZLFIkqftcYpmSxt2z8lwb7jzM530Jem6gUuOAnWDSf1eOK0HmVsdrHpuGTOO5EZXPQO+D/yuKzkL03Vn3FvV3DnUor6aPaA5RirO6bLtS9pM6mSM7Argb+cxbwAABbitF9r8MK096aSGoErTjTtNfn60oMXwza8Xm6fYGREFfB5hkAeqQI+yeKd+1myrzGX7GuMk30X4ORfttbj6/hKWHxOQFZVAd+SxWeOE5Q+N82VMb3ia6DMpe1+mxPYlbfn5uMNtjAdyJxqkZVcVA19CdXiHEXWVYvWrb0a+KZsC0NsYTtg+kWJzB44Vdj2U0Lz5q9Qy1LqjfdFRKt40nMNt+c1YlcfZfDB2J1w696+dhz/KoMHbMZz98S0uOA9t8dtRGN5YRiZVCs6Uum1wN/O4nbHuMV/xGfb+2OCMVlzHOGAzwWbYu6K+d0J840Xxy1aoAlTQAs0vtpLDWRABkiqTsQlWXXAX8jSQXyVr7+G4Rv8HFHP3W/qxW6v04FM4uDp4nAZIHPqRZfQonrgK7Hw0QAwESzACKfZuXyauz5ODK8Xnd1QWuzcTwNlnJZtA4vAFrzBod/Z+NSXokUjZdHQlya+HmS40TbiU9FvtDpaNFr756P1rbj4rvbrm8SIRktnvjLaAvDCstKWu6DhHiWMaLQq5ou5ecGmL/r0Gy2+gfM9NIjdN9fjHWZrkoDMagD+aSy84wFgFRbcyngamzn2/NrxcMBiiGVDGyzExA+zB36XsBkvtjLY4PcJvQfbDt89Rf1FrUQH88sxVDG879hNB7KuUSRq2huBb8HD1H6NKd04hWOL8zl7hTzLrH1w8hNcJFI9sfD79F6h5D235O+h70VEnxrxhO1YIdh8qUTim0QHJ7EJ+Po87Hhi32544hGcOcHJzkgZU2ON18sDl3rXpVcQk3UcrvYm4M/k4eMi2nhWPG7HdIvEqAMWLF54BwzF3j+wzN3MMXcz8McM595opM3hns7MFX3cBgJZ18zxdPNXNWffRDeBF05KFXtgkNTCSa0W4Puwfd0A8FQ8cKteremBpeHn0xSXzF8+MVHG7gpvziHhBu5Ytjp80iHOmAEcWSqoVtEMslqBr8PDSwVijLzsG1K+94xOAbKrlXN8tQF/HIthFAB+yiHaHHF9RSa1iTYnvQ34iIc9hn16pu85jvunw9Cf4V2xdhMxOTtyG+fbaxeTgmpAxreL5pTYDl97zmODKduIV8QWfD6xb7vIVVTVDnxXHrbJWNtBXMPa4gPsyunBb2lAF4zdAVtbIqb9XCeLryE3l5IO0SpWdXx1FfuxeESnSJce6RSzcqZxWEU2jge4cazeS4MnJ6TE90OcYyyArOvk/GydYus5DciID5yN9wH6nlZ9KUL6Vqff86CcD5z18eEbPro6rkH7txpEdHFasOtbXj6uQfq3GuR0cc7NLnHnpik2L3rNDxes7kTMJzKl2Lz2LZy378tlFJcfytg82iFmHm3k5LcLaPSTrX0sIpKdZF23iO3au4Fvy1K24Qu288Bq6ssxxV9tTcNjenAm41ZOp/QKEaf+8q3uI6cTPoqZn73H0AOLByfc58uDKGLe/qb0v9HFqmKhiF2rhGKm3/9VA3HMRfnz8Opl+fO+tXpuOIvfC4sXT25fe7H07tbnc/63GZHUHh5mpqw9PH4QZqZdYkaAuKQXKXKRcu8lp7+EEDHK16TsFNxDud8zPWv8cNERyy3WLOi9ZagBWRLAw5ZJVQCPfxwT9ev/E1Gr8bXz88P/r8RGBIp27Uggr0/U+nDXHPGz9LmvXRvzuS7+rYd/u+IZsTQ4Y6NzDYfFlMPBXtIWwHa885yojQjiYVF7JIjHV2BHH8qJ2k2f2pEU24ZVi0G8vmiKMWyCLdyVVhmvgDs2q20wJ7nhmbuI+LSL6x8azOsTmf37O/TbgX69bwXz+EPmcIpL9EfayOZgHl9Bgux9vSsSzuw/PpCxITw+zwbIRPY7BEiK/SoDmRPC4w+XJHtxfMJVxdZ/B2Qz+z0DZGgoj89TBDKR/SoBeSWUx5f4gQdkFguYAGQV+1UFshlXSAAZGsbj89SATGS/WkBSYTz+kD0cVTwJ/OaziK3TAbI5jMeXElE8eZiHq5e7ta3RRjc3Bxd7s58NR07XdHXzdHB22GFrM91no4fzdOeNbv8Fu4lUDg==`;for(var toByteArray_1=toByteArray,fromByteArray_1=fromByteArray,lookup=[],revLookup=[],Arr=typeof Uint8Array<`u`?Uint8Array:Array,code=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,i$1=0,len$1=code.length;i$1<len$1;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;function getLens(t$1){var e$2=t$1.length;if(e$2%4>0)throw Error(`Invalid string. Length must be a multiple of 4`);var r$1=t$1.indexOf(`=`);return r$1===-1&&(r$1=e$2),[r$1,r$1===e$2?0:4-r$1%4]}function _byteLength(t$1,e$2,r$1){return 3*(e$2+r$1)/4-r$1}function toByteArray(t$1){var e$2,r$1,n$1=getLens(t$1),i$2=n$1[0],s$1=n$1[1],o$1=new Arr(_byteLength(t$1,i$2,s$1)),a$1=0,u$1=s$1>0?i$2-4:i$2;for(r$1=0;r$1<u$1;r$1+=4)e$2=revLookup[t$1.charCodeAt(r$1)]<<18|revLookup[t$1.charCodeAt(r$1+1)]<<12|revLookup[t$1.charCodeAt(r$1+2)]<<6|revLookup[t$1.charCodeAt(r$1+3)],o$1[a$1++]=e$2>>16&255,o$1[a$1++]=e$2>>8&255,o$1[a$1++]=255&e$2;return s$1===2&&(e$2=revLookup[t$1.charCodeAt(r$1)]<<2|revLookup[t$1.charCodeAt(r$1+1)]>>4,o$1[a$1++]=255&e$2),s$1===1&&(e$2=revLookup[t$1.charCodeAt(r$1)]<<10|revLookup[t$1.charCodeAt(r$1+1)]<<4|revLookup[t$1.charCodeAt(r$1+2)]>>2,o$1[a$1++]=e$2>>8&255,o$1[a$1++]=255&e$2),o$1}function tripletToBase64(t$1){return lookup[t$1>>18&63]+lookup[t$1>>12&63]+lookup[t$1>>6&63]+lookup[63&t$1]}function encodeChunk(t$1,e$2,r$1){for(var n$1,i$2=[],s$1=e$2;s$1<r$1;s$1+=3)n$1=(t$1[s$1]<<16&16711680)+(t$1[s$1+1]<<8&65280)+(255&t$1[s$1+2]),i$2.push(tripletToBase64(n$1));return i$2.join(``)}function fromByteArray(t$1){for(var e$2,r$1=t$1.length,n$1=r$1%3,i$2=[],s$1=0,o$1=r$1-n$1;s$1<o$1;s$1+=16383)i$2.push(encodeChunk(t$1,s$1,s$1+16383>o$1?o$1:s$1+16383));return n$1===1?(e$2=t$1[r$1-1],i$2.push(lookup[e$2>>2]+lookup[e$2<<4&63]+`==`)):n$1===2&&(e$2=(t$1[r$1-2]<<8)+t$1[r$1-1],i$2.push(lookup[e$2>>10]+lookup[e$2>>4&63]+lookup[e$2<<2&63]+`=`)),i$2.join(``)}revLookup[45]=62,revLookup[95]=63;let ID_OFFSET=-8,SIZE_OFFSET=-4,ARRAYBUFFER_ID=0,STRING_ID=1,ARRAYBUFFERVIEW=1,ARRAY=2,STATICARRAY=4,VAL_ALIGN_OFFSET=6,VAL_SIGNED=2048,VAL_FLOAT=4096,VAL_MANAGED=16384,ARRAYBUFFERVIEW_BUFFER_OFFSET=0,ARRAYBUFFERVIEW_DATASTART_OFFSET=4,ARRAYBUFFERVIEW_BYTELENGTH_OFFSET=8,ARRAYBUFFERVIEW_SIZE=12,ARRAY_LENGTH_OFFSET=12,ARRAY_SIZE=16,E_NO_EXPORT_TABLE=`Operation requires compiling with --exportTable`,E_NO_EXPORT_RUNTIME=`Operation requires compiling with --exportRuntime`,F_NO_EXPORT_RUNTIME=()=>{throw Error(`Operation requires compiling with --exportRuntime`)},BIGINT=typeof BigUint64Array<`u`,THIS=Symbol(),STRING_SMALLSIZE=192,STRING_CHUNKSIZE=1024,utf16=new TextDecoder(`utf-16le`,{fatal:!0});function getStringImpl(t$1,e$2){let r$1=new Uint32Array(t$1)[e$2+-4>>>2]>>>1,n$1=new Uint16Array(t$1,e$2,r$1);if(r$1<=192)return String.fromCharCode(...n$1);try{return utf16.decode(n$1)}catch{let t$2=``,e$3=0;for(;r$1-e$3>STRING_CHUNKSIZE;)t$2+=String.fromCharCode(...n$1.subarray(e$3,e$3+=STRING_CHUNKSIZE));return t$2+String.fromCharCode(...n$1.subarray(e$3))}}function preInstantiate(t$1){let e$2={};function r$1(t$2,e$3){return t$2?getStringImpl(t$2.buffer,e$3):`<yet unknown>`}let n$1=t$1.env=t$1.env||{};return n$1.abort=n$1.abort||function(t$2,i$2,s$1,o$1){let a$1=e$2.memory||n$1.memory;throw Error(`abort: ${r$1(a$1,t$2)} at ${r$1(a$1,i$2)}:${s$1}:${o$1}`)},n$1.trace=n$1.trace||function(t$2,i$2,...s$1){let o$1=e$2.memory||n$1.memory;console.log(`trace: ${r$1(o$1,t$2)}${i$2?` `:``}${s$1.slice(0,i$2).join(`, `)}`)},n$1.seed=n$1.seed||Date.now,t$1.Math=t$1.Math||Math,t$1.Date=t$1.Date||Date,e$2}function postInstantiate(t$1,e$2){let r$1=e$2.exports,n$1=r$1.memory,i$2=r$1.table,s$1=r$1.__new||F_NO_EXPORT_RUNTIME,o$1=r$1.__pin||F_NO_EXPORT_RUNTIME,a$1=r$1.__unpin||F_NO_EXPORT_RUNTIME,u$1=r$1.__collect||F_NO_EXPORT_RUNTIME,l$1=r$1.__rtti_base,h$2=l$1?t$2=>t$2[l$1>>>2]:F_NO_EXPORT_RUNTIME;function c$2(t$2){let e$3=new Uint32Array(n$1.buffer);if((t$2>>>=0)>=h$2(e$3))throw Error(`invalid id: `+t$2);return e$3[(l$1+4>>>2)+(t$2<<1)+1]}function d$1(t$2){let e$3=function(t$3){let e$4=new Uint32Array(n$1.buffer);if((t$3>>>=0)>=h$2(e$4))throw Error(`invalid id: `+t$3);return e$4[(l$1+4>>>2)+(t$3<<1)]}(t$2);if(!(e$3&7))throw Error(`not an array: ${t$2}, flags=${e$3}`);return e$3}function g$1(t$2){return 31-Math.clz32(t$2>>>6&31)}function m$2(t$2,e$3,r$2){let i$3=n$1.buffer;if(r$2)switch(t$2){case 2:return new Float32Array(i$3);case 3:return new Float64Array(i$3)}else switch(t$2){case 0:return new(e$3?Int8Array:Uint8Array)(i$3);case 1:return new(e$3?Int16Array:Uint16Array)(i$3);case 2:return new(e$3?Int32Array:Uint32Array)(i$3);case 3:return new(e$3?BigInt64Array:BigUint64Array)(i$3)}throw Error(`unsupported align: `+t$2)}function p$2(t$2){let e$3=new Uint32Array(n$1.buffer),r$2=d$1(e$3[t$2+-8>>>2]),i$3=g$1(r$2),s$2=r$2&4?t$2:e$3[t$2+4>>>2],o$2=r$2&2?e$3[t$2+12>>>2]:e$3[s$2+-4>>>2]>>>i$3;return m$2(i$3,r$2&VAL_SIGNED,r$2&VAL_FLOAT).subarray(s$2>>>=i$3,s$2+o$2)}function f$1(t$2,e$3,r$2){return new t$2(A(t$2,e$3,r$2))}function A(t$2,e$3,r$2){let i$3=n$1.buffer,s$2=new Uint32Array(i$3);return new t$2(i$3,s$2[r$2+4>>>2],s$2[r$2+8>>>2]>>>e$3)}function I$1(e$3,r$2,n$2){t$1[`__get`+r$2]=f$1.bind(null,e$3,n$2),t$1[`__get${r$2}View`]=A.bind(null,e$3,n$2)}return t$1.__new=s$1,t$1.__pin=o$1,t$1.__unpin=a$1,t$1.__collect=u$1,t$1.__newString=function(t$2){if(t$2==null)return 0;let e$3=t$2.length,r$2=s$1(e$3<<1,1),i$3=new Uint16Array(n$1.buffer);for(var o$2=0,a$2=r$2>>>1;o$2<e$3;++o$2)i$3[a$2+o$2]=t$2.charCodeAt(o$2);return r$2},t$1.__newArrayBuffer=function(t$2){if(t$2==null)return 0;let e$3=new Uint8Array(t$2),r$2=s$1(e$3.length,0);return new Uint8Array(n$1.buffer).set(e$3,r$2),r$2},t$1.__getString=function(t$2){if(!t$2)return null;let e$3=n$1.buffer;if(new Uint32Array(e$3)[t$2+-8>>>2]!==1)throw Error(`not a string: `+t$2);return getStringImpl(e$3,t$2)},t$1.__newArray=function(t$2,e$3=0){let r$2=e$3,i$3=d$1(t$2),u$2=g$1(i$3),l$2=typeof r$2!=`number`,h$3=l$2?r$2.length:r$2,c$3=s$1(h$3<<u$2,i$3&4?t$2:0),p$3;if(i$3&4)p$3=c$3;else{o$1(c$3);let e$4=s$1(i$3&2?16:12,t$2);a$1(c$3);let r$3=new Uint32Array(n$1.buffer);r$3[e$4+0>>>2]=c$3,r$3[e$4+4>>>2]=c$3,r$3[e$4+8>>>2]=h$3<<u$2,i$3&2&&(r$3[e$4+12>>>2]=h$3),p$3=e$4}if(l$2){let t$3=m$2(u$2,i$3&VAL_SIGNED,i$3&VAL_FLOAT),e$4=c$3>>>u$2;if(i$3&16384)for(let n$2=0;n$2<h$3;++n$2)t$3[e$4+n$2]=r$2[n$2];else t$3.set(r$2,e$4)}return p$3},t$1.__getArrayView=p$2,t$1.__getArray=function(t$2){let e$3=p$2(t$2),r$2=e$3.length,n$2=Array(r$2);for(let t$3=0;t$3<r$2;t$3++)n$2[t$3]=e$3[t$3];return n$2},t$1.__getArrayBuffer=function(t$2){let e$3=n$1.buffer,r$2=new Uint32Array(e$3)[t$2+-4>>>2];return e$3.slice(t$2,t$2+r$2)},t$1.__getFunction=function(t$2){if(!i$2)throw Error(`Operation requires compiling with --exportTable`);let e$3=new Uint32Array(n$1.buffer)[t$2>>>2];return i$2.get(e$3)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach(t$2=>{I$1(t$2,t$2.name,31-Math.clz32(t$2.BYTES_PER_ELEMENT))}),BIGINT&&[BigUint64Array,BigInt64Array].forEach(t$2=>{I$1(t$2,t$2.name.slice(3),3)}),t$1.__instanceof=function(t$2,e$3){let r$2=new Uint32Array(n$1.buffer),i$3=r$2[t$2+-8>>>2];if(i$3<=h$2(r$2))do{if(i$3==e$3)return!0;i$3=c$2(i$3)}while(i$3);return!1},t$1.memory=t$1.memory||n$1,t$1.table=t$1.table||i$2,demangle(r$1,t$1)}function isResponse(t$1){return typeof Response<`u`&&t$1 instanceof Response}function isModule(t$1){return t$1 instanceof WebAssembly.Module}async function instantiate(t$1,e$2={}){if(isResponse(t$1=await t$1))return instantiateStreaming(t$1,e$2);let r$1=isModule(t$1)?t$1:await WebAssembly.compile(t$1),n$1=preInstantiate(e$2),i$2=await WebAssembly.instantiate(r$1,e$2);return{module:r$1,instance:i$2,exports:postInstantiate(n$1,i$2)}}function instantiateSync(t$1,e$2={}){let r$1=isModule(t$1)?t$1:new WebAssembly.Module(t$1),n$1=preInstantiate(e$2),i$2=new WebAssembly.Instance(r$1,e$2);return{module:r$1,instance:i$2,exports:postInstantiate(n$1,i$2)}}async function instantiateStreaming(t$1,e$2={}){if(!WebAssembly.instantiateStreaming)return instantiate(isResponse(t$1=await t$1)?t$1.arrayBuffer():t$1,e$2);let r$1=preInstantiate(e$2),n$1=await WebAssembly.instantiateStreaming(t$1,e$2),i$2=postInstantiate(r$1,n$1.instance);return{...n$1,exports:i$2}}function demangle(t$1,e$2={}){let r$1=t$1.__argumentsLength?e$3=>{t$1.__argumentsLength.value=e$3}:t$1.__setArgumentsLength||t$1.__setargc||(()=>{});for(let n$1 of Object.keys(t$1)){let i$2=t$1[n$1],s$1=n$1.split(`.`),o$1=e$2;for(;s$1.length>1;){let t$2=s$1.shift();Object.hasOwn(o$1,t$2)||(o$1[t$2]={}),o$1=o$1[t$2]}let a$1=s$1[0],u$1=a$1.indexOf(`#`);if(u$1>=0){let e$3=a$1.substring(0,u$1),s$2=o$1[e$3];if(s$2===void 0||!s$2.prototype){let t$2=function(...e$4){return t$2.wrap(t$2.prototype.constructor(0,...e$4))};t$2.prototype={valueOf(){return this[THIS]}},t$2.wrap=function(e$4){return Object.create(t$2.prototype,{[THIS]:{value:e$4,writable:!1}})},s$2&&Object.getOwnPropertyNames(s$2).forEach(e$4=>Object.defineProperty(t$2,e$4,Object.getOwnPropertyDescriptor(s$2,e$4))),o$1[e$3]=t$2}if(a$1=a$1.substring(u$1+1),o$1=o$1[e$3].prototype,/^(get|set):/.test(a$1)){if(!Object.hasOwn(o$1,a$1=a$1.substring(4))){let e$4=t$1[n$1.replace(`set:`,`get:`)],r$2=t$1[n$1.replace(`get:`,`set:`)];Object.defineProperty(o$1,a$1,{get(){return e$4(this[THIS])},set(t$2){r$2(this[THIS],t$2)},enumerable:!0})}}else a$1===`constructor`?(o$1[a$1]=function(...t$2){return r$1(t$2.length),i$2(...t$2)}).original=i$2:(o$1[a$1]=function(...t$2){return r$1(t$2.length),i$2(this[THIS],...t$2)}).original=i$2}else /^(get|set):/.test(a$1)?Object.hasOwn(o$1,a$1=a$1.substring(4))||Object.defineProperty(o$1,a$1,{get:t$1[n$1.replace(`set:`,`get:`)],set:t$1[n$1.replace(`get:`,`set:`)],enumerable:!0}):typeof i$2==`function`&&i$2!==r$1?(o$1[a$1]=(...t$2)=>(r$1(t$2.length),i$2(...t$2))).original=i$2:o$1[a$1]=i$2}return e$2}Object.hasOwn=Object.hasOwn||function(t$1,e$2){return Object.prototype.hasOwnProperty.call(t$1,e$2)};let isNode=typeof process<`u`&&process.version,isWorker=typeof importScripts==`function`,webAssemblyAvailable=(()=>{let t$1=!1;return t$1=isNode?`WebAssembly`in global:isWorker||`WebAssembly`in window,t$1})(),wasm,initWebAssembly=()=>__awaiter(void 0,void 0,void 0,(function*(){if(!webAssemblyAvailable)throw Error(`WebAssembly not available here!`);if(!wasm)return instantiate(pako__namespace.inflate(toByteArray_1(BINARY))).then(t$1=>wasm=t$1.exports||t$1)})),initWebAssemblySync=()=>{if(wasm)return;let t$1=instantiateSync(pako__namespace.inflate(toByteArray_1(BINARY)));wasm=t$1.exports||t$1},webAssemblyReady=()=>!!wasm,defaultRequest$1={bitBucketSize:32,autoResize:!0,lowestDiscernibleValue:1,highestTrackableValue:2,numberOfSignificantValueDigits:3},remoteHistogramClassFor=t$1=>t$1===`packed`?`PackedHistogram`:`Histogram`+t$1,destroyedWasmHistogram=new Proxy({},{get:function(t$1,e$2){throw Error(`Cannot use a destroyed histogram`)}});class WasmHistogram{constructor(t$1,e$2){this._wasmHistogram=t$1,this._remoteHistogramClass=e$2,this.tag=NO_TAG,wasm.__pin(this._wasmHistogram)}static build(t$1=defaultRequest$1){if(!webAssemblyReady())throw Error(`WebAssembly is not ready yet!`);let e$2=Object.assign({},defaultRequest$1,t$1),r$1=remoteHistogramClassFor(e$2.bitBucketSize);return new WasmHistogram(new wasm[r$1](e$2.lowestDiscernibleValue,e$2.highestTrackableValue,e$2.numberOfSignificantValueDigits,e$2.autoResize),r$1)}static decode(t$1,e$2=32,r$1=0){if(!webAssemblyReady())throw Error(`WebAssembly is not ready yet!`);let n$1=remoteHistogramClassFor(e$2),i$2=`decode`+n$1,s$1=wasm.__newArray(wasm.UINT8ARRAY_ID,t$1);return new WasmHistogram(wasm[n$1].wrap(wasm[i$2](s$1,r$1)),n$1)}get numberOfSignificantValueDigits(){return this._wasmHistogram.numberOfSignificantValueDigits}get autoResize(){return!!this._wasmHistogram.autoResize}set autoResize(t$1){this._wasmHistogram.autoResize=t$1}get highestTrackableValue(){return this._wasmHistogram.highestTrackableValue}set highestTrackableValue(t$1){this._wasmHistogram.highestTrackableValue=t$1}get startTimeStampMsec(){return this._wasmHistogram.startTimeStampMsec}set startTimeStampMsec(t$1){this._wasmHistogram.startTimeStampMsec=t$1}get endTimeStampMsec(){return this._wasmHistogram.endTimeStampMsec}set endTimeStampMsec(t$1){this._wasmHistogram.endTimeStampMsec=t$1}get totalCount(){return this._wasmHistogram.totalCount}get stdDeviation(){return this._wasmHistogram.stdDeviation}get mean(){return this._wasmHistogram.mean}get estimatedFootprintInBytes(){return 192+this._wasmHistogram.estimatedFootprintInBytes}get minNonZeroValue(){return this._wasmHistogram.minNonZeroValue}get maxValue(){return this._wasmHistogram.maxValue}recordValue(t$1){this._wasmHistogram.recordValue(t$1)}recordValueWithCount(t$1,e$2){this._wasmHistogram.recordValueWithCount(t$1,e$2)}recordValueWithExpectedInterval(t$1,e$2){this._wasmHistogram.recordValueWithExpectedInterval(t$1,e$2)}getValueAtPercentile(t$1){return this._wasmHistogram.getValueAtPercentile(t$1)}outputPercentileDistribution(t$1=5,e$2=1,r$1=!1){if(r$1)throw Error(`CSV output not supported by wasm histograms`);return wasm.__getString(this._wasmHistogram.outputPercentileDistribution(t$1,e$2))}isDestroyed(){return this._wasmHistogram===destroyedWasmHistogram}get summary(){return toSummary(this)}toJSON(){return this.summary}toString(){return this.isDestroyed()?`Destroyed WASM histogram`:`WASM ${this._remoteHistogramClass} ${JSON.stringify(this,null,2)}`}inspect(){return this.toString()}[Symbol.for(`nodejs.util.inspect.custom`)](){return this.toString()}addWhileCorrectingForCoordinatedOmission(t$1,e$2){this._wasmHistogram.addWhileCorrectingForCoordinatedOmission(t$1,e$2)}copyCorrectedForCoordinatedOmission(t$1){return new WasmHistogram(wasm[this._remoteHistogramClass].wrap(this._wasmHistogram.copyCorrectedForCoordinatedOmission(t$1)),this._remoteHistogramClass)}add(t$1){if(!(t$1 instanceof WasmHistogram))throw Error(`Cannot add a regular JS histogram to a WASM histogram`);this._wasmHistogram[`add`+t$1._remoteHistogramClass](t$1._wasmHistogram)}subtract(t$1){if(!(t$1 instanceof WasmHistogram))throw Error(`Cannot subtract a regular JS histogram to a WASM histogram`);this._wasmHistogram[`subtract`+t$1._remoteHistogramClass](t$1._wasmHistogram)}encode(){let t$1=wasm.__pin(this._wasmHistogram.encode()),e$2=wasm.__getUint8Array(t$1);return wasm.__unpin(t$1),e$2}reset(){this.tag=NO_TAG,this._wasmHistogram.reset()}destroy(){wasm.__unpin(this._wasmHistogram),this._wasmHistogram=destroyedWasmHistogram}}let MINIMUM_INITIAL_PACKED_ARRAY_CAPACITY=16,MAX_SUPPORTED_PACKED_COUNTS_ARRAY_LENGTH=2**13-1,SET_0_START_INDEX=0,NUMBER_OF_SETS$1=8,LEAF_LEVEL_SHIFT=3,NON_LEAF_ENTRY_SLOT_INDICATORS_OFFSET=0,NON_LEAF_ENTRY_HEADER_SIZE_IN_SHORTS=1,PACKED_ARRAY_GROWTH_INCREMENT=16,PACKED_ARRAY_GROWTH_FRACTION_POW2=4,{pow:pow$2,ceil,log2,max:max$1$1}=Math,bitCount=t$1=>{for(var e$2=0;t$1!==0;)e$2+=bitCount32(0|t$1),t$1/=4294967296;return e$2},bitCount32=t$1=>16843009*((t$1=(858993459&(t$1-=t$1>>1&1431655765))+(t$1>>2&858993459))+(t$1>>4)&252645135)>>24;class PackedArrayContext{constructor(t$1,e$2){this.populatedShortLength=0,this.topLevelShift=Number.MAX_VALUE,this.physicalLength=Math.max(e$2,16),this.isPacked=this.physicalLength<=8191,this.isPacked||(this.physicalLength=t$1),this.array=new ArrayBuffer(8*this.physicalLength),this.initArrayViews(this.array),this.init(t$1)}initArrayViews(t$1){this.byteArray=new Uint8Array(t$1),this.shortArray=new Uint16Array(t$1),this.longArray=new Float64Array(t$1)}init(t$1){if(this.isPacked){this.populatedShortLength=8;for(let t$2=0;t$2<8;t$2++)this.setAtShortIndex(0+t$2,0);this.setVirtualLength(t$1)}else this.virtualLength=t$1}clear(){this.byteArray.fill(0),this.init(this.virtualLength)}copyAndIncreaseSize(t$1,e$2){let r$1=new PackedArrayContext(e$2,t$1);return this.isPacked&&r$1.populateEquivalentEntriesWithEntriesFromOther(this),r$1}getPopulatedShortLength(){return this.populatedShortLength}getPopulatedLongLength(){return this.getPopulatedShortLength()+3>>2}setAtByteIndex(t$1,e$2){this.byteArray[t$1]=e$2}getAtByteIndex(t$1){return this.byteArray[t$1]}addAtByteIndex(t$1,e$2){let r$1=this.byteArray[t$1]+e$2;return this.byteArray[t$1]=r$1,r$1}setPopulatedLongLength(t$1){this.populatedShortLength=t$1<<2}getVirtualLength(){return this.virtualLength}length(){return this.physicalLength}setAtShortIndex(t$1,e$2){this.shortArray[t$1]=e$2}setAtLongIndex(t$1,e$2){this.longArray[t$1]=e$2}getAtShortIndex(t$1){return this.shortArray[t$1]}getIndexAtShortIndex(t$1){return this.shortArray[t$1]}setPackedSlotIndicators(t$1,e$2){this.setAtShortIndex(t$1+0,e$2)}getPackedSlotIndicators(t$1){return 65535&this.shortArray[t$1+0]}getIndexAtEntrySlot(t$1,e$2){return this.getAtShortIndex(t$1+1+e$2)}setIndexAtEntrySlot(t$1,e$2,r$1){this.setAtShortIndex(t$1+1+e$2,r$1)}expandArrayIfNeeded(t$1){let e$2=this.length();if(e$2<this.getPopulatedLongLength()+t$1){let r$1=max$1$1(t$1,16,this.getPopulatedLongLength()>>4);this.resizeArray(e$2+r$1)}}newEntry(t$1){let e$2=this.populatedShortLength;this.expandArrayIfNeeded(1+(t$1>>2)),this.populatedShortLength=e$2+t$1;for(let r$1=0;r$1<t$1;r$1++)this.setAtShortIndex(e$2+r$1,-1);return e$2}newLeafEntry(){let t$1;return t$1=this.getPopulatedLongLength(),this.expandArrayIfNeeded(1),this.setPopulatedLongLength(t$1+1),this.setAtLongIndex(t$1,0),t$1}consolidateEntry(t$1,e$2){let r$1=this.getPackedSlotIndicators(e$2),n$1=this.getPackedSlotIndicators(t$1),i$2=bitCount(n$1&(n$1^r$1)-1),s$1=bitCount(n$1),o$1=0;for(let r$2=0;r$2<s$1;r$2++)if(r$2!==i$2){let n$2=this.getIndexAtEntrySlot(e$2,o$1);n$2!==0&&this.setIndexAtEntrySlot(t$1,r$2,n$2),o$1++}}expandEntry(t$1,e$2,r$1,n$1,i$2){let s$1=65535&this.getAtShortIndex(t$1);s$1|=n$1;let o$1=bitCount(s$1);if(r$1>=o$1)throw Error(`inserted slot index is out of range given provided masks`);let a$1=o$1+1,u$1=0;i$2?u$1=this.newLeafEntry():(u$1=this.newEntry(1),this.setPackedSlotIndicators(u$1,0));let l$1=u$1,h$2=this.newEntry(a$1);return this.setPackedSlotIndicators(h$2,s$1),this.setIndexAtEntrySlot(h$2,r$1,l$1),this.setAtShortIndex(e$2,h$2),this.consolidateEntry(h$2,t$1),h$2}getRootEntry(t$1,e$2=!1){let r$1=0+t$1,n$1=this.getIndexAtShortIndex(r$1);if(n$1==0){if(!e$2)return 0;n$1=this.newEntry(1),this.setPackedSlotIndicators(n$1,0),this.setAtShortIndex(r$1,n$1)}return n$1}getPackedIndex(t$1,e$2,r$1){if(e$2>=this.virtualLength)throw Error(`Attempting access at index ${e$2}, beyond virtualLength ${this.virtualLength}`);let n$1=0+t$1,i$2=this.getRootEntry(t$1,r$1);if(i$2==0)return-1;for(let t$2=this.topLevelShift;t$2>=3;t$2-=4){let s$1=t$2===3,o$1=this.getPackedSlotIndicators(i$2),a$1=1<<(e$2/pow$2(2,t$2)&15),u$1=bitCount(o$1&a$1-1);if((o$1&a$1)==0){if(!r$1)return-1;i$2=this.expandEntry(i$2,n$1,u$1,a$1,s$1)}n$1=i$2+1+u$1,i$2=this.getIndexAtShortIndex(n$1)}return(i$2<<3)+(7&e$2)}determineTopLevelShiftForVirtualLength(t$1){let e$2=ceil(log2(t$1)),r$1=4*ceil((e$2-3)/4);return r$1=max$1$1(r$1,8),r$1-4+3}setVirtualLength(t$1){if(!this.isPacked)throw Error(`Should never be adjusting the virtual size of a non-packed context`);this.topLevelShift=this.determineTopLevelShiftForVirtualLength(t$1),this.virtualLength=t$1}getTopLevelShift(){return this.topLevelShift}resizeArray(t$1){let e$2=new Uint8Array(8*t$1);e$2.set(this.byteArray),this.array=e$2.buffer,this.initArrayViews(this.array),this.physicalLength=t$1}populateEquivalentEntriesWithEntriesFromOther(t$1){if(this.virtualLength<t$1.getVirtualLength())throw Error(`Cannot populate array of smaller virtual length`);for(let e$2=0;e$2<8;e$2++){let r$1=t$1.getAtShortIndex(0+e$2);if(r$1==0)continue;let n$1=0+e$2;for(let e$3=this.topLevelShift;e$3>t$1.topLevelShift;e$3-=4){let t$2=2,e$4=this.newEntry(2);this.setAtShortIndex(n$1,e$4),this.setPackedSlotIndicators(e$4,1),n$1=e$4+1}this.copyEntriesAtLevelFromOther(t$1,r$1,n$1,t$1.topLevelShift)}}copyEntriesAtLevelFromOther(t$1,e$2,r$1,n$1){let i$2=n$1==3,s$1=t$1.getPackedSlotIndicators(e$2),o$1=bitCount(s$1),a$1=1+o$1,u$1=this.newEntry(a$1);this.setAtShortIndex(r$1,u$1),this.setAtShortIndex(u$1+0,s$1);for(let r$2=0;r$2<o$1;r$2++)if(i$2){let n$2=this.newLeafEntry();this.setIndexAtEntrySlot(u$1,r$2,n$2);let i$3=t$1.getIndexAtEntrySlot(e$2,r$2);this.longArray[n$2]=t$1.longArray[i$3]}else{let i$3=t$1.getIndexAtEntrySlot(e$2,r$2);this.copyEntriesAtLevelFromOther(t$1,i$3,u$1+1+r$2,n$1-4)}}getAtUnpackedIndex(t$1){return this.longArray[t$1]}setAtUnpackedIndex(t$1,e$2){this.longArray[t$1]=e$2}lazysetAtUnpackedIndex(t$1,e$2){this.longArray[t$1]=e$2}incrementAndGetAtUnpackedIndex(t$1){return this.longArray[t$1]++,this.longArray[t$1]}addAndGetAtUnpackedIndex(t$1,e$2){return this.longArray[t$1]+=e$2,this.longArray[t$1]}nonLeafEntryToString(t$1,e$2,r$1){let n$1=``;for(let t$2=0;t$2<r$1;t$2++)n$1+=`  `;try{let i$2=this.getPackedSlotIndicators(t$1);n$1+=`slotIndiators: 0x${toHex(i$2)}, prevVersionIndex: 0: [ `;let s$1=bitCount(i$2);for(let e$3=0;e$3<s$1;e$3++)n$1+=this.getIndexAtEntrySlot(t$1,e$3),e$3<s$1-1&&(n$1+=`, `);n$1+=` ] (indexShift = ${e$2})\n`;let o$1=e$2==3;for(let i$3=0;i$3<s$1;i$3++){let s$2=this.getIndexAtEntrySlot(t$1,i$3);n$1+=o$1?this.leafEntryToString(s$2,r$1+4):this.nonLeafEntryToString(s$2,e$2-4,r$1+4)}}catch{n$1+=`Exception thrown at nonLeafEnty at index ${t$1} with indexShift ${e$2}\n`}return n$1}leafEntryToString(t$1,e$2){let r$1=``;for(let t$2=0;t$2<e$2;t$2++)r$1+=`  `;try{r$1+=`Leaf bytes : `;for(let e$3=0;e$3<8;e$3++)r$1+=`0x${toHex(this.byteArray[8*t$1+e$3])} `;r$1+=`
`}catch{r$1+=`Exception thrown at leafEnty at index ${t$1}\n`}return r$1}toString(){let t$1=`PackedArrayContext:
`;if(!this.isPacked)return t$1+`Context is unpacked:
`;for(let e$2=0;e$2<8;e$2++)try{let r$1=0+e$2,n$1=this.getIndexAtShortIndex(r$1);if(t$1+=`Set ${e$2}: root = ${n$1} \n`,n$1==0)continue;t$1+=this.nonLeafEntryToString(n$1,this.topLevelShift,4)}catch{t$1+=`Exception thrown in set ${e$2}%d\n`}return t$1}}let toHex=t$1=>Number(t$1).toString(16).padStart(2,`0`),NUMBER_OF_SETS=8,{pow:pow$1,floor:floor$1}=Math;class PackedArray{constructor(t$1,e$2=16){this.arrayContext=new PackedArrayContext(t$1,e$2)}setVirtualLength(t$1){if(t$1<this.length())throw Error(`Cannot set virtual length, as requested length `+t$1+` is smaller than the current virtual length `+this.length());let e$2=this.arrayContext;e$2.isPacked&&e$2.determineTopLevelShiftForVirtualLength(t$1)==e$2.getTopLevelShift()?e$2.setVirtualLength(t$1):this.arrayContext=e$2.copyAndIncreaseSize(this.getPhysicalLength(),t$1)}get(t$1){let e$2=0;for(let r$1=0;r$1<8;r$1++){let n$1=0;if(!this.arrayContext.isPacked)return this.arrayContext.getAtUnpackedIndex(t$1);let i$2=this.arrayContext.getPackedIndex(r$1,t$1,!1);if(i$2<0)return e$2;n$1=this.arrayContext.getAtByteIndex(i$2)*pow$1(2,r$1<<3),e$2+=n$1}return e$2}increment(t$1){this.add(t$1,1)}safeGetPackedIndexgetPackedIndex(t$1,e$2){return this.arrayContext.getPackedIndex(t$1,e$2,!0)}add(t$1,e$2){let r$1=e$2;for(let n$1=0,i$2=0;n$1<8;n$1++,i$2+=8){if(!this.arrayContext.isPacked)return void this.arrayContext.addAndGetAtUnpackedIndex(t$1,e$2);let i$3=this.safeGetPackedIndexgetPackedIndex(n$1,t$1),s$1=255&r$1,o$1=this.arrayContext.addAtByteIndex(i$3,s$1);if(r$1-=s$1,r$1/=pow$1(2,8),r$1+=floor$1(o$1/pow$1(2,8)),r$1==0)return}}set(t$1,e$2){let r$1=0,n$1=e$2;for(let i$2=0;i$2<8;i$2++){if(!this.arrayContext.isPacked)return void this.arrayContext.setAtUnpackedIndex(t$1,e$2);if(n$1==0&&this.arrayContext.getPackedIndex(i$2,t$1,!1)<0)return;let s$1=this.arrayContext.getPackedIndex(i$2,t$1,!0),o$1=255&n$1;n$1=floor$1(n$1/pow$1(2,8)),i$2<r$1||(this.arrayContext.setAtByteIndex(s$1,o$1),r$1++)}}getPhysicalLength(){return this.arrayContext.physicalLength}length(){return this.arrayContext.getVirtualLength()}clear(){this.arrayContext.clear()}toString(){let t$1=`PackedArray:
`;return t$1+=this.arrayContext.toString(),t$1}}class PackedHistogram extends JsHistogram{constructor(t$1,e$2,r$1){super(t$1,e$2,r$1),this._totalCount=0,this.packedCounts=new PackedArray(this.countsArrayLength)}clearCounts(){this.packedCounts.clear()}incrementCountAtIndex(t$1){this.packedCounts.increment(t$1)}addToCountAtIndex(t$1,e$2){this.packedCounts.add(t$1,e$2)}setCountAtIndex(t$1,e$2){this.packedCounts.set(t$1,e$2)}resize(t$1){this.establishSize(t$1),this.packedCounts.setVirtualLength(this.countsArrayLength)}getCountAtIndex(t$1){return this.packedCounts.get(t$1)}_getEstimatedFootprintInBytes(){return 192+8*this.packedCounts.getPhysicalLength()}copyCorrectedForCoordinatedOmission(t$1){let e$2=new PackedHistogram(this.lowestDiscernibleValue,this.highestTrackableValue,this.numberOfSignificantValueDigits);return e$2.addWhileCorrectingForCoordinatedOmission(this,t$1),e$2}toString(){return`PackedHistogram `+JSON.stringify(this,null,2)}}class TypedArrayHistogram extends JsHistogram{constructor(t$1,e$2,r$1,n$1){super(e$2,r$1,n$1),this.arrayCtr=t$1,this._totalCount=0,this._counts=new t$1(this.countsArrayLength)}clearCounts(){this._counts.fill(0)}incrementCountAtIndex(t$1){let e$2=this._counts[t$1]+1;if(e$2<0)throw e$2+` would overflow short integer count`;this._counts[t$1]=e$2}addToCountAtIndex(t$1,e$2){let r$1=this._counts[t$1]+e$2;if(r$1<-(2**53-1)||r$1>2**53-1)throw r$1+` would overflow integer count`;this._counts[t$1]=r$1}setCountAtIndex(t$1,e$2){if(e$2<-(2**53-1)||e$2>2**53-1)throw e$2+` would overflow integer count`;this._counts[t$1]=e$2}resize(t$1){this.establishSize(t$1);let e$2=new this.arrayCtr(this.countsArrayLength);e$2.set(this._counts),this._counts=e$2}getCountAtIndex(t$1){return this._counts[t$1]}_getEstimatedFootprintInBytes(){return 1024+this._counts.BYTES_PER_ELEMENT*this._counts.length}copyCorrectedForCoordinatedOmission(t$1){let e$2=new TypedArrayHistogram(this.arrayCtr,this.lowestDiscernibleValue,this.highestTrackableValue,this.numberOfSignificantValueDigits);return e$2.addWhileCorrectingForCoordinatedOmission(this,t$1),e$2}toString(){return`Histogram ${8*this._counts.BYTES_PER_ELEMENT}b ${JSON.stringify(this,null,2)}`}}class Int8Histogram extends TypedArrayHistogram{constructor(t$1,e$2,r$1){super(Uint8Array,t$1,e$2,r$1)}}class Int16Histogram extends TypedArrayHistogram{constructor(t$1,e$2,r$1){super(Uint16Array,t$1,e$2,r$1)}}class Int32Histogram extends TypedArrayHistogram{constructor(t$1,e$2,r$1){super(Uint32Array,t$1,e$2,r$1)}}class Float64Histogram extends TypedArrayHistogram{constructor(t$1,e$2,r$1){super(Float64Array,t$1,e$2,r$1)}}function constructorFromBucketSize(t$1){switch(t$1){case`packed`:return PackedHistogram;case 8:return Int8Histogram;case 16:return Int16Histogram;case 32:return Int32Histogram;case 64:return Float64Histogram;default:throw Error(`Incorrect parameter bitBucketSize`)}}let{pow,floor}=Math,TWO_POW_7=pow(2,7),TWO_POW_14=pow(2,14),TWO_POW_21=pow(2,21),TWO_POW_28=pow(2,28),TWO_POW_35=pow(2,35),TWO_POW_42=pow(2,42),TWO_POW_49=pow(2,49),TWO_POW_56=pow(2,56);class ZigZagEncoding{static encode(t$1,e$2){e$2>=0?e$2*=2:e$2=2*-e$2-1,e$2<TWO_POW_7?t$1.put(e$2):(t$1.put(128|e$2),e$2<TWO_POW_14?t$1.put(floor(e$2/TWO_POW_7)):(t$1.put(128|floor(e$2/TWO_POW_7)),e$2<TWO_POW_21?t$1.put(floor(e$2/TWO_POW_14)):(t$1.put(128|floor(e$2/TWO_POW_14)),e$2<TWO_POW_28?t$1.put(floor(e$2/TWO_POW_21)):(t$1.put(128|floor(e$2/TWO_POW_21)),e$2<TWO_POW_35?t$1.put(floor(e$2/TWO_POW_28)):(t$1.put(128|floor(e$2/TWO_POW_28)),e$2<TWO_POW_42?t$1.put(floor(e$2/TWO_POW_35)):(t$1.put(128|floor(e$2/TWO_POW_35)),e$2<TWO_POW_49?t$1.put(floor(e$2/TWO_POW_42)):(t$1.put(128|floor(e$2/TWO_POW_42)),e$2<TWO_POW_56?t$1.put(floor(e$2/TWO_POW_49)):(t$1.put(floor(e$2/TWO_POW_49)+128),t$1.put(floor(e$2/TWO_POW_56))))))))))}static decode(t$1){let e$2=t$1.get(),r$1=127&e$2;return 128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_7,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_14,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_21,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_28,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_35,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_42,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_49,128&e$2&&(e$2=t$1.get(),r$1+=(127&e$2)*TWO_POW_56)))))))),r$1%2==0?r$1/=2:r$1=-(r$1+1)/2,r$1}}let{max:max$3}=Math,V2EncodingCookieBase=478450435,V2CompressedEncodingCookieBase$1=478450436,V2maxWordSizeInBytes=9,encodingCookie=16|V2EncodingCookieBase,compressedEncodingCookie$1=16|V2CompressedEncodingCookieBase$1;function fillBufferFromCountsArray(t$1,e$2){let r$1=t$1.countsArrayIndex(t$1.maxValue)+1,n$1=0;for(;n$1<r$1;){let i$2=t$1.getCountAtIndex(n$1++);if(i$2<0)throw Error(`Cannot encode histogram containing negative counts (`+i$2+`) at index `+n$1+`, corresponding the value range [`+t$1.lowestEquivalentValue(t$1.valueFromIndex(n$1))+`,`+t$1.nextNonEquivalentValue(t$1.valueFromIndex(n$1))+`)`);let s$1=0;if(i$2==0)for(s$1=1;n$1<r$1&&t$1.getCountAtIndex(n$1)==0;)s$1++,n$1++;s$1>1?ZigZagEncoding.encode(e$2,-s$1):ZigZagEncoding.encode(e$2,i$2)}}function encodeIntoByteBuffer(t$1,e$2){let r$1=e$2.position;e$2.putInt32(478450451),e$2.putInt32(0),e$2.putInt32(1),e$2.putInt32(t$1.numberOfSignificantValueDigits),e$2.putInt64(t$1.lowestDiscernibleValue),e$2.putInt64(t$1.highestTrackableValue),e$2.putInt64(1);let n$1=e$2.position;fillBufferFromCountsArray(t$1,e$2);let i$2=e$2.position;return e$2.position=r$1+4,e$2.putInt32(i$2-n$1),e$2.position=i$2,i$2-r$1}function fillCountsArrayFromSourceBuffer(t$1,e$2,r$1,n$1){if(n$1!=2&&n$1!=4&&n$1!=8&&n$1!=9)throw Error(`word size must be 2, 4, 8, or V2maxWordSizeInBytes (9) bytes`);let i$2=0,s$1=e$2.position+r$1;for(;e$2.position<s$1;){let r$2=0,n$2=ZigZagEncoding.decode(e$2);n$2<0?(r$2=-n$2,i$2+=r$2):t$1.setCountAtIndex(i$2++,n$2)}return i$2}function getCookieBase(t$1){return-241&t$1}function getWordSizeInBytesFromCookie(t$1){return getCookieBase(t$1)==V2EncodingCookieBase||getCookieBase(t$1)==V2CompressedEncodingCookieBase$1?9:14&(240&t$1)>>4}function findDeflateFunction(){try{return eval(`require("zlib").deflateSync`)}catch{return pako__namespace?pako__namespace.deflate:()=>{throw Error(`pako library is mandatory for encoding/deconding on the browser side`)}}}function findInflateFunction(){try{return eval(`require("zlib").inflateSync`)}catch{return pako__namespace?pako__namespace.inflate:()=>{throw Error(`pako library is mandatory for encoding/deconding on the browser side`)}}}let deflate$3=findDeflateFunction(),inflate$3=findInflateFunction();function doDecode(t$1,e$2=32,r$1=0){let n$1=new ByteBuffer(t$1),i$2=n$1.getInt32(),s$1,o$1,a$1,u$1;if(getCookieBase(i$2)!==V2EncodingCookieBase)throw Error(`The buffer does not contain a Histogram (no valid V2 encoding cookie found)`);if(getWordSizeInBytesFromCookie(i$2)!=9)throw Error(`The buffer does not contain a Histogram (no valid cookie found)`);s$1=n$1.getInt32(),n$1.getInt32(),o$1=n$1.getInt32(),a$1=n$1.getInt64(),u$1=n$1.getInt64(),n$1.getInt64(),u$1=max$3(u$1,r$1);let l$1=new(constructorFromBucketSize(e$2))(a$1,u$1,o$1),h$2=fillCountsArrayFromSourceBuffer(l$1,n$1,s$1,9);return l$1.establishInternalTackingValues(h$2),l$1}function doEncodeIntoCompressedBase64(t$1){let e$2=t$1?{level:t$1}:{},r$1=ByteBuffer.allocate();r$1.putInt32(478450452);let n$1=ByteBuffer.allocate(),i$2=encodeIntoByteBuffer(this,n$1),s$1=n$1.data.slice(0,i$2),o$1=deflate$3(s$1,e$2);return r$1.putInt32(o$1.byteLength),r$1.putArray(o$1),fromByteArray_1(r$1.data)}JsHistogram.decode=doDecode,JsHistogram.prototype.encodeIntoCompressedBase64=doEncodeIntoCompressedBase64;let V2CompressedEncodingCookieBase=478450436,compressedEncodingCookie=16|V2CompressedEncodingCookieBase;function decompress(t$1){let e$2=new ByteBuffer(t$1),r$1=e$2.position;if((-241&e$2.getInt32())!==V2CompressedEncodingCookieBase)throw Error(`Encoding not supported, only V2 is supported`);let n$1=e$2.getInt32();return inflate$3(e$2.data.slice(r$1+8,r$1+8+n$1))}let decodeFromCompressedBase64=(t$1,e$2=32,r$1=!1,n$1=0)=>{let i$2=decompress(toByteArray_1(t$1.trim()));return r$1?WasmHistogram.decode(i$2,e$2,n$1):JsHistogram.decode(i$2,e$2,n$1)};function encodeWasmIntoCompressedBase64(t$1){let e$2=t$1?{level:t$1}:{},r$1=ByteBuffer.allocate();r$1.putInt32(478450452);let n$1=this.encode(),i$2=deflate$3(n$1,e$2);return r$1.putInt32(i$2.byteLength),r$1.putArray(i$2),fromByteArray_1(r$1.data)}WasmHistogram.prototype.encodeIntoCompressedBase64=encodeWasmIntoCompressedBase64;let encodeIntoCompressedBase64=(t$1,e$2)=>{if(t$1 instanceof WasmHistogram||t$1 instanceof JsHistogram)return t$1.encodeIntoCompressedBase64(e$2);throw Error(`Unsupported Histogram implementation`)},TAG_PREFIX=`Tag=`,TAG_PREFIX_LENGTH=4;class HistogramLogReader{constructor(t$1,e$2=32,r$1=!1){this.lines=splitLines(t$1),this.currentLineIndex=0,this.bitBucketSize=e$2,this.useWebAssembly=r$1}nextIntervalHistogram(t$1=0,e$2=Number.MAX_VALUE){for(;this.currentLineIndex<this.lines.length;){let r$1=this.lines[this.currentLineIndex];if(this.currentLineIndex++,r$1.startsWith(`#[StartTime:`))this.parseStartTimeFromLine(r$1);else if(r$1.startsWith(`#[BaseTime:`))this.parseBaseTimeFromLine(r$1);else if(!(r$1.startsWith(`#`)||r$1.startsWith(`"StartTimestamp"`))&&r$1.includes(`,`)){let n$1=r$1.split(`,`),[i$2]=n$1,s$1;i$2.startsWith(TAG_PREFIX)?(s$1=i$2.substring(4),n$1.shift()):s$1=NO_TAG;let[o$1,a$1,,u$1]=n$1,l$1=Number.parseFloat(o$1);if(this.baseTimeSec||(l$1<this.startTimeSec-31536e3?this.baseTimeSec=this.startTimeSec:this.baseTimeSec=0),e$2<l$1)return null;if(l$1<t$1)continue;let h$2=decodeFromCompressedBase64(u$1,this.bitBucketSize,this.useWebAssembly);h$2.startTimeStampMsec=1e3*(this.baseTimeSec+l$1);let c$2=Number.parseFloat(a$1);return h$2.endTimeStampMsec=1e3*(this.baseTimeSec+l$1+c$2),h$2.tag=s$1,h$2}}return null}parseStartTimeFromLine(t$1){this.startTimeSec=Number.parseFloat(t$1.split(` `)[1])}parseBaseTimeFromLine(t$1){this.baseTimeSec=Number.parseFloat(t$1.split(` `)[1])}}let splitLines=t$1=>t$1.split(/\r\n|\r|\n/g),shouldIncludeNoTag=t$1=>t$1.find(t$2=>!t$2.startsWith(`#`)&&!t$2.startsWith(`"`)&&!t$2.startsWith(TAG_PREFIX)&&t$2.includes(`,`)),listTags=t$1=>{let e$2=splitLines(t$1),r$1=e$2.filter(t$2=>t$2.includes(`,`)&&t$2.startsWith(TAG_PREFIX)).map(t$2=>t$2.substring(4,t$2.indexOf(`,`))),n$1=new Set(r$1),i$2=Array.from(n$1);return shouldIncludeNoTag(e$2)&&i$2.unshift(`NO TAG`),i$2},HISTOGRAM_LOG_FORMAT_VERSION=`1.3`,timeFormatter=floatFormatter(5,3);class HistogramLogWriter{constructor(t$1){this.log=t$1,this.baseTime=0}outputIntervalHistogram(t$1,e$2=(t$1.startTimeStampMsec-this.baseTime)/1e3,r$1=(t$1.endTimeStampMsec-this.baseTime)/1e3,n$1=1e3){let i$2=encodeIntoCompressedBase64(t$1),s$1=`${timeFormatter(e$2)},${timeFormatter(r$1-e$2)},${timeFormatter(t$1.maxValue/n$1)},${i$2}\n`;t$1.tag&&t$1.tag!==NO_TAG?this.log(`Tag=${t$1.tag},${s$1}`):this.log(s$1)}outputComment(t$1){this.log(`#${t$1}\n`)}outputStartTime(t$1){this.outputComment(`[StartTime: ${floatFormatter(5,3)(t$1/1e3)} (seconds since epoch), ${new Date(t$1)}]\n`)}outputLegend(){this.log(`"StartTimestamp","Interval_Length","Interval_Max","Interval_Compressed_Histogram"
`)}outputLogFormatVersion(){this.outputComment(`[Histogram log format version 1.3]`)}}let defaultRequest={bitBucketSize:32,autoResize:!0,lowestDiscernibleValue:1,highestTrackableValue:2,numberOfSignificantValueDigits:3,useWebAssembly:!1},build$1=(t$1=defaultRequest)=>{let e$2=Object.assign({},defaultRequest,t$1);if(t$1.useWebAssembly&&webAssemblyAvailable)return WasmHistogram.build(e$2);let r$1=new(constructorFromBucketSize(e$2.bitBucketSize))(e$2.lowestDiscernibleValue,e$2.highestTrackableValue,e$2.numberOfSignificantValueDigits);return r$1.autoResize=e$2.autoResize,r$1};class Recorder{constructor(t$1=defaultRequest,e$2=(()=>new Date().getTime())){this.histogramBuildRequest=t$1,this.clock=e$2,this.activeHistogram=build$1(this.histogramBuildRequest),Recorder.idGenerator++,this.activeHistogram.containingInstanceId=Recorder.idGenerator,this.activeHistogram.startTimeStampMsec=e$2()}recordValue(t$1){this.activeHistogram.recordValue(t$1)}recordValueWithCount(t$1,e$2){this.activeHistogram.recordValueWithCount(t$1,e$2)}recordValueWithExpectedInterval(t$1,e$2){this.activeHistogram.recordValueWithExpectedInterval(t$1,e$2)}getIntervalHistogram(t$1){if(t$1&&t$1.containingInstanceId!==this.activeHistogram.containingInstanceId)throw`replacement histogram must have been obtained via a previous getIntervalHistogram() call from this Recorder`;this.inactiveHistogram=t$1,this.performIntervalSample();let e$2=this.inactiveHistogram;return this.inactiveHistogram=null,e$2}getIntervalHistogramInto(t$1){this.performIntervalSample(),this.inactiveHistogram&&(t$1.add(this.inactiveHistogram),t$1.startTimeStampMsec=this.inactiveHistogram.startTimeStampMsec,t$1.endTimeStampMsec=this.inactiveHistogram.endTimeStampMsec)}reset(){this.activeHistogram.reset(),this.activeHistogram.startTimeStampMsec=this.clock()}performIntervalSample(){this.inactiveHistogram||(this.inactiveHistogram=build$1(this.histogramBuildRequest),this.inactiveHistogram.containingInstanceId=this.activeHistogram.containingInstanceId),this.inactiveHistogram.reset();let t$1=this.activeHistogram;this.activeHistogram=this.inactiveHistogram,this.inactiveHistogram=t$1;let e$2=this.clock();this.inactiveHistogram.endTimeStampMsec=e$2,this.activeHistogram.startTimeStampMsec=e$2}destroy(){var t$1;this.activeHistogram.destroy(),(t$1=this.inactiveHistogram)==null||t$1.destroy()}}Recorder.idGenerator=0,exports$1.ByteBuffer=ByteBuffer,exports$1.Float64Histogram=Float64Histogram,exports$1.HistogramLogReader=HistogramLogReader,exports$1.HistogramLogWriter=HistogramLogWriter,exports$1.Int16Histogram=Int16Histogram,exports$1.Int32Histogram=Int32Histogram,exports$1.Int8Histogram=Int8Histogram,exports$1.JsHistogram=JsHistogram,exports$1.PackedHistogram=PackedHistogram,exports$1.Recorder=Recorder,exports$1.WasmHistogram=WasmHistogram,exports$1.build=build$1,exports$1.decodeFromCompressedBase64=decodeFromCompressedBase64,exports$1.encodeIntoCompressedBase64=encodeIntoCompressedBase64,exports$1.initWebAssembly=initWebAssembly,exports$1.initWebAssemblySync=initWebAssemblySync,exports$1.listTags=listTags,Object.defineProperty(exports$1,`__esModule`,{value:!0})}))}))()),PerformanceTracker=class{static{this.ENABLED=!0}static{this.TRACK_PERCENTILES=!0}static{this.measurements=new Map}static{this.histograms=new Map}static{this.periodicLogInterval=null}static getHistogram(label){let histogram=this.histograms.get(label);return histogram||(histogram=(0,import_hdrhistogram_umd.build)({lowestDiscernibleValue:1,highestTrackableValue:1e3,numberOfSignificantValueDigits:2}),this.histograms.set(label,histogram)),histogram}static start(label){this.ENABLED&&this.measurements.set(label,performance.now())}static end(label,_additionalInfo){if(!this.ENABLED)return 0;let startTime=this.measurements.get(label);if(startTime===void 0)return 0;let duration=performance.now()-startTime;return this.measurements.delete(label),this.TRACK_PERCENTILES&&this.getHistogram(label).recordValue(Math.max(1,Math.round(duration))),duration}static log(message){this.ENABLED&&console.log(`[PERF] ${message}`)}static measure(label,fn,_additionalInfo){if(!this.ENABLED)return fn();let startTime=performance.now(),result=fn(),duration=performance.now()-startTime;return this.TRACK_PERCENTILES&&this.getHistogram(label).recordValue(Math.max(1,Math.round(duration))),result}static getStats(label){if(!this.TRACK_PERCENTILES)return null;let histogram=this.histograms.get(label);return!histogram||histogram.totalCount===0?null:{p50:histogram.getValueAtPercentile(50),p95:histogram.getValueAtPercentile(95),p99:histogram.getValueAtPercentile(99),min:histogram.minNonZeroValue,max:histogram.maxValue,mean:histogram.mean,count:histogram.totalCount}}static printStats(label){let stats=this.getStats(label);if(!stats){console.log(`[PERF] ${label}: No data`);return}console.log(`[PERF] ${label.padEnd(16)} | n=${stats.count.toString().padStart(5)} | p50=${stats.p50.toFixed(1).padStart(5)}ms | p95=${stats.p95.toFixed(1).padStart(5)}ms | p99=${stats.p99.toFixed(1).padStart(5)}ms | mean=${stats.mean.toFixed(1).padStart(5)}ms | max=${stats.max.toFixed(1).padStart(5)}ms`)}static printAllStats(){if(this.histograms.size===0){console.log(`[PERF] No data collected`);return}console.log(`[PERF] STATS -------------`),this.histograms.forEach((_histogram,label)=>{this.printStats(label)})}static resetStats(){this.histograms.forEach(histogram=>{histogram.reset()})}static resetStatsFor(label){let histogram=this.histograms.get(label);histogram&&histogram.reset()}static startPeriodicLogging(intervalMs=1e4){this.periodicLogInterval===null&&(this.periodicLogInterval=setInterval(()=>{this.printAllStats()},intervalMs))}static stopPeriodicLogging(){this.periodicLogInterval!==null&&(clearInterval(this.periodicLogInterval),this.periodicLogInterval=null)}},ChartController=class{constructor(timeSeriesStore,paneManager,commonScaleManager){this.timeSeriesStore=timeSeriesStore,this.paneManager=paneManager,this.commonScaleManager=commonScaleManager,this.renderBatcher=new RenderBatcher,this.timeSeriesStore.setOnChange(changeType=>this.handleDataChange(changeType))}setOnRender(callback){this.renderBatcher.setOnRender(callback)}loadInitialData(candles){this.timeSeriesStore.reset(candles)}handleRealtimeUpdate(candle){this.timeSeriesStore.add(candle)}loadMoreHistorical(historicalCandles){this.timeSeriesStore.prepend(historicalCandles)}handleDataChange(changeType){PerformanceTracker.start(`update`);let allCandles=this.timeSeriesStore.getAll(),{startIndex,endIndex}=this.commonScaleManager.getVisibleDomainIndices(),oldDomainLength=this.commonScaleManager.timeScale.getFullDomain().length;if(changeType===`append`||changeType===`prepend`||changeType===`reset`){let timestamps=allCandles.map(c$2=>c$2.timestamp);if(changeType===`append`){let wasViewingLatest=endIndex===allCandles.length-2;if(this.commonScaleManager.updateTimeScaleDomain(timestamps),wasViewingLatest){this.commonScaleManager.updateTimeScale(startIndex+1,endIndex+1),this.recalculatePriceScalesFromVisibleCandles(),PerformanceTracker.end(`update`,`type=${changeType}`);return}else{this.renderBatcher.requestRender(),PerformanceTracker.end(`update`,`type=${changeType} (no recalc)`);return}}else if(changeType===`prepend`){this.commonScaleManager.updateTimeScaleDomain(timestamps);let prependedCount=allCandles.length-oldDomainLength,newStartIndex=startIndex+prependedCount,newEndIndex=endIndex+prependedCount;this.commonScaleManager.updateTimeScale(newStartIndex,newEndIndex),this.paneManager.prependHistoricalCandles(allCandles),this.recalculatePriceScalesFromVisibleCandles(),PerformanceTracker.end(`update`,`type=${changeType}, prepended=${prependedCount}`);return}else this.commonScaleManager.updateTimeScaleDomain(timestamps)}if(changeType===`update`){let lastCandleIndex=allCandles.length-1,isLastCandleVisible=lastCandleIndex>=startIndex&&lastCandleIndex<=endIndex;this.paneManager.updateLastCandle(allCandles),isLastCandleVisible?(this.recalculatePriceScalesFromVisibleCandles(),PerformanceTracker.end(`update`,`type=${changeType}`)):(this.renderBatcher.requestRender(),PerformanceTracker.end(`update`,`type=${changeType} (not visible, render only)`));return}if(changeType===`reset`){this.paneManager.resetCandles(allCandles),this.recalculatePriceScalesFromVisibleCandles(),PerformanceTracker.end(`update`,`type=${changeType}`);return}}applyScaleUpdates(scaleUpdates){let mainUpdate=scaleUpdates.get(`main`);mainUpdate?.yDomain&&this.commonScaleManager.updatePriceScale(mainUpdate.yDomain.min,mainUpdate.yDomain.max)}recalculatePriceScalesFromVisibleCandles(){PerformanceTracker.start(`recalculation`);let allCandles=this.timeSeriesStore.getAll();if(allCandles.length===0)return;let{startIndex,endIndex}=this.commonScaleManager.getVisibleDomainIndices(),visibleCandles=allCandles.slice(startIndex,endIndex+1);if(visibleCandles.length===0)return;let priceMin=1/0,priceMax=-1/0;for(let candle of visibleCandles)candle.high>priceMax&&(priceMax=candle.high),candle.low<priceMin&&(priceMin=candle.low);let padding=(priceMax-priceMin)*.02;priceMin-=padding,priceMax+=padding,this.commonScaleManager.updatePriceScale(priceMin,priceMax),this.paneManager.updateScales(!0,!0),PerformanceTracker.end(`recalculation`,`visible=${visibleCandles.length}`),this.renderBatcher.requestRender()}destroy(){this.renderBatcher.destroy()}},PolylineRenderer=class{render(ctx,batch$1){if(batch$1.points.length===0)return;let startIdx=0;for(;startIdx<batch$1.points.length&&(Number.isNaN(batch$1.points[startIdx].x)||Number.isNaN(batch$1.points[startIdx].y));)startIdx++;if(!(startIdx>=batch$1.points.length)){ctx.save(),ctx.strokeStyle=batch$1.color,ctx.lineWidth=batch$1.lineWidth,ctx.lineCap=`round`,ctx.lineJoin=`round`,batch$1.lineDash&&ctx.setLineDash(batch$1.lineDash),ctx.beginPath(),ctx.moveTo(batch$1.points[startIdx].x,batch$1.points[startIdx].y);for(let i$1=startIdx+1;i$1<batch$1.points.length;i$1++){let pt=batch$1.points[i$1];if(Number.isNaN(pt.x)||Number.isNaN(pt.y)){ctx.stroke();let nextValidIdx=i$1+1;for(;nextValidIdx<batch$1.points.length;){let nextPt=batch$1.points[nextValidIdx];if(!Number.isNaN(nextPt.x)&&!Number.isNaN(nextPt.y)){ctx.beginPath(),ctx.moveTo(nextPt.x,nextPt.y),i$1=nextValidIdx;break}nextValidIdx++}if(nextValidIdx>=batch$1.points.length)break}else ctx.lineTo(pt.x,pt.y)}ctx.stroke(),ctx.restore()}}},BandFillRenderer=class{render(ctx,batch$1){if(batch$1.upperPoints.length===0||batch$1.lowerPoints.length===0)return;ctx.save(),ctx.globalAlpha=batch$1.fillOpacity,ctx.fillStyle=batch$1.fillColor,ctx.beginPath();let firstUpper=batch$1.upperPoints[0];ctx.moveTo(firstUpper.x,firstUpper.y);for(let i$1=1;i$1<batch$1.upperPoints.length;i$1++){let pt=batch$1.upperPoints[i$1];ctx.lineTo(pt.x,pt.y)}for(let i$1=batch$1.lowerPoints.length-1;i$1>=0;i$1--){let pt=batch$1.lowerPoints[i$1];ctx.lineTo(pt.x,pt.y)}if(ctx.closePath(),ctx.fill(),ctx.restore(),batch$1.showBorders){ctx.save(),ctx.strokeStyle=batch$1.borderColor,ctx.lineWidth=batch$1.borderWidth,ctx.lineCap=`round`,ctx.lineJoin=`round`,ctx.beginPath();let firstUpperBorder=batch$1.upperPoints[0];ctx.moveTo(firstUpperBorder.x,firstUpperBorder.y);for(let i$1=1;i$1<batch$1.upperPoints.length;i$1++){let pt=batch$1.upperPoints[i$1];ctx.lineTo(pt.x,pt.y)}ctx.stroke(),ctx.beginPath();let firstLowerBorder=batch$1.lowerPoints[0];ctx.moveTo(firstLowerBorder.x,firstLowerBorder.y);for(let i$1=1;i$1<batch$1.lowerPoints.length;i$1++){let pt=batch$1.lowerPoints[i$1];ctx.lineTo(pt.x,pt.y)}ctx.stroke(),ctx.restore()}if(batch$1.middlePoints.length>0){ctx.save(),ctx.strokeStyle=batch$1.borderColor,ctx.lineWidth=batch$1.borderWidth,ctx.lineCap=`round`,ctx.lineJoin=`round`,ctx.beginPath();let firstMiddle=batch$1.middlePoints[0];ctx.moveTo(firstMiddle.x,firstMiddle.y);for(let i$1=1;i$1<batch$1.middlePoints.length;i$1++){let pt=batch$1.middlePoints[i$1];ctx.lineTo(pt.x,pt.y)}ctx.stroke(),ctx.restore()}}},CandleBatchRenderer=class{constructor(context$1){this.context=context$1}render(ctx,batch$1){if(batch$1.candles.length===0)return;let theme$1=this.context.config.theme.colors,positiveColor=theme$1.candlePositive,negativeColor=theme$1.candleNegative,positive=[],negative=[];for(let candle of batch$1.candles)candle.isPositive?positive.push(candle):negative.push(candle);if(ctx.save(),positive.length>0){ctx.fillStyle=positiveColor,ctx.strokeStyle=positiveColor,ctx.lineWidth=1;for(let candle of positive)this.drawCandle(ctx,candle)}if(negative.length>0){ctx.fillStyle=negativeColor,ctx.strokeStyle=negativeColor,ctx.lineWidth=1;for(let candle of negative)this.drawCandle(ctx,candle)}ctx.restore()}drawCandle(ctx,candle){ctx.beginPath(),ctx.moveTo(candle.x,candle.upperWick.y1),ctx.lineTo(candle.x,candle.upperWick.y2),ctx.stroke(),ctx.beginPath(),ctx.moveTo(candle.x,candle.lowerWick.y1),ctx.lineTo(candle.x,candle.lowerWick.y2),ctx.stroke(),ctx.fillRect(candle.x-candle.body.width/2,candle.body.y,candle.body.width,candle.body.height)}},BarBatchRenderer=class{constructor(context$1){this.context=context$1}render(ctx,batch$1){if(batch$1.bars.length===0)return;let theme$1=this.context.config.theme.colors,positiveColor=theme$1.candlePositive,negativeColor=theme$1.candleNegative,positive=[],negative=[];for(let bar of batch$1.bars)bar.isPositive?positive.push(bar):negative.push(bar);if(ctx.save(),positive.length>0){ctx.fillStyle=positiveColor;for(let bar of positive)ctx.fillRect(bar.x,bar.y,bar.width,bar.height)}if(negative.length>0){ctx.fillStyle=negativeColor;for(let bar of negative)ctx.fillRect(bar.x,bar.y,bar.width,bar.height)}ctx.restore()}};function drawLine(ctx,line,color$2,lineWidth=1){Number.isNaN(line.start.x)||Number.isNaN(line.start.y)||Number.isNaN(line.end.x)||Number.isNaN(line.end.y)||(ctx.save(),line.lineDash&&ctx.setLineDash(line.lineDash),ctx.beginPath(),ctx.moveTo(line.start.x,line.start.y),ctx.lineTo(line.end.x,line.end.y),ctx.strokeStyle=color$2,ctx.lineWidth=lineWidth,ctx.stroke(),ctx.restore())}var Canvas2DCompositor=class{constructor(canvas,context$1){this.canvas=canvas;let ctx=canvas.getContext(`2d`);if(!ctx)throw Error(`Failed to get 2D context from canvas`);this.ctx=ctx,this.context=context$1,this.polylineRenderer=new PolylineRenderer,this.bandFillRenderer=new BandFillRenderer,this.candleBatchRenderer=new CandleBatchRenderer(context$1),this.barBatchRenderer=new BarBatchRenderer(context$1)}render(batch$1){switch(batch$1.type){case`polyline`:this.polylineRenderer.render(this.ctx,batch$1);break;case`bandfill`:this.bandFillRenderer.render(this.ctx,batch$1);break;case`candle`:this.candleBatchRenderer.render(this.ctx,batch$1);break;case`bar`:this.barBatchRenderer.render(this.ctx,batch$1);break;default:console.warn(`Unknown batch type: ${batch$1.type}`);break}}renderShapes(shapes){for(let shape of shapes)switch(shape.type){case`line`:let color$2=shape.color??`#000000`,lineWidth=shape.lineWidth??1;drawLine(this.ctx,shape,color$2,lineWidth);break;case`text`:this.ctx.save(),this.ctx.fillStyle=shape.color,this.ctx.font=shape.font,this.ctx.textAlign=shape.align,this.ctx.textBaseline=shape.baseline,this.ctx.fillText(shape.text,shape.position.x,shape.position.y),this.ctx.restore();break;case`boxedText`:this.ctx.save(),this.ctx.font=shape.font,this.ctx.textAlign=shape.align,this.ctx.textBaseline=shape.baseline;let textWidth=this.ctx.measureText(shape.text).width,textHeight=parseInt(shape.font),boxWidth=textWidth+shape.padding*2,boxHeight=textHeight+shape.padding*2,boxX=shape.position.x;shape.align===`center`?boxX-=boxWidth/2:shape.align===`right`&&(boxX-=boxWidth);let boxY=shape.position.y;shape.baseline===`middle`?boxY-=boxHeight/2:shape.baseline===`bottom`&&(boxY-=boxHeight),this.ctx.fillStyle=shape.backgroundColor,this.ctx.fillRect(boxX,boxY,boxWidth,boxHeight),shape.borderColor&&(this.ctx.strokeStyle=shape.borderColor,this.ctx.lineWidth=1,this.ctx.strokeRect(boxX,boxY,boxWidth,boxHeight));let textX=boxX+shape.padding;shape.align===`center`?textX=boxX+boxWidth/2:shape.align===`right`&&(textX=boxX+boxWidth-shape.padding);let textY=boxY+shape.padding;shape.baseline===`middle`?textY=boxY+boxHeight/2:shape.baseline===`bottom`&&(textY=boxY+boxHeight-shape.padding),this.ctx.fillStyle=shape.textColor,this.ctx.fillText(shape.text,textX,textY),this.ctx.restore();break;default:break}}clear(){this.ctx.fillStyle=this.context.config.theme.colors.background,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}setupHighDPI(width,height){let dpr$1=window.devicePixelRatio||1;this.canvas.width=width*dpr$1,this.canvas.height=height*dpr$1,this.canvas.style.width=`${width}px`,this.canvas.style.height=`${height}px`,this.ctx.scale(dpr$1,dpr$1)}setClipRegion(bounds){this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(bounds.x,bounds.y,bounds.width,bounds.height),this.ctx.clip()}clearClipRegion(){this.ctx.restore()}drawBorder(bounds){this.ctx.save(),this.ctx.strokeStyle=this.context.config.theme.colors.borderColor,this.ctx.lineWidth=1,this.ctx.strokeRect(bounds.x,bounds.y,bounds.width,bounds.height),this.ctx.restore()}},PixiPolylineRenderer=class{hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}render(graphics,batch$1){let points$1=batch$1.points;if(points$1.length===0)return;let color$2=this.hexToNumber(batch$1.color);graphics.moveTo(points$1[0].x,points$1[0].y);for(let i$1=1;i$1<points$1.length;i$1++)graphics.lineTo(points$1[i$1].x,points$1[i$1].y);batch$1.lineDash&&batch$1.lineDash.length,graphics.stroke({width:batch$1.lineWidth,color:color$2})}},PixiBandFillRenderer=class{hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}render(graphics,batch$1){if(batch$1.upperPoints.length===0||batch$1.lowerPoints.length===0)return;let fillColor=this.hexToNumber(batch$1.fillColor),borderColor=this.hexToNumber(batch$1.borderColor);graphics.moveTo(batch$1.upperPoints[0].x,batch$1.upperPoints[0].y);for(let i$1=1;i$1<batch$1.upperPoints.length;i$1++)graphics.lineTo(batch$1.upperPoints[i$1].x,batch$1.upperPoints[i$1].y);for(let i$1=batch$1.lowerPoints.length-1;i$1>=0;i$1--)graphics.lineTo(batch$1.lowerPoints[i$1].x,batch$1.lowerPoints[i$1].y);if(graphics.closePath(),graphics.fill({color:fillColor,alpha:batch$1.fillOpacity}),batch$1.showBorders){graphics.moveTo(batch$1.upperPoints[0].x,batch$1.upperPoints[0].y);for(let i$1=1;i$1<batch$1.upperPoints.length;i$1++)graphics.lineTo(batch$1.upperPoints[i$1].x,batch$1.upperPoints[i$1].y);graphics.stroke({width:batch$1.borderWidth,color:borderColor}),graphics.moveTo(batch$1.middlePoints[0].x,batch$1.middlePoints[0].y);for(let i$1=1;i$1<batch$1.middlePoints.length;i$1++)graphics.lineTo(batch$1.middlePoints[i$1].x,batch$1.middlePoints[i$1].y);graphics.stroke({width:batch$1.borderWidth,color:borderColor}),graphics.moveTo(batch$1.lowerPoints[0].x,batch$1.lowerPoints[0].y);for(let i$1=1;i$1<batch$1.lowerPoints.length;i$1++)graphics.lineTo(batch$1.lowerPoints[i$1].x,batch$1.lowerPoints[i$1].y);graphics.stroke({width:batch$1.borderWidth,color:borderColor})}}},PixiCandleBatchRenderer=class{constructor(context$1){this.context=context$1}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}render(graphics,batch$1){let positiveColor=this.hexToNumber(this.context.config.theme.colors.candlePositive),negativeColor=this.hexToNumber(this.context.config.theme.colors.candleNegative),positiveCandles=batch$1.candles.filter(c$2=>c$2.isPositive),negativeCandles=batch$1.candles.filter(c$2=>!c$2.isPositive);this.renderCandleGroup(graphics,positiveCandles,positiveColor),this.renderCandleGroup(graphics,negativeCandles,negativeColor)}renderCandleGroup(graphics,candles,color$2){if(candles.length!==0){for(let candle of candles)graphics.moveTo(candle.x,candle.upperWick.y1),graphics.lineTo(candle.x,candle.upperWick.y2),graphics.moveTo(candle.x,candle.lowerWick.y1),graphics.lineTo(candle.x,candle.lowerWick.y2);graphics.stroke({width:1,color:color$2});for(let candle of candles)graphics.rect(candle.x-candle.body.width/2,candle.body.y,candle.body.width,candle.body.height);graphics.fill({color:color$2})}}},PixiBarBatchRenderer=class{constructor(context$1){this.context=context$1}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}render(graphics,batch$1){let positiveColor=this.hexToNumber(this.context.config.theme.colors.candlePositive),negativeColor=this.hexToNumber(this.context.config.theme.colors.candleNegative),positiveBars=batch$1.bars.filter(b$1=>b$1.isPositive),negativeBars=batch$1.bars.filter(b$1=>!b$1.isPositive);this.renderBarGroup(graphics,positiveBars,positiveColor),this.renderBarGroup(graphics,negativeBars,negativeColor)}renderBarGroup(graphics,bars,color$2){if(bars.length!==0){for(let bar of bars)graphics.rect(bar.x,bar.y,bar.width,bar.height);graphics.fill({color:color$2})}}},PixiCompositor=class{constructor(canvas,context$1){this.app=null,this.graphicsList=[],this.context=context$1,this.canvas=canvas,this.targetWidth=context$1.config.size.width,this.targetHeight=context$1.config.size.height,this.container=new Container,this.currentGraphics=new Graphics,this.container.addChild(this.currentGraphics),this.graphicsList.push(this.currentGraphics),this.polylineRenderer=new PixiPolylineRenderer,this.bandFillRenderer=new PixiBandFillRenderer,this.candleBatchRenderer=new PixiCandleBatchRenderer(context$1),this.barBatchRenderer=new PixiBarBatchRenderer(context$1),this.initPromise=this.initAsync(canvas)}async initAsync(canvas){try{this.app=new Application,await this.app.init({canvas,width:this.targetWidth,height:this.targetHeight,backgroundColor:this.hexToNumber(this.context.config.theme.colors.background),antialias:!0,autoDensity:!0,resolution:window.devicePixelRatio||1}),this.app.stage.addChild(this.container),console.log(`PixiJS compositor initialized successfully`)}catch(error$1){throw console.error(`Failed to initialize PixiJS:`,error$1),error$1}}waitForInit(){return this.initPromise}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}parseFont(font){let parts=font.trim().split(/\s+/),size=10,family=`sans-serif`,weight;for(let i$1=0;i$1<parts.length;i$1++){let part=parts[i$1];if(part.includes(`px`))size=parseInt(part.replace(`px`,``),10);else if(part===`bold`||part===`normal`||/^\d00$/.test(part))weight=part;else if(!part.includes(`px`)&&part!==`bold`&&part!==`normal`){family=parts.slice(i$1).join(` `);break}}return{size,family,weight}}getTextAnchor(align,baseline){let x$1=.5;align===`left`||align===`start`?x$1=0:align===`right`||align===`end`?x$1=1:align===`center`&&(x$1=.5);let y$1=.5;return baseline===`top`||baseline===`hanging`?y$1=0:baseline===`bottom`||baseline===`ideographic`?y$1=1:baseline===`middle`?y$1=.5:baseline===`alphabetic`&&(y$1=.8),{x:x$1,y:y$1}}render(batch$1){if(!this.app){console.warn(`PixiJS not initialized yet, skipping render`);return}switch(batch$1.type){case`polyline`:this.polylineRenderer.render(this.currentGraphics,batch$1);break;case`bandfill`:this.bandFillRenderer.render(this.currentGraphics,batch$1);break;case`candle`:this.candleBatchRenderer.render(this.currentGraphics,batch$1);break;case`bar`:this.barBatchRenderer.render(this.currentGraphics,batch$1);break;default:console.warn(`Unknown batch type: ${batch$1.type}`);break}}renderShapes(shapes){if(!this.app){console.warn(`PixiJS not initialized yet, skipping renderShapes`);return}for(let shape of shapes)switch(shape.type){case`line`:{let color$2=this.hexToNumber(shape.color??`#000000`),lineWidth=shape.lineWidth??1;this.currentGraphics.moveTo(shape.start.x,shape.start.y),this.currentGraphics.lineTo(shape.end.x,shape.end.y),this.currentGraphics.stroke({width:lineWidth,color:color$2});break}case`text`:{let fontInfo=this.parseFont(shape.font),anchor=this.getTextAnchor(shape.align,shape.baseline),textStyle=new TextStyle({fontFamily:fontInfo.family,fontSize:fontInfo.size,fontWeight:fontInfo.weight,fill:shape.color,align:shape.align===`center`?`center`:shape.align===`right`?`right`:`left`}),text=new Text({text:shape.text,style:textStyle});text.x=shape.position.x,text.y=shape.position.y,text.anchor.set(anchor.x,anchor.y),this.container.addChild(text);break}default:break}}clear(){if(this.app){for(let graphics of this.graphicsList)this.container.removeChild(graphics),graphics.destroy();for(this.graphicsList=[];this.container.children.length>0;){let child=this.container.children[0];child.destroy({children:!0}),this.container.removeChild(child)}this.currentGraphics=new Graphics,this.container.addChild(this.currentGraphics),this.graphicsList.push(this.currentGraphics)}}setupHighDPI(width,height){this.targetWidth=width,this.targetHeight=height,this.app?.renderer&&this.app.renderer.resize(width,height)}setClipRegion(bounds){if(!this.app)return;let graphics=new Graphics,mask=new Graphics;mask.rect(bounds.x,bounds.y,bounds.width,bounds.height),mask.fill({color:16777215}),this.container.addChild(mask),graphics.mask=mask,this.container.addChild(graphics),this.graphicsList.push(graphics),this.currentGraphics=graphics}clearClipRegion(){if(!this.app)return;let graphics=new Graphics;this.container.addChild(graphics),this.graphicsList.push(graphics),this.currentGraphics=graphics}drawBorder(bounds){if(!this.app)return;let color$2=this.hexToNumber(this.context.config.theme.colors.borderColor);this.currentGraphics.rect(bounds.x,bounds.y,bounds.width,bounds.height),this.currentGraphics.stroke({width:1,color:color$2})}destroy(){for(let graphics of this.graphicsList)graphics.destroy();this.graphicsList=[],this.app&&=(this.app.destroy(!0,{children:!0}),null)}},PixiMeshPolylineRenderer=class{hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}hexToRGB(hex$1){let num=this.hexToNumber(hex$1);return[(num>>16&255)/255,(num>>8&255)/255,(num&255)/255]}render(container,batch$1){let points$1=batch$1.points;if(points$1.length<2)return;let halfWidth=batch$1.lineWidth/2,color$2=this.hexToNumber(batch$1.color),vertices=[],indices=[],uvs=[];for(let i$1=0;i$1<points$1.length-1;i$1++){let p1=points$1[i$1],p2=points$1[i$1+1],dx=p2.x-p1.x,dy=p2.y-p1.y,length$1=Math.sqrt(dx*dx+dy*dy);if(length$1===0)continue;let nx=-dy/length$1*halfWidth,ny=dx/length$1*halfWidth,baseIdx=vertices.length/2;vertices.push(p1.x-nx,p1.y-ny),uvs.push(0,0),vertices.push(p1.x+nx,p1.y+ny),uvs.push(1,0),vertices.push(p2.x+nx,p2.y+ny),uvs.push(1,1),vertices.push(p2.x-nx,p2.y-ny),uvs.push(0,1),indices.push(baseIdx,baseIdx+1,baseIdx+2),indices.push(baseIdx,baseIdx+2,baseIdx+3)}if(vertices.length===0)return;let geometry=new Geometry({attributes:{aPosition:new Float32Array(vertices),aUV:new Float32Array(uvs)},indexBuffer:new Uint16Array(indices)}),texture=Texture.WHITE,mesh=new Mesh({geometry,texture});mesh.tint=color$2,container.addChild(mesh)}renderWithMesh(container,batch$1){let points$1=batch$1.points;if(points$1.length<2)return;let halfWidth=batch$1.lineWidth/2,color$2=this.hexToNumber(batch$1.color),vertices=[],indices=[],uvs=[];for(let i$1=0;i$1<points$1.length-1;i$1++){let p1=points$1[i$1],p2=points$1[i$1+1],dx=p2.x-p1.x,dy=p2.y-p1.y,length$1=Math.sqrt(dx*dx+dy*dy);if(length$1===0)continue;let nx=-dy/length$1*halfWidth,ny=dx/length$1*halfWidth,baseIdx=vertices.length/2;vertices.push(p1.x-nx,p1.y-ny),uvs.push(0,0),vertices.push(p1.x+nx,p1.y+ny),uvs.push(1,0),vertices.push(p2.x+nx,p2.y+ny),uvs.push(1,1),vertices.push(p2.x-nx,p2.y-ny),uvs.push(0,1),indices.push(baseIdx,baseIdx+1,baseIdx+2),indices.push(baseIdx,baseIdx+2,baseIdx+3)}if(vertices.length===0)return;let geometry=new Geometry({attributes:{aPosition:new Float32Array(vertices),aUV:new Float32Array(uvs)},indexBuffer:new Uint16Array(indices)}),texture=Texture.WHITE,mesh=new Mesh({geometry,texture});mesh.tint=color$2,container.addChild(mesh)}},PixiMeshBandFillRenderer=class{hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}hexToRGB(hex$1){let num=this.hexToNumber(hex$1);return[(num>>16&255)/255,(num>>8&255)/255,(num&255)/255]}render(container,batch$1){if(batch$1.upperPoints.length===0||batch$1.lowerPoints.length===0)return;let fillColor=this.hexToRGB(batch$1.fillColor),borderColor=this.hexToNumber(batch$1.borderColor);this.renderFill(container,batch$1,fillColor),batch$1.showBorders&&this.renderBorders(container,batch$1,borderColor)}renderFill(container,batch$1,fillColor){let upperPoints=batch$1.upperPoints,lowerPoints=batch$1.lowerPoints;if(upperPoints.length===0||lowerPoints.length===0)return;if(upperPoints.length!==lowerPoints.length){console.warn(`Upper and lower points count mismatch in BandFill`);return}let vertices=[],indices=[],uvs=[];for(let i$1=0;i$1<upperPoints.length-1;i$1++){let upperLeft=upperPoints[i$1],upperRight=upperPoints[i$1+1],lowerLeft=lowerPoints[i$1],lowerRight=lowerPoints[i$1+1],baseIdx=vertices.length/2;vertices.push(upperLeft.x,upperLeft.y),uvs.push(0,0),vertices.push(upperRight.x,upperRight.y),uvs.push(1,0),vertices.push(lowerRight.x,lowerRight.y),uvs.push(1,1),vertices.push(lowerLeft.x,lowerLeft.y),uvs.push(0,1),indices.push(baseIdx,baseIdx+1,baseIdx+2),indices.push(baseIdx,baseIdx+2,baseIdx+3)}if(vertices.length===0)return;let geometry=new Geometry({attributes:{aPosition:new Float32Array(vertices),aUV:new Float32Array(uvs)},indexBuffer:new Uint16Array(indices)}),texture=Texture.WHITE,fillColorNum=this.hexToNumber(batch$1.fillColor),mesh=new Mesh({geometry,texture});mesh.tint=fillColorNum,mesh.alpha=batch$1.fillOpacity,container.addChild(mesh)}renderBorders(container,batch$1,borderColor){let upperGraphics=new Graphics;upperGraphics.moveTo(batch$1.upperPoints[0].x,batch$1.upperPoints[0].y);for(let i$1=1;i$1<batch$1.upperPoints.length;i$1++)upperGraphics.lineTo(batch$1.upperPoints[i$1].x,batch$1.upperPoints[i$1].y);upperGraphics.stroke({width:batch$1.borderWidth,color:borderColor}),container.addChild(upperGraphics);let middleGraphics=new Graphics;middleGraphics.moveTo(batch$1.middlePoints[0].x,batch$1.middlePoints[0].y);for(let i$1=1;i$1<batch$1.middlePoints.length;i$1++)middleGraphics.lineTo(batch$1.middlePoints[i$1].x,batch$1.middlePoints[i$1].y);middleGraphics.stroke({width:batch$1.borderWidth,color:borderColor}),container.addChild(middleGraphics);let lowerGraphics=new Graphics;lowerGraphics.moveTo(batch$1.lowerPoints[0].x,batch$1.lowerPoints[0].y);for(let i$1=1;i$1<batch$1.lowerPoints.length;i$1++)lowerGraphics.lineTo(batch$1.lowerPoints[i$1].x,batch$1.lowerPoints[i$1].y);lowerGraphics.stroke({width:batch$1.borderWidth,color:borderColor}),container.addChild(lowerGraphics)}triangulatePolygon(points$1){let indices=[];for(let i$1=1;i$1<points$1.length-1;i$1++)indices.push(0,i$1,i$1+1);return indices}},PixiMeshCandleBatchRenderer=class{constructor(context$1){this.context=context$1}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}hexToRGB(hex$1){let num=this.hexToNumber(hex$1);return[(num>>16&255)/255,(num>>8&255)/255,(num&255)/255]}render(container,batch$1){let positiveColor=this.context.config.theme.colors.candlePositive,negativeColor=this.context.config.theme.colors.candleNegative,positiveCandles=batch$1.candles.filter(c$2=>c$2.isPositive),negativeCandles=batch$1.candles.filter(c$2=>!c$2.isPositive);this.renderCandleGroup(container,positiveCandles,positiveColor),this.renderCandleGroup(container,negativeCandles,negativeColor)}renderCandleGroup(container,candles,colorHex){if(candles.length===0)return;let color$2=this.hexToNumber(colorHex),rgb=this.hexToRGB(colorHex),vertices=[],indices=[],colors=[],vertexCount=0;for(let candle of candles){let upperWickVertices=this.createLineVertices(candle.x,candle.upperWick.y1,candle.x,candle.upperWick.y2,.5);vertices.push(...upperWickVertices.vertices),indices.push(...upperWickVertices.indices.map(i$1=>i$1+vertexCount)),vertexCount+=upperWickVertices.vertices.length/2;for(let i$1=0;i$1<4;i$1++)colors.push(rgb[0],rgb[1],rgb[2],1);let lowerWickVertices=this.createLineVertices(candle.x,candle.lowerWick.y1,candle.x,candle.lowerWick.y2,.5);vertices.push(...lowerWickVertices.vertices),indices.push(...lowerWickVertices.indices.map(i$1=>i$1+vertexCount)),vertexCount+=lowerWickVertices.vertices.length/2;for(let i$1=0;i$1<4;i$1++)colors.push(rgb[0],rgb[1],rgb[2],1);let bodyVertices=this.createRectVertices(candle.x-candle.body.width/2,candle.body.y,candle.body.width,candle.body.height);vertices.push(...bodyVertices.vertices),indices.push(...bodyVertices.indices.map(i$1=>i$1+vertexCount)),vertexCount+=bodyVertices.vertices.length/2;for(let i$1=0;i$1<4;i$1++)colors.push(rgb[0],rgb[1],rgb[2],1)}let uvs=[];for(let i$1=0;i$1<vertexCount;i$1++)uvs.push(0,0);let geometry=new Geometry({attributes:{aPosition:new Float32Array(vertices),aUV:new Float32Array(uvs)},indexBuffer:new Uint16Array(indices)}),texture=Texture.WHITE,mesh=new Mesh({geometry,texture});mesh.tint=color$2,container.addChild(mesh)}createLineVertices(x1,y1,x2,y2,width){let dx=x2-x1,dy=y2-y1,length$1=Math.sqrt(dx*dx+dy*dy),nx=-dy/length$1*width,ny=dx/length$1*width;return{vertices:[x1-nx,y1-ny,x1+nx,y1+ny,x2+nx,y2+ny,x2-nx,y2-ny],indices:[0,1,2,0,2,3]}}createRectVertices(x$1,y$1,width,height){return{vertices:[x$1,y$1,x$1+width,y$1,x$1+width,y$1+height,x$1,y$1+height],indices:[0,1,2,0,2,3]}}},PixiMeshBarBatchRenderer=class{constructor(context$1){this.context=context$1}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}hexToRGB(hex$1){let num=this.hexToNumber(hex$1);return[(num>>16&255)/255,(num>>8&255)/255,(num&255)/255]}render(container,batch$1){let positiveColor=this.context.config.theme.colors.candlePositive,negativeColor=this.context.config.theme.colors.candleNegative,positiveBars=batch$1.bars.filter(b$1=>b$1.isPositive),negativeBars=batch$1.bars.filter(b$1=>!b$1.isPositive);this.renderBarGroup(container,positiveBars,positiveColor),this.renderBarGroup(container,negativeBars,negativeColor)}renderBarGroup(container,bars,colorHex){if(bars.length===0)return;let color$2=this.hexToNumber(colorHex);this.hexToRGB(colorHex);let vertices=[],indices=[],uvs=[],vertexCount=0;for(let bar of bars){let barVertices=this.createRectVertices(bar.x,bar.y,bar.width,bar.height);vertices.push(...barVertices.vertices),indices.push(...barVertices.indices.map(i$1=>i$1+vertexCount)),uvs.push(0,0,1,0,1,1,0,1),vertexCount+=4}let geometry=new Geometry({attributes:{aPosition:new Float32Array(vertices),aUV:new Float32Array(uvs)},indexBuffer:new Uint16Array(indices)}),texture=Texture.WHITE,mesh=new Mesh({geometry,texture});mesh.tint=color$2,container.addChild(mesh)}createRectVertices(x$1,y$1,width,height){return{vertices:[x$1,y$1,x$1+width,y$1,x$1+width,y$1+height,x$1,y$1+height],indices:[0,1,2,0,2,3]}}},PixiMeshCompositor=class{constructor(canvas,context$1){this.app=null,this.clippedContainer=null,this.context=context$1,this.canvas=canvas,this.targetWidth=context$1.config.size.width,this.targetHeight=context$1.config.size.height,this.container=new Container,this.infrastructureGraphics=new Graphics,this.container.addChild(this.infrastructureGraphics),this.polylineRenderer=new PixiMeshPolylineRenderer,this.bandFillRenderer=new PixiMeshBandFillRenderer,this.candleBatchRenderer=new PixiMeshCandleBatchRenderer(context$1),this.barBatchRenderer=new PixiMeshBarBatchRenderer(context$1),this.initPromise=this.initAsync(canvas)}async initAsync(canvas){try{this.app=new Application,await this.app.init({canvas,width:this.targetWidth,height:this.targetHeight,backgroundColor:this.hexToNumber(this.context.config.theme.colors.background),antialias:!0,autoDensity:!0,resolution:window.devicePixelRatio||1,preference:`webgl`}),this.app.stage.addChild(this.container),console.log(`PixiJS Mesh compositor initialized successfully`)}catch(error$1){throw console.error(`Failed to initialize PixiJS Mesh:`,error$1),error$1}}waitForInit(){return this.initPromise}hexToNumber(hex$1){return parseInt(hex$1.replace(`#`,``),16)}parseFont(font){let parts=font.trim().split(/\s+/),size=10,family=`sans-serif`,weight;for(let i$1=0;i$1<parts.length;i$1++){let part=parts[i$1];if(part.includes(`px`))size=parseInt(part.replace(`px`,``),10);else if(part===`bold`||part===`normal`||/^\d00$/.test(part))weight=part;else if(!part.includes(`px`)&&part!==`bold`&&part!==`normal`){family=parts.slice(i$1).join(` `);break}}return{size,family,weight}}getTextAnchor(align,baseline){let x$1=.5;align===`left`||align===`start`?x$1=0:align===`right`||align===`end`?x$1=1:align===`center`&&(x$1=.5);let y$1=.5;return baseline===`top`||baseline===`hanging`?y$1=0:baseline===`bottom`||baseline===`ideographic`?y$1=1:baseline===`middle`?y$1=.5:baseline===`alphabetic`&&(y$1=.8),{x:x$1,y:y$1}}render(batch$1){if(!this.app){console.warn(`PixiJS not initialized yet, skipping render`);return}let targetContainer=this.clippedContainer??this.container;switch(batch$1.type){case`polyline`:this.polylineRenderer.render(targetContainer,batch$1);break;case`bandfill`:this.bandFillRenderer.render(targetContainer,batch$1);break;case`candle`:this.candleBatchRenderer.render(targetContainer,batch$1);break;case`bar`:this.barBatchRenderer.render(targetContainer,batch$1);break;default:console.warn(`Unknown batch type: ${batch$1.type}`);break}}renderShapes(shapes){if(!this.app){console.warn(`PixiJS not initialized yet, skipping renderShapes`);return}for(let shape of shapes)switch(shape.type){case`line`:{let color$2=this.hexToNumber(shape.color??`#000000`),lineWidth=shape.lineWidth??1;if(shape.lineDash&&shape.lineDash.length>=2){let dashLength=shape.lineDash[0],gapLength=shape.lineDash[1],dx=shape.end.x-shape.start.x,dy=shape.end.y-shape.start.y,lineLength=Math.sqrt(dx*dx+dy*dy),segmentLength=dashLength+gapLength,segmentCount=Math.ceil(lineLength/segmentLength),unitDx=dx/lineLength,unitDy=dy/lineLength;for(let i$1=0;i$1<segmentCount;i$1++){let segmentStart=i$1*segmentLength,segmentEnd=Math.min(segmentStart+dashLength,lineLength);if(segmentStart>=lineLength)break;let x1=shape.start.x+unitDx*segmentStart,y1=shape.start.y+unitDy*segmentStart,x2=shape.start.x+unitDx*segmentEnd,y2=shape.start.y+unitDy*segmentEnd;this.infrastructureGraphics.moveTo(x1,y1),this.infrastructureGraphics.lineTo(x2,y2)}this.infrastructureGraphics.stroke({width:lineWidth,color:color$2})}else this.infrastructureGraphics.moveTo(shape.start.x,shape.start.y),this.infrastructureGraphics.lineTo(shape.end.x,shape.end.y),this.infrastructureGraphics.stroke({width:lineWidth,color:color$2});break}case`text`:{let fontInfo=this.parseFont(shape.font),anchor=this.getTextAnchor(shape.align,shape.baseline),textStyle=new TextStyle({fontFamily:fontInfo.family,fontSize:fontInfo.size,fontWeight:fontInfo.weight,fill:shape.color,align:shape.align===`center`?`center`:shape.align===`right`?`right`:`left`}),text=new Text({text:shape.text,style:textStyle});text.x=shape.position.x,text.y=shape.position.y,text.anchor.set(anchor.x,anchor.y),this.container.addChild(text);break}case`boxedText`:{let boxContainer=new Container,fontInfo=this.parseFont(shape.font),anchor=this.getTextAnchor(shape.align,shape.baseline),textStyle=new TextStyle({fontFamily:fontInfo.family,fontSize:fontInfo.size,fill:shape.textColor,align:shape.align===`center`?`center`:shape.align===`right`?`right`:`left`}),text=new Text({text:shape.text,style:textStyle}),textWidth=text.width,textHeight=text.height,boxWidth=textWidth+shape.padding*2,boxHeight=textHeight+shape.padding*2,boxX=-boxWidth*anchor.x,boxY=-boxHeight*anchor.y,boxGraphics=new Graphics;boxGraphics.rect(boxX,boxY,boxWidth,boxHeight),boxGraphics.fill(this.hexToNumber(shape.backgroundColor)),shape.borderColor&&boxGraphics.stroke({width:1,color:this.hexToNumber(shape.borderColor)}),boxContainer.addChild(boxGraphics);let textX=boxX+shape.padding;shape.align===`center`?textX=boxX+boxWidth/2-textWidth/2:shape.align===`right`&&(textX=boxX+boxWidth-shape.padding-textWidth);let textY=boxY+shape.padding;shape.baseline===`middle`?textY=boxY+boxHeight/2-textHeight/2:shape.baseline===`bottom`&&(textY=boxY+boxHeight-shape.padding-textHeight),text.x=textX,text.y=textY,text.anchor.set(0,0),boxContainer.addChild(text),boxContainer.x=shape.position.x,boxContainer.y=shape.position.y,this.container.addChild(boxContainer);break}default:break}}clear(){if(this.app){for(;this.container.children.length>0;){let child=this.container.children[0];child.destroy({children:!0}),this.container.removeChild(child)}this.infrastructureGraphics=new Graphics,this.container.addChild(this.infrastructureGraphics),this.clippedContainer=null}}setupHighDPI(width,height){this.targetWidth=width,this.targetHeight=height,this.app?.renderer&&this.app.renderer.resize(width,height)}setClipRegion(bounds){if(!this.app)return;let clippedContainer=new Container,mask=new Graphics;mask.rect(bounds.x,bounds.y,bounds.width,bounds.height),mask.fill({color:16777215}),this.container.addChild(mask),clippedContainer.mask=mask,this.container.addChild(clippedContainer),this.clippedContainer=clippedContainer}clearClipRegion(){this.app&&(this.clippedContainer=null)}drawBorder(bounds){if(!this.app)return;let color$2=this.hexToNumber(this.context.config.theme.colors.borderColor);this.infrastructureGraphics.rect(bounds.x,bounds.y,bounds.width,bounds.height),this.infrastructureGraphics.stroke({width:1,color:color$2})}destroy(){for(;this.container.children.length>0;){let child=this.container.children[0];child.destroy({children:!0}),this.container.removeChild(child)}this.app&&=(this.app.destroy(!0,{children:!0}),null)}};function createCompositor(canvas,context$1,backend){switch(backend){case`canvas2d`:return new Canvas2DCompositor(canvas,context$1);case`pixijs`:return new PixiCompositor(canvas,context$1);case`pixijs-mesh`:return new PixiMeshCompositor(canvas,context$1);default:throw Error(`Unknown backend: ${backend}`)}}var MultiPaneRenderer=class MultiPaneRenderer{static{this.PANE_SPACING=16}constructor(context$1,canvas,paneManager,timeAxis$1,backend=`canvas2d`){this.context=context$1,this.paneManager=paneManager,this.timeAxis=timeAxis$1,this.compositor=createCompositor(canvas,context$1,backend),this.compositor.setupHighDPI(context$1.config.size.width,context$1.config.size.height),this.recalculateLayout()}async waitForInit(){this.compositor.waitForInit&&await this.compositor.waitForInit()}addSubPane(subPane){this.paneManager.addSubPane(subPane),this.recalculateLayout()}recalculateLayout(){let mainPane=this.getMainPane(),subPanes=this.getSubPanes(),chartAreaX=this.context.config.padding.left,chartAreaY=this.context.config.padding.top,chartAreaWidth=this.context.config.size.width-this.context.config.padding.left-this.context.config.padding.right,chartAreaHeight=this.context.config.size.height-this.context.config.padding.top-this.context.config.padding.bottom,totalSpacing=subPanes.length*MultiPaneRenderer.PANE_SPACING,availableHeight=chartAreaHeight-totalSpacing,mainHeightPercent=1-subPanes.reduce((sum,sp)=>sum+sp.heightPercent,0);if(mainHeightPercent<=0)throw Error(`Main pane height must be positive (sub-panes total height >= 1.0)`);let currentY=chartAreaY,mainHeight=availableHeight*mainHeightPercent;mainPane.updateBounds({x:chartAreaX,y:currentY,width:chartAreaWidth,height:mainHeight},this.context.scales.priceScale),currentY+=mainHeight+MultiPaneRenderer.PANE_SPACING;for(let subPane of subPanes){let height=availableHeight*subPane.heightPercent;subPane.updateBounds({x:chartAreaX,y:currentY,width:chartAreaWidth,height}),currentY+=height+MultiPaneRenderer.PANE_SPACING}this.context.scales.timeScale.updateRange(chartAreaX,chartAreaX+chartAreaWidth)}render(){PerformanceTracker.start(`render`),this.compositor.clear();let mainPane=this.getMainPane(),subPanes=this.getSubPanes(),chartAreaX=this.context.config.padding.left,chartAreaY=this.context.config.padding.top,chartAreaWidth=this.context.config.size.width-this.context.config.padding.left-this.context.config.padding.right,chartAreaHeight=this.context.config.size.height-this.context.config.padding.top-this.context.config.padding.bottom;this.compositor.renderShapes(mainPane.generatePriceAxisGridShapes());for(let subPane of subPanes)this.compositor.renderShapes(subPane.generatePriceAxisGridShapes());this.compositor.renderShapes(this.timeAxis.generateGridShapes(mainPane.bounds));for(let subPane of subPanes)this.compositor.renderShapes(this.timeAxis.generateGridShapes(subPane.bounds));this.renderPaneWithClip(mainPane,mainPane.bounds);for(let subPane of subPanes)this.renderPaneWithClip(subPane,subPane.bounds);mainPane.renderInfrastructureTo(this.compositor,this.context.scales);for(let subPane of subPanes)subPane.renderInfrastructureTo(this.compositor,this.context.scales);this.compositor.drawBorder({x:chartAreaX,y:chartAreaY,width:chartAreaWidth,height:chartAreaHeight});let mainAxisLine=mainPane.generatePriceAxisLineShape();mainAxisLine&&this.compositor.renderShapes([mainAxisLine]);for(let subPane of subPanes){let axisLine$1=subPane.generatePriceAxisLineShape();axisLine$1&&this.compositor.renderShapes([axisLine$1])}let lastPane=subPanes.length>0?subPanes[subPanes.length-1]:mainPane,axisLine=this.timeAxis.generateAxisLineShape(lastPane.bounds);axisLine&&this.compositor.renderShapes([axisLine]),this.compositor.renderShapes(mainPane.generatePriceAxisLabelShapes());for(let subPane of subPanes)this.compositor.renderShapes(subPane.generatePriceAxisLabelShapes());this.compositor.renderShapes(this.timeAxis.generateLabelShapes(lastPane.bounds)),PerformanceTracker.end(`render`)}renderPaneWithClip(pane,bounds){this.compositor.setClipRegion(bounds),pane.renderTo(this.compositor,this.context.scales),this.compositor.clearClipRegion()}getMainPane(){return this.paneManager.getMainPane()}getSubPanes(){return this.paneManager.getSubPanes()}},ZoomManager=class{constructor(scaleManager,minVisibleCandles=10,maxVisibleCandles=2500){this.scaleManager=scaleManager,this.minVisibleCandles=minVisibleCandles,this.maxVisibleCandles=maxVisibleCandles}zoomIn(factor=1.2){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices(),visibleRange=endIndex-startIndex,newVisibleRange=Math.max(this.minVisibleCandles,visibleRange/factor),newStartIndex=endIndex-newVisibleRange;this.scaleManager.updateTimeScale(newStartIndex,endIndex)}zoomOut(factor=1.2){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices(),visibleRange=endIndex-startIndex,newVisibleRange=Math.min(this.maxVisibleCandles,visibleRange*factor),newStartIndex=endIndex-newVisibleRange;this.scaleManager.updateTimeScale(Math.max(0,newStartIndex),endIndex)}pan(deltaCandles){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices(),fullLength=this.scaleManager.timeScale.getFullDomain().length,visibleRange=endIndex-startIndex,newStartIndex=startIndex+deltaCandles,newEndIndex=endIndex+deltaCandles;newStartIndex<0&&(newStartIndex=0,newEndIndex=visibleRange),newEndIndex>=fullLength&&(newEndIndex=fullLength-1,newStartIndex=newEndIndex-visibleRange),(newStartIndex!==startIndex||newEndIndex!==endIndex)&&this.scaleManager.updateTimeScale(newStartIndex,newEndIndex)}resetZoom(){let fullLength=this.scaleManager.timeScale.getFullDomain().length;this.scaleManager.updateTimeScale(0,fullLength-1)}getZoomLevel(){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices(),visibleRange=endIndex-startIndex,fullLength=this.scaleManager.timeScale.getFullDomain().length;return visibleRange/fullLength*100}canZoomIn(){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices();return endIndex-startIndex>this.minVisibleCandles}canZoomOut(){let{startIndex,endIndex}=this.scaleManager.getVisibleDomainIndices();return endIndex-startIndex<this.maxVisibleCandles}canPanLeft(){let{startIndex}=this.scaleManager.getVisibleDomainIndices();return startIndex>0}canPanRight(){let{endIndex}=this.scaleManager.getVisibleDomainIndices(),fullLength=this.scaleManager.timeScale.getFullDomain().length;return endIndex<fullLength-1}},Chart=class{constructor(canvas,chartSize,chartPadding,theme$1,candleStudy,dataManager,backend=`canvas2d`){this.hasMoreHistorical=!0,this.isLoadingMore=!1,this.LOAD_MORE_THRESHOLD=20,this.dataManager=dataManager;let canvasWidth=chartSize.width-chartPadding.left-chartPadding.right,canvasHeight=chartSize.height-chartPadding.top-chartPadding.bottom,commonScaleManager=new CommonScaleManager([],canvasWidth,canvasHeight,0,100,0,0);this.context={config:{size:chartSize,padding:chartPadding,theme:theme$1},scales:commonScaleManager};let mainPane=new MainPane(this.context,candleStudy);this.paneManager=new PaneManager(mainPane),this.timeSeriesStore=new TimeSeriesStore,this.timeAxis=new TimeAxis(this.context,this.context.scales.timeScale,AxisPosition.Bottom,10),this.chartController=new ChartController(this.timeSeriesStore,this.paneManager,commonScaleManager),this.multiPaneRenderer=new MultiPaneRenderer(this.context,canvas,this.paneManager,this.timeAxis,backend),this.zoomManager=new ZoomManager(commonScaleManager),this.chartController.setOnRender(()=>{this.multiPaneRenderer.render()}),this.dataManager.onRealtimeUpdate(candle=>{this.handleRealtimeUpdate(candle)})}async initialize(){await this.multiPaneRenderer.waitForInit(),console.log(`[INITIALIZE] Compositor ready`);let batch$1=await this.dataManager.loadHistorical();this.hasMoreHistorical=batch$1.hasMore,console.log(`[INITIALIZE] Loaded ${batch$1.candles.length} candles`),this.chartController.loadInitialData(batch$1.candles);let totalCandles=batch$1.candles.length,startIndex=Math.max(0,totalCandles-120),endIndex=totalCandles-1;console.log(`[INITIALIZE] Setting visible range: startIndex=${startIndex}, endIndex=${endIndex}`),totalCandles>0&&(this.context.scales.updateTimeScale(startIndex,endIndex),this.chartController.recalculatePriceScalesFromVisibleCandles())}handleRealtimeUpdate(candle){this.chartController.handleRealtimeUpdate(candle)}addOverlayStudy(study){this.paneManager.getMainPane().addOverlayStudy(study)}createSubPane(id,primaryStudy,heightPercent,otherStudies=[]){let subPane=new SubPane(this.context,id,primaryStudy,heightPercent,otherStudies);this.multiPaneRenderer.addSubPane(subPane)}updateTheme(theme$1){this.context.config.theme=theme$1,this.multiPaneRenderer.render()}resize(chartSize){this.context.config.size=chartSize,this.multiPaneRenderer.recalculateLayout(),this.multiPaneRenderer.render()}updatePadding(chartPadding){this.context.config.padding=chartPadding,this.multiPaneRenderer.recalculateLayout(),this.multiPaneRenderer.render()}zoomIn(factor){this.zoomManager.zoomIn(factor),this.chartController.recalculatePriceScalesFromVisibleCandles()}zoomOut(factor){this.zoomManager.zoomOut(factor),this.chartController.recalculatePriceScalesFromVisibleCandles()}pan(deltaCandles){this.zoomManager.pan(deltaCandles),this.chartController.recalculatePriceScalesFromVisibleCandles(),this.checkAndLoadMore()}resetZoom(){this.zoomManager.resetZoom(),this.chartController.recalculatePriceScalesFromVisibleCandles()}getZoomLevel(){return this.zoomManager.getZoomLevel()}canZoomIn(){return this.zoomManager.canZoomIn()}canZoomOut(){return this.zoomManager.canZoomOut()}canPanLeft(){return this.zoomManager.canPanLeft()}canPanRight(){return this.zoomManager.canPanRight()}getVisibleIndices(){return this.context.scales.getVisibleDomainIndices()}getBoxWidth(){return this.context.scales.timeScale.boxWidth()}checkAndLoadMore(){if(this.isLoadingMore||!this.hasMoreHistorical)return;let{startIndex}=this.getVisibleIndices();startIndex<this.LOAD_MORE_THRESHOLD&&(console.log(`[CHART] Near start (startIndex=${startIndex}), loading more historical data...`),this.loadMoreHistoricalFromDataManager())}async loadMoreHistoricalFromDataManager(){if(!this.isLoadingMore){this.isLoadingMore=!0;try{let batch$1=await this.dataManager.loadHistorical();this.hasMoreHistorical=batch$1.hasMore,batch$1.candles.length>0&&(console.log(`[CHART] Loaded ${batch$1.candles.length} more historical candles (hasMore=${batch$1.hasMore})`),this.chartController.loadMoreHistorical(batch$1.candles))}catch(error$1){console.error(`[CHART] Failed to load more historical data:`,error$1)}finally{this.isLoadingMore=!1}}}destroy(){this.chartController.destroy()}},Study=class{constructor(id,name){this.enabled=!0,this.id=id,this.name=name}updateScaleBounds(_bounds){}getYScale(){return null}renderInfrastructureTo(_compositor,_commonScales,_bounds){}},InstantStudy=class extends Study{constructor(id,name,shapeBatch){super(id,name),this.computedData=[],this.yPriceDomainMin=1/0,this.yPriceDomainMax=-1/0,this.shapeBatch=shapeBatch}getComputedValues(){return this.computedData.map(dp=>dp.value)}updatePriceDomain(newBounds,oldBounds){if(oldBounds&&(oldBounds.min===this.yPriceDomainMin||oldBounds.max===this.yPriceDomainMax))return this.recomputePriceDomain(),!0;let changed=!1;return newBounds.min<this.yPriceDomainMin&&(this.yPriceDomainMin=newBounds.min,changed=!0),newBounds.max>this.yPriceDomainMax&&(this.yPriceDomainMax=newBounds.max,changed=!0),changed}recomputePriceDomain(){this.yPriceDomainMin=1/0,this.yPriceDomainMax=-1/0;for(let dataPoint of this.computedData){let bounds=this.extractPriceBounds(dataPoint.value);bounds&&(this.yPriceDomainMin=Math.min(this.yPriceDomainMin,bounds.min),this.yPriceDomainMax=Math.max(this.yPriceDomainMax,bounds.max))}}updateLastCandle(allCandles){if(allCandles.length===0)return null;let candle=allCandles[allCandles.length-1],newValue=this.calculateValue(candle);if(this.computedData.length===0){this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1});let bounds=this.extractPriceBounds(newValue);return bounds?(this.yPriceDomainMin=bounds.min,this.yPriceDomainMax=bounds.max,{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}):null}let lastComputed=this.computedData[this.computedData.length-1],timestampsMatch=lastComputed.timestamp.getTime()===candle.timestamp.getTime(),rangeChanged=!1;if(timestampsMatch){let oldValue=lastComputed.value,oldBounds=this.extractPriceBounds(oldValue);this.computedData[this.computedData.length-1]={timestamp:candle.timestamp,value:newValue,index:allCandles.length-1},this.lastRenderHash=void 0;let newBounds=this.extractPriceBounds(newValue);newBounds&&(rangeChanged=this.updatePriceDomain(newBounds,oldBounds??void 0))}else{this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1}),this.lastRenderHash=void 0;let newBounds=this.extractPriceBounds(newValue);newBounds&&(rangeChanged=this.updatePriceDomain(newBounds))}return rangeChanged?{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}:null}appendNewCandle(allCandles){if(allCandles.length===0)return null;let candle=allCandles[allCandles.length-1],newValue=this.calculateValue(candle);return this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1}),this.lastRenderHash=void 0,null}prependHistoricalCandles(allCandles){return this.resetCandles(allCandles)}resetCandles(allCandles){this.computedData=Array.from({length:allCandles.length});for(let i$1=0;i$1<allCandles.length;i$1++)this.computedData[i$1]={timestamp:allCandles[i$1].timestamp,value:this.calculateValue(allCandles[i$1]),index:i$1};return this.lastRenderHash=void 0,this.recomputePriceDomain(),this.computedData.length>0&&this.yPriceDomainMin!==1/0?{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}:null}updateScales(timeScaleChanged,priceScaleChanged){(timeScaleChanged||priceScaleChanged)&&(this.lastRenderHash=void 0)}renderTo(compositor,commonScales,bounds){if(this.computedData.length===0)return;let renderHash=this.getRenderHash(commonScales);if(!this.lastRenderHash||this.lastRenderHash!==renderHash){let{startIndex,endIndex}=commonScales.timeScale.getVisibleDomainIndices(),buffer=2,renderStart=Math.max(0,Math.floor(startIndex-2)),renderEnd=Math.min(this.computedData.length-1,Math.ceil(endIndex+2)),points$1=[];for(let i$1=renderStart;i$1<=renderEnd;i$1++){let dp=this.computedData[i$1];points$1.push(this.valueToPoint(dp.value,dp.timestamp,dp.index,commonScales))}this.shapeBatch.reset(points$1),this.lastRenderHash=renderHash}compositor.render(this.shapeBatch)}getRenderHash(commonScales){let ts=commonScales.timeScale,ps=commonScales.priceScale,{startIndex,endIndex}=ts.getVisibleDomainIndices(),domain=ps.getDomain();return`${this.computedData.length}-${startIndex}-${endIndex}-${domain.min}-${domain.max}`}},ShapeBatch=class{},CandleBatch=class extends ShapeBatch{constructor(){super(),this.type=`candle`,this.candles=[]}update(point){this.candles.length===0?this.candles.push(point):this.candles[this.candles.length-1]=point}append(point){this.candles.push(point)}reset(points$1){this.candles.length=0,this.candles.push(...points$1)}},CandleStudy=class extends InstantStudy{constructor(){super(`candle`,`Candles`,new CandleBatch)}calculateValue(candle){return{open:candle.open,high:candle.high,low:candle.low,close:candle.close}}extractPriceBounds(value){return{min:value.low,max:value.high}}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,priceScale=commonScales.priceScale,x$1=timeScale.scaledValueFromIndex(index),candleWidth=timeScale.boxWidth()*.7,bodyTop=Math.max(value.open,value.close),bodyBottom=Math.min(value.open,value.close);return{x:x$1,upperWick:{y1:priceScale.scaledValue(bodyTop),y2:priceScale.scaledValue(value.high)},lowerWick:{y1:priceScale.scaledValue(value.low),y2:priceScale.scaledValue(bodyBottom)},body:{y:priceScale.scaledValue(bodyTop),height:Math.abs(priceScale.scaledValue(bodyTop)-priceScale.scaledValue(bodyBottom)),width:candleWidth},isPositive:value.close>=value.open}}},BarBatch=class extends ShapeBatch{constructor(){super(),this.type=`bar`,this.bars=[]}update(point){this.bars.length===0?this.bars.push(point):this.bars[this.bars.length-1]=point}append(point){this.bars.push(point)}reset(points$1){this.bars.length=0,this.bars.push(...points$1)}},VolumeStudy=class extends InstantStudy{constructor(){super(`volume`,`Volume`,new BarBatch),this.maxVolume=0,this.customYScale=new NumericScale(0,1,0,100,!0)}calculateValue(candle){return{volume:candle.volume,isPositive:candle.close>=candle.open}}extractPriceBounds(_value){return null}updateLastCandle(allCandles){if(super.updateLastCandle(allCandles),this.computedData.length===0)return null;let lastValue=this.computedData[this.computedData.length-1].value;return lastValue.volume>this.maxVolume?(this.maxVolume=lastValue.volume,this.customYScale.updateDomain(0,this.maxVolume)):(this.recomputeMax(),this.customYScale.updateDomain(0,this.maxVolume)),null}resetCandles(allCandles){return super.resetCandles(allCandles),this.recomputeMax(),this.customYScale.updateDomain(0,this.maxVolume),null}prependHistoricalCandles(allCandles){return super.prependHistoricalCandles(allCandles),this.recomputeMax(),this.customYScale.updateDomain(0,this.maxVolume),null}recomputeMax(){this.maxVolume=0;for(let dataPoint of this.computedData)this.maxVolume=Math.max(this.maxVolume,dataPoint.value.volume)}updateScaleBounds(bounds){this.customYScale.updateRange(bounds.y,bounds.y+bounds.height)}getYScale(){return this.customYScale}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,volumeScale=this.customYScale,barWidth=timeScale.boxWidth()*.7,{volume,isPositive}=value,centerX=timeScale.scaledValueFromIndex(index),y0=volumeScale.scaledValue(0),y1=volumeScale.scaledValue(volume),barHeight=Math.abs(y1-y0),topY=Math.min(y0,y1);return{x:centerX-barWidth/2,y:topY,width:barWidth,height:barHeight,isPositive}}},WindowedStudy=class extends Study{constructor(id,name,windowSize,shapeBatch){super(id,name),this.computedData=[],this.yPriceDomainMin=1/0,this.yPriceDomainMax=-1/0,this.windowSize=windowSize,this.shapeBatch=shapeBatch}getComputedValues(){return this.computedData.map(dp=>dp.value)}updatePriceDomain(newBounds,oldBounds){if(oldBounds&&(oldBounds.min===this.yPriceDomainMin||oldBounds.max===this.yPriceDomainMax))return this.recomputePriceDomain(),!0;let changed=!1;return newBounds.min<this.yPriceDomainMin&&(this.yPriceDomainMin=newBounds.min,changed=!0),newBounds.max>this.yPriceDomainMax&&(this.yPriceDomainMax=newBounds.max,changed=!0),changed}recomputePriceDomain(){this.yPriceDomainMin=1/0,this.yPriceDomainMax=-1/0;for(let dataPoint of this.computedData){let bounds=this.extractPriceBounds(dataPoint.value);bounds&&(this.yPriceDomainMin=Math.min(this.yPriceDomainMin,bounds.min),this.yPriceDomainMax=Math.max(this.yPriceDomainMax,bounds.max))}}updateLastCandle(allCandles){if(allCandles.length<this.windowSize)return null;let candle=allCandles[allCandles.length-1],window$1=allCandles.slice(-this.windowSize),newValue=this.calculateValue(window$1);if(newValue===null)return null;if(this.computedData.length===0){this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1});let bounds=this.extractPriceBounds(newValue);return bounds?(this.yPriceDomainMin=bounds.min,this.yPriceDomainMax=bounds.max,{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}):null}let lastComputed=this.computedData[this.computedData.length-1],timestampsMatch=lastComputed.timestamp.getTime()===candle.timestamp.getTime(),rangeChanged=!1;if(timestampsMatch){let oldValue=lastComputed.value,oldBounds=this.extractPriceBounds(oldValue);this.computedData[this.computedData.length-1]={timestamp:candle.timestamp,value:newValue,index:allCandles.length-1};let newBounds=this.extractPriceBounds(newValue);newBounds&&(rangeChanged=this.updatePriceDomain(newBounds,oldBounds??void 0))}else{this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1});let newBounds=this.extractPriceBounds(newValue);newBounds&&(rangeChanged=this.updatePriceDomain(newBounds))}return rangeChanged?{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}:null}appendNewCandle(allCandles){if(allCandles.length<this.windowSize)return null;let candle=allCandles[allCandles.length-1],window$1=allCandles.slice(-this.windowSize),newValue=this.calculateValue(window$1);return newValue!==null&&this.computedData.push({timestamp:candle.timestamp,value:newValue,index:allCandles.length-1}),null}prependHistoricalCandles(allCandles){return this.resetCandles(allCandles)}resetCandles(allCandles){return this.recomputeAll(allCandles),this.recomputePriceDomain(),this.computedData.length>0&&this.yPriceDomainMin!==1/0?{yDomain:{min:this.yPriceDomainMin,max:this.yPriceDomainMax}}:null}updateScales(timeScaleChanged,priceScaleChanged){(timeScaleChanged||priceScaleChanged)&&(this.lastRenderHash=void 0)}renderTo(compositor,commonScales,bounds){if(this.computedData.length===0)return;let renderHash=this.getRenderHash(commonScales);if(!this.lastRenderHash||this.lastRenderHash!==renderHash){let points$1=this.computedData.map(dp=>this.valueToPoint(dp.value,dp.timestamp,dp.index,commonScales));this.shapeBatch.reset(points$1),this.lastRenderHash=renderHash}compositor.render(this.shapeBatch)}getRenderHash(commonScales){let ts=commonScales.timeScale,ps=commonScales.priceScale,{startIndex,endIndex}=ts.getVisibleDomainIndices(),domain=ps.getDomain();return`${this.computedData.length}-${startIndex}-${endIndex}-${domain.min}-${domain.max}`}recomputeAll(allCandles){if(this.computedData=[],!(allCandles.length<this.windowSize))for(let i$1=this.windowSize-1;i$1<allCandles.length;i$1++){let window$1=allCandles.slice(i$1-this.windowSize+1,i$1+1),value=this.calculateValue(window$1);value!==null&&this.computedData.push({timestamp:allCandles[i$1].timestamp,value,index:i$1})}}},PolylineBatch=class extends ShapeBatch{constructor(color$2,lineWidth,lineDash){super(),this.color=color$2,this.lineWidth=lineWidth,this.lineDash=lineDash,this.type=`polyline`,this.points=[]}update(point){this.points.length===0?this.points.push(point):this.points[this.points.length-1]=point}append(point){this.points.push(point)}reset(points$1){this.points.length=0,this.points.push(...points$1)}},SMAStudy=class extends WindowedStudy{constructor(period=20,color$2=`#4285f4`){super(`sma`,`SMA(${period})`,period,new PolylineBatch(color$2,2)),this.color=color$2}getPeriod(){return this.windowSize}getColor(){return this.color}calculateValue(window$1){return window$1.length<this.windowSize?null:window$1.reduce((acc,candle)=>acc+candle.close,0)/window$1.length}extractPriceBounds(value){return{min:value,max:value}}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,priceScale=commonScales.priceScale;return{x:timeScale.scaledValueFromIndex(index),y:priceScale.scaledValue(value)}}},BandFillBatch=class extends ShapeBatch{constructor(fillColor,fillOpacity,borderColor,borderWidth,showBorders){super(),this.fillColor=fillColor,this.fillOpacity=fillOpacity,this.borderColor=borderColor,this.borderWidth=borderWidth,this.showBorders=showBorders,this.type=`bandfill`,this.upperPoints=[],this.middlePoints=[],this.lowerPoints=[]}update(point){let lastIdx=this.upperPoints.length-1;lastIdx>=0?(this.upperPoints[lastIdx]=point.upper,this.middlePoints[lastIdx]=point.middle,this.lowerPoints[lastIdx]=point.lower):this.append(point)}append(point){this.upperPoints.push(point.upper),this.middlePoints.push(point.middle),this.lowerPoints.push(point.lower)}reset(points$1){this.upperPoints.length=0,this.middlePoints.length=0,this.lowerPoints.length=0;for(let point of points$1)this.upperPoints.push(point.upper),this.middlePoints.push(point.middle),this.lowerPoints.push(point.lower)}},BollingerBandsStudy=class extends WindowedStudy{constructor(period=20,multiplier=2,fillColor=`#2196f3`,borderColor=`#2196f3`){super(`bb`,`BB(${period},${multiplier})`,period,new BandFillBatch(fillColor,.1,borderColor,1,!0)),this.multiplier=multiplier}calculateValue(window$1){if(window$1.length<this.windowSize)return null;let sma=window$1.reduce((acc,candle)=>acc+candle.close,0)/window$1.length,variance=window$1.map(candle=>{let diff=candle.close-sma;return diff*diff}).reduce((acc,val)=>acc+val,0)/window$1.length,stdDev=Math.sqrt(variance),upper=sma+this.multiplier*stdDev,lower=sma-this.multiplier*stdDev;return{upper,middle:sma,lower}}extractPriceBounds(value){return{min:value.lower,max:value.upper}}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,priceScale=commonScales.priceScale,x$1=timeScale.scaledValueFromIndex(index);return{upper:{x:x$1,y:priceScale.scaledValue(value.upper)},middle:{x:x$1,y:priceScale.scaledValue(value.middle)},lower:{x:x$1,y:priceScale.scaledValue(value.lower)}}}},LastPriceLineStudy=class extends Study{constructor(color$2){super(`lastPriceLine`,`Last Price`),this.lastPrice=null,this.cachedLine=null,this.cachedLabel=null,this.color=color$2||`#2962FF`}updateLastCandle(allCandles){return allCandles.length===0?(this.lastPrice=null,null):(this.lastPrice=allCandles[allCandles.length-1].close,null)}appendNewCandle(allCandles){return this.updateLastCandle(allCandles)}prependHistoricalCandles(allCandles){return this.updateLastCandle(allCandles)}resetCandles(allCandles){return this.updateLastCandle(allCandles)}updateScales(timeScaleChanged,priceScaleChanged){(timeScaleChanged||priceScaleChanged)&&(this.lastRenderHash=void 0)}renderTo(compositor,commonScales,bounds){if(this.lastPrice===null)return;let domain=commonScales.priceScale.getDomain();if(this.lastPrice<domain.min||this.lastPrice>domain.max)return;let renderHash=`${this.lastPrice}-${bounds.x}-${bounds.width}-${domain.min}-${domain.max}`;this.lastRenderHash!==renderHash&&(this.generateShapes(commonScales,bounds),this.lastRenderHash=renderHash),this.cachedLine&&compositor.renderShapes([this.cachedLine])}renderInfrastructureTo(compositor,commonScales,bounds){if(this.lastPrice===null)return;let domain=commonScales.priceScale.getDomain();this.lastPrice<domain.min||this.lastPrice>domain.max||this.cachedLabel&&compositor.renderShapes([this.cachedLabel])}generateShapes(commonScales,bounds){if(this.lastPrice===null){this.cachedLine=null,this.cachedLabel=null;return}let y$1=commonScales.priceScale.scaledValue(this.lastPrice);this.cachedLine={type:`line`,start:{x:bounds.x,y:y$1},end:{x:bounds.x+bounds.width,y:y$1},color:this.color,lineWidth:1,lineDash:[5,5]};let priceText=this.lastPrice.toFixed(1);this.cachedLabel={type:`boxedText`,position:{x:bounds.x+bounds.width+2,y:y$1},text:priceText,textColor:`#ffffff`,backgroundColor:this.color,font:`11px sans-serif`,padding:3,align:`left`,baseline:`middle`}}};let CandleDuration=function(CandleDuration$1){return CandleDuration$1.OneSecond=`1s`,CandleDuration$1.FiveSeconds=`5s`,CandleDuration$1.ThirtySeconds=`30s`,CandleDuration$1.OneMinute=`1m`,CandleDuration$1.FiveMinutes=`5m`,CandleDuration$1.FifteenMinutes=`15m`,CandleDuration$1.ThirtyMinutes=`30m`,CandleDuration$1.OneHour=`1h`,CandleDuration$1.FourHours=`4h`,CandleDuration$1.OneDay=`1d`,CandleDuration$1.OneWeek=`1w`,CandleDuration$1.OneMonth=`1M`,CandleDuration$1}({});var INTRADAY_DURATIONS=[CandleDuration.OneSecond,CandleDuration.FiveSeconds,CandleDuration.ThirtySeconds,CandleDuration.OneMinute,CandleDuration.FiveMinutes,CandleDuration.FifteenMinutes,CandleDuration.ThirtyMinutes,CandleDuration.OneHour,CandleDuration.FourHours];let Volatility=function(Volatility$1){return Volatility$1.Low=`low`,Volatility$1.Medium=`medium`,Volatility$1.High=`high`,Volatility$1}({});var DataSimulator=class{constructor(config){this.oldestTimestamp=null,this.oldestCandleOpen=null,this.latestCandle=null,this.MARKET_OPEN_HOUR=6,this.MARKET_OPEN_MINUTE=0,this.MARKET_CLOSE_HOUR=23,this.MARKET_CLOSE_MINUTE=45,this.volumeMomentum=1,this.lastPrice=0,this.config={...config,volatility:config.volatility??Volatility.Medium,timezone:config.timezone??`Asia/Kolkata`},this.currentPrice=Math.round(config.initialPrice*10)/10,this.lastPrice=this.currentPrice,this.candleDurationMs=this.candleDurationToMilliseconds(config.candleDuration),this.timezoneOffsetMs=this.config.timezone===`Asia/Kolkata`?198e5:0,this.durationSeconds=this.candleDurationMs/1e3,this.calculateVolumeScaling()}candleDurationToMilliseconds(duration){switch(duration){case CandleDuration.OneSecond:return 1e3;case CandleDuration.FiveSeconds:return 5e3;case CandleDuration.ThirtySeconds:return 3e4;case CandleDuration.OneMinute:return 6e4;case CandleDuration.FiveMinutes:return 3e5;case CandleDuration.FifteenMinutes:return 9e5;case CandleDuration.ThirtyMinutes:return 18e5;case CandleDuration.OneHour:return 36e5;case CandleDuration.FourHours:return 144e5;case CandleDuration.OneDay:return 864e5;case CandleDuration.OneWeek:return 6048e5;case CandleDuration.OneMonth:return 2592e6;default:return 36e5}}calculateVolumeScaling(){this.expectedTicksPerCandle=this.durationSeconds*this.config.ticksPerSecond;let durationFactor=Math.max(1,this.durationSeconds/3600),targetMinVolume=1e4*durationFactor,targetMaxVolume=1e6*durationFactor,targetAvgVolume=(targetMinVolume+targetMaxVolume)/2;this.volumePerTick=Math.max(1,Math.floor(targetAvgVolume/this.expectedTicksPerCandle)),this.initialCandleVolume=Math.floor(targetAvgVolume*.1)}async generateHistoricalCandles(){await new Promise(resolve$1=>setTimeout(resolve$1,50+Math.random()*50));let isFirstBatch=this.oldestCandleOpen===null,timestamp=this.oldestTimestamp?this.oldestTimestamp:this.truncateToCandle(new Date),candles=[],timestamps=[];for(let i$1=0;i$1<this.config.historicalCandleCount;i$1++)timestamp=this.previousCandleTimestamp(timestamp),timestamps.push(timestamp);if(isFirstBatch){timestamps.reverse();for(let ts of timestamps){let candle=this.generateCandle(ts);candles.push(candle)}}else{this.currentPrice=this.oldestCandleOpen;for(let ts of timestamps){let candle=this.generateCandleBackwards(ts);candles.push(candle)}candles.reverse()}return candles.length>0&&(this.oldestTimestamp=candles[0].timestamp,this.oldestCandleOpen=candles[0].open,this.latestCandle===null&&(this.latestCandle=candles[candles.length-1])),candles}startTicker(onNewCandle){let intervalMs=1e3/this.config.ticksPerSecond,intervalId=setInterval(()=>{let now=this.truncateToCandle(new Date);if(this.latestCandle===null){let newCandle=this.generateCandle(now);this.latestCandle=newCandle,onNewCandle(newCandle)}else if(now.getTime()!==this.latestCandle.timestamp.getTime()){let newCandle=this.generateNewCandleFromTick(now);this.latestCandle=newCandle,onNewCandle(newCandle)}else{let updatedCandle=this.updateCandle(this.latestCandle);this.latestCandle=updatedCandle,onNewCandle(updatedCandle)}},intervalMs);return()=>clearInterval(intervalId)}generateCandleBackwards(timestamp){let{normalRange,bigJumpChance,bigJumpRange}=this.getVolatilityParams(),normalMove=(Math.random()-.5)*normalRange,bigJump=Math.random()<bigJumpChance?(Math.random()-.5)*bigJumpRange:0,totalMove=normalMove+bigJump,close=this.roundPrice(this.currentPrice),open=this.roundPrice(close/(1+totalMove)),extraRange=Math.abs(close-open)*(.1+Math.random()*.4),high=this.roundPrice(Math.max(open,close)+extraRange),low=this.roundPrice(Math.min(open,close)-extraRange),durationFactor=Math.max(1,this.durationSeconds/3600),baseMin=1e4*durationFactor,baseMax=1e6*durationFactor,volume=Math.floor(baseMin+Math.random()*(baseMax-baseMin)),oi=Math.floor(volume*(.5+Math.random()*.5));return this.currentPrice=open,{timestamp,open,high,low,close,volume,oi}}generateCandle(timestamp){let{normalRange,bigJumpChance,bigJumpRange}=this.getVolatilityParams(),normalMove=(Math.random()-.5)*normalRange,bigJump=Math.random()<bigJumpChance?(Math.random()-.5)*bigJumpRange:0,totalMove=normalMove+bigJump,open=this.roundPrice(this.currentPrice),close=this.roundPrice(open*(1+totalMove)),extraRange=Math.abs(close-open)*(.1+Math.random()*.4),high=this.roundPrice(Math.max(open,close)+extraRange),low=this.roundPrice(Math.min(open,close)-extraRange),durationFactor=Math.max(1,this.durationSeconds/3600),baseMin=1e4*durationFactor,baseMax=1e6*durationFactor,volume=Math.floor(baseMin+Math.random()*(baseMax-baseMin)),oi=Math.floor(volume*(.5+Math.random()*.5));return this.currentPrice=close,{timestamp,open,high,low,close,volume,oi}}generateNewTickPrice(){let{tickRange,bigJumpChance,bigJumpRange}=this.getVolatilityParams(),normalMove=(Math.random()-.5)*tickRange,bigJump=Math.random()<bigJumpChance?(Math.random()-.5)*bigJumpRange:0,totalMove=normalMove+bigJump,newPrice=this.roundPrice(this.currentPrice*(1+totalMove));return this.currentPrice=newPrice,newPrice}generateNewCandleFromTick(timestamp){let newPrice=this.roundPrice(this.generateNewTickPrice());this.lastPrice=newPrice;let open=newPrice,high=newPrice,low=newPrice,close=newPrice,volume=this.initialCandleVolume,oi=Math.floor(volume*(.5+Math.random()*.5));return{timestamp,open,high,low,close,volume,oi}}updateCandle(candle){let oldPrice=this.lastPrice||candle.close,newClose=this.roundPrice(this.generateNewTickPrice());this.lastPrice=newClose;let{tickRange}=this.getVolatilityParams(),shouldExtendWick=Math.random()<.2,newHigh=Math.max(candle.high,newClose),newLow=Math.min(candle.low,newClose);if(shouldExtendWick){let highExtension=Math.random()*2*tickRange*newClose;newHigh=this.roundPrice(Math.max(newHigh,newClose+highExtension));let lowExtension=Math.random()*2*tickRange*newClose;newLow=this.roundPrice(Math.min(newLow,newClose-lowExtension))}else newHigh=this.roundPrice(newHigh),newLow=this.roundPrice(newLow);let priceChange=Math.abs(newClose-oldPrice)/oldPrice,normalizedPriceChange=Math.min(1,priceChange/(tickRange*2));Math.random()<.05?this.volumeMomentum=1.5+Math.random()*1.5:(this.volumeMomentum=this.volumeMomentum*.95+1*.05,this.volumeMomentum*=.9+Math.random()*.2,this.volumeMomentum=Math.max(.1,Math.min(3,this.volumeMomentum)));let volumeMultiplier=this.volumeMomentum;volumeMultiplier*=1+normalizedPriceChange*2,volumeMultiplier*=.3+Math.random()*1.7;let additionalVolume=Math.floor(this.volumePerTick*volumeMultiplier);return{...candle,close:newClose,high:newHigh,low:newLow,volume:candle.volume+additionalVolume}}roundPrice(price){return Math.round(price*10)/10}getVolatilityParams(){let tickScaleFactor=Math.sqrt(1/this.config.ticksPerSecond),jumpChanceScaleFactor=1/this.config.ticksPerSecond;switch(this.config.volatility){case Volatility.Low:return{normalRange:.02,bigJumpChance:.03*jumpChanceScaleFactor,bigJumpRange:.1,tickRange:.003*tickScaleFactor};case Volatility.Medium:return{normalRange:.04,bigJumpChance:.05*jumpChanceScaleFactor,bigJumpRange:.2,tickRange:.006*tickScaleFactor};case Volatility.High:return{normalRange:.08,bigJumpChance:.08*jumpChanceScaleFactor,bigJumpRange:.3,tickRange:.012*tickScaleFactor};default:return{normalRange:.04,bigJumpChance:.05*jumpChanceScaleFactor,bigJumpRange:.2,tickRange:.006*tickScaleFactor}}}truncateToCandle(timestamp){let localTime=new Date(timestamp.getTime()+this.timezoneOffsetMs);if(this.candleDurationMs===2592e6){let truncated=new Date(Date.UTC(localTime.getUTCFullYear(),localTime.getUTCMonth(),1,0,0,0,0));return new Date(truncated.getTime()-this.timezoneOffsetMs)}if(this.candleDurationMs===6048e5){let dayOfWeek=localTime.getUTCDay(),daysToSubtract=dayOfWeek===0?6:dayOfWeek-1,truncated=new Date(localTime.getTime()-daysToSubtract*864e5);return truncated.setUTCHours(0,0,0,0),new Date(truncated.getTime()-this.timezoneOffsetMs)}let localMs=timestamp.getTime()+this.timezoneOffsetMs,truncatedMs=Math.floor(localMs/this.candleDurationMs)*this.candleDurationMs;return new Date(truncatedMs-this.timezoneOffsetMs)}previousCandleTimestamp(timestamp){let previous=new Date(timestamp.getTime()-this.candleDurationMs);if(this.candleDurationMs<864e5)for(;!this.isMarketOpen(previous);)previous=new Date(previous.getTime()-this.candleDurationMs);return previous}isMarketOpen(timestamp){let localTime=new Date(timestamp.getTime()+this.timezoneOffsetMs),hour=localTime.getUTCHours(),minute=localTime.getUTCMinutes();return!(hour<this.MARKET_OPEN_HOUR||hour===this.MARKET_OPEN_HOUR&&minute<this.MARKET_OPEN_MINUTE||hour>this.MARKET_CLOSE_HOUR||hour===this.MARKET_CLOSE_HOUR&&minute>this.MARKET_CLOSE_MINUTE)}},SimulatorDataManager=class{constructor(config){this.simulator=new DataSimulator(config)}async loadHistorical(){return{candles:await this.simulator.generateHistoricalCandles(),hasMore:!0}}onRealtimeUpdate(callback){this.realtimeCallback=callback}start(){if(!this.realtimeCallback){console.warn(`SimulatorDataManager.start() called but no callback registered`);return}if(this.stopTickerFn){console.warn(`SimulatorDataManager.start() called but ticker already running`);return}this.stopTickerFn=this.simulator.startTicker(this.realtimeCallback)}stop(){this.stopTickerFn&&=(this.stopTickerFn(),void 0)}isRunning(){return this.stopTickerFn!==void 0}},baseTypography={titleFont:`bold 16px sans-serif`,axisFont:`12px sans-serif`,labelsFont:`12px sans-serif`,tooltipFont:`12px sans-serif`},baseSpacing={paddingSmall:8,paddingMedium:16,paddingLarge:24,tickLength:6,tickOffset:8};const themes={light:{name:`light`,colors:{background:`#ffffff`,chartArea:`#fafbfc`,gridColor:`#e1e8ed`,tickColor:`#8899a6`,tickLabelColor:`#657786`,titleColor:`#14171a`,textColor:`#536471`,candlePositive:`#00ba7c`,candleNegative:`#fa533d`,lastPriceLine:`#2962FF`,hoverColor:`#1d9bf0`,selectionColor:`#1d9bf0`,borderColor:`#cfd9de`,dividerColor:`#eff3f4`},typography:baseTypography,spacing:baseSpacing},dark:{name:`dark`,colors:{background:`#000000`,chartArea:`#16181c`,gridColor:`#2f3336`,tickColor:`#71767b`,tickLabelColor:`#8b98a5`,titleColor:`#e7e9ea`,textColor:`#cfd2d6`,candlePositive:`#00d084`,candleNegative:`#f4212e`,lastPriceLine:`#2962FF`,hoverColor:`#1d9bf0`,selectionColor:`#1d9bf0`,borderColor:`#3e4144`,dividerColor:`#2f3336`},typography:baseTypography,spacing:baseSpacing}};var THEME_STORAGE_KEY=`chart-theme-preference`,globalCurrentTheme=ref(`auto`),globalCustomTheme=ref(null),isInitialized=!1;function useTheme(){let currentTheme=globalCurrentTheme,customTheme=globalCustomTheme,getSystemTheme=()=>typeof window<`u`&&window.matchMedia&&window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`,actualTheme=computed(()=>currentTheme.value===`auto`?getSystemTheme():currentTheme.value),currentThemeObject=computed(()=>{let baseTheme=themes[actualTheme.value];return customTheme.value?{...baseTheme,...customTheme.value,colors:{...baseTheme.colors,...customTheme.value.colors},typography:{...baseTheme.typography,...customTheme.value.typography},spacing:{...baseTheme.spacing,...customTheme.value.spacing}}:baseTheme}),initializeTheme=()=>{if(typeof localStorage<`u`){let saved=localStorage.getItem(THEME_STORAGE_KEY);saved&&[`light`,`dark`,`auto`].includes(saved)&&(currentTheme.value=saved)}},applyTheme=()=>{if(typeof document<`u`){document.documentElement.setAttribute(`data-theme`,actualTheme.value);let colors=currentThemeObject.value.colors,root=document.documentElement;root.style.setProperty(`--chart-bg`,colors.background),root.style.setProperty(`--chart-area-bg`,colors.chartArea),root.style.setProperty(`--chart-text-color`,colors.textColor),root.style.setProperty(`--chart-title-color`,colors.titleColor),root.style.setProperty(`--chart-border-color`,colors.borderColor),root.style.setProperty(`--chart-tick-color`,colors.tickColor)}};onMounted(()=>{isInitialized||(isInitialized=!0,initializeTheme(),applyTheme(),typeof window<`u`&&window.matchMedia&&window.matchMedia(`(prefers-color-scheme: dark)`).addEventListener(`change`,()=>{currentTheme.value===`auto`&&applyTheme()}))}),watch([currentTheme,customTheme],()=>{applyTheme()},{deep:!0}),onUnmounted(()=>{});let setTheme=theme$1=>{currentTheme.value=theme$1,typeof localStorage<`u`&&(theme$1===`auto`?localStorage.removeItem(THEME_STORAGE_KEY):localStorage.setItem(THEME_STORAGE_KEY,theme$1))};return{currentTheme:readonly(currentTheme),actualTheme,currentThemeObject,setTheme,setCustomTheme:theme$1=>{customTheme.value=theme$1},toggleTheme:()=>{let newTheme=actualTheme.value===`light`?`dark`:`light`;setTheme(newTheme)},getSystemTheme}}function getInitialChartDimensions(container){let isMobile$2=typeof window<`u`&&window.innerWidth<=768,size,padding;return isMobile$2?(size={width:container?.clientWidth??360,height:container?.clientHeight??500},padding={top:24,right:56,bottom:32,left:16}):(size={width:container?.clientWidth??1200,height:container?.clientHeight??700},padding={top:40,right:64,bottom:48,left:32}),{size,padding}}var _hoisted_1$4={class:`pixi-chart`},_hoisted_2$4={class:`chart-layout`},_hoisted_3$4={class:`controls-sidebar`},_hoisted_4$3={class:`control-group`},_hoisted_5$3=[`disabled`],_hoisted_6$3={class:`control-group`},_hoisted_7$3=[`disabled`],_hoisted_8$3={class:`control-group`},_hoisted_9$3=[`disabled`],_hoisted_10$3=[`disabled`],_hoisted_11$3={class:`chart-area`},_hoisted_12$3={class:`stats`},_hoisted_13$3={key:0,class:`perf-stats`},_hoisted_14$2={key:1,class:`loading-indicator`},PixiChart_default=__plugin_vue_export_helper_default(defineComponent({__name:`PixiChart`,setup(__props){let chartCanvas=ref(),chartContainer=ref(),pixiUIContainer=ref(),chartSize=reactive({width:1600,height:900}),chartPadding=reactive(getDefaultChartPadding()),{currentThemeObject,actualTheme}=useTheme(),chart=null,dataManager=null,pixiApp=null,orderEditorContainer=null,volatility=ref(Volatility.Medium),candleDuration=ref(CandleDuration.FiveSeconds),ticksPerSecond=ref(5),isRunning=ref(!1),isLoading=ref(!1),candleCount=ref(0),updatesPerSecond=ref(0),renderStats=ref(null),lastPrice=ref(0),updateCount=0,lastStatsUpdate=Date.now(),zoomLevel=ref(100),isDragging=ref(!1),lastMouseX=ref(0),showOrderEditor=ref(!1),isClosing=ref(!1),orderForm=reactive({strikePrice:0,quantity:1,price:0});watch([candleDuration,volatility,ticksPerSecond],()=>{isRunning.value||resetChart()});async function initChart(){let canvas=chartCanvas.value;if(canvas)try{isLoading.value=!0;let dimensions=getInitialChartDimensions(chartContainer.value);Object.assign(chartSize,dimensions.size),Object.assign(chartPadding,dimensions.padding),dataManager=new SimulatorDataManager({symbol:`PIXI-DEMO`,candleDuration:candleDuration.value,initialPrice:500,historicalCandleCount:500,ticksPerSecond:ticksPerSecond.value,volatility:volatility.value});let originalOnRealtimeUpdate=dataManager.onRealtimeUpdate.bind(dataManager);dataManager.onRealtimeUpdate=callback=>{originalOnRealtimeUpdate(candle=>{updateCount++,candleCount.value++,lastPrice.value=candle.close,callback(candle)})};let candleStudy=new CandleStudy;chart=new Chart(canvas,chartSize,chartPadding,currentThemeObject.value,candleStudy,dataManager,`pixijs`);let sma20=new SMAStudy(20,`#2196f3`);chart.addOverlayStudy(sma20);let bb=new BollingerBandsStudy(20,2);chart.addOverlayStudy(bb);let lastPriceLine=new LastPriceLineStudy;chart.addOverlayStudy(lastPriceLine);let volumeStudy=new VolumeStudy;if(chart.createSubPane(`volume`,volumeStudy,.2),await chart.initialize(),candleCount.value=500,dataManager){let histBatch=await dataManager.loadHistorical();histBatch.candles.length>0&&(lastPrice.value=histBatch.candles[histBatch.candles.length-1].close)}updateZoomState(),isLoading.value=!1,console.log(`PixiJS Chart initialized successfully`)}catch(error$1){console.error(`Failed to initialize PixiJS chart:`,error$1),isLoading.value=!1}}function toggleSimulation(){isRunning.value?stopSimulation():startSimulation()}function startSimulation(){dataManager&&(dataManager.start(),isRunning.value=!0,updateCount=0,lastStatsUpdate=Date.now(),startStatsTracking(),PerformanceTracker.startPeriodicLogging(1e4))}function stopSimulation(){dataManager&&(dataManager.stop(),isRunning.value=!1,stopStatsTracking(),PerformanceTracker.stopPeriodicLogging())}async function resetChart(){isRunning.value&&stopSimulation(),PerformanceTracker.resetStats(),renderStats.value=null,chart&&=(chart.destroy(),null),await initChart()}let statsInterval=null;function startStatsTracking(){statsInterval=window.setInterval(()=>{let now=Date.now(),elapsed=(now-lastStatsUpdate)/1e3;updatesPerSecond.value=updateCount/elapsed;let perfStats=PerformanceTracker.getStats(`render`);perfStats&&(renderStats.value={mean:perfStats.mean,p95:perfStats.p95,p99:perfStats.p99}),updateCount=0,lastStatsUpdate=now},1e3)}function stopStatsTracking(){statsInterval!==null&&(clearInterval(statsInterval),statsInterval=null),updatesPerSecond.value=0}function updateZoomState(){chart&&(zoomLevel.value=Math.round(chart.getZoomLevel()))}function handleWheel(event){chart&&(event.deltaY<0?chart.zoomIn():chart.zoomOut(),updateZoomState())}function handleMouseDown(event){isDragging.value=!0,lastMouseX.value=event.clientX,chartCanvas.value&&(chartCanvas.value.style.cursor=`grabbing`)}function handleMouseMove(event){if(!isDragging.value||!chart)return;let deltaX=event.clientX-lastMouseX.value,boxWidth=chart.getBoxWidth(),candlesToPan=deltaX/boxWidth;Math.abs(candlesToPan)>.01&&(chart.pan(-candlesToPan),updateZoomState()),lastMouseX.value=event.clientX}function handleMouseUp(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}function handleMouseLeave(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}async function createPixiOrderEditor(){if(!pixiUIContainer.value||!chartContainer.value)return;let containerWidth=chartContainer.value.offsetWidth,isMobile$2=containerWidth<768,panelWidth=Math.min(isMobile$2?containerWidth-24:600,containerWidth-40),panelHeight=isMobile$2?260:200;pixiApp=new Application,await pixiApp.init({width:panelWidth,height:panelHeight,backgroundAlpha:1,background:16777215,resolution:window.devicePixelRatio||1,autoDensity:!0}),pixiUIContainer.value.appendChild(pixiApp.canvas),pixiApp.renderer&&pixiApp.renderer.events&&(pixiApp.renderer.events.cursorStyles={}),pixiApp.stage.eventMode=`static`,pixiApp.stage.interactiveChildren=!0,orderEditorContainer=new Container,orderEditorContainer.eventMode=`static`,orderEditorContainer.interactiveChildren=!0,pixiApp.stage.addChild(orderEditorContainer);let padding=isMobile$2?12:10,contentWidth=panelWidth-padding*2,panel=new Graphics;panel.roundRect(0,0,contentWidth,panelHeight-padding*2,12),panel.fill({color:16382715}),panel.stroke({color:15067115,width:2}),panel.x=padding,panel.y=padding,panel.eventMode=`static`,panel.on(`pointerdown`,event=>{event.stopPropagation()}),orderEditorContainer.addChild(panel);let titleStyle=new TextStyle({fontFamily:`Arial`,fontSize:isMobile$2?15:16,fontWeight:`bold`,fill:1120295}),title=new Text({text:`Place Order (PixiJS UI)`,style:titleStyle});title.x=padding+8,title.y=padding+5,orderEditorContainer.addChild(title);let closeBtnSize=isMobile$2?32:30,closeBtn=new FancyButton({defaultView:new Graphics().roundRect(0,0,closeBtnSize,closeBtnSize,closeBtnSize/2).fill(15987958),hoverView:new Graphics().roundRect(0,0,closeBtnSize,closeBtnSize,closeBtnSize/2).fill(15067115),pressedView:new Graphics().roundRect(0,0,closeBtnSize,closeBtnSize,closeBtnSize/2).fill(13751771),text:new Text({text:``,style:new TextStyle({fontSize:isMobile$2?22:24,fill:7041664})})});closeBtn.x=contentWidth-closeBtnSize+padding-8,closeBtn.y=padding+2,closeBtn.eventMode=`static`,closeBtn.onPress.connect(()=>closeOrderEditor()),closeBtn.on(`pointerdown`,event=>{event.stopPropagation(),closeOrderEditor()}),orderEditorContainer.addChild(closeBtn);let labelStyle=new TextStyle({fontFamily:`Arial`,fontSize:isMobile$2?11:12,fontWeight:`600`,fill:7041664}),inputHeight=isMobile$2?38:40,inputWidth=isMobile$2?contentWidth-16:Math.min(140,(contentWidth-60)/3),inputSpacing=isMobile$2?0:inputWidth+20,startY=45,rowGap=isMobile$2?58:0,strikePriceLabel=new Text({text:`STRIKE PRICE`,style:labelStyle});strikePriceLabel.x=padding+8,strikePriceLabel.y=45,orderEditorContainer.addChild(strikePriceLabel);let strikePriceInput=new Input({bg:new Graphics().roundRect(0,0,inputWidth,inputHeight,8).fill(16777215).stroke({color:15067115,width:2}),textStyle:new TextStyle({fontSize:isMobile$2?15:16,fill:1120295}),value:String(orderForm.strikePrice||``),maxLength:10,padding:{top:9,right:10,bottom:9,left:10}});strikePriceInput.x=padding+8,strikePriceInput.y=63,strikePriceInput.onChange.connect(val=>{orderForm.strikePrice=parseFloat(val)||0}),orderEditorContainer.addChild(strikePriceInput);let quantityLabel=new Text({text:`QUANTITY`,style:labelStyle});quantityLabel.x=isMobile$2?padding+8:padding+8+inputSpacing,quantityLabel.y=isMobile$2?45+rowGap:45,orderEditorContainer.addChild(quantityLabel);let quantityInput=new Input({bg:new Graphics().roundRect(0,0,inputWidth,inputHeight,8).fill(16777215).stroke({color:15067115,width:2}),textStyle:new TextStyle({fontSize:isMobile$2?15:16,fill:1120295}),value:String(orderForm.quantity),maxLength:5,padding:{top:9,right:10,bottom:9,left:10}});quantityInput.x=isMobile$2?padding+8:padding+8+inputSpacing,quantityInput.y=isMobile$2?45+rowGap+18:63,quantityInput.onChange.connect(val=>{orderForm.quantity=parseInt(val)||1}),orderEditorContainer.addChild(quantityInput);let priceLabel=new Text({text:`PRICE`,style:labelStyle});priceLabel.x=isMobile$2?padding+8:padding+8+inputSpacing*2,priceLabel.y=isMobile$2?45+rowGap*2:45,orderEditorContainer.addChild(priceLabel);let priceInput=new Input({bg:new Graphics().roundRect(0,0,inputWidth,inputHeight,8).fill(16777215).stroke({color:15067115,width:2}),textStyle:new TextStyle({fontSize:isMobile$2?15:16,fill:1120295}),value:String(orderForm.price||``),maxLength:10,padding:{top:9,right:10,bottom:9,left:10}});priceInput.x=isMobile$2?padding+8:padding+8+inputSpacing*2,priceInput.y=isMobile$2?45+rowGap*2+18:63,priceInput.onChange.connect(val=>{orderForm.price=parseFloat(val)||0}),orderEditorContainer.addChild(priceInput);let buttonY=isMobile$2?45+rowGap*2+64:120,buttonWidth=isMobile$2?(contentWidth-26)/2:110,buttonHeight=isMobile$2?42:45,cancelBtn=new FancyButton({defaultView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(15987958),hoverView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(15067115),pressedView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(13751771),text:new Text({text:`Cancel`,style:new TextStyle({fontSize:14,fontWeight:`bold`,fill:4937059})})});cancelBtn.x=padding+8,cancelBtn.y=buttonY,cancelBtn.eventMode=`static`,cancelBtn.onPress.connect(()=>closeOrderEditor()),cancelBtn.on(`pointerdown`,event=>{event.stopPropagation(),closeOrderEditor()}),orderEditorContainer.addChild(cancelBtn);let placeBtn=new FancyButton({defaultView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(6717162),hoverView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(5597395),pressedView:new Graphics().roundRect(0,0,buttonWidth,buttonHeight,8).fill(5005255),text:new Text({text:`Place Order`,style:new TextStyle({fontSize:14,fontWeight:`bold`,fill:16777215})})});placeBtn.x=isMobile$2?contentWidth-buttonWidth+padding-8:contentWidth-buttonWidth-10,placeBtn.y=buttonY,placeBtn.eventMode=`static`,placeBtn.onPress.connect(()=>placeOrder()),placeBtn.on(`pointerdown`,event=>{event.stopPropagation(),placeOrder()}),orderEditorContainer.addChild(placeBtn)}function handleChartClick(){isDragging.value||isClosing.value||(orderForm.strikePrice=lastPrice.value,orderForm.quantity=1,orderForm.price=lastPrice.value,showOrderEditor.value=!0,setTimeout(()=>{pixiApp||createPixiOrderEditor()},0))}function closeOrderEditor(){if(isClosing.value=!0,showOrderEditor.value=!1,pixiApp)try{orderEditorContainer&&=(orderEditorContainer.removeChildren(),orderEditorContainer.destroy({children:!0,texture:!1}),null),pixiApp.destroy(!1,{children:!0,texture:!1}),pixiApp=null}catch(error$1){console.warn(`Error destroying order panel:`,error$1),pixiApp=null,orderEditorContainer=null}pixiUIContainer.value&&(pixiUIContainer.value.innerHTML=``),setTimeout(()=>{isClosing.value=!1},300)}function placeOrder(){console.log(`PixiJS Order placed:`,{strikePrice:orderForm.strikePrice,quantity:orderForm.quantity,price:orderForm.price}),alert(`PixiJS Order Placed!\nStrike: ${orderForm.strikePrice}\nQuantity: ${orderForm.quantity}\nPrice: ${orderForm.price}`),closeOrderEditor()}return onMounted(()=>{initChart();let isDev=typeof process<`u`&&!1;typeof window<`u`&&(window.PerformanceTracker=PerformanceTracker,isDev&&console.log(`[DEBUG] PerformanceTracker exposed to window. Try: PerformanceTracker.printAllStats()`))}),onUnmounted(()=>{if(isRunning.value&&stopSimulation(),stopStatsTracking(),PerformanceTracker.stopPeriodicLogging(),pixiApp){try{orderEditorContainer&&=(orderEditorContainer.removeChildren(),orderEditorContainer.destroy({children:!0,texture:!1}),null),pixiApp.destroy(!1,{children:!0,texture:!1})}catch(error$1){console.warn(`Error destroying order panel on unmount:`,error$1)}pixiApp=null}chart&&chart.destroy()}),watch(()=>actualTheme.value,()=>{let newTheme=currentThemeObject.value;chart&&chart.updateTheme(newTheme)}),(_ctx,_cache)=>(openBlock(),createElementBlock(`div`,_hoisted_1$4,[_cache[8]||=createBaseVNode(`h2`,{class:`demo-title`},`PixiJS Graphics (WebGL)`,-1),createBaseVNode(`div`,_hoisted_2$4,[createBaseVNode(`div`,_hoisted_3$4,[createBaseVNode(`div`,_hoisted_4$3,[_cache[4]||=createBaseVNode(`label`,null,`Volatility`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[0]||=$event=>volatility.value=$event,disabled:isRunning.value},[..._cache[3]||=[createBaseVNode(`option`,{value:`low`},`Low`,-1),createBaseVNode(`option`,{value:`medium`},`Medium`,-1),createBaseVNode(`option`,{value:`high`},`High`,-1)]],8,_hoisted_5$3),[[vModelSelect,volatility.value]])]),createBaseVNode(`div`,_hoisted_6$3,[_cache[6]||=createBaseVNode(`label`,null,`Candle Duration`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[1]||=$event=>candleDuration.value=$event,disabled:isRunning.value},[..._cache[5]||=[createBaseVNode(`option`,{value:`1s`},`1 Second`,-1),createBaseVNode(`option`,{value:`5s`},`5 Seconds`,-1),createBaseVNode(`option`,{value:`30s`},`30 Seconds`,-1),createBaseVNode(`option`,{value:`1m`},`1 Minute`,-1)]],8,_hoisted_7$3),[[vModelSelect,candleDuration.value]])]),createBaseVNode(`div`,_hoisted_8$3,[_cache[7]||=createBaseVNode(`label`,null,`Ticks/sec`,-1),withDirectives(createBaseVNode(`input`,{type:`number`,"onUpdate:modelValue":_cache[2]||=$event=>ticksPerSecond.value=$event,min:`1`,max:`60`,disabled:isRunning.value},null,8,_hoisted_9$3),[[vModelText,ticksPerSecond.value,void 0,{number:!0}]])]),createBaseVNode(`button`,{onClick:toggleSimulation,class:`toggle-btn`},toDisplayString(isRunning.value?`Stop`:`Start`),1),createBaseVNode(`button`,{onClick:resetChart,disabled:!isRunning.value,class:`reset-btn`},` Reset `,8,_hoisted_10$3)]),createBaseVNode(`div`,_hoisted_11$3,[createBaseVNode(`div`,{ref_key:`chartContainer`,ref:chartContainer,class:`chart-container`},[createBaseVNode(`canvas`,{ref_key:`chartCanvas`,ref:chartCanvas,class:`chart-canvas`,onWheel:withModifiers(handleWheel,[`prevent`]),onMousedown:handleMouseDown,onMousemove:handleMouseMove,onMouseup:handleMouseUp,onMouseleave:handleMouseLeave,onClick:handleChartClick},null,544),showOrderEditor.value?(openBlock(),createElementBlock(`div`,{key:0,ref_key:`pixiUIContainer`,ref:pixiUIContainer,class:`pixi-order-panel`},null,512)):createCommentVNode(``,!0)],512),createBaseVNode(`div`,_hoisted_12$3,[createBaseVNode(`span`,null,`Candles: `+toDisplayString(candleCount.value),1),createBaseVNode(`span`,null,`Updates/sec: `+toDisplayString(updatesPerSecond.value.toFixed(1)),1),createBaseVNode(`span`,null,`Zoom: `+toDisplayString(zoomLevel.value)+`%`,1),renderStats.value?(openBlock(),createElementBlock(`span`,_hoisted_13$3,`Render: `+toDisplayString(renderStats.value.mean.toFixed(1))+`ms (p95: `+toDisplayString(renderStats.value.p95.toFixed(1))+`ms)`,1)):createCommentVNode(``,!0),isLoading.value?(openBlock(),createElementBlock(`span`,_hoisted_14$2,` Loading initial data...`)):createCommentVNode(``,!0)])])])]))}}),[[`__scopeId`,`data-v-988c59c9`]]),_hoisted_1$3={class:`mesh-chart`},_hoisted_2$3={class:`chart-layout`},_hoisted_3$3={class:`controls-sidebar`},_hoisted_4$2={class:`control-group`},_hoisted_5$2=[`disabled`],_hoisted_6$2={class:`control-group`},_hoisted_7$2=[`disabled`],_hoisted_8$2={class:`control-group`},_hoisted_9$2=[`disabled`],_hoisted_10$2=[`disabled`],_hoisted_11$2={class:`chart-area`},_hoisted_12$2={class:`stats`},_hoisted_13$2={key:0,class:`perf-stats`},_hoisted_14$1={key:1,class:`loading-indicator`},MeshChart_default=__plugin_vue_export_helper_default(defineComponent({__name:`MeshChart`,setup(__props){let chartCanvas=ref(),chartContainer=ref(),chartSize=reactive({width:1600,height:900}),chartPadding=reactive(getDefaultChartPadding()),{currentThemeObject,actualTheme}=useTheme(),chart=null,dataManager=null,volatility=ref(Volatility.Medium),candleDuration=ref(CandleDuration.FiveSeconds),ticksPerSecond=ref(5),isRunning=ref(!1),isLoading=ref(!1),candleCount=ref(0),updatesPerSecond=ref(0),renderStats=ref(null),lastPrice=ref(0),updateCount=0,lastStatsUpdate=Date.now(),zoomLevel=ref(100),isDragging=ref(!1),lastMouseX=ref(0);watch([candleDuration,volatility,ticksPerSecond],()=>{isRunning.value||resetChart()});async function initChart(){let canvas=chartCanvas.value;if(canvas)try{isLoading.value=!0;let dimensions=getInitialChartDimensions(chartContainer.value);Object.assign(chartSize,dimensions.size),Object.assign(chartPadding,dimensions.padding),dataManager=new SimulatorDataManager({symbol:`MESH-DEMO`,candleDuration:candleDuration.value,initialPrice:500,historicalCandleCount:500,ticksPerSecond:ticksPerSecond.value,volatility:volatility.value});let originalOnRealtimeUpdate=dataManager.onRealtimeUpdate.bind(dataManager);dataManager.onRealtimeUpdate=callback=>{originalOnRealtimeUpdate(candle=>{updateCount++,candleCount.value++,lastPrice.value=candle.close,callback(candle)})};let candleStudy=new CandleStudy;chart=new Chart(canvas,chartSize,chartPadding,currentThemeObject.value,candleStudy,dataManager,`pixijs-mesh`);let sma20=new SMAStudy(20,`#2196f3`);chart.addOverlayStudy(sma20);let bb=new BollingerBandsStudy(20,2);chart.addOverlayStudy(bb);let lastPriceLine=new LastPriceLineStudy;chart.addOverlayStudy(lastPriceLine);let volumeStudy=new VolumeStudy;chart.createSubPane(`volume`,volumeStudy,.2),await chart.initialize(),candleCount.value=500,updateZoomState(),isLoading.value=!1,console.log(`PixiJS Mesh Chart initialized successfully`)}catch(error$1){console.error(`Failed to initialize PixiJS Mesh chart:`,error$1),isLoading.value=!1}}function toggleSimulation(){isRunning.value?stopSimulation():startSimulation()}function startSimulation(){dataManager&&(dataManager.start(),isRunning.value=!0,updateCount=0,lastStatsUpdate=Date.now(),startStatsTracking(),PerformanceTracker.startPeriodicLogging(1e4))}function stopSimulation(){dataManager&&(dataManager.stop(),isRunning.value=!1,stopStatsTracking(),PerformanceTracker.stopPeriodicLogging())}async function resetChart(){isRunning.value&&stopSimulation(),PerformanceTracker.resetStats(),renderStats.value=null,chart&&=(chart.destroy(),null),await initChart()}let statsInterval=null;function startStatsTracking(){statsInterval=window.setInterval(()=>{let now=Date.now(),elapsed=(now-lastStatsUpdate)/1e3;updatesPerSecond.value=updateCount/elapsed;let perfStats=PerformanceTracker.getStats(`render`);perfStats&&(renderStats.value={mean:perfStats.mean,p95:perfStats.p95,p99:perfStats.p99}),updateCount=0,lastStatsUpdate=now},1e3)}function stopStatsTracking(){statsInterval!==null&&(clearInterval(statsInterval),statsInterval=null),updatesPerSecond.value=0}function updateZoomState(){chart&&(zoomLevel.value=Math.round(chart.getZoomLevel()))}function handleWheel(event){chart&&(event.deltaY<0?chart.zoomIn():chart.zoomOut(),updateZoomState())}function handleMouseDown(event){isDragging.value=!0,lastMouseX.value=event.clientX,chartCanvas.value&&(chartCanvas.value.style.cursor=`grabbing`)}function handleMouseMove(event){if(!isDragging.value||!chart)return;let deltaX=event.clientX-lastMouseX.value,boxWidth=chart.getBoxWidth(),candlesToPan=deltaX/boxWidth;Math.abs(candlesToPan)>.01&&(chart.pan(-candlesToPan),updateZoomState()),lastMouseX.value=event.clientX}function handleMouseUp(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}function handleMouseLeave(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}return onMounted(()=>{initChart();let isDev=typeof process<`u`&&!1;typeof window<`u`&&(window.PerformanceTracker=PerformanceTracker,isDev&&console.log(`[DEBUG] PerformanceTracker exposed to window. Try: PerformanceTracker.printAllStats()`))}),onUnmounted(()=>{isRunning.value&&stopSimulation(),stopStatsTracking(),PerformanceTracker.stopPeriodicLogging(),chart&&chart.destroy()}),watch(()=>actualTheme.value,()=>{let newTheme=currentThemeObject.value;chart&&chart.updateTheme(newTheme)}),(_ctx,_cache)=>(openBlock(),createElementBlock(`div`,_hoisted_1$3,[_cache[8]||=createBaseVNode(`h2`,{class:`demo-title`},`PixiJS Mesh (Vertex Buffers)`,-1),createBaseVNode(`div`,_hoisted_2$3,[createBaseVNode(`div`,_hoisted_3$3,[createBaseVNode(`div`,_hoisted_4$2,[_cache[4]||=createBaseVNode(`label`,null,`Volatility`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[0]||=$event=>volatility.value=$event,disabled:isRunning.value},[..._cache[3]||=[createBaseVNode(`option`,{value:`low`},`Low`,-1),createBaseVNode(`option`,{value:`medium`},`Medium`,-1),createBaseVNode(`option`,{value:`high`},`High`,-1)]],8,_hoisted_5$2),[[vModelSelect,volatility.value]])]),createBaseVNode(`div`,_hoisted_6$2,[_cache[6]||=createBaseVNode(`label`,null,`Candle Duration`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[1]||=$event=>candleDuration.value=$event,disabled:isRunning.value},[..._cache[5]||=[createBaseVNode(`option`,{value:`1s`},`1 Second`,-1),createBaseVNode(`option`,{value:`5s`},`5 Seconds`,-1),createBaseVNode(`option`,{value:`30s`},`30 Seconds`,-1),createBaseVNode(`option`,{value:`1m`},`1 Minute`,-1)]],8,_hoisted_7$2),[[vModelSelect,candleDuration.value]])]),createBaseVNode(`div`,_hoisted_8$2,[_cache[7]||=createBaseVNode(`label`,null,`Ticks/sec`,-1),withDirectives(createBaseVNode(`input`,{type:`number`,"onUpdate:modelValue":_cache[2]||=$event=>ticksPerSecond.value=$event,min:`1`,max:`60`,disabled:isRunning.value},null,8,_hoisted_9$2),[[vModelText,ticksPerSecond.value,void 0,{number:!0}]])]),createBaseVNode(`button`,{onClick:toggleSimulation,class:`toggle-btn`},toDisplayString(isRunning.value?`Stop`:`Start`),1),createBaseVNode(`button`,{onClick:resetChart,disabled:!isRunning.value,class:`reset-btn`},` Reset `,8,_hoisted_10$2)]),createBaseVNode(`div`,_hoisted_11$2,[createBaseVNode(`div`,{ref_key:`chartContainer`,ref:chartContainer,class:`chart-container`},[createBaseVNode(`canvas`,{ref_key:`chartCanvas`,ref:chartCanvas,class:`chart-canvas`,onWheel:withModifiers(handleWheel,[`prevent`]),onMousedown:handleMouseDown,onMousemove:handleMouseMove,onMouseup:handleMouseUp,onMouseleave:handleMouseLeave},null,544)],512),createBaseVNode(`div`,_hoisted_12$2,[createBaseVNode(`span`,null,`Candles: `+toDisplayString(candleCount.value),1),createBaseVNode(`span`,null,`Updates/sec: `+toDisplayString(updatesPerSecond.value.toFixed(1)),1),createBaseVNode(`span`,null,`Zoom: `+toDisplayString(zoomLevel.value)+`%`,1),renderStats.value?(openBlock(),createElementBlock(`span`,_hoisted_13$2,`Render: `+toDisplayString(renderStats.value.mean.toFixed(1))+`ms (p95: `+toDisplayString(renderStats.value.p95.toFixed(1))+`ms)`,1)):createCommentVNode(``,!0),isLoading.value?(openBlock(),createElementBlock(`span`,_hoisted_14$1,` Loading initial data...`)):createCommentVNode(``,!0)])])])]))}}),[[`__scopeId`,`data-v-10500192`]]),_hoisted_1$2={class:`live-chart-demo`},_hoisted_2$2={class:`chart-layout`},_hoisted_3$2={class:`controls-sidebar`},_hoisted_4$1={class:`control-group`},_hoisted_5$1=[`disabled`],_hoisted_6$1={class:`control-group`},_hoisted_7$1=[`disabled`],_hoisted_8$1={class:`control-group`},_hoisted_9$1=[`disabled`],_hoisted_10$1=[`disabled`],_hoisted_11$1={class:`chart-area`},_hoisted_12$1={class:`stats`},_hoisted_13$1={key:0,class:`perf-stats`},_hoisted_14={key:1,class:`loading-indicator`},_hoisted_15={class:`order-body`},_hoisted_16={class:`order-field`},_hoisted_17={class:`order-field`},_hoisted_18={class:`order-field`},LiveChartDemo_default=__plugin_vue_export_helper_default(defineComponent({__name:`LiveChartDemo`,setup(__props){let chartCanvas=ref(),chartContainer=ref(),chartSize=reactive({width:1600,height:900}),chartPadding=reactive(getDefaultChartPadding()),{currentThemeObject}=useTheme(),chart=null,dataManager=null,volatility=ref(Volatility.Medium),candleDuration=ref(CandleDuration.FiveSeconds),ticksPerSecond=ref(5),isRunning=ref(!1),isLoading=ref(!1),candleCount=ref(0),updatesPerSecond=ref(0),renderStats=ref(null),lastPrice=ref(0),updateCount=0,lastStatsUpdate=Date.now(),zoomLevel=ref(100),isDragging=ref(!1),lastMouseX=ref(0),showOrderEditor=ref(!1),orderForm=reactive({strikePrice:0,quantity:1,price:0}),qtyInput=ref(),priceInput=ref();watch([candleDuration,volatility,ticksPerSecond],()=>{isRunning.value||resetChart()});async function initChart(){let canvas=chartCanvas.value;if(canvas)try{isLoading.value=!0;let dimensions=getInitialChartDimensions(chartContainer.value);Object.assign(chartSize,dimensions.size),Object.assign(chartPadding,dimensions.padding),dataManager=new SimulatorDataManager({symbol:`DEMO`,candleDuration:candleDuration.value,initialPrice:500,historicalCandleCount:500,ticksPerSecond:ticksPerSecond.value,volatility:volatility.value});let originalOnRealtimeUpdate=dataManager.onRealtimeUpdate.bind(dataManager);dataManager.onRealtimeUpdate=callback=>{originalOnRealtimeUpdate(candle=>{updateCount++,lastPrice.value=candle.close,callback(candle)})};let candleStudy=new CandleStudy;chart=new Chart(canvas,chartSize,chartPadding,currentThemeObject.value,candleStudy,dataManager);let sma20=new SMAStudy(20,`#ff9800`);chart.addOverlayStudy(sma20);let bb=new BollingerBandsStudy(20,2);chart.addOverlayStudy(bb);let lastPriceLine=new LastPriceLineStudy;chart.addOverlayStudy(lastPriceLine);let volumeStudy=new VolumeStudy;if(chart.createSubPane(`volume`,volumeStudy,.2),await chart.initialize(),candleCount.value=chart.getVisibleIndices().endIndex+1,dataManager){let histBatch=await dataManager.loadHistorical();histBatch.candles.length>0&&(lastPrice.value=histBatch.candles[histBatch.candles.length-1].close)}updateZoomState(),console.log(`Chart initialized with`,candleCount.value,`historical candles`)}catch(error$1){console.error(`Failed to initialize chart:`,error$1)}finally{isLoading.value=!1}}let statsInterval=null;function startSimulation(){!dataManager||isRunning.value||(console.log(`Starting simulation...`),isRunning.value=!0,updateCount=0,lastStatsUpdate=Date.now(),statsInterval=setInterval(()=>{let now=Date.now(),elapsed=(now-lastStatsUpdate)/1e3;updatesPerSecond.value=updateCount/elapsed;let perfStats=PerformanceTracker.getStats(`render`);perfStats&&(renderStats.value={mean:perfStats.mean,p95:perfStats.p95,p99:perfStats.p99}),updateCount=0,lastStatsUpdate=now},1e3),PerformanceTracker.startPeriodicLogging(1e4),dataManager.start())}function stopSimulation(){dataManager&&(dataManager.stop(),statsInterval&&=(clearInterval(statsInterval),null),PerformanceTracker.stopPeriodicLogging(),isRunning.value=!1,updatesPerSecond.value=0,console.log(`Simulation stopped`))}function toggleSimulation(){isRunning.value?stopSimulation():startSimulation()}async function resetChart(){isRunning.value&&stopSimulation(),PerformanceTracker.resetStats(),renderStats.value=null,chart&&=(chart.destroy(),null),dataManager=null,candleCount.value=0,await initChart()}function updateZoomState(){chart&&(zoomLevel.value=Math.round(chart.getZoomLevel()))}function handleWheel(event){chart&&(event.deltaY<0?chart.zoomIn():chart.zoomOut(),updateZoomState())}function handleMouseDown(event){isDragging.value=!0,lastMouseX.value=event.clientX,chartCanvas.value&&(chartCanvas.value.style.cursor=`grabbing`)}function handleMouseMove(event){if(!isDragging.value||!chart)return;let deltaX=event.clientX-lastMouseX.value,boxWidth=chart.getBoxWidth(),candlesToPan=deltaX/boxWidth;Math.abs(candlesToPan)>.01&&(chart.pan(-candlesToPan),updateZoomState()),lastMouseX.value=event.clientX}function handleMouseUp(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}function handleMouseLeave(){isDragging.value=!1,chartCanvas.value&&(chartCanvas.value.style.cursor=`grab`)}function handleChartClick(){isDragging.value||(orderForm.strikePrice=lastPrice.value,orderForm.quantity=1,orderForm.price=lastPrice.value,showOrderEditor.value=!0,setTimeout(()=>{priceInput.value?.focus()},350))}function closeOrderEditor(){showOrderEditor.value=!1}function placeOrder(){console.log(`Order placed:`,{strikePrice:orderForm.strikePrice,quantity:orderForm.quantity,price:orderForm.price}),alert(`Order Placed!\nStrike: ${orderForm.strikePrice}\nQuantity: ${orderForm.quantity}\nPrice: ${orderForm.price}`),closeOrderEditor()}return onMounted(()=>{initChart();let isDev=typeof process<`u`&&!1;typeof window<`u`&&(window.PerformanceTracker=PerformanceTracker,isDev&&console.log(`[DEBUG] PerformanceTracker exposed to window. Try: PerformanceTracker.printAllStats()`))}),onUnmounted(()=>{isRunning.value&&stopSimulation(),chart&&chart.destroy()}),(_ctx,_cache)=>(openBlock(),createElementBlock(`div`,_hoisted_1$2,[_cache[17]||=createBaseVNode(`h2`,{class:`demo-title`},`Canvas2D Live Demo`,-1),createBaseVNode(`div`,_hoisted_2$2,[createBaseVNode(`div`,_hoisted_3$2,[createBaseVNode(`div`,_hoisted_4$1,[_cache[8]||=createBaseVNode(`label`,null,`Volatility`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[0]||=$event=>volatility.value=$event,disabled:isRunning.value},[..._cache[7]||=[createBaseVNode(`option`,{value:`low`},`Low`,-1),createBaseVNode(`option`,{value:`medium`},`Medium`,-1),createBaseVNode(`option`,{value:`high`},`High`,-1)]],8,_hoisted_5$1),[[vModelSelect,volatility.value]])]),createBaseVNode(`div`,_hoisted_6$1,[_cache[10]||=createBaseVNode(`label`,null,`Candle Duration`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[1]||=$event=>candleDuration.value=$event,disabled:isRunning.value},[..._cache[9]||=[createStaticVNode(`<option value="1s" data-v-08c1ecef>1 Second</option><option value="5s" data-v-08c1ecef>5 Seconds</option><option value="30s" data-v-08c1ecef>30 Seconds</option><option value="1m" data-v-08c1ecef>1 Minute</option><option value="5m" data-v-08c1ecef>5 Minutes</option><option value="15m" data-v-08c1ecef>15 Minutes</option><option value="30m" data-v-08c1ecef>30 Minutes</option><option value="1h" data-v-08c1ecef>1 Hour</option><option value="4h" data-v-08c1ecef>4 Hours</option><option value="1d" data-v-08c1ecef>1 Day</option><option value="1w" data-v-08c1ecef>1 Week</option><option value="1M" data-v-08c1ecef>1 Month</option>`,12)]],8,_hoisted_7$1),[[vModelSelect,candleDuration.value]])]),createBaseVNode(`div`,_hoisted_8$1,[_cache[11]||=createBaseVNode(`label`,null,`Ticks/sec`,-1),withDirectives(createBaseVNode(`input`,{type:`number`,"onUpdate:modelValue":_cache[2]||=$event=>ticksPerSecond.value=$event,min:`1`,max:`60`,disabled:isRunning.value},null,8,_hoisted_9$1),[[vModelText,ticksPerSecond.value,void 0,{number:!0}]])]),createBaseVNode(`button`,{onClick:toggleSimulation,class:`toggle-btn`},toDisplayString(isRunning.value?`Stop`:`Start`),1),createBaseVNode(`button`,{onClick:resetChart,disabled:!isRunning.value,class:`reset-btn`},` Reset `,8,_hoisted_10$1)]),createBaseVNode(`div`,_hoisted_11$1,[createBaseVNode(`div`,{ref_key:`chartContainer`,ref:chartContainer,class:`chart-container`},[createBaseVNode(`canvas`,{ref_key:`chartCanvas`,ref:chartCanvas,class:`chart-canvas`,onWheel:withModifiers(handleWheel,[`prevent`]),onMousedown:handleMouseDown,onMousemove:handleMouseMove,onMouseup:handleMouseUp,onMouseleave:handleMouseLeave,onClick:handleChartClick},null,544)],512),createBaseVNode(`div`,_hoisted_12$1,[createBaseVNode(`span`,null,`Candles: `+toDisplayString(candleCount.value),1),createBaseVNode(`span`,null,`Updates/sec: `+toDisplayString(updatesPerSecond.value.toFixed(1)),1),createBaseVNode(`span`,null,`Zoom: `+toDisplayString(zoomLevel.value)+`%`,1),renderStats.value?(openBlock(),createElementBlock(`span`,_hoisted_13$1,`Render: `+toDisplayString(renderStats.value.mean.toFixed(1))+`ms (p95: `+toDisplayString(renderStats.value.p95.toFixed(1))+`ms)`,1)):createCommentVNode(``,!0),isLoading.value?(openBlock(),createElementBlock(`span`,_hoisted_14,` Loading initial data...`)):createCommentVNode(``,!0)])])]),showOrderEditor.value?(openBlock(),createElementBlock(`div`,{key:0,class:`drawer-overlay`,onClick:closeOrderEditor},[createBaseVNode(`div`,{class:normalizeClass([`order-drawer`,{"drawer-open":showOrderEditor.value}]),onClick:_cache[6]||=withModifiers(()=>{},[`stop`])},[_cache[16]||=createBaseVNode(`div`,{class:`drawer-handle`},null,-1),createBaseVNode(`div`,{class:`order-header`},[_cache[12]||=createBaseVNode(`h3`,null,`Place Order`,-1),createBaseVNode(`button`,{class:`close-btn`,onClick:closeOrderEditor},``)]),createBaseVNode(`div`,_hoisted_15,[createBaseVNode(`div`,_hoisted_16,[_cache[13]||=createBaseVNode(`label`,{for:`strike-price`},`Strike Price`,-1),withDirectives(createBaseVNode(`input`,{id:`strike-price`,type:`number`,"onUpdate:modelValue":_cache[3]||=$event=>orderForm.strikePrice=$event,step:`0.5`,placeholder:`Enter strike price`,inputmode:`decimal`},null,512),[[vModelText,orderForm.strikePrice,void 0,{number:!0}]])]),createBaseVNode(`div`,_hoisted_17,[_cache[14]||=createBaseVNode(`label`,{for:`quantity`},`Quantity`,-1),withDirectives(createBaseVNode(`input`,{id:`quantity`,ref_key:`qtyInput`,ref:qtyInput,type:`number`,"onUpdate:modelValue":_cache[4]||=$event=>orderForm.quantity=$event,min:`1`,step:`1`,placeholder:`Enter quantity`,inputmode:`numeric`},null,512),[[vModelText,orderForm.quantity,void 0,{number:!0}]])]),createBaseVNode(`div`,_hoisted_18,[_cache[15]||=createBaseVNode(`label`,{for:`price`},`Price`,-1),withDirectives(createBaseVNode(`input`,{id:`price`,ref_key:`priceInput`,ref:priceInput,type:`number`,"onUpdate:modelValue":_cache[5]||=$event=>orderForm.price=$event,min:`0`,step:`0.05`,placeholder:`Enter price`,inputmode:`decimal`},null,512),[[vModelText,orderForm.price,void 0,{number:!0}]])])]),createBaseVNode(`div`,{class:`order-actions`},[createBaseVNode(`button`,{class:`btn-cancel`,onClick:closeOrderEditor},`Cancel`),createBaseVNode(`button`,{class:`btn-place`,onClick:placeOrder},`Place Order`)])],2)])):createCommentVNode(``,!0)]))}}),[[`__scopeId`,`data-v-08c1ecef`]]),extendStatics=function(d$1,b$1){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d$2,b$2){d$2.__proto__=b$2}||function(d$2,b$2){for(var p$2 in b$2)Object.prototype.hasOwnProperty.call(b$2,p$2)&&(d$2[p$2]=b$2[p$2])},extendStatics(d$1,b$1)};function __extends(d$1,b$1){if(typeof b$1!=`function`&&b$1!==null)throw TypeError(`Class extends value `+String(b$1)+` is not a constructor or null`);extendStatics(d$1,b$1);function __(){this.constructor=d$1}d$1.prototype=b$1===null?Object.create(b$1):(__.prototype=b$1.prototype,new __)}var Browser=function(){function Browser$1(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return Browser$1}(),env=new(function(){function Env(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<`u`}return Env}());typeof wx==`object`&&typeof wx.getSystemInfoSync==`function`?(env.wxa=!0,env.touchEventsSupported=!0):typeof document>`u`&&typeof self<`u`?env.worker=!0:!env.hasGlobalWindow||`Deno`in window||typeof navigator<`u`&&typeof navigator.userAgent==`string`&&navigator.userAgent.indexOf(`Node.js`)>-1?(env.node=!0,env.svgSupported=!0):detect(navigator.userAgent,env);function detect(ua,env$1){var browser=env$1.browser,firefox=ua.match(/Firefox\/([\d.]+)/),ie=ua.match(/MSIE\s([\d.]+)/)||ua.match(/Trident\/.+?rv:(([\d.]+))/),edge=ua.match(/Edge?\/([\d.]+)/),weChat=/micromessenger/i.test(ua);if(firefox&&(browser.firefox=!0,browser.version=firefox[1]),ie&&(browser.ie=!0,browser.version=ie[1]),edge&&(browser.edge=!0,browser.version=edge[1],browser.newEdge=+edge[1].split(`.`)[0]>18),weChat&&(browser.weChat=!0),env$1.svgSupported=typeof SVGRect<`u`,env$1.touchEventsSupported=`ontouchstart`in window&&!browser.ie&&!browser.edge,env$1.pointerEventsSupported=`onpointerdown`in window&&(browser.edge||browser.ie&&+browser.version>=11),env$1.domSupported=typeof document<`u`){var style=document.documentElement.style;env$1.transform3dSupported=(browser.ie&&`transition`in style||browser.edge||`WebKitCSSMatrix`in window&&`m11`in new WebKitCSSMatrix||`MozPerspective`in style)&&!(`OTransition`in style),env$1.transformSupported=env$1.transform3dSupported||browser.ie&&+browser.version>=9}}var env_default=env,DEFAULT_FONT_SIZE=12,DEFAULT_FONT=`12px sans-serif`,OFFSET=20,SCALE=100,defaultWidthMapStr=`007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N`;function getTextWidthMap(mapStr){var map$2={};if(typeof JSON>`u`)return map$2;for(var i$1=0;i$1<mapStr.length;i$1++){var char=String.fromCharCode(i$1+32);map$2[char]=(mapStr.charCodeAt(i$1)-OFFSET)/SCALE}return map$2}var DEFAULT_TEXT_WIDTH_MAP=getTextWidthMap(defaultWidthMapStr),platformApi={createCanvas:function(){return typeof document<`u`&&document.createElement(`canvas`)},measureText:(function(){var _ctx,_cachedFont;return function(text,font){if(!_ctx){var canvas=platformApi.createCanvas();_ctx=canvas&&canvas.getContext(`2d`)}if(_ctx)return _cachedFont!==font&&(_cachedFont=_ctx.font=font||`12px sans-serif`),_ctx.measureText(text);text||=``,font||=`12px sans-serif`;var res=/((?:\d+)?\.?\d*)px/.exec(font),fontSize=res&&+res[1]||12,width=0;if(font.indexOf(`mono`)>=0)width=fontSize*text.length;else for(var i$1=0;i$1<text.length;i$1++){var preCalcWidth=DEFAULT_TEXT_WIDTH_MAP[text[i$1]];width+=preCalcWidth==null?fontSize:preCalcWidth*fontSize}return{width}}})(),loadImage:function(src,onload,onerror){var image=new Image;return image.onload=onload,image.onerror=onerror,image.src=src,image}},BUILTIN_OBJECT=reduce([`Function`,`RegExp`,`Date`,`Error`,`CanvasGradient`,`CanvasPattern`,`Image`,`Canvas`],function(obj,val){return obj[`[object `+val+`]`]=!0,obj},{}),TYPED_ARRAY=reduce([`Int8`,`Uint8`,`Uint8Clamped`,`Int16`,`Uint16`,`Int32`,`Uint32`,`Float32`,`Float64`],function(obj,val){return obj[`[object `+val+`Array]`]=!0,obj},{}),objToString=Object.prototype.toString,arrayProto=Array.prototype,nativeForEach=arrayProto.forEach,nativeFilter=arrayProto.filter,nativeSlice=arrayProto.slice,nativeMap=arrayProto.map,ctorFunction=function(){}.constructor,protoFunction=ctorFunction?ctorFunction.prototype:null,protoKey=`__proto__`,idStart=2311;function guid(){return idStart++}function logError(){var args=[...arguments];typeof console<`u`&&console.error.apply(console,args)}function clone(source$2){if(typeof source$2!=`object`||!source$2)return source$2;var result=source$2,typeStr=objToString.call(source$2);if(typeStr===`[object Array]`){if(!isPrimitive(source$2)){result=[];for(var i$1=0,len$1=source$2.length;i$1<len$1;i$1++)result[i$1]=clone(source$2[i$1])}}else if(TYPED_ARRAY[typeStr]){if(!isPrimitive(source$2)){var Ctor=source$2.constructor;if(Ctor.from)result=Ctor.from(source$2);else{result=new Ctor(source$2.length);for(var i$1=0,len$1=source$2.length;i$1<len$1;i$1++)result[i$1]=source$2[i$1]}}}else if(!BUILTIN_OBJECT[typeStr]&&!isPrimitive(source$2)&&!isDom(source$2))for(var key$1 in result={},source$2)source$2.hasOwnProperty(key$1)&&key$1!==protoKey&&(result[key$1]=clone(source$2[key$1]));return result}function merge(target,source$2,overwrite){if(!isObject(source$2)||!isObject(target))return overwrite?clone(source$2):target;for(var key$1 in source$2)if(source$2.hasOwnProperty(key$1)&&key$1!==protoKey){var targetProp=target[key$1],sourceProp=source$2[key$1];isObject(sourceProp)&&isObject(targetProp)&&!isArray(sourceProp)&&!isArray(targetProp)&&!isDom(sourceProp)&&!isDom(targetProp)&&!isBuiltInObject(sourceProp)&&!isBuiltInObject(targetProp)&&!isPrimitive(sourceProp)&&!isPrimitive(targetProp)?merge(targetProp,sourceProp,overwrite):(overwrite||!(key$1 in target))&&(target[key$1]=clone(source$2[key$1]))}return target}function extend(target,source$2){if(Object.assign)Object.assign(target,source$2);else for(var key$1 in source$2)source$2.hasOwnProperty(key$1)&&key$1!==protoKey&&(target[key$1]=source$2[key$1]);return target}function defaults(target,source$2,overlay){for(var keysArr=keys(source$2),i$1=0,len$1=keysArr.length;i$1<len$1;i$1++){var key$1=keysArr[i$1];(overlay?source$2[key$1]!=null:target[key$1]==null)&&(target[key$1]=source$2[key$1])}return target}var createCanvas=platformApi.createCanvas;function indexOf(array,value){if(array){if(array.indexOf)return array.indexOf(value);for(var i$1=0,len$1=array.length;i$1<len$1;i$1++)if(array[i$1]===value)return i$1}return-1}function inherits(clazz,baseClazz){var clazzPrototype=clazz.prototype;function F(){}for(var prop in F.prototype=baseClazz.prototype,clazz.prototype=new F,clazzPrototype)clazzPrototype.hasOwnProperty(prop)&&(clazz.prototype[prop]=clazzPrototype[prop]);clazz.prototype.constructor=clazz,clazz.superClass=baseClazz}function mixin(target,source$2,override){if(target=`prototype`in target?target.prototype:target,source$2=`prototype`in source$2?source$2.prototype:source$2,Object.getOwnPropertyNames)for(var keyList=Object.getOwnPropertyNames(source$2),i$1=0;i$1<keyList.length;i$1++){var key$1=keyList[i$1];key$1!==`constructor`&&(override?source$2[key$1]!=null:target[key$1]==null)&&(target[key$1]=source$2[key$1])}else defaults(target,source$2,override)}function isArrayLike(data){return!data||typeof data==`string`?!1:typeof data.length==`number`}function each(arr,cb,context$1){if(arr&&cb)if(arr.forEach&&arr.forEach===nativeForEach)arr.forEach(cb,context$1);else if(arr.length===+arr.length)for(var i$1=0,len$1=arr.length;i$1<len$1;i$1++)cb.call(context$1,arr[i$1],i$1,arr);else for(var key$1 in arr)arr.hasOwnProperty(key$1)&&cb.call(context$1,arr[key$1],key$1,arr)}function map(arr,cb,context$1){if(!arr)return[];if(!cb)return slice(arr);if(arr.map&&arr.map===nativeMap)return arr.map(cb,context$1);for(var result=[],i$1=0,len$1=arr.length;i$1<len$1;i$1++)result.push(cb.call(context$1,arr[i$1],i$1,arr));return result}function reduce(arr,cb,memo,context$1){if(arr&&cb){for(var i$1=0,len$1=arr.length;i$1<len$1;i$1++)memo=cb.call(context$1,memo,arr[i$1],i$1,arr);return memo}}function filter(arr,cb,context$1){if(!arr)return[];if(!cb)return slice(arr);if(arr.filter&&arr.filter===nativeFilter)return arr.filter(cb,context$1);for(var result=[],i$1=0,len$1=arr.length;i$1<len$1;i$1++)cb.call(context$1,arr[i$1],i$1,arr)&&result.push(arr[i$1]);return result}function find(arr,cb,context$1){if(arr&&cb){for(var i$1=0,len$1=arr.length;i$1<len$1;i$1++)if(cb.call(context$1,arr[i$1],i$1,arr))return arr[i$1]}}function keys(obj){if(!obj)return[];if(Object.keys)return Object.keys(obj);var keyList=[];for(var key$1 in obj)obj.hasOwnProperty(key$1)&&keyList.push(key$1);return keyList}function bindPolyfill(func,context$1){var args=[...arguments].slice(2);return function(){return func.apply(context$1,args.concat(nativeSlice.call(arguments)))}}var bind=protoFunction&&isFunction(protoFunction.bind)?protoFunction.call.bind(protoFunction.bind):bindPolyfill;function curry(func){var args=[...arguments].slice(1);return function(){return func.apply(this,args.concat(nativeSlice.call(arguments)))}}function isArray(value){return Array.isArray?Array.isArray(value):objToString.call(value)===`[object Array]`}function isFunction(value){return typeof value==`function`}function isString(value){return typeof value==`string`}function isStringSafe(value){return objToString.call(value)===`[object String]`}function isNumber(value){return typeof value==`number`}function isObject(value){var type=typeof value;return type===`function`||!!value&&type===`object`}function isBuiltInObject(value){return!!BUILTIN_OBJECT[objToString.call(value)]}function isTypedArray(value){return!!TYPED_ARRAY[objToString.call(value)]}function isDom(value){return typeof value==`object`&&typeof value.nodeType==`number`&&typeof value.ownerDocument==`object`}function isGradientObject(value){return value.colorStops!=null}function isImagePatternObject(value){return value.image!=null}function eqNaN(value){return value!==value}function retrieve(){for(var args=[...arguments],i$1=0,len$1=args.length;i$1<len$1;i$1++)if(args[i$1]!=null)return args[i$1]}function retrieve2(value0,value1){return value0??value1}function retrieve3(value0,value1,value2){return value0??value1??value2}function slice(arr){var args=[...arguments].slice(1);return nativeSlice.apply(arr,args)}function normalizeCssArray$1(val){if(typeof val==`number`)return[val,val,val,val];var len$1=val.length;return len$1===2?[val[0],val[1],val[0],val[1]]:len$1===3?[val[0],val[1],val[2],val[1]]:val}function assert(condition,message){if(!condition)throw Error(message)}function trim(str){return str==null?null:typeof str.trim==`function`?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,``)}var primitiveKey=`__ec_primitive__`;function setAsPrimitive(obj){obj[primitiveKey]=!0}function isPrimitive(obj){return obj[primitiveKey]}var MapPolyfill=function(){function MapPolyfill$1(){this.data={}}return MapPolyfill$1.prototype.delete=function(key$1){var existed=this.has(key$1);return existed&&delete this.data[key$1],existed},MapPolyfill$1.prototype.has=function(key$1){return this.data.hasOwnProperty(key$1)},MapPolyfill$1.prototype.get=function(key$1){return this.data[key$1]},MapPolyfill$1.prototype.set=function(key$1,value){return this.data[key$1]=value,this},MapPolyfill$1.prototype.keys=function(){return keys(this.data)},MapPolyfill$1.prototype.forEach=function(callback){var data=this.data;for(var key$1 in data)data.hasOwnProperty(key$1)&&callback(data[key$1],key$1)},MapPolyfill$1}(),isNativeMapSupported=typeof Map==`function`;function maybeNativeMap(){return isNativeMapSupported?new Map:new MapPolyfill}var HashMap=function(){function HashMap$1(obj){var isArr=isArray(obj);this.data=maybeNativeMap();var thisMap=this;obj instanceof HashMap$1?obj.each(visit):obj&&each(obj,visit);function visit(value,key$1){isArr?thisMap.set(value,key$1):thisMap.set(key$1,value)}}return HashMap$1.prototype.hasKey=function(key$1){return this.data.has(key$1)},HashMap$1.prototype.get=function(key$1){return this.data.get(key$1)},HashMap$1.prototype.set=function(key$1,value){return this.data.set(key$1,value),value},HashMap$1.prototype.each=function(cb,context$1){this.data.forEach(function(value,key$1){cb.call(context$1,value,key$1)})},HashMap$1.prototype.keys=function(){var keys$1=this.data.keys();return isNativeMapSupported?Array.from(keys$1):keys$1},HashMap$1.prototype.removeKey=function(key$1){this.data.delete(key$1)},HashMap$1}();function createHashMap(obj){return new HashMap(obj)}function concatArray(a$1,b$1){for(var newArray=new a$1.constructor(a$1.length+b$1.length),i$1=0;i$1<a$1.length;i$1++)newArray[i$1]=a$1[i$1];for(var offset=a$1.length,i$1=0;i$1<b$1.length;i$1++)newArray[i$1+offset]=b$1[i$1];return newArray}function createObject(proto,properties){var obj;if(Object.create)obj=Object.create(proto);else{var StyleCtor=function(){};StyleCtor.prototype=proto,obj=new StyleCtor}return properties&&extend(obj,properties),obj}function disableUserSelect(dom){var domStyle=dom.style;domStyle.webkitUserSelect=`none`,domStyle.userSelect=`none`,domStyle.webkitTapHighlightColor=`rgba(0,0,0,0)`,domStyle[`-webkit-touch-callout`]=`none`}function hasOwn(own,prop){return own.hasOwnProperty(prop)}function noop(){}var RADIAN_TO_DEGREE=180/Math.PI,EPSILON$3=2**-52||2**-52;function create(x$1,y$1){return x$1??=0,y$1??=0,[x$1,y$1]}function clone$2(v$1){return[v$1[0],v$1[1]]}function add(out$2,v1,v2){return out$2[0]=v1[0]+v2[0],out$2[1]=v1[1]+v2[1],out$2}function sub(out$2,v1,v2){return out$2[0]=v1[0]-v2[0],out$2[1]=v1[1]-v2[1],out$2}function len(v$1){return Math.sqrt(lenSquare(v$1))}function lenSquare(v$1){return v$1[0]*v$1[0]+v$1[1]*v$1[1]}function scale$1(out$2,v$1,s$1){return out$2[0]=v$1[0]*s$1,out$2[1]=v$1[1]*s$1,out$2}function normalize$1(out$2,v$1){var d$1=len(v$1);return d$1===0?(out$2[0]=0,out$2[1]=0):(out$2[0]=v$1[0]/d$1,out$2[1]=v$1[1]/d$1),out$2}function distance(v1,v2){return Math.sqrt((v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1]))}var dist$1=distance;function distanceSquare(v1,v2){return(v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1])}var distSquare=distanceSquare;function applyTransform(out$2,v$1,m$2){var x$1=v$1[0],y$1=v$1[1];return out$2[0]=m$2[0]*x$1+m$2[2]*y$1+m$2[4],out$2[1]=m$2[1]*x$1+m$2[3]*y$1+m$2[5],out$2}function min(out$2,v1,v2){return out$2[0]=Math.min(v1[0],v2[0]),out$2[1]=Math.min(v1[1],v2[1]),out$2}function max(out$2,v1,v2){return out$2[0]=Math.max(v1[0],v2[0]),out$2[1]=Math.max(v1[1],v2[1]),out$2}var Param=function(){function Param$1(target,e$2){this.target=target,this.topTarget=e$2&&e$2.topTarget}return Param$1}(),Draggable_default=function(){function Draggable$1(handler){this.handler=handler,handler.on(`mousedown`,this._dragStart,this),handler.on(`mousemove`,this._drag,this),handler.on(`mouseup`,this._dragEnd,this)}return Draggable$1.prototype._dragStart=function(e$2){for(var draggingTarget=e$2.target;draggingTarget&&!draggingTarget.draggable;)draggingTarget=draggingTarget.parent||draggingTarget.__hostTarget;draggingTarget&&(this._draggingTarget=draggingTarget,draggingTarget.dragging=!0,this._x=e$2.offsetX,this._y=e$2.offsetY,this.handler.dispatchToElement(new Param(draggingTarget,e$2),`dragstart`,e$2.event))},Draggable$1.prototype._drag=function(e$2){var draggingTarget=this._draggingTarget;if(draggingTarget){var x$1=e$2.offsetX,y$1=e$2.offsetY,dx=x$1-this._x,dy=y$1-this._y;this._x=x$1,this._y=y$1,draggingTarget.drift(dx,dy,e$2),this.handler.dispatchToElement(new Param(draggingTarget,e$2),`drag`,e$2.event);var dropTarget=this.handler.findHover(x$1,y$1,draggingTarget).target,lastDropTarget=this._dropTarget;this._dropTarget=dropTarget,draggingTarget!==dropTarget&&(lastDropTarget&&dropTarget!==lastDropTarget&&this.handler.dispatchToElement(new Param(lastDropTarget,e$2),`dragleave`,e$2.event),dropTarget&&dropTarget!==lastDropTarget&&this.handler.dispatchToElement(new Param(dropTarget,e$2),`dragenter`,e$2.event))}},Draggable$1.prototype._dragEnd=function(e$2){var draggingTarget=this._draggingTarget;draggingTarget&&(draggingTarget.dragging=!1),this.handler.dispatchToElement(new Param(draggingTarget,e$2),`dragend`,e$2.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,e$2),`drop`,e$2.event),this._draggingTarget=null,this._dropTarget=null},Draggable$1}(),Eventful_default=function(){function Eventful$1(eventProcessors){eventProcessors&&(this._$eventProcessor=eventProcessors)}return Eventful$1.prototype.on=function(event,query,handler,context$1){this._$handlers||={};var _h=this._$handlers;if(typeof query==`function`&&(context$1=handler,handler=query,query=null),!handler||!event)return this;var eventProcessor=this._$eventProcessor;query!=null&&eventProcessor&&eventProcessor.normalizeQuery&&(query=eventProcessor.normalizeQuery(query)),_h[event]||(_h[event]=[]);for(var i$1=0;i$1<_h[event].length;i$1++)if(_h[event][i$1].h===handler)return this;var wrap={h:handler,query,ctx:context$1||this,callAtLast:handler.zrEventfulCallAtLast},lastIndex=_h[event].length-1,lastWrap=_h[event][lastIndex];return lastWrap&&lastWrap.callAtLast?_h[event].splice(lastIndex,0,wrap):_h[event].push(wrap),this},Eventful$1.prototype.isSilent=function(eventName){var _h=this._$handlers;return!_h||!_h[eventName]||!_h[eventName].length},Eventful$1.prototype.off=function(eventType,handler){var _h=this._$handlers;if(!_h)return this;if(!eventType)return this._$handlers={},this;if(handler){if(_h[eventType]){for(var newList=[],i$1=0,l$1=_h[eventType].length;i$1<l$1;i$1++)_h[eventType][i$1].h!==handler&&newList.push(_h[eventType][i$1]);_h[eventType]=newList}_h[eventType]&&_h[eventType].length===0&&delete _h[eventType]}else delete _h[eventType];return this},Eventful$1.prototype.trigger=function(eventType){var args=[...arguments].slice(1);if(!this._$handlers)return this;var _h=this._$handlers[eventType],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,len$1=_h.length,i$1=0;i$1<len$1;i$1++){var hItem=_h[i$1];if(!(eventProcessor&&eventProcessor.filter&&hItem.query!=null&&!eventProcessor.filter(eventType,hItem.query)))switch(argLen){case 0:hItem.h.call(hItem.ctx);break;case 1:hItem.h.call(hItem.ctx,args[0]);break;case 2:hItem.h.call(hItem.ctx,args[0],args[1]);break;default:hItem.h.apply(hItem.ctx,args);break}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(eventType),this},Eventful$1.prototype.triggerWithContext=function(type){var args=[...arguments].slice(1);if(!this._$handlers)return this;var _h=this._$handlers[type],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,ctx=args[argLen-1],len$1=_h.length,i$1=0;i$1<len$1;i$1++){var hItem=_h[i$1];if(!(eventProcessor&&eventProcessor.filter&&hItem.query!=null&&!eventProcessor.filter(type,hItem.query)))switch(argLen){case 0:hItem.h.call(ctx);break;case 1:hItem.h.call(ctx,args[0]);break;case 2:hItem.h.call(ctx,args[0],args[1]);break;default:hItem.h.apply(ctx,args.slice(1,argLen-1));break}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(type),this},Eventful$1}(),LN2=Math.log(2);function determinant(rows,rank$1,rowStart,rowMask,colMask,detCache){var cacheKey=rowMask+`-`+colMask,fullRank=rows.length;if(detCache.hasOwnProperty(cacheKey))return detCache[cacheKey];if(rank$1===1){var colStart=Math.round(Math.log((1<<fullRank)-1&~colMask)/LN2);return rows[rowStart][colStart]}for(var subRowMask=rowMask|1<<rowStart,subRowStart=rowStart+1;rowMask&1<<subRowStart;)subRowStart++;for(var sum=0,j$1=0,colLocalIdx=0;j$1<fullRank;j$1++){var colTag=1<<j$1;colTag&colMask||(sum+=(colLocalIdx%2?-1:1)*rows[rowStart][j$1]*determinant(rows,rank$1-1,subRowStart,subRowMask,colMask|colTag,detCache),colLocalIdx++)}return detCache[cacheKey]=sum,sum}function buildTransformer(src,dest){var mA=[[src[0],src[1],1,0,0,0,-dest[0]*src[0],-dest[0]*src[1]],[0,0,0,src[0],src[1],1,-dest[1]*src[0],-dest[1]*src[1]],[src[2],src[3],1,0,0,0,-dest[2]*src[2],-dest[2]*src[3]],[0,0,0,src[2],src[3],1,-dest[3]*src[2],-dest[3]*src[3]],[src[4],src[5],1,0,0,0,-dest[4]*src[4],-dest[4]*src[5]],[0,0,0,src[4],src[5],1,-dest[5]*src[4],-dest[5]*src[5]],[src[6],src[7],1,0,0,0,-dest[6]*src[6],-dest[6]*src[7]],[0,0,0,src[6],src[7],1,-dest[7]*src[6],-dest[7]*src[7]]],detCache={},det=determinant(mA,8,0,0,0,detCache);if(det!==0){for(var vh=[],i$1=0;i$1<8;i$1++)for(var j$1=0;j$1<8;j$1++)vh[j$1]??(vh[j$1]=0),vh[j$1]+=((i$1+j$1)%2?-1:1)*determinant(mA,7,i$1===0?1:0,1<<i$1,1<<j$1,detCache)/det*dest[i$1];return function(out$2,srcPointX,srcPointY){var pk=srcPointX*vh[6]+srcPointY*vh[7]+1;out$2[0]=(srcPointX*vh[0]+srcPointY*vh[1]+vh[2])/pk,out$2[1]=(srcPointX*vh[3]+srcPointY*vh[4]+vh[5])/pk}}}var EVENT_SAVED_PROP=`___zrEVENTSAVED`,_calcOut$1=[];function transformLocalCoord(out$2,elFrom,elTarget,inX,inY){return transformCoordWithViewport(_calcOut$1,elFrom,inX,inY,!0)&&transformCoordWithViewport(out$2,elTarget,_calcOut$1[0],_calcOut$1[1])}function transformLocalCoordClear(elFrom,elTarget){elFrom&&dealClear(elFrom),elTarget&&dealClear(elTarget);function dealClear(el){var saved=el[EVENT_SAVED_PROP];saved&&(saved.clearMarkers&&saved.clearMarkers(),delete el[EVENT_SAVED_PROP])}}function transformCoordWithViewport(out$2,el,inX,inY,inverse){if(el.getBoundingClientRect&&env_default.domSupported&&!isCanvasEl(el)){var saved=el[EVENT_SAVED_PROP]||(el[EVENT_SAVED_PROP]={}),markers=prepareCoordMarkers(el,saved),transformer=preparePointerTransformer(markers,saved,inverse);if(transformer)return transformer(out$2,inX,inY),!0}return!1}function prepareCoordMarkers(el,saved){var markers=saved.markers;if(markers)return markers;markers=saved.markers=[];for(var propLR=[`left`,`right`],propTB=[`top`,`bottom`],i$1=0;i$1<4;i$1++){var marker=document.createElement(`div`),stl=marker.style,idxLR=i$1%2,idxTB=(i$1>>1)%2;stl.cssText=[`position: absolute`,`visibility: hidden`,`padding: 0`,`margin: 0`,`border-width: 0`,`user-select: none`,`width:0`,`height:0`,propLR[idxLR]+`:0`,propTB[idxTB]+`:0`,propLR[1-idxLR]+`:auto`,propTB[1-idxTB]+`:auto`,``].join(`!important;`),el.appendChild(marker),markers.push(marker)}return saved.clearMarkers=function(){each(markers,function(marker$1){marker$1.parentNode&&marker$1.parentNode.removeChild(marker$1)})},markers}function preparePointerTransformer(markers,saved,inverse){for(var transformerName=inverse?`invTrans`:`trans`,transformer=saved[transformerName],oldSrcCoords=saved.srcCoords,srcCoords=[],destCoords=[],oldCoordTheSame=!0,i$1=0;i$1<4;i$1++){var rect=markers[i$1].getBoundingClientRect(),ii=2*i$1,x$1=rect.left,y$1=rect.top;srcCoords.push(x$1,y$1),oldCoordTheSame=oldCoordTheSame&&oldSrcCoords&&x$1===oldSrcCoords[ii]&&y$1===oldSrcCoords[ii+1],destCoords.push(markers[i$1].offsetLeft,markers[i$1].offsetTop)}return oldCoordTheSame&&transformer?transformer:(saved.srcCoords=srcCoords,saved[transformerName]=inverse?buildTransformer(destCoords,srcCoords):buildTransformer(srcCoords,destCoords))}function isCanvasEl(el){return el.nodeName.toUpperCase()===`CANVAS`}var replaceReg=/([&<>"'])/g,replaceMap={"&":`&amp;`,"<":`&lt;`,">":`&gt;`,'"':`&quot;`,"'":`&#39;`};function encodeHTML(source$2){return source$2==null?``:(source$2+``).replace(replaceReg,function(str,c$2){return replaceMap[c$2]})}var MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env_default.browser.firefox&&+env_default.browser.version.split(`.`)[0]<39;function clientToLocal(el,e$2,out$2,calculate){return out$2||={},calculate?calculateZrXY(el,e$2,out$2):firefoxNotSupportOffsetXY&&e$2.layerX!=null&&e$2.layerX!==e$2.offsetX?(out$2.zrX=e$2.layerX,out$2.zrY=e$2.layerY):e$2.offsetX==null?calculateZrXY(el,e$2,out$2):(out$2.zrX=e$2.offsetX,out$2.zrY=e$2.offsetY),out$2}function calculateZrXY(el,e$2,out$2){if(env_default.domSupported&&el.getBoundingClientRect){var ex=e$2.clientX,ey=e$2.clientY;if(isCanvasEl(el)){var box=el.getBoundingClientRect();out$2.zrX=ex-box.left,out$2.zrY=ey-box.top;return}else if(transformCoordWithViewport(_calcOut,el,ex,ey)){out$2.zrX=_calcOut[0],out$2.zrY=_calcOut[1];return}}out$2.zrX=out$2.zrY=0}function getNativeEvent(e$2){return e$2||window.event}function normalizeEvent(el,e$2,calculate){if(e$2=getNativeEvent(e$2),e$2.zrX!=null)return e$2;var eventType=e$2.type;if(eventType&&eventType.indexOf(`touch`)>=0){var touch=eventType===`touchend`?e$2.changedTouches[0]:e$2.targetTouches[0];touch&&clientToLocal(el,touch,e$2,calculate)}else{clientToLocal(el,e$2,e$2,calculate);var wheelDelta=getWheelDeltaMayPolyfill(e$2);e$2.zrDelta=wheelDelta?wheelDelta/120:-(e$2.detail||0)/3}var button=e$2.button;return e$2.which==null&&button!==void 0&&MOUSE_EVENT_REG.test(e$2.type)&&(e$2.which=button&1?1:button&2?3:button&4?2:0),e$2}function getWheelDeltaMayPolyfill(e$2){var rawWheelDelta=e$2.wheelDelta;if(rawWheelDelta)return rawWheelDelta;var deltaX=e$2.deltaX,deltaY=e$2.deltaY;if(deltaX==null||deltaY==null)return rawWheelDelta;var delta=deltaY===0?Math.abs(deltaX):Math.abs(deltaY),sign$1=deltaY>0?-1:deltaY<0?1:deltaX>0?-1:1;return 3*delta*sign$1}function addEventListener(el,name,handler,opt){el.addEventListener(name,handler,opt)}function removeEventListener(el,name,handler,opt){el.removeEventListener(name,handler,opt)}var stop=function(e$2){e$2.preventDefault(),e$2.stopPropagation(),e$2.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(e$2){return e$2.which===2||e$2.which===3}var GestureMgr=function(){function GestureMgr$1(){this._track=[]}return GestureMgr$1.prototype.recognize=function(event,target,root){return this._doTrack(event,target,root),this._recognize(event)},GestureMgr$1.prototype.clear=function(){return this._track.length=0,this},GestureMgr$1.prototype._doTrack=function(event,target,root){var touches=event.touches;if(touches){for(var trackItem={points:[],touches:[],target,event},i$1=0,len$1=touches.length;i$1<len$1;i$1++){var touch=touches[i$1],pos=clientToLocal(root,touch,{});trackItem.points.push([pos.zrX,pos.zrY]),trackItem.touches.push(touch)}this._track.push(trackItem)}},GestureMgr$1.prototype._recognize=function(event){for(var eventName in recognizers)if(recognizers.hasOwnProperty(eventName)){var gestureInfo=recognizers[eventName](this._track,event);if(gestureInfo)return gestureInfo}},GestureMgr$1}();function dist(pointPair){var dx=pointPair[1][0]-pointPair[0][0],dy=pointPair[1][1]-pointPair[0][1];return Math.sqrt(dx*dx+dy*dy)}function center(pointPair){return[(pointPair[0][0]+pointPair[1][0])/2,(pointPair[0][1]+pointPair[1][1])/2]}var recognizers={pinch:function(tracks,event){var trackLen=tracks.length;if(trackLen){var pinchEnd=(tracks[trackLen-1]||{}).points,pinchPre=(tracks[trackLen-2]||{}).points||pinchEnd;if(pinchPre&&pinchPre.length>1&&pinchEnd&&pinchEnd.length>1){var pinchScale=dist(pinchEnd)/dist(pinchPre);!isFinite(pinchScale)&&(pinchScale=1),event.pinchScale=pinchScale;var pinchCenter=center(pinchEnd);return event.pinchX=pinchCenter[0],event.pinchY=pinchCenter[1],{type:`pinch`,target:tracks[0].target,event}}}}};function create$1(){return[1,0,0,1,0,0]}function identity(out$2){return out$2[0]=1,out$2[1]=0,out$2[2]=0,out$2[3]=1,out$2[4]=0,out$2[5]=0,out$2}function copy(out$2,m$2){return out$2[0]=m$2[0],out$2[1]=m$2[1],out$2[2]=m$2[2],out$2[3]=m$2[3],out$2[4]=m$2[4],out$2[5]=m$2[5],out$2}function mul(out$2,m1,m2){var out0=m1[0]*m2[0]+m1[2]*m2[1],out1=m1[1]*m2[0]+m1[3]*m2[1],out2=m1[0]*m2[2]+m1[2]*m2[3],out3=m1[1]*m2[2]+m1[3]*m2[3],out4=m1[0]*m2[4]+m1[2]*m2[5]+m1[4],out5=m1[1]*m2[4]+m1[3]*m2[5]+m1[5];return out$2[0]=out0,out$2[1]=out1,out$2[2]=out2,out$2[3]=out3,out$2[4]=out4,out$2[5]=out5,out$2}function translate(out$2,a$1,v$1){return out$2[0]=a$1[0],out$2[1]=a$1[1],out$2[2]=a$1[2],out$2[3]=a$1[3],out$2[4]=a$1[4]+v$1[0],out$2[5]=a$1[5]+v$1[1],out$2}function rotate(out$2,a$1,rad,pivot){pivot===void 0&&(pivot=[0,0]);var aa=a$1[0],ac=a$1[2],atx=a$1[4],ab=a$1[1],ad=a$1[3],aty=a$1[5],st=Math.sin(rad),ct=Math.cos(rad);return out$2[0]=aa*ct+ab*st,out$2[1]=-aa*st+ab*ct,out$2[2]=ac*ct+ad*st,out$2[3]=-ac*st+ct*ad,out$2[4]=ct*(atx-pivot[0])+st*(aty-pivot[1])+pivot[0],out$2[5]=ct*(aty-pivot[1])-st*(atx-pivot[0])+pivot[1],out$2}function scale$2(out$2,a$1,v$1){var vx$1=v$1[0],vy$1=v$1[1];return out$2[0]=a$1[0]*vx$1,out$2[1]=a$1[1]*vy$1,out$2[2]=a$1[2]*vx$1,out$2[3]=a$1[3]*vy$1,out$2[4]=a$1[4]*vx$1,out$2[5]=a$1[5]*vy$1,out$2}function invert(out$2,a$1){var aa=a$1[0],ac=a$1[2],atx=a$1[4],ab=a$1[1],ad=a$1[3],aty=a$1[5],det=aa*ad-ab*ac;return det?(det=1/det,out$2[0]=ad*det,out$2[1]=-ab*det,out$2[2]=-ac*det,out$2[3]=aa*det,out$2[4]=(ac*aty-ad*atx)*det,out$2[5]=(ab*atx-aa*aty)*det,out$2):null}var Point_default=function(){function Point$2(x$1,y$1){this.x=x$1||0,this.y=y$1||0}return Point$2.prototype.copy=function(other){return this.x=other.x,this.y=other.y,this},Point$2.prototype.clone=function(){return new Point$2(this.x,this.y)},Point$2.prototype.set=function(x$1,y$1){return this.x=x$1,this.y=y$1,this},Point$2.prototype.equal=function(other){return other.x===this.x&&other.y===this.y},Point$2.prototype.add=function(other){return this.x+=other.x,this.y+=other.y,this},Point$2.prototype.scale=function(scalar){this.x*=scalar,this.y*=scalar},Point$2.prototype.scaleAndAdd=function(other,scalar){this.x+=other.x*scalar,this.y+=other.y*scalar},Point$2.prototype.sub=function(other){return this.x-=other.x,this.y-=other.y,this},Point$2.prototype.dot=function(other){return this.x*other.x+this.y*other.y},Point$2.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Point$2.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},Point$2.prototype.normalize=function(){var len$1=this.len();return this.x/=len$1,this.y/=len$1,this},Point$2.prototype.distance=function(other){var dx=this.x-other.x,dy=this.y-other.y;return Math.sqrt(dx*dx+dy*dy)},Point$2.prototype.distanceSquare=function(other){var dx=this.x-other.x,dy=this.y-other.y;return dx*dx+dy*dy},Point$2.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Point$2.prototype.transform=function(m$2){if(m$2){var x$1=this.x,y$1=this.y;return this.x=m$2[0]*x$1+m$2[2]*y$1+m$2[4],this.y=m$2[1]*x$1+m$2[3]*y$1+m$2[5],this}},Point$2.prototype.toArray=function(out$2){return out$2[0]=this.x,out$2[1]=this.y,out$2},Point$2.prototype.fromArray=function(input){this.x=input[0],this.y=input[1]},Point$2.set=function(p$2,x$1,y$1){p$2.x=x$1,p$2.y=y$1},Point$2.copy=function(p$2,p2){p$2.x=p2.x,p$2.y=p2.y},Point$2.len=function(p$2){return Math.sqrt(p$2.x*p$2.x+p$2.y*p$2.y)},Point$2.lenSquare=function(p$2){return p$2.x*p$2.x+p$2.y*p$2.y},Point$2.dot=function(p0,p1){return p0.x*p1.x+p0.y*p1.y},Point$2.add=function(out$2,p0,p1){out$2.x=p0.x+p1.x,out$2.y=p0.y+p1.y},Point$2.sub=function(out$2,p0,p1){out$2.x=p0.x-p1.x,out$2.y=p0.y-p1.y},Point$2.scale=function(out$2,p0,scalar){out$2.x=p0.x*scalar,out$2.y=p0.y*scalar},Point$2.scaleAndAdd=function(out$2,p0,p1,scalar){out$2.x=p0.x+p1.x*scalar,out$2.y=p0.y+p1.y*scalar},Point$2.lerp=function(out$2,p0,p1,t$1){var onet=1-t$1;out$2.x=onet*p0.x+t$1*p1.x,out$2.y=onet*p0.y+t$1*p1.y},Point$2}(),mathMin$7=Math.min,mathMax$7=Math.max,mathAbs$4=Math.abs,XY$1=[`x`,`y`],WH$1=[`width`,`height`],lt=new Point_default,rb=new Point_default,lb=new Point_default,rt=new Point_default,_intersectCtx$1=createIntersectContext(),_minTv$1=_intersectCtx$1.minTv,_maxTv$1=_intersectCtx$1.maxTv,_lenMinMax=[0,0],BoundingRect=function(){function BoundingRect$1(x$1,y$1,width,height){BoundingRect$1.set(this,x$1,y$1,width,height)}return BoundingRect$1.set=function(target,x$1,y$1,width,height){return width<0&&(x$1+=width,width=-width),height<0&&(y$1+=height,height=-height),target.x=x$1,target.y=y$1,target.width=width,target.height=height,target},BoundingRect$1.prototype.union=function(other){var x$1=mathMin$7(other.x,this.x),y$1=mathMin$7(other.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax$7(other.x+other.width,this.x+this.width)-x$1:this.width=other.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax$7(other.y+other.height,this.y+this.height)-y$1:this.height=other.height,this.x=x$1,this.y=y$1},BoundingRect$1.prototype.applyTransform=function(m$2){BoundingRect$1.applyTransform(this,this,m$2)},BoundingRect$1.prototype.calculateTransform=function(b$1){var a$1=this,sx=b$1.width/a$1.width,sy=b$1.height/a$1.height,m$2=create$1();return translate(m$2,m$2,[-a$1.x,-a$1.y]),scale$2(m$2,m$2,[sx,sy]),translate(m$2,m$2,[b$1.x,b$1.y]),m$2},BoundingRect$1.prototype.intersect=function(b$1,mtv,opt){return BoundingRect$1.intersect(this,b$1,mtv,opt)},BoundingRect$1.intersect=function(a$1,b$1,mtv,opt){mtv&&Point_default.set(mtv,0,0);var outIntersectRect=opt&&opt.outIntersectRect||null,clamp$1=opt&&opt.clamp;if(outIntersectRect&&(outIntersectRect.x=outIntersectRect.y=outIntersectRect.width=outIntersectRect.height=NaN),!a$1||!b$1)return!1;a$1 instanceof BoundingRect$1||(a$1=BoundingRect$1.set(_tmpIntersectA,a$1.x,a$1.y,a$1.width,a$1.height)),b$1 instanceof BoundingRect$1||(b$1=BoundingRect$1.set(_tmpIntersectB,b$1.x,b$1.y,b$1.width,b$1.height));var useMTV=!!mtv;_intersectCtx$1.reset(opt,useMTV);var touchThreshold=_intersectCtx$1.touchThreshold,ax0=a$1.x+touchThreshold,ax1=a$1.x+a$1.width-touchThreshold,ay0=a$1.y+touchThreshold,ay1=a$1.y+a$1.height-touchThreshold,bx0=b$1.x+touchThreshold,bx1=b$1.x+b$1.width-touchThreshold,by0=b$1.y+touchThreshold,by1=b$1.y+b$1.height-touchThreshold;if(ax0>ax1||ay0>ay1||bx0>bx1||by0>by1)return!1;var overlap=!(ax1<bx0||bx1<ax0||ay1<by0||by1<ay0);return(useMTV||outIntersectRect)&&(_lenMinMax[0]=1/0,_lenMinMax[1]=0,intersectOneDim(ax0,ax1,bx0,bx1,0,useMTV,outIntersectRect,clamp$1),intersectOneDim(ay0,ay1,by0,by1,1,useMTV,outIntersectRect,clamp$1),useMTV&&Point_default.copy(mtv,overlap?_intersectCtx$1.useDir?_intersectCtx$1.dirMinTv:_minTv$1:_maxTv$1)),overlap},BoundingRect$1.contain=function(rect,x$1,y$1){return x$1>=rect.x&&x$1<=rect.x+rect.width&&y$1>=rect.y&&y$1<=rect.y+rect.height},BoundingRect$1.prototype.contain=function(x$1,y$1){return BoundingRect$1.contain(this,x$1,y$1)},BoundingRect$1.prototype.clone=function(){return new BoundingRect$1(this.x,this.y,this.width,this.height)},BoundingRect$1.prototype.copy=function(other){BoundingRect$1.copy(this,other)},BoundingRect$1.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},BoundingRect$1.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},BoundingRect$1.prototype.isZero=function(){return this.width===0||this.height===0},BoundingRect$1.create=function(rect){return new BoundingRect$1(rect.x,rect.y,rect.width,rect.height)},BoundingRect$1.copy=function(target,source$2){return target.x=source$2.x,target.y=source$2.y,target.width=source$2.width,target.height=source$2.height,target},BoundingRect$1.applyTransform=function(target,source$2,m$2){if(!m$2){target!==source$2&&BoundingRect$1.copy(target,source$2);return}if(m$2[1]<1e-5&&m$2[1]>-1e-5&&m$2[2]<1e-5&&m$2[2]>-1e-5){var sx=m$2[0],sy=m$2[3],tx=m$2[4],ty=m$2[5];target.x=source$2.x*sx+tx,target.y=source$2.y*sy+ty,target.width=source$2.width*sx,target.height=source$2.height*sy,target.width<0&&(target.x+=target.width,target.width=-target.width),target.height<0&&(target.y+=target.height,target.height=-target.height);return}lt.x=lb.x=source$2.x,lt.y=rt.y=source$2.y,rb.x=rt.x=source$2.x+source$2.width,rb.y=lb.y=source$2.y+source$2.height,lt.transform(m$2),rt.transform(m$2),rb.transform(m$2),lb.transform(m$2),target.x=mathMin$7(lt.x,rb.x,lb.x,rt.x),target.y=mathMin$7(lt.y,rb.y,lb.y,rt.y);var maxX=mathMax$7(lt.x,rb.x,lb.x,rt.x),maxY=mathMax$7(lt.y,rb.y,lb.y,rt.y);target.width=maxX-target.x,target.height=maxY-target.y},BoundingRect$1}(),_tmpIntersectA=new BoundingRect(0,0,0,0),_tmpIntersectB=new BoundingRect(0,0,0,0);function intersectOneDim(a0,a1,b0,b1,updateDimIdx,useMTV,outIntersectRect,clamp$1){var d0=mathAbs$4(a1-b0),d1=mathAbs$4(b1-a0),d01min=mathMin$7(d0,d1),updateDim=XY$1[updateDimIdx],zeroDim=XY$1[1-updateDimIdx],wh=WH$1[updateDimIdx];a1<b0||b1<a0?d0<d1?(useMTV&&(_maxTv$1[updateDim]=-d0),clamp$1&&(outIntersectRect[updateDim]=a1,outIntersectRect[wh]=0)):(useMTV&&(_maxTv$1[updateDim]=d1),clamp$1&&(outIntersectRect[updateDim]=a0,outIntersectRect[wh]=0)):(outIntersectRect&&(outIntersectRect[updateDim]=mathMax$7(a0,b0),outIntersectRect[wh]=mathMin$7(a1,b1)-outIntersectRect[updateDim]),useMTV&&(d01min<_lenMinMax[0]||_intersectCtx$1.useDir)&&(_lenMinMax[0]=mathMin$7(d01min,_lenMinMax[0]),(d0<d1||!_intersectCtx$1.bidirectional)&&(_minTv$1[updateDim]=d0,_minTv$1[zeroDim]=0,_intersectCtx$1.useDir&&_intersectCtx$1.calcDirMTV()),(d0>=d1||!_intersectCtx$1.bidirectional)&&(_minTv$1[updateDim]=-d1,_minTv$1[zeroDim]=0,_intersectCtx$1.useDir&&_intersectCtx$1.calcDirMTV())))}function createIntersectContext(){var _direction=0,_dirCheckVec=new Point_default,_dirTmp=new Point_default,_ctx={minTv:new Point_default,maxTv:new Point_default,useDir:!1,dirMinTv:new Point_default,touchThreshold:0,bidirectional:!0,negativeSize:!1,reset:function(opt,useMTV){_ctx.touchThreshold=0,opt&&opt.touchThreshold!=null&&(_ctx.touchThreshold=mathMax$7(0,opt.touchThreshold)),_ctx.negativeSize=!1,useMTV&&(_ctx.minTv.set(1/0,1/0),_ctx.maxTv.set(0,0),_ctx.useDir=!1,opt&&opt.direction!=null&&(_ctx.useDir=!0,_ctx.dirMinTv.copy(_ctx.minTv),_dirTmp.copy(_ctx.minTv),_direction=opt.direction,_ctx.bidirectional=opt.bidirectional==null||!!opt.bidirectional,_ctx.bidirectional||_dirCheckVec.set(Math.cos(_direction),Math.sin(_direction))))},calcDirMTV:function(){var minTv=_ctx.minTv,dirMinTv=_ctx.dirMinTv,squareMag=minTv.y*minTv.y+minTv.x*minTv.x,dirSin=Math.sin(_direction),dirCos=Math.cos(_direction),dotProd=dirSin*minTv.y+dirCos*minTv.x;if(nearZero$1(dotProd)){nearZero$1(minTv.x)&&nearZero$1(minTv.y)&&dirMinTv.set(0,0);return}if(_dirTmp.x=squareMag*dirCos/dotProd,_dirTmp.y=squareMag*dirSin/dotProd,nearZero$1(_dirTmp.x)&&nearZero$1(_dirTmp.y)){dirMinTv.set(0,0);return}(_ctx.bidirectional||_dirCheckVec.dot(_dirTmp)>0)&&_dirTmp.len()<dirMinTv.len()&&dirMinTv.copy(_dirTmp)}};function nearZero$1(val){return mathAbs$4(val)<1e-10}return _ctx}var BoundingRect_default=BoundingRect,SILENT=`silent`;function makeEventPacket(eveType,targetInfo,event){return{type:eveType,event,target:targetInfo.target,topTarget:targetInfo.topTarget,cancelBubble:!1,offsetX:event.zrX,offsetY:event.zrY,gestureEvent:event.gestureEvent,pinchX:event.pinchX,pinchY:event.pinchY,pinchScale:event.pinchScale,wheelDelta:event.zrDelta,zrByTouch:event.zrByTouch,which:event.which,stop:stopEvent}}function stopEvent(){stop(this.event)}var EmptyProxy=function(_super){__extends(EmptyProxy$1,_super);function EmptyProxy$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.handler=null,_this}return EmptyProxy$1.prototype.dispose=function(){},EmptyProxy$1.prototype.setCursor=function(){},EmptyProxy$1}(Eventful_default),HoveredResult=function(){function HoveredResult$1(x$1,y$1){this.x=x$1,this.y=y$1}return HoveredResult$1}(),handlerNames=[`click`,`dblclick`,`mousewheel`,`mouseout`,`mouseup`,`mousedown`,`mousemove`,`contextmenu`],tmpRect$1=new BoundingRect_default(0,0,0,0),Handler=function(_super){__extends(Handler$1,_super);function Handler$1(storage,painter,proxy,painterRoot,pointerSize){var _this=_super.call(this)||this;return _this._hovered=new HoveredResult(0,0),_this.storage=storage,_this.painter=painter,_this.painterRoot=painterRoot,_this._pointerSize=pointerSize,proxy||=new EmptyProxy,_this.proxy=null,_this.setHandlerProxy(proxy),_this._draggingMgr=new Draggable_default(_this),_this}return Handler$1.prototype.setHandlerProxy=function(proxy){this.proxy&&this.proxy.dispose(),proxy&&(each(handlerNames,function(name){proxy.on&&proxy.on(name,this[name],this)},this),proxy.handler=this),this.proxy=proxy},Handler$1.prototype.mousemove=function(event){var x$1=event.zrX,y$1=event.zrY,isOutside=isOutsideBoundary(this,x$1,y$1),lastHovered=this._hovered,lastHoveredTarget=lastHovered.target;lastHoveredTarget&&!lastHoveredTarget.__zr&&(lastHovered=this.findHover(lastHovered.x,lastHovered.y),lastHoveredTarget=lastHovered.target);var hovered=this._hovered=isOutside?new HoveredResult(x$1,y$1):this.findHover(x$1,y$1),hoveredTarget=hovered.target,proxy=this.proxy;proxy.setCursor&&proxy.setCursor(hoveredTarget?hoveredTarget.cursor:`default`),lastHoveredTarget&&hoveredTarget!==lastHoveredTarget&&this.dispatchToElement(lastHovered,`mouseout`,event),this.dispatchToElement(hovered,`mousemove`,event),hoveredTarget&&hoveredTarget!==lastHoveredTarget&&this.dispatchToElement(hovered,`mouseover`,event)},Handler$1.prototype.mouseout=function(event){var eventControl=event.zrEventControl;eventControl!==`only_globalout`&&this.dispatchToElement(this._hovered,`mouseout`,event),eventControl!==`no_globalout`&&this.trigger(`globalout`,{type:`globalout`,event})},Handler$1.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},Handler$1.prototype.dispatch=function(eventName,eventArgs){var handler=this[eventName];handler&&handler.call(this,eventArgs)},Handler$1.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},Handler$1.prototype.setCursorStyle=function(cursorStyle){var proxy=this.proxy;proxy.setCursor&&proxy.setCursor(cursorStyle)},Handler$1.prototype.dispatchToElement=function(targetInfo,eventName,event){targetInfo||={};var el=targetInfo.target;if(!(el&&el.silent)){for(var eventKey=`on`+eventName,eventPacket=makeEventPacket(eventName,targetInfo,event);el&&(el[eventKey]&&(eventPacket.cancelBubble=!!el[eventKey].call(el,eventPacket)),el.trigger(eventName,eventPacket),el=el.__hostTarget?el.__hostTarget:el.parent,!eventPacket.cancelBubble););eventPacket.cancelBubble||(this.trigger(eventName,eventPacket),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(layer){typeof layer[eventKey]==`function`&&layer[eventKey].call(layer,eventPacket),layer.trigger&&layer.trigger(eventName,eventPacket)}))}},Handler$1.prototype.findHover=function(x$1,y$1,exclude){var list=this.storage.getDisplayList(),out$2=new HoveredResult(x$1,y$1);if(setHoverTarget(list,out$2,x$1,y$1,exclude),this._pointerSize&&!out$2.target){for(var candidates=[],pointerSize=this._pointerSize,targetSizeHalf=pointerSize/2,pointerRect=new BoundingRect_default(x$1-targetSizeHalf,y$1-targetSizeHalf,pointerSize,pointerSize),i$1=list.length-1;i$1>=0;i$1--){var el=list[i$1];el!==exclude&&!el.ignore&&!el.ignoreCoarsePointer&&(!el.parent||!el.parent.ignoreCoarsePointer)&&(tmpRect$1.copy(el.getBoundingRect()),el.transform&&tmpRect$1.applyTransform(el.transform),tmpRect$1.intersect(pointerRect)&&candidates.push(el))}if(candidates.length)for(var rStep=4,thetaStep=Math.PI/12,PI2$6=Math.PI*2,r$1=0;r$1<targetSizeHalf;r$1+=rStep)for(var theta=0;theta<PI2$6;theta+=thetaStep){var x1=x$1+r$1*Math.cos(theta),y1=y$1+r$1*Math.sin(theta);if(setHoverTarget(candidates,out$2,x1,y1,exclude),out$2.target)return out$2}}return out$2},Handler$1.prototype.processGesture=function(event,stage){this._gestureMgr||=new GestureMgr;var gestureMgr=this._gestureMgr;stage===`start`&&gestureMgr.clear();var gestureInfo=gestureMgr.recognize(event,this.findHover(event.zrX,event.zrY,null).target,this.proxy.dom);if(stage===`end`&&gestureMgr.clear(),gestureInfo){var type=gestureInfo.type;event.gestureEvent=type;var res=new HoveredResult;res.target=gestureInfo.target,this.dispatchToElement(res,type,gestureInfo.event)}},Handler$1}(Eventful_default);each([`click`,`mousedown`,`mouseup`,`mousewheel`,`dblclick`,`contextmenu`],function(name){Handler.prototype[name]=function(event){var x$1=event.zrX,y$1=event.zrY,isOutside=isOutsideBoundary(this,x$1,y$1),hovered,hoveredTarget;if((name!==`mouseup`||!isOutside)&&(hovered=this.findHover(x$1,y$1),hoveredTarget=hovered.target),name===`mousedown`)this._downEl=hoveredTarget,this._downPoint=[event.zrX,event.zrY],this._upEl=hoveredTarget;else if(name===`mouseup`)this._upEl=hoveredTarget;else if(name===`click`){if(this._downEl!==this._upEl||!this._downPoint||dist$1(this._downPoint,[event.zrX,event.zrY])>4)return;this._downPoint=null}this.dispatchToElement(hovered,name,event)}});function isHover(displayable,x$1,y$1){if(displayable[displayable.rectHover?`rectContain`:`contain`](x$1,y$1)){for(var el=displayable,isSilent=void 0,ignoreClip=!1;el;){if(el.ignoreClip&&(ignoreClip=!0),!ignoreClip){var clipPath=el.getClipPath();if(clipPath&&!clipPath.contain(x$1,y$1))return!1}el.silent&&(isSilent=!0);var hostEl=el.__hostTarget;el=hostEl?el.ignoreHostSilent?null:hostEl:el.parent}return isSilent?SILENT:!0}return!1}function setHoverTarget(list,out$2,x$1,y$1,exclude){for(var i$1=list.length-1;i$1>=0;i$1--){var el=list[i$1],hoverCheckResult=void 0;if(el!==exclude&&!el.ignore&&(hoverCheckResult=isHover(el,x$1,y$1))&&(!out$2.topTarget&&(out$2.topTarget=el),hoverCheckResult!==SILENT)){out$2.target=el;break}}}function isOutsideBoundary(handlerInstance,x$1,y$1){var painter=handlerInstance.painter;return x$1<0||x$1>painter.getWidth()||y$1<0||y$1>painter.getHeight()}var Handler_default=Handler,DEFAULT_MIN_MERGE=32,DEFAULT_MIN_GALLOPING=7;function minRunLength(n$1){for(var r$1=0;n$1>=DEFAULT_MIN_MERGE;)r$1|=n$1&1,n$1>>=1;return n$1+r$1}function makeAscendingRun(array,lo,hi,compare$1){var runHi=lo+1;if(runHi===hi)return 1;if(compare$1(array[runHi++],array[lo])<0){for(;runHi<hi&&compare$1(array[runHi],array[runHi-1])<0;)runHi++;reverseRun(array,lo,runHi)}else for(;runHi<hi&&compare$1(array[runHi],array[runHi-1])>=0;)runHi++;return runHi-lo}function reverseRun(array,lo,hi){for(hi--;lo<hi;){var t$1=array[lo];array[lo++]=array[hi],array[hi--]=t$1}}function binaryInsertionSort(array,lo,hi,start$1,compare$1){for(start$1===lo&&start$1++;start$1<hi;start$1++){for(var pivot=array[start$1],left=lo,right=start$1,mid;left<right;)mid=left+right>>>1,compare$1(pivot,array[mid])<0?right=mid:left=mid+1;var n$1=start$1-left;switch(n$1){case 3:array[left+3]=array[left+2];case 2:array[left+2]=array[left+1];case 1:array[left+1]=array[left];break;default:for(;n$1>0;)array[left+n$1]=array[left+n$1-1],n$1--}array[left]=pivot}}function gallopLeft(value,array,start$1,length$1,hint,compare$1){var lastOffset=0,maxOffset=0,offset=1;if(compare$1(value,array[start$1+hint])>0){for(maxOffset=length$1-hint;offset<maxOffset&&compare$1(value,array[start$1+hint+offset])>0;)lastOffset=offset,offset=(offset<<1)+1,offset<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}else{for(maxOffset=hint+1;offset<maxOffset&&compare$1(value,array[start$1+hint-offset])<=0;)lastOffset=offset,offset=(offset<<1)+1,offset<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset);var tmp=lastOffset;lastOffset=hint-offset,offset=hint-tmp}for(lastOffset++;lastOffset<offset;){var m$2=lastOffset+(offset-lastOffset>>>1);compare$1(value,array[start$1+m$2])>0?lastOffset=m$2+1:offset=m$2}return offset}function gallopRight(value,array,start$1,length$1,hint,compare$1){var lastOffset=0,maxOffset=0,offset=1;if(compare$1(value,array[start$1+hint])<0){for(maxOffset=hint+1;offset<maxOffset&&compare$1(value,array[start$1+hint-offset])<0;)lastOffset=offset,offset=(offset<<1)+1,offset<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset);var tmp=lastOffset;lastOffset=hint-offset,offset=hint-tmp}else{for(maxOffset=length$1-hint;offset<maxOffset&&compare$1(value,array[start$1+hint+offset])>=0;)lastOffset=offset,offset=(offset<<1)+1,offset<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}for(lastOffset++;lastOffset<offset;){var m$2=lastOffset+(offset-lastOffset>>>1);compare$1(value,array[start$1+m$2])<0?offset=m$2:lastOffset=m$2+1}return offset}function TimSort(array,compare$1){var minGallop=DEFAULT_MIN_GALLOPING,runStart,runLength,stackSize=0,tmp=[];runStart=[],runLength=[];function pushRun(_runStart,_runLength){runStart[stackSize]=_runStart,runLength[stackSize]=_runLength,stackSize+=1}function mergeRuns(){for(;stackSize>1;){var n$1=stackSize-2;if(n$1>=1&&runLength[n$1-1]<=runLength[n$1]+runLength[n$1+1]||n$1>=2&&runLength[n$1-2]<=runLength[n$1]+runLength[n$1-1])runLength[n$1-1]<runLength[n$1+1]&&n$1--;else if(runLength[n$1]>runLength[n$1+1])break;mergeAt(n$1)}}function forceMergeRuns(){for(;stackSize>1;){var n$1=stackSize-2;n$1>0&&runLength[n$1-1]<runLength[n$1+1]&&n$1--,mergeAt(n$1)}}function mergeAt(i$1){var start1=runStart[i$1],length1=runLength[i$1],start2=runStart[i$1+1],length2=runLength[i$1+1];runLength[i$1]=length1+length2,i$1===stackSize-3&&(runStart[i$1+1]=runStart[i$1+2],runLength[i$1+1]=runLength[i$1+2]),stackSize--;var k$1=gallopRight(array[start2],array,start1,length1,0,compare$1);start1+=k$1,length1-=k$1,length1!==0&&(length2=gallopLeft(array[start1+length1-1],array,start2,length2,length2-1,compare$1),length2!==0&&(length1<=length2?mergeLow(start1,length1,start2,length2):mergeHigh(start1,length1,start2,length2)))}function mergeLow(start1,length1,start2,length2){var i$1=0;for(i$1=0;i$1<length1;i$1++)tmp[i$1]=array[start1+i$1];var cursor1=0,cursor2=start2,dest=start1;if(array[dest++]=array[cursor2++],--length2===0){for(i$1=0;i$1<length1;i$1++)array[dest+i$1]=tmp[cursor1+i$1];return}if(length1===1){for(i$1=0;i$1<length2;i$1++)array[dest+i$1]=array[cursor2+i$1];array[dest+length2]=tmp[cursor1];return}for(var _minGallop=minGallop,count1,count2,exit;;){count1=0,count2=0,exit=!1;do if(compare$1(array[cursor2],tmp[cursor1])<0){if(array[dest++]=array[cursor2++],count2++,count1=0,--length2===0){exit=!0;break}}else if(array[dest++]=tmp[cursor1++],count1++,count2=0,--length1===1){exit=!0;break}while((count1|count2)<_minGallop);if(exit)break;do{if(count1=gallopRight(array[cursor2],tmp,cursor1,length1,0,compare$1),count1!==0){for(i$1=0;i$1<count1;i$1++)array[dest+i$1]=tmp[cursor1+i$1];if(dest+=count1,cursor1+=count1,length1-=count1,length1<=1){exit=!0;break}}if(array[dest++]=array[cursor2++],--length2===0){exit=!0;break}if(count2=gallopLeft(tmp[cursor1],array,cursor2,length2,0,compare$1),count2!==0){for(i$1=0;i$1<count2;i$1++)array[dest+i$1]=array[cursor2+i$1];if(dest+=count2,cursor2+=count2,length2-=count2,length2===0){exit=!0;break}}if(array[dest++]=tmp[cursor1++],--length1===1){exit=!0;break}_minGallop--}while(count1>=DEFAULT_MIN_GALLOPING||count2>=DEFAULT_MIN_GALLOPING);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}if(minGallop=_minGallop,minGallop<1&&(minGallop=1),length1===1){for(i$1=0;i$1<length2;i$1++)array[dest+i$1]=array[cursor2+i$1];array[dest+length2]=tmp[cursor1]}else if(length1===0)throw Error();else for(i$1=0;i$1<length1;i$1++)array[dest+i$1]=tmp[cursor1+i$1]}function mergeHigh(start1,length1,start2,length2){var i$1=0;for(i$1=0;i$1<length2;i$1++)tmp[i$1]=array[start2+i$1];var cursor1=start1+length1-1,cursor2=length2-1,dest=start2+length2-1,customCursor=0,customDest=0;if(array[dest--]=array[cursor1--],--length1===0){for(customCursor=dest-(length2-1),i$1=0;i$1<length2;i$1++)array[customCursor+i$1]=tmp[i$1];return}if(length2===1){for(dest-=length1,cursor1-=length1,customDest=dest+1,customCursor=cursor1+1,i$1=length1-1;i$1>=0;i$1--)array[customDest+i$1]=array[customCursor+i$1];array[dest]=tmp[cursor2];return}for(var _minGallop=minGallop;;){var count1=0,count2=0,exit=!1;do if(compare$1(tmp[cursor2],array[cursor1])<0){if(array[dest--]=array[cursor1--],count1++,count2=0,--length1===0){exit=!0;break}}else if(array[dest--]=tmp[cursor2--],count2++,count1=0,--length2===1){exit=!0;break}while((count1|count2)<_minGallop);if(exit)break;do{if(count1=length1-gallopRight(tmp[cursor2],array,start1,length1,length1-1,compare$1),count1!==0){for(dest-=count1,cursor1-=count1,length1-=count1,customDest=dest+1,customCursor=cursor1+1,i$1=count1-1;i$1>=0;i$1--)array[customDest+i$1]=array[customCursor+i$1];if(length1===0){exit=!0;break}}if(array[dest--]=tmp[cursor2--],--length2===1){exit=!0;break}if(count2=length2-gallopLeft(array[cursor1],tmp,0,length2,length2-1,compare$1),count2!==0){for(dest-=count2,cursor2-=count2,length2-=count2,customDest=dest+1,customCursor=cursor2+1,i$1=0;i$1<count2;i$1++)array[customDest+i$1]=tmp[customCursor+i$1];if(length2<=1){exit=!0;break}}if(array[dest--]=array[cursor1--],--length1===0){exit=!0;break}_minGallop--}while(count1>=DEFAULT_MIN_GALLOPING||count2>=DEFAULT_MIN_GALLOPING);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}if(minGallop=_minGallop,minGallop<1&&(minGallop=1),length2===1){for(dest-=length1,cursor1-=length1,customDest=dest+1,customCursor=cursor1+1,i$1=length1-1;i$1>=0;i$1--)array[customDest+i$1]=array[customCursor+i$1];array[dest]=tmp[cursor2]}else if(length2===0)throw Error();else for(customCursor=dest-(length2-1),i$1=0;i$1<length2;i$1++)array[customCursor+i$1]=tmp[i$1]}return{mergeRuns,forceMergeRuns,pushRun}}function sort(array,compare$1,lo,hi){lo||=0,hi||=array.length;var remaining=hi-lo;if(!(remaining<2)){var runLength=0;if(remaining<DEFAULT_MIN_MERGE){runLength=makeAscendingRun(array,lo,hi,compare$1),binaryInsertionSort(array,lo,hi,lo+runLength,compare$1);return}var ts=TimSort(array,compare$1),minRun=minRunLength(remaining);do{if(runLength=makeAscendingRun(array,lo,hi,compare$1),runLength<minRun){var force=remaining;force>minRun&&(force=minRun),binaryInsertionSort(array,lo,lo+force,lo+runLength,compare$1),runLength=force}ts.pushRun(lo,runLength),ts.mergeRuns(),remaining-=runLength,lo+=runLength}while(remaining!==0);ts.forceMergeRuns()}}var REDRAW_BIT=1,STYLE_CHANGED_BIT=2,SHAPE_CHANGED_BIT=4,invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0,console.warn(`z / z2 / zlevel of displayable is invalid, which may cause unexpected errors`))}function shapeCompareFunc(a$1,b$1){return a$1.zlevel===b$1.zlevel?a$1.z===b$1.z?a$1.z2-b$1.z2:a$1.z-b$1.z:a$1.zlevel-b$1.zlevel}var Storage_default=function(){function Storage$1(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return Storage$1.prototype.traverse=function(cb,context$1){for(var i$1=0;i$1<this._roots.length;i$1++)this._roots[i$1].traverse(cb,context$1)},Storage$1.prototype.getDisplayList=function(update,includeIgnore){includeIgnore||=!1;var displayList=this._displayList;return(update||!displayList.length)&&this.updateDisplayList(includeIgnore),displayList},Storage$1.prototype.updateDisplayList=function(includeIgnore){this._displayListLen=0;for(var roots$1=this._roots,displayList=this._displayList,i$1=0,len$1=roots$1.length;i$1<len$1;i$1++)this._updateAndAddDisplayable(roots$1[i$1],null,includeIgnore);displayList.length=this._displayListLen,sort(displayList,shapeCompareFunc)},Storage$1.prototype._updateAndAddDisplayable=function(el,parentClipPaths,includeIgnore){if(!(el.ignore&&!includeIgnore)){el.beforeUpdate(),el.update(),el.afterUpdate();var userSetClipPath=el.getClipPath(),parentHasClipPaths=parentClipPaths&&parentClipPaths.length,clipPathIdx=0,thisClipPaths=el.__clipPaths;if(!el.ignoreClip&&(parentHasClipPaths||userSetClipPath)){if(thisClipPaths||=el.__clipPaths=[],parentHasClipPaths)for(var idx=0;idx<parentClipPaths.length;idx++)thisClipPaths[clipPathIdx++]=parentClipPaths[idx];for(var currentClipPath=userSetClipPath,parentClipPath=el;currentClipPath;)currentClipPath.parent=parentClipPath,currentClipPath.updateTransform(),thisClipPaths[clipPathIdx++]=currentClipPath,parentClipPath=currentClipPath,currentClipPath=currentClipPath.getClipPath()}if(thisClipPaths&&(thisClipPaths.length=clipPathIdx),el.childrenRef){for(var children=el.childrenRef(),i$1=0;i$1<children.length;i$1++){var child=children[i$1];el.__dirty&&(child.__dirty|=1),this._updateAndAddDisplayable(child,thisClipPaths,includeIgnore)}el.__dirty=0}else{var disp=el;isNaN(disp.z)&&(logInvalidZError(),disp.z=0),isNaN(disp.z2)&&(logInvalidZError(),disp.z2=0),isNaN(disp.zlevel)&&(logInvalidZError(),disp.zlevel=0),this._displayList[this._displayListLen++]=disp}var decalEl=el.getDecalElement&&el.getDecalElement();decalEl&&this._updateAndAddDisplayable(decalEl,thisClipPaths,includeIgnore);var textGuide=el.getTextGuideLine();textGuide&&this._updateAndAddDisplayable(textGuide,thisClipPaths,includeIgnore);var textEl=el.getTextContent();textEl&&this._updateAndAddDisplayable(textEl,thisClipPaths,includeIgnore)}},Storage$1.prototype.addRoot=function(el){el.__zr&&el.__zr.storage===this||this._roots.push(el)},Storage$1.prototype.delRoot=function(el){if(el instanceof Array){for(var i$1=0,l$1=el.length;i$1<l$1;i$1++)this.delRoot(el[i$1]);return}var idx=indexOf(this._roots,el);idx>=0&&this._roots.splice(idx,1)},Storage$1.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},Storage$1.prototype.getRoots=function(){return this._roots},Storage$1.prototype.dispose=function(){this._displayList=null,this._roots=null},Storage$1}(),requestAnimationFrame_default=env_default.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(func){return setTimeout(func,16)},easingFuncs={linear:function(k$1){return k$1},quadraticIn:function(k$1){return k$1*k$1},quadraticOut:function(k$1){return k$1*(2-k$1)},quadraticInOut:function(k$1){return(k$1*=2)<1?.5*k$1*k$1:-.5*(--k$1*(k$1-2)-1)},cubicIn:function(k$1){return k$1*k$1*k$1},cubicOut:function(k$1){return--k$1*k$1*k$1+1},cubicInOut:function(k$1){return(k$1*=2)<1?.5*k$1*k$1*k$1:.5*((k$1-=2)*k$1*k$1+2)},quarticIn:function(k$1){return k$1*k$1*k$1*k$1},quarticOut:function(k$1){return 1- --k$1*k$1*k$1*k$1},quarticInOut:function(k$1){return(k$1*=2)<1?.5*k$1*k$1*k$1*k$1:-.5*((k$1-=2)*k$1*k$1*k$1-2)},quinticIn:function(k$1){return k$1*k$1*k$1*k$1*k$1},quinticOut:function(k$1){return--k$1*k$1*k$1*k$1*k$1+1},quinticInOut:function(k$1){return(k$1*=2)<1?.5*k$1*k$1*k$1*k$1*k$1:.5*((k$1-=2)*k$1*k$1*k$1*k$1+2)},sinusoidalIn:function(k$1){return 1-Math.cos(k$1*Math.PI/2)},sinusoidalOut:function(k$1){return Math.sin(k$1*Math.PI/2)},sinusoidalInOut:function(k$1){return .5*(1-Math.cos(Math.PI*k$1))},exponentialIn:function(k$1){return k$1===0?0:1024**(k$1-1)},exponentialOut:function(k$1){return k$1===1?1:1-2**(-10*k$1)},exponentialInOut:function(k$1){return k$1===0?0:k$1===1?1:(k$1*=2)<1?.5*1024**(k$1-1):.5*(-(2**(-10*(k$1-1)))+2)},circularIn:function(k$1){return 1-Math.sqrt(1-k$1*k$1)},circularOut:function(k$1){return Math.sqrt(1- --k$1*k$1)},circularInOut:function(k$1){return(k$1*=2)<1?-.5*(Math.sqrt(1-k$1*k$1)-1):.5*(Math.sqrt(1-(k$1-=2)*k$1)+1)},elasticIn:function(k$1){var s$1,a$1=.1,p$2=.4;return k$1===0?0:k$1===1?1:(!a$1||a$1<1?(a$1=1,s$1=p$2/4):s$1=p$2*Math.asin(1/a$1)/(2*Math.PI),-(a$1*2**(10*--k$1)*Math.sin((k$1-s$1)*(2*Math.PI)/p$2)))},elasticOut:function(k$1){var s$1,a$1=.1,p$2=.4;return k$1===0?0:k$1===1?1:(!a$1||a$1<1?(a$1=1,s$1=p$2/4):s$1=p$2*Math.asin(1/a$1)/(2*Math.PI),a$1*2**(-10*k$1)*Math.sin((k$1-s$1)*(2*Math.PI)/p$2)+1)},elasticInOut:function(k$1){var s$1,a$1=.1,p$2=.4;return k$1===0?0:k$1===1?1:(!a$1||a$1<1?(a$1=1,s$1=p$2/4):s$1=p$2*Math.asin(1/a$1)/(2*Math.PI),(k$1*=2)<1?-.5*(a$1*2**(10*--k$1)*Math.sin((k$1-s$1)*(2*Math.PI)/p$2)):a$1*2**(-10*--k$1)*Math.sin((k$1-s$1)*(2*Math.PI)/p$2)*.5+1)},backIn:function(k$1){var s$1=1.70158;return k$1*k$1*((s$1+1)*k$1-s$1)},backOut:function(k$1){var s$1=1.70158;return--k$1*k$1*((s$1+1)*k$1+s$1)+1},backInOut:function(k$1){var s$1=1.70158*1.525;return(k$1*=2)<1?.5*(k$1*k$1*((s$1+1)*k$1-s$1)):.5*((k$1-=2)*k$1*((s$1+1)*k$1+s$1)+2)},bounceIn:function(k$1){return 1-easingFuncs.bounceOut(1-k$1)},bounceOut:function(k$1){return k$1<1/2.75?7.5625*k$1*k$1:k$1<2/2.75?7.5625*(k$1-=1.5/2.75)*k$1+.75:k$1<2.5/2.75?7.5625*(k$1-=2.25/2.75)*k$1+.9375:7.5625*(k$1-=2.625/2.75)*k$1+.984375},bounceInOut:function(k$1){return k$1<.5?easingFuncs.bounceIn(k$1*2)*.5:easingFuncs.bounceOut(k$1*2-1)*.5+.5}},easing_default=easingFuncs,mathPow$1=Math.pow,mathSqrt$3=Math.sqrt,EPSILON$2=1e-8,EPSILON_NUMERIC=1e-4,THREE_SQRT=mathSqrt$3(3),ONE_THIRD=1/3,_v0=create(),_v1=create(),_v2=create();function isAroundZero(val){return val>-EPSILON$2&&val<EPSILON$2}function isNotAroundZero$1(val){return val>EPSILON$2||val<-EPSILON$2}function cubicAt(p0,p1,p2,p3,t$1){var onet=1-t$1;return onet*onet*(onet*p0+3*t$1*p1)+t$1*t$1*(t$1*p3+3*onet*p2)}function cubicDerivativeAt(p0,p1,p2,p3,t$1){var onet=1-t$1;return 3*(((p1-p0)*onet+2*(p2-p1)*t$1)*onet+(p3-p2)*t$1*t$1)}function cubicRootAt(p0,p1,p2,p3,val,roots$1){var a$1=p3+3*(p1-p2)-p0,b$1=3*(p2-p1*2+p0),c$2=3*(p1-p0),d$1=p0-val,A=b$1*b$1-3*a$1*c$2,B=b$1*c$2-9*a$1*d$1,C=c$2*c$2-3*b$1*d$1,n$1=0;if(isAroundZero(A)&&isAroundZero(B))if(isAroundZero(b$1))roots$1[0]=0;else{var t1=-c$2/b$1;t1>=0&&t1<=1&&(roots$1[n$1++]=t1)}else{var disc=B*B-4*A*C;if(isAroundZero(disc)){var K=B/A,t1=-b$1/a$1+K,t2=-K/2;t1>=0&&t1<=1&&(roots$1[n$1++]=t1),t2>=0&&t2<=1&&(roots$1[n$1++]=t2)}else if(disc>0){var discSqrt=mathSqrt$3(disc),Y1=A*b$1+1.5*a$1*(-B+discSqrt),Y2=A*b$1+1.5*a$1*(-B-discSqrt);Y1=Y1<0?-mathPow$1(-Y1,ONE_THIRD):mathPow$1(Y1,ONE_THIRD),Y2=Y2<0?-mathPow$1(-Y2,ONE_THIRD):mathPow$1(Y2,ONE_THIRD);var t1=(-b$1-(Y1+Y2))/(3*a$1);t1>=0&&t1<=1&&(roots$1[n$1++]=t1)}else{var T=(2*A*b$1-3*a$1*B)/(2*mathSqrt$3(A*A*A)),theta=Math.acos(T)/3,ASqrt=mathSqrt$3(A),tmp=Math.cos(theta),t1=(-b$1-2*ASqrt*tmp)/(3*a$1),t2=(-b$1+ASqrt*(tmp+THREE_SQRT*Math.sin(theta)))/(3*a$1),t3=(-b$1+ASqrt*(tmp-THREE_SQRT*Math.sin(theta)))/(3*a$1);t1>=0&&t1<=1&&(roots$1[n$1++]=t1),t2>=0&&t2<=1&&(roots$1[n$1++]=t2),t3>=0&&t3<=1&&(roots$1[n$1++]=t3)}}return n$1}function cubicExtrema(p0,p1,p2,p3,extrema$1){var b$1=6*p2-12*p1+6*p0,a$1=9*p1+3*p3-3*p0-9*p2,c$2=3*p1-3*p0,n$1=0;if(isAroundZero(a$1)){if(isNotAroundZero$1(b$1)){var t1=-c$2/b$1;t1>=0&&t1<=1&&(extrema$1[n$1++]=t1)}}else{var disc=b$1*b$1-4*a$1*c$2;if(isAroundZero(disc))extrema$1[0]=-b$1/(2*a$1);else if(disc>0){var discSqrt=mathSqrt$3(disc),t1=(-b$1+discSqrt)/(2*a$1),t2=(-b$1-discSqrt)/(2*a$1);t1>=0&&t1<=1&&(extrema$1[n$1++]=t1),t2>=0&&t2<=1&&(extrema$1[n$1++]=t2)}}return n$1}function cubicSubdivide(p0,p1,p2,p3,t$1,out$2){var p01=(p1-p0)*t$1+p0,p12=(p2-p1)*t$1+p1,p23=(p3-p2)*t$1+p2,p012=(p12-p01)*t$1+p01,p123=(p23-p12)*t$1+p12,p0123=(p123-p012)*t$1+p012;out$2[0]=p0,out$2[1]=p01,out$2[2]=p012,out$2[3]=p0123,out$2[4]=p0123,out$2[5]=p123,out$2[6]=p23,out$2[7]=p3}function cubicProjectPoint(x0,y0,x1,y1,x2,y2,x3,y3,x$1,y$1,out$2){var t$1,interval=.005,d$1=1/0,prev,next,d1,d2;_v0[0]=x$1,_v0[1]=y$1;for(var _t=0;_t<1;_t+=.05)_v1[0]=cubicAt(x0,x1,x2,x3,_t),_v1[1]=cubicAt(y0,y1,y2,y3,_t),d1=distSquare(_v0,_v1),d1<d$1&&(t$1=_t,d$1=d1);d$1=1/0;for(var i$1=0;i$1<32&&!(interval<EPSILON_NUMERIC);i$1++)prev=t$1-interval,next=t$1+interval,_v1[0]=cubicAt(x0,x1,x2,x3,prev),_v1[1]=cubicAt(y0,y1,y2,y3,prev),d1=distSquare(_v1,_v0),prev>=0&&d1<d$1?(t$1=prev,d$1=d1):(_v2[0]=cubicAt(x0,x1,x2,x3,next),_v2[1]=cubicAt(y0,y1,y2,y3,next),d2=distSquare(_v2,_v0),next<=1&&d2<d$1?(t$1=next,d$1=d2):interval*=.5);return out$2&&(out$2[0]=cubicAt(x0,x1,x2,x3,t$1),out$2[1]=cubicAt(y0,y1,y2,y3,t$1)),mathSqrt$3(d$1)}function cubicLength(x0,y0,x1,y1,x2,y2,x3,y3,iteration){for(var px=x0,py=y0,d$1=0,step=1/iteration,i$1=1;i$1<=iteration;i$1++){var t$1=i$1*step,x$1=cubicAt(x0,x1,x2,x3,t$1),y$1=cubicAt(y0,y1,y2,y3,t$1),dx=x$1-px,dy=y$1-py;d$1+=Math.sqrt(dx*dx+dy*dy),px=x$1,py=y$1}return d$1}function quadraticAt(p0,p1,p2,t$1){var onet=1-t$1;return onet*(onet*p0+2*t$1*p1)+t$1*t$1*p2}function quadraticDerivativeAt(p0,p1,p2,t$1){return 2*((1-t$1)*(p1-p0)+t$1*(p2-p1))}function quadraticRootAt(p0,p1,p2,val,roots$1){var a$1=p0-2*p1+p2,b$1=2*(p1-p0),c$2=p0-val,n$1=0;if(isAroundZero(a$1)){if(isNotAroundZero$1(b$1)){var t1=-c$2/b$1;t1>=0&&t1<=1&&(roots$1[n$1++]=t1)}}else{var disc=b$1*b$1-4*a$1*c$2;if(isAroundZero(disc)){var t1=-b$1/(2*a$1);t1>=0&&t1<=1&&(roots$1[n$1++]=t1)}else if(disc>0){var discSqrt=mathSqrt$3(disc),t1=(-b$1+discSqrt)/(2*a$1),t2=(-b$1-discSqrt)/(2*a$1);t1>=0&&t1<=1&&(roots$1[n$1++]=t1),t2>=0&&t2<=1&&(roots$1[n$1++]=t2)}}return n$1}function quadraticExtremum(p0,p1,p2){var divider=p0+p2-2*p1;return divider===0?.5:(p0-p1)/divider}function quadraticSubdivide(p0,p1,p2,t$1,out$2){var p01=(p1-p0)*t$1+p0,p12=(p2-p1)*t$1+p1,p012=(p12-p01)*t$1+p01;out$2[0]=p0,out$2[1]=p01,out$2[2]=p012,out$2[3]=p012,out$2[4]=p12,out$2[5]=p2}function quadraticProjectPoint(x0,y0,x1,y1,x2,y2,x$1,y$1,out$2){var t$1,interval=.005,d$1=1/0;_v0[0]=x$1,_v0[1]=y$1;for(var _t=0;_t<1;_t+=.05){_v1[0]=quadraticAt(x0,x1,x2,_t),_v1[1]=quadraticAt(y0,y1,y2,_t);var d1=distSquare(_v0,_v1);d1<d$1&&(t$1=_t,d$1=d1)}d$1=1/0;for(var i$1=0;i$1<32&&!(interval<EPSILON_NUMERIC);i$1++){var prev=t$1-interval,next=t$1+interval;_v1[0]=quadraticAt(x0,x1,x2,prev),_v1[1]=quadraticAt(y0,y1,y2,prev);var d1=distSquare(_v1,_v0);if(prev>=0&&d1<d$1)t$1=prev,d$1=d1;else{_v2[0]=quadraticAt(x0,x1,x2,next),_v2[1]=quadraticAt(y0,y1,y2,next);var d2=distSquare(_v2,_v0);next<=1&&d2<d$1?(t$1=next,d$1=d2):interval*=.5}}return out$2&&(out$2[0]=quadraticAt(x0,x1,x2,t$1),out$2[1]=quadraticAt(y0,y1,y2,t$1)),mathSqrt$3(d$1)}function quadraticLength(x0,y0,x1,y1,x2,y2,iteration){for(var px=x0,py=y0,d$1=0,step=1/iteration,i$1=1;i$1<=iteration;i$1++){var t$1=i$1*step,x$1=quadraticAt(x0,x1,x2,t$1),y$1=quadraticAt(y0,y1,y2,t$1),dx=x$1-px,dy=y$1-py;d$1+=Math.sqrt(dx*dx+dy*dy),px=x$1,py=y$1}return d$1}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(cubicEasingStr){var cubic=cubicEasingStr&&regexp.exec(cubicEasingStr);if(cubic){var points$1=cubic[1].split(`,`),a_1=+trim(points$1[0]),b_1=+trim(points$1[1]),c_1=+trim(points$1[2]),d_1=+trim(points$1[3]);if(isNaN(a_1+b_1+c_1+d_1))return;var roots_1=[];return function(p$2){return p$2<=0?0:p$2>=1?1:cubicRootAt(0,a_1,c_1,1,p$2,roots_1)&&cubicAt(0,b_1,d_1,1,roots_1[0])}}}var Clip_default=function(){function Clip$1(opts){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=opts.life||1e3,this._delay=opts.delay||0,this.loop=opts.loop||!1,this.onframe=opts.onframe||noop,this.ondestroy=opts.ondestroy||noop,this.onrestart=opts.onrestart||noop,opts.easing&&this.setEasing(opts.easing)}return Clip$1.prototype.step=function(globalTime,deltaTime){if(this._inited||=(this._startTime=globalTime+this._delay,!0),this._paused){this._pausedTime+=deltaTime;return}var life=this._life,elapsedTime=globalTime-this._startTime-this._pausedTime,percent=elapsedTime/life;percent<0&&(percent=0),percent=Math.min(percent,1);var easingFunc=this.easingFunc,schedule=easingFunc?easingFunc(percent):percent;if(this.onframe(schedule),percent===1)if(this.loop){var remainder=elapsedTime%life;this._startTime=globalTime-remainder,this._pausedTime=0,this.onrestart()}else return!0;return!1},Clip$1.prototype.pause=function(){this._paused=!0},Clip$1.prototype.resume=function(){this._paused=!1},Clip$1.prototype.setEasing=function(easing){this.easing=easing,this.easingFunc=isFunction(easing)?easing:easing_default[easing]||createCubicEasingFunc(easing)},Clip$1}(),Entry=function(){function Entry$1(val){this.value=val}return Entry$1}(),LinkedList=function(){function LinkedList$1(){this._len=0}return LinkedList$1.prototype.insert=function(val){var entry=new Entry(val);return this.insertEntry(entry),entry},LinkedList$1.prototype.insertEntry=function(entry){this.head?(this.tail.next=entry,entry.prev=this.tail,entry.next=null,this.tail=entry):this.head=this.tail=entry,this._len++},LinkedList$1.prototype.remove=function(entry){var prev=entry.prev,next=entry.next;prev?prev.next=next:this.head=next,next?next.prev=prev:this.tail=prev,entry.next=entry.prev=null,this._len--},LinkedList$1.prototype.len=function(){return this._len},LinkedList$1.prototype.clear=function(){this.head=this.tail=null,this._len=0},LinkedList$1}(),LRU_default=function(){function LRU$2(maxSize){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=maxSize}return LRU$2.prototype.put=function(key$1,value){var list=this._list,map$2=this._map,removed=null;if(map$2[key$1]==null){var len$1=list.len(),entry=this._lastRemovedEntry;if(len$1>=this._maxSize&&len$1>0){var leastUsedEntry=list.head;list.remove(leastUsedEntry),delete map$2[leastUsedEntry.key],removed=leastUsedEntry.value,this._lastRemovedEntry=leastUsedEntry}entry?entry.value=value:entry=new Entry(value),entry.key=key$1,list.insertEntry(entry),map$2[key$1]=entry}return removed},LRU$2.prototype.get=function(key$1){var entry=this._map[key$1],list=this._list;if(entry!=null)return entry!==list.tail&&(list.remove(entry),list.insertEntry(entry)),entry.value},LRU$2.prototype.clear=function(){this._list.clear(),this._map={}},LRU$2.prototype.len=function(){return this._list.len()},LRU$2}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(i$1){return i$1=Math.round(i$1),i$1<0?0:i$1>255?255:i$1}function clampCssAngle(i$1){return i$1=Math.round(i$1),i$1<0?0:i$1>360?360:i$1}function clampCssFloat(f$1){return f$1<0?0:f$1>1?1:f$1}function parseCssInt(val){var str=val;return str.length&&str.charAt(str.length-1)===`%`?clampCssByte(parseFloat(str)/100*255):clampCssByte(parseInt(str,10))}function parseCssFloat(val){var str=val;return str.length&&str.charAt(str.length-1)===`%`?clampCssFloat(parseFloat(str)/100):clampCssFloat(parseFloat(str))}function cssHueToRgb(m1,m2,h$2){return h$2<0?h$2+=1:h$2>1&&--h$2,h$2*6<1?m1+(m2-m1)*h$2*6:h$2*2<1?m2:h$2*3<2?m1+(m2-m1)*(2/3-h$2)*6:m1}function lerpNumber(a$1,b$1,p$2){return a$1+(b$1-a$1)*p$2}function setRgba(out$2,r$1,g$1,b$1,a$1){return out$2[0]=r$1,out$2[1]=g$1,out$2[2]=b$1,out$2[3]=a$1,out$2}function copyRgba(out$2,a$1){return out$2[0]=a$1[0],out$2[1]=a$1[1],out$2[2]=a$1[2],out$2[3]=a$1[3],out$2}var colorCache=new LRU_default(20),lastRemovedArr=null;function putToCache(colorStr,rgbaArr){lastRemovedArr&&copyRgba(lastRemovedArr,rgbaArr),lastRemovedArr=colorCache.put(colorStr,lastRemovedArr||rgbaArr.slice())}function parse(colorStr,rgbaArr){if(colorStr){rgbaArr||=[];var cached=colorCache.get(colorStr);if(cached)return copyRgba(rgbaArr,cached);colorStr+=``;var str=colorStr.replace(/ /g,``).toLowerCase();if(str in kCSSColorTable)return copyRgba(rgbaArr,kCSSColorTable[str]),putToCache(colorStr,rgbaArr),rgbaArr;var strLen=str.length;if(str.charAt(0)===`#`){if(strLen===4||strLen===5){var iv=parseInt(str.slice(1,4),16);if(!(iv>=0&&iv<=4095)){setRgba(rgbaArr,0,0,0,1);return}return setRgba(rgbaArr,(iv&3840)>>4|(iv&3840)>>8,iv&240|(iv&240)>>4,iv&15|(iv&15)<<4,strLen===5?parseInt(str.slice(4),16)/15:1),putToCache(colorStr,rgbaArr),rgbaArr}else if(strLen===7||strLen===9){var iv=parseInt(str.slice(1,7),16);if(!(iv>=0&&iv<=16777215)){setRgba(rgbaArr,0,0,0,1);return}return setRgba(rgbaArr,(iv&16711680)>>16,(iv&65280)>>8,iv&255,strLen===9?parseInt(str.slice(7),16)/255:1),putToCache(colorStr,rgbaArr),rgbaArr}return}var op=str.indexOf(`(`),ep=str.indexOf(`)`);if(op!==-1&&ep+1===strLen){var fname=str.substr(0,op),params=str.substr(op+1,ep-(op+1)).split(`,`),alpha=1;switch(fname){case`rgba`:if(params.length!==4)return params.length===3?setRgba(rgbaArr,+params[0],+params[1],+params[2],1):setRgba(rgbaArr,0,0,0,1);alpha=parseCssFloat(params.pop());case`rgb`:if(params.length>=3)return setRgba(rgbaArr,parseCssInt(params[0]),parseCssInt(params[1]),parseCssInt(params[2]),params.length===3?alpha:parseCssFloat(params[3])),putToCache(colorStr,rgbaArr),rgbaArr;setRgba(rgbaArr,0,0,0,1);return;case`hsla`:if(params.length!==4){setRgba(rgbaArr,0,0,0,1);return}return params[3]=parseCssFloat(params[3]),hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr;case`hsl`:if(params.length!==3){setRgba(rgbaArr,0,0,0,1);return}return hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr;default:return}}setRgba(rgbaArr,0,0,0,1)}}function hsla2rgba(hsla,rgba){var h$2=(parseFloat(hsla[0])%360+360)%360/360,s$1=parseCssFloat(hsla[1]),l$1=parseCssFloat(hsla[2]),m2=l$1<=.5?l$1*(s$1+1):l$1+s$1-l$1*s$1,m1=l$1*2-m2;return rgba||=[],setRgba(rgba,clampCssByte(cssHueToRgb(m1,m2,h$2+1/3)*255),clampCssByte(cssHueToRgb(m1,m2,h$2)*255),clampCssByte(cssHueToRgb(m1,m2,h$2-1/3)*255),1),hsla.length===4&&(rgba[3]=hsla[3]),rgba}function rgba2hsla(rgba){if(rgba){var R=rgba[0]/255,G=rgba[1]/255,B=rgba[2]/255,vMin=Math.min(R,G,B),vMax=Math.max(R,G,B),delta=vMax-vMin,L=(vMax+vMin)/2,H$1,S$1;if(delta===0)H$1=0,S$1=0;else{S$1=L<.5?delta/(vMax+vMin):delta/(2-vMax-vMin);var deltaR=((vMax-R)/6+delta/2)/delta,deltaG=((vMax-G)/6+delta/2)/delta,deltaB=((vMax-B)/6+delta/2)/delta;R===vMax?H$1=deltaB-deltaG:G===vMax?H$1=1/3+deltaR-deltaB:B===vMax&&(H$1=2/3+deltaG-deltaR),H$1<0&&(H$1+=1),H$1>1&&--H$1}var hsla=[H$1*360,S$1,L];return rgba[3]!=null&&hsla.push(rgba[3]),hsla}}function lift(color$2,level){var colorArr=parse(color$2);if(colorArr){for(var i$1=0;i$1<3;i$1++)level<0?colorArr[i$1]=colorArr[i$1]*(1-level)|0:colorArr[i$1]=(255-colorArr[i$1])*level+colorArr[i$1]|0,colorArr[i$1]>255?colorArr[i$1]=255:colorArr[i$1]<0&&(colorArr[i$1]=0);return stringify(colorArr,colorArr.length===4?`rgba`:`rgb`)}}function lerp(normalizedValue,colors,fullOutput){if(!(!(colors&&colors.length)||!(normalizedValue>=0&&normalizedValue<=1))){var value=normalizedValue*(colors.length-1),leftIndex=Math.floor(value),rightIndex=Math.ceil(value),leftColor=parse(colors[leftIndex]),rightColor=parse(colors[rightIndex]),dv=value-leftIndex,color$2=stringify([clampCssByte(lerpNumber(leftColor[0],rightColor[0],dv)),clampCssByte(lerpNumber(leftColor[1],rightColor[1],dv)),clampCssByte(lerpNumber(leftColor[2],rightColor[2],dv)),clampCssFloat(lerpNumber(leftColor[3],rightColor[3],dv))],`rgba`);return fullOutput?{color:color$2,leftIndex,rightIndex,value}:color$2}}function modifyHSL(color$2,h$2,s$1,l$1){var colorArr=parse(color$2);if(color$2)return colorArr=rgba2hsla(colorArr),h$2!=null&&(colorArr[0]=clampCssAngle(isFunction(h$2)?h$2(colorArr[0]):h$2)),s$1!=null&&(colorArr[1]=parseCssFloat(isFunction(s$1)?s$1(colorArr[1]):s$1)),l$1!=null&&(colorArr[2]=parseCssFloat(isFunction(l$1)?l$1(colorArr[2]):l$1)),stringify(hsla2rgba(colorArr),`rgba`)}function stringify(arrColor,type){if(!(!arrColor||!arrColor.length)){var colorStr=arrColor[0]+`,`+arrColor[1]+`,`+arrColor[2];return(type===`rgba`||type===`hsva`||type===`hsla`)&&(colorStr+=`,`+arrColor[3]),type+`(`+colorStr+`)`}}function lum(color$2,backgroundLum){var arr=parse(color$2);return arr?(.299*arr[0]+.587*arr[1]+.114*arr[2])*arr[3]/255+(1-arr[3])*backgroundLum:0}var liftedColorCache=new LRU_default(100);function liftColor(color$2){if(isString(color$2)){var liftedColor=liftedColorCache.get(color$2);return liftedColor||(liftedColor=lift(color$2,-.1),liftedColorCache.put(color$2,liftedColor)),liftedColor}else if(isGradientObject(color$2)){var ret=extend({},color$2);return ret.colorStops=map(color$2.colorStops,function(stop$2){return{offset:stop$2.offset,color:lift(stop$2.color,-.1)}}),ret}return color$2}function isLinearGradient(val){return val.type===`linear`}function isRadialGradient(val){return val.type===`radial`}var encodeBase64=(function(){return env_default.hasGlobalWindow&&isFunction(window.btoa)?function(str){return window.btoa(unescape(encodeURIComponent(str)))}:typeof Buffer<`u`?function(str){return Buffer.from(str).toString(`base64`)}:function(str){return null}})(),arraySlice=Array.prototype.slice;function interpolateNumber$1(p0,p1,percent){return(p1-p0)*percent+p0}function interpolate1DArray(out$2,p0,p1,percent){for(var len$1=p0.length,i$1=0;i$1<len$1;i$1++)out$2[i$1]=interpolateNumber$1(p0[i$1],p1[i$1],percent);return out$2}function interpolate2DArray(out$2,p0,p1,percent){for(var len$1=p0.length,len2=len$1&&p0[0].length,i$1=0;i$1<len$1;i$1++){out$2[i$1]||(out$2[i$1]=[]);for(var j$1=0;j$1<len2;j$1++)out$2[i$1][j$1]=interpolateNumber$1(p0[i$1][j$1],p1[i$1][j$1],percent)}return out$2}function add1DArray(out$2,p0,p1,sign$1){for(var len$1=p0.length,i$1=0;i$1<len$1;i$1++)out$2[i$1]=p0[i$1]+p1[i$1]*sign$1;return out$2}function add2DArray(out$2,p0,p1,sign$1){for(var len$1=p0.length,len2=len$1&&p0[0].length,i$1=0;i$1<len$1;i$1++){out$2[i$1]||(out$2[i$1]=[]);for(var j$1=0;j$1<len2;j$1++)out$2[i$1][j$1]=p0[i$1][j$1]+p1[i$1][j$1]*sign$1}return out$2}function fillColorStops(val0,val1){for(var len0=val0.length,len1=val1.length,shorterArr=len0>len1?val1:val0,shorterLen=Math.min(len0,len1),last=shorterArr[shorterLen-1]||{color:[0,0,0,0],offset:0},i$1=shorterLen;i$1<Math.max(len0,len1);i$1++)shorterArr.push({offset:last.offset,color:last.color.slice()})}function fillArray(val0,val1,arrDim){var arr0=val0,arr1=val1;if(!(!arr0.push||!arr1.push)){var arr0Len=arr0.length,arr1Len=arr1.length;if(arr0Len!==arr1Len)if(arr0Len>arr1Len)arr0.length=arr1Len;else for(var i$1=arr0Len;i$1<arr1Len;i$1++)arr0.push(arrDim===1?arr1[i$1]:arraySlice.call(arr1[i$1]));for(var len2=arr0[0]&&arr0[0].length,i$1=0;i$1<arr0.length;i$1++)if(arrDim===1)isNaN(arr0[i$1])&&(arr0[i$1]=arr1[i$1]);else for(var j$1=0;j$1<len2;j$1++)isNaN(arr0[i$1][j$1])&&(arr0[i$1][j$1]=arr1[i$1][j$1])}}function cloneValue(value){if(isArrayLike(value)){var len$1=value.length;if(isArrayLike(value[0])){for(var ret=[],i$1=0;i$1<len$1;i$1++)ret.push(arraySlice.call(value[i$1]));return ret}return arraySlice.call(value)}return value}function rgba2String(rgba){return rgba[0]=Math.floor(rgba[0])||0,rgba[1]=Math.floor(rgba[1])||0,rgba[2]=Math.floor(rgba[2])||0,rgba[3]=rgba[3]==null?1:rgba[3],`rgba(`+rgba.join(`,`)+`)`}function guessArrayDim(value){return isArrayLike(value&&value[0])?2:1}var VALUE_TYPE_NUMBER=0,VALUE_TYPE_1D_ARRAY=1,VALUE_TYPE_2D_ARRAY=2,VALUE_TYPE_COLOR=3,VALUE_TYPE_LINEAR_GRADIENT=4,VALUE_TYPE_RADIAL_GRADIENT=5,VALUE_TYPE_UNKOWN=6;function isGradientValueType(valType){return valType===VALUE_TYPE_LINEAR_GRADIENT||valType===VALUE_TYPE_RADIAL_GRADIENT}function isArrayValueType(valType){return valType===VALUE_TYPE_1D_ARRAY||valType===VALUE_TYPE_2D_ARRAY}var tmpRgba=[0,0,0,0],Track=function(){function Track$1(propName){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=propName}return Track$1.prototype.isFinished=function(){return this._finished},Track$1.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},Track$1.prototype.needsAnimate=function(){return this.keyframes.length>=1},Track$1.prototype.getAdditiveTrack=function(){return this._additiveTrack},Track$1.prototype.addKeyframe=function(time,rawValue,easing){this._needsSort=!0;var keyframes=this.keyframes,len$1=keyframes.length,discrete=!1,valType=VALUE_TYPE_UNKOWN,value=rawValue;if(isArrayLike(rawValue)){var arrayDim=guessArrayDim(rawValue);valType=arrayDim,(arrayDim===1&&!isNumber(rawValue[0])||arrayDim===2&&!isNumber(rawValue[0][0]))&&(discrete=!0)}else if(isNumber(rawValue)&&!eqNaN(rawValue))valType=VALUE_TYPE_NUMBER;else if(isString(rawValue))if(!isNaN(+rawValue))valType=VALUE_TYPE_NUMBER;else{var colorArray=parse(rawValue);colorArray&&(value=colorArray,valType=VALUE_TYPE_COLOR)}else if(isGradientObject(rawValue)){var parsedGradient=extend({},value);parsedGradient.colorStops=map(rawValue.colorStops,function(colorStop){return{offset:colorStop.offset,color:parse(colorStop.color)}}),isLinearGradient(rawValue)?valType=VALUE_TYPE_LINEAR_GRADIENT:isRadialGradient(rawValue)&&(valType=VALUE_TYPE_RADIAL_GRADIENT),value=parsedGradient}len$1===0?this.valType=valType:(valType!==this.valType||valType===VALUE_TYPE_UNKOWN)&&(discrete=!0),this.discrete=this.discrete||discrete;var kf={time,value,rawValue,percent:0};return easing&&(kf.easing=easing,kf.easingFunc=isFunction(easing)?easing:easing_default[easing]||createCubicEasingFunc(easing)),keyframes.push(kf),kf},Track$1.prototype.prepare=function(maxTime,additiveTrack){var kfs=this.keyframes;this._needsSort&&kfs.sort(function(a$1,b$1){return a$1.time-b$1.time});for(var valType=this.valType,kfsLen=kfs.length,lastKf=kfs[kfsLen-1],isDiscrete=this.discrete,isArr=isArrayValueType(valType),isGradient=isGradientValueType(valType),i$1=0;i$1<kfsLen;i$1++){var kf=kfs[i$1],value=kf.value,lastValue=lastKf.value;kf.percent=kf.time/maxTime,isDiscrete||(isArr&&i$1!==kfsLen-1?fillArray(value,lastValue,valType):isGradient&&fillColorStops(value.colorStops,lastValue.colorStops))}if(!isDiscrete&&valType!==VALUE_TYPE_RADIAL_GRADIENT&&additiveTrack&&this.needsAnimate()&&additiveTrack.needsAnimate()&&valType===additiveTrack.valType&&!additiveTrack._finished){this._additiveTrack=additiveTrack;for(var startValue=kfs[0].value,i$1=0;i$1<kfsLen;i$1++)valType===VALUE_TYPE_NUMBER?kfs[i$1].additiveValue=kfs[i$1].value-startValue:valType===VALUE_TYPE_COLOR?kfs[i$1].additiveValue=add1DArray([],kfs[i$1].value,startValue,-1):isArrayValueType(valType)&&(kfs[i$1].additiveValue=valType===VALUE_TYPE_1D_ARRAY?add1DArray([],kfs[i$1].value,startValue,-1):add2DArray([],kfs[i$1].value,startValue,-1))}},Track$1.prototype.step=function(target,percent){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var isAdditive=this._additiveTrack!=null,valueKey=isAdditive?`additiveValue`:`value`,valType=this.valType,keyframes=this.keyframes,kfsNum=keyframes.length,propName=this.propName,isValueColor=valType===VALUE_TYPE_COLOR,frameIdx,lastFrame=this._lastFr,mathMin$8=Math.min,frame,nextFrame;if(kfsNum===1)frame=nextFrame=keyframes[0];else{if(percent<0)frameIdx=0;else if(percent<this._lastFrP){for(frameIdx=mathMin$8(lastFrame+1,kfsNum-1);frameIdx>=0&&!(keyframes[frameIdx].percent<=percent);frameIdx--);frameIdx=mathMin$8(frameIdx,kfsNum-2)}else{for(frameIdx=lastFrame;frameIdx<kfsNum&&!(keyframes[frameIdx].percent>percent);frameIdx++);frameIdx=mathMin$8(frameIdx-1,kfsNum-2)}nextFrame=keyframes[frameIdx+1],frame=keyframes[frameIdx]}if(frame&&nextFrame){this._lastFr=frameIdx,this._lastFrP=percent;var interval=nextFrame.percent-frame.percent,w$1=interval===0?1:mathMin$8((percent-frame.percent)/interval,1);nextFrame.easingFunc&&(w$1=nextFrame.easingFunc(w$1));var targetArr=isAdditive?this._additiveValue:isValueColor?tmpRgba:target[propName];if((isArrayValueType(valType)||isValueColor)&&!targetArr&&(targetArr=this._additiveValue=[]),this.discrete)target[propName]=w$1<1?frame.rawValue:nextFrame.rawValue;else if(isArrayValueType(valType))valType===VALUE_TYPE_1D_ARRAY?interpolate1DArray(targetArr,frame[valueKey],nextFrame[valueKey],w$1):interpolate2DArray(targetArr,frame[valueKey],nextFrame[valueKey],w$1);else if(isGradientValueType(valType)){var val=frame[valueKey],nextVal_1=nextFrame[valueKey],isLinearGradient_1=valType===VALUE_TYPE_LINEAR_GRADIENT;target[propName]={type:isLinearGradient_1?`linear`:`radial`,x:interpolateNumber$1(val.x,nextVal_1.x,w$1),y:interpolateNumber$1(val.y,nextVal_1.y,w$1),colorStops:map(val.colorStops,function(colorStop,idx){var nextColorStop=nextVal_1.colorStops[idx];return{offset:interpolateNumber$1(colorStop.offset,nextColorStop.offset,w$1),color:rgba2String(interpolate1DArray([],colorStop.color,nextColorStop.color,w$1))}}),global:nextVal_1.global},isLinearGradient_1?(target[propName].x2=interpolateNumber$1(val.x2,nextVal_1.x2,w$1),target[propName].y2=interpolateNumber$1(val.y2,nextVal_1.y2,w$1)):target[propName].r=interpolateNumber$1(val.r,nextVal_1.r,w$1)}else if(isValueColor)interpolate1DArray(targetArr,frame[valueKey],nextFrame[valueKey],w$1),isAdditive||(target[propName]=rgba2String(targetArr));else{var value=interpolateNumber$1(frame[valueKey],nextFrame[valueKey],w$1);isAdditive?this._additiveValue=value:target[propName]=value}isAdditive&&this._addToTarget(target)}}},Track$1.prototype._addToTarget=function(target){var valType=this.valType,propName=this.propName,additiveValue=this._additiveValue;valType===VALUE_TYPE_NUMBER?target[propName]=target[propName]+additiveValue:valType===VALUE_TYPE_COLOR?(parse(target[propName],tmpRgba),add1DArray(tmpRgba,tmpRgba,additiveValue,1),target[propName]=rgba2String(tmpRgba)):valType===VALUE_TYPE_1D_ARRAY?add1DArray(target[propName],target[propName],additiveValue,1):valType===VALUE_TYPE_2D_ARRAY&&add2DArray(target[propName],target[propName],additiveValue,1)},Track$1}(),Animator_default=function(){function Animator$1(target,loop,allowDiscreteAnimation,additiveTo){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=target,this._loop=loop,loop&&additiveTo){logError(`Can' use additive animation on looped animation.`);return}this._additiveAnimators=additiveTo,this._allowDiscrete=allowDiscreteAnimation}return Animator$1.prototype.getMaxTime=function(){return this._maxTime},Animator$1.prototype.getDelay=function(){return this._delay},Animator$1.prototype.getLoop=function(){return this._loop},Animator$1.prototype.getTarget=function(){return this._target},Animator$1.prototype.changeTarget=function(target){this._target=target},Animator$1.prototype.when=function(time,props,easing){return this.whenWithKeys(time,props,keys(props),easing)},Animator$1.prototype.whenWithKeys=function(time,props,propNames,easing){for(var tracks=this._tracks,i$1=0;i$1<propNames.length;i$1++){var propName=propNames[i$1],track$1=tracks[propName];if(!track$1){track$1=tracks[propName]=new Track(propName);var initialValue=void 0,additiveTrack=this._getAdditiveTrack(propName);if(additiveTrack){var addtiveTrackKfs=additiveTrack.keyframes,lastFinalKf=addtiveTrackKfs[addtiveTrackKfs.length-1];initialValue=lastFinalKf&&lastFinalKf.value,additiveTrack.valType===VALUE_TYPE_COLOR&&initialValue&&(initialValue=rgba2String(initialValue))}else initialValue=this._target[propName];if(initialValue==null)continue;time>0&&track$1.addKeyframe(0,cloneValue(initialValue),easing),this._trackKeys.push(propName)}track$1.addKeyframe(time,cloneValue(props[propName]),easing)}return this._maxTime=Math.max(this._maxTime,time),this},Animator$1.prototype.pause=function(){this._clip.pause(),this._paused=!0},Animator$1.prototype.resume=function(){this._clip.resume(),this._paused=!1},Animator$1.prototype.isPaused=function(){return!!this._paused},Animator$1.prototype.duration=function(duration){return this._maxTime=duration,this._force=!0,this},Animator$1.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var doneList=this._doneCbs;if(doneList)for(var len$1=doneList.length,i$1=0;i$1<len$1;i$1++)doneList[i$1].call(this)},Animator$1.prototype._abortedCallback=function(){this._setTracksFinished();var animation=this.animation,abortedList=this._abortedCbs;if(animation&&animation.removeClip(this._clip),this._clip=null,abortedList)for(var i$1=0;i$1<abortedList.length;i$1++)abortedList[i$1].call(this)},Animator$1.prototype._setTracksFinished=function(){for(var tracks=this._tracks,tracksKeys=this._trackKeys,i$1=0;i$1<tracksKeys.length;i$1++)tracks[tracksKeys[i$1]].setFinished()},Animator$1.prototype._getAdditiveTrack=function(trackName){var additiveTrack,additiveAnimators=this._additiveAnimators;if(additiveAnimators)for(var i$1=0;i$1<additiveAnimators.length;i$1++){var track$1=additiveAnimators[i$1].getTrack(trackName);track$1&&(additiveTrack=track$1)}return additiveTrack},Animator$1.prototype.start=function(easing){if(!(this._started>0)){this._started=1;for(var self$1=this,tracks=[],maxTime=this._maxTime||0,i$1=0;i$1<this._trackKeys.length;i$1++){var propName=this._trackKeys[i$1],track$1=this._tracks[propName],additiveTrack=this._getAdditiveTrack(propName),kfs=track$1.keyframes,kfsNum=kfs.length;if(track$1.prepare(maxTime,additiveTrack),track$1.needsAnimate())if(!this._allowDiscrete&&track$1.discrete){var lastKf=kfs[kfsNum-1];lastKf&&(self$1._target[track$1.propName]=lastKf.rawValue),track$1.setFinished()}else tracks.push(track$1)}if(tracks.length||this._force){var clip$1=new Clip_default({life:maxTime,loop:this._loop,delay:this._delay||0,onframe:function(percent){self$1._started=2;var additiveAnimators=self$1._additiveAnimators;if(additiveAnimators){for(var stillHasAdditiveAnimator=!1,i$2=0;i$2<additiveAnimators.length;i$2++)if(additiveAnimators[i$2]._clip){stillHasAdditiveAnimator=!0;break}stillHasAdditiveAnimator||(self$1._additiveAnimators=null)}for(var i$2=0;i$2<tracks.length;i$2++)tracks[i$2].step(self$1._target,percent);var onframeList=self$1._onframeCbs;if(onframeList)for(var i$2=0;i$2<onframeList.length;i$2++)onframeList[i$2](self$1._target,percent)},ondestroy:function(){self$1._doneCallback()}});this._clip=clip$1,this.animation&&this.animation.addClip(clip$1),easing&&clip$1.setEasing(easing)}else this._doneCallback();return this}},Animator$1.prototype.stop=function(forwardToLast){if(this._clip){var clip$1=this._clip;forwardToLast&&clip$1.onframe(1),this._abortedCallback()}},Animator$1.prototype.delay=function(time){return this._delay=time,this},Animator$1.prototype.during=function(cb){return cb&&(this._onframeCbs||=[],this._onframeCbs.push(cb)),this},Animator$1.prototype.done=function(cb){return cb&&(this._doneCbs||=[],this._doneCbs.push(cb)),this},Animator$1.prototype.aborted=function(cb){return cb&&(this._abortedCbs||=[],this._abortedCbs.push(cb)),this},Animator$1.prototype.getClip=function(){return this._clip},Animator$1.prototype.getTrack=function(propName){return this._tracks[propName]},Animator$1.prototype.getTracks=function(){var _this=this;return map(this._trackKeys,function(key$1){return _this._tracks[key$1]})},Animator$1.prototype.stopTracks=function(propNames,forwardToLast){if(!propNames.length||!this._clip)return!0;for(var tracks=this._tracks,tracksKeys=this._trackKeys,i$1=0;i$1<propNames.length;i$1++){var track$1=tracks[propNames[i$1]];track$1&&!track$1.isFinished()&&(forwardToLast?track$1.step(this._target,1):this._started===1&&track$1.step(this._target,0),track$1.setFinished())}for(var allAborted=!0,i$1=0;i$1<tracksKeys.length;i$1++)if(!tracks[tracksKeys[i$1]].isFinished()){allAborted=!1;break}return allAborted&&this._abortedCallback(),allAborted},Animator$1.prototype.saveTo=function(target,trackKeys,firstOrLast){if(target){trackKeys||=this._trackKeys;for(var i$1=0;i$1<trackKeys.length;i$1++){var propName=trackKeys[i$1],track$1=this._tracks[propName];if(!(!track$1||track$1.isFinished())){var kfs=track$1.keyframes,kf=kfs[firstOrLast?0:kfs.length-1];kf&&(target[propName]=cloneValue(kf.rawValue))}}}},Animator$1.prototype.__changeFinalValue=function(finalProps,trackKeys){trackKeys||=keys(finalProps);for(var i$1=0;i$1<trackKeys.length;i$1++){var propName=trackKeys[i$1],track$1=this._tracks[propName];if(track$1){var kfs=track$1.keyframes;if(kfs.length>1){var lastKf=kfs.pop();track$1.addKeyframe(lastKf.time,finalProps[propName]),track$1.prepare(this._maxTime,track$1.getAdditiveTrack())}}}},Animator$1}();function getTime(){return new Date().getTime()}var Animation_default=function(_super){__extends(Animation$1,_super);function Animation$1(opts){var _this=_super.call(this)||this;return _this._running=!1,_this._time=0,_this._pausedTime=0,_this._pauseStart=0,_this._paused=!1,opts||={},_this.stage=opts.stage||{},_this}return Animation$1.prototype.addClip=function(clip$1){clip$1.animation&&this.removeClip(clip$1),this._head?(this._tail.next=clip$1,clip$1.prev=this._tail,clip$1.next=null,this._tail=clip$1):this._head=this._tail=clip$1,clip$1.animation=this},Animation$1.prototype.addAnimator=function(animator){animator.animation=this;var clip$1=animator.getClip();clip$1&&this.addClip(clip$1)},Animation$1.prototype.removeClip=function(clip$1){if(clip$1.animation){var prev=clip$1.prev,next=clip$1.next;prev?prev.next=next:this._head=next,next?next.prev=prev:this._tail=prev,clip$1.next=clip$1.prev=clip$1.animation=null}},Animation$1.prototype.removeAnimator=function(animator){var clip$1=animator.getClip();clip$1&&this.removeClip(clip$1),animator.animation=null},Animation$1.prototype.update=function(notTriggerFrameAndStageUpdate){for(var time=getTime()-this._pausedTime,delta=time-this._time,clip$1=this._head;clip$1;){var nextClip=clip$1.next;clip$1.step(time,delta)?(clip$1.ondestroy(),this.removeClip(clip$1),clip$1=nextClip):clip$1=nextClip}this._time=time,notTriggerFrameAndStageUpdate||(this.trigger(`frame`,delta),this.stage.update&&this.stage.update())},Animation$1.prototype._startLoop=function(){var self$1=this;this._running=!0;function step(){self$1._running&&(requestAnimationFrame_default(step),!self$1._paused&&self$1.update())}requestAnimationFrame_default(step)},Animation$1.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},Animation$1.prototype.stop=function(){this._running=!1},Animation$1.prototype.pause=function(){this._paused||=(this._pauseStart=getTime(),!0)},Animation$1.prototype.resume=function(){this._paused&&=(this._pausedTime+=getTime()-this._pauseStart,!1)},Animation$1.prototype.clear=function(){for(var clip$1=this._head;clip$1;){var nextClip=clip$1.next;clip$1.prev=clip$1.next=clip$1.animation=null,clip$1=nextClip}this._head=this._tail=null},Animation$1.prototype.isFinished=function(){return this._head==null},Animation$1.prototype.animate=function(target,options){options||={},this.start();var animator=new Animator_default(target,options.loop);return this.addAnimator(animator),animator},Animation$1}(Eventful_default),TOUCH_CLICK_DELAY=300,globalEventSupported=env_default.domSupported,localNativeListenerNames=(function(){var mouseHandlerNames=[`click`,`dblclick`,`mousewheel`,`wheel`,`mouseout`,`mouseup`,`mousedown`,`mousemove`,`contextmenu`],touchHandlerNames=[`touchstart`,`touchend`,`touchmove`],pointerEventNameMap={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},pointerHandlerNames=map(mouseHandlerNames,function(name){var nm=name.replace(`mouse`,`pointer`);return pointerEventNameMap.hasOwnProperty(nm)?nm:name});return{mouse:mouseHandlerNames,touch:touchHandlerNames,pointer:pointerHandlerNames}})(),globalNativeListenerNames={mouse:[`mousemove`,`mouseup`],pointer:[`pointermove`,`pointerup`]},wheelEventSupported=!1;function isPointerFromTouch(event){var pointerType=event.pointerType;return pointerType===`pen`||pointerType===`touch`}function setTouchTimer(scope){scope.touching=!0,scope.touchTimer!=null&&(clearTimeout(scope.touchTimer),scope.touchTimer=null),scope.touchTimer=setTimeout(function(){scope.touching=!1,scope.touchTimer=null},700)}function markTouch(event){event&&(event.zrByTouch=!0)}function normalizeGlobalEvent(instance,event){return normalizeEvent(instance.dom,new FakeGlobalEvent(instance,event),!0)}function isLocalEl(instance,el){for(var elTmp=el,isLocal=!1;elTmp&&elTmp.nodeType!==9&&!(isLocal=elTmp.domBelongToZr||elTmp!==el&&elTmp===instance.painterRoot);)elTmp=elTmp.parentNode;return isLocal}var FakeGlobalEvent=function(){function FakeGlobalEvent$1(instance,event){this.stopPropagation=noop,this.stopImmediatePropagation=noop,this.preventDefault=noop,this.type=event.type,this.target=this.currentTarget=instance.dom,this.pointerType=event.pointerType,this.clientX=event.clientX,this.clientY=event.clientY}return FakeGlobalEvent$1}(),localDOMHandlers={mousedown:function(event){event=normalizeEvent(this.dom,event),this.__mayPointerCapture=[event.zrX,event.zrY],this.trigger(`mousedown`,event)},mousemove:function(event){event=normalizeEvent(this.dom,event);var downPoint=this.__mayPointerCapture;downPoint&&(event.zrX!==downPoint[0]||event.zrY!==downPoint[1])&&this.__togglePointerCapture(!0),this.trigger(`mousemove`,event)},mouseup:function(event){event=normalizeEvent(this.dom,event),this.__togglePointerCapture(!1),this.trigger(`mouseup`,event)},mouseout:function(event){event=normalizeEvent(this.dom,event);var element=event.toElement||event.relatedTarget;isLocalEl(this,element)||(this.__pointerCapturing&&(event.zrEventControl=`no_globalout`),this.trigger(`mouseout`,event))},wheel:function(event){wheelEventSupported=!0,event=normalizeEvent(this.dom,event),this.trigger(`mousewheel`,event)},mousewheel:function(event){wheelEventSupported||(event=normalizeEvent(this.dom,event),this.trigger(`mousewheel`,event))},touchstart:function(event){event=normalizeEvent(this.dom,event),markTouch(event),this.__lastTouchMoment=new Date,this.handler.processGesture(event,`start`),localDOMHandlers.mousemove.call(this,event),localDOMHandlers.mousedown.call(this,event)},touchmove:function(event){event=normalizeEvent(this.dom,event),markTouch(event),this.handler.processGesture(event,`change`),localDOMHandlers.mousemove.call(this,event)},touchend:function(event){event=normalizeEvent(this.dom,event),markTouch(event),this.handler.processGesture(event,`end`),localDOMHandlers.mouseup.call(this,event),new Date-+this.__lastTouchMoment<TOUCH_CLICK_DELAY&&localDOMHandlers.click.call(this,event)},pointerdown:function(event){localDOMHandlers.mousedown.call(this,event)},pointermove:function(event){isPointerFromTouch(event)||localDOMHandlers.mousemove.call(this,event)},pointerup:function(event){localDOMHandlers.mouseup.call(this,event)},pointerout:function(event){isPointerFromTouch(event)||localDOMHandlers.mouseout.call(this,event)}};each([`click`,`dblclick`,`contextmenu`],function(name){localDOMHandlers[name]=function(event){event=normalizeEvent(this.dom,event),this.trigger(name,event)}});var globalDOMHandlers={pointermove:function(event){isPointerFromTouch(event)||globalDOMHandlers.mousemove.call(this,event)},pointerup:function(event){globalDOMHandlers.mouseup.call(this,event)},mousemove:function(event){this.trigger(`mousemove`,event)},mouseup:function(event){var pointerCaptureReleasing=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger(`mouseup`,event),pointerCaptureReleasing&&(event.zrEventControl=`only_globalout`,this.trigger(`mouseout`,event))}};function mountLocalDOMEventListeners(instance,scope){var domHandlers=scope.domHandlers;env_default.pointerEventsSupported?each(localNativeListenerNames.pointer,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){domHandlers[nativeEventName].call(instance,event)})}):(env_default.touchEventsSupported&&each(localNativeListenerNames.touch,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){domHandlers[nativeEventName].call(instance,event),setTouchTimer(scope)})}),each(localNativeListenerNames.mouse,function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,function(event){event=getNativeEvent(event),scope.touching||domHandlers[nativeEventName].call(instance,event)})}))}function mountGlobalDOMEventListeners(instance,scope){env_default.pointerEventsSupported?each(globalNativeListenerNames.pointer,mount):env_default.touchEventsSupported||each(globalNativeListenerNames.mouse,mount);function mount(nativeEventName){function nativeEventListener(event){event=getNativeEvent(event),isLocalEl(instance,event.target)||(event=normalizeGlobalEvent(instance,event),scope.domHandlers[nativeEventName].call(instance,event))}mountSingleDOMEventListener(scope,nativeEventName,nativeEventListener,{capture:!0})}}function mountSingleDOMEventListener(scope,nativeEventName,listener,opt){scope.mounted[nativeEventName]=listener,scope.listenerOpts[nativeEventName]=opt,addEventListener(scope.domTarget,nativeEventName,listener,opt)}function unmountDOMEventListeners(scope){var mounted=scope.mounted;for(var nativeEventName in mounted)mounted.hasOwnProperty(nativeEventName)&&removeEventListener(scope.domTarget,nativeEventName,mounted[nativeEventName],scope.listenerOpts[nativeEventName]);scope.mounted={}}var DOMHandlerScope=function(){function DOMHandlerScope$1(domTarget,domHandlers){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=domTarget,this.domHandlers=domHandlers}return DOMHandlerScope$1}(),HandlerProxy_default=function(_super){__extends(HandlerDomProxy$1,_super);function HandlerDomProxy$1(dom,painterRoot){var _this=_super.call(this)||this;return _this.__pointerCapturing=!1,_this.dom=dom,_this.painterRoot=painterRoot,_this._localHandlerScope=new DOMHandlerScope(dom,localDOMHandlers),globalEventSupported&&(_this._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(_this,_this._localHandlerScope),_this}return HandlerDomProxy$1.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},HandlerDomProxy$1.prototype.setCursor=function(cursorStyle){this.dom.style&&(this.dom.style.cursor=cursorStyle||`default`)},HandlerDomProxy$1.prototype.__togglePointerCapture=function(isPointerCapturing){if(this.__mayPointerCapture=null,globalEventSupported&&this.__pointerCapturing^+isPointerCapturing){this.__pointerCapturing=isPointerCapturing;var globalHandlerScope=this._globalHandlerScope;isPointerCapturing?mountGlobalDOMEventListeners(this,globalHandlerScope):unmountDOMEventListeners(globalHandlerScope)}},HandlerDomProxy$1}(Eventful_default),dpr=1;env_default.hasGlobalWindow&&(dpr=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var devicePixelRatio=dpr,DARK_MODE_THRESHOLD=.4,DARK_LABEL_COLOR=`#333`,LIGHT_LABEL_COLOR=`#ccc`,LIGHTER_LABEL_COLOR=`#eee`,mIdentity=identity,EPSILON$1=5e-5;function isNotAroundZero(val){return val>EPSILON$1||val<-EPSILON$1}var scaleTmp=[],tmpTransform=[],originTransform=create$1(),abs=Math.abs,Transformable=function(){function Transformable$1(){}return Transformable$1.prototype.getLocalTransform=function(m$2){return Transformable$1.getLocalTransform(this,m$2)},Transformable$1.prototype.setPosition=function(arr){this.x=arr[0],this.y=arr[1]},Transformable$1.prototype.setScale=function(arr){this.scaleX=arr[0],this.scaleY=arr[1]},Transformable$1.prototype.setSkew=function(arr){this.skewX=arr[0],this.skewY=arr[1]},Transformable$1.prototype.setOrigin=function(arr){this.originX=arr[0],this.originY=arr[1]},Transformable$1.prototype.needLocalTransform=function(){return isNotAroundZero(this.rotation)||isNotAroundZero(this.x)||isNotAroundZero(this.y)||isNotAroundZero(this.scaleX-1)||isNotAroundZero(this.scaleY-1)||isNotAroundZero(this.skewX)||isNotAroundZero(this.skewY)},Transformable$1.prototype.updateTransform=function(){var parentTransform=this.parent&&this.parent.transform,needLocalTransform=this.needLocalTransform(),m$2=this.transform;if(!(needLocalTransform||parentTransform)){m$2&&(mIdentity(m$2),this.invTransform=null);return}m$2||=create$1(),needLocalTransform?this.getLocalTransform(m$2):mIdentity(m$2),parentTransform&&(needLocalTransform?mul(m$2,parentTransform,m$2):copy(m$2,parentTransform)),this.transform=m$2,this._resolveGlobalScaleRatio(m$2)},Transformable$1.prototype._resolveGlobalScaleRatio=function(m$2){var globalScaleRatio=this.globalScaleRatio;if(globalScaleRatio!=null&&globalScaleRatio!==1){this.getGlobalScale(scaleTmp);var relX=scaleTmp[0]<0?-1:1,relY=scaleTmp[1]<0?-1:1,sx=((scaleTmp[0]-relX)*globalScaleRatio+relX)/scaleTmp[0]||0,sy=((scaleTmp[1]-relY)*globalScaleRatio+relY)/scaleTmp[1]||0;m$2[0]*=sx,m$2[1]*=sx,m$2[2]*=sy,m$2[3]*=sy}this.invTransform=this.invTransform||create$1(),invert(this.invTransform,m$2)},Transformable$1.prototype.getComputedTransform=function(){for(var transformNode=this,ancestors=[];transformNode;)ancestors.push(transformNode),transformNode=transformNode.parent;for(;transformNode=ancestors.pop();)transformNode.updateTransform();return this.transform},Transformable$1.prototype.setLocalTransform=function(m$2){if(m$2){var sx=m$2[0]*m$2[0]+m$2[1]*m$2[1],sy=m$2[2]*m$2[2]+m$2[3]*m$2[3],rotation=Math.atan2(m$2[1],m$2[0]),shearX=Math.PI/2+rotation-Math.atan2(m$2[3],m$2[2]);sy=Math.sqrt(sy)*Math.cos(shearX),sx=Math.sqrt(sx),this.skewX=shearX,this.skewY=0,this.rotation=-rotation,this.x=+m$2[4],this.y=+m$2[5],this.scaleX=sx,this.scaleY=sy,this.originX=0,this.originY=0}},Transformable$1.prototype.decomposeTransform=function(){if(this.transform){var parent=this.parent,m$2=this.transform;parent&&parent.transform&&(parent.invTransform=parent.invTransform||create$1(),mul(tmpTransform,parent.invTransform,m$2),m$2=tmpTransform);var ox=this.originX,oy=this.originY;(ox||oy)&&(originTransform[4]=ox,originTransform[5]=oy,mul(tmpTransform,m$2,originTransform),tmpTransform[4]-=ox,tmpTransform[5]-=oy,m$2=tmpTransform),this.setLocalTransform(m$2)}},Transformable$1.prototype.getGlobalScale=function(out$2){var m$2=this.transform;return out$2||=[],m$2?(out$2[0]=Math.sqrt(m$2[0]*m$2[0]+m$2[1]*m$2[1]),out$2[1]=Math.sqrt(m$2[2]*m$2[2]+m$2[3]*m$2[3]),m$2[0]<0&&(out$2[0]=-out$2[0]),m$2[3]<0&&(out$2[1]=-out$2[1]),out$2):(out$2[0]=1,out$2[1]=1,out$2)},Transformable$1.prototype.transformCoordToLocal=function(x$1,y$1){var v2=[x$1,y$1],invTransform=this.invTransform;return invTransform&&applyTransform(v2,v2,invTransform),v2},Transformable$1.prototype.transformCoordToGlobal=function(x$1,y$1){var v2=[x$1,y$1],transform=this.transform;return transform&&applyTransform(v2,v2,transform),v2},Transformable$1.prototype.getLineScale=function(){var m$2=this.transform;return m$2&&abs(m$2[0]-1)>1e-10&&abs(m$2[3]-1)>1e-10?Math.sqrt(abs(m$2[0]*m$2[3]-m$2[2]*m$2[1])):1},Transformable$1.prototype.copyTransform=function(source$2){copyTransform(this,source$2)},Transformable$1.getLocalTransform=function(target,m$2){m$2||=[];var ox=target.originX||0,oy=target.originY||0,sx=target.scaleX,sy=target.scaleY,ax=target.anchorX,ay=target.anchorY,rotation=target.rotation||0,x$1=target.x,y$1=target.y,skewX=target.skewX?Math.tan(target.skewX):0,skewY=target.skewY?Math.tan(-target.skewY):0;if(ox||oy||ax||ay){var dx=ox+ax,dy=oy+ay;m$2[4]=-dx*sx-skewX*dy*sy,m$2[5]=-dy*sy-skewY*dx*sx}else m$2[4]=m$2[5]=0;return m$2[0]=sx,m$2[3]=sy,m$2[1]=skewY*sx,m$2[2]=skewX*sy,rotation&&rotate(m$2,m$2,rotation),m$2[4]+=ox+x$1,m$2[5]+=oy+y$1,m$2},Transformable$1.initDefaultProps=(function(){var proto=Transformable$1.prototype;proto.scaleX=proto.scaleY=proto.globalScaleRatio=1,proto.x=proto.y=proto.originX=proto.originY=proto.skewX=proto.skewY=proto.rotation=proto.anchorX=proto.anchorY=0})(),Transformable$1}(),TRANSFORMABLE_PROPS=[`x`,`y`,`originX`,`originY`,`anchorX`,`anchorY`,`rotation`,`scaleX`,`scaleY`,`skewX`,`skewY`];function copyTransform(target,source$2){for(var i$1=0;i$1<TRANSFORMABLE_PROPS.length;i$1++){var propName=TRANSFORMABLE_PROPS[i$1];target[propName]=source$2[propName]}}var Transformable_default=Transformable;function ensureFontMeasureInfo(font){_fontMeasureInfoCache||=new LRU_default(100),font||=`12px sans-serif`;var measureInfo=_fontMeasureInfoCache.get(font);return measureInfo||(measureInfo={font,strWidthCache:new LRU_default(500),asciiWidthMap:null,asciiWidthMapTried:!1,stWideCharWidth:platformApi.measureText(``,font).width,asciiCharWidth:platformApi.measureText(`a`,font).width},_fontMeasureInfoCache.put(font,measureInfo)),measureInfo}var _fontMeasureInfoCache;function tryCreateASCIIWidthMap(font){if(!(_getASCIIWidthMapLongCount>=GET_ASCII_WIDTH_LONG_COUNT_MAX)){font||=`12px sans-serif`;for(var asciiWidthMap=[],start$1=+new Date,code=0;code<=127;code++)asciiWidthMap[code]=platformApi.measureText(String.fromCharCode(code),font).width;var cost=+new Date-start$1;return cost>16?_getASCIIWidthMapLongCount=GET_ASCII_WIDTH_LONG_COUNT_MAX:cost>2&&_getASCIIWidthMapLongCount++,asciiWidthMap}}var _getASCIIWidthMapLongCount=0,GET_ASCII_WIDTH_LONG_COUNT_MAX=5;function measureCharWidth(fontMeasureInfo,charCode){return fontMeasureInfo.asciiWidthMapTried||=(fontMeasureInfo.asciiWidthMap=tryCreateASCIIWidthMap(fontMeasureInfo.font),!0),0<=charCode&&charCode<=127?fontMeasureInfo.asciiWidthMap==null?fontMeasureInfo.asciiCharWidth:fontMeasureInfo.asciiWidthMap[charCode]:fontMeasureInfo.stWideCharWidth}function measureWidth(fontMeasureInfo,text){var strWidthCache=fontMeasureInfo.strWidthCache,width=strWidthCache.get(text);return width??(width=platformApi.measureText(text,fontMeasureInfo.font).width,strWidthCache.put(text,width)),width}function innerGetBoundingRect(text,font,textAlign,textBaseline){var width=measureWidth(ensureFontMeasureInfo(font),text),height=getLineHeight(font),x$1=adjustTextX(0,width,textAlign),y$1=adjustTextY(0,height,textBaseline);return new BoundingRect_default(x$1,y$1,width,height)}function getBoundingRect(text,font,textAlign,textBaseline){var textLines=((text||``)+``).split(`
`);if(textLines.length===1)return innerGetBoundingRect(textLines[0],font,textAlign,textBaseline);for(var uniondRect=new BoundingRect_default(0,0,0,0),i$1=0;i$1<textLines.length;i$1++){var rect=innerGetBoundingRect(textLines[i$1],font,textAlign,textBaseline);i$1===0?uniondRect.copy(rect):uniondRect.union(rect)}return uniondRect}function adjustTextX(x$1,width,textAlign,inverse){return textAlign===`right`?inverse?x$1+=width:x$1-=width:textAlign===`center`&&(inverse?x$1+=width/2:x$1-=width/2),x$1}function adjustTextY(y$1,height,verticalAlign,inverse){return verticalAlign===`middle`?inverse?y$1+=height/2:y$1-=height/2:verticalAlign===`bottom`&&(inverse?y$1+=height:y$1-=height),y$1}function getLineHeight(font){return ensureFontMeasureInfo(font).stWideCharWidth}function parsePercent$1(value,maxValue){return typeof value==`string`?value.lastIndexOf(`%`)>=0?parseFloat(value)/100*maxValue:parseFloat(value):value}function calculateTextPosition(out$2,opts,rect){var textPosition=opts.position||`inside`,distance$1=opts.distance==null?5:opts.distance,height=rect.height,width=rect.width,halfHeight=height/2,x$1=rect.x,y$1=rect.y,textAlign=`left`,textVerticalAlign=`top`;if(textPosition instanceof Array)x$1+=parsePercent$1(textPosition[0],rect.width),y$1+=parsePercent$1(textPosition[1],rect.height),textAlign=null,textVerticalAlign=null;else switch(textPosition){case`left`:x$1-=distance$1,y$1+=halfHeight,textAlign=`right`,textVerticalAlign=`middle`;break;case`right`:x$1+=distance$1+width,y$1+=halfHeight,textVerticalAlign=`middle`;break;case`top`:x$1+=width/2,y$1-=distance$1,textAlign=`center`,textVerticalAlign=`bottom`;break;case`bottom`:x$1+=width/2,y$1+=height+distance$1,textAlign=`center`;break;case`inside`:x$1+=width/2,y$1+=halfHeight,textAlign=`center`,textVerticalAlign=`middle`;break;case`insideLeft`:x$1+=distance$1,y$1+=halfHeight,textVerticalAlign=`middle`;break;case`insideRight`:x$1+=width-distance$1,y$1+=halfHeight,textAlign=`right`,textVerticalAlign=`middle`;break;case`insideTop`:x$1+=width/2,y$1+=distance$1,textAlign=`center`;break;case`insideBottom`:x$1+=width/2,y$1+=height-distance$1,textAlign=`center`,textVerticalAlign=`bottom`;break;case`insideTopLeft`:x$1+=distance$1,y$1+=distance$1;break;case`insideTopRight`:x$1+=width-distance$1,y$1+=distance$1,textAlign=`right`;break;case`insideBottomLeft`:x$1+=distance$1,y$1+=height-distance$1,textVerticalAlign=`bottom`;break;case`insideBottomRight`:x$1+=width-distance$1,y$1+=height-distance$1,textAlign=`right`,textVerticalAlign=`bottom`;break}return out$2||={},out$2.x=x$1,out$2.y=y$1,out$2.align=textAlign,out$2.verticalAlign=textVerticalAlign,out$2}var PRESERVED_NORMAL_STATE=`__zr_normal__`,PRIMARY_STATES_KEYS$1=TRANSFORMABLE_PROPS.concat([`ignore`]),DEFAULT_ANIMATABLE_MAP=reduce(TRANSFORMABLE_PROPS,function(obj,key$1){return obj[key$1]=!0,obj},{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect_default(0,0,0,0),tmpInnerTextTrans=[],Element$1=function(){function Element$2(props){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(props)}return Element$2.prototype._init=function(props){this.attr(props)},Element$2.prototype.drift=function(dx,dy,e$2){switch(this.draggable){case`horizontal`:dy=0;break;case`vertical`:dx=0;break}var m$2=this.transform;m$2||=this.transform=[1,0,0,1,0,0],m$2[4]+=dx,m$2[5]+=dy,this.decomposeTransform(),this.markRedraw()},Element$2.prototype.beforeUpdate=function(){},Element$2.prototype.afterUpdate=function(){},Element$2.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},Element$2.prototype.updateInnerText=function(forceUpdate){var textEl=this._textContent;if(textEl&&(!textEl.ignore||forceUpdate)){this.textConfig||={};var textConfig=this.textConfig,isLocal=textConfig.local,innerTransformable=textEl.innerTransformable,textAlign=void 0,textVerticalAlign=void 0,textStyleChanged=!1;innerTransformable.parent=isLocal?this:null;var innerOrigin=!1;innerTransformable.copyTransform(textEl);var hasPosition=textConfig.position!=null,autoOverflowArea=textConfig.autoOverflowArea,layoutRect=void 0;if((autoOverflowArea||hasPosition)&&(layoutRect=tmpBoundingRect,textConfig.layoutRect?layoutRect.copy(textConfig.layoutRect):layoutRect.copy(this.getBoundingRect()),isLocal||layoutRect.applyTransform(this.transform)),hasPosition){this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,textConfig,layoutRect):calculateTextPosition(tmpTextPosCalcRes,textConfig,layoutRect),innerTransformable.x=tmpTextPosCalcRes.x,innerTransformable.y=tmpTextPosCalcRes.y,textAlign=tmpTextPosCalcRes.align,textVerticalAlign=tmpTextPosCalcRes.verticalAlign;var textOrigin=textConfig.origin;if(textOrigin&&textConfig.rotation!=null){var relOriginX=void 0,relOriginY=void 0;textOrigin===`center`?(relOriginX=layoutRect.width*.5,relOriginY=layoutRect.height*.5):(relOriginX=parsePercent$1(textOrigin[0],layoutRect.width),relOriginY=parsePercent$1(textOrigin[1],layoutRect.height)),innerOrigin=!0,innerTransformable.originX=-innerTransformable.x+relOriginX+(isLocal?0:layoutRect.x),innerTransformable.originY=-innerTransformable.y+relOriginY+(isLocal?0:layoutRect.y)}}textConfig.rotation!=null&&(innerTransformable.rotation=textConfig.rotation);var textOffset=textConfig.offset;textOffset&&(innerTransformable.x+=textOffset[0],innerTransformable.y+=textOffset[1],innerOrigin||(innerTransformable.originX=-textOffset[0],innerTransformable.originY=-textOffset[1]));var innerTextDefaultStyle=this._innerTextDefaultStyle||={};if(autoOverflowArea){var overflowRect=innerTextDefaultStyle.overflowRect=innerTextDefaultStyle.overflowRect||new BoundingRect_default(0,0,0,0);innerTransformable.getLocalTransform(tmpInnerTextTrans),invert(tmpInnerTextTrans,tmpInnerTextTrans),BoundingRect_default.copy(overflowRect,layoutRect),overflowRect.applyTransform(tmpInnerTextTrans)}else innerTextDefaultStyle.overflowRect=null;var isInside=textConfig.inside==null?typeof textConfig.position==`string`&&textConfig.position.indexOf(`inside`)>=0:textConfig.inside,textFill=void 0,textStroke=void 0,autoStroke=void 0;isInside&&this.canBeInsideText()?(textFill=textConfig.insideFill,textStroke=textConfig.insideStroke,(textFill==null||textFill===`auto`)&&(textFill=this.getInsideTextFill()),(textStroke==null||textStroke===`auto`)&&(textStroke=this.getInsideTextStroke(textFill),autoStroke=!0)):(textFill=textConfig.outsideFill,textStroke=textConfig.outsideStroke,(textFill==null||textFill===`auto`)&&(textFill=this.getOutsideFill()),(textStroke==null||textStroke===`auto`)&&(textStroke=this.getOutsideStroke(textFill),autoStroke=!0)),textFill||=`#000`,(textFill!==innerTextDefaultStyle.fill||textStroke!==innerTextDefaultStyle.stroke||autoStroke!==innerTextDefaultStyle.autoStroke||textAlign!==innerTextDefaultStyle.align||textVerticalAlign!==innerTextDefaultStyle.verticalAlign)&&(textStyleChanged=!0,innerTextDefaultStyle.fill=textFill,innerTextDefaultStyle.stroke=textStroke,innerTextDefaultStyle.autoStroke=autoStroke,innerTextDefaultStyle.align=textAlign,innerTextDefaultStyle.verticalAlign=textVerticalAlign,textEl.setDefaultTextStyle(innerTextDefaultStyle)),textEl.__dirty|=1,textStyleChanged&&textEl.dirtyStyle(!0)}},Element$2.prototype.canBeInsideText=function(){return!0},Element$2.prototype.getInsideTextFill=function(){return`#fff`},Element$2.prototype.getInsideTextStroke=function(textFill){return`#000`},Element$2.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?LIGHT_LABEL_COLOR:DARK_LABEL_COLOR},Element$2.prototype.getOutsideStroke=function(textFill){var backgroundColor$1=this.__zr&&this.__zr.getBackgroundColor(),colorArr=typeof backgroundColor$1==`string`&&parse(backgroundColor$1);colorArr||=[255,255,255,1];for(var alpha=colorArr[3],isDark=this.__zr.isDarkMode(),i$1=0;i$1<3;i$1++)colorArr[i$1]=colorArr[i$1]*alpha+(isDark?0:255)*(1-alpha);return colorArr[3]=1,stringify(colorArr,`rgba`)},Element$2.prototype.traverse=function(cb,context$1){},Element$2.prototype.attrKV=function(key$1,value){key$1===`textConfig`?this.setTextConfig(value):key$1===`textContent`?this.setTextContent(value):key$1===`clipPath`?this.setClipPath(value):key$1===`extra`?(this.extra=this.extra||{},extend(this.extra,value)):this[key$1]=value},Element$2.prototype.hide=function(){this.ignore=!0,this.markRedraw()},Element$2.prototype.show=function(){this.ignore=!1,this.markRedraw()},Element$2.prototype.attr=function(keyOrObj,value){if(typeof keyOrObj==`string`)this.attrKV(keyOrObj,value);else if(isObject(keyOrObj))for(var keysArr=keys(keyOrObj),i$1=0;i$1<keysArr.length;i$1++){var key$1=keysArr[i$1];this.attrKV(key$1,keyOrObj[key$1])}return this.markRedraw(),this},Element$2.prototype.saveCurrentToNormalState=function(toState){this._innerSaveToNormal(toState);for(var normalState=this._normalState,i$1=0;i$1<this.animators.length;i$1++){var animator=this.animators[i$1],fromStateTransition=animator.__fromStateTransition;if(!(animator.getLoop()||fromStateTransition&&fromStateTransition!==`__zr_normal__`)){var targetName=animator.targetName,target=targetName?normalState[targetName]:normalState;animator.saveTo(target)}}},Element$2.prototype._innerSaveToNormal=function(toState){var normalState=this._normalState;normalState||=this._normalState={},toState.textConfig&&!normalState.textConfig&&(normalState.textConfig=this.textConfig),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS$1)},Element$2.prototype._savePrimaryToNormal=function(toState,normalState,primaryKeys){for(var i$1=0;i$1<primaryKeys.length;i$1++){var key$1=primaryKeys[i$1];toState[key$1]!=null&&!(key$1 in normalState)&&(normalState[key$1]=this[key$1])}},Element$2.prototype.hasState=function(){return this.currentStates.length>0},Element$2.prototype.getState=function(name){return this.states[name]},Element$2.prototype.ensureState=function(name){var states=this.states;return states[name]||(states[name]={}),states[name]},Element$2.prototype.clearStates=function(noAnimation){this.useState(PRESERVED_NORMAL_STATE,!1,noAnimation)},Element$2.prototype.useState=function(stateName,keepCurrentStates,noAnimation,forceUseHoverLayer){var toNormalState=stateName===PRESERVED_NORMAL_STATE;if(!(!this.hasState()&&toNormalState)){var currentStates=this.currentStates,animationCfg=this.stateTransition;if(!(indexOf(currentStates,stateName)>=0&&(keepCurrentStates||currentStates.length===1))){var state;if(this.stateProxy&&!toNormalState&&(state=this.stateProxy(stateName)),state||=this.states&&this.states[stateName],!state&&!toNormalState){logError(`State `+stateName+` not exists.`);return}toNormalState||this.saveCurrentToNormalState(state);var useHoverLayer=!!(state&&state.hoverLayer||forceUseHoverLayer);useHoverLayer&&this._toggleHoverLayerFlag(!0),this._applyStateObj(stateName,state,this._normalState,keepCurrentStates,!noAnimation&&!this.__inHover&&animationCfg&&animationCfg.duration>0,animationCfg);var textContent=this._textContent,textGuide=this._textGuide;return textContent&&textContent.useState(stateName,keepCurrentStates,noAnimation,useHoverLayer),textGuide&&textGuide.useState(stateName,keepCurrentStates,noAnimation,useHoverLayer),toNormalState?(this.currentStates=[],this._normalState={}):keepCurrentStates?this.currentStates.push(stateName):this.currentStates=[stateName],this._updateAnimationTargets(),this.markRedraw(),!useHoverLayer&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),state}}},Element$2.prototype.useStates=function(states,noAnimation,forceUseHoverLayer){if(!states.length)this.clearStates();else{var stateObjects=[],currentStates=this.currentStates,len$1=states.length,notChange=len$1===currentStates.length;if(notChange){for(var i$1=0;i$1<len$1;i$1++)if(states[i$1]!==currentStates[i$1]){notChange=!1;break}}if(notChange)return;for(var i$1=0;i$1<len$1;i$1++){var stateName=states[i$1],stateObj=void 0;this.stateProxy&&(stateObj=this.stateProxy(stateName,states)),stateObj||=this.states[stateName],stateObj&&stateObjects.push(stateObj)}var lastStateObj=stateObjects[len$1-1],useHoverLayer=!!(lastStateObj&&lastStateObj.hoverLayer||forceUseHoverLayer);useHoverLayer&&this._toggleHoverLayerFlag(!0);var mergedState=this._mergeStates(stateObjects),animationCfg=this.stateTransition;this.saveCurrentToNormalState(mergedState),this._applyStateObj(states.join(`,`),mergedState,this._normalState,!1,!noAnimation&&!this.__inHover&&animationCfg&&animationCfg.duration>0,animationCfg);var textContent=this._textContent,textGuide=this._textGuide;textContent&&textContent.useStates(states,noAnimation,useHoverLayer),textGuide&&textGuide.useStates(states,noAnimation,useHoverLayer),this._updateAnimationTargets(),this.currentStates=states.slice(),this.markRedraw(),!useHoverLayer&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}},Element$2.prototype.isSilent=function(){for(var el=this;el;){if(el.silent)return!0;var hostEl=el.__hostTarget;el=hostEl?el.ignoreHostSilent?null:hostEl:el.parent}return!1},Element$2.prototype._updateAnimationTargets=function(){for(var i$1=0;i$1<this.animators.length;i$1++){var animator=this.animators[i$1];animator.targetName&&animator.changeTarget(this[animator.targetName])}},Element$2.prototype.removeState=function(state){var idx=indexOf(this.currentStates,state);if(idx>=0){var currentStates=this.currentStates.slice();currentStates.splice(idx,1),this.useStates(currentStates)}},Element$2.prototype.replaceState=function(oldState,newState,forceAdd){var currentStates=this.currentStates.slice(),idx=indexOf(currentStates,oldState),newStateExists=indexOf(currentStates,newState)>=0;idx>=0?newStateExists?currentStates.splice(idx,1):currentStates[idx]=newState:forceAdd&&!newStateExists&&currentStates.push(newState),this.useStates(currentStates)},Element$2.prototype.toggleState=function(state,enable){enable?this.useState(state,!0):this.removeState(state)},Element$2.prototype._mergeStates=function(states){for(var mergedState={},mergedTextConfig,i$1=0;i$1<states.length;i$1++){var state=states[i$1];extend(mergedState,state),state.textConfig&&(mergedTextConfig||={},extend(mergedTextConfig,state.textConfig))}return mergedTextConfig&&(mergedState.textConfig=mergedTextConfig),mergedState},Element$2.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){var needsRestoreToNormal=!(state&&keepCurrentStates);state&&state.textConfig?(this.textConfig=extend({},keepCurrentStates?this.textConfig:normalState.textConfig),extend(this.textConfig,state.textConfig)):needsRestoreToNormal&&normalState.textConfig&&(this.textConfig=normalState.textConfig);for(var transitionTarget={},hasTransition=!1,i$1=0;i$1<PRIMARY_STATES_KEYS$1.length;i$1++){var key$1=PRIMARY_STATES_KEYS$1[i$1],propNeedsTransition=transition&&DEFAULT_ANIMATABLE_MAP[key$1];state&&state[key$1]!=null?propNeedsTransition?(hasTransition=!0,transitionTarget[key$1]=state[key$1]):this[key$1]=state[key$1]:needsRestoreToNormal&&normalState[key$1]!=null&&(propNeedsTransition?(hasTransition=!0,transitionTarget[key$1]=normalState[key$1]):this[key$1]=normalState[key$1])}if(!transition)for(var i$1=0;i$1<this.animators.length;i$1++){var animator=this.animators[i$1],targetName=animator.targetName;animator.getLoop()||animator.__changeFinalValue(targetName?(state||normalState)[targetName]:state||normalState)}hasTransition&&this._transitionState(stateName,transitionTarget,animationCfg)},Element$2.prototype._attachComponent=function(componentEl){if(!(componentEl.__zr&&!componentEl.__hostTarget)&&componentEl!==this){var zr=this.__zr;zr&&componentEl.addSelfToZr(zr),componentEl.__zr=zr,componentEl.__hostTarget=this}},Element$2.prototype._detachComponent=function(componentEl){componentEl.__zr&&componentEl.removeSelfFromZr(componentEl.__zr),componentEl.__zr=null,componentEl.__hostTarget=null},Element$2.prototype.getClipPath=function(){return this._clipPath},Element$2.prototype.setClipPath=function(clipPath){this._clipPath&&this._clipPath!==clipPath&&this.removeClipPath(),this._attachComponent(clipPath),this._clipPath=clipPath,this.markRedraw()},Element$2.prototype.removeClipPath=function(){var clipPath=this._clipPath;clipPath&&(this._detachComponent(clipPath),this._clipPath=null,this.markRedraw())},Element$2.prototype.getTextContent=function(){return this._textContent},Element$2.prototype.setTextContent=function(textEl){var previousTextContent=this._textContent;previousTextContent!==textEl&&(previousTextContent&&previousTextContent!==textEl&&this.removeTextContent(),textEl.innerTransformable=new Transformable_default,this._attachComponent(textEl),this._textContent=textEl,this.markRedraw())},Element$2.prototype.setTextConfig=function(cfg){this.textConfig||={},extend(this.textConfig,cfg),this.markRedraw()},Element$2.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},Element$2.prototype.removeTextContent=function(){var textEl=this._textContent;textEl&&(textEl.innerTransformable=null,this._detachComponent(textEl),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},Element$2.prototype.getTextGuideLine=function(){return this._textGuide},Element$2.prototype.setTextGuideLine=function(guideLine){this._textGuide&&this._textGuide!==guideLine&&this.removeTextGuideLine(),this._attachComponent(guideLine),this._textGuide=guideLine,this.markRedraw()},Element$2.prototype.removeTextGuideLine=function(){var textGuide=this._textGuide;textGuide&&(this._detachComponent(textGuide),this._textGuide=null,this.markRedraw())},Element$2.prototype.markRedraw=function(){this.__dirty|=1;var zr=this.__zr;zr&&(this.__inHover?zr.refreshHover():zr.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},Element$2.prototype.dirty=function(){this.markRedraw()},Element$2.prototype._toggleHoverLayerFlag=function(inHover){this.__inHover=inHover;var textContent=this._textContent,textGuide=this._textGuide;textContent&&(textContent.__inHover=inHover),textGuide&&(textGuide.__inHover=inHover)},Element$2.prototype.addSelfToZr=function(zr){if(this.__zr!==zr){this.__zr=zr;var animators=this.animators;if(animators)for(var i$1=0;i$1<animators.length;i$1++)zr.animation.addAnimator(animators[i$1]);this._clipPath&&this._clipPath.addSelfToZr(zr),this._textContent&&this._textContent.addSelfToZr(zr),this._textGuide&&this._textGuide.addSelfToZr(zr)}},Element$2.prototype.removeSelfFromZr=function(zr){if(this.__zr){this.__zr=null;var animators=this.animators;if(animators)for(var i$1=0;i$1<animators.length;i$1++)zr.animation.removeAnimator(animators[i$1]);this._clipPath&&this._clipPath.removeSelfFromZr(zr),this._textContent&&this._textContent.removeSelfFromZr(zr),this._textGuide&&this._textGuide.removeSelfFromZr(zr)}},Element$2.prototype.animate=function(key$1,loop,allowDiscreteAnimation){var target=key$1?this[key$1]:this,animator=new Animator_default(target,loop,allowDiscreteAnimation);return key$1&&(animator.targetName=key$1),this.addAnimator(animator,key$1),animator},Element$2.prototype.addAnimator=function(animator,key$1){var zr=this.__zr,el=this;animator.during(function(){el.updateDuringAnimation(key$1)}).done(function(){var animators=el.animators,idx=indexOf(animators,animator);idx>=0&&animators.splice(idx,1)}),this.animators.push(animator),zr&&zr.animation.addAnimator(animator),zr&&zr.wakeUp()},Element$2.prototype.updateDuringAnimation=function(key$1){this.markRedraw()},Element$2.prototype.stopAnimation=function(scope,forwardToLast){for(var animators=this.animators,len$1=animators.length,leftAnimators=[],i$1=0;i$1<len$1;i$1++){var animator=animators[i$1];!scope||scope===animator.scope?animator.stop(forwardToLast):leftAnimators.push(animator)}return this.animators=leftAnimators,this},Element$2.prototype.animateTo=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps)},Element$2.prototype.animateFrom=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps,!0)},Element$2.prototype._transitionState=function(stateName,target,cfg,animationProps){for(var animators=animateTo(this,target,cfg,animationProps),i$1=0;i$1<animators.length;i$1++)animators[i$1].__fromStateTransition=stateName},Element$2.prototype.getBoundingRect=function(){return null},Element$2.prototype.getPaintRect=function(){return null},Element$2.initDefaultProps=(function(){var elProto=Element$2.prototype;elProto.type=`element`,elProto.name=``,elProto.ignore=elProto.silent=elProto.ignoreHostSilent=elProto.isGroup=elProto.draggable=elProto.dragging=elProto.ignoreClip=elProto.__inHover=!1,elProto.__dirty=1;function createLegacyProperty(key$1,privateKey,xKey,yKey){Object.defineProperty(elProto,key$1,{get:function(){if(!this[privateKey]){var pos=this[privateKey]=[];enhanceArray(this,pos)}return this[privateKey]},set:function(pos){this[xKey]=pos[0],this[yKey]=pos[1],this[privateKey]=pos,enhanceArray(this,pos)}});function enhanceArray(self$1,pos){Object.defineProperty(pos,0,{get:function(){return self$1[xKey]},set:function(val){self$1[xKey]=val}}),Object.defineProperty(pos,1,{get:function(){return self$1[yKey]},set:function(val){self$1[yKey]=val}})}}Object.defineProperty&&(createLegacyProperty(`position`,`_legacyPos`,`x`,`y`),createLegacyProperty(`scale`,`_legacyScale`,`scaleX`,`scaleY`),createLegacyProperty(`origin`,`_legacyOrigin`,`originX`,`originY`))})(),Element$2}();mixin(Element$1,Eventful_default),mixin(Element$1,Transformable_default);function animateTo(animatable,target,cfg,animationProps,reverse){cfg||={};var animators=[];animateToShallow(animatable,``,animatable,target,cfg,animationProps,animators,reverse);var finishCount=animators.length,doneHappened=!1,cfgDone=cfg.done,cfgAborted=cfg.aborted,doneCb=function(){doneHappened=!0,finishCount--,finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())},abortedCb=function(){finishCount--,finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())};finishCount||cfgDone&&cfgDone(),animators.length>0&&cfg.during&&animators[0].during(function(target$1,percent){cfg.during(percent)});for(var i$1=0;i$1<animators.length;i$1++){var animator=animators[i$1];doneCb&&animator.done(doneCb),abortedCb&&animator.aborted(abortedCb),cfg.force&&animator.duration(cfg.duration),animator.start(cfg.easing)}return animators}function copyArrShallow(source$2,target,len$1){for(var i$1=0;i$1<len$1;i$1++)source$2[i$1]=target[i$1]}function is2DArray(value){return isArrayLike(value[0])}function copyValue(target,source$2,key$1){if(isArrayLike(source$2[key$1]))if(isArrayLike(target[key$1])||(target[key$1]=[]),isTypedArray(source$2[key$1])){var len$1=source$2[key$1].length;target[key$1].length!==len$1&&(target[key$1]=new source$2[key$1].constructor(len$1),copyArrShallow(target[key$1],source$2[key$1],len$1))}else{var sourceArr=source$2[key$1],targetArr=target[key$1],len0=sourceArr.length;if(is2DArray(sourceArr))for(var len1=sourceArr[0].length,i$1=0;i$1<len0;i$1++)targetArr[i$1]?copyArrShallow(targetArr[i$1],sourceArr[i$1],len1):targetArr[i$1]=Array.prototype.slice.call(sourceArr[i$1]);else copyArrShallow(targetArr,sourceArr,len0);targetArr.length=sourceArr.length}else target[key$1]=source$2[key$1]}function isValueSame(val1,val2){return val1===val2||isArrayLike(val1)&&isArrayLike(val2)&&is1DArraySame(val1,val2)}function is1DArraySame(arr0,arr1){var len$1=arr0.length;if(len$1!==arr1.length)return!1;for(var i$1=0;i$1<len$1;i$1++)if(arr0[i$1]!==arr1[i$1])return!1;return!0}function animateToShallow(animatable,topKey,animateObj,target,cfg,animationProps,animators,reverse){for(var targetKeys=keys(target),duration=cfg.duration,delay=cfg.delay,additive=cfg.additive,setToFinal=cfg.setToFinal,animateAll=!isObject(animationProps),existsAnimators=animatable.animators,animationKeys=[],k$1=0;k$1<targetKeys.length;k$1++){var innerKey=targetKeys[k$1],targetVal=target[innerKey];if(targetVal!=null&&animateObj[innerKey]!=null&&(animateAll||animationProps[innerKey]))if(isObject(targetVal)&&!isArrayLike(targetVal)&&!isGradientObject(targetVal)){if(topKey){reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey));continue}animateToShallow(animatable,innerKey,animateObj[innerKey],targetVal,cfg,animationProps&&animationProps[innerKey],animators,reverse)}else animationKeys.push(innerKey);else reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey),animationKeys.push(innerKey))}var keyLen=animationKeys.length;if(!additive&&keyLen)for(var i$1=0;i$1<existsAnimators.length;i$1++){var animator=existsAnimators[i$1];if(animator.targetName===topKey&&animator.stopTracks(animationKeys)){var idx=indexOf(existsAnimators,animator);existsAnimators.splice(idx,1)}}if(cfg.force||(animationKeys=filter(animationKeys,function(key$1){return!isValueSame(target[key$1],animateObj[key$1])}),keyLen=animationKeys.length),keyLen>0||cfg.force&&!animators.length){var revertedSource=void 0,reversedTarget=void 0,sourceClone=void 0;if(reverse){reversedTarget={},setToFinal&&(revertedSource={});for(var i$1=0;i$1<keyLen;i$1++){var innerKey=animationKeys[i$1];reversedTarget[innerKey]=animateObj[innerKey],setToFinal?revertedSource[innerKey]=target[innerKey]:animateObj[innerKey]=target[innerKey]}}else if(setToFinal){sourceClone={};for(var i$1=0;i$1<keyLen;i$1++){var innerKey=animationKeys[i$1];sourceClone[innerKey]=cloneValue(animateObj[innerKey]),copyValue(animateObj,target,innerKey)}}var animator=new Animator_default(animateObj,!1,!1,additive?filter(existsAnimators,function(animator$1){return animator$1.targetName===topKey}):null);animator.targetName=topKey,cfg.scope&&(animator.scope=cfg.scope),setToFinal&&revertedSource&&animator.whenWithKeys(0,revertedSource,animationKeys),sourceClone&&animator.whenWithKeys(0,sourceClone,animationKeys),animator.whenWithKeys(duration??500,reverse?reversedTarget:target,animationKeys).delay(delay||0),animatable.addAnimator(animator,topKey),animators.push(animator)}}var Element_default=Element$1,Group=function(_super){__extends(Group$2,_super);function Group$2(opts){var _this=_super.call(this)||this;return _this.isGroup=!0,_this._children=[],_this.attr(opts),_this}return Group$2.prototype.childrenRef=function(){return this._children},Group$2.prototype.children=function(){return this._children.slice()},Group$2.prototype.childAt=function(idx){return this._children[idx]},Group$2.prototype.childOfName=function(name){for(var children=this._children,i$1=0;i$1<children.length;i$1++)if(children[i$1].name===name)return children[i$1]},Group$2.prototype.childCount=function(){return this._children.length},Group$2.prototype.add=function(child){return child&&child!==this&&child.parent!==this&&(this._children.push(child),this._doAdd(child)),this},Group$2.prototype.addBefore=function(child,nextSibling){if(child&&child!==this&&child.parent!==this&&nextSibling&&nextSibling.parent===this){var children=this._children,idx=children.indexOf(nextSibling);idx>=0&&(children.splice(idx,0,child),this._doAdd(child))}return this},Group$2.prototype.replace=function(oldChild,newChild){var idx=indexOf(this._children,oldChild);return idx>=0&&this.replaceAt(newChild,idx),this},Group$2.prototype.replaceAt=function(child,index){var children=this._children,old=children[index];if(child&&child!==this&&child.parent!==this&&child!==old){children[index]=child,old.parent=null;var zr=this.__zr;zr&&old.removeSelfFromZr(zr),this._doAdd(child)}return this},Group$2.prototype._doAdd=function(child){child.parent&&child.parent.remove(child),child.parent=this;var zr=this.__zr;zr&&zr!==child.__zr&&child.addSelfToZr(zr),zr&&zr.refresh()},Group$2.prototype.remove=function(child){var zr=this.__zr,children=this._children,idx=indexOf(children,child);return idx<0?this:(children.splice(idx,1),child.parent=null,zr&&child.removeSelfFromZr(zr),zr&&zr.refresh(),this)},Group$2.prototype.removeAll=function(){for(var children=this._children,zr=this.__zr,i$1=0;i$1<children.length;i$1++){var child=children[i$1];zr&&child.removeSelfFromZr(zr),child.parent=null}return children.length=0,this},Group$2.prototype.eachChild=function(cb,context$1){for(var children=this._children,i$1=0;i$1<children.length;i$1++){var child=children[i$1];cb.call(context$1,child,i$1)}return this},Group$2.prototype.traverse=function(cb,context$1){for(var i$1=0;i$1<this._children.length;i$1++){var child=this._children[i$1],stopped=cb.call(context$1,child);child.isGroup&&!stopped&&child.traverse(cb,context$1)}return this},Group$2.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i$1=0;i$1<this._children.length;i$1++)this._children[i$1].addSelfToZr(zr)},Group$2.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i$1=0;i$1<this._children.length;i$1++)this._children[i$1].removeSelfFromZr(zr)},Group$2.prototype.getBoundingRect=function(includeChildren){for(var tmpRect$2=new BoundingRect_default(0,0,0,0),children=includeChildren||this._children,tmpMat=[],rect=null,i$1=0;i$1<children.length;i$1++){var child=children[i$1];if(!(child.ignore||child.invisible)){var childRect=child.getBoundingRect(),transform=child.getLocalTransform(tmpMat);transform?(BoundingRect_default.applyTransform(tmpRect$2,childRect,transform),rect||=tmpRect$2.clone(),rect.union(tmpRect$2)):(rect||=childRect.clone(),rect.union(childRect))}}return rect||tmpRect$2},Group$2}(Element_default);Group.prototype.type=`group`;var Group_default=Group,painterCtors={},instances$1={};function delInstance(id){delete instances$1[id]}function isDarkMode(backgroundColor$1){if(!backgroundColor$1)return!1;if(typeof backgroundColor$1==`string`)return lum(backgroundColor$1,1)<DARK_MODE_THRESHOLD;if(backgroundColor$1.colorStops){for(var colorStops=backgroundColor$1.colorStops,totalLum=0,len$1=colorStops.length,i$1=0;i$1<len$1;i$1++)totalLum+=lum(colorStops[i$1].color,1);return totalLum/=len$1,totalLum<DARK_MODE_THRESHOLD}return!1}var ZRender=function(){function ZRender$1(id,dom,opts){var _this=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,opts||={},this.dom=dom,this.id=id;var storage=new Storage_default,rendererType=opts.renderer||`canvas`;painterCtors[rendererType]||(rendererType=keys(painterCtors)[0]),opts.useDirtyRect=opts.useDirtyRect==null?!1:opts.useDirtyRect;var painter=new painterCtors[rendererType](dom,storage,opts,id),ssrMode=opts.ssr||painter.ssrOnly;this.storage=storage,this.painter=painter;var handlerProxy=!env_default.node&&!env_default.worker&&!ssrMode?new HandlerProxy_default(painter.getViewportRoot(),painter.root):null,useCoarsePointer=opts.useCoarsePointer,usePointerSize=useCoarsePointer==null||useCoarsePointer===`auto`?env_default.touchEventsSupported:!!useCoarsePointer,defaultPointerSize=44,pointerSize;usePointerSize&&(pointerSize=retrieve2(opts.pointerSize,defaultPointerSize)),this.handler=new Handler_default(storage,painter,handlerProxy,painter.root,pointerSize),this.animation=new Animation_default({stage:{update:ssrMode?null:function(){return _this._flush(!0)}}}),ssrMode||this.animation.start()}return ZRender$1.prototype.add=function(el){this._disposed||!el||(this.storage.addRoot(el),el.addSelfToZr(this),this.refresh())},ZRender$1.prototype.remove=function(el){this._disposed||!el||(this.storage.delRoot(el),el.removeSelfFromZr(this),this.refresh())},ZRender$1.prototype.configLayer=function(zLevel,config){this._disposed||(this.painter.configLayer&&this.painter.configLayer(zLevel,config),this.refresh())},ZRender$1.prototype.setBackgroundColor=function(backgroundColor$1){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(backgroundColor$1),this.refresh(),this._backgroundColor=backgroundColor$1,this._darkMode=isDarkMode(backgroundColor$1))},ZRender$1.prototype.getBackgroundColor=function(){return this._backgroundColor},ZRender$1.prototype.setDarkMode=function(darkMode){this._darkMode=darkMode},ZRender$1.prototype.isDarkMode=function(){return this._darkMode},ZRender$1.prototype.refreshImmediately=function(fromInside){this._disposed||(fromInside||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},ZRender$1.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},ZRender$1.prototype.flush=function(){this._disposed||this._flush(!1)},ZRender$1.prototype._flush=function(fromInside){var triggerRendered,start$1=getTime();this._needsRefresh&&(triggerRendered=!0,this.refreshImmediately(fromInside)),this._needsRefreshHover&&(triggerRendered=!0,this.refreshHoverImmediately());var end$1=getTime();triggerRendered?(this._stillFrameAccum=0,this.trigger(`rendered`,{elapsedTime:end$1-start$1})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},ZRender$1.prototype.setSleepAfterStill=function(stillFramesCount){this._sleepAfterStill=stillFramesCount},ZRender$1.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},ZRender$1.prototype.refreshHover=function(){this._needsRefreshHover=!0},ZRender$1.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()===`canvas`&&this.painter.refreshHover())},ZRender$1.prototype.resize=function(opts){this._disposed||(opts||={},this.painter.resize(opts.width,opts.height),this.handler.resize())},ZRender$1.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},ZRender$1.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},ZRender$1.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},ZRender$1.prototype.setCursorStyle=function(cursorStyle){this._disposed||this.handler.setCursorStyle(cursorStyle)},ZRender$1.prototype.findHover=function(x$1,y$1){if(!this._disposed)return this.handler.findHover(x$1,y$1)},ZRender$1.prototype.on=function(eventName,eventHandler,context$1){return this._disposed||this.handler.on(eventName,eventHandler,context$1),this},ZRender$1.prototype.off=function(eventName,eventHandler){this._disposed||this.handler.off(eventName,eventHandler)},ZRender$1.prototype.trigger=function(eventName,event){this._disposed||this.handler.trigger(eventName,event)},ZRender$1.prototype.clear=function(){if(!this._disposed){for(var roots$1=this.storage.getRoots(),i$1=0;i$1<roots$1.length;i$1++)roots$1[i$1]instanceof Group_default&&roots$1[i$1].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},ZRender$1.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,delInstance(this.id))},ZRender$1}();function init$1(dom,opts){var zr=new ZRender(guid(),dom,opts);return instances$1[zr.id]=zr,zr}function registerPainter(name,Ctor){painterCtors[name]=Ctor}var ssrDataGetter,RADIAN_EPSILON=1e-4,ROUND_SUPPORTED_PRECISION_MAX=20;function _trim(str){return str.replace(/^\s+|\s+$/g,``)}var mathMin$2=Math.min,mathMax=Math.max,mathAbs=Math.abs;function linearMap(val,domain,range,clamp$1){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1],subDomain=d1-d0,subRange=r1-r0;if(subDomain===0)return subRange===0?r0:(r0+r1)/2;if(clamp$1){if(subDomain>0){if(val<=d0)return r0;if(val>=d1)return r1}else if(val>=d0)return r0;else if(val<=d1)return r1}else{if(val===d0)return r0;if(val===d1)return r1}return(val-d0)/subDomain*subRange+r0}var parsePercent=parsePositionOption;function parsePositionOption(option,percentBase,percentOffset){switch(option){case`center`:case`middle`:option=`50%`;break;case`left`:case`top`:option=`0%`;break;case`right`:case`bottom`:option=`100%`;break}return parsePositionSizeOption(option,percentBase,percentOffset)}function parsePositionSizeOption(option,percentBase,percentOffset){return isString(option)?_trim(option).match(/%$/)?parseFloat(option)/100*percentBase+(percentOffset||0):parseFloat(option):option==null?NaN:+option}function round(x$1,precision,returnStr){return precision??=10,precision=Math.min(Math.max(0,precision),ROUND_SUPPORTED_PRECISION_MAX),x$1=(+x$1).toFixed(precision),returnStr?x$1:+x$1}function asc(arr){return arr.sort(function(a$1,b$1){return a$1-b$1}),arr}function getPrecision(val){if(val=+val,isNaN(val))return 0;if(val>1e-14){for(var e$2=1,i$1=0;i$1<15;i$1++,e$2*=10)if(Math.round(val*e$2)/e$2===val)return i$1}return getPrecisionSafe(val)}function getPrecisionSafe(val){var str=val.toString().toLowerCase(),eIndex=str.indexOf(`e`),exp=eIndex>0?+str.slice(eIndex+1):0,significandPartLen=eIndex>0?eIndex:str.length,dotIndex=str.indexOf(`.`),decimalPartLen=dotIndex<0?0:significandPartLen-1-dotIndex;return Math.max(0,decimalPartLen-exp)}function getPixelPrecision(dataExtent,pixelExtent){var log$1=Math.log,LN10=Math.LN10,dataQuantity=Math.floor(log$1(dataExtent[1]-dataExtent[0])/LN10),sizeQuantity=Math.round(log$1(mathAbs(pixelExtent[1]-pixelExtent[0]))/LN10),precision=Math.min(Math.max(-dataQuantity+sizeQuantity,0),20);return isFinite(precision)?precision:20}function addSafe(val0,val1){var maxPrecision=Math.max(getPrecision(val0),getPrecision(val1)),sum=val0+val1;return maxPrecision>ROUND_SUPPORTED_PRECISION_MAX?sum:round(sum,maxPrecision)}function remRadian(radian){var pi2=Math.PI*2;return(radian%pi2+pi2)%pi2}function isRadianAroundZero(val){return val>-RADIAN_EPSILON&&val<RADIAN_EPSILON}var TIME_REG=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function parseDate(value){if(value instanceof Date)return value;if(isString(value)){var match=TIME_REG.exec(value);if(!match)return new Date(NaN);if(match[8]){var hour=+match[4]||0;return match[8].toUpperCase()!==`Z`&&(hour-=+match[8].slice(0,3)),new Date(Date.UTC(+match[1],(match[2]||1)-1,+match[3]||1,hour,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0))}else return new Date(+match[1],(match[2]||1)-1,+match[3]||1,+match[4]||0,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0)}else if(value==null)return new Date(NaN);return new Date(Math.round(value))}function quantity(val){return 10**quantityExponent(val)}function quantityExponent(val){if(val===0)return 0;var exp=Math.floor(Math.log(val)/Math.LN10);return val/10**exp>=10&&exp++,exp}function nice(val,round$3){var exponent=quantityExponent(val),exp10=10**exponent,f$1=val/exp10;return val=(round$3?f$1<1.5?1:f$1<2.5?2:f$1<4?3:f$1<7?5:10:f$1<1?1:f$1<2?2:f$1<3?3:f$1<5?5:10)*exp10,exponent>=-20?+val.toFixed(exponent<0?-exponent:0):val}function numericToNumber(val){var valFloat=parseFloat(val);return valFloat==val&&(valFloat!==0||!isString(val)||val.indexOf(`x`)<=0)?valFloat:NaN}function isNumeric(val){return!isNaN(numericToNumber(val))}function getRandomIdBase(){return Math.round(Math.random()*9)}function getGreatestCommonDividor(a$1,b$1){return b$1===0?a$1:getGreatestCommonDividor(b$1,a$1%b$1)}function getLeastCommonMultiple(a$1,b$1){return a$1==null?b$1:b$1==null?a$1:a$1*b$1/getGreatestCommonDividor(a$1,b$1)}var ECHARTS_PREFIX=`[ECharts] `,storedLogs={},hasConsole=typeof console<`u`&&console.warn&&console.log;function outputLog(type,str,onlyOnce){if(hasConsole){if(onlyOnce){if(storedLogs[str])return;storedLogs[str]=!0}console[type](ECHARTS_PREFIX+str)}}function error(str,onlyOnce){outputLog(`error`,str,onlyOnce)}function throwError(msg$3){throw Error(msg$3)}function interpolateNumber(p0,p1,percent){return(p1-p0)*percent+p0}var DUMMY_COMPONENT_NAME_PREFIX=`series\0`,INTERNAL_COMPONENT_ID_PREFIX=`\0_ec_\0`;function normalizeToArray(value){return value instanceof Array?value:value==null?[]:[value]}function defaultEmphasis(opt,key$1,subOpts){if(opt){opt[key$1]=opt[key$1]||{},opt.emphasis=opt.emphasis||{},opt.emphasis[key$1]=opt.emphasis[key$1]||{};for(var i$1=0,len$1=subOpts.length;i$1<len$1;i$1++){var subOptName=subOpts[i$1];!opt.emphasis[key$1].hasOwnProperty(subOptName)&&opt[key$1].hasOwnProperty(subOptName)&&(opt.emphasis[key$1][subOptName]=opt[key$1][subOptName])}}}var TEXT_STYLE_OPTIONS=`fontStyle.fontWeight.fontSize.fontFamily.rich.tag.color.textBorderColor.textBorderWidth.width.height.lineHeight.align.verticalAlign.baseline.shadowColor.shadowBlur.shadowOffsetX.shadowOffsetY.textShadowColor.textShadowBlur.textShadowOffsetX.textShadowOffsetY.backgroundColor.borderColor.borderWidth.borderRadius.padding`.split(`.`);function getDataItemValue(dataItem){return isObject(dataItem)&&!isArray(dataItem)&&!(dataItem instanceof Date)?dataItem.value:dataItem}function isDataItemOption(dataItem){return isObject(dataItem)&&!(dataItem instanceof Array)}function mappingToExists(existings,newCmptOptions,mode){var isNormalMergeMode=mode===`normalMerge`,isReplaceMergeMode=mode===`replaceMerge`,isReplaceAllMode=mode===`replaceAll`;existings||=[],newCmptOptions=(newCmptOptions||[]).slice();var existingIdIdxMap=createHashMap();each(newCmptOptions,function(cmptOption,index){if(!isObject(cmptOption)){newCmptOptions[index]=null;return}});var result=prepareResult(existings,existingIdIdxMap,mode);return(isNormalMergeMode||isReplaceMergeMode)&&mappingById(result,existings,existingIdIdxMap,newCmptOptions),isNormalMergeMode&&mappingByName(result,newCmptOptions),isNormalMergeMode||isReplaceMergeMode?mappingByIndex(result,newCmptOptions,isReplaceMergeMode):isReplaceAllMode&&mappingInReplaceAllMode(result,newCmptOptions),makeIdAndName(result),result}function prepareResult(existings,existingIdIdxMap,mode){var result=[];if(mode===`replaceAll`)return result;for(var index=0;index<existings.length;index++){var existing=existings[index];existing&&existing.id!=null&&existingIdIdxMap.set(existing.id,index),result.push({existing:mode===`replaceMerge`||isComponentIdInternal(existing)?null:existing,newOption:null,keyInfo:null,brandNew:null})}return result}function mappingById(result,existings,existingIdIdxMap,newCmptOptions){each(newCmptOptions,function(cmptOption,index){if(!(!cmptOption||cmptOption.id==null)){var optionId=makeComparableKey(cmptOption.id),existingIdx=existingIdIdxMap.get(optionId);if(existingIdx!=null){var resultItem=result[existingIdx];assert(!resultItem.newOption,`Duplicated option on id "`+optionId+`".`),resultItem.newOption=cmptOption,resultItem.existing=existings[existingIdx],newCmptOptions[index]=null}}})}function mappingByName(result,newCmptOptions){each(newCmptOptions,function(cmptOption,index){if(!(!cmptOption||cmptOption.name==null))for(var i$1=0;i$1<result.length;i$1++){var existing=result[i$1].existing;if(!result[i$1].newOption&&existing&&(existing.id==null||cmptOption.id==null)&&!isComponentIdInternal(cmptOption)&&!isComponentIdInternal(existing)&&keyExistAndEqual(`name`,existing,cmptOption)){result[i$1].newOption=cmptOption,newCmptOptions[index]=null;return}}})}function mappingByIndex(result,newCmptOptions,brandNew){each(newCmptOptions,function(cmptOption){if(cmptOption){for(var resultItem,nextIdx=0;(resultItem=result[nextIdx])&&(resultItem.newOption||isComponentIdInternal(resultItem.existing)||resultItem.existing&&cmptOption.id!=null&&!keyExistAndEqual(`id`,cmptOption,resultItem.existing));)nextIdx++;resultItem?(resultItem.newOption=cmptOption,resultItem.brandNew=brandNew):result.push({newOption:cmptOption,brandNew,existing:null,keyInfo:null}),nextIdx++}})}function mappingInReplaceAllMode(result,newCmptOptions){each(newCmptOptions,function(cmptOption){result.push({newOption:cmptOption,brandNew:!0,existing:null,keyInfo:null})})}function makeIdAndName(mapResult){var idMap=createHashMap();each(mapResult,function(item){var existing=item.existing;existing&&idMap.set(existing.id,item)}),each(mapResult,function(item){var opt=item.newOption;assert(!opt||opt.id==null||!idMap.get(opt.id)||idMap.get(opt.id)===item,`id duplicates: `+(opt&&opt.id)),opt&&opt.id!=null&&idMap.set(opt.id,item),!item.keyInfo&&(item.keyInfo={})}),each(mapResult,function(item,index){var existing=item.existing,opt=item.newOption,keyInfo=item.keyInfo;if(isObject(opt)){if(keyInfo.name=opt.name==null?existing?existing.name:DUMMY_COMPONENT_NAME_PREFIX+index:makeComparableKey(opt.name),existing)keyInfo.id=makeComparableKey(existing.id);else if(opt.id!=null)keyInfo.id=makeComparableKey(opt.id);else{var idNum=0;do keyInfo.id=`\0`+keyInfo.name+`\0`+ idNum++;while(idMap.get(keyInfo.id))}idMap.set(keyInfo.id,item)}})}function keyExistAndEqual(attr,obj1,obj2){var key1=convertOptionIdName(obj1[attr],null),key2=convertOptionIdName(obj2[attr],null);return key1!=null&&key2!=null&&key1===key2}function makeComparableKey(val){return convertOptionIdName(val,``)}function convertOptionIdName(idOrName,defaultValue$1){return idOrName==null?defaultValue$1:isString(idOrName)?idOrName:isNumber(idOrName)||isStringSafe(idOrName)?idOrName+``:defaultValue$1}function isNameSpecified(componentModel){var name=componentModel.name;return!!(name&&name.indexOf(DUMMY_COMPONENT_NAME_PREFIX))}function isComponentIdInternal(cmptOption){return cmptOption&&cmptOption.id!=null&&makeComparableKey(cmptOption.id).indexOf(INTERNAL_COMPONENT_ID_PREFIX)===0}function setComponentTypeToKeyInfo(mappingResult,mainType,componentModelCtor){each(mappingResult,function(item){var newOption=item.newOption;isObject(newOption)&&(item.keyInfo.mainType=mainType,item.keyInfo.subType=determineSubType(mainType,newOption,item.existing,componentModelCtor))})}function determineSubType(mainType,newCmptOption,existComponent,componentModelCtor){return newCmptOption.type?newCmptOption.type:existComponent?existComponent.subType:componentModelCtor.determineSubType(mainType,newCmptOption)}function queryDataIndex(data,payload){if(payload.dataIndexInside!=null)return payload.dataIndexInside;if(payload.dataIndex!=null)return isArray(payload.dataIndex)?map(payload.dataIndex,function(value){return data.indexOfRawIndex(value)}):data.indexOfRawIndex(payload.dataIndex);if(payload.name!=null)return isArray(payload.name)?map(payload.name,function(value){return data.indexOfName(value)}):data.indexOfName(payload.name)}function makeInner(){var key$1=`__ec_inner_`+ innerUniqueIndex++;return function(hostObj){return hostObj[key$1]||(hostObj[key$1]={})}}var innerUniqueIndex=getRandomIdBase();function parseFinder(ecModel,finderInput,opt){var _a$1=preParseFinder(finderInput,opt),mainTypeSpecified=_a$1.mainTypeSpecified,queryOptionMap=_a$1.queryOptionMap,result=_a$1.others,defaultMainType=opt?opt.defaultMainType:null;return!mainTypeSpecified&&defaultMainType&&queryOptionMap.set(defaultMainType,{}),queryOptionMap.each(function(queryOption,mainType){var queryResult=queryReferringComponents(ecModel,mainType,queryOption,{useDefault:defaultMainType===mainType,enableAll:opt&&opt.enableAll!=null?opt.enableAll:!0,enableNone:opt&&opt.enableNone!=null?opt.enableNone:!0});result[mainType+`Models`]=queryResult.models,result[mainType+`Model`]=queryResult.models[0]}),result}function preParseFinder(finderInput,opt){var finder;if(isString(finderInput)){var obj={};obj[finderInput+`Index`]=0,finder=obj}else finder=finderInput;var queryOptionMap=createHashMap(),others={},mainTypeSpecified=!1;return each(finder,function(value,key$1){if(key$1===`dataIndex`||key$1===`dataIndexInside`){others[key$1]=value;return}var parsedKey=key$1.match(/^(\w+)(Index|Id|Name)$/)||[],mainType=parsedKey[1],queryType=(parsedKey[2]||``).toLowerCase();if(!(!mainType||!queryType||opt&&opt.includeMainTypes&&indexOf(opt.includeMainTypes,mainType)<0)){mainTypeSpecified||=!!mainType;var queryOption=queryOptionMap.get(mainType)||queryOptionMap.set(mainType,{});queryOption[queryType]=value}}),{mainTypeSpecified,queryOptionMap,others}}var SINGLE_REFERRING={useDefault:!0,enableAll:!1,enableNone:!1},MULTIPLE_REFERRING={useDefault:!1,enableAll:!0,enableNone:!0};function queryReferringComponents(ecModel,mainType,userOption,opt){opt||=SINGLE_REFERRING;var indexOption=userOption.index,idOption=userOption.id,nameOption=userOption.name,result={models:null,specified:indexOption!=null||idOption!=null||nameOption!=null};if(!result.specified){var firstCmpt=void 0;return result.models=opt.useDefault&&(firstCmpt=ecModel.getComponent(mainType))?[firstCmpt]:[],result}if(indexOption===`none`||indexOption===!1){if(opt.enableNone)return result.models=[],result;indexOption=-1}return indexOption===`all`&&(indexOption=opt.enableAll?idOption=nameOption=null:-1),result.models=ecModel.queryComponents({mainType,index:indexOption,id:idOption,name:nameOption}),result}function setAttribute(dom,key$1,value){dom.setAttribute?dom.setAttribute(key$1,value):dom[key$1]=value}function getAttribute(dom,key$1){return dom.getAttribute?dom.getAttribute(key$1):dom[key$1]}function getTooltipRenderMode(renderModeOption){return renderModeOption===`auto`?env_default.domSupported?`html`:`richText`:renderModeOption||`html`}function interpolateRawValues(data,precision,sourceValue,targetValue,percent){var isAutoPrecision=precision==null||precision===`auto`;if(targetValue==null)return targetValue;if(isNumber(targetValue)){var value=interpolateNumber(sourceValue||0,targetValue,percent);return round(value,isAutoPrecision?Math.max(getPrecision(sourceValue||0),getPrecision(targetValue)):precision)}else if(isString(targetValue))return percent<1?sourceValue:targetValue;else{for(var interpolated=[],leftArr=sourceValue,rightArr=targetValue,length_1=Math.max(leftArr?leftArr.length:0,rightArr.length),i$1=0;i$1<length_1;++i$1){var info=data.getDimensionInfo(i$1);if(info&&info.type===`ordinal`)interpolated[i$1]=(percent<1&&leftArr?leftArr:rightArr)[i$1];else{var leftVal=leftArr&&leftArr[i$1]?leftArr[i$1]:0,rightVal=rightArr[i$1],value=interpolateNumber(leftVal,rightVal,percent);interpolated[i$1]=round(value,isAutoPrecision?Math.max(getPrecision(leftVal),getPrecision(rightVal)):precision)}}return interpolated}}var ListIterator=function(){function ListIterator$1(){}return ListIterator$1.prototype.reset=function(list,start$1,end$1,step){return this._list=list,this._step=step||=1,this._idx=start$1,this._end=end$1??(step>0?list.length:0),this.item=null,this.key=NaN,this},ListIterator$1.prototype.next=function(){return(this._step>0?this._idx<this._end:this._idx>=this._end)?(this.item=this._list[this._idx],this.key=this._idx+=this._step,!0):!1},ListIterator$1}(),TYPE_DELIMITER=`.`,IS_CONTAINER=`___EC__COMPONENT__CONTAINER___`,IS_EXTENDED_CLASS=`___EC__EXTENDED_CLASS___`;function parseClassType(componentType){var ret={main:``,sub:``};if(componentType){var typeArr=componentType.split(TYPE_DELIMITER);ret.main=typeArr[0]||``,ret.sub=typeArr[1]||``}return ret}function checkClassType(componentType){assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(componentType),`componentType "`+componentType+`" illegal`)}function isExtendedClass(clz){return!!(clz&&clz[IS_EXTENDED_CLASS])}function enableClassExtend(rootClz,mandatoryMethods){rootClz.$constructor=rootClz,rootClz.extend=function(proto){var superClass=this,ExtendedClass;return isESClass(superClass)?ExtendedClass=function(_super){__extends(class_1,_super);function class_1(){return _super.apply(this,arguments)||this}return class_1}(superClass):(ExtendedClass=function(){(proto.$constructor||superClass).apply(this,arguments)},inherits(ExtendedClass,this)),extend(ExtendedClass.prototype,proto),ExtendedClass[IS_EXTENDED_CLASS]=!0,ExtendedClass.extend=this.extend,ExtendedClass.superCall=superCall,ExtendedClass.superApply=superApply,ExtendedClass.superClass=superClass,ExtendedClass}}function isESClass(fn){return isFunction(fn)&&/^class\s/.test(Function.prototype.toString.call(fn))}function mountExtend(SubClz,SupperClz){SubClz.extend=SupperClz.extend}var classBase=Math.round(Math.random()*10);function enableClassCheck(target){var classAttr=[`__\0is_clz`,classBase++].join(`_`);target.prototype[classAttr]=!0,target.isInstance=function(obj){return!!(obj&&obj[classAttr])}}function superCall(context$1,methodName){var args=[...arguments].slice(2);return this.superClass.prototype[methodName].apply(context$1,args)}function superApply(context$1,methodName,args){return this.superClass.prototype[methodName].apply(context$1,args)}function enableClassManagement(target){var storage={};target.registerClass=function(clz){var componentFullType=clz.type||clz.prototype.type;if(componentFullType){checkClassType(componentFullType),clz.prototype.type=componentFullType;var componentTypeInfo=parseClassType(componentFullType);if(!componentTypeInfo.sub)storage[componentTypeInfo.main]=clz;else if(componentTypeInfo.sub!==IS_CONTAINER){var container=makeContainer(componentTypeInfo);container[componentTypeInfo.sub]=clz}}return clz},target.getClass=function(mainType,subType,throwWhenNotFound){var clz=storage[mainType];if(clz&&clz[IS_CONTAINER]&&(clz=subType?clz[subType]:null),throwWhenNotFound&&!clz)throw Error(subType?`Component `+mainType+`.`+(subType||``)+` is used but not imported.`:mainType+`.type should be specified.`);return clz},target.getClassesByMainType=function(componentType){var componentTypeInfo=parseClassType(componentType),result=[],obj=storage[componentTypeInfo.main];return obj&&obj[IS_CONTAINER]?each(obj,function(o$1,type){type!==IS_CONTAINER&&result.push(o$1)}):result.push(obj),result},target.hasClass=function(componentType){var componentTypeInfo=parseClassType(componentType);return!!storage[componentTypeInfo.main]},target.getAllClassMainTypes=function(){var types=[];return each(storage,function(obj,type){types.push(type)}),types},target.hasSubTypes=function(componentType){var componentTypeInfo=parseClassType(componentType),obj=storage[componentTypeInfo.main];return obj&&obj[IS_CONTAINER]};function makeContainer(componentTypeInfo){var container=storage[componentTypeInfo.main];return(!container||!container[IS_CONTAINER])&&(container=storage[componentTypeInfo.main]={},container[IS_CONTAINER]=!0),container}}function makeStyleMapper(properties,ignoreParent){for(var i$1=0;i$1<properties.length;i$1++)properties[i$1][1]||(properties[i$1][1]=properties[i$1][0]);return ignoreParent||=!1,function(model,excludes,includes){for(var style={},i$2=0;i$2<properties.length;i$2++){var propName=properties[i$2][1];if(!(excludes&&indexOf(excludes,propName)>=0||includes&&indexOf(includes,propName)<0)){var val=model.getShallow(propName,ignoreParent);val!=null&&(style[properties[i$2][0]]=val)}}return style}}var getAreaStyle=makeStyleMapper([[`fill`,`color`],[`shadowBlur`],[`shadowOffsetX`],[`shadowOffsetY`],[`opacity`],[`shadowColor`]]),AreaStyleMixin=function(){function AreaStyleMixin$1(){}return AreaStyleMixin$1.prototype.getAreaStyle=function(excludes,includes){return getAreaStyle(this,excludes,includes)},AreaStyleMixin$1}(),globalImageCache=new LRU_default(50);function findExistImage(newImageOrSrc){if(typeof newImageOrSrc==`string`){var cachedImgObj=globalImageCache.get(newImageOrSrc);return cachedImgObj&&cachedImgObj.image}else return newImageOrSrc}function createOrUpdateImage(newImageOrSrc,image,hostEl,onload,cbPayload){if(newImageOrSrc)if(typeof newImageOrSrc==`string`){if(image&&image.__zrImageSrc===newImageOrSrc||!hostEl)return image;var cachedImgObj=globalImageCache.get(newImageOrSrc),pendingWrap={hostEl,cb:onload,cbPayload};return cachedImgObj?(image=cachedImgObj.image,!isImageReady(image)&&cachedImgObj.pending.push(pendingWrap)):(image=platformApi.loadImage(newImageOrSrc,imageOnLoad,imageOnLoad),image.__zrImageSrc=newImageOrSrc,globalImageCache.put(newImageOrSrc,image.__cachedImgObj={image,pending:[pendingWrap]})),image}else return newImageOrSrc;else return image}function imageOnLoad(){var cachedImgObj=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var i$1=0;i$1<cachedImgObj.pending.length;i$1++){var pendingWrap=cachedImgObj.pending[i$1],cb=pendingWrap.cb;cb&&cb(this,pendingWrap.cbPayload),pendingWrap.hostEl.dirty()}cachedImgObj.pending.length=0}function isImageReady(image){return image&&image.width&&image.height}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText2(out$2,text,containerWidth,font,ellipsis,options){if(!containerWidth){out$2.text=``,out$2.isTruncated=!1;return}var textLines=(text+``).split(`
`);options=prepareTruncateOptions(containerWidth,font,ellipsis,options);for(var isTruncated=!1,truncateOut={},i$1=0,len$1=textLines.length;i$1<len$1;i$1++)truncateSingleLine(truncateOut,textLines[i$1],options),textLines[i$1]=truncateOut.textLine,isTruncated||=truncateOut.isTruncated;out$2.text=textLines.join(`
`),out$2.isTruncated=isTruncated}function prepareTruncateOptions(containerWidth,font,ellipsis,options){options||={};var preparedOpts=extend({},options);ellipsis=retrieve2(ellipsis,`...`),preparedOpts.maxIterations=retrieve2(options.maxIterations,2);var minChar=preparedOpts.minChar=retrieve2(options.minChar,0),fontMeasureInfo=preparedOpts.fontMeasureInfo=ensureFontMeasureInfo(font),ascCharWidth=fontMeasureInfo.asciiCharWidth;preparedOpts.placeholder=retrieve2(options.placeholder,``);for(var contentWidth=containerWidth=Math.max(0,containerWidth-1),i$1=0;i$1<minChar&&contentWidth>=ascCharWidth;i$1++)contentWidth-=ascCharWidth;var ellipsisWidth=measureWidth(fontMeasureInfo,ellipsis);return ellipsisWidth>contentWidth&&(ellipsis=``,ellipsisWidth=0),contentWidth=containerWidth-ellipsisWidth,preparedOpts.ellipsis=ellipsis,preparedOpts.ellipsisWidth=ellipsisWidth,preparedOpts.contentWidth=contentWidth,preparedOpts.containerWidth=containerWidth,preparedOpts}function truncateSingleLine(out$2,textLine,options){var containerWidth=options.containerWidth,contentWidth=options.contentWidth,fontMeasureInfo=options.fontMeasureInfo;if(!containerWidth){out$2.textLine=``,out$2.isTruncated=!1;return}var lineWidth=measureWidth(fontMeasureInfo,textLine);if(lineWidth<=containerWidth){out$2.textLine=textLine,out$2.isTruncated=!1;return}for(var j$1=0;;j$1++){if(lineWidth<=contentWidth||j$1>=options.maxIterations){textLine+=options.ellipsis;break}var subLength=j$1===0?estimateLength(textLine,contentWidth,fontMeasureInfo):lineWidth>0?Math.floor(textLine.length*contentWidth/lineWidth):0;textLine=textLine.substr(0,subLength),lineWidth=measureWidth(fontMeasureInfo,textLine)}textLine===``&&(textLine=options.placeholder),out$2.textLine=textLine,out$2.isTruncated=!0}function estimateLength(text,contentWidth,fontMeasureInfo){for(var width=0,i$1=0,len$1=text.length;i$1<len$1&&width<contentWidth;i$1++)width+=measureCharWidth(fontMeasureInfo,text.charCodeAt(i$1));return i$1}function parsePlainText(rawText,style,defaultOuterWidth,defaultOuterHeight){var text=formatText(rawText),overflow=style.overflow,padding=style.padding,paddingH=padding?padding[1]+padding[3]:0,paddingV=padding?padding[0]+padding[2]:0,font=style.font,truncate=overflow===`truncate`,calculatedLineHeight=getLineHeight(font),lineHeight=retrieve2(style.lineHeight,calculatedLineHeight),truncateLineOverflow=style.lineOverflow===`truncate`,isTruncated=!1,width=style.width;width==null&&defaultOuterWidth!=null&&(width=defaultOuterWidth-paddingH);var height=style.height;height==null&&defaultOuterHeight!=null&&(height=defaultOuterHeight-paddingV);var lines=width!=null&&(overflow===`break`||overflow===`breakAll`)?text?wrapText(text,style.font,width,overflow===`breakAll`,0).lines:[]:text?text.split(`
`):[],contentHeight=lines.length*lineHeight;if(height??=contentHeight,contentHeight>height&&truncateLineOverflow){var lineCount=Math.floor(height/lineHeight);isTruncated||=lines.length>lineCount,lines=lines.slice(0,lineCount),contentHeight=lines.length*lineHeight}if(text&&truncate&&width!=null)for(var options=prepareTruncateOptions(width,font,style.ellipsis,{minChar:style.truncateMinChar,placeholder:style.placeholder}),singleOut={},i$1=0;i$1<lines.length;i$1++)truncateSingleLine(singleOut,lines[i$1],options),lines[i$1]=singleOut.textLine,isTruncated||=singleOut.isTruncated;for(var outerHeight=height,contentWidth=0,fontMeasureInfo=ensureFontMeasureInfo(font),i$1=0;i$1<lines.length;i$1++)contentWidth=Math.max(measureWidth(fontMeasureInfo,lines[i$1]),contentWidth);width??=contentWidth;var outerWidth=width;return outerHeight+=paddingV,outerWidth+=paddingH,{lines,height,outerWidth,outerHeight,lineHeight,calculatedLineHeight,contentWidth,contentHeight,width,isTruncated}}var RichTextToken=function(){function RichTextToken$1(){}return RichTextToken$1}(),RichTextLine=function(){function RichTextLine$1(tokens$1){this.tokens=[],tokens$1&&(this.tokens=tokens$1)}return RichTextLine$1}(),RichTextContentBlock=function(){function RichTextContentBlock$1(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}return RichTextContentBlock$1}();function parseRichText(rawText,style,defaultOuterWidth,defaultOuterHeight,topTextAlign){var contentBlock=new RichTextContentBlock,text=formatText(rawText);if(!text)return contentBlock;var stlPadding=style.padding,stlPaddingH=stlPadding?stlPadding[1]+stlPadding[3]:0,stlPaddingV=stlPadding?stlPadding[0]+stlPadding[2]:0,topWidth=style.width;topWidth==null&&defaultOuterWidth!=null&&(topWidth=defaultOuterWidth-stlPaddingH);var topHeight=style.height;topHeight==null&&defaultOuterHeight!=null&&(topHeight=defaultOuterHeight-stlPaddingV);for(var overflow=style.overflow,wrapInfo=(overflow===`break`||overflow===`breakAll`)&&topWidth!=null?{width:topWidth,accumWidth:0,breakAll:overflow===`breakAll`}:null,lastIndex=STYLE_REG.lastIndex=0,result;(result=STYLE_REG.exec(text))!=null;){var matchedIndex=result.index;matchedIndex>lastIndex&&pushTokens(contentBlock,text.substring(lastIndex,matchedIndex),style,wrapInfo),pushTokens(contentBlock,result[2],style,wrapInfo,result[1]),lastIndex=STYLE_REG.lastIndex}lastIndex<text.length&&pushTokens(contentBlock,text.substring(lastIndex,text.length),style,wrapInfo);var pendingList=[],calculatedHeight=0,calculatedWidth=0,truncate=overflow===`truncate`,truncateLine=style.lineOverflow===`truncate`,tmpTruncateOut={};function finishLine(line$1,lineWidth$1,lineHeight$1){line$1.width=lineWidth$1,line$1.lineHeight=lineHeight$1,calculatedHeight+=lineHeight$1,calculatedWidth=Math.max(calculatedWidth,lineWidth$1)}outer:for(var i$1=0;i$1<contentBlock.lines.length;i$1++){for(var line=contentBlock.lines[i$1],lineHeight=0,lineWidth=0,j$1=0;j$1<line.tokens.length;j$1++){var token=line.tokens[j$1],tokenStyle=token.styleName&&style.rich[token.styleName]||{},textPadding=token.textPadding=tokenStyle.padding,paddingH=textPadding?textPadding[1]+textPadding[3]:0,font=token.font=tokenStyle.font||style.font;token.contentHeight=getLineHeight(font);var tokenHeight=retrieve2(tokenStyle.height,token.contentHeight);if(token.innerHeight=tokenHeight,textPadding&&(tokenHeight+=textPadding[0]+textPadding[2]),token.height=tokenHeight,token.lineHeight=retrieve3(tokenStyle.lineHeight,style.lineHeight,tokenHeight),token.align=tokenStyle&&tokenStyle.align||topTextAlign,token.verticalAlign=tokenStyle&&tokenStyle.verticalAlign||`middle`,truncateLine&&topHeight!=null&&calculatedHeight+token.lineHeight>topHeight){var originalLength=contentBlock.lines.length;j$1>0?(line.tokens=line.tokens.slice(0,j$1),finishLine(line,lineWidth,lineHeight),contentBlock.lines=contentBlock.lines.slice(0,i$1+1)):contentBlock.lines=contentBlock.lines.slice(0,i$1),contentBlock.isTruncated=contentBlock.isTruncated||contentBlock.lines.length<originalLength;break outer}var styleTokenWidth=tokenStyle.width,tokenWidthNotSpecified=styleTokenWidth==null||styleTokenWidth===`auto`;if(typeof styleTokenWidth==`string`&&styleTokenWidth.charAt(styleTokenWidth.length-1)===`%`)token.percentWidth=styleTokenWidth,pendingList.push(token),token.contentWidth=measureWidth(ensureFontMeasureInfo(font),token.text);else{if(tokenWidthNotSpecified){var textBackgroundColor=tokenStyle.backgroundColor,bgImg=textBackgroundColor&&textBackgroundColor.image;bgImg&&(bgImg=findExistImage(bgImg),isImageReady(bgImg)&&(token.width=Math.max(token.width,bgImg.width*tokenHeight/bgImg.height)))}var remainTruncWidth=truncate&&topWidth!=null?topWidth-lineWidth:null;remainTruncWidth!=null&&remainTruncWidth<token.width?!tokenWidthNotSpecified||remainTruncWidth<paddingH?(token.text=``,token.width=token.contentWidth=0):(truncateText2(tmpTruncateOut,token.text,remainTruncWidth-paddingH,font,style.ellipsis,{minChar:style.truncateMinChar}),token.text=tmpTruncateOut.text,contentBlock.isTruncated=contentBlock.isTruncated||tmpTruncateOut.isTruncated,token.width=token.contentWidth=measureWidth(ensureFontMeasureInfo(font),token.text)):token.contentWidth=measureWidth(ensureFontMeasureInfo(font),token.text)}token.width+=paddingH,lineWidth+=token.width,tokenStyle&&(lineHeight=Math.max(lineHeight,token.lineHeight))}finishLine(line,lineWidth,lineHeight)}contentBlock.outerWidth=contentBlock.width=retrieve2(topWidth,calculatedWidth),contentBlock.outerHeight=contentBlock.height=retrieve2(topHeight,calculatedHeight),contentBlock.contentHeight=calculatedHeight,contentBlock.contentWidth=calculatedWidth,contentBlock.outerWidth+=stlPaddingH,contentBlock.outerHeight+=stlPaddingV;for(var i$1=0;i$1<pendingList.length;i$1++){var token=pendingList[i$1],percentWidth=token.percentWidth;token.width=parseInt(percentWidth,10)/100*contentBlock.width}return contentBlock}function pushTokens(block,str,style,wrapInfo,styleName){var isEmptyStr=str===``,tokenStyle=styleName&&style.rich[styleName]||{},lines=block.lines,font=tokenStyle.font||style.font,newLine=!1,strLines,linesWidths;if(wrapInfo){var tokenPadding=tokenStyle.padding,tokenPaddingH=tokenPadding?tokenPadding[1]+tokenPadding[3]:0;if(tokenStyle.width!=null&&tokenStyle.width!==`auto`){var outerWidth_1=parsePercent$1(tokenStyle.width,wrapInfo.width)+tokenPaddingH;lines.length>0&&outerWidth_1+wrapInfo.accumWidth>wrapInfo.width&&(strLines=str.split(`
`),newLine=!0),wrapInfo.accumWidth=outerWidth_1}else{var res=wrapText(str,font,wrapInfo.width,wrapInfo.breakAll,wrapInfo.accumWidth);wrapInfo.accumWidth=res.accumWidth+tokenPaddingH,linesWidths=res.linesWidths,strLines=res.lines}}strLines||=str.split(`
`);for(var fontMeasureInfo=ensureFontMeasureInfo(font),i$1=0;i$1<strLines.length;i$1++){var text=strLines[i$1],token=new RichTextToken;if(token.styleName=styleName,token.text=text,token.isLineHolder=!text&&!isEmptyStr,typeof tokenStyle.width==`number`?token.width=tokenStyle.width:token.width=linesWidths?linesWidths[i$1]:measureWidth(fontMeasureInfo,text),!i$1&&!newLine){var tokens$1=(lines[lines.length-1]||(lines[0]=new RichTextLine)).tokens,tokensLen=tokens$1.length;tokensLen===1&&tokens$1[0].isLineHolder?tokens$1[0]=token:(text||!tokensLen||isEmptyStr)&&tokens$1.push(token)}else lines.push(new RichTextLine([token]))}}function isAlphabeticLetter(ch){var code=ch.charCodeAt(0);return code>=32&&code<=591||code>=880&&code<=4351||code>=4608&&code<=5119||code>=7680&&code<=8303}var breakCharMap=reduce(`,&?/;] `.split(``),function(obj,ch){return obj[ch]=!0,obj},{});function isWordBreakChar(ch){return isAlphabeticLetter(ch)?!!breakCharMap[ch]:!0}function wrapText(text,font,lineWidth,isBreakAll,lastAccumWidth){for(var lines=[],linesWidths=[],line=``,currentWord=``,currentWordWidth=0,accumWidth=0,fontMeasureInfo=ensureFontMeasureInfo(font),i$1=0;i$1<text.length;i$1++){var ch=text.charAt(i$1);if(ch===`
`){currentWord&&(line+=currentWord,accumWidth+=currentWordWidth),lines.push(line),linesWidths.push(accumWidth),line=``,currentWord=``,currentWordWidth=0,accumWidth=0;continue}var chWidth=measureCharWidth(fontMeasureInfo,ch.charCodeAt(0)),inWord=isBreakAll?!1:!isWordBreakChar(ch);if(lines.length?accumWidth+chWidth>lineWidth:lastAccumWidth+accumWidth+chWidth>lineWidth){accumWidth?(line||currentWord)&&(inWord?(line||(line=currentWord,currentWord=``,currentWordWidth=0,accumWidth=currentWordWidth),lines.push(line),linesWidths.push(accumWidth-currentWordWidth),currentWord+=ch,currentWordWidth+=chWidth,line=``,accumWidth=currentWordWidth):(currentWord&&(line+=currentWord,currentWord=``,currentWordWidth=0),lines.push(line),linesWidths.push(accumWidth),line=ch,accumWidth=chWidth)):inWord?(lines.push(currentWord),linesWidths.push(currentWordWidth),currentWord=ch,currentWordWidth=chWidth):(lines.push(ch),linesWidths.push(chWidth));continue}accumWidth+=chWidth,inWord?(currentWord+=ch,currentWordWidth+=chWidth):(currentWord&&(line+=currentWord,currentWord=``,currentWordWidth=0),line+=ch)}return currentWord&&(line+=currentWord),line&&(lines.push(line),linesWidths.push(accumWidth)),lines.length===1&&(accumWidth+=lastAccumWidth),{accumWidth,lines,linesWidths}}function calcInnerTextOverflowArea(out$2,overflowRect,baseX,baseY,textAlign,textVerticalAlign){if(out$2.baseX=baseX,out$2.baseY=baseY,out$2.outerWidth=out$2.outerHeight=null,overflowRect){var textWidth=overflowRect.width*2,textHeight=overflowRect.height*2;BoundingRect_default.set(tmpCITCTextRect,adjustTextX(baseX,textWidth,textAlign),adjustTextY(baseY,textHeight,textVerticalAlign),textWidth,textHeight),BoundingRect_default.intersect(overflowRect,tmpCITCTextRect,null,tmpCITCIntersectRectOpt);var outIntersectRect=tmpCITCIntersectRectOpt.outIntersectRect;out$2.outerWidth=outIntersectRect.width,out$2.outerHeight=outIntersectRect.height,out$2.baseX=adjustTextX(outIntersectRect.x,outIntersectRect.width,textAlign,!0),out$2.baseY=adjustTextY(outIntersectRect.y,outIntersectRect.height,textVerticalAlign,!0)}}var tmpCITCTextRect=new BoundingRect_default(0,0,0,0),tmpCITCIntersectRectOpt={outIntersectRect:{},clamp:!0};function formatText(text){return text==null?text=``:text+=``}function tSpanCreateBoundingRect(style){var text=formatText(style.text),font=style.font,contentWidth=measureWidth(ensureFontMeasureInfo(font),text),contentHeight=getLineHeight(font);return tSpanCreateBoundingRect2(style,contentWidth,contentHeight,null)}function tSpanCreateBoundingRect2(style,contentWidth,contentHeight,forceLineWidth){var rect=new BoundingRect_default(adjustTextX(style.x||0,contentWidth,style.textAlign),adjustTextY(style.y||0,contentHeight,style.textBaseline),contentWidth,contentHeight),lineWidth=forceLineWidth??(tSpanHasStroke(style)?style.lineWidth:0);return lineWidth>0&&(rect.x-=lineWidth/2,rect.y-=lineWidth/2,rect.width+=lineWidth,rect.height+=lineWidth),rect}function tSpanHasStroke(style){var stroke=style.stroke;return stroke!=null&&stroke!==`none`&&style.lineWidth>0}var STYLE_MAGIC_KEY=`__zr_style_`+Math.round(Math.random()*10),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:`#000`,opacity:1,blend:`source-over`},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0;var PRIMARY_STATES_KEYS=[`z`,`z2`,`invisible`],PRIMARY_STATES_KEYS_IN_HOVER_LAYER=[`invisible`],Displayable=function(_super){__extends(Displayable$1,_super);function Displayable$1(props){return _super.call(this,props)||this}return Displayable$1.prototype._init=function(props){for(var keysArr=keys(props),i$1=0;i$1<keysArr.length;i$1++){var key$1=keysArr[i$1];key$1===`style`?this.useStyle(props[key$1]):_super.prototype.attrKV.call(this,key$1,props[key$1])}this.style||this.useStyle({})},Displayable$1.prototype.beforeBrush=function(){},Displayable$1.prototype.afterBrush=function(){},Displayable$1.prototype.innerBeforeBrush=function(){},Displayable$1.prototype.innerAfterBrush=function(){},Displayable$1.prototype.shouldBePainted=function(viewWidth,viewHeight,considerClipPath,considerAncestors){var m$2=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&isDisplayableCulled(this,viewWidth,viewHeight)||m$2&&!m$2[0]&&!m$2[3])return!1;if(considerClipPath&&this.__clipPaths&&this.__clipPaths.length){for(var i$1=0;i$1<this.__clipPaths.length;++i$1)if(this.__clipPaths[i$1].isZeroArea())return!1}if(considerAncestors&&this.parent)for(var parent_1=this.parent;parent_1;){if(parent_1.ignore)return!1;parent_1=parent_1.parent}return!0},Displayable$1.prototype.contain=function(x$1,y$1){return this.rectContain(x$1,y$1)},Displayable$1.prototype.traverse=function(cb,context$1){cb.call(context$1,this)},Displayable$1.prototype.rectContain=function(x$1,y$1){var coord=this.transformCoordToLocal(x$1,y$1);return this.getBoundingRect().contain(coord[0],coord[1])},Displayable$1.prototype.getPaintRect=function(){var rect=this._paintRect;if(!this._paintRect||this.__dirty){var transform=this.transform,elRect=this.getBoundingRect(),style=this.style,shadowSize=style.shadowBlur||0,shadowOffsetX=style.shadowOffsetX||0,shadowOffsetY=style.shadowOffsetY||0;rect=this._paintRect||=new BoundingRect_default(0,0,0,0),transform?BoundingRect_default.applyTransform(rect,elRect,transform):rect.copy(elRect),(shadowSize||shadowOffsetX||shadowOffsetY)&&(rect.width+=shadowSize*2+Math.abs(shadowOffsetX),rect.height+=shadowSize*2+Math.abs(shadowOffsetY),rect.x=Math.min(rect.x,rect.x+shadowOffsetX-shadowSize),rect.y=Math.min(rect.y,rect.y+shadowOffsetY-shadowSize));var tolerance=this.dirtyRectTolerance;rect.isZero()||(rect.x=Math.floor(rect.x-tolerance),rect.y=Math.floor(rect.y-tolerance),rect.width=Math.ceil(rect.width+1+tolerance*2),rect.height=Math.ceil(rect.height+1+tolerance*2))}return rect},Displayable$1.prototype.setPrevPaintRect=function(paintRect){paintRect?(this._prevPaintRect=this._prevPaintRect||new BoundingRect_default(0,0,0,0),this._prevPaintRect.copy(paintRect)):this._prevPaintRect=null},Displayable$1.prototype.getPrevPaintRect=function(){return this._prevPaintRect},Displayable$1.prototype.animateStyle=function(loop){return this.animate(`style`,loop)},Displayable$1.prototype.updateDuringAnimation=function(targetKey){targetKey===`style`?this.dirtyStyle():this.markRedraw()},Displayable$1.prototype.attrKV=function(key$1,value){key$1===`style`?this.style?this.setStyle(value):this.useStyle(value):_super.prototype.attrKV.call(this,key$1,value)},Displayable$1.prototype.setStyle=function(keyOrObj,value){return typeof keyOrObj==`string`?this.style[keyOrObj]=value:extend(this.style,keyOrObj),this.dirtyStyle(),this},Displayable$1.prototype.dirtyStyle=function(notRedraw){notRedraw||this.markRedraw(),this.__dirty|=2,this._rect&&=null},Displayable$1.prototype.dirty=function(){this.dirtyStyle()},Displayable$1.prototype.styleChanged=function(){return!!(this.__dirty&2)},Displayable$1.prototype.styleUpdated=function(){this.__dirty&=-3},Displayable$1.prototype.createStyle=function(obj){return createObject(DEFAULT_COMMON_STYLE,obj)},Displayable$1.prototype.useStyle=function(obj){obj[STYLE_MAGIC_KEY]||(obj=this.createStyle(obj)),this.__inHover?this.__hoverStyle=obj:this.style=obj,this.dirtyStyle()},Displayable$1.prototype.isStyleObject=function(obj){return obj[STYLE_MAGIC_KEY]},Displayable$1.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.style&&!normalState.style&&(normalState.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS)},Displayable$1.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var needsRestoreToNormal=!(state&&keepCurrentStates),targetStyle;if(state&&state.style?transition?keepCurrentStates?targetStyle=state.style:(targetStyle=this._mergeStyle(this.createStyle(),normalState.style),this._mergeStyle(targetStyle,state.style)):(targetStyle=this._mergeStyle(this.createStyle(),keepCurrentStates?this.style:normalState.style),this._mergeStyle(targetStyle,state.style)):needsRestoreToNormal&&(targetStyle=normalState.style),targetStyle)if(transition){var sourceStyle=this.style;if(this.style=this.createStyle(needsRestoreToNormal?{}:sourceStyle),needsRestoreToNormal)for(var changedKeys=keys(sourceStyle),i$1=0;i$1<changedKeys.length;i$1++){var key$1=changedKeys[i$1];key$1 in targetStyle&&(targetStyle[key$1]=targetStyle[key$1],this.style[key$1]=sourceStyle[key$1])}for(var targetKeys=keys(targetStyle),i$1=0;i$1<targetKeys.length;i$1++){var key$1=targetKeys[i$1];this.style[key$1]=this.style[key$1]}this._transitionState(stateName,{style:targetStyle},animationCfg,this.getAnimationStyleProps())}else this.useStyle(targetStyle);for(var statesKeys=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS,i$1=0;i$1<statesKeys.length;i$1++){var key$1=statesKeys[i$1];state&&state[key$1]!=null?this[key$1]=state[key$1]:needsRestoreToNormal&&normalState[key$1]!=null&&(this[key$1]=normalState[key$1])}},Displayable$1.prototype._mergeStates=function(states){for(var mergedState=_super.prototype._mergeStates.call(this,states),mergedStyle,i$1=0;i$1<states.length;i$1++){var state=states[i$1];state.style&&(mergedStyle||={},this._mergeStyle(mergedStyle,state.style))}return mergedStyle&&(mergedState.style=mergedStyle),mergedState},Displayable$1.prototype._mergeStyle=function(targetStyle,sourceStyle){return extend(targetStyle,sourceStyle),targetStyle},Displayable$1.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},Displayable$1.initDefaultProps=(function(){var dispProto=Displayable$1.prototype;dispProto.type=`displayable`,dispProto.invisible=!1,dispProto.z=0,dispProto.z2=0,dispProto.zlevel=0,dispProto.culling=!1,dispProto.cursor=`pointer`,dispProto.rectHover=!1,dispProto.incremental=!1,dispProto._rect=null,dispProto.dirtyRectTolerance=0,dispProto.__dirty=3})(),Displayable$1}(Element_default),tmpRect=new BoundingRect_default(0,0,0,0),viewRect=new BoundingRect_default(0,0,0,0);function isDisplayableCulled(el,width,height){return tmpRect.copy(el.getBoundingRect()),el.transform&&tmpRect.applyTransform(el.transform),viewRect.width=width,viewRect.height=height,!tmpRect.intersect(viewRect)}var Displayable_default=Displayable,mathMin$6=Math.min,mathMax$6=Math.max,mathSin$3=Math.sin,mathCos$3=Math.cos,PI2$5=Math.PI*2,start=create(),end=create(),extremity=create();function fromLine(x0,y0,x1,y1,min$2,max$2){min$2[0]=mathMin$6(x0,x1),min$2[1]=mathMin$6(y0,y1),max$2[0]=mathMax$6(x0,x1),max$2[1]=mathMax$6(y0,y1)}var xDim=[],yDim=[];function fromCubic(x0,y0,x1,y1,x2,y2,x3,y3,min$2,max$2){var cubicExtrema$1=cubicExtrema,cubicAt$1=cubicAt,n$1=cubicExtrema$1(x0,x1,x2,x3,xDim);min$2[0]=1/0,min$2[1]=1/0,max$2[0]=-1/0,max$2[1]=-1/0;for(var i$1=0;i$1<n$1;i$1++){var x$1=cubicAt$1(x0,x1,x2,x3,xDim[i$1]);min$2[0]=mathMin$6(x$1,min$2[0]),max$2[0]=mathMax$6(x$1,max$2[0])}n$1=cubicExtrema$1(y0,y1,y2,y3,yDim);for(var i$1=0;i$1<n$1;i$1++){var y$1=cubicAt$1(y0,y1,y2,y3,yDim[i$1]);min$2[1]=mathMin$6(y$1,min$2[1]),max$2[1]=mathMax$6(y$1,max$2[1])}min$2[0]=mathMin$6(x0,min$2[0]),max$2[0]=mathMax$6(x0,max$2[0]),min$2[0]=mathMin$6(x3,min$2[0]),max$2[0]=mathMax$6(x3,max$2[0]),min$2[1]=mathMin$6(y0,min$2[1]),max$2[1]=mathMax$6(y0,max$2[1]),min$2[1]=mathMin$6(y3,min$2[1]),max$2[1]=mathMax$6(y3,max$2[1])}function fromQuadratic(x0,y0,x1,y1,x2,y2,min$2,max$2){var quadraticExtremum$1=quadraticExtremum,quadraticAt$1=quadraticAt,tx=mathMax$6(mathMin$6(quadraticExtremum$1(x0,x1,x2),1),0),ty=mathMax$6(mathMin$6(quadraticExtremum$1(y0,y1,y2),1),0),x$1=quadraticAt$1(x0,x1,x2,tx),y$1=quadraticAt$1(y0,y1,y2,ty);min$2[0]=mathMin$6(x0,x2,x$1),min$2[1]=mathMin$6(y0,y2,y$1),max$2[0]=mathMax$6(x0,x2,x$1),max$2[1]=mathMax$6(y0,y2,y$1)}function fromArc(x$1,y$1,rx,ry,startAngle,endAngle,anticlockwise,min$2,max$2){var vec2Min=min,vec2Max=max,diff=Math.abs(startAngle-endAngle);if(diff%PI2$5<1e-4&&diff>1e-4){min$2[0]=x$1-rx,min$2[1]=y$1-ry,max$2[0]=x$1+rx,max$2[1]=y$1+ry;return}if(start[0]=mathCos$3(startAngle)*rx+x$1,start[1]=mathSin$3(startAngle)*ry+y$1,end[0]=mathCos$3(endAngle)*rx+x$1,end[1]=mathSin$3(endAngle)*ry+y$1,vec2Min(min$2,start,end),vec2Max(max$2,start,end),startAngle%=PI2$5,startAngle<0&&(startAngle+=PI2$5),endAngle%=PI2$5,endAngle<0&&(endAngle+=PI2$5),startAngle>endAngle&&!anticlockwise?endAngle+=PI2$5:startAngle<endAngle&&anticlockwise&&(startAngle+=PI2$5),anticlockwise){var tmp=endAngle;endAngle=startAngle,startAngle=tmp}for(var angle=0;angle<endAngle;angle+=Math.PI/2)angle>startAngle&&(extremity[0]=mathCos$3(angle)*rx+x$1,extremity[1]=mathSin$3(angle)*ry+y$1,vec2Min(min$2,extremity,min$2),vec2Max(max$2,extremity,max$2))}var CMD$2={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min$1=[],max$1=[],min2=[],max2=[],mathMin$5=Math.min,mathMax$5=Math.max,mathCos$2=Math.cos,mathSin$2=Math.sin,mathAbs$3=Math.abs,PI$4=Math.PI,PI2$4=PI$4*2,hasTypedArray=typeof Float32Array<`u`,tmpAngles=[];function modPI2(radian){return Math.round(radian/PI$4*1e8)/1e8%2*PI$4}function normalizeArcAngles(angles,anticlockwise){var newStartAngle=modPI2(angles[0]);newStartAngle<0&&(newStartAngle+=PI2$4);var delta=newStartAngle-angles[0],newEndAngle=angles[1];newEndAngle+=delta,!anticlockwise&&newEndAngle-newStartAngle>=PI2$4?newEndAngle=newStartAngle+PI2$4:anticlockwise&&newStartAngle-newEndAngle>=PI2$4?newEndAngle=newStartAngle-PI2$4:!anticlockwise&&newStartAngle>newEndAngle?newEndAngle=newStartAngle+(PI2$4-modPI2(newStartAngle-newEndAngle)):anticlockwise&&newStartAngle<newEndAngle&&(newEndAngle=newStartAngle-(PI2$4-modPI2(newEndAngle-newStartAngle))),angles[0]=newStartAngle,angles[1]=newEndAngle}var PathProxy_default=function(){function PathProxy$1(notSaveData){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,notSaveData&&(this._saveData=!1),this._saveData&&(this.data=[])}return PathProxy$1.prototype.increaseVersion=function(){this._version++},PathProxy$1.prototype.getVersion=function(){return this._version},PathProxy$1.prototype.setScale=function(sx,sy,segmentIgnoreThreshold){segmentIgnoreThreshold||=0,segmentIgnoreThreshold>0&&(this._ux=mathAbs$3(segmentIgnoreThreshold/devicePixelRatio/sx)||0,this._uy=mathAbs$3(segmentIgnoreThreshold/devicePixelRatio/sy)||0)},PathProxy$1.prototype.setDPR=function(dpr$1){this.dpr=dpr$1},PathProxy$1.prototype.setContext=function(ctx){this._ctx=ctx},PathProxy$1.prototype.getContext=function(){return this._ctx},PathProxy$1.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},PathProxy$1.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},PathProxy$1.prototype.moveTo=function(x$1,y$1){return this._drawPendingPt(),this.addData(CMD$2.M,x$1,y$1),this._ctx&&this._ctx.moveTo(x$1,y$1),this._x0=x$1,this._y0=y$1,this._xi=x$1,this._yi=y$1,this},PathProxy$1.prototype.lineTo=function(x$1,y$1){var dx=mathAbs$3(x$1-this._xi),dy=mathAbs$3(y$1-this._yi),exceedUnit=dx>this._ux||dy>this._uy;if(this.addData(CMD$2.L,x$1,y$1),this._ctx&&exceedUnit&&this._ctx.lineTo(x$1,y$1),exceedUnit)this._xi=x$1,this._yi=y$1,this._pendingPtDist=0;else{var d2=dx*dx+dy*dy;d2>this._pendingPtDist&&(this._pendingPtX=x$1,this._pendingPtY=y$1,this._pendingPtDist=d2)}return this},PathProxy$1.prototype.bezierCurveTo=function(x1,y1,x2,y2,x3,y3){return this._drawPendingPt(),this.addData(CMD$2.C,x1,y1,x2,y2,x3,y3),this._ctx&&this._ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3),this._xi=x3,this._yi=y3,this},PathProxy$1.prototype.quadraticCurveTo=function(x1,y1,x2,y2){return this._drawPendingPt(),this.addData(CMD$2.Q,x1,y1,x2,y2),this._ctx&&this._ctx.quadraticCurveTo(x1,y1,x2,y2),this._xi=x2,this._yi=y2,this},PathProxy$1.prototype.arc=function(cx,cy,r$1,startAngle,endAngle,anticlockwise){this._drawPendingPt(),tmpAngles[0]=startAngle,tmpAngles[1]=endAngle,normalizeArcAngles(tmpAngles,anticlockwise),startAngle=tmpAngles[0],endAngle=tmpAngles[1];var delta=endAngle-startAngle;return this.addData(CMD$2.A,cx,cy,r$1,r$1,startAngle,delta,0,anticlockwise?0:1),this._ctx&&this._ctx.arc(cx,cy,r$1,startAngle,endAngle,anticlockwise),this._xi=mathCos$2(endAngle)*r$1+cx,this._yi=mathSin$2(endAngle)*r$1+cy,this},PathProxy$1.prototype.arcTo=function(x1,y1,x2,y2,radius){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(x1,y1,x2,y2,radius),this},PathProxy$1.prototype.rect=function(x$1,y$1,w$1,h$2){return this._drawPendingPt(),this._ctx&&this._ctx.rect(x$1,y$1,w$1,h$2),this.addData(CMD$2.R,x$1,y$1,w$1,h$2),this},PathProxy$1.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD$2.Z);var ctx=this._ctx,x0=this._x0,y0=this._y0;return ctx&&ctx.closePath(),this._xi=x0,this._yi=y0,this},PathProxy$1.prototype.fill=function(ctx){ctx&&ctx.fill(),this.toStatic()},PathProxy$1.prototype.stroke=function(ctx){ctx&&ctx.stroke(),this.toStatic()},PathProxy$1.prototype.len=function(){return this._len},PathProxy$1.prototype.setData=function(data){if(this._saveData){var len$1=data.length;!(this.data&&this.data.length===len$1)&&hasTypedArray&&(this.data=new Float32Array(len$1));for(var i$1=0;i$1<len$1;i$1++)this.data[i$1]=data[i$1];this._len=len$1}},PathProxy$1.prototype.appendPath=function(path$1){if(this._saveData){path$1 instanceof Array||(path$1=[path$1]);for(var len$1=path$1.length,appendSize=0,offset=this._len,i$1=0;i$1<len$1;i$1++)appendSize+=path$1[i$1].len();var oldData=this.data;if(hasTypedArray&&(oldData instanceof Float32Array||!oldData)&&(this.data=new Float32Array(offset+appendSize),offset>0&&oldData))for(var k$1=0;k$1<offset;k$1++)this.data[k$1]=oldData[k$1];for(var i$1=0;i$1<len$1;i$1++)for(var appendPathData=path$1[i$1].data,k$1=0;k$1<appendPathData.length;k$1++)this.data[offset++]=appendPathData[k$1];this._len=offset}},PathProxy$1.prototype.addData=function(cmd,a$1,b$1,c$2,d$1,e$2,f$1,g$1,h$2){if(this._saveData){var data=this.data;this._len+arguments.length>data.length&&(this._expandData(),data=this.data);for(var i$1=0;i$1<arguments.length;i$1++)data[this._len++]=arguments[i$1]}},PathProxy$1.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},PathProxy$1.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var newData=[],i$1=0;i$1<this._len;i$1++)newData[i$1]=this.data[i$1];this.data=newData}},PathProxy$1.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var data=this.data;data instanceof Array&&(data.length=this._len,hasTypedArray&&this._len>11&&(this.data=new Float32Array(data)))}},PathProxy$1.prototype.getBoundingRect=function(){min$1[0]=min$1[1]=min2[0]=min2[1]=Number.MAX_VALUE,max$1[0]=max$1[1]=max2[0]=max2[1]=-Number.MAX_VALUE;var data=this.data,xi=0,yi=0,x0=0,y0=0,i$1;for(i$1=0;i$1<this._len;){var cmd=data[i$1++],isFirst=i$1===1;switch(isFirst&&(xi=data[i$1],yi=data[i$1+1],x0=xi,y0=yi),cmd){case CMD$2.M:xi=x0=data[i$1++],yi=y0=data[i$1++],min2[0]=x0,min2[1]=y0,max2[0]=x0,max2[1]=y0;break;case CMD$2.L:fromLine(xi,yi,data[i$1],data[i$1+1],min2,max2),xi=data[i$1++],yi=data[i$1++];break;case CMD$2.C:fromCubic(xi,yi,data[i$1++],data[i$1++],data[i$1++],data[i$1++],data[i$1],data[i$1+1],min2,max2),xi=data[i$1++],yi=data[i$1++];break;case CMD$2.Q:fromQuadratic(xi,yi,data[i$1++],data[i$1++],data[i$1],data[i$1+1],min2,max2),xi=data[i$1++],yi=data[i$1++];break;case CMD$2.A:var cx=data[i$1++],cy=data[i$1++],rx=data[i$1++],ry=data[i$1++],startAngle=data[i$1++],endAngle=data[i$1++]+startAngle;i$1+=1;var anticlockwise=!data[i$1++];isFirst&&(x0=mathCos$2(startAngle)*rx+cx,y0=mathSin$2(startAngle)*ry+cy),fromArc(cx,cy,rx,ry,startAngle,endAngle,anticlockwise,min2,max2),xi=mathCos$2(endAngle)*rx+cx,yi=mathSin$2(endAngle)*ry+cy;break;case CMD$2.R:x0=xi=data[i$1++],y0=yi=data[i$1++];var width=data[i$1++],height=data[i$1++];fromLine(x0,y0,x0+width,y0+height,min2,max2);break;case CMD$2.Z:xi=x0,yi=y0;break}min(min$1,min$1,min2),max(max$1,max$1,max2)}return i$1===0&&(min$1[0]=min$1[1]=max$1[0]=max$1[1]=0),new BoundingRect_default(min$1[0],min$1[1],max$1[0]-min$1[0],max$1[1]-min$1[1])},PathProxy$1.prototype._calculateLength=function(){var data=this.data,len$1=this._len,ux$1=this._ux,uy$1=this._uy,xi=0,yi=0,x0=0,y0=0;this._pathSegLen||=[];for(var pathSegLen=this._pathSegLen,pathTotalLen=0,segCount=0,i$1=0;i$1<len$1;){var cmd=data[i$1++],isFirst=i$1===1;isFirst&&(xi=data[i$1],yi=data[i$1+1],x0=xi,y0=yi);var l$1=-1;switch(cmd){case CMD$2.M:xi=x0=data[i$1++],yi=y0=data[i$1++];break;case CMD$2.L:var x2=data[i$1++],y2=data[i$1++],dx=x2-xi,dy=y2-yi;(mathAbs$3(dx)>ux$1||mathAbs$3(dy)>uy$1||i$1===len$1-1)&&(l$1=Math.sqrt(dx*dx+dy*dy),xi=x2,yi=y2);break;case CMD$2.C:var x1=data[i$1++],y1=data[i$1++],x2=data[i$1++],y2=data[i$1++],x3=data[i$1++],y3=data[i$1++];l$1=cubicLength(xi,yi,x1,y1,x2,y2,x3,y3,10),xi=x3,yi=y3;break;case CMD$2.Q:var x1=data[i$1++],y1=data[i$1++],x2=data[i$1++],y2=data[i$1++];l$1=quadraticLength(xi,yi,x1,y1,x2,y2,10),xi=x2,yi=y2;break;case CMD$2.A:var cx=data[i$1++],cy=data[i$1++],rx=data[i$1++],ry=data[i$1++],startAngle=data[i$1++],delta=data[i$1++],endAngle=delta+startAngle;i$1+=1,isFirst&&(x0=mathCos$2(startAngle)*rx+cx,y0=mathSin$2(startAngle)*ry+cy),l$1=mathMax$5(rx,ry)*mathMin$5(PI2$4,Math.abs(delta)),xi=mathCos$2(endAngle)*rx+cx,yi=mathSin$2(endAngle)*ry+cy;break;case CMD$2.R:x0=xi=data[i$1++],y0=yi=data[i$1++];var width=data[i$1++],height=data[i$1++];l$1=width*2+height*2;break;case CMD$2.Z:var dx=x0-xi,dy=y0-yi;l$1=Math.sqrt(dx*dx+dy*dy),xi=x0,yi=y0;break}l$1>=0&&(pathSegLen[segCount++]=l$1,pathTotalLen+=l$1)}return this._pathLen=pathTotalLen,pathTotalLen},PathProxy$1.prototype.rebuildPath=function(ctx,percent){var d$1=this.data,ux$1=this._ux,uy$1=this._uy,len$1=this._len,x0,y0,xi,yi,x$1,y$1,drawPart=percent<1,pathSegLen,pathTotalLen,accumLength=0,segCount=0,displayedLength,pendingPtDist=0,pendingPtX,pendingPtY;if(!(drawPart&&(this._pathSegLen||this._calculateLength(),pathSegLen=this._pathSegLen,pathTotalLen=this._pathLen,displayedLength=percent*pathTotalLen,!displayedLength)))lo:for(var i$1=0;i$1<len$1;){var cmd=d$1[i$1++],isFirst=i$1===1;switch(isFirst&&(xi=d$1[i$1],yi=d$1[i$1+1],x0=xi,y0=yi),cmd!==CMD$2.L&&pendingPtDist>0&&(ctx.lineTo(pendingPtX,pendingPtY),pendingPtDist=0),cmd){case CMD$2.M:x0=xi=d$1[i$1++],y0=yi=d$1[i$1++],ctx.moveTo(xi,yi);break;case CMD$2.L:x$1=d$1[i$1++],y$1=d$1[i$1++];var dx=mathAbs$3(x$1-xi),dy=mathAbs$3(y$1-yi);if(dx>ux$1||dy>uy$1){if(drawPart){var l$1=pathSegLen[segCount++];if(accumLength+l$1>displayedLength){var t$1=(displayedLength-accumLength)/l$1;ctx.lineTo(xi*(1-t$1)+x$1*t$1,yi*(1-t$1)+y$1*t$1);break lo}accumLength+=l$1}ctx.lineTo(x$1,y$1),xi=x$1,yi=y$1,pendingPtDist=0}else{var d2=dx*dx+dy*dy;d2>pendingPtDist&&(pendingPtX=x$1,pendingPtY=y$1,pendingPtDist=d2)}break;case CMD$2.C:var x1=d$1[i$1++],y1=d$1[i$1++],x2=d$1[i$1++],y2=d$1[i$1++],x3=d$1[i$1++],y3=d$1[i$1++];if(drawPart){var l$1=pathSegLen[segCount++];if(accumLength+l$1>displayedLength){var t$1=(displayedLength-accumLength)/l$1;cubicSubdivide(xi,x1,x2,x3,t$1,tmpOutX),cubicSubdivide(yi,y1,y2,y3,t$1,tmpOutY),ctx.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break lo}accumLength+=l$1}ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3),xi=x3,yi=y3;break;case CMD$2.Q:var x1=d$1[i$1++],y1=d$1[i$1++],x2=d$1[i$1++],y2=d$1[i$1++];if(drawPart){var l$1=pathSegLen[segCount++];if(accumLength+l$1>displayedLength){var t$1=(displayedLength-accumLength)/l$1;quadraticSubdivide(xi,x1,x2,t$1,tmpOutX),quadraticSubdivide(yi,y1,y2,t$1,tmpOutY),ctx.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break lo}accumLength+=l$1}ctx.quadraticCurveTo(x1,y1,x2,y2),xi=x2,yi=y2;break;case CMD$2.A:var cx=d$1[i$1++],cy=d$1[i$1++],rx=d$1[i$1++],ry=d$1[i$1++],startAngle=d$1[i$1++],delta=d$1[i$1++],psi=d$1[i$1++],anticlockwise=!d$1[i$1++],r$1=rx>ry?rx:ry,isEllipse=mathAbs$3(rx-ry)>.001,endAngle=startAngle+delta,breakBuild=!1;if(drawPart){var l$1=pathSegLen[segCount++];accumLength+l$1>displayedLength&&(endAngle=startAngle+delta*(displayedLength-accumLength)/l$1,breakBuild=!0),accumLength+=l$1}if(isEllipse&&ctx.ellipse?ctx.ellipse(cx,cy,rx,ry,psi,startAngle,endAngle,anticlockwise):ctx.arc(cx,cy,r$1,startAngle,endAngle,anticlockwise),breakBuild)break lo;isFirst&&(x0=mathCos$2(startAngle)*rx+cx,y0=mathSin$2(startAngle)*ry+cy),xi=mathCos$2(endAngle)*rx+cx,yi=mathSin$2(endAngle)*ry+cy;break;case CMD$2.R:x0=xi=d$1[i$1],y0=yi=d$1[i$1+1],x$1=d$1[i$1++],y$1=d$1[i$1++];var width=d$1[i$1++],height=d$1[i$1++];if(drawPart){var l$1=pathSegLen[segCount++];if(accumLength+l$1>displayedLength){var d_1=displayedLength-accumLength;ctx.moveTo(x$1,y$1),ctx.lineTo(x$1+mathMin$5(d_1,width),y$1),d_1-=width,d_1>0&&ctx.lineTo(x$1+width,y$1+mathMin$5(d_1,height)),d_1-=height,d_1>0&&ctx.lineTo(x$1+mathMax$5(width-d_1,0),y$1+height),d_1-=width,d_1>0&&ctx.lineTo(x$1,y$1+mathMax$5(height-d_1,0));break lo}accumLength+=l$1}ctx.rect(x$1,y$1,width,height);break;case CMD$2.Z:if(drawPart){var l$1=pathSegLen[segCount++];if(accumLength+l$1>displayedLength){var t$1=(displayedLength-accumLength)/l$1;ctx.lineTo(xi*(1-t$1)+x0*t$1,yi*(1-t$1)+y0*t$1);break lo}accumLength+=l$1}ctx.closePath(),xi=x0,yi=y0}}},PathProxy$1.prototype.clone=function(){var newProxy=new PathProxy$1,data=this.data;return newProxy.data=data.slice?data.slice():Array.prototype.slice.call(data),newProxy._len=this._len,newProxy},PathProxy$1.prototype.canSave=function(){return!!this._saveData},PathProxy$1.CMD=CMD$2,PathProxy$1.initDefaultProps=(function(){var proto=PathProxy$1.prototype;proto._saveData=!0,proto._ux=0,proto._uy=0,proto._pendingPtDist=0,proto._version=0})(),PathProxy$1}();function containStroke$4(x0,y0,x1,y1,lineWidth,x$1,y$1){if(lineWidth===0)return!1;var _l=lineWidth,_a$1=0,_b$1=x0;if(y$1>y0+_l&&y$1>y1+_l||y$1<y0-_l&&y$1<y1-_l||x$1>x0+_l&&x$1>x1+_l||x$1<x0-_l&&x$1<x1-_l)return!1;if(x0!==x1)_a$1=(y0-y1)/(x0-x1),_b$1=(x0*y1-x1*y0)/(x0-x1);else return Math.abs(x$1-x0)<=_l/2;var tmp=_a$1*x$1-y$1+_b$1;return tmp*tmp/(_a$1*_a$1+1)<=_l/2*_l/2}function containStroke$3(x0,y0,x1,y1,x2,y2,x3,y3,lineWidth,x$1,y$1){if(lineWidth===0)return!1;var _l=lineWidth;return y$1>y0+_l&&y$1>y1+_l&&y$1>y2+_l&&y$1>y3+_l||y$1<y0-_l&&y$1<y1-_l&&y$1<y2-_l&&y$1<y3-_l||x$1>x0+_l&&x$1>x1+_l&&x$1>x2+_l&&x$1>x3+_l||x$1<x0-_l&&x$1<x1-_l&&x$1<x2-_l&&x$1<x3-_l?!1:cubicProjectPoint(x0,y0,x1,y1,x2,y2,x3,y3,x$1,y$1,null)<=_l/2}function containStroke$2(x0,y0,x1,y1,x2,y2,lineWidth,x$1,y$1){if(lineWidth===0)return!1;var _l=lineWidth;return y$1>y0+_l&&y$1>y1+_l&&y$1>y2+_l||y$1<y0-_l&&y$1<y1-_l&&y$1<y2-_l||x$1>x0+_l&&x$1>x1+_l&&x$1>x2+_l||x$1<x0-_l&&x$1<x1-_l&&x$1<x2-_l?!1:quadraticProjectPoint(x0,y0,x1,y1,x2,y2,x$1,y$1,null)<=_l/2}var PI2$3=Math.PI*2;function normalizeRadian(angle){return angle%=PI2$3,angle<0&&(angle+=PI2$3),angle}var PI2$2=Math.PI*2;function containStroke$1(cx,cy,r$1,startAngle,endAngle,anticlockwise,lineWidth,x$1,y$1){if(lineWidth===0)return!1;var _l=lineWidth;x$1-=cx,y$1-=cy;var d$1=Math.sqrt(x$1*x$1+y$1*y$1);if(d$1-_l>r$1||d$1+_l<r$1)return!1;if(Math.abs(startAngle-endAngle)%PI2$2<1e-4)return!0;if(anticlockwise){var tmp=startAngle;startAngle=normalizeRadian(endAngle),endAngle=normalizeRadian(tmp)}else startAngle=normalizeRadian(startAngle),endAngle=normalizeRadian(endAngle);startAngle>endAngle&&(endAngle+=PI2$2);var angle=Math.atan2(y$1,x$1);return angle<0&&(angle+=PI2$2),angle>=startAngle&&angle<=endAngle||angle+PI2$2>=startAngle&&angle+PI2$2<=endAngle}function windingLine(x0,y0,x1,y1,x$1,y$1){if(y$1>y0&&y$1>y1||y$1<y0&&y$1<y1||y1===y0)return 0;var t$1=(y$1-y0)/(y1-y0),dir=y1<y0?1:-1;(t$1===1||t$1===0)&&(dir=y1<y0?.5:-.5);var x_=t$1*(x1-x0)+x0;return x_===x$1?1/0:x_>x$1?dir:0}var CMD$1=PathProxy_default.CMD,PI2$1=Math.PI*2,EPSILON=1e-4;function isAroundEqual(a$1,b$1){return Math.abs(a$1-b$1)<EPSILON}var roots=[-1,-1,-1],extrema=[-1,-1];function swapExtrema(){var tmp=extrema[0];extrema[0]=extrema[1],extrema[1]=tmp}function windingCubic(x0,y0,x1,y1,x2,y2,x3,y3,x$1,y$1){if(y$1>y0&&y$1>y1&&y$1>y2&&y$1>y3||y$1<y0&&y$1<y1&&y$1<y2&&y$1<y3)return 0;var nRoots=cubicRootAt(y0,y1,y2,y3,y$1,roots);if(nRoots===0)return 0;for(var w$1=0,nExtrema=-1,y0_=void 0,y1_=void 0,i$1=0;i$1<nRoots;i$1++){var t$1=roots[i$1],unit=t$1===0||t$1===1?.5:1;cubicAt(x0,x1,x2,x3,t$1)<x$1||(nExtrema<0&&(nExtrema=cubicExtrema(y0,y1,y2,y3,extrema),extrema[1]<extrema[0]&&nExtrema>1&&swapExtrema(),y0_=cubicAt(y0,y1,y2,y3,extrema[0]),nExtrema>1&&(y1_=cubicAt(y0,y1,y2,y3,extrema[1]))),nExtrema===2?t$1<extrema[0]?w$1+=y0_<y0?unit:-unit:t$1<extrema[1]?w$1+=y1_<y0_?unit:-unit:w$1+=y3<y1_?unit:-unit:t$1<extrema[0]?w$1+=y0_<y0?unit:-unit:w$1+=y3<y0_?unit:-unit)}return w$1}function windingQuadratic(x0,y0,x1,y1,x2,y2,x$1,y$1){if(y$1>y0&&y$1>y1&&y$1>y2||y$1<y0&&y$1<y1&&y$1<y2)return 0;var nRoots=quadraticRootAt(y0,y1,y2,y$1,roots);if(nRoots===0)return 0;var t$1=quadraticExtremum(y0,y1,y2);if(t$1>=0&&t$1<=1){for(var w$1=0,y_=quadraticAt(y0,y1,y2,t$1),i$1=0;i$1<nRoots;i$1++){var unit=roots[i$1]===0||roots[i$1]===1?.5:1,x_=quadraticAt(x0,x1,x2,roots[i$1]);x_<x$1||(roots[i$1]<t$1?w$1+=y_<y0?unit:-unit:w$1+=y2<y_?unit:-unit)}return w$1}else{var unit=roots[0]===0||roots[0]===1?.5:1,x_=quadraticAt(x0,x1,x2,roots[0]);return x_<x$1?0:y2<y0?unit:-unit}}function windingArc(cx,cy,r$1,startAngle,endAngle,anticlockwise,x$1,y$1){if(y$1-=cy,y$1>r$1||y$1<-r$1)return 0;var tmp=Math.sqrt(r$1*r$1-y$1*y$1);roots[0]=-tmp,roots[1]=tmp;var dTheta=Math.abs(startAngle-endAngle);if(dTheta<1e-4)return 0;if(dTheta>=PI2$1-1e-4){startAngle=0,endAngle=PI2$1;var dir=anticlockwise?1:-1;return x$1>=roots[0]+cx&&x$1<=roots[1]+cx?dir:0}if(startAngle>endAngle){var tmp_1=startAngle;startAngle=endAngle,endAngle=tmp_1}startAngle<0&&(startAngle+=PI2$1,endAngle+=PI2$1);for(var w$1=0,i$1=0;i$1<2;i$1++){var x_=roots[i$1];if(x_+cx>x$1){var angle=Math.atan2(y$1,x_),dir=anticlockwise?1:-1;angle<0&&(angle=PI2$1+angle),(angle>=startAngle&&angle<=endAngle||angle+PI2$1>=startAngle&&angle+PI2$1<=endAngle)&&(angle>Math.PI/2&&angle<Math.PI*1.5&&(dir=-dir),w$1+=dir)}}return w$1}function containPath(path$1,lineWidth,isStroke,x$1,y$1){for(var data=path$1.data,len$1=path$1.len(),w$1=0,xi=0,yi=0,x0=0,y0=0,x1,y1,i$1=0;i$1<len$1;){var cmd=data[i$1++],isFirst=i$1===1;switch(cmd===CMD$1.M&&i$1>1&&(isStroke||(w$1+=windingLine(xi,yi,x0,y0,x$1,y$1))),isFirst&&(xi=data[i$1],yi=data[i$1+1],x0=xi,y0=yi),cmd){case CMD$1.M:x0=data[i$1++],y0=data[i$1++],xi=x0,yi=y0;break;case CMD$1.L:if(isStroke){if(containStroke$4(xi,yi,data[i$1],data[i$1+1],lineWidth,x$1,y$1))return!0}else w$1+=windingLine(xi,yi,data[i$1],data[i$1+1],x$1,y$1)||0;xi=data[i$1++],yi=data[i$1++];break;case CMD$1.C:if(isStroke){if(containStroke$3(xi,yi,data[i$1++],data[i$1++],data[i$1++],data[i$1++],data[i$1],data[i$1+1],lineWidth,x$1,y$1))return!0}else w$1+=windingCubic(xi,yi,data[i$1++],data[i$1++],data[i$1++],data[i$1++],data[i$1],data[i$1+1],x$1,y$1)||0;xi=data[i$1++],yi=data[i$1++];break;case CMD$1.Q:if(isStroke){if(containStroke$2(xi,yi,data[i$1++],data[i$1++],data[i$1],data[i$1+1],lineWidth,x$1,y$1))return!0}else w$1+=windingQuadratic(xi,yi,data[i$1++],data[i$1++],data[i$1],data[i$1+1],x$1,y$1)||0;xi=data[i$1++],yi=data[i$1++];break;case CMD$1.A:var cx=data[i$1++],cy=data[i$1++],rx=data[i$1++],ry=data[i$1++],theta=data[i$1++],dTheta=data[i$1++];i$1+=1;var anticlockwise=!!(1-data[i$1++]);x1=Math.cos(theta)*rx+cx,y1=Math.sin(theta)*ry+cy,isFirst?(x0=x1,y0=y1):w$1+=windingLine(xi,yi,x1,y1,x$1,y$1);var _x=(x$1-cx)*ry/rx+cx;if(isStroke){if(containStroke$1(cx,cy,ry,theta,theta+dTheta,anticlockwise,lineWidth,_x,y$1))return!0}else w$1+=windingArc(cx,cy,ry,theta,theta+dTheta,anticlockwise,_x,y$1);xi=Math.cos(theta+dTheta)*rx+cx,yi=Math.sin(theta+dTheta)*ry+cy;break;case CMD$1.R:x0=xi=data[i$1++],y0=yi=data[i$1++];var width=data[i$1++],height=data[i$1++];if(x1=x0+width,y1=y0+height,isStroke){if(containStroke$4(x0,y0,x1,y0,lineWidth,x$1,y$1)||containStroke$4(x1,y0,x1,y1,lineWidth,x$1,y$1)||containStroke$4(x1,y1,x0,y1,lineWidth,x$1,y$1)||containStroke$4(x0,y1,x0,y0,lineWidth,x$1,y$1))return!0}else w$1+=windingLine(x1,y0,x1,y1,x$1,y$1),w$1+=windingLine(x0,y1,x0,y0,x$1,y$1);break;case CMD$1.Z:if(isStroke){if(containStroke$4(xi,yi,x0,y0,lineWidth,x$1,y$1))return!0}else w$1+=windingLine(xi,yi,x0,y0,x$1,y$1);xi=x0,yi=y0;break}}return!isStroke&&!isAroundEqual(yi,y0)&&(w$1+=windingLine(xi,yi,x0,y0,x$1,y$1)||0),w$1!==0}function contain$1(pathProxy,x$1,y$1){return containPath(pathProxy,0,!1,x$1,y$1)}function containStroke(pathProxy,lineWidth,x$1,y$1){return containPath(pathProxy,lineWidth,!0,x$1,y$1)}var DEFAULT_PATH_STYLE=defaults({fill:`#000`,stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:`butt`,miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat([`invisible`,`culling`,`z`,`z2`,`zlevel`,`parent`]),Path_default=function(_super){__extends(Path$1,_super);function Path$1(opts){return _super.call(this,opts)||this}return Path$1.prototype.update=function(){var _this=this;_super.prototype.update.call(this);var style=this.style;if(style.decal){var decalEl=this._decalEl=this._decalEl||new Path$1;decalEl.buildPath===Path$1.prototype.buildPath&&(decalEl.buildPath=function(ctx){_this.buildPath(ctx,_this.shape)}),decalEl.silent=!0;var decalElStyle=decalEl.style;for(var key$1 in style)decalElStyle[key$1]!==style[key$1]&&(decalElStyle[key$1]=style[key$1]);decalElStyle.fill=style.fill?style.decal:null,decalElStyle.decal=null,decalElStyle.shadowColor=null,style.strokeFirst&&(decalElStyle.stroke=null);for(var i$1=0;i$1<pathCopyParams.length;++i$1)decalEl[pathCopyParams[i$1]]=this[pathCopyParams[i$1]];decalEl.__dirty|=1}else this._decalEl&&=null},Path$1.prototype.getDecalElement=function(){return this._decalEl},Path$1.prototype._init=function(props){var keysArr=keys(props);this.shape=this.getDefaultShape();var defaultStyle=this.getDefaultStyle();defaultStyle&&this.useStyle(defaultStyle);for(var i$1=0;i$1<keysArr.length;i$1++){var key$1=keysArr[i$1],value=props[key$1];key$1===`style`?this.style?extend(this.style,value):this.useStyle(value):key$1===`shape`?extend(this.shape,value):_super.prototype.attrKV.call(this,key$1,value)}this.style||this.useStyle({})},Path$1.prototype.getDefaultStyle=function(){return null},Path$1.prototype.getDefaultShape=function(){return{}},Path$1.prototype.canBeInsideText=function(){return this.hasFill()},Path$1.prototype.getInsideTextFill=function(){var pathFill=this.style.fill;if(pathFill!==`none`){if(isString(pathFill)){var fillLum=lum(pathFill,0);return fillLum>.5?DARK_LABEL_COLOR:fillLum>.2?LIGHTER_LABEL_COLOR:LIGHT_LABEL_COLOR}else if(pathFill)return LIGHT_LABEL_COLOR}return DARK_LABEL_COLOR},Path$1.prototype.getInsideTextStroke=function(textFill){var pathFill=this.style.fill;if(isString(pathFill)){var zr=this.__zr,isDarkMode$1=!!(zr&&zr.isDarkMode()),isDarkLabel=lum(textFill,0)<DARK_MODE_THRESHOLD;if(isDarkMode$1===isDarkLabel)return pathFill}},Path$1.prototype.buildPath=function(ctx,shapeCfg,inBatch){},Path$1.prototype.pathUpdated=function(){this.__dirty&=-5},Path$1.prototype.getUpdatedPathProxy=function(inBatch){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,inBatch),this.path},Path$1.prototype.createPathProxy=function(){this.path=new PathProxy_default(!1)},Path$1.prototype.hasStroke=function(){var style=this.style,stroke=style.stroke;return!(stroke==null||stroke===`none`||!(style.lineWidth>0))},Path$1.prototype.hasFill=function(){var fill=this.style.fill;return fill!=null&&fill!==`none`},Path$1.prototype.getBoundingRect=function(){var rect=this._rect,style=this.style,needsUpdateRect=!rect;if(needsUpdateRect){var firstInvoke=!1;this.path||(firstInvoke=!0,this.createPathProxy());var path$1=this.path;(firstInvoke||this.__dirty&4)&&(path$1.beginPath(),this.buildPath(path$1,this.shape,!1),this.pathUpdated()),rect=path$1.getBoundingRect()}if(this._rect=rect,this.hasStroke()&&this.path&&this.path.len()>0){var rectStroke=this._rectStroke||=rect.clone();if(this.__dirty||needsUpdateRect){rectStroke.copy(rect);var lineScale=style.strokeNoScale?this.getLineScale():1,w$1=style.lineWidth;if(!this.hasFill()){var strokeContainThreshold=this.strokeContainThreshold;w$1=Math.max(w$1,strokeContainThreshold??4)}lineScale>1e-10&&(rectStroke.width+=w$1/lineScale,rectStroke.height+=w$1/lineScale,rectStroke.x-=w$1/lineScale/2,rectStroke.y-=w$1/lineScale/2)}return rectStroke}return rect},Path$1.prototype.contain=function(x$1,y$1){var localPos=this.transformCoordToLocal(x$1,y$1),rect=this.getBoundingRect(),style=this.style;if(x$1=localPos[0],y$1=localPos[1],rect.contain(x$1,y$1)){var pathProxy=this.path;if(this.hasStroke()){var lineWidth=style.lineWidth,lineScale=style.strokeNoScale?this.getLineScale():1;if(lineScale>1e-10&&(this.hasFill()||(lineWidth=Math.max(lineWidth,this.strokeContainThreshold)),containStroke(pathProxy,lineWidth/lineScale,x$1,y$1)))return!0}if(this.hasFill())return contain$1(pathProxy,x$1,y$1)}return!1},Path$1.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&=null,this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},Path$1.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},Path$1.prototype.animateShape=function(loop){return this.animate(`shape`,loop)},Path$1.prototype.updateDuringAnimation=function(targetKey){targetKey===`style`?this.dirtyStyle():targetKey===`shape`?this.dirtyShape():this.markRedraw()},Path$1.prototype.attrKV=function(key$1,value){key$1===`shape`?this.setShape(value):_super.prototype.attrKV.call(this,key$1,value)},Path$1.prototype.setShape=function(keyOrObj,value){var shape=this.shape;return shape||=this.shape={},typeof keyOrObj==`string`?shape[keyOrObj]=value:extend(shape,keyOrObj),this.dirtyShape(),this},Path$1.prototype.shapeChanged=function(){return!!(this.__dirty&4)},Path$1.prototype.createStyle=function(obj){return createObject(DEFAULT_PATH_STYLE,obj)},Path$1.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.shape&&!normalState.shape&&(normalState.shape=extend({},this.shape))},Path$1.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var needsRestoreToNormal=!(state&&keepCurrentStates),targetShape;if(state&&state.shape?transition?keepCurrentStates?targetShape=state.shape:(targetShape=extend({},normalState.shape),extend(targetShape,state.shape)):(targetShape=extend({},keepCurrentStates?this.shape:normalState.shape),extend(targetShape,state.shape)):needsRestoreToNormal&&(targetShape=normalState.shape),targetShape)if(transition){this.shape=extend({},this.shape);for(var targetShapePrimaryProps={},shapeKeys=keys(targetShape),i$1=0;i$1<shapeKeys.length;i$1++){var key$1=shapeKeys[i$1];typeof targetShape[key$1]==`object`?this.shape[key$1]=targetShape[key$1]:targetShapePrimaryProps[key$1]=targetShape[key$1]}this._transitionState(stateName,{shape:targetShapePrimaryProps},animationCfg)}else this.shape=targetShape,this.dirtyShape()},Path$1.prototype._mergeStates=function(states){for(var mergedState=_super.prototype._mergeStates.call(this,states),mergedShape,i$1=0;i$1<states.length;i$1++){var state=states[i$1];state.shape&&(mergedShape||={},this._mergeStyle(mergedShape,state.shape))}return mergedShape&&(mergedState.shape=mergedShape),mergedState},Path$1.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},Path$1.prototype.isZeroArea=function(){return!1},Path$1.extend=function(defaultProps){var Sub=function(_super$1){__extends(Sub$1,_super$1);function Sub$1(opts){var _this=_super$1.call(this,opts)||this;return defaultProps.init&&defaultProps.init.call(_this,opts),_this}return Sub$1.prototype.getDefaultStyle=function(){return clone(defaultProps.style)},Sub$1.prototype.getDefaultShape=function(){return clone(defaultProps.shape)},Sub$1}(Path$1);for(var key$1 in defaultProps)typeof defaultProps[key$1]==`function`&&(Sub.prototype[key$1]=defaultProps[key$1]);return Sub},Path$1.initDefaultProps=(function(){var pathProto=Path$1.prototype;pathProto.type=`path`,pathProto.strokeContainThreshold=5,pathProto.segmentIgnoreThreshold=0,pathProto.subPixelOptimize=!1,pathProto.autoBatch=!1,pathProto.__dirty=7})(),Path$1}(Displayable_default),DEFAULT_TSPAN_STYLE=defaults({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:`left`,textBaseline:`top`,miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(_super){__extends(TSpan$1,_super);function TSpan$1(){return _super!==null&&_super.apply(this,arguments)||this}return TSpan$1.prototype.hasStroke=function(){return tSpanHasStroke(this.style)},TSpan$1.prototype.hasFill=function(){var fill=this.style.fill;return fill!=null&&fill!==`none`},TSpan$1.prototype.createStyle=function(obj){return createObject(DEFAULT_TSPAN_STYLE,obj)},TSpan$1.prototype.setBoundingRect=function(rect){this._rect=rect},TSpan$1.prototype.getBoundingRect=function(){return this._rect||=tSpanCreateBoundingRect(this.style),this._rect},TSpan$1.initDefaultProps=(function(){var tspanProto=TSpan$1.prototype;tspanProto.dirtyRectTolerance=10})(),TSpan$1}(Displayable_default);TSpan.prototype.type=`tspan`;var TSpan_default=TSpan,DEFAULT_IMAGE_STYLE=defaults({x:0,y:0},DEFAULT_COMMON_STYLE),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};function isImageLike(source$2){return!!(source$2&&typeof source$2!=`string`&&source$2.width&&source$2.height)}var ZRImage=function(_super){__extends(ZRImage$1,_super);function ZRImage$1(){return _super!==null&&_super.apply(this,arguments)||this}return ZRImage$1.prototype.createStyle=function(obj){return createObject(DEFAULT_IMAGE_STYLE,obj)},ZRImage$1.prototype._getSize=function(dim){var style=this.style,size=style[dim];if(size!=null)return size;var imageSource=isImageLike(style.image)?style.image:this.__image;if(!imageSource)return 0;var otherDim=dim===`width`?`height`:`width`,otherDimSize=style[otherDim];return otherDimSize==null?imageSource[dim]:imageSource[dim]/imageSource[otherDim]*otherDimSize},ZRImage$1.prototype.getWidth=function(){return this._getSize(`width`)},ZRImage$1.prototype.getHeight=function(){return this._getSize(`height`)},ZRImage$1.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},ZRImage$1.prototype.getBoundingRect=function(){var style=this.style;return this._rect||=new BoundingRect_default(style.x||0,style.y||0,this.getWidth(),this.getHeight()),this._rect},ZRImage$1}(Displayable_default);ZRImage.prototype.type=`image`;var Image_default=ZRImage;function buildPath$2(ctx,shape){var x$1=shape.x,y$1=shape.y,width=shape.width,height=shape.height,r$1=shape.r,r1,r2,r3,r4;width<0&&(x$1+=width,width=-width),height<0&&(y$1+=height,height=-height),typeof r$1==`number`?r1=r2=r3=r4=r$1:r$1 instanceof Array?r$1.length===1?r1=r2=r3=r4=r$1[0]:r$1.length===2?(r1=r3=r$1[0],r2=r4=r$1[1]):r$1.length===3?(r1=r$1[0],r2=r4=r$1[1],r3=r$1[2]):(r1=r$1[0],r2=r$1[1],r3=r$1[2],r4=r$1[3]):r1=r2=r3=r4=0;var total;r1+r2>width&&(total=r1+r2,r1*=width/total,r2*=width/total),r3+r4>width&&(total=r3+r4,r3*=width/total,r4*=width/total),r2+r3>height&&(total=r2+r3,r2*=height/total,r3*=height/total),r1+r4>height&&(total=r1+r4,r1*=height/total,r4*=height/total),ctx.moveTo(x$1+r1,y$1),ctx.lineTo(x$1+width-r2,y$1),r2!==0&&ctx.arc(x$1+width-r2,y$1+r2,r2,-Math.PI/2,0),ctx.lineTo(x$1+width,y$1+height-r3),r3!==0&&ctx.arc(x$1+width-r3,y$1+height-r3,r3,0,Math.PI/2),ctx.lineTo(x$1+r4,y$1+height),r4!==0&&ctx.arc(x$1+r4,y$1+height-r4,r4,Math.PI/2,Math.PI),ctx.lineTo(x$1,y$1+r1),r1!==0&&ctx.arc(x$1+r1,y$1+r1,r1,Math.PI,Math.PI*1.5)}var round$1=Math.round;function subPixelOptimizeLine$1(outputShape,inputShape,style){if(inputShape){var x1=inputShape.x1,x2=inputShape.x2,y1=inputShape.y1,y2=inputShape.y2;outputShape.x1=x1,outputShape.x2=x2,outputShape.y1=y1,outputShape.y2=y2;var lineWidth=style&&style.lineWidth;return lineWidth?(round$1(x1*2)===round$1(x2*2)&&(outputShape.x1=outputShape.x2=subPixelOptimize$1(x1,lineWidth,!0)),round$1(y1*2)===round$1(y2*2)&&(outputShape.y1=outputShape.y2=subPixelOptimize$1(y1,lineWidth,!0)),outputShape):outputShape}}function subPixelOptimizeRect$1(outputShape,inputShape,style){if(inputShape){var originX=inputShape.x,originY=inputShape.y,originWidth=inputShape.width,originHeight=inputShape.height;outputShape.x=originX,outputShape.y=originY,outputShape.width=originWidth,outputShape.height=originHeight;var lineWidth=style&&style.lineWidth;return lineWidth?(outputShape.x=subPixelOptimize$1(originX,lineWidth,!0),outputShape.y=subPixelOptimize$1(originY,lineWidth,!0),outputShape.width=Math.max(subPixelOptimize$1(originX+originWidth,lineWidth,!1)-outputShape.x,originWidth===0?0:1),outputShape.height=Math.max(subPixelOptimize$1(originY+originHeight,lineWidth,!1)-outputShape.y,originHeight===0?0:1),outputShape):outputShape}}function subPixelOptimize$1(position,lineWidth,positiveOrNegative){if(!lineWidth)return position;var doubledPosition=round$1(position*2);return(doubledPosition+round$1(lineWidth))%2==0?doubledPosition/2:(doubledPosition+(positiveOrNegative?1:-1))/2}var RectShape=function(){function RectShape$1(){this.x=0,this.y=0,this.width=0,this.height=0}return RectShape$1}(),subPixelOptimizeOutputShape$1={},Rect$1=function(_super){__extends(Rect$2,_super);function Rect$2(opts){return _super.call(this,opts)||this}return Rect$2.prototype.getDefaultShape=function(){return new RectShape},Rect$2.prototype.buildPath=function(ctx,shape){var x$1,y$1,width,height;if(this.subPixelOptimize){var optimizedShape=subPixelOptimizeRect$1(subPixelOptimizeOutputShape$1,shape,this.style);x$1=optimizedShape.x,y$1=optimizedShape.y,width=optimizedShape.width,height=optimizedShape.height,optimizedShape.r=shape.r,shape=optimizedShape}else x$1=shape.x,y$1=shape.y,width=shape.width,height=shape.height;shape.r?buildPath$2(ctx,shape):ctx.rect(x$1,y$1,width,height)},Rect$2.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},Rect$2}(Path_default);Rect$1.prototype.type=`rect`;var Rect_default=Rect$1,DEFAULT_RICH_TEXT_COLOR={fill:`#000`},DEFAULT_STROKE_LINE_WIDTH=2,tmpCITOverflowAreaOut={},DEFAULT_TEXT_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(_super){__extends(ZRText$1,_super);function ZRText$1(opts){var _this=_super.call(this)||this;return _this.type=`text`,_this._children=[],_this._defaultStyle=DEFAULT_RICH_TEXT_COLOR,_this.attr(opts),_this}return ZRText$1.prototype.childrenRef=function(){return this._children},ZRText$1.prototype.update=function(){_super.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var i$1=0;i$1<this._children.length;i$1++){var child=this._children[i$1];child.zlevel=this.zlevel,child.z=this.z,child.z2=this.z2,child.culling=this.culling,child.cursor=this.cursor,child.invisible=this.invisible}},ZRText$1.prototype.updateTransform=function(){var innerTransformable=this.innerTransformable;innerTransformable?(innerTransformable.updateTransform(),innerTransformable.transform&&(this.transform=innerTransformable.transform)):_super.prototype.updateTransform.call(this)},ZRText$1.prototype.getLocalTransform=function(m$2){var innerTransformable=this.innerTransformable;return innerTransformable?innerTransformable.getLocalTransform(m$2):_super.prototype.getLocalTransform.call(this,m$2)},ZRText$1.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),_super.prototype.getComputedTransform.call(this)},ZRText$1.prototype._updateSubTexts=function(){this._childCursor=0,normalizeTextStyle(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},ZRText$1.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i$1=0;i$1<this._children.length;i$1++)this._children[i$1].__zr=zr},ZRText$1.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i$1=0;i$1<this._children.length;i$1++)this._children[i$1].__zr=null},ZRText$1.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var tmpRect$2=new BoundingRect_default(0,0,0,0),children=this._children,tmpMat=[],rect=null,i$1=0;i$1<children.length;i$1++){var child=children[i$1],childRect=child.getBoundingRect(),transform=child.getLocalTransform(tmpMat);transform?(tmpRect$2.copy(childRect),tmpRect$2.applyTransform(transform),rect||=tmpRect$2.clone(),rect.union(tmpRect$2)):(rect||=childRect.clone(),rect.union(childRect))}this._rect=rect||tmpRect$2}return this._rect},ZRText$1.prototype.setDefaultTextStyle=function(defaultTextStyle){this._defaultStyle=defaultTextStyle||DEFAULT_RICH_TEXT_COLOR},ZRText$1.prototype.setTextContent=function(textContent){},ZRText$1.prototype._mergeStyle=function(targetStyle,sourceStyle){if(!sourceStyle)return targetStyle;var sourceRich=sourceStyle.rich,targetRich=targetStyle.rich||sourceRich&&{};return extend(targetStyle,sourceStyle),sourceRich&&targetRich?(this._mergeRich(targetRich,sourceRich),targetStyle.rich=targetRich):targetRich&&(targetStyle.rich=targetRich),targetStyle},ZRText$1.prototype._mergeRich=function(targetRich,sourceRich){for(var richNames=keys(sourceRich),i$1=0;i$1<richNames.length;i$1++){var richName=richNames[i$1];targetRich[richName]=targetRich[richName]||{},extend(targetRich[richName],sourceRich[richName])}},ZRText$1.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},ZRText$1.prototype._getOrCreateChild=function(Ctor){var child=this._children[this._childCursor];return(!child||!(child instanceof Ctor))&&(child=new Ctor),this._children[this._childCursor++]=child,child.__zr=this.__zr,child.parent=this,child},ZRText$1.prototype._updatePlainTexts=function(){var style=this.style,textFont=style.font||`12px sans-serif`,textPadding=style.padding,defaultStyle=this._defaultStyle,baseX=style.x||0,baseY=style.y||0,textAlign=style.align||defaultStyle.align||`left`,verticalAlign=style.verticalAlign||defaultStyle.verticalAlign||`top`;calcInnerTextOverflowArea(tmpCITOverflowAreaOut,defaultStyle.overflowRect,baseX,baseY,textAlign,verticalAlign),baseX=tmpCITOverflowAreaOut.baseX,baseY=tmpCITOverflowAreaOut.baseY;var text=getStyleText(style),contentBlock=parsePlainText(text,style,tmpCITOverflowAreaOut.outerWidth,tmpCITOverflowAreaOut.outerHeight),needDrawBg=needDrawBackground(style),bgColorDrawn=!!style.backgroundColor,outerHeight=contentBlock.outerHeight,outerWidth=contentBlock.outerWidth,textLines=contentBlock.lines,lineHeight=contentBlock.lineHeight;this.isTruncated=!!contentBlock.isTruncated;var textX=baseX,textY=adjustTextY(baseY,contentBlock.contentHeight,verticalAlign);if(needDrawBg||textPadding){var boxX=adjustTextX(baseX,outerWidth,textAlign),boxY=adjustTextY(baseY,outerHeight,verticalAlign);needDrawBg&&this._renderBackground(style,style,boxX,boxY,outerWidth,outerHeight)}textY+=lineHeight/2,textPadding&&(textX=getTextXForPadding(baseX,textAlign,textPadding),verticalAlign===`top`?textY+=textPadding[0]:verticalAlign===`bottom`&&(textY-=textPadding[2]));for(var defaultLineWidth=0,usingDefaultStroke=!1,useDefaultFill=!1,textFill=getFill(`fill`in style?style.fill:(useDefaultFill=!0,defaultStyle.fill)),textStroke=getStroke(`stroke`in style?style.stroke:!bgColorDrawn&&(!defaultStyle.autoStroke||useDefaultFill)?(defaultLineWidth=DEFAULT_STROKE_LINE_WIDTH,usingDefaultStroke=!0,defaultStyle.stroke):null),hasShadow=style.textShadowBlur>0,i$1=0;i$1<textLines.length;i$1++){var el=this._getOrCreateChild(TSpan_default),subElStyle=el.createStyle();el.useStyle(subElStyle),subElStyle.text=textLines[i$1],subElStyle.x=textX,subElStyle.y=textY,textAlign&&(subElStyle.textAlign=textAlign),subElStyle.textBaseline=`middle`,subElStyle.opacity=style.opacity,subElStyle.strokeFirst=!0,hasShadow&&(subElStyle.shadowBlur=style.textShadowBlur||0,subElStyle.shadowColor=style.textShadowColor||`transparent`,subElStyle.shadowOffsetX=style.textShadowOffsetX||0,subElStyle.shadowOffsetY=style.textShadowOffsetY||0),subElStyle.stroke=textStroke,subElStyle.fill=textFill,textStroke&&(subElStyle.lineWidth=style.lineWidth||defaultLineWidth,subElStyle.lineDash=style.lineDash,subElStyle.lineDashOffset=style.lineDashOffset||0),subElStyle.font=textFont,setSeparateFont(subElStyle,style),textY+=lineHeight,el.setBoundingRect(tSpanCreateBoundingRect2(subElStyle,contentBlock.contentWidth,contentBlock.calculatedLineHeight,usingDefaultStroke?0:null))}},ZRText$1.prototype._updateRichTexts=function(){var style=this.style,defaultStyle=this._defaultStyle,textAlign=style.align||defaultStyle.align,verticalAlign=style.verticalAlign||defaultStyle.verticalAlign,baseX=style.x||0,baseY=style.y||0;calcInnerTextOverflowArea(tmpCITOverflowAreaOut,defaultStyle.overflowRect,baseX,baseY,textAlign,verticalAlign),baseX=tmpCITOverflowAreaOut.baseX,baseY=tmpCITOverflowAreaOut.baseY;var text=getStyleText(style),contentBlock=parseRichText(text,style,tmpCITOverflowAreaOut.outerWidth,tmpCITOverflowAreaOut.outerHeight,textAlign),contentWidth=contentBlock.width,outerWidth=contentBlock.outerWidth,outerHeight=contentBlock.outerHeight,textPadding=style.padding;this.isTruncated=!!contentBlock.isTruncated;var boxX=adjustTextX(baseX,outerWidth,textAlign),boxY=adjustTextY(baseY,outerHeight,verticalAlign),xLeft=boxX,lineTop=boxY;textPadding&&(xLeft+=textPadding[3],lineTop+=textPadding[0]);var xRight=xLeft+contentWidth;needDrawBackground(style)&&this._renderBackground(style,style,boxX,boxY,outerWidth,outerHeight);for(var bgColorDrawn=!!style.backgroundColor,i$1=0;i$1<contentBlock.lines.length;i$1++){for(var line=contentBlock.lines[i$1],tokens$1=line.tokens,tokenCount=tokens$1.length,lineHeight=line.lineHeight,remainedWidth=line.width,leftIndex=0,lineXLeft=xLeft,lineXRight=xRight,rightIndex=tokenCount-1,token=void 0;leftIndex<tokenCount&&(token=tokens$1[leftIndex],!token.align||token.align===`left`);)this._placeToken(token,style,lineHeight,lineTop,lineXLeft,`left`,bgColorDrawn),remainedWidth-=token.width,lineXLeft+=token.width,leftIndex++;for(;rightIndex>=0&&(token=tokens$1[rightIndex],token.align===`right`);)this._placeToken(token,style,lineHeight,lineTop,lineXRight,`right`,bgColorDrawn),remainedWidth-=token.width,lineXRight-=token.width,rightIndex--;for(lineXLeft+=(contentWidth-(lineXLeft-xLeft)-(xRight-lineXRight)-remainedWidth)/2;leftIndex<=rightIndex;)token=tokens$1[leftIndex],this._placeToken(token,style,lineHeight,lineTop,lineXLeft+token.width/2,`center`,bgColorDrawn),lineXLeft+=token.width,leftIndex++;lineTop+=lineHeight}},ZRText$1.prototype._placeToken=function(token,style,lineHeight,lineTop,x$1,textAlign,parentBgColorDrawn){var tokenStyle=style.rich[token.styleName]||{};tokenStyle.text=token.text;var verticalAlign=token.verticalAlign,y$1=lineTop+lineHeight/2;verticalAlign===`top`?y$1=lineTop+token.height/2:verticalAlign===`bottom`&&(y$1=lineTop+lineHeight-token.height/2),!token.isLineHolder&&needDrawBackground(tokenStyle)&&this._renderBackground(tokenStyle,style,textAlign===`right`?x$1-token.width:textAlign===`center`?x$1-token.width/2:x$1,y$1-token.height/2,token.width,token.height);var bgColorDrawn=!!tokenStyle.backgroundColor,textPadding=token.textPadding;textPadding&&(x$1=getTextXForPadding(x$1,textAlign,textPadding),y$1-=token.height/2-textPadding[0]-token.innerHeight/2);var el=this._getOrCreateChild(TSpan_default),subElStyle=el.createStyle();el.useStyle(subElStyle);var defaultStyle=this._defaultStyle,useDefaultFill=!1,defaultLineWidth=0,usingDefaultStroke=!1,textFill=getFill(`fill`in tokenStyle?tokenStyle.fill:`fill`in style?style.fill:(useDefaultFill=!0,defaultStyle.fill)),textStroke=getStroke(`stroke`in tokenStyle?tokenStyle.stroke:`stroke`in style?style.stroke:!bgColorDrawn&&!parentBgColorDrawn&&(!defaultStyle.autoStroke||useDefaultFill)?(defaultLineWidth=DEFAULT_STROKE_LINE_WIDTH,usingDefaultStroke=!0,defaultStyle.stroke):null),hasShadow=tokenStyle.textShadowBlur>0||style.textShadowBlur>0;subElStyle.text=token.text,subElStyle.x=x$1,subElStyle.y=y$1,hasShadow&&(subElStyle.shadowBlur=tokenStyle.textShadowBlur||style.textShadowBlur||0,subElStyle.shadowColor=tokenStyle.textShadowColor||style.textShadowColor||`transparent`,subElStyle.shadowOffsetX=tokenStyle.textShadowOffsetX||style.textShadowOffsetX||0,subElStyle.shadowOffsetY=tokenStyle.textShadowOffsetY||style.textShadowOffsetY||0),subElStyle.textAlign=textAlign,subElStyle.textBaseline=`middle`,subElStyle.font=token.font||`12px sans-serif`,subElStyle.opacity=retrieve3(tokenStyle.opacity,style.opacity,1),setSeparateFont(subElStyle,tokenStyle),textStroke&&(subElStyle.lineWidth=retrieve3(tokenStyle.lineWidth,style.lineWidth,defaultLineWidth),subElStyle.lineDash=retrieve2(tokenStyle.lineDash,style.lineDash),subElStyle.lineDashOffset=style.lineDashOffset||0,subElStyle.stroke=textStroke),textFill&&(subElStyle.fill=textFill),el.setBoundingRect(tSpanCreateBoundingRect2(subElStyle,token.contentWidth,token.contentHeight,usingDefaultStroke?0:null))},ZRText$1.prototype._renderBackground=function(style,topStyle,x$1,y$1,width,height){var textBackgroundColor=style.backgroundColor,textBorderWidth=style.borderWidth,textBorderColor=style.borderColor,isImageBg=textBackgroundColor&&textBackgroundColor.image,isPlainOrGradientBg=textBackgroundColor&&!isImageBg,textBorderRadius=style.borderRadius,self$1=this,rectEl,imgEl;if(isPlainOrGradientBg||style.lineHeight||textBorderWidth&&textBorderColor){rectEl=this._getOrCreateChild(Rect_default),rectEl.useStyle(rectEl.createStyle()),rectEl.style.fill=null;var rectShape=rectEl.shape;rectShape.x=x$1,rectShape.y=y$1,rectShape.width=width,rectShape.height=height,rectShape.r=textBorderRadius,rectEl.dirtyShape()}if(isPlainOrGradientBg){var rectStyle=rectEl.style;rectStyle.fill=textBackgroundColor||null,rectStyle.fillOpacity=retrieve2(style.fillOpacity,1)}else if(isImageBg){imgEl=this._getOrCreateChild(Image_default),imgEl.onload=function(){self$1.dirtyStyle()};var imgStyle=imgEl.style;imgStyle.image=textBackgroundColor.image,imgStyle.x=x$1,imgStyle.y=y$1,imgStyle.width=width,imgStyle.height=height}if(textBorderWidth&&textBorderColor){var rectStyle=rectEl.style;rectStyle.lineWidth=textBorderWidth,rectStyle.stroke=textBorderColor,rectStyle.strokeOpacity=retrieve2(style.strokeOpacity,1),rectStyle.lineDash=style.borderDash,rectStyle.lineDashOffset=style.borderDashOffset||0,rectEl.strokeContainThreshold=0,rectEl.hasFill()&&rectEl.hasStroke()&&(rectStyle.strokeFirst=!0,rectStyle.lineWidth*=2)}var commonStyle=(rectEl||imgEl).style;commonStyle.shadowBlur=style.shadowBlur||0,commonStyle.shadowColor=style.shadowColor||`transparent`,commonStyle.shadowOffsetX=style.shadowOffsetX||0,commonStyle.shadowOffsetY=style.shadowOffsetY||0,commonStyle.opacity=retrieve3(style.opacity,topStyle.opacity,1)},ZRText$1.makeFont=function(style){var font=``;return hasSeparateFont(style)&&(font=[style.fontStyle,style.fontWeight,parseFontSize(style.fontSize),style.fontFamily||`sans-serif`].join(` `)),font&&trim(font)||style.textFont||style.font},ZRText$1}(Displayable_default),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=[`fontStyle`,`fontWeight`,`fontSize`,`fontFamily`];function parseFontSize(fontSize){return typeof fontSize==`string`&&(fontSize.indexOf(`px`)!==-1||fontSize.indexOf(`rem`)!==-1||fontSize.indexOf(`em`)!==-1)?fontSize:isNaN(+fontSize)?`12px`:fontSize+`px`}function setSeparateFont(targetStyle,sourceStyle){for(var i$1=0;i$1<FONT_PARTS.length;i$1++){var fontProp=FONT_PARTS[i$1],val=sourceStyle[fontProp];val!=null&&(targetStyle[fontProp]=val)}}function hasSeparateFont(style){return style.fontSize!=null||style.fontFamily||style.fontWeight}function normalizeTextStyle(style){return normalizeStyle(style),each(style.rich,normalizeStyle),style}function normalizeStyle(style){if(style){style.font=ZRText.makeFont(style);var textAlign=style.align;textAlign===`middle`&&(textAlign=`center`),style.align=textAlign==null||VALID_TEXT_ALIGN[textAlign]?textAlign:`left`;var verticalAlign=style.verticalAlign;verticalAlign===`center`&&(verticalAlign=`middle`),style.verticalAlign=verticalAlign==null||VALID_TEXT_VERTICAL_ALIGN[verticalAlign]?verticalAlign:`top`,style.padding&&=normalizeCssArray$1(style.padding)}}function getStroke(stroke,lineWidth){return stroke==null||lineWidth<=0||stroke===`transparent`||stroke===`none`?null:stroke.image||stroke.colorStops?`#000`:stroke}function getFill(fill){return fill==null||fill===`none`?null:fill.image||fill.colorStops?`#000`:fill}function getTextXForPadding(x$1,textAlign,textPadding){return textAlign===`right`?x$1-textPadding[1]:textAlign===`center`?x$1+textPadding[3]/2-textPadding[1]/2:x$1+textPadding[3]}function getStyleText(style){var text=style.text;return text!=null&&(text+=``),text}function needDrawBackground(style){return!!(style.backgroundColor||style.lineHeight||style.borderWidth&&style.borderColor)}var Text_default=ZRText,getECData=makeInner(),setCommonECData=function(seriesIndex,dataType,dataIdx,el){if(el){var ecData=getECData(el);ecData.dataIndex=dataIdx,ecData.dataType=dataType,ecData.seriesIndex=seriesIndex,ecData.ssrType=`chart`,el.type===`group`&&el.traverse(function(child){var childECData=getECData(child);childECData.seriesIndex=seriesIndex,childECData.dataIndex=dataIdx,childECData.dataType=dataType,childECData.ssrType=`chart`})}},_highlightNextDigit=1,_highlightKeyMap={},getSavedStates=makeInner(),getComponentStates=makeInner(),HOVER_STATE_NORMAL=0,HOVER_STATE_BLUR=1,HOVER_STATE_EMPHASIS=2,SPECIAL_STATES=[`emphasis`,`blur`,`select`],DISPLAY_STATES=[`normal`,`emphasis`,`blur`,`select`],Z2_EMPHASIS_LIFT=10,Z2_SELECT_LIFT=9,HIGHLIGHT_ACTION_TYPE=`highlight`,DOWNPLAY_ACTION_TYPE=`downplay`,SELECT_ACTION_TYPE=`select`,UNSELECT_ACTION_TYPE=`unselect`,TOGGLE_SELECT_ACTION_TYPE=`toggleSelect`,SELECT_CHANGED_EVENT_TYPE=`selectchanged`;function hasFillOrStroke(fillOrStroke){return fillOrStroke!=null&&fillOrStroke!==`none`}function doChangeHoverState(el,stateName,hoverStateEnum){el.onHoverStateChange&&(el.hoverState||0)!==hoverStateEnum&&el.onHoverStateChange(stateName),el.hoverState=hoverStateEnum}function singleEnterEmphasis(el){doChangeHoverState(el,`emphasis`,2)}function singleLeaveEmphasis(el){el.hoverState===2&&doChangeHoverState(el,`normal`,0)}function singleEnterBlur(el){doChangeHoverState(el,`blur`,1)}function singleLeaveBlur(el){el.hoverState===1&&doChangeHoverState(el,`normal`,0)}function singleEnterSelect(el){el.selected=!0}function singleLeaveSelect(el){el.selected=!1}function updateElementState(el,updater,commonParam){updater(el,commonParam)}function traverseUpdateState(el,updater,commonParam){updateElementState(el,updater,commonParam),el.isGroup&&el.traverse(function(child){updateElementState(child,updater,commonParam)})}function setStatesFlag(el,stateName){switch(stateName){case`emphasis`:el.hoverState=2;break;case`normal`:el.hoverState=0;break;case`blur`:el.hoverState=1;break;case`select`:el.selected=!0}}function getFromStateStyle(el,props,toStateName,defaultValue$1){for(var style=el.style,fromState={},i$1=0;i$1<props.length;i$1++){var propName=props[i$1];fromState[propName]=style[propName]??(defaultValue$1&&defaultValue$1[propName])}for(var i$1=0;i$1<el.animators.length;i$1++){var animator=el.animators[i$1];animator.__fromStateTransition&&animator.__fromStateTransition.indexOf(toStateName)<0&&animator.targetName===`style`&&animator.saveTo(fromState,props)}return fromState}function createEmphasisDefaultState(el,stateName,targetStates,state){var hasSelect=targetStates&&indexOf(targetStates,`select`)>=0,cloned=!1;if(el instanceof Path_default){var store=getSavedStates(el),fromFill=hasSelect&&store.selectFill||store.normalFill,fromStroke=hasSelect&&store.selectStroke||store.normalStroke;if(hasFillOrStroke(fromFill)||hasFillOrStroke(fromStroke)){state||={};var emphasisStyle=state.style||{};emphasisStyle.fill===`inherit`?(cloned=!0,state=extend({},state),emphasisStyle=extend({},emphasisStyle),emphasisStyle.fill=fromFill):!hasFillOrStroke(emphasisStyle.fill)&&hasFillOrStroke(fromFill)?(cloned=!0,state=extend({},state),emphasisStyle=extend({},emphasisStyle),emphasisStyle.fill=liftColor(fromFill)):!hasFillOrStroke(emphasisStyle.stroke)&&hasFillOrStroke(fromStroke)&&(cloned||(state=extend({},state),emphasisStyle=extend({},emphasisStyle)),emphasisStyle.stroke=liftColor(fromStroke)),state.style=emphasisStyle}}if(state&&state.z2==null){cloned||(state=extend({},state));var z2EmphasisLift=el.z2EmphasisLift;state.z2=el.z2+(z2EmphasisLift??10)}return state}function createSelectDefaultState(el,stateName,state){if(state&&state.z2==null){state=extend({},state);var z2SelectLift=el.z2SelectLift;state.z2=el.z2+(z2SelectLift??9)}return state}function createBlurDefaultState(el,stateName,state){var hasBlur=indexOf(el.currentStates,stateName)>=0,currentOpacity=el.style.opacity,fromState=hasBlur?null:getFromStateStyle(el,[`opacity`],stateName,{opacity:1});state||={};var blurStyle=state.style||{};return blurStyle.opacity??(state=extend({},state),blurStyle=extend({opacity:hasBlur?currentOpacity:fromState.opacity*.1},blurStyle),state.style=blurStyle),state}function elementStateProxy(stateName,targetStates){var state=this.states[stateName];if(this.style){if(stateName===`emphasis`)return createEmphasisDefaultState(this,stateName,targetStates,state);if(stateName===`blur`)return createBlurDefaultState(this,stateName,state);if(stateName===`select`)return createSelectDefaultState(this,stateName,state)}return state}function setDefaultStateProxy(el){el.stateProxy=elementStateProxy;var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();textContent&&(textContent.stateProxy=elementStateProxy),textGuide&&(textGuide.stateProxy=elementStateProxy)}function enterEmphasisWhenMouseOver(el,e$2){!shouldSilent(el,e$2)&&!el.__highByOuter&&traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasisWhenMouseOut(el,e$2){!shouldSilent(el,e$2)&&!el.__highByOuter&&traverseUpdateState(el,singleLeaveEmphasis)}function enterEmphasis(el,highlightDigit){el.__highByOuter|=1<<(highlightDigit||0),traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasis(el,highlightDigit){!(el.__highByOuter&=~(1<<(highlightDigit||0)))&&traverseUpdateState(el,singleLeaveEmphasis)}function enterBlur(el){traverseUpdateState(el,singleEnterBlur)}function leaveBlur(el){traverseUpdateState(el,singleLeaveBlur)}function enterSelect(el){traverseUpdateState(el,singleEnterSelect)}function leaveSelect(el){traverseUpdateState(el,singleLeaveSelect)}function shouldSilent(el,e$2){return el.__highDownSilentOnTouch&&e$2.zrByTouch}function allLeaveBlur(api){var model=api.getModel(),leaveBlurredSeries=[],allComponentViews=[];model.eachComponent(function(componentType,componentModel){var componentStates=getComponentStates(componentModel),isSeries$1=componentType===`series`,view=isSeries$1?api.getViewOfSeriesModel(componentModel):api.getViewOfComponentModel(componentModel);!isSeries$1&&allComponentViews.push(view),componentStates.isBlured&&(view.group.traverse(function(child){singleLeaveBlur(child)}),isSeries$1&&leaveBlurredSeries.push(componentModel)),componentStates.isBlured=!1}),each(allComponentViews,function(view){view&&view.toggleBlurSeries&&view.toggleBlurSeries(leaveBlurredSeries,!1,model)})}function blurSeries(targetSeriesIndex,focus,blurScope,api){var ecModel=api.getModel();blurScope||=`coordinateSystem`;function leaveBlurOfIndices(data,dataIndices){for(var i$1=0;i$1<dataIndices.length;i$1++){var itemEl=data.getItemGraphicEl(dataIndices[i$1]);itemEl&&leaveBlur(itemEl)}}if(targetSeriesIndex!=null&&!(!focus||focus===`none`)){var targetSeriesModel=ecModel.getSeriesByIndex(targetSeriesIndex),targetCoordSys=targetSeriesModel.coordinateSystem;targetCoordSys&&targetCoordSys.master&&(targetCoordSys=targetCoordSys.master);var blurredSeries=[];ecModel.eachSeries(function(seriesModel){var sameSeries=targetSeriesModel===seriesModel,coordSys=seriesModel.coordinateSystem;if(coordSys&&coordSys.master&&(coordSys=coordSys.master),!(blurScope===`series`&&!sameSeries||blurScope===`coordinateSystem`&&!(coordSys&&targetCoordSys?coordSys===targetCoordSys:sameSeries)||focus===`series`&&sameSeries)){if(api.getViewOfSeriesModel(seriesModel).group.traverse(function(child){child.__highByOuter&&sameSeries&&focus===`self`||singleEnterBlur(child)}),isArrayLike(focus))leaveBlurOfIndices(seriesModel.getData(),focus);else if(isObject(focus))for(var dataTypes=keys(focus),d$1=0;d$1<dataTypes.length;d$1++)leaveBlurOfIndices(seriesModel.getData(dataTypes[d$1]),focus[dataTypes[d$1]]);blurredSeries.push(seriesModel),getComponentStates(seriesModel).isBlured=!0}}),ecModel.eachComponent(function(componentType,componentModel){if(componentType!==`series`){var view=api.getViewOfComponentModel(componentModel);view&&view.toggleBlurSeries&&view.toggleBlurSeries(blurredSeries,!0,ecModel)}})}}function blurComponent(componentMainType,componentIndex,api){if(!(componentMainType==null||componentIndex==null)){var componentModel=api.getModel().getComponent(componentMainType,componentIndex);if(componentModel){getComponentStates(componentModel).isBlured=!0;var view=api.getViewOfComponentModel(componentModel);!view||!view.focusBlurEnabled||view.group.traverse(function(child){singleEnterBlur(child)})}}}function blurSeriesFromHighlightPayload(seriesModel,payload,api){var seriesIndex=seriesModel.seriesIndex,data=seriesModel.getData(payload.dataType);if(data){var dataIndex=queryDataIndex(data,payload);dataIndex=(isArray(dataIndex)?dataIndex[0]:dataIndex)||0;var el=data.getItemGraphicEl(dataIndex);if(!el)for(var count$1=data.count(),current=0;!el&&current<count$1;)el=data.getItemGraphicEl(current++);if(el){var ecData=getECData(el);blurSeries(seriesIndex,ecData.focus,ecData.blurScope,api)}else{var focus_1=seriesModel.get([`emphasis`,`focus`]),blurScope=seriesModel.get([`emphasis`,`blurScope`]);focus_1!=null&&blurSeries(seriesIndex,focus_1,blurScope,api)}}}function findComponentHighDownDispatchers(componentMainType,componentIndex,name,api){var ret={focusSelf:!1,dispatchers:null};if(componentMainType==null||componentMainType===`series`||componentIndex==null||name==null)return ret;var componentModel=api.getModel().getComponent(componentMainType,componentIndex);if(!componentModel)return ret;var view=api.getViewOfComponentModel(componentModel);if(!view||!view.findHighDownDispatchers)return ret;for(var dispatchers=view.findHighDownDispatchers(name),focusSelf,i$1=0;i$1<dispatchers.length;i$1++)if(getECData(dispatchers[i$1]).focus===`self`){focusSelf=!0;break}return{focusSelf,dispatchers}}function handleGlobalMouseOverForHighDown(dispatcher,e$2,api){var ecData=getECData(dispatcher),_a$1=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api),dispatchers=_a$1.dispatchers,focusSelf=_a$1.focusSelf;dispatchers?(focusSelf&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),each(dispatchers,function(dispatcher$1){return enterEmphasisWhenMouseOver(dispatcher$1,e$2)})):(blurSeries(ecData.seriesIndex,ecData.focus,ecData.blurScope,api),ecData.focus===`self`&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),enterEmphasisWhenMouseOver(dispatcher,e$2))}function handleGlobalMouseOutForHighDown(dispatcher,e$2,api){allLeaveBlur(api);var ecData=getECData(dispatcher),dispatchers=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api).dispatchers;dispatchers?each(dispatchers,function(dispatcher$1){return leaveEmphasisWhenMouseOut(dispatcher$1,e$2)}):leaveEmphasisWhenMouseOut(dispatcher,e$2)}function toggleSelectionFromPayload(seriesModel,payload,api){if(isSelectChangePayload(payload)){var dataType=payload.dataType,data=seriesModel.getData(dataType),dataIndex=queryDataIndex(data,payload);isArray(dataIndex)||(dataIndex=[dataIndex]),seriesModel[payload.type===`toggleSelect`?`toggleSelect`:payload.type===`select`?`select`:`unselect`](dataIndex,dataType)}}function updateSeriesElementSelection(seriesModel){var allData=seriesModel.getAllData();each(allData,function(_a$1){var data=_a$1.data,type=_a$1.type;data.eachItemGraphicEl(function(el,idx){seriesModel.isSelected(idx,type)?enterSelect(el):leaveSelect(el)})})}function getAllSelectedIndices(ecModel){var ret=[];return ecModel.eachSeries(function(seriesModel){var allData=seriesModel.getAllData();each(allData,function(_a$1){_a$1.data;var type=_a$1.type,dataIndices=seriesModel.getSelectedDataIndices();if(dataIndices.length>0){var item={dataIndex:dataIndices,seriesIndex:seriesModel.seriesIndex};type!=null&&(item.dataType=type),ret.push(item)}})}),ret}function enableHoverEmphasis(el,focus,blurScope){setAsHighDownDispatcher(el,!0),traverseUpdateState(el,setDefaultStateProxy),enableHoverFocus(el,focus,blurScope)}function disableHoverEmphasis(el){setAsHighDownDispatcher(el,!1)}function toggleHoverEmphasis(el,focus,blurScope,isDisabled){isDisabled?disableHoverEmphasis(el):enableHoverEmphasis(el,focus,blurScope)}function enableHoverFocus(el,focus,blurScope){var ecData=getECData(el);focus==null?ecData.focus&&=null:(ecData.focus=focus,ecData.blurScope=blurScope)}var OTHER_STATES=[`emphasis`,`blur`,`select`],defaultStyleGetterMap={itemStyle:`getItemStyle`,lineStyle:`getLineStyle`,areaStyle:`getAreaStyle`};function setStatesStylesFromModel(el,itemModel,styleType,getter){styleType||=`itemStyle`;for(var i$1=0;i$1<OTHER_STATES.length;i$1++){var stateName=OTHER_STATES[i$1],model=itemModel.getModel([stateName,styleType]),state=el.ensureState(stateName);state.style=getter?getter(model):model[defaultStyleGetterMap[styleType]]()}}function setAsHighDownDispatcher(el,asDispatcher){var disable=asDispatcher===!1,extendedEl=el;el.highDownSilentOnTouch&&(extendedEl.__highDownSilentOnTouch=el.highDownSilentOnTouch),(!disable||extendedEl.__highDownDispatcher)&&(extendedEl.__highByOuter=extendedEl.__highByOuter||0,extendedEl.__highDownDispatcher=!disable)}function isHighDownDispatcher(el){return!!(el&&el.__highDownDispatcher)}function getHighlightDigit(highlightKey){var highlightDigit=_highlightKeyMap[highlightKey];return highlightDigit==null&&_highlightNextDigit<=32&&(highlightDigit=_highlightKeyMap[highlightKey]=_highlightNextDigit++),highlightDigit}function isSelectChangePayload(payload){var payloadType=payload.type;return payloadType===`select`||payloadType===`unselect`||payloadType===`toggleSelect`}function isHighDownPayload(payload){var payloadType=payload.type;return payloadType===`highlight`||payloadType===`downplay`}function savePathStates(el){var store=getSavedStates(el);store.normalFill=el.style.fill,store.normalStroke=el.style.stroke;var selectState=el.states.select||{};store.selectFill=selectState.style&&selectState.style.fill||null,store.selectStroke=selectState.style&&selectState.style.stroke||null}var CMD=PathProxy_default.CMD,points=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;function transformPath(path$1,m$2){if(m$2){var data=path$1.data,len$1=path$1.len(),cmd,nPoint,i$1,j$1,k$1,p$2,M$1=CMD.M,C=CMD.C,L=CMD.L,R=CMD.R,A=CMD.A,Q=CMD.Q;for(i$1=0,j$1=0;i$1<len$1;){switch(cmd=data[i$1++],j$1=i$1,nPoint=0,cmd){case M$1:nPoint=1;break;case L:nPoint=1;break;case C:nPoint=3;break;case Q:nPoint=2;break;case A:var x$1=m$2[4],y$1=m$2[5],sx=mathSqrt$2(m$2[0]*m$2[0]+m$2[1]*m$2[1]),sy=mathSqrt$2(m$2[2]*m$2[2]+m$2[3]*m$2[3]),angle=mathAtan2(-m$2[1]/sy,m$2[0]/sx);data[i$1]*=sx,data[i$1++]+=x$1,data[i$1]*=sy,data[i$1++]+=y$1,data[i$1++]*=sx,data[i$1++]*=sy,data[i$1++]+=angle,data[i$1++]+=angle,i$1+=2,j$1=i$1;break;case R:p$2[0]=data[i$1++],p$2[1]=data[i$1++],applyTransform(p$2,p$2,m$2),data[j$1++]=p$2[0],data[j$1++]=p$2[1],p$2[0]+=data[i$1++],p$2[1]+=data[i$1++],applyTransform(p$2,p$2,m$2),data[j$1++]=p$2[0],data[j$1++]=p$2[1]}for(k$1=0;k$1<nPoint;k$1++){var p_1=points[k$1];p_1[0]=data[i$1++],p_1[1]=data[i$1++],applyTransform(p_1,p_1,m$2),data[j$1++]=p_1[0],data[j$1++]=p_1[1]}}path$1.increaseVersion()}}var mathSqrt$1=Math.sqrt,mathSin$1=Math.sin,mathCos$1=Math.cos,PI$3=Math.PI;function vMag(v$1){return Math.sqrt(v$1[0]*v$1[0]+v$1[1]*v$1[1])}function vRatio(u$1,v$1){return(u$1[0]*v$1[0]+u$1[1]*v$1[1])/(vMag(u$1)*vMag(v$1))}function vAngle(u$1,v$1){return(u$1[0]*v$1[1]<u$1[1]*v$1[0]?-1:1)*Math.acos(vRatio(u$1,v$1))}function processArc(x1,y1,x2,y2,fa,fs,rx,ry,psiDeg,cmd,path$1){var psi=psiDeg*(PI$3/180),xp=mathCos$1(psi)*(x1-x2)/2+mathSin$1(psi)*(y1-y2)/2,yp=-1*mathSin$1(psi)*(x1-x2)/2+mathCos$1(psi)*(y1-y2)/2,lambda=xp*xp/(rx*rx)+yp*yp/(ry*ry);lambda>1&&(rx*=mathSqrt$1(lambda),ry*=mathSqrt$1(lambda));var f$1=(fa===fs?-1:1)*mathSqrt$1((rx*rx*(ry*ry)-rx*rx*(yp*yp)-ry*ry*(xp*xp))/(rx*rx*(yp*yp)+ry*ry*(xp*xp)))||0,cxp=f$1*rx*yp/ry,cyp=f$1*-ry*xp/rx,cx=(x1+x2)/2+mathCos$1(psi)*cxp-mathSin$1(psi)*cyp,cy=(y1+y2)/2+mathSin$1(psi)*cxp+mathCos$1(psi)*cyp,theta=vAngle([1,0],[(xp-cxp)/rx,(yp-cyp)/ry]),u$1=[(xp-cxp)/rx,(yp-cyp)/ry],v$1=[(-1*xp-cxp)/rx,(-1*yp-cyp)/ry],dTheta=vAngle(u$1,v$1);if(vRatio(u$1,v$1)<=-1&&(dTheta=PI$3),vRatio(u$1,v$1)>=1&&(dTheta=0),dTheta<0){var n$1=Math.round(dTheta/PI$3*1e6)/1e6;dTheta=PI$3*2+n$1%2*PI$3}path$1.addData(cmd,cx,cy,rx,ry,theta,dTheta,psi,fs)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function createPathProxyFromString(data){var path$1=new PathProxy_default;if(!data)return path$1;var cpx=0,cpy=0,subpathX=cpx,subpathY=cpy,prevCmd,CMD$3=PathProxy_default.CMD,cmdList=data.match(commandReg);if(!cmdList)return path$1;for(var l$1=0;l$1<cmdList.length;l$1++){for(var cmdText=cmdList[l$1],cmdStr=cmdText.charAt(0),cmd=void 0,p$2=cmdText.match(numberReg)||[],pLen=p$2.length,i$1=0;i$1<pLen;i$1++)p$2[i$1]=parseFloat(p$2[i$1]);for(var off=0;off<pLen;){var ctlPtx=void 0,ctlPty=void 0,rx=void 0,ry=void 0,psi=void 0,fa=void 0,fs=void 0,x1=cpx,y1=cpy,len$1=void 0,pathData=void 0;switch(cmdStr){case`l`:cpx+=p$2[off++],cpy+=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`L`:cpx=p$2[off++],cpy=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`m`:cpx+=p$2[off++],cpy+=p$2[off++],cmd=CMD$3.M,path$1.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr=`l`;break;case`M`:cpx=p$2[off++],cpy=p$2[off++],cmd=CMD$3.M,path$1.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr=`L`;break;case`h`:cpx+=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`H`:cpx=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`v`:cpy+=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`V`:cpy=p$2[off++],cmd=CMD$3.L,path$1.addData(cmd,cpx,cpy);break;case`C`:cmd=CMD$3.C,path$1.addData(cmd,p$2[off++],p$2[off++],p$2[off++],p$2[off++],p$2[off++],p$2[off++]),cpx=p$2[off-2],cpy=p$2[off-1];break;case`c`:cmd=CMD$3.C,path$1.addData(cmd,p$2[off++]+cpx,p$2[off++]+cpy,p$2[off++]+cpx,p$2[off++]+cpy,p$2[off++]+cpx,p$2[off++]+cpy),cpx+=p$2[off-2],cpy+=p$2[off-1];break;case`S`:ctlPtx=cpx,ctlPty=cpy,len$1=path$1.len(),pathData=path$1.data,prevCmd===CMD$3.C&&(ctlPtx+=cpx-pathData[len$1-4],ctlPty+=cpy-pathData[len$1-3]),cmd=CMD$3.C,x1=p$2[off++],y1=p$2[off++],cpx=p$2[off++],cpy=p$2[off++],path$1.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case`s`:ctlPtx=cpx,ctlPty=cpy,len$1=path$1.len(),pathData=path$1.data,prevCmd===CMD$3.C&&(ctlPtx+=cpx-pathData[len$1-4],ctlPty+=cpy-pathData[len$1-3]),cmd=CMD$3.C,x1=cpx+p$2[off++],y1=cpy+p$2[off++],cpx+=p$2[off++],cpy+=p$2[off++],path$1.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case`Q`:x1=p$2[off++],y1=p$2[off++],cpx=p$2[off++],cpy=p$2[off++],cmd=CMD$3.Q,path$1.addData(cmd,x1,y1,cpx,cpy);break;case`q`:x1=p$2[off++]+cpx,y1=p$2[off++]+cpy,cpx+=p$2[off++],cpy+=p$2[off++],cmd=CMD$3.Q,path$1.addData(cmd,x1,y1,cpx,cpy);break;case`T`:ctlPtx=cpx,ctlPty=cpy,len$1=path$1.len(),pathData=path$1.data,prevCmd===CMD$3.Q&&(ctlPtx+=cpx-pathData[len$1-4],ctlPty+=cpy-pathData[len$1-3]),cpx=p$2[off++],cpy=p$2[off++],cmd=CMD$3.Q,path$1.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case`t`:ctlPtx=cpx,ctlPty=cpy,len$1=path$1.len(),pathData=path$1.data,prevCmd===CMD$3.Q&&(ctlPtx+=cpx-pathData[len$1-4],ctlPty+=cpy-pathData[len$1-3]),cpx+=p$2[off++],cpy+=p$2[off++],cmd=CMD$3.Q,path$1.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case`A`:rx=p$2[off++],ry=p$2[off++],psi=p$2[off++],fa=p$2[off++],fs=p$2[off++],x1=cpx,y1=cpy,cpx=p$2[off++],cpy=p$2[off++],cmd=CMD$3.A,processArc(x1,y1,cpx,cpy,fa,fs,rx,ry,psi,cmd,path$1);break;case`a`:rx=p$2[off++],ry=p$2[off++],psi=p$2[off++],fa=p$2[off++],fs=p$2[off++],x1=cpx,y1=cpy,cpx+=p$2[off++],cpy+=p$2[off++],cmd=CMD$3.A,processArc(x1,y1,cpx,cpy,fa,fs,rx,ry,psi,cmd,path$1);break}}(cmdStr===`z`||cmdStr===`Z`)&&(cmd=CMD$3.Z,path$1.addData(cmd),cpx=subpathX,cpy=subpathY),prevCmd=cmd}return path$1.toStatic(),path$1}var SVGPath=function(_super){__extends(SVGPath$1,_super);function SVGPath$1(){return _super!==null&&_super.apply(this,arguments)||this}return SVGPath$1.prototype.applyTransform=function(m$2){},SVGPath$1}(Path_default);function isPathProxy(path$1){return path$1.setData!=null}function createPathOptions(str,opts){var pathProxy=createPathProxyFromString(str),innerOpts=extend({},opts);return innerOpts.buildPath=function(path$1){var beProxy=isPathProxy(path$1);if(beProxy&&path$1.canSave()){path$1.appendPath(pathProxy);var ctx=path$1.getContext();ctx&&path$1.rebuildPath(ctx,1)}else{var ctx=beProxy?path$1.getContext():path$1;ctx&&pathProxy.rebuildPath(ctx,1)}},innerOpts.applyTransform=function(m$2){transformPath(pathProxy,m$2),this.dirtyShape()},innerOpts}function createFromString(str,opts){return new SVGPath(createPathOptions(str,opts))}function extendFromString(str,defaultOpts){var innerOpts=createPathOptions(str,defaultOpts);return function(_super){__extends(Sub,_super);function Sub(opts){var _this=_super.call(this,opts)||this;return _this.applyTransform=innerOpts.applyTransform,_this.buildPath=innerOpts.buildPath,_this}return Sub}(SVGPath)}function mergePath$1(pathEls,opts){for(var pathList=[],len$1=pathEls.length,i$1=0;i$1<len$1;i$1++){var pathEl=pathEls[i$1];pathList.push(pathEl.getUpdatedPathProxy(!0))}var pathBundle=new Path_default(opts);return pathBundle.createPathProxy(),pathBundle.buildPath=function(path$1){if(isPathProxy(path$1)){path$1.appendPath(pathList);var ctx=path$1.getContext();ctx&&path$1.rebuildPath(ctx,1)}},pathBundle}var CircleShape=function(){function CircleShape$1(){this.cx=0,this.cy=0,this.r=0}return CircleShape$1}(),Circle=function(_super){__extends(Circle$2,_super);function Circle$2(opts){return _super.call(this,opts)||this}return Circle$2.prototype.getDefaultShape=function(){return new CircleShape},Circle$2.prototype.buildPath=function(ctx,shape){ctx.moveTo(shape.cx+shape.r,shape.cy),ctx.arc(shape.cx,shape.cy,shape.r,0,Math.PI*2)},Circle$2}(Path_default);Circle.prototype.type=`circle`;var Circle_default=Circle,EllipseShape=function(){function EllipseShape$1(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return EllipseShape$1}(),Ellipse=function(_super){__extends(Ellipse$2,_super);function Ellipse$2(opts){return _super.call(this,opts)||this}return Ellipse$2.prototype.getDefaultShape=function(){return new EllipseShape},Ellipse$2.prototype.buildPath=function(ctx,shape){var k$1=.5522848,x$1=shape.cx,y$1=shape.cy,a$1=shape.rx,b$1=shape.ry,ox=a$1*k$1,oy=b$1*k$1;ctx.moveTo(x$1-a$1,y$1),ctx.bezierCurveTo(x$1-a$1,y$1-oy,x$1-ox,y$1-b$1,x$1,y$1-b$1),ctx.bezierCurveTo(x$1+ox,y$1-b$1,x$1+a$1,y$1-oy,x$1+a$1,y$1),ctx.bezierCurveTo(x$1+a$1,y$1+oy,x$1+ox,y$1+b$1,x$1,y$1+b$1),ctx.bezierCurveTo(x$1-ox,y$1+b$1,x$1-a$1,y$1+oy,x$1-a$1,y$1),ctx.closePath()},Ellipse$2}(Path_default);Ellipse.prototype.type=`ellipse`;var Ellipse_default=Ellipse,PI$2=Math.PI,PI2=PI$2*2,mathSin=Math.sin,mathCos=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs$2=Math.abs,mathSqrt=Math.sqrt,mathMax$4=Math.max,mathMin$4=Math.min,e=1e-4;function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var dx10=x1-x0,dy10=y1-y0,dx32=x3-x2,dy32=y3-y2,t$1=dy32*dx10-dx32*dy10;if(!(t$1*t$1<e))return t$1=(dx32*(y0-y2)-dy32*(x0-x2))/t$1,[x0+t$1*dx10,y0+t$1*dy10]}function computeCornerTangents(x0,y0,x1,y1,radius,cr,clockwise){var x01=x0-x1,y01=y0-y1,lo=(clockwise?cr:-cr)/mathSqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r$1=radius-cr,s$1=x11*y10-x10*y11,d$1=(dy<0?-1:1)*mathSqrt(mathMax$4(0,r$1*r$1*d2-s$1*s$1)),cx0=(s$1*dy-dx*d$1)/d2,cy0=(-s$1*dx-dy*d$1)/d2,cx1=(s$1*dy+dx*d$1)/d2,cy1=(-s$1*dx+dy*d$1)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x0:-ox,y0:-oy,x1:cx0*(radius/r$1-1),y1:cy0*(radius/r$1-1)}}function normalizeCornerRadius(cr){var arr;if(isArray(cr)){var len$1=cr.length;if(!len$1)return cr;arr=len$1===1?[cr[0],cr[0],0,0]:len$1===2?[cr[0],cr[0],cr[1],cr[1]]:len$1===3?cr.concat(cr[2]):cr}else arr=[cr,cr,cr,cr];return arr}function buildPath$1(ctx,shape){var _a$1,radius=mathMax$4(shape.r,0),innerRadius=mathMax$4(shape.r0||0,0),hasRadius=radius>0;if(!(!hasRadius&&!(innerRadius>0))){if(hasRadius||(radius=innerRadius,innerRadius=0),innerRadius>radius){var tmp=radius;radius=innerRadius,innerRadius=tmp}var startAngle=shape.startAngle,endAngle=shape.endAngle;if(!(isNaN(startAngle)||isNaN(endAngle))){var cx=shape.cx,cy=shape.cy,clockwise=!!shape.clockwise,arc=mathAbs$2(endAngle-startAngle),mod=arc>PI2&&arc%PI2;if(mod>e&&(arc=mod),!(radius>e))ctx.moveTo(cx,cy);else if(arc>PI2-e)ctx.moveTo(cx+radius*mathCos(startAngle),cy+radius*mathSin(startAngle)),ctx.arc(cx,cy,radius,startAngle,endAngle,!clockwise),innerRadius>e&&(ctx.moveTo(cx+innerRadius*mathCos(endAngle),cy+innerRadius*mathSin(endAngle)),ctx.arc(cx,cy,innerRadius,endAngle,startAngle,clockwise));else{var icrStart=void 0,icrEnd=void 0,ocrStart=void 0,ocrEnd=void 0,ocrs=void 0,ocre=void 0,icrs=void 0,icre=void 0,ocrMax=void 0,icrMax=void 0,limitedOcrMax=void 0,limitedIcrMax=void 0,xre=void 0,yre=void 0,xirs=void 0,yirs=void 0,xrs=radius*mathCos(startAngle),yrs=radius*mathSin(startAngle),xire=innerRadius*mathCos(endAngle),yire=innerRadius*mathSin(endAngle),hasArc=arc>e;if(hasArc){var cornerRadius=shape.cornerRadius;cornerRadius&&(_a$1=normalizeCornerRadius(cornerRadius),icrStart=_a$1[0],icrEnd=_a$1[1],ocrStart=_a$1[2],ocrEnd=_a$1[3]);var halfRd=mathAbs$2(radius-innerRadius)/2;if(ocrs=mathMin$4(halfRd,ocrStart),ocre=mathMin$4(halfRd,ocrEnd),icrs=mathMin$4(halfRd,icrStart),icre=mathMin$4(halfRd,icrEnd),limitedOcrMax=ocrMax=mathMax$4(ocrs,ocre),limitedIcrMax=icrMax=mathMax$4(icrs,icre),(ocrMax>e||icrMax>e)&&(xre=radius*mathCos(endAngle),yre=radius*mathSin(endAngle),xirs=innerRadius*mathCos(startAngle),yirs=innerRadius*mathSin(startAngle),arc<PI$2)){var it_1=intersect(xrs,yrs,xirs,yirs,xre,yre,xire,yire);if(it_1){var x0=xrs-it_1[0],y0=yrs-it_1[1],x1=xre-it_1[0],y1=yre-it_1[1],a$1=1/mathSin(mathACos((x0*x1+y0*y1)/(mathSqrt(x0*x0+y0*y0)*mathSqrt(x1*x1+y1*y1)))/2),b$1=mathSqrt(it_1[0]*it_1[0]+it_1[1]*it_1[1]);limitedOcrMax=mathMin$4(ocrMax,(radius-b$1)/(a$1+1)),limitedIcrMax=mathMin$4(icrMax,(innerRadius-b$1)/(a$1-1))}}}if(!hasArc)ctx.moveTo(cx+xrs,cy+yrs);else if(limitedOcrMax>e){var crStart=mathMin$4(ocrStart,limitedOcrMax),crEnd=mathMin$4(ocrEnd,limitedOcrMax),ct0=computeCornerTangents(xirs,yirs,xrs,yrs,radius,crStart,clockwise),ct1=computeCornerTangents(xre,yre,xire,yire,radius,crEnd,clockwise);ctx.moveTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedOcrMax<ocrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedOcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(crStart>0&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crStart,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,radius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),!clockwise),crEnd>0&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crEnd,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))}else ctx.moveTo(cx+xrs,cy+yrs),ctx.arc(cx,cy,radius,startAngle,endAngle,!clockwise);if(!(innerRadius>e)||!hasArc)ctx.lineTo(cx+xire,cy+yire);else if(limitedIcrMax>e){var crStart=mathMin$4(icrStart,limitedIcrMax),crEnd=mathMin$4(icrEnd,limitedIcrMax),ct0=computeCornerTangents(xire,yire,xre,yre,innerRadius,-crEnd,clockwise),ct1=computeCornerTangents(xrs,yrs,xirs,yirs,innerRadius,-crStart,clockwise);ctx.lineTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedIcrMax<icrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedIcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(crEnd>0&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crEnd,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,innerRadius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),clockwise),crStart>0&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crStart,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))}else ctx.lineTo(cx+xire,cy+yire),ctx.arc(cx,cy,innerRadius,endAngle,startAngle,clockwise)}ctx.closePath()}}}var SectorShape=function(){function SectorShape$1(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return SectorShape$1}(),Sector=function(_super){__extends(Sector$1,_super);function Sector$1(opts){return _super.call(this,opts)||this}return Sector$1.prototype.getDefaultShape=function(){return new SectorShape},Sector$1.prototype.buildPath=function(ctx,shape){buildPath$1(ctx,shape)},Sector$1.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},Sector$1}(Path_default);Sector.prototype.type=`sector`;var Sector_default=Sector,RingShape=function(){function RingShape$1(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return RingShape$1}(),Ring=function(_super){__extends(Ring$1,_super);function Ring$1(opts){return _super.call(this,opts)||this}return Ring$1.prototype.getDefaultShape=function(){return new RingShape},Ring$1.prototype.buildPath=function(ctx,shape){var x$1=shape.cx,y$1=shape.cy,PI2$6=Math.PI*2;ctx.moveTo(x$1+shape.r,y$1),ctx.arc(x$1,y$1,shape.r,0,PI2$6,!1),ctx.moveTo(x$1+shape.r0,y$1),ctx.arc(x$1,y$1,shape.r0,0,PI2$6,!0)},Ring$1}(Path_default);Ring.prototype.type=`ring`;var Ring_default=Ring;function smoothBezier(points$1,smooth,isLoop,constraint){var cps=[],v$1=[],v1=[],v2=[],prevPoint,nextPoint,min$2,max$2;if(constraint){min$2=[1/0,1/0],max$2=[-1/0,-1/0];for(var i$1=0,len$1=points$1.length;i$1<len$1;i$1++)min(min$2,min$2,points$1[i$1]),max(max$2,max$2,points$1[i$1]);min(min$2,min$2,constraint[0]),max(max$2,max$2,constraint[1])}for(var i$1=0,len$1=points$1.length;i$1<len$1;i$1++){var point=points$1[i$1];if(isLoop)prevPoint=points$1[i$1?i$1-1:len$1-1],nextPoint=points$1[(i$1+1)%len$1];else if(i$1===0||i$1===len$1-1){cps.push(clone$2(points$1[i$1]));continue}else prevPoint=points$1[i$1-1],nextPoint=points$1[i$1+1];sub(v$1,nextPoint,prevPoint),scale$1(v$1,v$1,smooth);var d0=distance(point,prevPoint),d1=distance(point,nextPoint),sum=d0+d1;sum!==0&&(d0/=sum,d1/=sum),scale$1(v1,v$1,-d0),scale$1(v2,v$1,d1);var cp0=add([],point,v1),cp1=add([],point,v2);constraint&&(max(cp0,cp0,min$2),min(cp0,cp0,max$2),max(cp1,cp1,min$2),min(cp1,cp1,max$2)),cps.push(cp0),cps.push(cp1)}return isLoop&&cps.push(cps.shift()),cps}function buildPath(ctx,shape,closePath){var smooth=shape.smooth,points$1=shape.points;if(points$1&&points$1.length>=2){if(smooth){var controlPoints=smoothBezier(points$1,smooth,closePath,shape.smoothConstraint);ctx.moveTo(points$1[0][0],points$1[0][1]);for(var len$1=points$1.length,i$1=0;i$1<(closePath?len$1:len$1-1);i$1++){var cp1=controlPoints[i$1*2],cp2=controlPoints[i$1*2+1],p$2=points$1[(i$1+1)%len$1];ctx.bezierCurveTo(cp1[0],cp1[1],cp2[0],cp2[1],p$2[0],p$2[1])}}else{ctx.moveTo(points$1[0][0],points$1[0][1]);for(var i$1=1,l$1=points$1.length;i$1<l$1;i$1++)ctx.lineTo(points$1[i$1][0],points$1[i$1][1])}closePath&&ctx.closePath()}}var PolygonShape=function(){function PolygonShape$1(){this.points=null,this.smooth=0,this.smoothConstraint=null}return PolygonShape$1}(),Polygon=function(_super){__extends(Polygon$2,_super);function Polygon$2(opts){return _super.call(this,opts)||this}return Polygon$2.prototype.getDefaultShape=function(){return new PolygonShape},Polygon$2.prototype.buildPath=function(ctx,shape){buildPath(ctx,shape,!0)},Polygon$2}(Path_default);Polygon.prototype.type=`polygon`;var Polygon_default=Polygon,PolylineShape=function(){function PolylineShape$1(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return PolylineShape$1}(),Polyline=function(_super){__extends(Polyline$1,_super);function Polyline$1(opts){return _super.call(this,opts)||this}return Polyline$1.prototype.getDefaultStyle=function(){return{stroke:`#000`,fill:null}},Polyline$1.prototype.getDefaultShape=function(){return new PolylineShape},Polyline$1.prototype.buildPath=function(ctx,shape){buildPath(ctx,shape,!1)},Polyline$1}(Path_default);Polyline.prototype.type=`polyline`;var Polyline_default=Polyline,subPixelOptimizeOutputShape={},LineShape=function(){function LineShape$1(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return LineShape$1}(),Line=function(_super){__extends(Line$1,_super);function Line$1(opts){return _super.call(this,opts)||this}return Line$1.prototype.getDefaultStyle=function(){return{stroke:`#000`,fill:null}},Line$1.prototype.getDefaultShape=function(){return new LineShape},Line$1.prototype.buildPath=function(ctx,shape){var x1,y1,x2,y2;if(this.subPixelOptimize){var optimizedShape=subPixelOptimizeLine$1(subPixelOptimizeOutputShape,shape,this.style);x1=optimizedShape.x1,y1=optimizedShape.y1,x2=optimizedShape.x2,y2=optimizedShape.y2}else x1=shape.x1,y1=shape.y1,x2=shape.x2,y2=shape.y2;var percent=shape.percent;percent!==0&&(ctx.moveTo(x1,y1),percent<1&&(x2=x1*(1-percent)+x2*percent,y2=y1*(1-percent)+y2*percent),ctx.lineTo(x2,y2))},Line$1.prototype.pointAt=function(p$2){var shape=this.shape;return[shape.x1*(1-p$2)+shape.x2*p$2,shape.y1*(1-p$2)+shape.y2*p$2]},Line$1}(Path_default);Line.prototype.type=`line`;var Line_default=Line,out=[],BezierCurveShape=function(){function BezierCurveShape$1(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return BezierCurveShape$1}();function someVectorAt(shape,t$1,isTangent){var cpx2=shape.cpx2,cpy2=shape.cpy2;return cpx2!=null||cpy2!=null?[(isTangent?cubicDerivativeAt:cubicAt)(shape.x1,shape.cpx1,shape.cpx2,shape.x2,t$1),(isTangent?cubicDerivativeAt:cubicAt)(shape.y1,shape.cpy1,shape.cpy2,shape.y2,t$1)]:[(isTangent?quadraticDerivativeAt:quadraticAt)(shape.x1,shape.cpx1,shape.x2,t$1),(isTangent?quadraticDerivativeAt:quadraticAt)(shape.y1,shape.cpy1,shape.y2,t$1)]}var BezierCurve=function(_super){__extends(BezierCurve$1,_super);function BezierCurve$1(opts){return _super.call(this,opts)||this}return BezierCurve$1.prototype.getDefaultStyle=function(){return{stroke:`#000`,fill:null}},BezierCurve$1.prototype.getDefaultShape=function(){return new BezierCurveShape},BezierCurve$1.prototype.buildPath=function(ctx,shape){var x1=shape.x1,y1=shape.y1,x2=shape.x2,y2=shape.y2,cpx1=shape.cpx1,cpy1=shape.cpy1,cpx2=shape.cpx2,cpy2=shape.cpy2,percent=shape.percent;percent!==0&&(ctx.moveTo(x1,y1),cpx2==null||cpy2==null?(percent<1&&(quadraticSubdivide(x1,cpx1,x2,percent,out),cpx1=out[1],x2=out[2],quadraticSubdivide(y1,cpy1,y2,percent,out),cpy1=out[1],y2=out[2]),ctx.quadraticCurveTo(cpx1,cpy1,x2,y2)):(percent<1&&(cubicSubdivide(x1,cpx1,cpx2,x2,percent,out),cpx1=out[1],cpx2=out[2],x2=out[3],cubicSubdivide(y1,cpy1,cpy2,y2,percent,out),cpy1=out[1],cpy2=out[2],y2=out[3]),ctx.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,x2,y2)))},BezierCurve$1.prototype.pointAt=function(t$1){return someVectorAt(this.shape,t$1,!1)},BezierCurve$1.prototype.tangentAt=function(t$1){var p$2=someVectorAt(this.shape,t$1,!0);return normalize$1(p$2,p$2)},BezierCurve$1}(Path_default);BezierCurve.prototype.type=`bezier-curve`;var BezierCurve_default=BezierCurve,ArcShape=function(){function ArcShape$1(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return ArcShape$1}(),Arc=function(_super){__extends(Arc$1,_super);function Arc$1(opts){return _super.call(this,opts)||this}return Arc$1.prototype.getDefaultStyle=function(){return{stroke:`#000`,fill:null}},Arc$1.prototype.getDefaultShape=function(){return new ArcShape},Arc$1.prototype.buildPath=function(ctx,shape){var x$1=shape.cx,y$1=shape.cy,r$1=Math.max(shape.r,0),startAngle=shape.startAngle,endAngle=shape.endAngle,clockwise=shape.clockwise,unitX=Math.cos(startAngle),unitY=Math.sin(startAngle);ctx.moveTo(unitX*r$1+x$1,unitY*r$1+y$1),ctx.arc(x$1,y$1,r$1,startAngle,endAngle,!clockwise)},Arc$1}(Path_default);Arc.prototype.type=`arc`;var Arc_default=Arc,CompoundPath_default=function(_super){__extends(CompoundPath$1,_super);function CompoundPath$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`compound`,_this}return CompoundPath$1.prototype._updatePathDirty=function(){for(var paths=this.shape.paths,dirtyPath=this.shapeChanged(),i$1=0;i$1<paths.length;i$1++)dirtyPath||=paths[i$1].shapeChanged();dirtyPath&&this.dirtyShape()},CompoundPath$1.prototype.beforeBrush=function(){this._updatePathDirty();for(var paths=this.shape.paths||[],scale$3=this.getGlobalScale(),i$1=0;i$1<paths.length;i$1++)paths[i$1].path||paths[i$1].createPathProxy(),paths[i$1].path.setScale(scale$3[0],scale$3[1],paths[i$1].segmentIgnoreThreshold)},CompoundPath$1.prototype.buildPath=function(ctx,shape){for(var paths=shape.paths||[],i$1=0;i$1<paths.length;i$1++)paths[i$1].buildPath(ctx,paths[i$1].shape,!0)},CompoundPath$1.prototype.afterBrush=function(){for(var paths=this.shape.paths||[],i$1=0;i$1<paths.length;i$1++)paths[i$1].pathUpdated()},CompoundPath$1.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path_default.prototype.getBoundingRect.call(this)},CompoundPath$1}(Path_default),Gradient_default=function(){function Gradient$1(colorStops){this.colorStops=colorStops||[]}return Gradient$1.prototype.addColorStop=function(offset,color$2){this.colorStops.push({offset,color:color$2})},Gradient$1}(),LinearGradient_default=function(_super){__extends(LinearGradient$1,_super);function LinearGradient$1(x$1,y$1,x2,y2,colorStops,globalCoord){var _this=_super.call(this,colorStops)||this;return _this.x=x$1??0,_this.y=y$1??0,_this.x2=x2??1,_this.y2=y2??0,_this.type=`linear`,_this.global=globalCoord||!1,_this}return LinearGradient$1}(Gradient_default),RadialGradient_default=function(_super){__extends(RadialGradient$1,_super);function RadialGradient$1(x$1,y$1,r$1,colorStops,globalCoord){var _this=_super.call(this,colorStops)||this;return _this.x=x$1??.5,_this.y=y$1??.5,_this.r=r$1??.5,_this.type=`radial`,_this.global=globalCoord||!1,_this}return RadialGradient$1}(Gradient_default),mathMin$3=Math.min,mathMax$3=Math.max,mathAbs$1=Math.abs,_extent=[0,0],_extent2=[0,0],_intersectCtx=createIntersectContext(),_minTv=_intersectCtx.minTv,_maxTv=_intersectCtx.maxTv,OrientedBoundingRect_default=function(){function OrientedBoundingRect$1(rect,transform){this._corners=[],this._axes=[],this._origin=[0,0];for(var i$1=0;i$1<4;i$1++)this._corners[i$1]=new Point_default;for(var i$1=0;i$1<2;i$1++)this._axes[i$1]=new Point_default;rect&&this.fromBoundingRect(rect,transform)}return OrientedBoundingRect$1.prototype.fromBoundingRect=function(rect,transform){var corners=this._corners,axes=this._axes,x$1=rect.x,y$1=rect.y,x2=x$1+rect.width,y2=y$1+rect.height;if(corners[0].set(x$1,y$1),corners[1].set(x2,y$1),corners[2].set(x2,y2),corners[3].set(x$1,y2),transform)for(var i$1=0;i$1<4;i$1++)corners[i$1].transform(transform);Point_default.sub(axes[0],corners[1],corners[0]),Point_default.sub(axes[1],corners[3],corners[0]),axes[0].normalize(),axes[1].normalize();for(var i$1=0;i$1<2;i$1++)this._origin[i$1]=axes[i$1].dot(corners[0])},OrientedBoundingRect$1.prototype.intersect=function(other,mtv,opt){var overlapped=!0,noMtv=!mtv;return mtv&&Point_default.set(mtv,0,0),_intersectCtx.reset(opt,!noMtv),!this._intersectCheckOneSide(this,other,noMtv,1)&&(overlapped=!1,noMtv)||!this._intersectCheckOneSide(other,this,noMtv,-1)&&(overlapped=!1,noMtv)||!noMtv&&!_intersectCtx.negativeSize&&Point_default.copy(mtv,overlapped?_intersectCtx.useDir?_intersectCtx.dirMinTv:_minTv:_maxTv),overlapped},OrientedBoundingRect$1.prototype._intersectCheckOneSide=function(self$1,other,noMtv,inverse){for(var overlapped=!0,i$1=0;i$1<2;i$1++){var axis=self$1._axes[i$1];if(self$1._getProjMinMaxOnAxis(i$1,self$1._corners,_extent),self$1._getProjMinMaxOnAxis(i$1,other._corners,_extent2),_intersectCtx.negativeSize||_extent[1]<_extent2[0]||_extent[0]>_extent2[1]){if(overlapped=!1,_intersectCtx.negativeSize||noMtv)return overlapped;var dist0=mathAbs$1(_extent2[0]-_extent[1]),dist1=mathAbs$1(_extent[0]-_extent2[1]);mathMin$3(dist0,dist1)>_maxTv.len()&&(dist0<dist1?Point_default.scale(_maxTv,axis,-dist0*inverse):Point_default.scale(_maxTv,axis,dist1*inverse))}else if(!noMtv){var dist0=mathAbs$1(_extent2[0]-_extent[1]),dist1=mathAbs$1(_extent[0]-_extent2[1]);(_intersectCtx.useDir||mathMin$3(dist0,dist1)<_minTv.len())&&((dist0<dist1||!_intersectCtx.bidirectional)&&(Point_default.scale(_minTv,axis,dist0*inverse),_intersectCtx.useDir&&_intersectCtx.calcDirMTV()),(dist0>=dist1||!_intersectCtx.bidirectional)&&(Point_default.scale(_minTv,axis,-dist1*inverse),_intersectCtx.useDir&&_intersectCtx.calcDirMTV()))}}return overlapped},OrientedBoundingRect$1.prototype._getProjMinMaxOnAxis=function(dim,corners,out$2){for(var axis=this._axes[dim],origin=this._origin,proj=corners[0].dot(axis)+origin[dim],min$2=proj,max$2=proj,i$1=1;i$1<corners.length;i$1++){var proj_1=corners[i$1].dot(axis)+origin[dim];min$2=mathMin$3(proj_1,min$2),max$2=mathMax$3(proj_1,max$2)}out$2[0]=min$2+_intersectCtx.touchThreshold,out$2[1]=max$2-_intersectCtx.touchThreshold,_intersectCtx.negativeSize=out$2[1]<out$2[0]},OrientedBoundingRect$1}(),m=[],IncrementalDisplayable_default=function(_super){__extends(IncrementalDisplayable$1,_super);function IncrementalDisplayable$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.notClear=!0,_this.incremental=!0,_this._displayables=[],_this._temporaryDisplayables=[],_this._cursor=0,_this}return IncrementalDisplayable$1.prototype.traverse=function(cb,context$1){cb.call(context$1,this)},IncrementalDisplayable$1.prototype.useStyle=function(){this.style={}},IncrementalDisplayable$1.prototype.getCursor=function(){return this._cursor},IncrementalDisplayable$1.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},IncrementalDisplayable$1.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},IncrementalDisplayable$1.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},IncrementalDisplayable$1.prototype.addDisplayable=function(displayable,notPersistent){notPersistent?this._temporaryDisplayables.push(displayable):this._displayables.push(displayable),this.markRedraw()},IncrementalDisplayable$1.prototype.addDisplayables=function(displayables,notPersistent){notPersistent||=!1;for(var i$1=0;i$1<displayables.length;i$1++)this.addDisplayable(displayables[i$1],notPersistent)},IncrementalDisplayable$1.prototype.getDisplayables=function(){return this._displayables},IncrementalDisplayable$1.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},IncrementalDisplayable$1.prototype.eachPendingDisplayable=function(cb){for(var i$1=this._cursor;i$1<this._displayables.length;i$1++)cb&&cb(this._displayables[i$1]);for(var i$1=0;i$1<this._temporaryDisplayables.length;i$1++)cb&&cb(this._temporaryDisplayables[i$1])},IncrementalDisplayable$1.prototype.update=function(){this.updateTransform();for(var i$1=this._cursor;i$1<this._displayables.length;i$1++){var displayable=this._displayables[i$1];displayable.parent=this,displayable.update(),displayable.parent=null}for(var i$1=0;i$1<this._temporaryDisplayables.length;i$1++){var displayable=this._temporaryDisplayables[i$1];displayable.parent=this,displayable.update(),displayable.parent=null}},IncrementalDisplayable$1.prototype.getBoundingRect=function(){if(!this._rect){for(var rect=new BoundingRect_default(1/0,1/0,-1/0,-1/0),i$1=0;i$1<this._displayables.length;i$1++){var displayable=this._displayables[i$1],childRect=displayable.getBoundingRect().clone();displayable.needLocalTransform()&&childRect.applyTransform(displayable.getLocalTransform(m)),rect.union(childRect)}this._rect=rect}return this._rect},IncrementalDisplayable$1.prototype.contain=function(x$1,y$1){var localPos=this.transformCoordToLocal(x$1,y$1);if(this.getBoundingRect().contain(localPos[0],localPos[1])){for(var i$1=0;i$1<this._displayables.length;i$1++)if(this._displayables[i$1].contain(x$1,y$1))return!0}return!1},IncrementalDisplayable$1}(Displayable_default),transitionStore=makeInner();function getAnimationConfig(animationType,animatableModel,dataIndex,extraOpts,extraDelayParams){var animationPayload;if(animatableModel&&animatableModel.ecModel){var updatePayload=animatableModel.ecModel.getUpdatePayload();animationPayload=updatePayload&&updatePayload.animation}var animationEnabled=animatableModel&&animatableModel.isAnimationEnabled(),isUpdate=animationType===`update`;if(animationEnabled){var duration=void 0,easing=void 0,delay=void 0;return extraOpts?(duration=retrieve2(extraOpts.duration,200),easing=retrieve2(extraOpts.easing,`cubicOut`),delay=0):(duration=animatableModel.getShallow(isUpdate?`animationDurationUpdate`:`animationDuration`),easing=animatableModel.getShallow(isUpdate?`animationEasingUpdate`:`animationEasing`),delay=animatableModel.getShallow(isUpdate?`animationDelayUpdate`:`animationDelay`)),animationPayload&&(animationPayload.duration!=null&&(duration=animationPayload.duration),animationPayload.easing!=null&&(easing=animationPayload.easing),animationPayload.delay!=null&&(delay=animationPayload.delay)),isFunction(delay)&&(delay=delay(dataIndex,extraDelayParams)),isFunction(duration)&&(duration=duration(dataIndex)),{duration:duration||0,delay,easing}}else return null}function animateOrSetProps(animationType,el,props,animatableModel,dataIndex,cb,during){var isFrom=!1,removeOpt;isFunction(dataIndex)?(during=cb,cb=dataIndex,dataIndex=null):isObject(dataIndex)&&(cb=dataIndex.cb,during=dataIndex.during,isFrom=dataIndex.isFrom,removeOpt=dataIndex.removeOpt,dataIndex=dataIndex.dataIndex);var isRemove=animationType===`leave`;isRemove||el.stopAnimation(`leave`);var animationConfig=getAnimationConfig(animationType,animatableModel,dataIndex,isRemove?removeOpt||{}:null,animatableModel&&animatableModel.getAnimationDelayParams?animatableModel.getAnimationDelayParams(el,dataIndex):null);if(animationConfig&&animationConfig.duration>0){var duration=animationConfig.duration,animationDelay=animationConfig.delay,animationEasing=animationConfig.easing,animateConfig={duration,delay:animationDelay||0,easing:animationEasing,done:cb,force:!!cb||!!during,setToFinal:!isRemove,scope:animationType,during};isFrom?el.animateFrom(props,animateConfig):el.animateTo(props,animateConfig)}else el.stopAnimation(),!isFrom&&el.attr(props),during&&during(1),cb&&cb()}function updateProps$1(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps(`update`,el,props,animatableModel,dataIndex,cb,during)}function initProps(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps(`enter`,el,props,animatableModel,dataIndex,cb,during)}function isElementRemoved(el){if(!el.__zr)return!0;for(var i$1=0;i$1<el.animators.length;i$1++)if(el.animators[i$1].scope===`leave`)return!0;return!1}function removeElement(el,props,animatableModel,dataIndex,cb,during){isElementRemoved(el)||animateOrSetProps(`leave`,el,props,animatableModel,dataIndex,cb,during)}function fadeOutDisplayable(el,animatableModel,dataIndex,done){el.removeTextContent(),el.removeTextGuideLine(),removeElement(el,{style:{opacity:0}},animatableModel,dataIndex,done)}function removeElementWithFadeOut(el,animatableModel,dataIndex){function doRemove(){el.parent&&el.parent.remove(el)}el.isGroup?el.traverse(function(disp){disp.isGroup||fadeOutDisplayable(disp,animatableModel,dataIndex,doRemove)}):fadeOutDisplayable(el,animatableModel,dataIndex,doRemove)}function saveOldStyle(el){transitionStore(el).oldStyle=el.style}var graphic_exports=__export({Arc:()=>Arc_default,BezierCurve:()=>BezierCurve_default,BoundingRect:()=>BoundingRect_default,Circle:()=>Circle_default,CompoundPath:()=>CompoundPath_default,Ellipse:()=>Ellipse_default,Group:()=>Group_default,Image:()=>Image_default,IncrementalDisplayable:()=>IncrementalDisplayable_default,Line:()=>Line_default,LinearGradient:()=>LinearGradient_default,OrientedBoundingRect:()=>OrientedBoundingRect_default,Path:()=>Path_default,Point:()=>Point_default,Polygon:()=>Polygon_default,Polyline:()=>Polyline_default,RadialGradient:()=>RadialGradient_default,Rect:()=>Rect_default,Ring:()=>Ring_default,Sector:()=>Sector_default,Text:()=>Text_default,WH:()=>WH,XY:()=>XY,applyTransform:()=>applyTransform$1,calcZ2Range:()=>calcZ2Range,clipPointsByRect:()=>clipPointsByRect,clipRectByRect:()=>clipRectByRect,createIcon:()=>createIcon,ensureCopyRect:()=>ensureCopyRect,ensureCopyTransform:()=>ensureCopyTransform,expandOrShrinkRect:()=>expandOrShrinkRect,extendPath:()=>extendPath,extendShape:()=>extendShape,getShapeClass:()=>getShapeClass,getTransform:()=>getTransform,groupTransition:()=>groupTransition,initProps:()=>initProps,isBoundingRectAxisAligned:()=>isBoundingRectAxisAligned,isElementRemoved:()=>isElementRemoved,lineLineIntersect:()=>lineLineIntersect,linePolygonIntersect:()=>linePolygonIntersect,makeImage:()=>makeImage,makePath:()=>makePath,mergePath:()=>mergePath,registerShape:()=>registerShape,removeElement:()=>removeElement,removeElementWithFadeOut:()=>removeElementWithFadeOut,resizePath:()=>resizePath,retrieveZInfo:()=>retrieveZInfo,setTooltipConfig:()=>setTooltipConfig,subPixelOptimize:()=>subPixelOptimize,subPixelOptimizeLine:()=>subPixelOptimizeLine,subPixelOptimizeRect:()=>subPixelOptimizeRect,transformDirection:()=>transformDirection,traverseElements:()=>traverseElements,traverseUpdateZ:()=>traverseUpdateZ,updateProps:()=>updateProps$1}),_customShapeMap={},XY=[`x`,`y`],WH=[`width`,`height`];function extendShape(opts){return Path_default.extend(opts)}var extendPathFromString=extendFromString;function extendPath(pathData,opts){return extendPathFromString(pathData,opts)}function registerShape(name,ShapeClass){_customShapeMap[name]=ShapeClass}function getShapeClass(name){if(_customShapeMap.hasOwnProperty(name))return _customShapeMap[name]}function makePath(pathData,opts,rect,layout$2){var path$1=createFromString(pathData,opts);return rect&&(layout$2===`center`&&(rect=centerGraphic(rect,path$1.getBoundingRect())),resizePath(path$1,rect)),path$1}function makeImage(imageUrl,rect,layout$2){var zrImg=new Image_default({style:{image:imageUrl,x:rect.x,y:rect.y,width:rect.width,height:rect.height},onload:function(img){if(layout$2===`center`){var boundingRect={width:img.width,height:img.height};zrImg.setStyle(centerGraphic(rect,boundingRect))}}});return zrImg}function centerGraphic(rect,boundingRect){var aspect=boundingRect.width/boundingRect.height,width=rect.height*aspect,height;width<=rect.width?height=rect.height:(width=rect.width,height=width/aspect);var cx=rect.x+rect.width/2,cy=rect.y+rect.height/2;return{x:cx-width/2,y:cy-height/2,width,height}}var mergePath=mergePath$1;function resizePath(path$1,rect){if(path$1.applyTransform){var m$2=path$1.getBoundingRect().calculateTransform(rect);path$1.applyTransform(m$2)}}function subPixelOptimizeLine(shape,lineWidth){return subPixelOptimizeLine$1(shape,shape,{lineWidth}),shape}function subPixelOptimizeRect(shape,style){return subPixelOptimizeRect$1(shape,shape,style),shape}var subPixelOptimize=subPixelOptimize$1;function getTransform(target,ancestor){for(var mat=identity([]);target&&target!==ancestor;)mul(mat,target.getLocalTransform(),mat),target=target.parent;return mat}function applyTransform$1(target,transform,invert$1){return transform&&!isArrayLike(transform)&&(transform=Transformable_default.getLocalTransform(transform)),invert$1&&(transform=invert([],transform)),applyTransform([],target,transform)}function transformDirection(direction,transform,invert$1){var hBase=transform[4]===0||transform[5]===0||transform[0]===0?1:mathAbs(2*transform[4]/transform[0]),vBase=transform[4]===0||transform[5]===0||transform[2]===0?1:mathAbs(2*transform[4]/transform[2]),vertex$3=[direction===`left`?-hBase:direction===`right`?hBase:0,direction===`top`?-vBase:direction===`bottom`?vBase:0];return vertex$3=applyTransform$1(vertex$3,transform,invert$1),mathAbs(vertex$3[0])>mathAbs(vertex$3[1])?vertex$3[0]>0?`right`:`left`:vertex$3[1]>0?`bottom`:`top`}function isNotGroup(el){return!el.isGroup}function isPath(el){return el.shape!=null}function groupTransition(g1,g2,animatableModel){if(!g1||!g2)return;function getElMap(g$1){var elMap={};return g$1.traverse(function(el){isNotGroup(el)&&el.anid&&(elMap[el.anid]=el)}),elMap}function getAnimatableProps(el){var obj={x:el.x,y:el.y,rotation:el.rotation};return isPath(el)&&(obj.shape=clone(el.shape)),obj}var elMap1=getElMap(g1);g2.traverse(function(el){if(isNotGroup(el)&&el.anid){var oldEl=elMap1[el.anid];if(oldEl){var newProp=getAnimatableProps(el);el.attr(getAnimatableProps(oldEl)),updateProps$1(el,newProp,animatableModel,getECData(el).dataIndex)}}})}function clipPointsByRect(points$1,rect){return map(points$1,function(point){var x$1=point[0];x$1=mathMax(x$1,rect.x),x$1=mathMin$2(x$1,rect.x+rect.width);var y$1=point[1];return y$1=mathMax(y$1,rect.y),y$1=mathMin$2(y$1,rect.y+rect.height),[x$1,y$1]})}function clipRectByRect(targetRect,rect){var x$1=mathMax(targetRect.x,rect.x),x2=mathMin$2(targetRect.x+targetRect.width,rect.x+rect.width),y$1=mathMax(targetRect.y,rect.y),y2=mathMin$2(targetRect.y+targetRect.height,rect.y+rect.height);if(x2>=x$1&&y2>=y$1)return{x:x$1,y:y$1,width:x2-x$1,height:y2-y$1}}function createIcon(iconStr,opt,rect){var innerOpts=extend({rectHover:!0},opt),style=innerOpts.style={strokeNoScale:!0};if(rect||={x:-1,y:-1,width:2,height:2},iconStr)return iconStr.indexOf(`image://`)===0?(style.image=iconStr.slice(8),defaults(style,rect),new Image_default(innerOpts)):makePath(iconStr.replace(`path://`,``),innerOpts,rect,`center`)}function linePolygonIntersect(a1x,a1y,a2x,a2y,points$1){for(var i$1=0,p2=points$1[points$1.length-1];i$1<points$1.length;i$1++){var p$2=points$1[i$1];if(lineLineIntersect(a1x,a1y,a2x,a2y,p$2[0],p$2[1],p2[0],p2[1]))return!0;p2=p$2}}function lineLineIntersect(a1x,a1y,a2x,a2y,b1x,b1y,b2x,b2y){var mx=a2x-a1x,my=a2y-a1y,nx=b2x-b1x,ny=b2y-b1y,nmCrossProduct=crossProduct2d(nx,ny,mx,my);if(nearZero(nmCrossProduct))return!1;var b1a1x=a1x-b1x,b1a1y=a1y-b1y,q$1=crossProduct2d(b1a1x,b1a1y,mx,my)/nmCrossProduct;if(q$1<0||q$1>1)return!1;var p$2=crossProduct2d(b1a1x,b1a1y,nx,ny)/nmCrossProduct;return!(p$2<0||p$2>1)}function crossProduct2d(x1,y1,x2,y2){return x1*y2-x2*y1}function nearZero(val){return val<=1e-6&&val>=-1e-6}function expandOrShrinkRect(rect,delta,shrinkOrExpand,noNegative,minSize){return delta==null?rect:(isNumber(delta)?_tmpExpandRectDelta[0]=_tmpExpandRectDelta[1]=_tmpExpandRectDelta[2]=_tmpExpandRectDelta[3]=delta:(_tmpExpandRectDelta[0]=delta[0],_tmpExpandRectDelta[1]=delta[1],_tmpExpandRectDelta[2]=delta[2],_tmpExpandRectDelta[3]=delta[3]),noNegative&&(_tmpExpandRectDelta[0]=mathMax(0,_tmpExpandRectDelta[0]),_tmpExpandRectDelta[1]=mathMax(0,_tmpExpandRectDelta[1]),_tmpExpandRectDelta[2]=mathMax(0,_tmpExpandRectDelta[2]),_tmpExpandRectDelta[3]=mathMax(0,_tmpExpandRectDelta[3])),shrinkOrExpand&&(_tmpExpandRectDelta[0]=-_tmpExpandRectDelta[0],_tmpExpandRectDelta[1]=-_tmpExpandRectDelta[1],_tmpExpandRectDelta[2]=-_tmpExpandRectDelta[2],_tmpExpandRectDelta[3]=-_tmpExpandRectDelta[3]),expandRectOnOneDimension(rect,_tmpExpandRectDelta,`x`,`width`,3,1,minSize&&minSize[0]||0),expandRectOnOneDimension(rect,_tmpExpandRectDelta,`y`,`height`,0,2,minSize&&minSize[1]||0),rect)}var _tmpExpandRectDelta=[0,0,0,0];function expandRectOnOneDimension(rect,delta,xy,wh,ltIdx,rbIdx,minSize){var deltaSum=delta[rbIdx]+delta[ltIdx],oldSize=rect[wh];rect[wh]+=deltaSum,minSize=mathMax(0,mathMin$2(minSize,oldSize)),rect[wh]<minSize?(rect[wh]=minSize,rect[xy]+=delta[ltIdx]>=0?-delta[ltIdx]:delta[rbIdx]>=0?oldSize+delta[rbIdx]:mathAbs(deltaSum)>1e-8?(oldSize-minSize)*delta[ltIdx]/deltaSum:0):rect[xy]-=delta[ltIdx]}function setTooltipConfig(opt){var itemTooltipOption=opt.itemTooltipOption,componentModel=opt.componentModel,itemName=opt.itemName,itemTooltipOptionObj=isString(itemTooltipOption)?{formatter:itemTooltipOption}:itemTooltipOption,mainType=componentModel.mainType,componentIndex=componentModel.componentIndex,formatterParams={componentType:mainType,name:itemName,$vars:[`name`]};formatterParams[mainType+`Index`]=componentIndex;var formatterParamsExtra=opt.formatterParamsExtra;formatterParamsExtra&&each(keys(formatterParamsExtra),function(key$1){hasOwn(formatterParams,key$1)||(formatterParams[key$1]=formatterParamsExtra[key$1],formatterParams.$vars.push(key$1))});var ecData=getECData(opt.el);ecData.componentMainType=mainType,ecData.componentIndex=componentIndex,ecData.tooltipConfig={name:itemName,option:defaults({content:itemName,encodeHTMLContent:!0,formatterParams},itemTooltipOptionObj)}}function traverseElement(el,cb){var stopped;el.isGroup&&(stopped=cb(el)),stopped||el.traverse(cb)}function traverseElements(els,cb){if(els)if(isArray(els))for(var i$1=0;i$1<els.length;i$1++)traverseElement(els[i$1],cb);else traverseElement(els,cb)}function isBoundingRectAxisAligned(transform){return!transform||mathAbs(transform[1])<AXIS_ALIGN_EPSILON&&mathAbs(transform[2])<AXIS_ALIGN_EPSILON||mathAbs(transform[0])<AXIS_ALIGN_EPSILON&&mathAbs(transform[3])<AXIS_ALIGN_EPSILON}var AXIS_ALIGN_EPSILON=1e-5;function ensureCopyRect(target,source$2){return target?BoundingRect_default.copy(target,source$2):source$2.clone()}function ensureCopyTransform(target,source$2){return source$2?copy(target||create$1(),source$2):void 0}function retrieveZInfo(model){return{z:model.get(`z`)||0,zlevel:model.get(`zlevel`)||0}}function calcZ2Range(el){var max$2=-1/0,min$2=1/0;traverseElement(el,function(el$1){visitEl(el$1),visitEl(el$1.getTextContent()),visitEl(el$1.getTextGuideLine())});function visitEl(el$1){if(!(!el$1||el$1.isGroup)){var currentStates=el$1.currentStates;if(currentStates.length)for(var idx=0;idx<currentStates.length;idx++)calcZ2(el$1.states[currentStates[idx]]);calcZ2(el$1)}}function calcZ2(entity){if(entity){var z2=entity.z2;z2>max$2&&(max$2=z2),z2<min$2&&(min$2=z2)}}return min$2>max$2&&(min$2=max$2=0),{min:min$2,max:max$2}}function traverseUpdateZ(el,z,zlevel){doUpdateZ(el,z,zlevel,-1/0)}function doUpdateZ(el,z,zlevel,maxZ2){if(el.ignoreModelZ)return maxZ2;var label=el.getTextContent(),labelLine=el.getTextGuideLine();if(el.isGroup)for(var children=el.childrenRef(),i$1=0;i$1<children.length;i$1++)maxZ2=mathMax(doUpdateZ(children[i$1],z,zlevel,maxZ2),maxZ2);else el.z=z,el.zlevel=zlevel,maxZ2=mathMax(el.z2||0,maxZ2);if(label&&(label.z=z,label.zlevel=zlevel,isFinite(maxZ2)&&(label.z2=maxZ2+2)),labelLine){var textGuideLineConfig=el.textGuideLineConfig;labelLine.z=z,labelLine.zlevel=zlevel,isFinite(maxZ2)&&(labelLine.z2=maxZ2+(textGuideLineConfig&&textGuideLineConfig.showAbove?1:-1))}return maxZ2}registerShape(`circle`,Circle_default),registerShape(`ellipse`,Ellipse_default),registerShape(`sector`,Sector_default),registerShape(`ring`,Ring_default),registerShape(`polygon`,Polygon_default),registerShape(`polyline`,Polyline_default),registerShape(`rect`,Rect_default),registerShape(`line`,Line_default),registerShape(`bezierCurve`,BezierCurve_default),registerShape(`arc`,Arc_default);var EMPTY_OBJ={};function setLabelText(label,labelTexts){for(var i$1=0;i$1<SPECIAL_STATES.length;i$1++){var stateName=SPECIAL_STATES[i$1],text=labelTexts[stateName],state=label.ensureState(stateName);state.style=state.style||{},state.style.text=text}var oldStates=label.currentStates.slice();label.clearStates(!0),label.setStyle({text:labelTexts.normal}),label.useStates(oldStates,!0)}function getLabelText(opt,stateModels,interpolatedValue){var labelFetcher=opt.labelFetcher,labelDataIndex=opt.labelDataIndex,labelDimIndex=opt.labelDimIndex,normalModel=stateModels.normal,baseText;labelFetcher&&(baseText=labelFetcher.getFormattedLabel(labelDataIndex,`normal`,null,labelDimIndex,normalModel&&normalModel.get(`formatter`),interpolatedValue==null?null:{interpolatedValue})),baseText??=isFunction(opt.defaultText)?opt.defaultText(labelDataIndex,opt,interpolatedValue):opt.defaultText;for(var statesText={normal:baseText},i$1=0;i$1<SPECIAL_STATES.length;i$1++){var stateName=SPECIAL_STATES[i$1],stateModel=stateModels[stateName];statesText[stateName]=retrieve2(labelFetcher?labelFetcher.getFormattedLabel(labelDataIndex,stateName,null,labelDimIndex,stateModel&&stateModel.get(`formatter`)):null,baseText)}return statesText}function setLabelStyle(targetEl,labelStatesModels,opt,stateSpecified){opt||=EMPTY_OBJ;for(var isSetOnText=targetEl instanceof Text_default,needsCreateText=!1,i$1=0;i$1<DISPLAY_STATES.length;i$1++){var stateModel=labelStatesModels[DISPLAY_STATES[i$1]];if(stateModel&&stateModel.getShallow(`show`)){needsCreateText=!0;break}}var textContent=isSetOnText?targetEl:targetEl.getTextContent();if(needsCreateText){isSetOnText||(textContent||(textContent=new Text_default,targetEl.setTextContent(textContent)),targetEl.stateProxy&&(textContent.stateProxy=targetEl.stateProxy));var labelStatesTexts=getLabelText(opt,labelStatesModels),normalModel=labelStatesModels.normal,showNormal=!!normalModel.getShallow(`show`),normalStyle=createTextStyle(normalModel,stateSpecified&&stateSpecified.normal,opt,!1,!isSetOnText);normalStyle.text=labelStatesTexts.normal,isSetOnText||targetEl.setTextConfig(createTextConfig(normalModel,opt,!1));for(var i$1=0;i$1<SPECIAL_STATES.length;i$1++){var stateName=SPECIAL_STATES[i$1],stateModel=labelStatesModels[stateName];if(stateModel){var stateObj=textContent.ensureState(stateName),stateShow=!!retrieve2(stateModel.getShallow(`show`),showNormal);if(stateShow!==showNormal&&(stateObj.ignore=!stateShow),stateObj.style=createTextStyle(stateModel,stateSpecified&&stateSpecified[stateName],opt,!0,!isSetOnText),stateObj.style.text=labelStatesTexts[stateName],!isSetOnText){var targetElEmphasisState=targetEl.ensureState(stateName);targetElEmphasisState.textConfig=createTextConfig(stateModel,opt,!0)}}}textContent.silent=!!normalModel.getShallow(`silent`),textContent.style.x!=null&&(normalStyle.x=textContent.style.x),textContent.style.y!=null&&(normalStyle.y=textContent.style.y),textContent.ignore=!showNormal,textContent.useStyle(normalStyle),textContent.dirty(),opt.enableTextSetter&&(labelInner(textContent).setLabelText=function(interpolatedValue){var labelStatesTexts$1=getLabelText(opt,labelStatesModels,interpolatedValue);setLabelText(textContent,labelStatesTexts$1)})}else textContent&&(textContent.ignore=!0);targetEl.dirty()}function getLabelStatesModels(itemModel,labelName){labelName||=`label`;for(var statesModels={normal:itemModel.getModel(labelName)},i$1=0;i$1<SPECIAL_STATES.length;i$1++){var stateName=SPECIAL_STATES[i$1];statesModels[stateName]=itemModel.getModel([stateName,labelName])}return statesModels}function createTextStyle(textStyleModel,specifiedTextStyle,opt,isNotNormal,isAttached){var textStyle={};return setTextStyleCommon(textStyle,textStyleModel,opt,isNotNormal,isAttached),specifiedTextStyle&&extend(textStyle,specifiedTextStyle),textStyle}function createTextConfig(textStyleModel,opt,isNotNormal){opt||={};var textConfig={},labelPosition,labelRotate=textStyleModel.getShallow(`rotate`),labelDistance=retrieve2(textStyleModel.getShallow(`distance`),isNotNormal?null:5),labelOffset=textStyleModel.getShallow(`offset`);return labelPosition=textStyleModel.getShallow(`position`)||(isNotNormal?null:`inside`),labelPosition===`outside`&&(labelPosition=opt.defaultOutsidePosition||`top`),labelPosition!=null&&(textConfig.position=labelPosition),labelOffset!=null&&(textConfig.offset=labelOffset),labelRotate!=null&&(labelRotate*=Math.PI/180,textConfig.rotation=labelRotate),labelDistance!=null&&(textConfig.distance=labelDistance),textConfig.outsideFill=textStyleModel.get(`color`)===`inherit`?opt.inheritColor||null:`auto`,opt.autoOverflowArea!=null&&(textConfig.autoOverflowArea=opt.autoOverflowArea),opt.layoutRect!=null&&(textConfig.layoutRect=opt.layoutRect),textConfig}function setTextStyleCommon(textStyle,textStyleModel,opt,isNotNormal,isAttached){opt||=EMPTY_OBJ;var ecModel=textStyleModel.ecModel,globalTextStyle=ecModel&&ecModel.option.textStyle,richItemNames=getRichItemNames(textStyleModel),richResult;if(richItemNames){richResult={};var richInheritPlainLabelOptionName=`richInheritPlainLabel`,richInheritPlainLabel=retrieve2(textStyleModel.get(richInheritPlainLabelOptionName),ecModel?ecModel.get(richInheritPlainLabelOptionName):void 0);for(var name_1 in richItemNames)if(richItemNames.hasOwnProperty(name_1)){var richTextStyle=textStyleModel.getModel([`rich`,name_1]);setTokenTextStyle(richResult[name_1]={},richTextStyle,globalTextStyle,textStyleModel,richInheritPlainLabel,opt,isNotNormal,isAttached,!1,!0)}}richResult&&(textStyle.rich=richResult);var overflow=textStyleModel.get(`overflow`);overflow&&(textStyle.overflow=overflow);var lineOverflow=textStyleModel.get(`lineOverflow`);lineOverflow&&(textStyle.lineOverflow=lineOverflow);var labelTextStyle=textStyle,minMargin=textStyleModel.get(`minMargin`);if(minMargin!=null)minMargin=isNumber(minMargin)?minMargin/2:0,labelTextStyle.margin=[minMargin,minMargin,minMargin,minMargin],labelTextStyle.__marginType=LabelMarginType.minMargin;else{var textMargin=textStyleModel.get(`textMargin`);textMargin!=null&&(labelTextStyle.margin=normalizeCssArray$1(textMargin),labelTextStyle.__marginType=LabelMarginType.textMargin)}setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,null,null,opt,isNotNormal,isAttached,!0,!1)}function getRichItemNames(textStyleModel){for(var richItemNameMap;textStyleModel&&textStyleModel!==textStyleModel.ecModel;){var rich=(textStyleModel.option||EMPTY_OBJ).rich;if(rich){richItemNameMap||={};for(var richKeys=keys(rich),i$1=0;i$1<richKeys.length;i$1++){var richKey=richKeys[i$1];richItemNameMap[richKey]=1}}textStyleModel=textStyleModel.parentModel}return richItemNameMap}var TEXT_PROPS_WITH_GLOBAL=[`fontStyle`,`fontWeight`,`fontSize`,`fontFamily`,`textShadowColor`,`textShadowBlur`,`textShadowOffsetX`,`textShadowOffsetY`],TEXT_PROPS_SELF=[`align`,`lineHeight`,`width`,`height`,`tag`,`verticalAlign`,`ellipsis`],TEXT_PROPS_BOX=[`padding`,`borderWidth`,`borderRadius`,`borderDashOffset`,`backgroundColor`,`borderColor`,`shadowColor`,`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`];function setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,plainTextModel,richInheritPlainLabel,opt,isNotNormal,isAttached,isBlock,inRich){globalTextStyle=!isNotNormal&&globalTextStyle||EMPTY_OBJ;var inheritColor=opt&&opt.inheritColor,fillColor=textStyleModel.getShallow(`color`),strokeColor=textStyleModel.getShallow(`textBorderColor`),opacity=retrieve2(textStyleModel.getShallow(`opacity`),globalTextStyle.opacity);(fillColor===`inherit`||fillColor===`auto`)&&(fillColor=inheritColor||null),(strokeColor===`inherit`||strokeColor===`auto`)&&(strokeColor=inheritColor||null),isAttached||(fillColor||=globalTextStyle.color,strokeColor||=globalTextStyle.textBorderColor),fillColor!=null&&(textStyle.fill=fillColor),strokeColor!=null&&(textStyle.stroke=strokeColor);var textBorderWidth=retrieve2(textStyleModel.getShallow(`textBorderWidth`),globalTextStyle.textBorderWidth);textBorderWidth!=null&&(textStyle.lineWidth=textBorderWidth);var textBorderType=retrieve2(textStyleModel.getShallow(`textBorderType`),globalTextStyle.textBorderType);textBorderType!=null&&(textStyle.lineDash=textBorderType);var textBorderDashOffset=retrieve2(textStyleModel.getShallow(`textBorderDashOffset`),globalTextStyle.textBorderDashOffset);textBorderDashOffset!=null&&(textStyle.lineDashOffset=textBorderDashOffset),!isNotNormal&&opacity==null&&!inRich&&(opacity=opt&&opt.defaultOpacity),opacity!=null&&(textStyle.opacity=opacity),!isNotNormal&&!isAttached&&textStyle.fill==null&&opt.inheritColor&&(textStyle.fill=opt.inheritColor);for(var i$1=0;i$1<TEXT_PROPS_WITH_GLOBAL.length;i$1++){var key$1=TEXT_PROPS_WITH_GLOBAL[i$1],val=richInheritPlainLabel!==!1&&plainTextModel?retrieve3(textStyleModel.getShallow(key$1),plainTextModel.getShallow(key$1),globalTextStyle[key$1]):retrieve2(textStyleModel.getShallow(key$1),globalTextStyle[key$1]);val!=null&&(textStyle[key$1]=val)}for(var i$1=0;i$1<TEXT_PROPS_SELF.length;i$1++){var key$1=TEXT_PROPS_SELF[i$1],val=textStyleModel.getShallow(key$1);val!=null&&(textStyle[key$1]=val)}if(textStyle.verticalAlign==null){var baseline=textStyleModel.getShallow(`baseline`);baseline!=null&&(textStyle.verticalAlign=baseline)}if(!isBlock||!opt.disableBox){for(var i$1=0;i$1<TEXT_PROPS_BOX.length;i$1++){var key$1=TEXT_PROPS_BOX[i$1],val=textStyleModel.getShallow(key$1);val!=null&&(textStyle[key$1]=val)}var borderType=textStyleModel.getShallow(`borderType`);borderType!=null&&(textStyle.borderDash=borderType),(textStyle.backgroundColor===`auto`||textStyle.backgroundColor===`inherit`)&&inheritColor&&(textStyle.backgroundColor=inheritColor),(textStyle.borderColor===`auto`||textStyle.borderColor===`inherit`)&&inheritColor&&(textStyle.borderColor=inheritColor)}}function getFont(opt,ecModel){var gTextStyleModel=ecModel&&ecModel.getModel(`textStyle`);return trim([opt.fontStyle||gTextStyleModel&&gTextStyleModel.getShallow(`fontStyle`)||``,opt.fontWeight||gTextStyleModel&&gTextStyleModel.getShallow(`fontWeight`)||``,(opt.fontSize||gTextStyleModel&&gTextStyleModel.getShallow(`fontSize`)||12)+`px`,opt.fontFamily||gTextStyleModel&&gTextStyleModel.getShallow(`fontFamily`)||`sans-serif`].join(` `))}var labelInner=makeInner();function setLabelValueAnimation(label,labelStatesModels,value,getDefaultText){if(label){var obj=labelInner(label);obj.prevValue=obj.value,obj.value=value;var normalLabelModel=labelStatesModels.normal;obj.valueAnimation=normalLabelModel.get(`valueAnimation`),obj.valueAnimation&&(obj.precision=normalLabelModel.get(`precision`),obj.defaultInterpolatedText=getDefaultText,obj.statesModels=labelStatesModels)}}var LabelMarginType={minMargin:1,textMargin:2},PATH_COLOR=[`textStyle`,`color`],textStyleParams=[`fontStyle`,`fontWeight`,`fontSize`,`fontFamily`,`padding`,`lineHeight`,`rich`,`width`,`height`,`overflow`],tmpText=new Text_default,textStyle_default=function(){function TextStyleMixin$1(){}return TextStyleMixin$1.prototype.getTextColor=function(isEmphasis){var ecModel=this.ecModel;return this.getShallow(`color`)||(!isEmphasis&&ecModel?ecModel.get(PATH_COLOR):null)},TextStyleMixin$1.prototype.getFont=function(){return getFont({fontStyle:this.getShallow(`fontStyle`),fontWeight:this.getShallow(`fontWeight`),fontSize:this.getShallow(`fontSize`),fontFamily:this.getShallow(`fontFamily`)},this.ecModel)},TextStyleMixin$1.prototype.getTextRect=function(text){for(var style={text,verticalAlign:this.getShallow(`verticalAlign`)||this.getShallow(`baseline`)},i$1=0;i$1<textStyleParams.length;i$1++)style[textStyleParams[i$1]]=this.getShallow(textStyleParams[i$1]);return tmpText.useStyle(style),tmpText.update(),tmpText.getBoundingRect()},TextStyleMixin$1}(),LINE_STYLE_KEY_MAP=[[`lineWidth`,`width`],[`stroke`,`color`],[`opacity`],[`shadowBlur`],[`shadowOffsetX`],[`shadowOffsetY`],[`shadowColor`],[`lineDash`,`type`],[`lineDashOffset`,`dashOffset`],[`lineCap`,`cap`],[`lineJoin`,`join`],[`miterLimit`]],getLineStyle=makeStyleMapper(LINE_STYLE_KEY_MAP),LineStyleMixin=function(){function LineStyleMixin$1(){}return LineStyleMixin$1.prototype.getLineStyle=function(excludes){return getLineStyle(this,excludes)},LineStyleMixin$1}(),ITEM_STYLE_KEY_MAP=[[`fill`,`color`],[`stroke`,`borderColor`],[`lineWidth`,`borderWidth`],[`opacity`],[`shadowBlur`],[`shadowOffsetX`],[`shadowOffsetY`],[`shadowColor`],[`lineDash`,`borderType`],[`lineDashOffset`,`borderDashOffset`],[`lineCap`,`borderCap`],[`lineJoin`,`borderJoin`],[`miterLimit`,`borderMiterLimit`]],getItemStyle=makeStyleMapper(ITEM_STYLE_KEY_MAP),ItemStyleMixin=function(){function ItemStyleMixin$1(){}return ItemStyleMixin$1.prototype.getItemStyle=function(excludes,includes){return getItemStyle(this,excludes,includes)},ItemStyleMixin$1}(),Model=function(){function Model$1(option,parentModel,ecModel){this.parentModel=parentModel,this.ecModel=ecModel,this.option=option}return Model$1.prototype.init=function(option,parentModel,ecModel){},Model$1.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0)},Model$1.prototype.get=function(path$1,ignoreParent){return path$1==null?this.option:this._doGet(this.parsePath(path$1),!ignoreParent&&this.parentModel)},Model$1.prototype.getShallow=function(key$1,ignoreParent){var option=this.option,val=option==null?option:option[key$1];if(val==null&&!ignoreParent){var parentModel=this.parentModel;parentModel&&(val=parentModel.getShallow(key$1))}return val},Model$1.prototype.getModel=function(path$1,parentModel){var hasPath=path$1!=null,pathFinal=hasPath?this.parsePath(path$1):null,obj=hasPath?this._doGet(pathFinal):this.option;return parentModel||=this.parentModel&&this.parentModel.getModel(this.resolveParentPath(pathFinal)),new Model$1(obj,parentModel,this.ecModel)},Model$1.prototype.isEmpty=function(){return this.option==null},Model$1.prototype.restoreData=function(){},Model$1.prototype.clone=function(){var Ctor=this.constructor;return new Ctor(clone(this.option))},Model$1.prototype.parsePath=function(path$1){return typeof path$1==`string`?path$1.split(`.`):path$1},Model$1.prototype.resolveParentPath=function(path$1){return path$1},Model$1.prototype.isAnimationEnabled=function(){if(!env_default.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},Model$1.prototype._doGet=function(pathArr,parentModel){var obj=this.option;if(!pathArr)return obj;for(var i$1=0;i$1<pathArr.length&&!(pathArr[i$1]&&(obj=obj&&typeof obj==`object`?obj[pathArr[i$1]]:null,obj==null));i$1++);return obj==null&&parentModel&&(obj=parentModel._doGet(this.resolveParentPath(pathArr),parentModel.parentModel)),obj},Model$1}();enableClassExtend(Model),enableClassCheck(Model),mixin(Model,LineStyleMixin),mixin(Model,ItemStyleMixin),mixin(Model,AreaStyleMixin),mixin(Model,textStyle_default);var Model_default=Model,base=Math.round(Math.random()*10);function getUID(type){return[type||``,base++].join(`_`)}function enableSubTypeDefaulter(target){var subTypeDefaulters={};target.registerSubTypeDefaulter=function(componentType,defaulter){var componentTypeInfo=parseClassType(componentType);subTypeDefaulters[componentTypeInfo.main]=defaulter},target.determineSubType=function(componentType,option){var type=option.type;if(!type){var componentTypeMain=parseClassType(componentType).main;target.hasSubTypes(componentType)&&subTypeDefaulters[componentTypeMain]&&(type=subTypeDefaulters[componentTypeMain](option))}return type}}function enableTopologicalTravel(entity,dependencyGetter){entity.topologicalTravel=function(targetNameList,fullNameList,callback,context$1){if(!targetNameList.length)return;var result=makeDepndencyGraph(fullNameList),graph=result.graph,noEntryList=result.noEntryList,targetNameSet={};for(each(targetNameList,function(name){targetNameSet[name]=!0});noEntryList.length;){var currComponentType=noEntryList.pop(),currVertex=graph[currComponentType],isInTargetNameSet=!!targetNameSet[currComponentType];isInTargetNameSet&&(callback.call(context$1,currComponentType,currVertex.originalDeps.slice()),delete targetNameSet[currComponentType]),each(currVertex.successor,isInTargetNameSet?removeEdgeAndAdd:removeEdge)}each(targetNameSet,function(){throw Error(``)});function removeEdge(succComponentType){graph[succComponentType].entryCount--,graph[succComponentType].entryCount===0&&noEntryList.push(succComponentType)}function removeEdgeAndAdd(succComponentType){targetNameSet[succComponentType]=!0,removeEdge(succComponentType)}};function makeDepndencyGraph(fullNameList){var graph={},noEntryList=[];return each(fullNameList,function(name){var thisItem=createDependencyGraphItem(graph,name),originalDeps=thisItem.originalDeps=dependencyGetter(name),availableDeps=getAvailableDependencies(originalDeps,fullNameList);thisItem.entryCount=availableDeps.length,thisItem.entryCount===0&&noEntryList.push(name),each(availableDeps,function(dependentName){indexOf(thisItem.predecessor,dependentName)<0&&thisItem.predecessor.push(dependentName);var thatItem=createDependencyGraphItem(graph,dependentName);indexOf(thatItem.successor,dependentName)<0&&thatItem.successor.push(name)})}),{graph,noEntryList}}function createDependencyGraphItem(graph,name){return graph[name]||(graph[name]={predecessor:[],successor:[]}),graph[name]}function getAvailableDependencies(originalDeps,fullNameList){var availableDeps=[];return each(originalDeps,function(dep){indexOf(fullNameList,dep)>=0&&availableDeps.push(dep)}),availableDeps}}function inheritDefaultOption(superOption,subOption){return merge(merge({},superOption,!0),subOption,!0)}var langEN_default={time:{month:[`January`,`February`,`March`,`April`,`May`,`June`,`July`,`August`,`September`,`October`,`November`,`December`],monthAbbr:[`Jan`,`Feb`,`Mar`,`Apr`,`May`,`Jun`,`Jul`,`Aug`,`Sep`,`Oct`,`Nov`,`Dec`],dayOfWeek:[`Sunday`,`Monday`,`Tuesday`,`Wednesday`,`Thursday`,`Friday`,`Saturday`],dayOfWeekAbbr:[`Sun`,`Mon`,`Tue`,`Wed`,`Thu`,`Fri`,`Sat`]},legend:{selector:{all:`All`,inverse:`Inv`}},toolbox:{brush:{title:{rect:`Box Select`,polygon:`Lasso Select`,lineX:`Horizontally Select`,lineY:`Vertically Select`,keep:`Keep Selections`,clear:`Clear Selections`}},dataView:{title:`Data View`,lang:[`Data View`,`Close`,`Refresh`]},dataZoom:{title:{zoom:`Zoom`,back:`Zoom Reset`}},magicType:{title:{line:`Switch to Line Chart`,bar:`Switch to Bar Chart`,stack:`Stack`,tiled:`Tile`}},restore:{title:`Restore`},saveAsImage:{title:`Save as Image`,lang:[`Right Click to Save Image`]}},series:{typeNames:{pie:`Pie chart`,bar:`Bar chart`,line:`Line chart`,scatter:`Scatter plot`,effectScatter:`Ripple scatter plot`,radar:`Radar chart`,tree:`Tree`,treemap:`Treemap`,boxplot:`Boxplot`,candlestick:`Candlestick`,k:`K line chart`,heatmap:`Heat map`,map:`Map`,parallel:`Parallel coordinate map`,lines:`Line graph`,graph:`Relationship graph`,sankey:`Sankey diagram`,funnel:`Funnel chart`,gauge:`Gauge`,pictorialBar:`Pictorial bar`,themeRiver:`Theme River Map`,sunburst:`Sunburst`,custom:`Custom chart`,chart:`Chart`}},aria:{general:{withTitle:`This is a chart about "{title}"`,withoutTitle:`This is a chart`},series:{single:{prefix:``,withName:` with type {seriesType} named {seriesName}.`,withoutName:` with type {seriesType}.`},multiple:{prefix:`. It consists of {seriesCount} series count.`,withName:` The {seriesId} series is a {seriesType} representing {seriesName}.`,withoutName:` The {seriesId} series is a {seriesType}.`,separator:{middle:``,end:``}}},data:{allData:`The data is as follows: `,partialData:`The first {displayCnt} items are: `,withName:`the data for {name} is {value}`,withoutName:`{value}`,separator:{middle:`, `,end:`. `}}}},langZH_default={time:{month:[``,``,``,``,``,``,``,``,``,``,``,``],monthAbbr:[`1`,`2`,`3`,`4`,`5`,`6`,`7`,`8`,`9`,`10`,`11`,`12`],dayOfWeek:[``,``,``,``,``,``,``],dayOfWeekAbbr:[``,``,``,``,``,``,``]},legend:{selector:{all:``,inverse:``}},toolbox:{brush:{title:{rect:``,polygon:``,lineX:``,lineY:``,keep:``,clear:``}},dataView:{title:``,lang:[``,``,``]},dataZoom:{title:{zoom:``,back:``}},magicType:{title:{line:``,bar:``,stack:``,tiled:``}},restore:{title:``},saveAsImage:{title:``,lang:[``]}},series:{typeNames:{pie:``,bar:``,line:``,scatter:``,effectScatter:``,radar:``,tree:``,treemap:``,boxplot:``,candlestick:`K`,k:`K`,heatmap:``,map:``,parallel:``,lines:``,graph:``,sankey:``,funnel:``,gauge:``,pictorialBar:``,themeRiver:``,sunburst:``,custom:``,chart:``}},aria:{general:{withTitle:`{title}`,withoutTitle:``},series:{single:{prefix:``,withName:`{seriesType}{seriesName}`,withoutName:`{seriesType}`},multiple:{prefix:`{seriesCount}`,withName:`{seriesId}{seriesName}{seriesType}`,withoutName:`{seriesId}{seriesType}`,separator:{middle:``,end:``}}},data:{allData:``,partialData:`{displayCnt}`,withName:`{name}{value}`,withoutName:`{value}`,separator:{middle:``,end:``}}}},LOCALE_ZH=`ZH`,LOCALE_EN=`EN`,DEFAULT_LOCALE=LOCALE_EN,localeStorage={},localeModels={},SYSTEM_LANG=env_default.domSupported?function(){return(document.documentElement.lang||navigator.language||navigator.browserLanguage||DEFAULT_LOCALE).toUpperCase().indexOf(LOCALE_ZH)>-1?LOCALE_ZH:DEFAULT_LOCALE}():DEFAULT_LOCALE;function registerLocale(locale,localeObj){locale=locale.toUpperCase(),localeModels[locale]=new Model_default(localeObj),localeStorage[locale]=localeObj}function createLocaleObject(locale){if(isString(locale)){var localeObj=localeStorage[locale.toUpperCase()]||{};return locale===LOCALE_ZH||locale===LOCALE_EN?clone(localeObj):merge(clone(localeObj),clone(localeStorage[DEFAULT_LOCALE]),!1)}else return merge(clone(locale),clone(localeStorage[DEFAULT_LOCALE]),!1)}function getLocaleModel(lang){return localeModels[lang]}function getDefaultLocaleModel(){return localeModels[DEFAULT_LOCALE]}registerLocale(LOCALE_EN,langEN_default),registerLocale(LOCALE_ZH,langZH_default);var _impl$1=null;function getScaleBreakHelper(){return _impl$1}var ONE_SECOND=1e3,ONE_MINUTE=ONE_SECOND*60,ONE_HOUR=ONE_MINUTE*60,ONE_DAY=ONE_HOUR*24,ONE_YEAR=ONE_DAY*365,primaryTimeUnitFormatterMatchers={year:/({yyyy}|{yy})/,month:/({MMMM}|{MMM}|{MM}|{M})/,day:/({dd}|{d})/,hour:/({HH}|{H}|{hh}|{h})/,minute:/({mm}|{m})/,second:/({ss}|{s})/,millisecond:/({SSS}|{S})/},defaultFormatterSeed={year:`{yyyy}`,month:`{MMM}`,day:`{d}`,hour:`{HH}:{mm}`,minute:`{HH}:{mm}`,second:`{HH}:{mm}:{ss}`,millisecond:`{HH}:{mm}:{ss} {SSS}`},defaultFullFormatter=`{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}`,fullDayFormatter=`{yyyy}-{MM}-{dd}`,fullLeveledFormatter={year:`{yyyy}`,month:`{yyyy}-{MM}`,day:fullDayFormatter,hour:fullDayFormatter+` `+defaultFormatterSeed.hour,minute:fullDayFormatter+` `+defaultFormatterSeed.minute,second:fullDayFormatter+` `+defaultFormatterSeed.second,millisecond:defaultFullFormatter},primaryTimeUnits=[`year`,`month`,`day`,`hour`,`minute`,`second`,`millisecond`],timeUnits=[`year`,`half-year`,`quarter`,`month`,`week`,`half-week`,`day`,`half-day`,`quarter-day`,`hour`,`minute`,`second`,`millisecond`];function parseTimeAxisLabelFormatter(formatter){return!isString(formatter)&&!isFunction(formatter)?parseTimeAxisLabelFormatterDictionary(formatter):formatter}function parseTimeAxisLabelFormatterDictionary(dictOption){dictOption||={};var dict={},canAddHighlight=!0;return each(primaryTimeUnits,function(lowestUnit){canAddHighlight&&=dictOption[lowestUnit]==null}),each(primaryTimeUnits,function(lowestUnit,lowestUnitIdx){var upperDictOption=dictOption[lowestUnit];dict[lowestUnit]={};for(var lowerTpl=null,upperUnitIdx=lowestUnitIdx;upperUnitIdx>=0;upperUnitIdx--){var upperUnit=primaryTimeUnits[upperUnitIdx],upperDictItemOption=isObject(upperDictOption)&&!isArray(upperDictOption)?upperDictOption[upperUnit]:upperDictOption,tplArr=void 0;isArray(upperDictItemOption)?(tplArr=upperDictItemOption.slice(),lowerTpl=tplArr[0]||``):isString(upperDictItemOption)?(lowerTpl=upperDictItemOption,tplArr=[lowerTpl]):(lowerTpl==null?lowerTpl=defaultFormatterSeed[lowestUnit]:primaryTimeUnitFormatterMatchers[upperUnit].test(lowerTpl)||(lowerTpl=dict[upperUnit][upperUnit][0]+` `+lowerTpl),tplArr=[lowerTpl],canAddHighlight&&(tplArr[1]=`{primary|`+lowerTpl+`}`)),dict[lowestUnit][upperUnit]=tplArr}}),dict}function pad(str,len$1){return str+=``,`0000`.substr(0,len$1-str.length)+str}function getPrimaryTimeUnit(timeUnit){switch(timeUnit){case`half-year`:case`quarter`:return`month`;case`week`:case`half-week`:return`day`;case`half-day`:case`quarter-day`:return`hour`;default:return timeUnit}}function isPrimaryTimeUnit(timeUnit){return timeUnit===getPrimaryTimeUnit(timeUnit)}function getDefaultFormatPrecisionOfInterval(timeUnit){switch(timeUnit){case`year`:case`month`:return`day`;case`millisecond`:return`millisecond`;default:return`second`}}function format(time,template,isUTC,lang){var date=parseDate(time),y$1=date[fullYearGetterName(isUTC)](),M$1=date[monthGetterName(isUTC)]()+1,q$1=Math.floor((M$1-1)/3)+1,d$1=date[dateGetterName(isUTC)](),e$2=date[`get`+(isUTC?`UTC`:``)+`Day`](),H$1=date[hoursGetterName(isUTC)](),h$2=(H$1-1)%12+1,m$2=date[minutesGetterName(isUTC)](),s$1=date[secondsGetterName(isUTC)](),S$1=date[millisecondsGetterName(isUTC)](),a$1=H$1>=12?`pm`:`am`,A=a$1.toUpperCase(),timeModel=(lang instanceof Model_default?lang:getLocaleModel(lang||SYSTEM_LANG)||getDefaultLocaleModel()).getModel(`time`),month=timeModel.get(`month`),monthAbbr=timeModel.get(`monthAbbr`),dayOfWeek=timeModel.get(`dayOfWeek`),dayOfWeekAbbr=timeModel.get(`dayOfWeekAbbr`);return(template||``).replace(/{a}/g,a$1+``).replace(/{A}/g,A+``).replace(/{yyyy}/g,y$1+``).replace(/{yy}/g,pad(y$1%100+``,2)).replace(/{Q}/g,q$1+``).replace(/{MMMM}/g,month[M$1-1]).replace(/{MMM}/g,monthAbbr[M$1-1]).replace(/{MM}/g,pad(M$1,2)).replace(/{M}/g,M$1+``).replace(/{dd}/g,pad(d$1,2)).replace(/{d}/g,d$1+``).replace(/{eeee}/g,dayOfWeek[e$2]).replace(/{ee}/g,dayOfWeekAbbr[e$2]).replace(/{e}/g,e$2+``).replace(/{HH}/g,pad(H$1,2)).replace(/{H}/g,H$1+``).replace(/{hh}/g,pad(h$2+``,2)).replace(/{h}/g,h$2+``).replace(/{mm}/g,pad(m$2,2)).replace(/{m}/g,m$2+``).replace(/{ss}/g,pad(s$1,2)).replace(/{s}/g,s$1+``).replace(/{SSS}/g,pad(S$1,3)).replace(/{S}/g,S$1+``)}function leveledFormat(tick,idx,formatter,lang,isUTC){var template=null;if(isString(formatter))template=formatter;else if(isFunction(formatter)){var extra={time:tick.time,level:tick.time.level},scaleBreakHelper=getScaleBreakHelper();scaleBreakHelper&&scaleBreakHelper.makeAxisLabelFormatterParamBreak(extra,tick.break),template=formatter(tick.value,idx,extra)}else{var tickTime=tick.time;if(tickTime){var leveledTplArr=formatter[tickTime.lowerTimeUnit][tickTime.upperTimeUnit];template=leveledTplArr[Math.min(tickTime.level,leveledTplArr.length-1)]||``}else{var unit=getUnitFromValue(tick.value,isUTC);template=formatter[unit][unit][0]}}return format(new Date(tick.value),template,isUTC,lang)}function getUnitFromValue(value,isUTC){var date=parseDate(value),M$1=date[monthGetterName(isUTC)]()+1,d$1=date[dateGetterName(isUTC)](),h$2=date[hoursGetterName(isUTC)](),m$2=date[minutesGetterName(isUTC)](),s$1=date[secondsGetterName(isUTC)](),isSecond=date[millisecondsGetterName(isUTC)]()===0,isMinute=isSecond&&s$1===0,isHour=isMinute&&m$2===0,isDay=isHour&&h$2===0,isMonth=isDay&&d$1===1;return isMonth&&M$1===1?`year`:isMonth?`month`:isDay?`day`:isHour?`hour`:isMinute?`minute`:isSecond?`second`:`millisecond`}function roundTime(date,timeUnit,isUTC){switch(timeUnit){case`year`:date[monthSetterName(isUTC)](0);case`month`:date[dateSetterName(isUTC)](1);case`day`:date[hoursSetterName(isUTC)](0);case`hour`:date[minutesSetterName(isUTC)](0);case`minute`:date[secondsSetterName(isUTC)](0);case`second`:date[millisecondsSetterName(isUTC)](0)}return date}function fullYearGetterName(isUTC){return isUTC?`getUTCFullYear`:`getFullYear`}function monthGetterName(isUTC){return isUTC?`getUTCMonth`:`getMonth`}function dateGetterName(isUTC){return isUTC?`getUTCDate`:`getDate`}function hoursGetterName(isUTC){return isUTC?`getUTCHours`:`getHours`}function minutesGetterName(isUTC){return isUTC?`getUTCMinutes`:`getMinutes`}function secondsGetterName(isUTC){return isUTC?`getUTCSeconds`:`getSeconds`}function millisecondsGetterName(isUTC){return isUTC?`getUTCMilliseconds`:`getMilliseconds`}function fullYearSetterName(isUTC){return isUTC?`setUTCFullYear`:`setFullYear`}function monthSetterName(isUTC){return isUTC?`setUTCMonth`:`setMonth`}function dateSetterName(isUTC){return isUTC?`setUTCDate`:`setDate`}function hoursSetterName(isUTC){return isUTC?`setUTCHours`:`setHours`}function minutesSetterName(isUTC){return isUTC?`setUTCMinutes`:`setMinutes`}function secondsSetterName(isUTC){return isUTC?`setUTCSeconds`:`setSeconds`}function millisecondsSetterName(isUTC){return isUTC?`setUTCMilliseconds`:`setMilliseconds`}function addCommas(x$1){if(!isNumeric(x$1))return isString(x$1)?x$1:`-`;var parts=(x$1+``).split(`.`);return parts[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,`$1,`)+(parts.length>1?`.`+parts[1]:``)}function toCamelCase(str,upperCaseFirst){return str=(str||``).toLowerCase().replace(/-(.)/g,function(match,group1){return group1.toUpperCase()}),upperCaseFirst&&str&&(str=str.charAt(0).toUpperCase()+str.slice(1)),str}var normalizeCssArray=normalizeCssArray$1;function makeValueReadable(value,valueType,useUTC){var USER_READABLE_DEFUALT_TIME_PATTERN=`{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}`;function stringToUserReadable(str){return str&&trim(str)?str:`-`}function isNumberUserReadable(num){return!!(num!=null&&!isNaN(num)&&isFinite(num))}var isTypeTime=valueType===`time`,isValueDate=value instanceof Date;if(isTypeTime||isValueDate){var date=isTypeTime?parseDate(value):value;if(isNaN(+date)){if(isValueDate)return`-`}else return format(date,USER_READABLE_DEFUALT_TIME_PATTERN,useUTC)}if(valueType===`ordinal`)return isStringSafe(value)?stringToUserReadable(value):isNumber(value)&&isNumberUserReadable(value)?value+``:`-`;var numericResult=numericToNumber(value);return isNumberUserReadable(numericResult)?addCommas(numericResult):isStringSafe(value)?stringToUserReadable(value):typeof value==`boolean`?value+``:`-`}var TPL_VAR_ALIAS=[`a`,`b`,`c`,`d`,`e`,`f`,`g`],wrapVar=function(varName,seriesIdx){return`{`+varName+(seriesIdx??``)+`}`};function formatTpl(tpl,paramsList,encode){isArray(paramsList)||(paramsList=[paramsList]);var seriesLen=paramsList.length;if(!seriesLen)return``;for(var $vars=paramsList[0].$vars||[],i$1=0;i$1<$vars.length;i$1++){var alias=TPL_VAR_ALIAS[i$1];tpl=tpl.replace(wrapVar(alias),wrapVar(alias,0))}for(var seriesIdx=0;seriesIdx<seriesLen;seriesIdx++)for(var k$1=0;k$1<$vars.length;k$1++){var val=paramsList[seriesIdx][$vars[k$1]];tpl=tpl.replace(wrapVar(TPL_VAR_ALIAS[k$1],seriesIdx),encode?encodeHTML(val):val)}return tpl}function getTooltipMarker(inOpt,extraCssText){var opt=isString(inOpt)?{color:inOpt,extraCssText}:inOpt||{},color$2=opt.color,type=opt.type;extraCssText=opt.extraCssText;var renderMode=opt.renderMode||`html`;if(!color$2)return``;if(renderMode===`html`)return type===`subItem`?`<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:`+encodeHTML(color$2)+`;`+(extraCssText||``)+`"></span>`:`<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:`+encodeHTML(color$2)+`;`+(extraCssText||``)+`"></span>`;var markerId=opt.markerId||`markerX`;return{renderMode,content:`{`+markerId+`|}  `,style:type===`subItem`?{width:4,height:4,borderRadius:2,backgroundColor:color$2}:{width:10,height:10,borderRadius:5,backgroundColor:color$2}}}function convertToColorString(color$2,defaultColor){return defaultColor||=`transparent`,isString(color$2)?color$2:isObject(color$2)&&color$2.colorStops&&(color$2.colorStops[0]||{}).color||defaultColor}function windowOpen(link,target){if(target===`_blank`||target===`blank`){var blank=window.open();blank.opener=null,blank.location.href=link}else window.open(link,target)}var nonSeriesBoxCoordSysCreators={},normalCoordSysCreators={},CoordinateSystemManager=function(){function CoordinateSystemManager$1(){this._normalMasterList=[],this._nonSeriesBoxMasterList=[]}return CoordinateSystemManager$1.prototype.create=function(ecModel,api){this._nonSeriesBoxMasterList=dealCreate(nonSeriesBoxCoordSysCreators,!0),this._normalMasterList=dealCreate(normalCoordSysCreators,!1);function dealCreate(creatorMap,canBeNonSeriesBox){var coordinateSystems=[];return each(creatorMap,function(creator,type){var list=creator.create(ecModel,api);coordinateSystems=coordinateSystems.concat(list||[])}),coordinateSystems}},CoordinateSystemManager$1.prototype.update=function(ecModel,api){each(this._normalMasterList,function(coordSys){coordSys.update&&coordSys.update(ecModel,api)})},CoordinateSystemManager$1.prototype.getCoordinateSystems=function(){return this._normalMasterList.concat(this._nonSeriesBoxMasterList)},CoordinateSystemManager$1.register=function(type,creator){if(type===`matrix`||type===`calendar`){nonSeriesBoxCoordSysCreators[type]=creator;return}normalCoordSysCreators[type]=creator},CoordinateSystemManager$1.get=function(type){return normalCoordSysCreators[type]||nonSeriesBoxCoordSysCreators[type]},CoordinateSystemManager$1}();function canBeNonSeriesBoxCoordSys(coordSysType){return!!nonSeriesBoxCoordSysCreators[coordSysType]}var BoxCoordinateSystemCoordFrom={coord:1,coord2:2},coordSysUseMap=createHashMap();function getCoordForBoxCoordSys(model){var coord=model.getShallow(`coord`,!0),from=BoxCoordinateSystemCoordFrom.coord;if(coord==null){var store=coordSysUseMap.get(model.type);store&&store.getCoord2&&(from=BoxCoordinateSystemCoordFrom.coord2,coord=store.getCoord2(model))}return{coord,from}}var CoordinateSystemUsageKind={none:0,dataCoordSys:1,boxCoordSys:2};function decideCoordSysUsageKind(model,printError){var coordSysType=model.getShallow(`coordinateSystem`),coordSysUsageOption=model.getShallow(`coordinateSystemUsage`,!0),kind=CoordinateSystemUsageKind.none;if(coordSysType){var isSeries$1=model.mainType===`series`;coordSysUsageOption??=isSeries$1?`data`:`box`,coordSysUsageOption===`data`?(kind=CoordinateSystemUsageKind.dataCoordSys,isSeries$1||(kind=CoordinateSystemUsageKind.none)):coordSysUsageOption===`box`&&(kind=CoordinateSystemUsageKind.boxCoordSys,!isSeries$1&&!canBeNonSeriesBoxCoordSys(coordSysType)&&(kind=CoordinateSystemUsageKind.none))}return{coordSysType,kind}}function injectCoordSysByOption(opt){var targetModel=opt.targetModel,coordSysType=opt.coordSysType,coordSysProvider=opt.coordSysProvider,isDefaultDataCoordSys=opt.isDefaultDataCoordSys;opt.allowNotFound;var _a$1=decideCoordSysUsageKind(targetModel,!0),kind=_a$1.kind,declaredType=_a$1.coordSysType;if(isDefaultDataCoordSys&&kind!==CoordinateSystemUsageKind.dataCoordSys&&(kind=CoordinateSystemUsageKind.dataCoordSys,declaredType=coordSysType),kind===CoordinateSystemUsageKind.none||declaredType!==coordSysType)return!1;var coordSys=coordSysProvider(coordSysType,targetModel);return coordSys?(kind===CoordinateSystemUsageKind.dataCoordSys?targetModel.coordinateSystem=coordSys:targetModel.boxCoordinateSystem=coordSys,!0):!1}var CoordinateSystem_default=CoordinateSystemManager,each$4=each,LOCATION_PARAMS=[`left`,`right`,`top`,`bottom`,`width`,`height`],HV_NAMES=[[`width`,`left`,`right`],[`height`,`top`,`bottom`]];function boxLayout(orient,group,gap,maxWidth,maxHeight){var x$1=0,y$1=0;maxWidth??=1/0,maxHeight??=1/0;var currentLineMaxSize=0;group.eachChild(function(child,idx){var rect=child.getBoundingRect(),nextChild=group.childAt(idx+1),nextChildRect=nextChild&&nextChild.getBoundingRect(),nextX,nextY;if(orient===`horizontal`){var moveX=rect.width+(nextChildRect?-nextChildRect.x+rect.x:0);nextX=x$1+moveX,nextX>maxWidth||child.newline?(x$1=0,nextX=moveX,y$1+=currentLineMaxSize+gap,currentLineMaxSize=rect.height):currentLineMaxSize=Math.max(currentLineMaxSize,rect.height)}else{var moveY=rect.height+(nextChildRect?-nextChildRect.y+rect.y:0);nextY=y$1+moveY,nextY>maxHeight||child.newline?(x$1+=currentLineMaxSize+gap,y$1=0,nextY=moveY,currentLineMaxSize=rect.width):currentLineMaxSize=Math.max(currentLineMaxSize,rect.width)}child.newline||(child.x=x$1,child.y=y$1,child.markRedraw(),orient===`horizontal`?x$1=nextX+gap:y$1=nextY+gap)})}var vbox=curry(boxLayout,`vertical`),hbox=curry(boxLayout,`horizontal`);function getBoxLayoutParams(boxLayoutModel,ignoreParent){return{left:boxLayoutModel.getShallow(`left`,ignoreParent),top:boxLayoutModel.getShallow(`top`,ignoreParent),right:boxLayoutModel.getShallow(`right`,ignoreParent),bottom:boxLayoutModel.getShallow(`bottom`,ignoreParent),width:boxLayoutModel.getShallow(`width`,ignoreParent),height:boxLayoutModel.getShallow(`height`,ignoreParent)}}function getLayoutRect(positionInfo,containerRect,margin){margin=normalizeCssArray(margin||0);var containerWidth=containerRect.width,containerHeight=containerRect.height,left=parsePercent(positionInfo.left,containerWidth),top=parsePercent(positionInfo.top,containerHeight),right=parsePercent(positionInfo.right,containerWidth),bottom=parsePercent(positionInfo.bottom,containerHeight),width=parsePercent(positionInfo.width,containerWidth),height=parsePercent(positionInfo.height,containerHeight),verticalMargin=margin[2]+margin[0],horizontalMargin=margin[1]+margin[3],aspect=positionInfo.aspect;switch(isNaN(width)&&(width=containerWidth-right-horizontalMargin-left),isNaN(height)&&(height=containerHeight-bottom-verticalMargin-top),aspect!=null&&(isNaN(width)&&isNaN(height)&&(aspect>containerWidth/containerHeight?width=containerWidth*.8:height=containerHeight*.8),isNaN(width)&&(width=aspect*height),isNaN(height)&&(height=width/aspect)),isNaN(left)&&(left=containerWidth-right-width-horizontalMargin),isNaN(top)&&(top=containerHeight-bottom-height-verticalMargin),positionInfo.left||positionInfo.right){case`center`:left=containerWidth/2-width/2-margin[3];break;case`right`:left=containerWidth-width-horizontalMargin;break}switch(positionInfo.top||positionInfo.bottom){case`middle`:case`center`:top=containerHeight/2-height/2-margin[0];break;case`bottom`:top=containerHeight-height-verticalMargin;break}left||=0,top||=0,isNaN(width)&&(width=containerWidth-horizontalMargin-left-(right||0)),isNaN(height)&&(height=containerHeight-verticalMargin-top-(bottom||0));var rect=new BoundingRect_default((containerRect.x||0)+left+margin[3],(containerRect.y||0)+top+margin[0],width,height);return rect.margin=margin,rect}var BoxLayoutReferenceType={rect:1,point:2};function createBoxLayoutReference(model,api,opt){var refContainer,refPoint,layoutRefType,boxCoordSys=model.boxCoordinateSystem,boxCoordFrom;if(boxCoordSys){var _a$1=getCoordForBoxCoordSys(model),coord=_a$1.coord,from=_a$1.from;if(boxCoordSys.dataToLayout){layoutRefType=BoxLayoutReferenceType.rect,boxCoordFrom=from;var result=boxCoordSys.dataToLayout(coord);refContainer=result.contentRect||result.rect}else opt&&opt.enableLayoutOnlyByCenter&&boxCoordSys.dataToPoint&&(layoutRefType=BoxLayoutReferenceType.point,boxCoordFrom=from,refPoint=boxCoordSys.dataToPoint(coord))}return layoutRefType??=BoxLayoutReferenceType.rect,layoutRefType===BoxLayoutReferenceType.rect&&(refContainer||={x:0,y:0,width:api.getWidth(),height:api.getHeight()},refPoint=[refContainer.x+refContainer.width/2,refContainer.y+refContainer.height/2]),{type:layoutRefType,refContainer,refPoint,boxCoordFrom}}function fetchLayoutMode(ins){var layoutMode=ins.layoutMode||ins.constructor.layoutMode;return isObject(layoutMode)?layoutMode:layoutMode?{type:layoutMode}:null}function mergeLayoutParam(targetOption,newOption,opt){var ignoreSize=opt&&opt.ignoreSize;!isArray(ignoreSize)&&(ignoreSize=[ignoreSize,ignoreSize]);var hResult=merge$1(HV_NAMES[0],0),vResult=merge$1(HV_NAMES[1],1);copy$1(HV_NAMES[0],targetOption,hResult),copy$1(HV_NAMES[1],targetOption,vResult);function merge$1(names,hvIdx){var newParams={},newValueCount=0,merged={},mergedValueCount=0,enoughParamNumber=2;if(each$4(names,function(name){merged[name]=targetOption[name]}),each$4(names,function(name){hasOwn(newOption,name)&&(newParams[name]=merged[name]=newOption[name]),hasValue(newParams,name)&&newValueCount++,hasValue(merged,name)&&mergedValueCount++}),ignoreSize[hvIdx])return hasValue(newOption,names[1])?merged[names[2]]=null:hasValue(newOption,names[2])&&(merged[names[1]]=null),merged;if(mergedValueCount===enoughParamNumber||!newValueCount)return merged;if(newValueCount>=enoughParamNumber)return newParams;for(var i$1=0;i$1<names.length;i$1++){var name_1=names[i$1];if(!hasOwn(newParams,name_1)&&hasOwn(targetOption,name_1)){newParams[name_1]=targetOption[name_1];break}}return newParams}function hasValue(obj,name){return obj[name]!=null&&obj[name]!==`auto`}function copy$1(names,target,source$2){each$4(names,function(name){target[name]=source$2[name]})}}function getLayoutParams(source$2){return copyLayoutParams({},source$2)}function copyLayoutParams(target,source$2){return source$2&&target&&each$4(LOCATION_PARAMS,function(name){hasOwn(source$2,name)&&(target[name]=source$2[name])}),target}var inner$10=makeInner(),ComponentModel=function(_super){__extends(ComponentModel$1,_super);function ComponentModel$1(option,parentModel,ecModel){var _this=_super.call(this,option,parentModel,ecModel)||this;return _this.uid=getUID(`ec_cpt_model`),_this}return ComponentModel$1.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel)},ComponentModel$1.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{},themeModel=ecModel.getTheme();merge(option,themeModel.get(this.mainType)),merge(option,this.getDefaultOption()),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},ComponentModel$1.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0);var layoutMode=fetchLayoutMode(this);layoutMode&&mergeLayoutParam(this.option,option,layoutMode)},ComponentModel$1.prototype.optionUpdated=function(newCptOption,isInit){},ComponentModel$1.prototype.getDefaultOption=function(){var ctor=this.constructor;if(!isExtendedClass(ctor))return ctor.defaultOption;var fields=inner$10(this);if(!fields.defaultOption){for(var optList=[],clz=ctor;clz;){var opt=clz.prototype.defaultOption;opt&&optList.push(opt),clz=clz.superClass}for(var defaultOption$1={},i$1=optList.length-1;i$1>=0;i$1--)defaultOption$1=merge(defaultOption$1,optList[i$1],!0);fields.defaultOption=defaultOption$1}return fields.defaultOption},ComponentModel$1.prototype.getReferringComponents=function(mainType,opt){var indexKey=mainType+`Index`,idKey=mainType+`Id`;return queryReferringComponents(this.ecModel,mainType,{index:this.get(indexKey,!0),id:this.get(idKey,!0)},opt)},ComponentModel$1.prototype.getBoxLayoutParams=function(){return getBoxLayoutParams(this,!1)},ComponentModel$1.prototype.getZLevelKey=function(){return``},ComponentModel$1.prototype.setZLevel=function(zlevel){this.option.zlevel=zlevel},ComponentModel$1.protoInitialize=function(){var proto=ComponentModel$1.prototype;proto.type=`component`,proto.id=``,proto.name=``,proto.mainType=``,proto.subType=``,proto.componentIndex=0}(),ComponentModel$1}(Model_default);mountExtend(ComponentModel,Model_default),enableClassManagement(ComponentModel),enableSubTypeDefaulter(ComponentModel),enableTopologicalTravel(ComponentModel,getDependencies);function getDependencies(componentType){var deps=[];return each(ComponentModel.getClassesByMainType(componentType),function(clz){deps=deps.concat(clz.dependencies||clz.prototype.dependencies||[])}),deps=map(deps,function(type){return parseClassType(type).main}),componentType!==`dataset`&&indexOf(deps,`dataset`)<=0&&deps.unshift(`dataset`),deps}var Component_default=ComponentModel,tokens={color:{},darkColor:{},size:{}},color$1=tokens.color={theme:[`#5070dd`,`#b6d634`,`#505372`,`#ff994d`,`#0ca8df`,`#ffd10a`,`#fb628b`,`#785db0`,`#3fbe95`],neutral00:`#fff`,neutral05:`#f4f7fd`,neutral10:`#e8ebf0`,neutral15:`#dbdee4`,neutral20:`#cfd2d7`,neutral25:`#c3c5cb`,neutral30:`#b7b9be`,neutral35:`#aaacb2`,neutral40:`#9ea0a5`,neutral45:`#929399`,neutral50:`#86878c`,neutral55:`#797b7f`,neutral60:`#6d6e73`,neutral65:`#616266`,neutral70:`#54555a`,neutral75:`#48494d`,neutral80:`#3c3c41`,neutral85:`#303034`,neutral90:`#232328`,neutral95:`#17171b`,neutral99:`#000`,accent05:`#eff1f9`,accent10:`#e0e4f2`,accent15:`#d0d6ec`,accent20:`#c0c9e6`,accent25:`#b1bbdf`,accent30:`#a1aed9`,accent35:`#91a0d3`,accent40:`#8292cc`,accent45:`#7285c6`,accent50:`#6578ba`,accent55:`#5c6da9`,accent60:`#536298`,accent65:`#4a5787`,accent70:`#404c76`,accent75:`#374165`,accent80:`#2e3654`,accent85:`#252b43`,accent90:`#1b2032`,accent95:`#121521`,transparent:`rgba(0,0,0,0)`,highlight:`rgba(255,231,130,0.8)`};for(var key in extend(color$1,{primary:color$1.neutral80,secondary:color$1.neutral70,tertiary:color$1.neutral60,quaternary:color$1.neutral50,disabled:color$1.neutral20,border:color$1.neutral30,borderTint:color$1.neutral20,borderShade:color$1.neutral40,background:color$1.neutral05,backgroundTint:`rgba(234,237,245,0.5)`,backgroundTransparent:`rgba(255,255,255,0)`,backgroundShade:color$1.neutral10,shadow:`rgba(0,0,0,0.2)`,shadowTint:`rgba(129,130,136,0.2)`,axisLine:color$1.neutral70,axisLineTint:color$1.neutral40,axisTick:color$1.neutral70,axisTickMinor:color$1.neutral60,axisLabel:color$1.neutral70,axisSplitLine:color$1.neutral15,axisMinorSplitLine:color$1.neutral05}),color$1)if(color$1.hasOwnProperty(key)){var hex=color$1[key];key===`theme`?tokens.darkColor.theme=color$1.theme.slice():key===`highlight`?tokens.darkColor.highlight=`rgba(255,231,130,0.4)`:key.indexOf(`accent`)===0?tokens.darkColor[key]=modifyHSL(hex,null,function(s$1){return s$1*.5},function(l$1){return Math.min(1,1.3-l$1)}):tokens.darkColor[key]=modifyHSL(hex,null,function(s$1){return s$1*.9},function(l$1){return 1-l$1**1.5})}tokens.size={xxs:2,xs:5,s:10,m:15,l:20,xl:30,xxl:40,xxxl:50};var tokens_default=tokens,platform=``;typeof navigator<`u`&&(platform=navigator.platform||``);var decalColor=`rgba(0, 0, 0, 0.2)`,themeColor=tokens_default.color.theme[0],lightThemeColor=modifyHSL(themeColor,null,null,.9),globalDefault_default={darkMode:`auto`,colorBy:`series`,color:tokens_default.color.theme,gradientColor:[lightThemeColor,themeColor],aria:{decal:{decals:[{color:decalColor,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:decalColor,symbol:`circle`,dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:decalColor,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:decalColor,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:decalColor,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:decalColor,symbol:`triangle`,dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:platform.match(/^Win/)?`Microsoft YaHei`:`sans-serif`,fontSize:12,fontStyle:`normal`,fontWeight:`normal`},blendMode:null,stateAnimation:{duration:300,easing:`cubicOut`},animation:`auto`,animationDuration:1e3,animationDurationUpdate:500,animationEasing:`cubicInOut`,animationEasingUpdate:`cubicInOut`,animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},VISUAL_DIMENSIONS=createHashMap([`tooltip`,`label`,`itemName`,`itemId`,`itemGroupId`,`itemChildGroupId`,`seriesName`]),SOURCE_FORMAT_ORIGINAL=`original`,SOURCE_FORMAT_ARRAY_ROWS=`arrayRows`,SOURCE_FORMAT_OBJECT_ROWS=`objectRows`,SOURCE_FORMAT_KEYED_COLUMNS=`keyedColumns`,SOURCE_FORMAT_TYPED_ARRAY=`typedArray`,SOURCE_FORMAT_UNKNOWN=`unknown`,SERIES_LAYOUT_BY_COLUMN=`column`,SERIES_LAYOUT_BY_ROW=`row`,BE_ORDINAL={Must:1,Might:2,Not:3},innerGlobalModel=makeInner();function resetSourceDefaulter(ecModel){innerGlobalModel(ecModel).datasetMap=createHashMap()}function makeSeriesEncodeForAxisCoordSys(coordDimensions,seriesModel,source$2){var encode={},datasetModel=querySeriesUpstreamDatasetModel(seriesModel);if(!datasetModel||!coordDimensions)return encode;var encodeItemName=[],encodeSeriesName=[],ecModel=seriesModel.ecModel,datasetMap=innerGlobalModel(ecModel).datasetMap,key$1=datasetModel.uid+`_`+source$2.seriesLayoutBy,baseCategoryDimIndex,categoryWayValueDimStart;coordDimensions=coordDimensions.slice(),each(coordDimensions,function(coordDimInfoLoose,coordDimIdx){var coordDimInfo=isObject(coordDimInfoLoose)?coordDimInfoLoose:coordDimensions[coordDimIdx]={name:coordDimInfoLoose};coordDimInfo.type===`ordinal`&&baseCategoryDimIndex==null&&(baseCategoryDimIndex=coordDimIdx,categoryWayValueDimStart=getDataDimCountOnCoordDim(coordDimInfo)),encode[coordDimInfo.name]=[]});var datasetRecord=datasetMap.get(key$1)||datasetMap.set(key$1,{categoryWayDim:categoryWayValueDimStart,valueWayDim:0});each(coordDimensions,function(coordDimInfo,coordDimIdx){var coordDimName=coordDimInfo.name,count$1=getDataDimCountOnCoordDim(coordDimInfo);if(baseCategoryDimIndex==null){var start$1=datasetRecord.valueWayDim;pushDim(encode[coordDimName],start$1,count$1),pushDim(encodeSeriesName,start$1,count$1),datasetRecord.valueWayDim+=count$1}else if(baseCategoryDimIndex===coordDimIdx)pushDim(encode[coordDimName],0,count$1),pushDim(encodeItemName,0,count$1);else{var start$1=datasetRecord.categoryWayDim;pushDim(encode[coordDimName],start$1,count$1),pushDim(encodeSeriesName,start$1,count$1),datasetRecord.categoryWayDim+=count$1}});function pushDim(dimIdxArr,idxFrom,idxCount){for(var i$1=0;i$1<idxCount;i$1++)dimIdxArr.push(idxFrom+i$1)}function getDataDimCountOnCoordDim(coordDimInfo){var dimsDef=coordDimInfo.dimsDef;return dimsDef?dimsDef.length:1}return encodeItemName.length&&(encode.itemName=encodeItemName),encodeSeriesName.length&&(encode.seriesName=encodeSeriesName),encode}function querySeriesUpstreamDatasetModel(seriesModel){if(!seriesModel.get(`data`,!0))return queryReferringComponents(seriesModel.ecModel,`dataset`,{index:seriesModel.get(`datasetIndex`,!0),id:seriesModel.get(`datasetId`,!0)},SINGLE_REFERRING).models[0]}function queryDatasetUpstreamDatasetModels(datasetModel){return!datasetModel.get(`transform`,!0)&&!datasetModel.get(`fromTransformResult`,!0)?[]:queryReferringComponents(datasetModel.ecModel,`dataset`,{index:datasetModel.get(`fromDatasetIndex`,!0),id:datasetModel.get(`fromDatasetId`,!0)},SINGLE_REFERRING).models}function guessOrdinal(source$2,dimIndex){return doGuessOrdinal(source$2.data,source$2.sourceFormat,source$2.seriesLayoutBy,source$2.dimensionsDefine,source$2.startIndex,dimIndex)}function doGuessOrdinal(data,sourceFormat,seriesLayoutBy,dimensionsDefine,startIndex,dimIndex){var result,maxLoop=5;if(isTypedArray(data))return BE_ORDINAL.Not;var dimName,dimType;if(dimensionsDefine){var dimDefItem=dimensionsDefine[dimIndex];isObject(dimDefItem)?(dimName=dimDefItem.name,dimType=dimDefItem.type):isString(dimDefItem)&&(dimName=dimDefItem)}if(dimType!=null)return dimType===`ordinal`?BE_ORDINAL.Must:BE_ORDINAL.Not;if(sourceFormat===`arrayRows`){var dataArrayRows=data;if(seriesLayoutBy===`row`){for(var sample=dataArrayRows[dimIndex],i$1=0;i$1<(sample||[]).length&&i$1<maxLoop;i$1++)if((result=detectValue(sample[startIndex+i$1]))!=null)return result}else for(var i$1=0;i$1<dataArrayRows.length&&i$1<maxLoop;i$1++){var row=dataArrayRows[startIndex+i$1];if(row&&(result=detectValue(row[dimIndex]))!=null)return result}}else if(sourceFormat===`objectRows`){var dataObjectRows=data;if(!dimName)return BE_ORDINAL.Not;for(var i$1=0;i$1<dataObjectRows.length&&i$1<maxLoop;i$1++){var item=dataObjectRows[i$1];if(item&&(result=detectValue(item[dimName]))!=null)return result}}else if(sourceFormat===`keyedColumns`){var dataKeyedColumns=data;if(!dimName)return BE_ORDINAL.Not;var sample=dataKeyedColumns[dimName];if(!sample||isTypedArray(sample))return BE_ORDINAL.Not;for(var i$1=0;i$1<sample.length&&i$1<maxLoop;i$1++)if((result=detectValue(sample[i$1]))!=null)return result}else if(sourceFormat===`original`)for(var dataOriginal=data,i$1=0;i$1<dataOriginal.length&&i$1<maxLoop;i$1++){var item=dataOriginal[i$1],val=getDataItemValue(item);if(!isArray(val))return BE_ORDINAL.Not;if((result=detectValue(val[dimIndex]))!=null)return result}function detectValue(val$1){var beStr=isString(val$1);if(val$1!=null&&Number.isFinite(Number(val$1))&&val$1!==``)return beStr?BE_ORDINAL.Might:BE_ORDINAL.Not;if(beStr&&val$1!==`-`)return BE_ORDINAL.Must}return BE_ORDINAL.Not}var internalOptionCreatorMap=createHashMap();function concatInternalOptions(ecModel,mainType,newCmptOptionList){var internalOptionCreator=internalOptionCreatorMap.get(mainType);if(!internalOptionCreator)return newCmptOptionList;var internalOptions=internalOptionCreator(ecModel);return internalOptions?newCmptOptionList.concat(internalOptions):newCmptOptionList}var innerColor=makeInner(),innerDecal=makeInner(),PaletteMixin=function(){function PaletteMixin$1(){}return PaletteMixin$1.prototype.getColorFromPalette=function(name,scope,requestNum){var defaultPalette=normalizeToArray(this.get(`color`,!0)),layeredPalette=this.get(`colorLayer`,!0);return getFromPalette(this,innerColor,defaultPalette,layeredPalette,name,scope,requestNum)},PaletteMixin$1.prototype.clearColorPalette=function(){clearPalette(this,innerColor)},PaletteMixin$1}();function getNearestPalette(palettes,requestColorNum){for(var paletteNum=palettes.length,i$1=0;i$1<paletteNum;i$1++)if(palettes[i$1].length>requestColorNum)return palettes[i$1];return palettes[paletteNum-1]}function getFromPalette(that,inner$11,defaultPalette,layeredPalette,name,scope,requestNum){scope||=that;var scopeFields=inner$11(scope),paletteIdx=scopeFields.paletteIdx||0,paletteNameMap=scopeFields.paletteNameMap=scopeFields.paletteNameMap||{};if(paletteNameMap.hasOwnProperty(name))return paletteNameMap[name];var palette=requestNum==null||!layeredPalette?defaultPalette:getNearestPalette(layeredPalette,requestNum);if(palette||=defaultPalette,!(!palette||!palette.length)){var pickedPaletteItem=palette[paletteIdx];return name&&(paletteNameMap[name]=pickedPaletteItem),scopeFields.paletteIdx=(paletteIdx+1)%palette.length,pickedPaletteItem}}function clearPalette(that,inner$11){inner$11(that).paletteIdx=0,inner$11(that).paletteNameMap={}}var reCreateSeriesIndices,assertSeriesInitialized,initBase,OPTION_INNER_KEY=`\0_ec_inner`,OPTION_INNER_VALUE=1,GlobalModel=function(_super){__extends(GlobalModel$1,_super);function GlobalModel$1(){return _super!==null&&_super.apply(this,arguments)||this}return GlobalModel$1.prototype.init=function(option,parentModel,ecModel,theme$1,locale,optionManager){theme$1||={},this.option=null,this._theme=new Model_default(theme$1),this._locale=new Model_default(locale),this._optionManager=optionManager},GlobalModel$1.prototype.setOption=function(option,opts,optionPreprocessorFuncs$1){var innerOpt=normalizeSetOptionInput(opts);this._optionManager.setOption(option,optionPreprocessorFuncs$1,innerOpt),this._resetOption(null,innerOpt)},GlobalModel$1.prototype.resetOption=function(type,opt){return this._resetOption(type,normalizeSetOptionInput(opt))},GlobalModel$1.prototype._resetOption=function(type,opt){var optionChanged=!1,optionManager=this._optionManager;if(!type||type===`recreate`){var baseOption=optionManager.mountOption(type===`recreate`);!this.option||type===`recreate`?initBase(this,baseOption):(this.restoreData(),this._mergeOption(baseOption,opt)),optionChanged=!0}if((type===`timeline`||type===`media`)&&this.restoreData(),!type||type===`recreate`||type===`timeline`){var timelineOption=optionManager.getTimelineOption(this);timelineOption&&(optionChanged=!0,this._mergeOption(timelineOption,opt))}if(!type||type===`recreate`||type===`media`){var mediaOptions=optionManager.getMediaOption(this);mediaOptions.length&&each(mediaOptions,function(mediaOption){optionChanged=!0,this._mergeOption(mediaOption,opt)},this)}return optionChanged},GlobalModel$1.prototype.mergeOption=function(option){this._mergeOption(option,null)},GlobalModel$1.prototype._mergeOption=function(newOption,opt){var option=this.option,componentsMap=this._componentsMap,componentsCount=this._componentsCount,newCmptTypes=[],newCmptTypeMap=createHashMap(),replaceMergeMainTypeMap=opt&&opt.replaceMergeMainTypeMap;resetSourceDefaulter(this),each(newOption,function(componentOption,mainType){componentOption!=null&&(Component_default.hasClass(mainType)?mainType&&(newCmptTypes.push(mainType),newCmptTypeMap.set(mainType,!0)):option[mainType]=option[mainType]==null?clone(componentOption):merge(option[mainType],componentOption,!0))}),replaceMergeMainTypeMap&&replaceMergeMainTypeMap.each(function(val,mainTypeInReplaceMerge){Component_default.hasClass(mainTypeInReplaceMerge)&&!newCmptTypeMap.get(mainTypeInReplaceMerge)&&(newCmptTypes.push(mainTypeInReplaceMerge),newCmptTypeMap.set(mainTypeInReplaceMerge,!0))}),Component_default.topologicalTravel(newCmptTypes,Component_default.getAllClassMainTypes(),visitComponent,this);function visitComponent(mainType){var newCmptOptionList=concatInternalOptions(this,mainType,normalizeToArray(newOption[mainType])),oldCmptList=componentsMap.get(mainType),mergeMode=oldCmptList?replaceMergeMainTypeMap&&replaceMergeMainTypeMap.get(mainType)?`replaceMerge`:`normalMerge`:`replaceAll`,mappingResult=mappingToExists(oldCmptList,newCmptOptionList,mergeMode);setComponentTypeToKeyInfo(mappingResult,mainType,Component_default),option[mainType]=null,componentsMap.set(mainType,null),componentsCount.set(mainType,0);var optionsByMainType=[],cmptsByMainType=[],cmptsCountByMainType=0,tooltipExists;each(mappingResult,function(resultItem,index){var componentModel=resultItem.existing,newCmptOption=resultItem.newOption;if(!newCmptOption)componentModel&&(componentModel.mergeOption({},this),componentModel.optionUpdated({},!1));else{var isSeriesType=mainType===`series`,ComponentModelClass=Component_default.getClass(mainType,resultItem.keyInfo.subType,!isSeriesType);if(!ComponentModelClass)return;if(mainType===`tooltip`){if(tooltipExists)return;tooltipExists=!0}if(componentModel&&componentModel.constructor===ComponentModelClass)componentModel.name=resultItem.keyInfo.name,componentModel.mergeOption(newCmptOption,this),componentModel.optionUpdated(newCmptOption,!1);else{var extraOpt=extend({componentIndex:index},resultItem.keyInfo);componentModel=new ComponentModelClass(newCmptOption,this,this,extraOpt),extend(componentModel,extraOpt),resultItem.brandNew&&(componentModel.__requireNewView=!0),componentModel.init(newCmptOption,this,this),componentModel.optionUpdated(null,!0)}}componentModel?(optionsByMainType.push(componentModel.option),cmptsByMainType.push(componentModel),cmptsCountByMainType++):(optionsByMainType.push(void 0),cmptsByMainType.push(void 0))},this),option[mainType]=optionsByMainType,componentsMap.set(mainType,cmptsByMainType),componentsCount.set(mainType,cmptsCountByMainType),mainType===`series`&&reCreateSeriesIndices(this)}this._seriesIndices||reCreateSeriesIndices(this)},GlobalModel$1.prototype.getOption=function(){var option=clone(this.option);return each(option,function(optInMainType,mainType){if(Component_default.hasClass(mainType)){for(var opts=normalizeToArray(optInMainType),realLen=opts.length,metNonInner=!1,i$1=realLen-1;i$1>=0;i$1--)opts[i$1]&&!isComponentIdInternal(opts[i$1])?metNonInner=!0:(opts[i$1]=null,!metNonInner&&realLen--);opts.length=realLen,option[mainType]=opts}}),delete option[OPTION_INNER_KEY],option},GlobalModel$1.prototype.setTheme=function(theme$1){this._theme=new Model_default(theme$1),this._resetOption(`recreate`,null)},GlobalModel$1.prototype.getTheme=function(){return this._theme},GlobalModel$1.prototype.getLocaleModel=function(){return this._locale},GlobalModel$1.prototype.setUpdatePayload=function(payload){this._payload=payload},GlobalModel$1.prototype.getUpdatePayload=function(){return this._payload},GlobalModel$1.prototype.getComponent=function(mainType,idx){var list=this._componentsMap.get(mainType);if(list){var cmpt=list[idx||0];if(cmpt)return cmpt;if(idx==null){for(var i$1=0;i$1<list.length;i$1++)if(list[i$1])return list[i$1]}}},GlobalModel$1.prototype.queryComponents=function(condition){var mainType=condition.mainType;if(!mainType)return[];var index=condition.index,id=condition.id,name=condition.name,cmpts=this._componentsMap.get(mainType);if(!cmpts||!cmpts.length)return[];var result;return index==null?result=id==null?name==null?filter(cmpts,function(cmpt){return!!cmpt}):queryByIdOrName(`name`,name,cmpts):queryByIdOrName(`id`,id,cmpts):(result=[],each(normalizeToArray(index),function(idx){cmpts[idx]&&result.push(cmpts[idx])})),filterBySubType(result,condition)},GlobalModel$1.prototype.findComponents=function(condition){var query=condition.query,mainType=condition.mainType,queryCond=getQueryCond(query),result=queryCond?this.queryComponents(queryCond):filter(this._componentsMap.get(mainType),function(cmpt){return!!cmpt});return doFilter(filterBySubType(result,condition));function getQueryCond(q$1){var indexAttr=mainType+`Index`,idAttr=mainType+`Id`,nameAttr=mainType+`Name`;return q$1&&(q$1[indexAttr]!=null||q$1[idAttr]!=null||q$1[nameAttr]!=null)?{mainType,index:q$1[indexAttr],id:q$1[idAttr],name:q$1[nameAttr]}:null}function doFilter(res){return condition.filter?filter(res,condition.filter):res}},GlobalModel$1.prototype.eachComponent=function(mainType,cb,context$1){var componentsMap=this._componentsMap;if(isFunction(mainType)){var ctxForAll_1=cb,cbForAll_1=mainType;componentsMap.each(function(cmpts$1,componentType){for(var i$2=0;cmpts$1&&i$2<cmpts$1.length;i$2++){var cmpt$1=cmpts$1[i$2];cmpt$1&&cbForAll_1.call(ctxForAll_1,componentType,cmpt$1,cmpt$1.componentIndex)}})}else for(var cmpts=isString(mainType)?componentsMap.get(mainType):isObject(mainType)?this.findComponents(mainType):null,i$1=0;cmpts&&i$1<cmpts.length;i$1++){var cmpt=cmpts[i$1];cmpt&&cb.call(context$1,cmpt,cmpt.componentIndex)}},GlobalModel$1.prototype.getSeriesByName=function(name){var nameStr=convertOptionIdName(name,null);return filter(this._componentsMap.get(`series`),function(oneSeries){return!!oneSeries&&nameStr!=null&&oneSeries.name===nameStr})},GlobalModel$1.prototype.getSeriesByIndex=function(seriesIndex){return this._componentsMap.get(`series`)[seriesIndex]},GlobalModel$1.prototype.getSeriesByType=function(subType){return filter(this._componentsMap.get(`series`),function(oneSeries){return!!oneSeries&&oneSeries.subType===subType})},GlobalModel$1.prototype.getSeries=function(){return filter(this._componentsMap.get(`series`),function(oneSeries){return!!oneSeries})},GlobalModel$1.prototype.getSeriesCount=function(){return this._componentsCount.get(`series`)},GlobalModel$1.prototype.eachSeries=function(cb,context$1){assertSeriesInitialized(this),each(this._seriesIndices,function(rawSeriesIndex){var series=this._componentsMap.get(`series`)[rawSeriesIndex];cb.call(context$1,series,rawSeriesIndex)},this)},GlobalModel$1.prototype.eachRawSeries=function(cb,context$1){each(this._componentsMap.get(`series`),function(series){series&&cb.call(context$1,series,series.componentIndex)})},GlobalModel$1.prototype.eachSeriesByType=function(subType,cb,context$1){assertSeriesInitialized(this),each(this._seriesIndices,function(rawSeriesIndex){var series=this._componentsMap.get(`series`)[rawSeriesIndex];series.subType===subType&&cb.call(context$1,series,rawSeriesIndex)},this)},GlobalModel$1.prototype.eachRawSeriesByType=function(subType,cb,context$1){return each(this.getSeriesByType(subType),cb,context$1)},GlobalModel$1.prototype.isSeriesFiltered=function(seriesModel){return assertSeriesInitialized(this),this._seriesIndicesMap.get(seriesModel.componentIndex)==null},GlobalModel$1.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},GlobalModel$1.prototype.filterSeries=function(cb,context$1){assertSeriesInitialized(this);var newSeriesIndices=[];each(this._seriesIndices,function(seriesRawIdx){var series=this._componentsMap.get(`series`)[seriesRawIdx];cb.call(context$1,series,seriesRawIdx)&&newSeriesIndices.push(seriesRawIdx)},this),this._seriesIndices=newSeriesIndices,this._seriesIndicesMap=createHashMap(newSeriesIndices)},GlobalModel$1.prototype.restoreData=function(payload){reCreateSeriesIndices(this);var componentsMap=this._componentsMap,componentTypes=[];componentsMap.each(function(components,componentType){Component_default.hasClass(componentType)&&componentTypes.push(componentType)}),Component_default.topologicalTravel(componentTypes,Component_default.getAllClassMainTypes(),function(componentType){each(componentsMap.get(componentType),function(component){component&&(componentType!==`series`||!isNotTargetSeries(component,payload))&&component.restoreData()})})},GlobalModel$1.internalField=function(){reCreateSeriesIndices=function(ecModel){var seriesIndices=ecModel._seriesIndices=[];each(ecModel._componentsMap.get(`series`),function(series){series&&seriesIndices.push(series.componentIndex)}),ecModel._seriesIndicesMap=createHashMap(seriesIndices)},assertSeriesInitialized=function(ecModel){},initBase=function(ecModel,baseOption){ecModel.option={},ecModel.option[OPTION_INNER_KEY]=OPTION_INNER_VALUE,ecModel._componentsMap=createHashMap({series:[]}),ecModel._componentsCount=createHashMap();var airaOption=baseOption.aria;isObject(airaOption)&&airaOption.enabled==null&&(airaOption.enabled=!0),mergeTheme(baseOption,ecModel._theme.option),merge(baseOption,globalDefault_default,!1),ecModel._mergeOption(baseOption,null)}}(),GlobalModel$1}(Model_default);function isNotTargetSeries(seriesModel,payload){if(payload){var index=payload.seriesIndex,id=payload.seriesId,name_1=payload.seriesName;return index!=null&&seriesModel.componentIndex!==index||id!=null&&seriesModel.id!==id||name_1!=null&&seriesModel.name!==name_1}}function mergeTheme(option,theme$1){var notMergeColorLayer=option.color&&!option.colorLayer;each(theme$1,function(themeItem,name){name===`colorLayer`&&notMergeColorLayer||name===`color`&&option.color||Component_default.hasClass(name)||(typeof themeItem==`object`?option[name]=option[name]?merge(option[name],themeItem,!1):clone(themeItem):option[name]??(option[name]=themeItem))})}function queryByIdOrName(attr,idOrName,cmpts){if(isArray(idOrName)){var keyMap_1=createHashMap();return each(idOrName,function(idOrNameItem){idOrNameItem!=null&&convertOptionIdName(idOrNameItem,null)!=null&&keyMap_1.set(idOrNameItem,!0)}),filter(cmpts,function(cmpt){return cmpt&&keyMap_1.get(cmpt[attr])})}else{var idName_1=convertOptionIdName(idOrName,null);return filter(cmpts,function(cmpt){return cmpt&&idName_1!=null&&cmpt[attr]===idName_1})}}function filterBySubType(components,condition){return condition.hasOwnProperty(`subType`)?filter(components,function(cmpt){return cmpt&&cmpt.subType===condition.subType}):components}function normalizeSetOptionInput(opts){var replaceMergeMainTypeMap=createHashMap();return opts&&each(normalizeToArray(opts.replaceMerge),function(mainType){replaceMergeMainTypeMap.set(mainType,!0)}),{replaceMergeMainTypeMap}}mixin(GlobalModel,PaletteMixin);var Global_default=GlobalModel,availableMethods=[`getDom`,`getZr`,`getWidth`,`getHeight`,`getDevicePixelRatio`,`dispatchAction`,`isSSR`,`isDisposed`,`on`,`off`,`getDataURL`,`getConnectedDataURL`,`getOption`,`getId`,`updateLabelLayout`],ExtensionAPI_default=function(){function ExtensionAPI$1(ecInstance){each(availableMethods,function(methodName){this[methodName]=bind(ecInstance[methodName],ecInstance)},this)}return ExtensionAPI$1}(),QUERY_REG=/^(min|max)?(.+)$/,OptionManager=function(){function OptionManager$1(api){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=api}return OptionManager$1.prototype.setOption=function(rawOption,optionPreprocessorFuncs$1,opt){rawOption&&(each(normalizeToArray(rawOption.series),function(series){series&&series.data&&isTypedArray(series.data)&&setAsPrimitive(series.data)}),each(normalizeToArray(rawOption.dataset),function(dataset){dataset&&dataset.source&&isTypedArray(dataset.source)&&setAsPrimitive(dataset.source)})),rawOption=clone(rawOption);var optionBackup=this._optionBackup,newParsedOption=parseRawOption(rawOption,optionPreprocessorFuncs$1,!optionBackup);this._newBaseOption=newParsedOption.baseOption,optionBackup?(newParsedOption.timelineOptions.length&&(optionBackup.timelineOptions=newParsedOption.timelineOptions),newParsedOption.mediaList.length&&(optionBackup.mediaList=newParsedOption.mediaList),newParsedOption.mediaDefault&&(optionBackup.mediaDefault=newParsedOption.mediaDefault)):this._optionBackup=newParsedOption},OptionManager$1.prototype.mountOption=function(isRecreate){var optionBackup=this._optionBackup;return this._timelineOptions=optionBackup.timelineOptions,this._mediaList=optionBackup.mediaList,this._mediaDefault=optionBackup.mediaDefault,this._currentMediaIndices=[],clone(isRecreate?optionBackup.baseOption:this._newBaseOption)},OptionManager$1.prototype.getTimelineOption=function(ecModel){var option,timelineOptions=this._timelineOptions;if(timelineOptions.length){var timelineModel=ecModel.getComponent(`timeline`);timelineModel&&(option=clone(timelineOptions[timelineModel.getCurrentIndex()]))}return option},OptionManager$1.prototype.getMediaOption=function(ecModel){var ecWidth=this._api.getWidth(),ecHeight=this._api.getHeight(),mediaList=this._mediaList,mediaDefault=this._mediaDefault,indices=[],result=[];if(!mediaList.length&&!mediaDefault)return result;for(var i$1=0,len$1=mediaList.length;i$1<len$1;i$1++)applyMediaQuery(mediaList[i$1].query,ecWidth,ecHeight)&&indices.push(i$1);return!indices.length&&mediaDefault&&(indices=[-1]),indices.length&&!indicesEquals(indices,this._currentMediaIndices)&&(result=map(indices,function(index){return clone(index===-1?mediaDefault.option:mediaList[index].option)})),this._currentMediaIndices=indices,result},OptionManager$1}();function parseRawOption(rawOption,optionPreprocessorFuncs$1,isNew){var mediaList=[],mediaDefault,baseOption,declaredBaseOption=rawOption.baseOption,timelineOnRoot=rawOption.timeline,timelineOptionsOnRoot=rawOption.options,mediaOnRoot=rawOption.media,hasMedia=!!rawOption.media,hasTimeline=!!(timelineOptionsOnRoot||timelineOnRoot||declaredBaseOption&&declaredBaseOption.timeline);declaredBaseOption?(baseOption=declaredBaseOption,baseOption.timeline||=timelineOnRoot):((hasTimeline||hasMedia)&&(rawOption.options=rawOption.media=null),baseOption=rawOption),hasMedia&&isArray(mediaOnRoot)&&each(mediaOnRoot,function(singleMedia){singleMedia&&singleMedia.option&&(singleMedia.query?mediaList.push(singleMedia):mediaDefault||=singleMedia)}),doPreprocess(baseOption),each(timelineOptionsOnRoot,function(option){return doPreprocess(option)}),each(mediaList,function(media){return doPreprocess(media.option)});function doPreprocess(option){each(optionPreprocessorFuncs$1,function(preProcess){preProcess(option,isNew)})}return{baseOption,timelineOptions:timelineOptionsOnRoot||[],mediaDefault,mediaList}}function applyMediaQuery(query,ecWidth,ecHeight){var realMap={width:ecWidth,height:ecHeight,aspectratio:ecWidth/ecHeight},applicable=!0;return each(query,function(value,attr){var matched=attr.match(QUERY_REG);if(!(!matched||!matched[1]||!matched[2])){var operator=matched[1],realAttr=matched[2].toLowerCase();compare(realMap[realAttr],value,operator)||(applicable=!1)}}),applicable}function compare(real,expect,operator){return operator===`min`?real>=expect:operator===`max`?real<=expect:real===expect}function indicesEquals(indices1,indices2){return indices1.join(`,`)===indices2.join(`,`)}var OptionManager_default=OptionManager,each$3=each,isObject$2=isObject,POSSIBLE_STYLES=[`areaStyle`,`lineStyle`,`nodeStyle`,`linkStyle`,`chordStyle`,`label`,`labelLine`];function compatEC2ItemStyle(opt){var itemStyleOpt=opt&&opt.itemStyle;if(itemStyleOpt)for(var i$1=0,len$1=POSSIBLE_STYLES.length;i$1<len$1;i$1++){var styleName=POSSIBLE_STYLES[i$1],normalItemStyleOpt=itemStyleOpt.normal,emphasisItemStyleOpt=itemStyleOpt.emphasis;normalItemStyleOpt&&normalItemStyleOpt[styleName]&&(opt[styleName]=opt[styleName]||{},opt[styleName].normal?merge(opt[styleName].normal,normalItemStyleOpt[styleName]):opt[styleName].normal=normalItemStyleOpt[styleName],normalItemStyleOpt[styleName]=null),emphasisItemStyleOpt&&emphasisItemStyleOpt[styleName]&&(opt[styleName]=opt[styleName]||{},opt[styleName].emphasis?merge(opt[styleName].emphasis,emphasisItemStyleOpt[styleName]):opt[styleName].emphasis=emphasisItemStyleOpt[styleName],emphasisItemStyleOpt[styleName]=null)}}function convertNormalEmphasis(opt,optType,useExtend){if(opt&&opt[optType]&&(opt[optType].normal||opt[optType].emphasis)){var normalOpt=opt[optType].normal,emphasisOpt=opt[optType].emphasis;normalOpt&&(useExtend?(opt[optType].normal=opt[optType].emphasis=null,defaults(opt[optType],normalOpt)):opt[optType]=normalOpt),emphasisOpt&&(opt.emphasis=opt.emphasis||{},opt.emphasis[optType]=emphasisOpt,emphasisOpt.focus&&(opt.emphasis.focus=emphasisOpt.focus),emphasisOpt.blurScope&&(opt.emphasis.blurScope=emphasisOpt.blurScope))}}function removeEC3NormalStatus(opt){convertNormalEmphasis(opt,`itemStyle`),convertNormalEmphasis(opt,`lineStyle`),convertNormalEmphasis(opt,`areaStyle`),convertNormalEmphasis(opt,`label`),convertNormalEmphasis(opt,`labelLine`),convertNormalEmphasis(opt,`upperLabel`),convertNormalEmphasis(opt,`edgeLabel`)}function compatTextStyle(opt,propName){var labelOptSingle=isObject$2(opt)&&opt[propName],textStyle=isObject$2(labelOptSingle)&&labelOptSingle.textStyle;if(textStyle)for(var i$1=0,len$1=TEXT_STYLE_OPTIONS.length;i$1<len$1;i$1++){var textPropName=TEXT_STYLE_OPTIONS[i$1];textStyle.hasOwnProperty(textPropName)&&(labelOptSingle[textPropName]=textStyle[textPropName])}}function compatEC3CommonStyles(opt){opt&&(removeEC3NormalStatus(opt),compatTextStyle(opt,`label`),opt.emphasis&&compatTextStyle(opt.emphasis,`label`))}function processSeries(seriesOpt){if(isObject$2(seriesOpt)){compatEC2ItemStyle(seriesOpt),removeEC3NormalStatus(seriesOpt),compatTextStyle(seriesOpt,`label`),compatTextStyle(seriesOpt,`upperLabel`),compatTextStyle(seriesOpt,`edgeLabel`),seriesOpt.emphasis&&(compatTextStyle(seriesOpt.emphasis,`label`),compatTextStyle(seriesOpt.emphasis,`upperLabel`),compatTextStyle(seriesOpt.emphasis,`edgeLabel`));var markPoint=seriesOpt.markPoint;markPoint&&(compatEC2ItemStyle(markPoint),compatEC3CommonStyles(markPoint));var markLine=seriesOpt.markLine;markLine&&(compatEC2ItemStyle(markLine),compatEC3CommonStyles(markLine));var markArea=seriesOpt.markArea;markArea&&compatEC3CommonStyles(markArea);var data=seriesOpt.data;if(seriesOpt.type===`graph`){data||=seriesOpt.nodes;var edgeData=seriesOpt.links||seriesOpt.edges;if(edgeData&&!isTypedArray(edgeData))for(var i$1=0;i$1<edgeData.length;i$1++)compatEC3CommonStyles(edgeData[i$1]);each(seriesOpt.categories,function(opt){removeEC3NormalStatus(opt)})}if(data&&!isTypedArray(data))for(var i$1=0;i$1<data.length;i$1++)compatEC3CommonStyles(data[i$1]);if(markPoint=seriesOpt.markPoint,markPoint&&markPoint.data)for(var mpData=markPoint.data,i$1=0;i$1<mpData.length;i$1++)compatEC3CommonStyles(mpData[i$1]);if(markLine=seriesOpt.markLine,markLine&&markLine.data)for(var mlData=markLine.data,i$1=0;i$1<mlData.length;i$1++)isArray(mlData[i$1])?(compatEC3CommonStyles(mlData[i$1][0]),compatEC3CommonStyles(mlData[i$1][1])):compatEC3CommonStyles(mlData[i$1]);seriesOpt.type===`gauge`?(compatTextStyle(seriesOpt,`axisLabel`),compatTextStyle(seriesOpt,`title`),compatTextStyle(seriesOpt,`detail`)):seriesOpt.type===`treemap`?(convertNormalEmphasis(seriesOpt.breadcrumb,`itemStyle`),each(seriesOpt.levels,function(opt){removeEC3NormalStatus(opt)})):seriesOpt.type===`tree`&&removeEC3NormalStatus(seriesOpt.leaves)}}function toArr(o$1){return isArray(o$1)?o$1:o$1?[o$1]:[]}function toObj(o$1){return(isArray(o$1)?o$1[0]:o$1)||{}}function globalCompatStyle(option,isTheme){each$3(toArr(option.series),function(seriesOpt){isObject$2(seriesOpt)&&processSeries(seriesOpt)});var axes=[`xAxis`,`yAxis`,`radiusAxis`,`angleAxis`,`singleAxis`,`parallelAxis`,`radar`];isTheme&&axes.push(`valueAxis`,`categoryAxis`,`logAxis`,`timeAxis`),each$3(axes,function(axisName){each$3(toArr(option[axisName]),function(axisOpt){axisOpt&&(compatTextStyle(axisOpt,`axisLabel`),compatTextStyle(axisOpt.axisPointer,`label`))})}),each$3(toArr(option.parallel),function(parallelOpt){var parallelAxisDefault=parallelOpt&&parallelOpt.parallelAxisDefault;compatTextStyle(parallelAxisDefault,`axisLabel`),compatTextStyle(parallelAxisDefault&&parallelAxisDefault.axisPointer,`label`)}),each$3(toArr(option.calendar),function(calendarOpt){convertNormalEmphasis(calendarOpt,`itemStyle`),compatTextStyle(calendarOpt,`dayLabel`),compatTextStyle(calendarOpt,`monthLabel`),compatTextStyle(calendarOpt,`yearLabel`)}),each$3(toArr(option.radar),function(radarOpt){compatTextStyle(radarOpt,`name`),radarOpt.name&&radarOpt.axisName==null&&(radarOpt.axisName=radarOpt.name,delete radarOpt.name),radarOpt.nameGap!=null&&radarOpt.axisNameGap==null&&(radarOpt.axisNameGap=radarOpt.nameGap,delete radarOpt.nameGap)}),each$3(toArr(option.geo),function(geoOpt){isObject$2(geoOpt)&&(compatEC3CommonStyles(geoOpt),each$3(toArr(geoOpt.regions),function(regionObj){compatEC3CommonStyles(regionObj)}))}),each$3(toArr(option.timeline),function(timelineOpt){compatEC3CommonStyles(timelineOpt),convertNormalEmphasis(timelineOpt,`label`),convertNormalEmphasis(timelineOpt,`itemStyle`),convertNormalEmphasis(timelineOpt,`controlStyle`,!0);var data=timelineOpt.data;isArray(data)&&each(data,function(item){isObject(item)&&(convertNormalEmphasis(item,`label`),convertNormalEmphasis(item,`itemStyle`))})}),each$3(toArr(option.toolbox),function(toolboxOpt){convertNormalEmphasis(toolboxOpt,`iconStyle`),each$3(toolboxOpt.feature,function(featureOpt){convertNormalEmphasis(featureOpt,`iconStyle`)})}),compatTextStyle(toObj(option.axisPointer),`label`),compatTextStyle(toObj(option.tooltip).axisPointer,`label`)}function get(opt,path$1){for(var pathArr=path$1.split(`,`),obj=opt,i$1=0;i$1<pathArr.length&&(obj&&=obj[pathArr[i$1]],obj!=null);i$1++);return obj}function set(opt,path$1,val,overwrite){for(var pathArr=path$1.split(`,`),obj=opt,key$1,i$1=0;i$1<pathArr.length-1;i$1++)key$1=pathArr[i$1],obj[key$1]??(obj[key$1]={}),obj=obj[key$1];(overwrite||obj[pathArr[i$1]]==null)&&(obj[pathArr[i$1]]=val)}function compatLayoutProperties(option){option&&each(LAYOUT_PROPERTIES,function(prop){prop[0]in option&&!(prop[1]in option)&&(option[prop[1]]=option[prop[0]])})}var LAYOUT_PROPERTIES=[[`x`,`left`],[`y`,`top`],[`x2`,`right`],[`y2`,`bottom`]],COMPATITABLE_COMPONENTS=[`grid`,`geo`,`parallel`,`legend`,`toolbox`,`title`,`visualMap`,`dataZoom`,`timeline`],BAR_ITEM_STYLE_MAP=[[`borderRadius`,`barBorderRadius`],[`borderColor`,`barBorderColor`],[`borderWidth`,`barBorderWidth`]];function compatBarItemStyle(option){var itemStyle=option&&option.itemStyle;if(itemStyle)for(var i$1=0;i$1<BAR_ITEM_STYLE_MAP.length;i$1++){var oldName=BAR_ITEM_STYLE_MAP[i$1][1],newName=BAR_ITEM_STYLE_MAP[i$1][0];itemStyle[oldName]!=null&&(itemStyle[newName]=itemStyle[oldName])}}function compatPieLabel(option){option&&option.alignTo===`edge`&&option.margin!=null&&option.edgeDistance==null&&(option.edgeDistance=option.margin)}function compatSunburstState(option){option&&option.downplay&&!option.blur&&(option.blur=option.downplay)}function compatGraphFocus(option){option&&option.focusNodeAdjacency!=null&&(option.emphasis=option.emphasis||{},option.emphasis.focus??(option.emphasis.focus=`adjacency`))}function traverseTree(data,cb){if(data)for(var i$1=0;i$1<data.length;i$1++)cb(data[i$1]),data[i$1]&&traverseTree(data[i$1].children,cb)}function globalBackwardCompat(option,isTheme){globalCompatStyle(option,isTheme),option.series=normalizeToArray(option.series),each(option.series,function(seriesOpt){if(isObject(seriesOpt)){var seriesType$1=seriesOpt.type;if(seriesType$1===`line`)seriesOpt.clipOverflow!=null&&(seriesOpt.clip=seriesOpt.clipOverflow);else if(seriesType$1===`pie`||seriesType$1===`gauge`){seriesOpt.clockWise!=null&&(seriesOpt.clockwise=seriesOpt.clockWise),compatPieLabel(seriesOpt.label);var data=seriesOpt.data;if(data&&!isTypedArray(data))for(var i$1=0;i$1<data.length;i$1++)compatPieLabel(data[i$1]);seriesOpt.hoverOffset!=null&&(seriesOpt.emphasis=seriesOpt.emphasis||{},(seriesOpt.emphasis.scaleSize=null)&&(seriesOpt.emphasis.scaleSize=seriesOpt.hoverOffset))}else if(seriesType$1===`gauge`){var pointerColor=get(seriesOpt,`pointer.color`);pointerColor!=null&&set(seriesOpt,`itemStyle.color`,pointerColor)}else if(seriesType$1===`bar`){compatBarItemStyle(seriesOpt),compatBarItemStyle(seriesOpt.backgroundStyle),compatBarItemStyle(seriesOpt.emphasis);var data=seriesOpt.data;if(data&&!isTypedArray(data))for(var i$1=0;i$1<data.length;i$1++)typeof data[i$1]==`object`&&(compatBarItemStyle(data[i$1]),compatBarItemStyle(data[i$1]&&data[i$1].emphasis))}else if(seriesType$1===`sunburst`){var highlightPolicy=seriesOpt.highlightPolicy;highlightPolicy&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis.focus||(seriesOpt.emphasis.focus=highlightPolicy)),compatSunburstState(seriesOpt),traverseTree(seriesOpt.data,compatSunburstState)}else seriesType$1===`graph`||seriesType$1===`sankey`?compatGraphFocus(seriesOpt):seriesType$1===`map`&&(seriesOpt.mapType&&!seriesOpt.map&&(seriesOpt.map=seriesOpt.mapType),seriesOpt.mapLocation&&defaults(seriesOpt,seriesOpt.mapLocation));seriesOpt.hoverAnimation!=null&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis&&seriesOpt.emphasis.scale==null&&(seriesOpt.emphasis.scale=seriesOpt.hoverAnimation)),compatLayoutProperties(seriesOpt)}}),option.dataRange&&(option.visualMap=option.dataRange),each(COMPATITABLE_COMPONENTS,function(componentName){var options=option[componentName];options&&(isArray(options)||(options=[options]),each(options,function(option$1){compatLayoutProperties(option$1)}))})}function dataStack(ecModel){var stackInfoMap=createHashMap();ecModel.eachSeries(function(seriesModel){var stack=seriesModel.get(`stack`);if(stack){var stackInfoList=stackInfoMap.get(stack)||stackInfoMap.set(stack,[]),data=seriesModel.getData(),stackInfo={stackResultDimension:data.getCalculationInfo(`stackResultDimension`),stackedOverDimension:data.getCalculationInfo(`stackedOverDimension`),stackedDimension:data.getCalculationInfo(`stackedDimension`),stackedByDimension:data.getCalculationInfo(`stackedByDimension`),isStackedByIndex:data.getCalculationInfo(`isStackedByIndex`),data,seriesModel};if(!stackInfo.stackedDimension||!(stackInfo.isStackedByIndex||stackInfo.stackedByDimension))return;stackInfoList.push(stackInfo)}}),stackInfoMap.each(function(stackInfoList){stackInfoList.length!==0&&((stackInfoList[0].seriesModel.get(`stackOrder`)||`seriesAsc`)===`seriesDesc`&&stackInfoList.reverse(),each(stackInfoList,function(stackInfo,index){stackInfo.data.setCalculationInfo(`stackedOnSeries`,index>0?stackInfoList[index-1].seriesModel:null)}),calculateStack(stackInfoList))})}function calculateStack(stackInfoList){each(stackInfoList,function(targetStackInfo,idxInStack){var resultVal=[],resultNaN=[NaN,NaN],dims=[targetStackInfo.stackResultDimension,targetStackInfo.stackedOverDimension],targetData=targetStackInfo.data,isStackedByIndex=targetStackInfo.isStackedByIndex,stackStrategy=targetStackInfo.seriesModel.get(`stackStrategy`)||`samesign`;targetData.modify(dims,function(v0,v1,dataIndex){var sum=targetData.get(targetStackInfo.stackedDimension,dataIndex);if(isNaN(sum))return resultNaN;var byValue,stackedDataRawIndex;isStackedByIndex?stackedDataRawIndex=targetData.getRawIndex(dataIndex):byValue=targetData.get(targetStackInfo.stackedByDimension,dataIndex);for(var stackedOver=NaN,j$1=idxInStack-1;j$1>=0;j$1--){var stackInfo=stackInfoList[j$1];if(isStackedByIndex||(stackedDataRawIndex=stackInfo.data.rawIndexOf(stackInfo.stackedByDimension,byValue)),stackedDataRawIndex>=0){var val=stackInfo.data.getByRawIndex(stackInfo.stackResultDimension,stackedDataRawIndex);if(stackStrategy===`all`||stackStrategy===`positive`&&val>0||stackStrategy===`negative`&&val<0||stackStrategy===`samesign`&&sum>=0&&val>0||stackStrategy===`samesign`&&sum<=0&&val<0){sum=addSafe(sum,val),stackedOver=val;break}}}return resultVal[0]=sum,resultVal[1]=stackedOver,resultVal})})}var SourceImpl=function(){function SourceImpl$1(fields){this.data=fields.data||(fields.sourceFormat===`keyedColumns`?{}:[]),this.sourceFormat=fields.sourceFormat||`unknown`,this.seriesLayoutBy=fields.seriesLayoutBy||`column`,this.startIndex=fields.startIndex||0,this.dimensionsDetectedCount=fields.dimensionsDetectedCount,this.metaRawOption=fields.metaRawOption;var dimensionsDefine=this.dimensionsDefine=fields.dimensionsDefine;if(dimensionsDefine)for(var i$1=0;i$1<dimensionsDefine.length;i$1++){var dim=dimensionsDefine[i$1];dim.type==null&&guessOrdinal(this,i$1)===BE_ORDINAL.Must&&(dim.type=`ordinal`)}}return SourceImpl$1}();function isSourceInstance(val){return val instanceof SourceImpl}function createSource(sourceData,thisMetaRawOption,sourceFormat){sourceFormat||=detectSourceFormat(sourceData);var seriesLayoutBy=thisMetaRawOption.seriesLayoutBy,determined=determineSourceDimensions(sourceData,sourceFormat,seriesLayoutBy,thisMetaRawOption.sourceHeader,thisMetaRawOption.dimensions);return new SourceImpl({data:sourceData,sourceFormat,seriesLayoutBy,dimensionsDefine:determined.dimensionsDefine,startIndex:determined.startIndex,dimensionsDetectedCount:determined.dimensionsDetectedCount,metaRawOption:clone(thisMetaRawOption)})}function createSourceFromSeriesDataOption(data){return new SourceImpl({data,sourceFormat:isTypedArray(data)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL})}function cloneSourceShallow(source$2){return new SourceImpl({data:source$2.data,sourceFormat:source$2.sourceFormat,seriesLayoutBy:source$2.seriesLayoutBy,dimensionsDefine:clone(source$2.dimensionsDefine),startIndex:source$2.startIndex,dimensionsDetectedCount:source$2.dimensionsDetectedCount})}function detectSourceFormat(data){var sourceFormat=SOURCE_FORMAT_UNKNOWN;if(isTypedArray(data))sourceFormat=SOURCE_FORMAT_TYPED_ARRAY;else if(isArray(data)){data.length===0&&(sourceFormat=SOURCE_FORMAT_ARRAY_ROWS);for(var i$1=0,len$1=data.length;i$1<len$1;i$1++){var item=data[i$1];if(item!=null){if(isArray(item)||isTypedArray(item)){sourceFormat=SOURCE_FORMAT_ARRAY_ROWS;break}else if(isObject(item)){sourceFormat=SOURCE_FORMAT_OBJECT_ROWS;break}}}}else if(isObject(data)){for(var key$1 in data)if(hasOwn(data,key$1)&&isArrayLike(data[key$1])){sourceFormat=SOURCE_FORMAT_KEYED_COLUMNS;break}}return sourceFormat}function determineSourceDimensions(data,sourceFormat,seriesLayoutBy,sourceHeader,dimensionsDefine){var dimensionsDetectedCount,startIndex;if(!data)return{dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),startIndex,dimensionsDetectedCount};if(sourceFormat===`arrayRows`){var dataArrayRows=data;sourceHeader===`auto`||sourceHeader==null?arrayRowsTravelFirst(function(val){val!=null&&val!==`-`&&(isString(val)?startIndex??=1:startIndex=0)},seriesLayoutBy,dataArrayRows,10):startIndex=isNumber(sourceHeader)?sourceHeader:sourceHeader?1:0,!dimensionsDefine&&startIndex===1&&(dimensionsDefine=[],arrayRowsTravelFirst(function(val,index){dimensionsDefine[index]=val==null?``:val+``},seriesLayoutBy,dataArrayRows,1/0)),dimensionsDetectedCount=dimensionsDefine?dimensionsDefine.length:seriesLayoutBy===`row`?dataArrayRows.length:dataArrayRows[0]?dataArrayRows[0].length:null}else if(sourceFormat===`objectRows`)dimensionsDefine||=objectRowsCollectDimensions(data);else if(sourceFormat===`keyedColumns`)dimensionsDefine||(dimensionsDefine=[],each(data,function(colArr,key$1){dimensionsDefine.push(key$1)}));else if(sourceFormat===`original`){var value0=getDataItemValue(data[0]);dimensionsDetectedCount=isArray(value0)&&value0.length||1}return{startIndex,dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),dimensionsDetectedCount}}function objectRowsCollectDimensions(data){for(var firstIndex=0,obj;firstIndex<data.length&&!(obj=data[firstIndex++]););if(obj)return keys(obj)}function normalizeDimensionsOption(dimensionsDefine){if(dimensionsDefine){var nameMap=createHashMap();return map(dimensionsDefine,function(rawItem,index){rawItem=isObject(rawItem)?rawItem:{name:rawItem};var item={name:rawItem.name,displayName:rawItem.displayName,type:rawItem.type};if(item.name==null)return item;item.name+=``,item.displayName??=item.name;var exist=nameMap.get(item.name);return exist?item.name+=`-`+ exist.count++:nameMap.set(item.name,{count:1}),item})}}function arrayRowsTravelFirst(cb,seriesLayoutBy,data,maxLoop){if(seriesLayoutBy===`row`)for(var i$1=0;i$1<data.length&&i$1<maxLoop;i$1++)cb(data[i$1]?data[i$1][0]:null,i$1);else for(var value0=data[0]||[],i$1=0;i$1<value0.length&&i$1<maxLoop;i$1++)cb(value0[i$1],i$1)}function shouldRetrieveDataByName(source$2){var sourceFormat=source$2.sourceFormat;return sourceFormat===`objectRows`||sourceFormat===`keyedColumns`}var _a,_b,_c,_d,providerMethods,mountMethods,DefaultDataProvider=function(){function DefaultDataProvider$1(sourceParam,dimSize){var source$2=isSourceInstance(sourceParam)?sourceParam:createSourceFromSeriesDataOption(sourceParam);this._source=source$2;var data=this._data=source$2.data,sourceFormat=source$2.sourceFormat;source$2.seriesLayoutBy,sourceFormat===`typedArray`&&(this._offset=0,this._dimSize=dimSize,this._data=data),mountMethods(this,data,source$2)}return DefaultDataProvider$1.prototype.getSource=function(){return this._source},DefaultDataProvider$1.prototype.count=function(){return 0},DefaultDataProvider$1.prototype.getItem=function(idx,out$2){},DefaultDataProvider$1.prototype.appendData=function(newData){},DefaultDataProvider$1.prototype.clean=function(){},DefaultDataProvider$1.protoInitialize=function(){var proto=DefaultDataProvider$1.prototype;proto.pure=!1,proto.persistent=!0}(),DefaultDataProvider$1.internalField=function(){var _a$1;mountMethods=function(provider,data,source$2){var sourceFormat=source$2.sourceFormat,seriesLayoutBy=source$2.seriesLayoutBy,startIndex=source$2.startIndex,dimsDef=source$2.dimensionsDefine,methods=providerMethods[getMethodMapKey(sourceFormat,seriesLayoutBy)];if(extend(provider,methods),sourceFormat===`typedArray`)provider.getItem=getItemForTypedArray,provider.count=countForTypedArray,provider.fillStorage=fillStorageForTypedArray;else{var rawItemGetter=getRawSourceItemGetter(sourceFormat,seriesLayoutBy);provider.getItem=bind(rawItemGetter,null,data,startIndex,dimsDef);var rawCounter=getRawSourceDataCounter(sourceFormat,seriesLayoutBy);provider.count=bind(rawCounter,null,data,startIndex,dimsDef)}};var getItemForTypedArray=function(idx,out$2){idx-=this._offset,out$2||=[];for(var data=this._data,dimSize=this._dimSize,offset=dimSize*idx,i$1=0;i$1<dimSize;i$1++)out$2[i$1]=data[offset+i$1];return out$2},fillStorageForTypedArray=function(start$1,end$1,storage,extent){for(var data=this._data,dimSize=this._dimSize,dim=0;dim<dimSize;dim++){for(var dimExtent=extent[dim],min$2=dimExtent[0]==null?1/0:dimExtent[0],max$2=dimExtent[1]==null?-1/0:dimExtent[1],count$1=end$1-start$1,arr=storage[dim],i$1=0;i$1<count$1;i$1++){var val=data[i$1*dimSize+dim];arr[start$1+i$1]=val,val<min$2&&(min$2=val),val>max$2&&(max$2=val)}dimExtent[0]=min$2,dimExtent[1]=max$2}},countForTypedArray=function(){return this._data?this._data.length/this._dimSize:0};providerMethods=(_a$1={},_a$1[SOURCE_FORMAT_ARRAY_ROWS+`_`+SERIES_LAYOUT_BY_COLUMN]={pure:!0,appendData:appendDataSimply},_a$1[SOURCE_FORMAT_ARRAY_ROWS+`_row`]={pure:!0,appendData:function(){throw Error(`Do not support appendData when set seriesLayoutBy: "row".`)}},_a$1[SOURCE_FORMAT_OBJECT_ROWS]={pure:!0,appendData:appendDataSimply},_a$1[SOURCE_FORMAT_KEYED_COLUMNS]={pure:!0,appendData:function(newData){var data=this._data;each(newData,function(newCol,key$1){for(var oldCol=data[key$1]||(data[key$1]=[]),i$1=0;i$1<(newCol||[]).length;i$1++)oldCol.push(newCol[i$1])})}},_a$1[SOURCE_FORMAT_ORIGINAL]={appendData:appendDataSimply},_a$1[SOURCE_FORMAT_TYPED_ARRAY]={persistent:!1,pure:!0,appendData:function(newData){this._data=newData},clean:function(){this._offset+=this.count(),this._data=null}},_a$1);function appendDataSimply(newData){for(var i$1=0;i$1<newData.length;i$1++)this._data.push(newData[i$1])}}(),DefaultDataProvider$1}(),validateSimply=function(rawData){isArray(rawData)||error(`series.data or dataset.source must be an array.`)};_a={},_a[SOURCE_FORMAT_ARRAY_ROWS+`_`+SERIES_LAYOUT_BY_COLUMN]=validateSimply,_a[SOURCE_FORMAT_ARRAY_ROWS+`_row`]=validateSimply,_a[SOURCE_FORMAT_OBJECT_ROWS]=validateSimply,_a[SOURCE_FORMAT_KEYED_COLUMNS]=function(rawData,dimsDef){for(var i$1=0;i$1<dimsDef.length;i$1++)dimsDef[i$1].name??error(`dimension name must not be null/undefined.`)},_a[SOURCE_FORMAT_ORIGINAL]=validateSimply;var getItemSimply=function(rawData,startIndex,dimsDef,idx){return rawData[idx]},rawSourceItemGetterMap=(_b={},_b[SOURCE_FORMAT_ARRAY_ROWS+`_`+SERIES_LAYOUT_BY_COLUMN]=function(rawData,startIndex,dimsDef,idx){return rawData[idx+startIndex]},_b[SOURCE_FORMAT_ARRAY_ROWS+`_row`]=function(rawData,startIndex,dimsDef,idx,out$2){idx+=startIndex;for(var item=out$2||[],data=rawData,i$1=0;i$1<data.length;i$1++){var row=data[i$1];item[i$1]=row?row[idx]:null}return item},_b[SOURCE_FORMAT_OBJECT_ROWS]=getItemSimply,_b[SOURCE_FORMAT_KEYED_COLUMNS]=function(rawData,startIndex,dimsDef,idx,out$2){for(var item=out$2||[],i$1=0;i$1<dimsDef.length;i$1++){var dimName=dimsDef[i$1].name,col=dimName==null?null:rawData[dimName];item[i$1]=col?col[idx]:null}return item},_b[SOURCE_FORMAT_ORIGINAL]=getItemSimply,_b);function getRawSourceItemGetter(sourceFormat,seriesLayoutBy){return rawSourceItemGetterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)]}var countSimply=function(rawData,startIndex,dimsDef){return rawData.length},rawSourceDataCounterMap=(_c={},_c[SOURCE_FORMAT_ARRAY_ROWS+`_`+SERIES_LAYOUT_BY_COLUMN]=function(rawData,startIndex,dimsDef){return Math.max(0,rawData.length-startIndex)},_c[SOURCE_FORMAT_ARRAY_ROWS+`_row`]=function(rawData,startIndex,dimsDef){var row=rawData[0];return row?Math.max(0,row.length-startIndex):0},_c[SOURCE_FORMAT_OBJECT_ROWS]=countSimply,_c[SOURCE_FORMAT_KEYED_COLUMNS]=function(rawData,startIndex,dimsDef){var dimName=dimsDef[0].name,col=dimName==null?null:rawData[dimName];return col?col.length:0},_c[SOURCE_FORMAT_ORIGINAL]=countSimply,_c);function getRawSourceDataCounter(sourceFormat,seriesLayoutBy){return rawSourceDataCounterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)]}var getRawValueSimply=function(dataItem,dimIndex,property){return dataItem[dimIndex]},rawSourceValueGetterMap=(_d={},_d[SOURCE_FORMAT_ARRAY_ROWS]=getRawValueSimply,_d[SOURCE_FORMAT_OBJECT_ROWS]=function(dataItem,dimIndex,property){return dataItem[property]},_d[SOURCE_FORMAT_KEYED_COLUMNS]=getRawValueSimply,_d[SOURCE_FORMAT_ORIGINAL]=function(dataItem,dimIndex,property){var value=getDataItemValue(dataItem);return value instanceof Array?value[dimIndex]:value},_d[SOURCE_FORMAT_TYPED_ARRAY]=getRawValueSimply,_d);function getRawSourceValueGetter(sourceFormat){return rawSourceValueGetterMap[sourceFormat]}function getMethodMapKey(sourceFormat,seriesLayoutBy){return sourceFormat===`arrayRows`?sourceFormat+`_`+seriesLayoutBy:sourceFormat}function retrieveRawValue(data,dataIndex,dim){if(data){var dataItem=data.getRawDataItem(dataIndex);if(dataItem!=null){var store=data.getStore(),sourceFormat=store.getSource().sourceFormat;if(dim!=null){var dimIndex=data.getDimensionIndex(dim),property=store.getDimensionProperty(dimIndex);return getRawSourceValueGetter(sourceFormat)(dataItem,dimIndex,property)}else{var result=dataItem;return sourceFormat===`original`&&(result=getDataItemValue(dataItem)),result}}}}var DIMENSION_LABEL_REG=/\{@(.+?)\}/g,DataFormatMixin=function(){function DataFormatMixin$1(){}return DataFormatMixin$1.prototype.getDataParams=function(dataIndex,dataType){var data=this.getData(dataType),rawValue=this.getRawValue(dataIndex,dataType),rawDataIndex=data.getRawIndex(dataIndex),name=data.getName(dataIndex),itemOpt=data.getRawDataItem(dataIndex),style=data.getItemVisual(dataIndex,`style`),color$2=style&&style[data.getItemVisual(dataIndex,`drawType`)||`fill`],borderColor=style&&style.stroke,mainType=this.mainType,isSeries$1=mainType===`series`,userOutput=data.userOutput&&data.userOutput.get();return{componentType:mainType,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:isSeries$1?this.subType:null,seriesIndex:this.seriesIndex,seriesId:isSeries$1?this.id:null,seriesName:isSeries$1?this.name:null,name,dataIndex:rawDataIndex,data:itemOpt,dataType,value:rawValue,color:color$2,borderColor,dimensionNames:userOutput?userOutput.fullDimensions:null,encode:userOutput?userOutput.encode:null,$vars:[`seriesName`,`name`,`value`]}},DataFormatMixin$1.prototype.getFormattedLabel=function(dataIndex,status,dataType,labelDimIndex,formatter,extendParams){status||=`normal`;var data=this.getData(dataType),params=this.getDataParams(dataIndex,dataType);if(extendParams&&(params.value=extendParams.interpolatedValue),labelDimIndex!=null&&isArray(params.value)&&(params.value=params.value[labelDimIndex]),formatter||=data.getItemModel(dataIndex).get(status===`normal`?[`label`,`formatter`]:[status,`label`,`formatter`]),isFunction(formatter))return params.status=status,params.dimensionIndex=labelDimIndex,formatter(params);if(isString(formatter))return formatTpl(formatter,params).replace(DIMENSION_LABEL_REG,function(origin,dimStr){var len$1=dimStr.length,dimLoose=dimStr;dimLoose.charAt(0)===`[`&&dimLoose.charAt(len$1-1)===`]`&&(dimLoose=+dimLoose.slice(1,len$1-1));var val=retrieveRawValue(data,dataIndex,dimLoose);if(extendParams&&isArray(extendParams.interpolatedValue)){var dimIndex=data.getDimensionIndex(dimLoose);dimIndex>=0&&(val=extendParams.interpolatedValue[dimIndex])}return val==null?``:val+``})},DataFormatMixin$1.prototype.getRawValue=function(idx,dataType){return retrieveRawValue(this.getData(dataType),idx)},DataFormatMixin$1.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){},DataFormatMixin$1}();function normalizeTooltipFormatResult(result){var markupText,markupFragment;return isObject(result)?result.type&&(markupFragment=result):markupText=result,{text:markupText,frag:markupFragment}}function createTask(define$1){return new Task(define$1)}var Task=function(){function Task$1(define$1){define$1||={},this._reset=define$1.reset,this._plan=define$1.plan,this._count=define$1.count,this._onDirty=define$1.onDirty,this._dirty=!0}return Task$1.prototype.perform=function(performArgs){var upTask=this._upstream,skip=performArgs&&performArgs.skip;if(this._dirty&&upTask){var context$1=this.context;context$1.data=context$1.outputData=upTask.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var planResult;this._plan&&!skip&&(planResult=this._plan(this.context));var lastModBy=normalizeModBy(this._modBy),lastModDataCount=this._modDataCount||0,modBy=normalizeModBy(performArgs&&performArgs.modBy),modDataCount=performArgs&&performArgs.modDataCount||0;(lastModBy!==modBy||lastModDataCount!==modDataCount)&&(planResult=`reset`);function normalizeModBy(val){return!(val>=1)&&(val=1),val}var forceFirstProgress;(this._dirty||planResult===`reset`)&&(this._dirty=!1,forceFirstProgress=this._doReset(skip)),this._modBy=modBy,this._modDataCount=modDataCount;var step=performArgs&&performArgs.step;if(upTask?this._dueEnd=upTask._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var start$1=this._dueIndex,end$1=Math.min(step==null?1/0:this._dueIndex+step,this._dueEnd);if(!skip&&(forceFirstProgress||start$1<end$1)){var progress=this._progress;if(isArray(progress))for(var i$1=0;i$1<progress.length;i$1++)this._doProgress(progress[i$1],start$1,end$1,modBy,modDataCount);else this._doProgress(progress,start$1,end$1,modBy,modDataCount)}this._dueIndex=end$1,this._outputDueEnd=this._settedOutputEnd==null?end$1:this._settedOutputEnd}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd==null?this._dueEnd:this._settedOutputEnd;return this.unfinished()},Task$1.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},Task$1.prototype._doProgress=function(progress,start$1,end$1,modBy,modDataCount){iterator.reset(start$1,end$1,modBy,modDataCount),this._callingProgress=progress,this._callingProgress({start:start$1,end:end$1,count:end$1-start$1,next:iterator.next},this.context)},Task$1.prototype._doReset=function(skip){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var progress,forceFirstProgress;!skip&&this._reset&&(progress=this._reset(this.context),progress&&progress.progress&&(forceFirstProgress=progress.forceFirstProgress,progress=progress.progress),isArray(progress)&&!progress.length&&(progress=null)),this._progress=progress,this._modBy=this._modDataCount=null;var downstream=this._downstream;return downstream&&downstream.dirty(),forceFirstProgress},Task$1.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},Task$1.prototype.pipe=function(downTask){(this._downstream!==downTask||this._dirty)&&(this._downstream=downTask,downTask._upstream=this,downTask.dirty())},Task$1.prototype.dispose=function(){this._disposed||=(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,!0)},Task$1.prototype.getUpstream=function(){return this._upstream},Task$1.prototype.getDownstream=function(){return this._downstream},Task$1.prototype.setOutputEnd=function(end$1){this._outputDueEnd=this._settedOutputEnd=end$1},Task$1}(),iterator=function(){var end$1,current,modBy,modDataCount,winCount,it={reset:function(s$1,e$2,sStep,sCount){current=s$1,end$1=e$2,modBy=sStep,modDataCount=sCount,winCount=Math.ceil(modDataCount/modBy),it.next=modBy>1&&modDataCount>0?modNext:sequentialNext}};return it;function sequentialNext(){return current<end$1?current++:null}function modNext(){var dataIndex=current%winCount*modBy+Math.ceil(current/winCount),result=current>=end$1?null:dataIndex<modDataCount?dataIndex:current;return current++,result}}();function parseDataValue(value,opt){var dimType=opt&&opt.type;return dimType===`ordinal`?value:(dimType===`time`&&!isNumber(value)&&value!=null&&value!==`-`&&(value=+parseDate(value)),value==null||value===``?NaN:Number(value))}var valueParserMap=createHashMap({number:function(val){return parseFloat(val)},time:function(val){return+parseDate(val)},trim:function(val){return isString(val)?trim(val):val}}),ORDER_COMPARISON_OP_MAP={lt:function(lval,rval){return lval<rval},lte:function(lval,rval){return lval<=rval},gt:function(lval,rval){return lval>rval},gte:function(lval,rval){return lval>=rval}},FilterOrderComparator=function(){function FilterOrderComparator$1(op,rval){isNumber(rval)||throwError(``),this._opFn=ORDER_COMPARISON_OP_MAP[op],this._rvalFloat=numericToNumber(rval)}return FilterOrderComparator$1.prototype.evaluate=function(lval){return isNumber(lval)?this._opFn(lval,this._rvalFloat):this._opFn(numericToNumber(lval),this._rvalFloat)},FilterOrderComparator$1}(),SortOrderComparator=function(){function SortOrderComparator$1(order,incomparable){var isDesc=order===`desc`;this._resultLT=isDesc?1:-1,incomparable??=isDesc?`min`:`max`,this._incomparable=incomparable===`min`?-1/0:1/0}return SortOrderComparator$1.prototype.evaluate=function(lval,rval){var lvalFloat=isNumber(lval)?lval:numericToNumber(lval),rvalFloat=isNumber(rval)?rval:numericToNumber(rval),lvalNotNumeric=isNaN(lvalFloat),rvalNotNumeric=isNaN(rvalFloat);if(lvalNotNumeric&&(lvalFloat=this._incomparable),rvalNotNumeric&&(rvalFloat=this._incomparable),lvalNotNumeric&&rvalNotNumeric){var lvalIsStr=isString(lval),rvalIsStr=isString(rval);lvalIsStr&&(lvalFloat=rvalIsStr?lval:0),rvalIsStr&&(rvalFloat=lvalIsStr?rval:0)}return lvalFloat<rvalFloat?this._resultLT:lvalFloat>rvalFloat?-this._resultLT:0},SortOrderComparator$1}(),FilterEqualityComparator=function(){function FilterEqualityComparator$1(isEq,rval){this._rval=rval,this._isEQ=isEq,this._rvalTypeof=typeof rval,this._rvalFloat=numericToNumber(rval)}return FilterEqualityComparator$1.prototype.evaluate=function(lval){var eqResult=lval===this._rval;if(!eqResult){var lvalTypeof=typeof lval;lvalTypeof!==this._rvalTypeof&&(lvalTypeof===`number`||this._rvalTypeof===`number`)&&(eqResult=numericToNumber(lval)===this._rvalFloat)}return this._isEQ?eqResult:!eqResult},FilterEqualityComparator$1}(),ExternalSource=function(){function ExternalSource$1(){}return ExternalSource$1.prototype.getRawData=function(){throw Error(`not supported`)},ExternalSource$1.prototype.getRawDataItem=function(dataIndex){throw Error(`not supported`)},ExternalSource$1.prototype.cloneRawData=function(){},ExternalSource$1.prototype.getDimensionInfo=function(dim){},ExternalSource$1.prototype.cloneAllDimensionInfo=function(){},ExternalSource$1.prototype.count=function(){},ExternalSource$1.prototype.retrieveValue=function(dataIndex,dimIndex){},ExternalSource$1.prototype.retrieveValueFromItem=function(dataItem,dimIndex){},ExternalSource$1.prototype.convertValue=function(rawVal,dimInfo){return parseDataValue(rawVal,dimInfo)},ExternalSource$1}();function createExternalSource(internalSource,externalTransform){var extSource=new ExternalSource,data=internalSource.data,sourceFormat=extSource.sourceFormat=internalSource.sourceFormat,sourceHeaderCount=internalSource.startIndex;internalSource.seriesLayoutBy!==`column`&&throwError(``);var dimensions=[],dimsByName={},dimsDef=internalSource.dimensionsDefine;if(dimsDef)each(dimsDef,function(dimDef,idx){var name=dimDef.name,dimDefExt={index:idx,name,displayName:dimDef.displayName};dimensions.push(dimDefExt),name!=null&&(hasOwn(dimsByName,name)&&throwError(``),dimsByName[name]=dimDefExt)});else for(var i$1=0;i$1<internalSource.dimensionsDetectedCount;i$1++)dimensions.push({index:i$1});var rawItemGetter=getRawSourceItemGetter(sourceFormat,SERIES_LAYOUT_BY_COLUMN);externalTransform.__isBuiltIn&&(extSource.getRawDataItem=function(dataIndex){return rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex)},extSource.getRawData=bind(getRawData,null,internalSource)),extSource.cloneRawData=bind(cloneRawData,null,internalSource);var rawCounter=getRawSourceDataCounter(sourceFormat,SERIES_LAYOUT_BY_COLUMN);extSource.count=bind(rawCounter,null,data,sourceHeaderCount,dimensions);var rawValueGetter=getRawSourceValueGetter(sourceFormat);extSource.retrieveValue=function(dataIndex,dimIndex){var rawItem=rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex);return retrieveValueFromItem(rawItem,dimIndex)};var retrieveValueFromItem=extSource.retrieveValueFromItem=function(dataItem,dimIndex){if(dataItem!=null){var dimDef=dimensions[dimIndex];if(dimDef)return rawValueGetter(dataItem,dimIndex,dimDef.name)}};return extSource.getDimensionInfo=bind(getDimensionInfo,null,dimensions,dimsByName),extSource.cloneAllDimensionInfo=bind(cloneAllDimensionInfo,null,dimensions),extSource}function getRawData(upstream){var sourceFormat=upstream.sourceFormat;return isSupportedSourceFormat(sourceFormat)||throwError(``),upstream.data}function cloneRawData(upstream){var sourceFormat=upstream.sourceFormat,data=upstream.data;if(isSupportedSourceFormat(sourceFormat)||throwError(``),sourceFormat===`arrayRows`){for(var result=[],i$1=0,len$1=data.length;i$1<len$1;i$1++)result.push(data[i$1].slice());return result}else if(sourceFormat===`objectRows`){for(var result=[],i$1=0,len$1=data.length;i$1<len$1;i$1++)result.push(extend({},data[i$1]));return result}}function getDimensionInfo(dimensions,dimsByName,dim){if(dim!=null){if(isNumber(dim)||!isNaN(dim)&&!hasOwn(dimsByName,dim))return dimensions[dim];if(hasOwn(dimsByName,dim))return dimsByName[dim]}}function cloneAllDimensionInfo(dimensions){return clone(dimensions)}var externalTransformMap=createHashMap();function registerExternalTransform(externalTransform){externalTransform=clone(externalTransform);var type=externalTransform.type,errMsg=``;type||throwError(errMsg);var typeParsed=type.split(`:`);typeParsed.length!==2&&throwError(errMsg);var isBuiltIn=!1;typeParsed[0]===`echarts`&&(type=typeParsed[1],isBuiltIn=!0),externalTransform.__isBuiltIn=isBuiltIn,externalTransformMap.set(type,externalTransform)}function applyDataTransform(rawTransOption,sourceList,infoForPrint){var pipedTransOption=normalizeToArray(rawTransOption),pipeLen=pipedTransOption.length;pipeLen||throwError(``);for(var i$1=0,len$1=pipeLen;i$1<len$1;i$1++){var transOption=pipedTransOption[i$1];sourceList=applySingleDataTransform(transOption,sourceList,infoForPrint,pipeLen===1?null:i$1),i$1!==len$1-1&&(sourceList.length=Math.max(sourceList.length,1))}return sourceList}function applySingleDataTransform(transOption,upSourceList,infoForPrint,pipeIndex){var errMsg=``;upSourceList.length||throwError(errMsg),isObject(transOption)||throwError(errMsg);var transType=transOption.type,externalTransform=externalTransformMap.get(transType);externalTransform||throwError(errMsg);var extUpSourceList=map(upSourceList,function(upSource){return createExternalSource(upSource,externalTransform)}),resultList=normalizeToArray(externalTransform.transform({upstream:extUpSourceList[0],upstreamList:extUpSourceList,config:clone(transOption.config)}));return map(resultList,function(result,resultIndex){var errMsg$1=``;isObject(result)||throwError(errMsg$1),result.data||throwError(errMsg$1);var sourceFormat=detectSourceFormat(result.data);isSupportedSourceFormat(sourceFormat)||throwError(errMsg$1);var resultMetaRawOption,firstUpSource=upSourceList[0];if(firstUpSource&&resultIndex===0&&!result.dimensions){var startIndex=firstUpSource.startIndex;startIndex&&(result.data=firstUpSource.data.slice(0,startIndex).concat(result.data)),resultMetaRawOption={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:startIndex,dimensions:firstUpSource.metaRawOption.dimensions}}else resultMetaRawOption={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:0,dimensions:result.dimensions};return createSource(result.data,resultMetaRawOption,null)})}function isSupportedSourceFormat(sourceFormat){return sourceFormat===`arrayRows`||sourceFormat===`objectRows`}var UNDEFINED=`undefined`,CtorUint32Array=typeof Uint32Array===UNDEFINED?Array:Uint32Array,CtorUint16Array=typeof Uint16Array===UNDEFINED?Array:Uint16Array,CtorInt32Array=typeof Int32Array===UNDEFINED?Array:Int32Array,CtorFloat64Array=typeof Float64Array===UNDEFINED?Array:Float64Array,dataCtors={float:CtorFloat64Array,int:CtorInt32Array,ordinal:Array,number:Array,time:CtorFloat64Array},defaultDimValueGetters;function getIndicesCtor(rawCount){return rawCount>65535?CtorUint32Array:CtorUint16Array}function getInitialExtent(){return[1/0,-1/0]}function cloneChunk(originalChunk){var Ctor=originalChunk.constructor;return Ctor===Array?originalChunk.slice():new Ctor(originalChunk)}function prepareStore(store,dimIdx,dimType,end$1,append){var DataCtor=dataCtors[dimType||`float`];if(append){var oldStore=store[dimIdx],oldLen=oldStore&&oldStore.length;if(oldLen!==end$1){for(var newStore=new DataCtor(end$1),j$1=0;j$1<oldLen;j$1++)newStore[j$1]=oldStore[j$1];store[dimIdx]=newStore}}else store[dimIdx]=new DataCtor(end$1)}var DataStore_default=function(){function DataStore$1(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=createHashMap()}return DataStore$1.prototype.initData=function(provider,inputDimensions,dimValueGetter){this._provider=provider,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var source$2=provider.getSource(),defaultGetter=this.defaultDimValueGetter=defaultDimValueGetters[source$2.sourceFormat];this._dimValueGetter=dimValueGetter||defaultGetter,this._rawExtent=[],shouldRetrieveDataByName(source$2),this._dimensions=map(inputDimensions,function(dim){return{type:dim.type,property:dim.property}}),this._initDataFromProvider(0,provider.count())},DataStore$1.prototype.getProvider=function(){return this._provider},DataStore$1.prototype.getSource=function(){return this._provider.getSource()},DataStore$1.prototype.ensureCalculationDimension=function(dimName,type){var calcDimNameToIdx=this._calcDimNameToIdx,dimensions=this._dimensions,calcDimIdx=calcDimNameToIdx.get(dimName);if(calcDimIdx!=null){if(dimensions[calcDimIdx].type===type)return calcDimIdx}else calcDimIdx=dimensions.length;return dimensions[calcDimIdx]={type},calcDimNameToIdx.set(dimName,calcDimIdx),this._chunks[calcDimIdx]=new dataCtors[type||`float`](this._rawCount),this._rawExtent[calcDimIdx]=getInitialExtent(),calcDimIdx},DataStore$1.prototype.collectOrdinalMeta=function(dimIdx,ordinalMeta){var chunk=this._chunks[dimIdx],dim=this._dimensions[dimIdx],rawExtents=this._rawExtent,offset=dim.ordinalOffset||0,len$1=chunk.length;offset===0&&(rawExtents[dimIdx]=getInitialExtent());for(var dimRawExtent=rawExtents[dimIdx],i$1=offset;i$1<len$1;i$1++){var val=chunk[i$1]=ordinalMeta.parseAndCollect(chunk[i$1]);isNaN(val)||(dimRawExtent[0]=Math.min(val,dimRawExtent[0]),dimRawExtent[1]=Math.max(val,dimRawExtent[1]))}dim.ordinalMeta=ordinalMeta,dim.ordinalOffset=len$1,dim.type=`ordinal`},DataStore$1.prototype.getOrdinalMeta=function(dimIdx){return this._dimensions[dimIdx].ordinalMeta},DataStore$1.prototype.getDimensionProperty=function(dimIndex){var item=this._dimensions[dimIndex];return item&&item.property},DataStore$1.prototype.appendData=function(data){var provider=this._provider,start$1=this.count();provider.appendData(data);var end$1=provider.count();return provider.persistent||(end$1+=start$1),start$1<end$1&&this._initDataFromProvider(start$1,end$1,!0),[start$1,end$1]},DataStore$1.prototype.appendValues=function(values,minFillLen){for(var chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,start$1=this.count(),end$1=start$1+Math.max(values.length,minFillLen||0),i$1=0;i$1<dimLen;i$1++){var dim=dimensions[i$1];prepareStore(chunks,i$1,dim.type,end$1,!0)}for(var emptyDataItem=[],idx=start$1;idx<end$1;idx++)for(var sourceIdx=idx-start$1,dimIdx=0;dimIdx<dimLen;dimIdx++){var dim=dimensions[dimIdx],val=defaultDimValueGetters.arrayRows.call(this,values[sourceIdx]||emptyDataItem,dim.property,sourceIdx,dimIdx);chunks[dimIdx][idx]=val;var dimRawExtent=rawExtent[dimIdx];val<dimRawExtent[0]&&(dimRawExtent[0]=val),val>dimRawExtent[1]&&(dimRawExtent[1]=val)}return this._rawCount=this._count=end$1,{start:start$1,end:end$1}},DataStore$1.prototype._initDataFromProvider=function(start$1,end$1,append){for(var provider=this._provider,chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,dimNames=map(dimensions,function(dim$1){return dim$1.property}),i$1=0;i$1<dimLen;i$1++){var dim=dimensions[i$1];rawExtent[i$1]||(rawExtent[i$1]=getInitialExtent()),prepareStore(chunks,i$1,dim.type,end$1,append)}if(provider.fillStorage)provider.fillStorage(start$1,end$1,chunks,rawExtent);else for(var dataItem=[],idx=start$1;idx<end$1;idx++){dataItem=provider.getItem(idx,dataItem);for(var dimIdx=0;dimIdx<dimLen;dimIdx++){var dimStorage=chunks[dimIdx],val=this._dimValueGetter(dataItem,dimNames[dimIdx],idx,dimIdx);dimStorage[idx]=val;var dimRawExtent=rawExtent[dimIdx];val<dimRawExtent[0]&&(dimRawExtent[0]=val),val>dimRawExtent[1]&&(dimRawExtent[1]=val)}}!provider.persistent&&provider.clean&&provider.clean(),this._rawCount=this._count=end$1,this._extent=[]},DataStore$1.prototype.count=function(){return this._count},DataStore$1.prototype.get=function(dim,idx){if(!(idx>=0&&idx<this._count))return NaN;var dimStore=this._chunks[dim];return dimStore?dimStore[this.getRawIndex(idx)]:NaN},DataStore$1.prototype.getValues=function(dimensions,idx){var values=[],dimArr=[];if(idx==null){idx=dimensions,dimensions=[];for(var i$1=0;i$1<this._dimensions.length;i$1++)dimArr.push(i$1)}else dimArr=dimensions;for(var i$1=0,len$1=dimArr.length;i$1<len$1;i$1++)values.push(this.get(dimArr[i$1],idx));return values},DataStore$1.prototype.getByRawIndex=function(dim,rawIdx){if(!(rawIdx>=0&&rawIdx<this._rawCount))return NaN;var dimStore=this._chunks[dim];return dimStore?dimStore[rawIdx]:NaN},DataStore$1.prototype.getSum=function(dim){var dimData=this._chunks[dim],sum=0;if(dimData)for(var i$1=0,len$1=this.count();i$1<len$1;i$1++){var value=this.get(dim,i$1);isNaN(value)||(sum+=value)}return sum},DataStore$1.prototype.getMedian=function(dim){var dimDataArray=[];this.each([dim],function(val){isNaN(val)||dimDataArray.push(val)});var sortedDimDataArray=dimDataArray.sort(function(a$1,b$1){return a$1-b$1}),len$1=this.count();return len$1===0?0:len$1%2==1?sortedDimDataArray[(len$1-1)/2]:(sortedDimDataArray[len$1/2]+sortedDimDataArray[len$1/2-1])/2},DataStore$1.prototype.indexOfRawIndex=function(rawIndex){if(rawIndex>=this._rawCount||rawIndex<0)return-1;if(!this._indices)return rawIndex;var indices=this._indices,rawDataIndex=indices[rawIndex];if(rawDataIndex!=null&&rawDataIndex<this._count&&rawDataIndex===rawIndex)return rawIndex;for(var left=0,right=this._count-1;left<=right;){var mid=(left+right)/2|0;if(indices[mid]<rawIndex)left=mid+1;else if(indices[mid]>rawIndex)right=mid-1;else return mid}return-1},DataStore$1.prototype.getIndices=function(){var newIndices,indices=this._indices;if(indices){var Ctor=indices.constructor,thisCount=this._count;if(Ctor===Array){newIndices=new Ctor(thisCount);for(var i$1=0;i$1<thisCount;i$1++)newIndices[i$1]=indices[i$1]}else newIndices=new Ctor(indices.buffer,0,thisCount)}else{var Ctor=getIndicesCtor(this._rawCount);newIndices=new Ctor(this.count());for(var i$1=0;i$1<newIndices.length;i$1++)newIndices[i$1]=i$1}return newIndices},DataStore$1.prototype.filter=function(dims,cb){if(!this._count)return this;for(var newStore=this.clone(),count$1=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(count$1),value=[],dimSize=dims.length,offset=0,dim0=dims[0],chunks=newStore._chunks,i$1=0;i$1<count$1;i$1++){var keep=void 0,rawIdx=newStore.getRawIndex(i$1);if(dimSize===0)keep=cb(i$1);else if(dimSize===1){var val=chunks[dim0][rawIdx];keep=cb(val,i$1)}else{for(var k$1=0;k$1<dimSize;k$1++)value[k$1]=chunks[dims[k$1]][rawIdx];value[k$1]=i$1,keep=cb.apply(null,value)}keep&&(newIndices[offset++]=rawIdx)}return offset<count$1&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore$1.prototype.selectRange=function(range){var newStore=this.clone(),len$1=newStore._count;if(!len$1)return this;var dims=keys(range),dimSize=dims.length;if(!dimSize)return this;var originalCount=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(originalCount),offset=0,dim0=dims[0],min$2=range[dim0][0],max$2=range[dim0][1],storeArr=newStore._chunks,quickFinished=!1;if(!newStore._indices){var idx=0;if(dimSize===1){for(var dimStorage=storeArr[dims[0]],i$1=0;i$1<len$1;i$1++){var val=dimStorage[i$1];(val>=min$2&&val<=max$2||isNaN(val))&&(newIndices[offset++]=idx),idx++}quickFinished=!0}else if(dimSize===2){for(var dimStorage=storeArr[dims[0]],dimStorage2=storeArr[dims[1]],min2$1=range[dims[1]][0],max2$1=range[dims[1]][1],i$1=0;i$1<len$1;i$1++){var val=dimStorage[i$1],val2=dimStorage2[i$1];(val>=min$2&&val<=max$2||isNaN(val))&&(val2>=min2$1&&val2<=max2$1||isNaN(val2))&&(newIndices[offset++]=idx),idx++}quickFinished=!0}}if(!quickFinished)if(dimSize===1)for(var i$1=0;i$1<originalCount;i$1++){var rawIndex=newStore.getRawIndex(i$1),val=storeArr[dims[0]][rawIndex];(val>=min$2&&val<=max$2||isNaN(val))&&(newIndices[offset++]=rawIndex)}else for(var i$1=0;i$1<originalCount;i$1++){for(var keep=!0,rawIndex=newStore.getRawIndex(i$1),k$1=0;k$1<dimSize;k$1++){var dimk=dims[k$1],val=storeArr[dimk][rawIndex];(val<range[dimk][0]||val>range[dimk][1])&&(keep=!1)}keep&&(newIndices[offset++]=newStore.getRawIndex(i$1))}return offset<originalCount&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore$1.prototype.map=function(dims,cb){var target=this.clone(dims);return this._updateDims(target,dims,cb),target},DataStore$1.prototype.modify=function(dims,cb){this._updateDims(this,dims,cb)},DataStore$1.prototype._updateDims=function(target,dims,cb){for(var targetChunks=target._chunks,tmpRetValue=[],dimSize=dims.length,dataCount=target.count(),values=[],rawExtent=target._rawExtent,i$1=0;i$1<dims.length;i$1++)rawExtent[dims[i$1]]=getInitialExtent();for(var dataIndex=0;dataIndex<dataCount;dataIndex++){for(var rawIndex=target.getRawIndex(dataIndex),k$1=0;k$1<dimSize;k$1++)values[k$1]=targetChunks[dims[k$1]][rawIndex];values[dimSize]=dataIndex;var retValue=cb&&cb.apply(null,values);if(retValue!=null){typeof retValue!=`object`&&(tmpRetValue[0]=retValue,retValue=tmpRetValue);for(var i$1=0;i$1<retValue.length;i$1++){var dim=dims[i$1],val=retValue[i$1],rawExtentOnDim=rawExtent[dim],dimStore=targetChunks[dim];dimStore&&(dimStore[rawIndex]=val),val<rawExtentOnDim[0]&&(rawExtentOnDim[0]=val),val>rawExtentOnDim[1]&&(rawExtentOnDim[1]=val)}}}},DataStore$1.prototype.lttbDownSample=function(valueDimension,rate){var target=this.clone([valueDimension],!0),dimStore=target._chunks[valueDimension],len$1=this.count(),sampledIndex=0,frameSize=Math.floor(1/rate),currentRawIndex=this.getRawIndex(0),maxArea,area$1,nextRawIndex,newIndices=new(getIndicesCtor(this._rawCount))(Math.min((Math.ceil(len$1/frameSize)+2)*2,len$1));newIndices[sampledIndex++]=currentRawIndex;for(var i$1=1;i$1<len$1-1;i$1+=frameSize){for(var nextFrameStart=Math.min(i$1+frameSize,len$1-1),nextFrameEnd=Math.min(i$1+frameSize*2,len$1),avgX=(nextFrameEnd+nextFrameStart)/2,avgY=0,idx=nextFrameStart;idx<nextFrameEnd;idx++){var rawIndex=this.getRawIndex(idx),y$1=dimStore[rawIndex];isNaN(y$1)||(avgY+=y$1)}avgY/=nextFrameEnd-nextFrameStart;var frameStart=i$1,frameEnd=Math.min(i$1+frameSize,len$1),pointAX=i$1-1,pointAY=dimStore[currentRawIndex];maxArea=-1,nextRawIndex=frameStart;for(var firstNaNIndex=-1,countNaN=0,idx=frameStart;idx<frameEnd;idx++){var rawIndex=this.getRawIndex(idx),y$1=dimStore[rawIndex];if(isNaN(y$1)){countNaN++,firstNaNIndex<0&&(firstNaNIndex=rawIndex);continue}area$1=Math.abs((pointAX-avgX)*(y$1-pointAY)-(pointAX-idx)*(avgY-pointAY)),area$1>maxArea&&(maxArea=area$1,nextRawIndex=rawIndex)}countNaN>0&&countNaN<frameEnd-frameStart&&(newIndices[sampledIndex++]=Math.min(firstNaNIndex,nextRawIndex),nextRawIndex=Math.max(firstNaNIndex,nextRawIndex)),newIndices[sampledIndex++]=nextRawIndex,currentRawIndex=nextRawIndex}return newIndices[sampledIndex++]=this.getRawIndex(len$1-1),target._count=sampledIndex,target._indices=newIndices,target.getRawIndex=this._getRawIdx,target},DataStore$1.prototype.minmaxDownSample=function(valueDimension,rate){for(var target=this.clone([valueDimension],!0),targetStorage=target._chunks,frameSize=Math.floor(1/rate),dimStore=targetStorage[valueDimension],len$1=this.count(),newIndices=new(getIndicesCtor(this._rawCount))(Math.ceil(len$1/frameSize)*2),offset=0,i$1=0;i$1<len$1;i$1+=frameSize){var minIndex=i$1,minValue=dimStore[this.getRawIndex(minIndex)],maxIndex=i$1,maxValue=dimStore[this.getRawIndex(maxIndex)],thisFrameSize=frameSize;i$1+frameSize>len$1&&(thisFrameSize=len$1-i$1);for(var k$1=0;k$1<thisFrameSize;k$1++){var rawIndex=this.getRawIndex(i$1+k$1),value=dimStore[rawIndex];value<minValue&&(minValue=value,minIndex=i$1+k$1),value>maxValue&&(maxValue=value,maxIndex=i$1+k$1)}var rawMinIndex=this.getRawIndex(minIndex),rawMaxIndex=this.getRawIndex(maxIndex);minIndex<maxIndex?(newIndices[offset++]=rawMinIndex,newIndices[offset++]=rawMaxIndex):(newIndices[offset++]=rawMaxIndex,newIndices[offset++]=rawMinIndex)}return target._count=offset,target._indices=newIndices,target._updateGetRawIdx(),target},DataStore$1.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){for(var target=this.clone([dimension],!0),targetStorage=target._chunks,frameValues=[],frameSize=Math.floor(1/rate),dimStore=targetStorage[dimension],len$1=this.count(),rawExtentOnDim=target._rawExtent[dimension]=getInitialExtent(),newIndices=new(getIndicesCtor(this._rawCount))(Math.ceil(len$1/frameSize)),offset=0,i$1=0;i$1<len$1;i$1+=frameSize){frameSize>len$1-i$1&&(frameSize=len$1-i$1,frameValues.length=frameSize);for(var k$1=0;k$1<frameSize;k$1++){var dataIdx=this.getRawIndex(i$1+k$1);frameValues[k$1]=dimStore[dataIdx]}var value=sampleValue(frameValues),sampleFrameIdx=this.getRawIndex(Math.min(i$1+sampleIndex(frameValues,value)||0,len$1-1));dimStore[sampleFrameIdx]=value,value<rawExtentOnDim[0]&&(rawExtentOnDim[0]=value),value>rawExtentOnDim[1]&&(rawExtentOnDim[1]=value),newIndices[offset++]=sampleFrameIdx}return target._count=offset,target._indices=newIndices,target._updateGetRawIdx(),target},DataStore$1.prototype.each=function(dims,cb){if(this._count)for(var dimSize=dims.length,chunks=this._chunks,i$1=0,len$1=this.count();i$1<len$1;i$1++){var rawIdx=this.getRawIndex(i$1);switch(dimSize){case 0:cb(i$1);break;case 1:cb(chunks[dims[0]][rawIdx],i$1);break;case 2:cb(chunks[dims[0]][rawIdx],chunks[dims[1]][rawIdx],i$1);break;default:for(var k$1=0,value=[];k$1<dimSize;k$1++)value[k$1]=chunks[dims[k$1]][rawIdx];value[k$1]=i$1,cb.apply(null,value)}}},DataStore$1.prototype.getDataExtent=function(dim){var dimData=this._chunks[dim],initialExtent=getInitialExtent();if(!dimData)return initialExtent;var currEnd=this.count(),useRaw=!this._indices,dimExtent;if(useRaw)return this._rawExtent[dim].slice();if(dimExtent=this._extent[dim],dimExtent)return dimExtent.slice();dimExtent=initialExtent;for(var min$2=dimExtent[0],max$2=dimExtent[1],i$1=0;i$1<currEnd;i$1++){var rawIdx=this.getRawIndex(i$1),value=dimData[rawIdx];value<min$2&&(min$2=value),value>max$2&&(max$2=value)}return dimExtent=[min$2,max$2],this._extent[dim]=dimExtent,dimExtent},DataStore$1.prototype.getRawDataItem=function(idx){var rawIdx=this.getRawIndex(idx);if(this._provider.persistent)return this._provider.getItem(rawIdx);for(var val=[],chunks=this._chunks,i$1=0;i$1<chunks.length;i$1++)val.push(chunks[i$1][rawIdx]);return val},DataStore$1.prototype.clone=function(clonedDims,ignoreIndices){var target=new DataStore$1,chunks=this._chunks,clonedDimsMap=clonedDims&&reduce(clonedDims,function(obj,dimIdx){return obj[dimIdx]=!0,obj},{});if(clonedDimsMap)for(var i$1=0;i$1<chunks.length;i$1++)target._chunks[i$1]=clonedDimsMap[i$1]?cloneChunk(chunks[i$1]):chunks[i$1];else target._chunks=chunks;return this._copyCommonProps(target),ignoreIndices||(target._indices=this._cloneIndices()),target._updateGetRawIdx(),target},DataStore$1.prototype._copyCommonProps=function(target){target._count=this._count,target._rawCount=this._rawCount,target._provider=this._provider,target._dimensions=this._dimensions,target._extent=clone(this._extent),target._rawExtent=clone(this._rawExtent)},DataStore$1.prototype._cloneIndices=function(){if(this._indices){var Ctor=this._indices.constructor,indices=void 0;if(Ctor===Array){var thisCount=this._indices.length;indices=new Ctor(thisCount);for(var i$1=0;i$1<thisCount;i$1++)indices[i$1]=this._indices[i$1]}else indices=new Ctor(this._indices);return indices}return null},DataStore$1.prototype._getRawIdxIdentity=function(idx){return idx},DataStore$1.prototype._getRawIdx=function(idx){return idx<this._count&&idx>=0?this._indices[idx]:-1},DataStore$1.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},DataStore$1.internalField=function(){function getDimValueSimply(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[dimIndex],this._dimensions[dimIndex])}defaultDimValueGetters={arrayRows:getDimValueSimply,objectRows:function(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[property],this._dimensions[dimIndex])},keyedColumns:getDimValueSimply,original:function(dataItem,property,dataIndex,dimIndex){var value=dataItem&&(dataItem.value==null?dataItem:dataItem.value);return parseDataValue(value instanceof Array?value[dimIndex]:value,this._dimensions[dimIndex])},typedArray:function(dataItem,property,dataIndex,dimIndex){return dataItem[dimIndex]}}}(),DataStore$1}(),SourceManager=function(){function SourceManager$1(sourceHost){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=sourceHost}return SourceManager$1.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},SourceManager$1.prototype._setLocalSource=function(sourceList,upstreamSignList){this._sourceList=sourceList,this._upstreamSignList=upstreamSignList,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},SourceManager$1.prototype._getVersionSign=function(){return this._sourceHost.uid+`_`+this._versionSignBase},SourceManager$1.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},SourceManager$1.prototype._createSource=function(){this._setLocalSource([],[]);var sourceHost=this._sourceHost,upSourceMgrList=this._getUpstreamSourceManagers(),hasUpstream=!!upSourceMgrList.length,resultSourceList,upstreamSignList;if(isSeries(sourceHost)){var seriesModel=sourceHost,data=void 0,sourceFormat=void 0,upSource=void 0;if(hasUpstream){var upSourceMgr=upSourceMgrList[0];upSourceMgr.prepareSource(),upSource=upSourceMgr.getSource(),data=upSource.data,sourceFormat=upSource.sourceFormat,upstreamSignList=[upSourceMgr._getVersionSign()]}else data=seriesModel.get(`data`,!0),sourceFormat=isTypedArray(data)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL,upstreamSignList=[];var newMetaRawOption=this._getSourceMetaRawOption()||{},upMetaRawOption=upSource&&upSource.metaRawOption||{},seriesLayoutBy=retrieve2(newMetaRawOption.seriesLayoutBy,upMetaRawOption.seriesLayoutBy)||null,sourceHeader=retrieve2(newMetaRawOption.sourceHeader,upMetaRawOption.sourceHeader),dimensions=retrieve2(newMetaRawOption.dimensions,upMetaRawOption.dimensions);resultSourceList=seriesLayoutBy!==upMetaRawOption.seriesLayoutBy||!!sourceHeader!=!!upMetaRawOption.sourceHeader||dimensions?[createSource(data,{seriesLayoutBy,sourceHeader,dimensions},sourceFormat)]:[]}else{var datasetModel=sourceHost;if(hasUpstream){var result=this._applyTransform(upSourceMgrList);resultSourceList=result.sourceList,upstreamSignList=result.upstreamSignList}else{var sourceData=datasetModel.get(`source`,!0);resultSourceList=[createSource(sourceData,this._getSourceMetaRawOption(),null)],upstreamSignList=[]}}this._setLocalSource(resultSourceList,upstreamSignList)},SourceManager$1.prototype._applyTransform=function(upMgrList){var datasetModel=this._sourceHost,transformOption=datasetModel.get(`transform`,!0),fromTransformResult=datasetModel.get(`fromTransformResult`,!0);fromTransformResult!=null&&upMgrList.length!==1&&doThrow(``);var sourceList,upSourceList=[],upstreamSignList=[];return each(upMgrList,function(upMgr){upMgr.prepareSource();var upSource=upMgr.getSource(fromTransformResult||0);fromTransformResult!=null&&!upSource&&doThrow(``),upSourceList.push(upSource),upstreamSignList.push(upMgr._getVersionSign())}),transformOption?sourceList=applyDataTransform(transformOption,upSourceList,{datasetIndex:datasetModel.componentIndex}):fromTransformResult!=null&&(sourceList=[cloneSourceShallow(upSourceList[0])]),{sourceList,upstreamSignList}},SourceManager$1.prototype._isDirty=function(){if(this._dirty)return!0;for(var upSourceMgrList=this._getUpstreamSourceManagers(),i$1=0;i$1<upSourceMgrList.length;i$1++){var upSrcMgr=upSourceMgrList[i$1];if(upSrcMgr._isDirty()||this._upstreamSignList[i$1]!==upSrcMgr._getVersionSign())return!0}},SourceManager$1.prototype.getSource=function(sourceIndex){sourceIndex||=0;var source$2=this._sourceList[sourceIndex];if(!source$2){var upSourceMgrList=this._getUpstreamSourceManagers();return upSourceMgrList[0]&&upSourceMgrList[0].getSource(sourceIndex)}return source$2},SourceManager$1.prototype.getSharedDataStore=function(seriesDimRequest){var schema=seriesDimRequest.makeStoreSchema();return this._innerGetDataStore(schema.dimensions,seriesDimRequest.source,schema.hash)},SourceManager$1.prototype._innerGetDataStore=function(storeDims,seriesSource,sourceReadKey){var sourceIndex=0,storeList=this._storeList,cachedStoreMap=storeList[sourceIndex];cachedStoreMap||=storeList[sourceIndex]={};var cachedStore=cachedStoreMap[sourceReadKey];if(!cachedStore){var upSourceMgr=this._getUpstreamSourceManagers()[0];isSeries(this._sourceHost)&&upSourceMgr?cachedStore=upSourceMgr._innerGetDataStore(storeDims,seriesSource,sourceReadKey):(cachedStore=new DataStore_default,cachedStore.initData(new DefaultDataProvider(seriesSource,storeDims.length),storeDims)),cachedStoreMap[sourceReadKey]=cachedStore}return cachedStore},SourceManager$1.prototype._getUpstreamSourceManagers=function(){var sourceHost=this._sourceHost;if(isSeries(sourceHost)){var datasetModel=querySeriesUpstreamDatasetModel(sourceHost);return datasetModel?[datasetModel.getSourceManager()]:[]}else return map(queryDatasetUpstreamDatasetModels(sourceHost),function(datasetModel$1){return datasetModel$1.getSourceManager()})},SourceManager$1.prototype._getSourceMetaRawOption=function(){var sourceHost=this._sourceHost,seriesLayoutBy,sourceHeader,dimensions;if(isSeries(sourceHost))seriesLayoutBy=sourceHost.get(`seriesLayoutBy`,!0),sourceHeader=sourceHost.get(`sourceHeader`,!0),dimensions=sourceHost.get(`dimensions`,!0);else if(!this._getUpstreamSourceManagers().length){var model=sourceHost;seriesLayoutBy=model.get(`seriesLayoutBy`,!0),sourceHeader=model.get(`sourceHeader`,!0),dimensions=model.get(`dimensions`,!0)}return{seriesLayoutBy,sourceHeader,dimensions}},SourceManager$1}();function isSeries(sourceHost){return sourceHost.mainType===`series`}function doThrow(errMsg){throw Error(errMsg)}var TOOLTIP_LINE_HEIGHT_CSS=`line-height:1`;function getTooltipLineHeight(textStyle){var lineHeight=textStyle.lineHeight;return lineHeight==null?TOOLTIP_LINE_HEIGHT_CSS:`line-height:`+encodeHTML(lineHeight+``)+`px`}function getTooltipTextStyle(textStyle,renderMode){var nameFontColor=textStyle.color||tokens_default.color.tertiary,nameFontSize=textStyle.fontSize||12,nameFontWeight=textStyle.fontWeight||`400`,valueFontColor=textStyle.color||tokens_default.color.secondary,valueFontSize=textStyle.fontSize||14,valueFontWeight=textStyle.fontWeight||`900`;return renderMode===`html`?{nameStyle:`font-size:`+encodeHTML(nameFontSize+``)+`px;color:`+encodeHTML(nameFontColor)+`;font-weight:`+encodeHTML(nameFontWeight+``),valueStyle:`font-size:`+encodeHTML(valueFontSize+``)+`px;color:`+encodeHTML(valueFontColor)+`;font-weight:`+encodeHTML(valueFontWeight+``)}:{nameStyle:{fontSize:nameFontSize,fill:nameFontColor,fontWeight:nameFontWeight},valueStyle:{fontSize:valueFontSize,fill:valueFontColor,fontWeight:valueFontWeight}}}var HTML_GAPS=[0,10,20,30],RICH_TEXT_GAPS=[``,`
`,`

`,`


`];function createTooltipMarkup(type,option){return option.type=type,option}function isSectionFragment(frag){return frag.type===`section`}function getBuilder(frag){return isSectionFragment(frag)?buildSection:buildNameValue}function getBlockGapLevel(frag){if(isSectionFragment(frag)){var gapLevel_1=0,subBlockLen=frag.blocks.length,hasInnerGap_1=subBlockLen>1||subBlockLen>0&&!frag.noHeader;return each(frag.blocks,function(subBlock){var subGapLevel=getBlockGapLevel(subBlock);subGapLevel>=gapLevel_1&&(gapLevel_1=subGapLevel+ +(hasInnerGap_1&&(!subGapLevel||isSectionFragment(subBlock)&&!subBlock.noHeader)))}),gapLevel_1}return 0}function buildSection(ctx,fragment$3,topMarginForOuterGap,toolTipTextStyle){var noHeader=fragment$3.noHeader,gaps=getGap(getBlockGapLevel(fragment$3)),subMarkupTextList=[],subBlocks=fragment$3.blocks||[];assert(!subBlocks||isArray(subBlocks)),subBlocks||=[];var orderMode=ctx.orderMode;if(fragment$3.sortBlocks&&orderMode){subBlocks=subBlocks.slice();var orderMap={valueAsc:`asc`,valueDesc:`desc`};if(hasOwn(orderMap,orderMode)){var comparator_1=new SortOrderComparator(orderMap[orderMode],null);subBlocks.sort(function(a$1,b$1){return comparator_1.evaluate(a$1.sortParam,b$1.sortParam)})}else orderMode===`seriesDesc`&&subBlocks.reverse()}each(subBlocks,function(subBlock,idx){var valueFormatter=fragment$3.valueFormatter,subMarkupText$1=getBuilder(subBlock)(valueFormatter?extend(extend({},ctx),{valueFormatter}):ctx,subBlock,idx>0?gaps.html:0,toolTipTextStyle);subMarkupText$1!=null&&subMarkupTextList.push(subMarkupText$1)});var subMarkupText=ctx.renderMode===`richText`?subMarkupTextList.join(gaps.richText):wrapBlockHTML(toolTipTextStyle,subMarkupTextList.join(``),noHeader?topMarginForOuterGap:gaps.html);if(noHeader)return subMarkupText;var displayableHeader=makeValueReadable(fragment$3.header,`ordinal`,ctx.useUTC),nameStyle=getTooltipTextStyle(toolTipTextStyle,ctx.renderMode).nameStyle,tooltipLineHeight=getTooltipLineHeight(toolTipTextStyle);return ctx.renderMode===`richText`?wrapInlineNameRichText(ctx,displayableHeader,nameStyle)+gaps.richText+subMarkupText:wrapBlockHTML(toolTipTextStyle,`<div style="`+nameStyle+`;`+tooltipLineHeight+`;">`+encodeHTML(displayableHeader)+`</div>`+subMarkupText,topMarginForOuterGap)}function buildNameValue(ctx,fragment$3,topMarginForOuterGap,toolTipTextStyle){var renderMode=ctx.renderMode,noName=fragment$3.noName,noValue=fragment$3.noValue,noMarker=!fragment$3.markerType,name=fragment$3.name,useUTC=ctx.useUTC,valueFormatter=fragment$3.valueFormatter||ctx.valueFormatter||function(value){return value=isArray(value)?value:[value],map(value,function(val,idx){return makeValueReadable(val,isArray(valueTypeOption)?valueTypeOption[idx]:valueTypeOption,useUTC)})};if(!(noName&&noValue)){var markerStr=noMarker?``:ctx.markupStyleCreator.makeTooltipMarker(fragment$3.markerType,fragment$3.markerColor||tokens_default.color.secondary,renderMode),readableName=noName?``:makeValueReadable(name,`ordinal`,useUTC),valueTypeOption=fragment$3.valueType,readableValueList=noValue?[]:valueFormatter(fragment$3.value,fragment$3.dataIndex),valueAlignRight=!noMarker||!noName,valueCloseToMarker=!noMarker&&noName,_a$1=getTooltipTextStyle(toolTipTextStyle,renderMode),nameStyle=_a$1.nameStyle,valueStyle=_a$1.valueStyle;return renderMode===`richText`?(noMarker?``:markerStr)+(noName?``:wrapInlineNameRichText(ctx,readableName,nameStyle))+(noValue?``:wrapInlineValueRichText(ctx,readableValueList,valueAlignRight,valueCloseToMarker,valueStyle)):wrapBlockHTML(toolTipTextStyle,(noMarker?``:markerStr)+(noName?``:wrapInlineNameHTML(readableName,!noMarker,nameStyle))+(noValue?``:wrapInlineValueHTML(readableValueList,valueAlignRight,valueCloseToMarker,valueStyle)),topMarginForOuterGap)}}function buildTooltipMarkup(fragment$3,markupStyleCreator,renderMode,orderMode,useUTC,toolTipTextStyle){if(fragment$3){var builder=getBuilder(fragment$3),ctx={useUTC,renderMode,orderMode,markupStyleCreator,valueFormatter:fragment$3.valueFormatter};return builder(ctx,fragment$3,0,toolTipTextStyle)}}function getGap(gapLevel){return{html:HTML_GAPS[gapLevel],richText:RICH_TEXT_GAPS[gapLevel]}}function wrapBlockHTML(textStyle,encodedContent,topGap){var clearfix=`<div style="clear:both"></div>`,marginCSS=`margin: `+topGap+`px 0 0`,tooltipLineHeight=getTooltipLineHeight(textStyle);return`<div style="`+marginCSS+`;`+tooltipLineHeight+`;">`+encodedContent+clearfix+`</div>`}function wrapInlineNameHTML(name,leftHasMarker,style){var marginCss=leftHasMarker?`margin-left:2px`:``;return`<span style="`+style+`;`+marginCss+`">`+encodeHTML(name)+`</span>`}function wrapInlineValueHTML(valueList,alignRight$1,valueCloseToMarker,style){var alignCSS=alignRight$1?`float:right;margin-left:`+(valueCloseToMarker?`10px`:`20px`):``;return valueList=isArray(valueList)?valueList:[valueList],`<span style="`+alignCSS+`;`+style+`">`+map(valueList,function(value){return encodeHTML(value)}).join(`&nbsp;&nbsp;`)+`</span>`}function wrapInlineNameRichText(ctx,name,style){return ctx.markupStyleCreator.wrapRichTextStyle(name,style)}function wrapInlineValueRichText(ctx,values,alignRight$1,valueCloseToMarker,style){var styles=[style],paddingLeft=valueCloseToMarker?10:20;return alignRight$1&&styles.push({padding:[0,0,0,paddingLeft],align:`right`}),ctx.markupStyleCreator.wrapRichTextStyle(isArray(values)?values.join(`  `):values,styles)}function retrieveVisualColorForTooltipMarker(series,dataIndex){var color$2=series.getData().getItemVisual(dataIndex,`style`)[series.visualDrawType];return convertToColorString(color$2)}function getPaddingFromTooltipModel(model,renderMode){return model.get(`padding`)??(renderMode===`richText`?[8,10]:10)}var TooltipMarkupStyleCreator=function(){function TooltipMarkupStyleCreator$1(){this.richTextStyles={},this._nextStyleNameId=getRandomIdBase()}return TooltipMarkupStyleCreator$1.prototype._generateStyleName=function(){return`__EC_aUTo_`+ this._nextStyleNameId++},TooltipMarkupStyleCreator$1.prototype.makeTooltipMarker=function(markerType,colorStr,renderMode){var markerId=renderMode===`richText`?this._generateStyleName():null,marker=getTooltipMarker({color:colorStr,type:markerType,renderMode,markerId});return isString(marker)?marker:(this.richTextStyles[markerId]=marker.style,marker.content)},TooltipMarkupStyleCreator$1.prototype.wrapRichTextStyle=function(text,styles){var finalStl={};isArray(styles)?each(styles,function(stl){return extend(finalStl,stl)}):extend(finalStl,styles);var styleName=this._generateStyleName();return this.richTextStyles[styleName]=finalStl,`{`+styleName+`|`+text+`}`},TooltipMarkupStyleCreator$1}();function defaultSeriesFormatTooltip(opt){var series=opt.series,dataIndex=opt.dataIndex,multipleSeries=opt.multipleSeries,data=series.getData(),tooltipDims=data.mapDimensionsAll(`defaultedTooltip`),tooltipDimLen=tooltipDims.length,value=series.getRawValue(dataIndex),isValueArr=isArray(value),markerColor=retrieveVisualColorForTooltipMarker(series,dataIndex),inlineValue,inlineValueType,subBlocks,sortParam;if(tooltipDimLen>1||isValueArr&&!tooltipDimLen){var formatArrResult=formatTooltipArrayValue(value,series,dataIndex,tooltipDims,markerColor);inlineValue=formatArrResult.inlineValues,inlineValueType=formatArrResult.inlineValueTypes,subBlocks=formatArrResult.blocks,sortParam=formatArrResult.inlineValues[0]}else if(tooltipDimLen){var dimInfo=data.getDimensionInfo(tooltipDims[0]);sortParam=inlineValue=retrieveRawValue(data,dataIndex,tooltipDims[0]),inlineValueType=dimInfo.type}else sortParam=inlineValue=isValueArr?value[0]:value;var seriesNameSpecified=isNameSpecified(series),seriesName=seriesNameSpecified&&series.name||``,itemName=data.getName(dataIndex),inlineName=multipleSeries?seriesName:itemName;return createTooltipMarkup(`section`,{header:seriesName,noHeader:multipleSeries||!seriesNameSpecified,sortParam,blocks:[createTooltipMarkup(`nameValue`,{markerType:`item`,markerColor,name:inlineName,noName:!trim(inlineName),value:inlineValue,valueType:inlineValueType,dataIndex})].concat(subBlocks||[])})}function formatTooltipArrayValue(value,series,dataIndex,tooltipDims,colorStr){var data=series.getData(),isValueMultipleLine=reduce(value,function(isValueMultipleLine$1,val,idx){var dimItem=data.getDimensionInfo(idx);return isValueMultipleLine$1||=dimItem&&dimItem.tooltip!==!1&&dimItem.displayName!=null},!1),inlineValues=[],inlineValueTypes=[],blocks=[];tooltipDims.length?each(tooltipDims,function(dim){setEachItem(retrieveRawValue(data,dataIndex,dim),dim)}):each(value,setEachItem);function setEachItem(val,dim){var dimInfo=data.getDimensionInfo(dim);!dimInfo||dimInfo.otherDims.tooltip===!1||(isValueMultipleLine?blocks.push(createTooltipMarkup(`nameValue`,{markerType:`subItem`,markerColor:colorStr,name:dimInfo.displayName,value:val,valueType:dimInfo.type})):(inlineValues.push(val),inlineValueTypes.push(dimInfo.type)))}return{inlineValues,inlineValueTypes,blocks}}var inner$9=makeInner();function getSelectionKey(data,dataIndex){return data.getName(dataIndex)||data.getId(dataIndex)}var SERIES_UNIVERSAL_TRANSITION_PROP=`__universalTransitionEnabled`,SeriesModel=function(_super){__extends(SeriesModel$1,_super);function SeriesModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this._selectedDataIndicesMap={},_this}return SeriesModel$1.prototype.init=function(option,parentModel,ecModel){this.seriesIndex=this.componentIndex,this.dataTask=createTask({count:dataTaskCount,reset:dataTaskReset}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(option,ecModel),(inner$9(this).sourceManager=new SourceManager(this)).prepareSource();var data=this.getInitialData(option,ecModel);wrapData(data,this),this.dataTask.context.data=data,inner$9(this).dataBeforeProcessed=data,autoSeriesName(this),this._initSelectedMapFromData(data)},SeriesModel$1.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{},themeSubType=this.subType;Component_default.hasClass(themeSubType)&&(themeSubType+=`Series`),merge(option,ecModel.getTheme().get(this.subType)),merge(option,this.getDefaultOption()),defaultEmphasis(option,`label`,[`show`]),this.fillDataTextStyle(option.data),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},SeriesModel$1.prototype.mergeOption=function(newSeriesOption,ecModel){newSeriesOption=merge(this.option,newSeriesOption,!0),this.fillDataTextStyle(newSeriesOption.data);var layoutMode=fetchLayoutMode(this);layoutMode&&mergeLayoutParam(this.option,newSeriesOption,layoutMode);var sourceManager=inner$9(this).sourceManager;sourceManager.dirty(),sourceManager.prepareSource();var data=this.getInitialData(newSeriesOption,ecModel);wrapData(data,this),this.dataTask.dirty(),this.dataTask.context.data=data,inner$9(this).dataBeforeProcessed=data,autoSeriesName(this),this._initSelectedMapFromData(data)},SeriesModel$1.prototype.fillDataTextStyle=function(data){if(data&&!isTypedArray(data))for(var props=[`show`],i$1=0;i$1<data.length;i$1++)data[i$1]&&data[i$1].label&&defaultEmphasis(data[i$1],`label`,props)},SeriesModel$1.prototype.getInitialData=function(option,ecModel){},SeriesModel$1.prototype.appendData=function(params){this.getRawData().appendData(params.data)},SeriesModel$1.prototype.getData=function(dataType){var task=getCurrentTask(this);if(task){var data=task.context.data;return dataType==null||!data.getLinkedData?data:data.getLinkedData(dataType)}else return inner$9(this).data},SeriesModel$1.prototype.getAllData=function(){var mainData=this.getData();return mainData&&mainData.getLinkedDataAll?mainData.getLinkedDataAll():[{data:mainData}]},SeriesModel$1.prototype.setData=function(data){var task=getCurrentTask(this);if(task){var context$1=task.context;context$1.outputData=data,task!==this.dataTask&&(context$1.data=data)}inner$9(this).data=data},SeriesModel$1.prototype.getEncode=function(){var encode=this.get(`encode`,!0);if(encode)return createHashMap(encode)},SeriesModel$1.prototype.getSourceManager=function(){return inner$9(this).sourceManager},SeriesModel$1.prototype.getSource=function(){return this.getSourceManager().getSource()},SeriesModel$1.prototype.getRawData=function(){return inner$9(this).dataBeforeProcessed},SeriesModel$1.prototype.getColorBy=function(){return this.get(`colorBy`)||`series`},SeriesModel$1.prototype.isColorBySeries=function(){return this.getColorBy()===`series`},SeriesModel$1.prototype.getBaseAxis=function(){var coordSys=this.coordinateSystem;return coordSys&&coordSys.getBaseAxis&&coordSys.getBaseAxis()},SeriesModel$1.prototype.indicesOfNearest=function(axisDim,dim,value,maxDistance){var data=this.getData(),coordSys=this.coordinateSystem,axis=coordSys&&coordSys.getAxis(axisDim);if(!coordSys||!axis)return[];var targetCoord=axis.dataToCoord(value);maxDistance??=1/0;var nearestIndices=[],minDist=1/0,minDiff=-1,nearestIndicesLen=0;return data.each(dim,function(dimValue,idx){var dataCoord=axis.dataToCoord(dimValue),diff=targetCoord-dataCoord,dist$2=Math.abs(diff);dist$2<=maxDistance&&((dist$2<minDist||dist$2===minDist&&diff>=0&&minDiff<0)&&(minDist=dist$2,minDiff=diff,nearestIndicesLen=0),diff===minDiff&&(nearestIndices[nearestIndicesLen++]=idx))}),nearestIndices.length=nearestIndicesLen,nearestIndices},SeriesModel$1.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){return defaultSeriesFormatTooltip({series:this,dataIndex,multipleSeries})},SeriesModel$1.prototype.isAnimationEnabled=function(){var ecModel=this.ecModel;if(env_default.node&&!(ecModel&&ecModel.ssr))return!1;var animationEnabled=this.getShallow(`animation`);return animationEnabled&&this.getData().count()>this.getShallow(`animationThreshold`)&&(animationEnabled=!1),!!animationEnabled},SeriesModel$1.prototype.restoreData=function(){this.dataTask.dirty()},SeriesModel$1.prototype.getColorFromPalette=function(name,scope,requestColorNum){var ecModel=this.ecModel,color$2=PaletteMixin.prototype.getColorFromPalette.call(this,name,scope,requestColorNum);return color$2||=ecModel.getColorFromPalette(name,scope,requestColorNum),color$2},SeriesModel$1.prototype.coordDimToDataDim=function(coordDim){return this.getRawData().mapDimensionsAll(coordDim)},SeriesModel$1.prototype.getProgressive=function(){return this.get(`progressive`)},SeriesModel$1.prototype.getProgressiveThreshold=function(){return this.get(`progressiveThreshold`)},SeriesModel$1.prototype.select=function(innerDataIndices,dataType){this._innerSelect(this.getData(dataType),innerDataIndices)},SeriesModel$1.prototype.unselect=function(innerDataIndices,dataType){var selectedMap=this.option.selectedMap;if(selectedMap){var selectedMode=this.option.selectedMode,data=this.getData(dataType);if(selectedMode===`series`||selectedMap===`all`){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var i$1=0;i$1<innerDataIndices.length;i$1++){var dataIndex=innerDataIndices[i$1],nameOrId=getSelectionKey(data,dataIndex);selectedMap[nameOrId]=!1,this._selectedDataIndicesMap[nameOrId]=-1}}},SeriesModel$1.prototype.toggleSelect=function(innerDataIndices,dataType){for(var tmpArr=[],i$1=0;i$1<innerDataIndices.length;i$1++)tmpArr[0]=innerDataIndices[i$1],this.isSelected(innerDataIndices[i$1],dataType)?this.unselect(tmpArr,dataType):this.select(tmpArr,dataType)},SeriesModel$1.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap===`all`)return[].slice.call(this.getData().getIndices());for(var selectedDataIndicesMap=this._selectedDataIndicesMap,nameOrIds=keys(selectedDataIndicesMap),dataIndices=[],i$1=0;i$1<nameOrIds.length;i$1++){var dataIndex=selectedDataIndicesMap[nameOrIds[i$1]];dataIndex>=0&&dataIndices.push(dataIndex)}return dataIndices},SeriesModel$1.prototype.isSelected=function(dataIndex,dataType){var selectedMap=this.option.selectedMap;if(!selectedMap)return!1;var data=this.getData(dataType);return(selectedMap===`all`||selectedMap[getSelectionKey(data,dataIndex)])&&!data.getItemModel(dataIndex).get([`select`,`disabled`])},SeriesModel$1.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var universalTransitionOpt=this.option.universalTransition;return universalTransitionOpt?universalTransitionOpt===!0?!0:universalTransitionOpt&&universalTransitionOpt.enabled:!1},SeriesModel$1.prototype._innerSelect=function(data,innerDataIndices){var _a$1,_b$1,option=this.option,selectedMode=option.selectedMode,len$1=innerDataIndices.length;if(!(!selectedMode||!len$1)){if(selectedMode===`series`)option.selectedMap=`all`;else if(selectedMode===`multiple`){isObject(option.selectedMap)||(option.selectedMap={});for(var selectedMap=option.selectedMap,i$1=0;i$1<len$1;i$1++){var dataIndex=innerDataIndices[i$1],nameOrId=getSelectionKey(data,dataIndex);selectedMap[nameOrId]=!0,this._selectedDataIndicesMap[nameOrId]=data.getRawIndex(dataIndex)}}else if(selectedMode===`single`||selectedMode===!0){var lastDataIndex=innerDataIndices[len$1-1],nameOrId=getSelectionKey(data,lastDataIndex);option.selectedMap=(_a$1={},_a$1[nameOrId]=!0,_a$1),this._selectedDataIndicesMap=(_b$1={},_b$1[nameOrId]=data.getRawIndex(lastDataIndex),_b$1)}}},SeriesModel$1.prototype._initSelectedMapFromData=function(data){if(!this.option.selectedMap){var dataIndices=[];data.hasItemOption&&data.each(function(idx){var rawItem=data.getRawDataItem(idx);rawItem&&rawItem.selected&&dataIndices.push(idx)}),dataIndices.length>0&&this._innerSelect(data,dataIndices)}},SeriesModel$1.registerClass=function(clz){return Component_default.registerClass(clz)},SeriesModel$1.protoInitialize=function(){var proto=SeriesModel$1.prototype;proto.type=`series.__base__`,proto.seriesIndex=0,proto.ignoreStyleOnData=!1,proto.hasSymbolVisual=!1,proto.defaultSymbol=`circle`,proto.visualStyleAccessPath=`itemStyle`,proto.visualDrawType=`fill`}(),SeriesModel$1}(Component_default);mixin(SeriesModel,DataFormatMixin),mixin(SeriesModel,PaletteMixin),mountExtend(SeriesModel,Component_default);function autoSeriesName(seriesModel){var name=seriesModel.name;isNameSpecified(seriesModel)||(seriesModel.name=getSeriesAutoName(seriesModel)||name)}function getSeriesAutoName(seriesModel){var data=seriesModel.getRawData(),dataDims=data.mapDimensionsAll(`seriesName`),nameArr=[];return each(dataDims,function(dataDim){var dimInfo=data.getDimensionInfo(dataDim);dimInfo.displayName&&nameArr.push(dimInfo.displayName)}),nameArr.join(` `)}function dataTaskCount(context$1){return context$1.model.getRawData().count()}function dataTaskReset(context$1){var seriesModel=context$1.model;return seriesModel.setData(seriesModel.getRawData().cloneShallow()),dataTaskProgress}function dataTaskProgress(param,context$1){context$1.outputData&&param.end>context$1.outputData.count()&&context$1.model.getRawData().cloneShallow(context$1.outputData)}function wrapData(data,seriesModel){each(concatArray(data.CHANGABLE_METHODS,data.DOWNSAMPLE_METHODS),function(methodName){data.wrapMethod(methodName,curry(onDataChange,seriesModel))})}function onDataChange(seriesModel,newList){var task=getCurrentTask(seriesModel);return task&&task.setOutputEnd((newList||this).count()),newList}function getCurrentTask(seriesModel){var scheduler=(seriesModel.ecModel||{}).scheduler,pipeline=scheduler&&scheduler.getPipeline(seriesModel.uid);if(pipeline){var task=pipeline.currentTask;if(task){var agentStubMap=task.agentStubMap;agentStubMap&&(task=agentStubMap.get(seriesModel.uid))}return task}}var Series_default=SeriesModel,ComponentView=function(){function ComponentView$1(){this.group=new Group_default,this.uid=getUID(`viewComponent`)}return ComponentView$1.prototype.init=function(ecModel,api){},ComponentView$1.prototype.render=function(model,ecModel,api,payload){},ComponentView$1.prototype.dispose=function(ecModel,api){},ComponentView$1.prototype.updateView=function(model,ecModel,api,payload){},ComponentView$1.prototype.updateLayout=function(model,ecModel,api,payload){},ComponentView$1.prototype.updateVisual=function(model,ecModel,api,payload){},ComponentView$1.prototype.toggleBlurSeries=function(seriesModels,isBlur,ecModel){},ComponentView$1.prototype.eachRendered=function(cb){var group=this.group;group&&group.traverse(cb)},ComponentView$1}();enableClassExtend(ComponentView),enableClassManagement(ComponentView);var Component_default$1=ComponentView;function createRenderPlanner(){var inner$11=makeInner();return function(seriesModel){var fields=inner$11(seriesModel),pipelineContext=seriesModel.pipelineContext,originalLarge=!!fields.large,originalProgressive=!!fields.progressiveRender,large=fields.large=!!(pipelineContext&&pipelineContext.large),progressive=fields.progressiveRender=!!(pipelineContext&&pipelineContext.progressiveRender);return(originalLarge!==large||originalProgressive!==progressive)&&`reset`}}var inner$8=makeInner(),renderPlanner=createRenderPlanner(),ChartView=function(){function ChartView$1(){this.group=new Group_default,this.uid=getUID(`viewChart`),this.renderTask=createTask({plan:renderTaskPlan,reset:renderTaskReset}),this.renderTask.context={view:this}}return ChartView$1.prototype.init=function(ecModel,api){},ChartView$1.prototype.render=function(seriesModel,ecModel,api,payload){},ChartView$1.prototype.highlight=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(payload&&payload.dataType);data&&toggleHighlight(data,payload,`emphasis`)},ChartView$1.prototype.downplay=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(payload&&payload.dataType);data&&toggleHighlight(data,payload,`normal`)},ChartView$1.prototype.remove=function(ecModel,api){this.group.removeAll()},ChartView$1.prototype.dispose=function(ecModel,api){},ChartView$1.prototype.updateView=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView$1.prototype.updateLayout=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView$1.prototype.updateVisual=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView$1.prototype.eachRendered=function(cb){traverseElements(this.group,cb)},ChartView$1.markUpdateMethod=function(payload,methodName){inner$8(payload).updateMethod=methodName},ChartView$1.protoInitialize=function(){var proto=ChartView$1.prototype;proto.type=`chart`}(),ChartView$1}();function elSetState(el,state,highlightDigit){el&&isHighDownDispatcher(el)&&(state===`emphasis`?enterEmphasis:leaveEmphasis)(el,highlightDigit)}function toggleHighlight(data,payload,state){var dataIndex=queryDataIndex(data,payload),highlightDigit=payload&&payload.highlightKey!=null?getHighlightDigit(payload.highlightKey):null;dataIndex==null?data.eachItemGraphicEl(function(el){elSetState(el,state,highlightDigit)}):each(normalizeToArray(dataIndex),function(dataIdx){elSetState(data.getItemGraphicEl(dataIdx),state,highlightDigit)})}enableClassExtend(ChartView,[`dispose`]),enableClassManagement(ChartView);function renderTaskPlan(context$1){return renderPlanner(context$1.model)}function renderTaskReset(context$1){var seriesModel=context$1.model,ecModel=context$1.ecModel,api=context$1.api,payload=context$1.payload,progressiveRender=seriesModel.pipelineContext.progressiveRender,view=context$1.view,updateMethod=payload&&inner$8(payload).updateMethod,methodName=progressiveRender?`incrementalPrepareRender`:updateMethod&&view[updateMethod]?updateMethod:`render`;return methodName!==`render`&&view[methodName](seriesModel,ecModel,api,payload),progressMethodMap[methodName]}var progressMethodMap={incrementalPrepareRender:{progress:function(params,context$1){context$1.view.incrementalRender(params,context$1.model,context$1.ecModel,context$1.api,context$1.payload)}},render:{forceFirstProgress:!0,progress:function(params,context$1){context$1.view.render(context$1.model,context$1.ecModel,context$1.api,context$1.payload)}}},Chart_default=ChartView,ORIGIN_METHOD=`\0__throttleOriginMethod`,RATE=`\0__throttleRate`,THROTTLE_TYPE=`\0__throttleType`;function throttle(fn,delay,debounce){var currCall,lastCall=0,lastExec=0,timer=null,diff,scope,args,debounceNextCall;delay||=0;function exec(){lastExec=new Date().getTime(),timer=null,fn.apply(scope,args||[])}var cb=function(){var cbArgs=[...arguments];currCall=new Date().getTime(),scope=this,args=cbArgs;var thisDelay=debounceNextCall||delay,thisDebounce=debounceNextCall||debounce;debounceNextCall=null,diff=currCall-(thisDebounce?lastCall:lastExec)-thisDelay,clearTimeout(timer),thisDebounce?timer=setTimeout(exec,thisDelay):diff>=0?exec():timer=setTimeout(exec,-diff),lastCall=currCall};return cb.clear=function(){timer&&=(clearTimeout(timer),null)},cb.debounceNextCall=function(debounceDelay){debounceNextCall=debounceDelay},cb}function createOrUpdate(obj,fnAttr,rate,throttleType){var fn=obj[fnAttr];if(fn){var originFn=fn[ORIGIN_METHOD]||fn,lastThrottleType=fn[THROTTLE_TYPE];if(fn[RATE]!==rate||lastThrottleType!==throttleType){if(rate==null||!throttleType)return obj[fnAttr]=originFn;fn=obj[fnAttr]=throttle(originFn,rate,throttleType===`debounce`),fn[ORIGIN_METHOD]=originFn,fn[THROTTLE_TYPE]=throttleType,fn[RATE]=rate}return fn}}function clear(obj,fnAttr){var fn=obj[fnAttr];fn&&fn[ORIGIN_METHOD]&&(fn.clear&&fn.clear(),obj[fnAttr]=fn[ORIGIN_METHOD])}var inner$7=makeInner(),defaultStyleMappers={itemStyle:makeStyleMapper(ITEM_STYLE_KEY_MAP,!0),lineStyle:makeStyleMapper(LINE_STYLE_KEY_MAP,!0)},defaultColorKey={lineStyle:`stroke`,itemStyle:`fill`};function getStyleMapper(seriesModel,stylePath){return seriesModel.visualStyleMapper||defaultStyleMappers[stylePath]||(console.warn(`Unknown style type '`+stylePath+`'.`),defaultStyleMappers.itemStyle)}function getDefaultColorKey(seriesModel,stylePath){return seriesModel.visualDrawType||defaultColorKey[stylePath]||(console.warn(`Unknown style type '`+stylePath+`'.`),`fill`)}var seriesStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||`itemStyle`,styleModel=seriesModel.getModel(stylePath),globalStyle=getStyleMapper(seriesModel,stylePath)(styleModel),decalOption=styleModel.getShallow(`decal`);decalOption&&(data.setVisual(`decal`,decalOption),decalOption.dirty=!0);var colorKey=getDefaultColorKey(seriesModel,stylePath),color$2=globalStyle[colorKey],colorCallback=isFunction(color$2)?color$2:null,hasAutoColor=globalStyle.fill===`auto`||globalStyle.stroke===`auto`;if(!globalStyle[colorKey]||colorCallback||hasAutoColor){var colorPalette=seriesModel.getColorFromPalette(seriesModel.name,null,ecModel.getSeriesCount());globalStyle[colorKey]||(globalStyle[colorKey]=colorPalette,data.setVisual(`colorFromPalette`,!0)),globalStyle.fill=globalStyle.fill===`auto`||isFunction(globalStyle.fill)?colorPalette:globalStyle.fill,globalStyle.stroke=globalStyle.stroke===`auto`||isFunction(globalStyle.stroke)?colorPalette:globalStyle.stroke}if(data.setVisual(`style`,globalStyle),data.setVisual(`drawType`,colorKey),!ecModel.isSeriesFiltered(seriesModel)&&colorCallback)return data.setVisual(`colorFromPalette`,!1),{dataEach:function(data$1,idx){var dataParams=seriesModel.getDataParams(idx),itemStyle=extend({},globalStyle);itemStyle[colorKey]=colorCallback(dataParams),data$1.setItemVisual(idx,`style`,itemStyle)}}}},sharedModel=new Model_default,dataStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){if(!(seriesModel.ignoreStyleOnData||ecModel.isSeriesFiltered(seriesModel))){var data=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||`itemStyle`,getStyle$1=getStyleMapper(seriesModel,stylePath),colorKey=data.getVisual(`drawType`);return{dataEach:data.hasItemOption?function(data$1,idx){var rawItem=data$1.getRawDataItem(idx);if(rawItem&&rawItem[stylePath]){sharedModel.option=rawItem[stylePath];var style=getStyle$1(sharedModel),existsStyle=data$1.ensureUniqueItemVisual(idx,`style`);extend(existsStyle,style),sharedModel.option.decal&&(data$1.setItemVisual(idx,`decal`,sharedModel.option.decal),sharedModel.option.decal.dirty=!0),colorKey in style&&data$1.setItemVisual(idx,`colorFromPalette`,!1)}}:null}}}},dataColorPaletteTask={performRawSeries:!0,overallReset:function(ecModel){var paletteScopeGroupByType=createHashMap();ecModel.eachSeries(function(seriesModel){var colorBy=seriesModel.getColorBy();if(!seriesModel.isColorBySeries()){var key$1=seriesModel.type+`-`+colorBy,colorScope=paletteScopeGroupByType.get(key$1);colorScope||(colorScope={},paletteScopeGroupByType.set(key$1,colorScope)),inner$7(seriesModel).scope=colorScope}}),ecModel.eachSeries(function(seriesModel){if(!(seriesModel.isColorBySeries()||ecModel.isSeriesFiltered(seriesModel))){var dataAll=seriesModel.getRawData(),idxMap={},data=seriesModel.getData(),colorScope=inner$7(seriesModel).scope,stylePath=seriesModel.visualStyleAccessPath||`itemStyle`,colorKey=getDefaultColorKey(seriesModel,stylePath);data.each(function(idx){var rawIdx=data.getRawIndex(idx);idxMap[rawIdx]=idx}),dataAll.each(function(rawIdx){var idx=idxMap[rawIdx];if(data.getItemVisual(idx,`colorFromPalette`)){var itemStyle=data.ensureUniqueItemVisual(idx,`style`),name_1=dataAll.getName(rawIdx)||rawIdx+``,dataCount=dataAll.count();itemStyle[colorKey]=seriesModel.getColorFromPalette(name_1,colorScope,dataCount)}})}})}},PI$1=Math.PI;function defaultLoading(api,opts){opts||={},defaults(opts,{text:`loading`,textColor:tokens_default.color.primary,fontSize:12,fontWeight:`normal`,fontStyle:`normal`,fontFamily:`sans-serif`,maskColor:`rgba(255,255,255,0.8)`,showSpinner:!0,color:tokens_default.color.theme[0],spinnerRadius:10,lineWidth:5,zlevel:0});var group=new Group_default,mask=new Rect_default({style:{fill:opts.maskColor},zlevel:opts.zlevel,z:1e4});group.add(mask);var textContent=new Text_default({style:{text:opts.text,fill:opts.textColor,fontSize:opts.fontSize,fontWeight:opts.fontWeight,fontStyle:opts.fontStyle,fontFamily:opts.fontFamily},zlevel:opts.zlevel,z:10001}),labelRect=new Rect_default({style:{fill:`none`},textContent,textConfig:{position:`right`,distance:10},zlevel:opts.zlevel,z:10001});group.add(labelRect);var arc;return opts.showSpinner&&(arc=new Arc_default({shape:{startAngle:-PI$1/2,endAngle:-PI$1/2+.1,r:opts.spinnerRadius},style:{stroke:opts.color,lineCap:`round`,lineWidth:opts.lineWidth},zlevel:opts.zlevel,z:10001}),arc.animateShape(!0).when(1e3,{endAngle:PI$1*3/2}).start(`circularInOut`),arc.animateShape(!0).when(1e3,{startAngle:PI$1*3/2}).delay(300).start(`circularInOut`),group.add(arc)),group.resize=function(){var textWidth=textContent.getBoundingRect().width,r$1=opts.showSpinner?opts.spinnerRadius:0,cx=(api.getWidth()-r$1*2-(opts.showSpinner&&textWidth?10:0)-textWidth)/2-(opts.showSpinner&&textWidth?0:5+textWidth/2)+(opts.showSpinner?0:textWidth/2)+(textWidth?0:r$1),cy=api.getHeight()/2;opts.showSpinner&&arc.setShape({cx,cy}),labelRect.setShape({x:cx-r$1,y:cy-r$1,width:r$1*2,height:r$1*2}),mask.setShape({x:0,y:0,width:api.getWidth(),height:api.getHeight()})},group.resize(),group}var Scheduler=function(){function Scheduler$1(ecInstance,api,dataProcessorHandlers,visualHandlers){this._stageTaskMap=createHashMap(),this.ecInstance=ecInstance,this.api=api,dataProcessorHandlers=this._dataProcessorHandlers=dataProcessorHandlers.slice(),visualHandlers=this._visualHandlers=visualHandlers.slice(),this._allHandlers=dataProcessorHandlers.concat(visualHandlers)}return Scheduler$1.prototype.restoreData=function(ecModel,payload){ecModel.restoreData(payload),this._stageTaskMap.each(function(taskRecord){var overallTask=taskRecord.overallTask;overallTask&&overallTask.dirty()})},Scheduler$1.prototype.getPerformArgs=function(task,isBlock){if(task.__pipeline){var pipeline=this._pipelineMap.get(task.__pipeline.id),pCtx=pipeline.context,step=!isBlock&&pipeline.progressiveEnabled&&(!pCtx||pCtx.progressiveRender)&&task.__idxInPipeline>pipeline.blockIndex?pipeline.step:null,modDataCount=pCtx&&pCtx.modDataCount,modBy=modDataCount==null?null:Math.ceil(modDataCount/step);return{step,modBy,modDataCount}}},Scheduler$1.prototype.getPipeline=function(pipelineId){return this._pipelineMap.get(pipelineId)},Scheduler$1.prototype.updateStreamModes=function(seriesModel,view){var pipeline=this._pipelineMap.get(seriesModel.uid),dataLen=seriesModel.getData().count(),progressiveRender=pipeline.progressiveEnabled&&view.incrementalPrepareRender&&dataLen>=pipeline.threshold,large=seriesModel.get(`large`)&&dataLen>=seriesModel.get(`largeThreshold`),modDataCount=seriesModel.get(`progressiveChunkMode`)===`mod`?dataLen:null;seriesModel.pipelineContext=pipeline.context={progressiveRender,modDataCount,large}},Scheduler$1.prototype.restorePipelines=function(ecModel){var scheduler=this,pipelineMap=scheduler._pipelineMap=createHashMap();ecModel.eachSeries(function(seriesModel){var progressive=seriesModel.getProgressive(),pipelineId=seriesModel.uid;pipelineMap.set(pipelineId,{id:pipelineId,head:null,tail:null,threshold:seriesModel.getProgressiveThreshold(),progressiveEnabled:progressive&&!(seriesModel.preventIncremental&&seriesModel.preventIncremental()),blockIndex:-1,step:Math.round(progressive||700),count:0}),scheduler._pipe(seriesModel,seriesModel.dataTask)})},Scheduler$1.prototype.prepareStageTasks=function(){var stageTaskMap=this._stageTaskMap,ecModel=this.api.getModel(),api=this.api;each(this._allHandlers,function(handler){var record=stageTaskMap.get(handler.uid)||stageTaskMap.set(handler.uid,{});assert(!(handler.reset&&handler.overallReset),``),handler.reset&&this._createSeriesStageTask(handler,record,ecModel,api),handler.overallReset&&this._createOverallStageTask(handler,record,ecModel,api)},this)},Scheduler$1.prototype.prepareView=function(view,model,ecModel,api){var renderTask=view.renderTask,context$1=renderTask.context;context$1.model=model,context$1.ecModel=ecModel,context$1.api=api,renderTask.__block=!view.incrementalPrepareRender,this._pipe(model,renderTask)},Scheduler$1.prototype.performDataProcessorTasks=function(ecModel,payload){this._performStageTasks(this._dataProcessorHandlers,ecModel,payload,{block:!0})},Scheduler$1.prototype.performVisualTasks=function(ecModel,payload,opt){this._performStageTasks(this._visualHandlers,ecModel,payload,opt)},Scheduler$1.prototype._performStageTasks=function(stageHandlers,ecModel,payload,opt){opt||={};var unfinished=!1,scheduler=this;each(stageHandlers,function(stageHandler,idx){if(!(opt.visualType&&opt.visualType!==stageHandler.visualType)){var stageHandlerRecord=scheduler._stageTaskMap.get(stageHandler.uid),seriesTaskMap=stageHandlerRecord.seriesTaskMap,overallTask=stageHandlerRecord.overallTask;if(overallTask){var overallNeedDirty_1,agentStubMap=overallTask.agentStubMap;agentStubMap.each(function(stub){needSetDirty(opt,stub)&&(stub.dirty(),overallNeedDirty_1=!0)}),overallNeedDirty_1&&overallTask.dirty(),scheduler.updatePayload(overallTask,payload);var performArgs_1=scheduler.getPerformArgs(overallTask,opt.block);agentStubMap.each(function(stub){stub.perform(performArgs_1)}),overallTask.perform(performArgs_1)&&(unfinished=!0)}else seriesTaskMap&&seriesTaskMap.each(function(task,pipelineId){needSetDirty(opt,task)&&task.dirty();var performArgs=scheduler.getPerformArgs(task,opt.block);performArgs.skip=!stageHandler.performRawSeries&&ecModel.isSeriesFiltered(task.context.model),scheduler.updatePayload(task,payload),task.perform(performArgs)&&(unfinished=!0)})}});function needSetDirty(opt$1,task){return opt$1.setDirty&&(!opt$1.dirtyMap||opt$1.dirtyMap.get(task.__pipeline.id))}this.unfinished=unfinished||this.unfinished},Scheduler$1.prototype.performSeriesTasks=function(ecModel){var unfinished;ecModel.eachSeries(function(seriesModel){unfinished=seriesModel.dataTask.perform()||unfinished}),this.unfinished=unfinished||this.unfinished},Scheduler$1.prototype.plan=function(){this._pipelineMap.each(function(pipeline){var task=pipeline.tail;do{if(task.__block){pipeline.blockIndex=task.__idxInPipeline;break}task=task.getUpstream()}while(task)})},Scheduler$1.prototype.updatePayload=function(task,payload){payload!==`remain`&&(task.context.payload=payload)},Scheduler$1.prototype._createSeriesStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,oldSeriesTaskMap=stageHandlerRecord.seriesTaskMap,newSeriesTaskMap=stageHandlerRecord.seriesTaskMap=createHashMap(),seriesType$1=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries;stageHandler.createOnAllSeries?ecModel.eachRawSeries(create$2):seriesType$1?ecModel.eachRawSeriesByType(seriesType$1,create$2):getTargetSeries&&getTargetSeries(ecModel,api).each(create$2);function create$2(seriesModel){var pipelineId=seriesModel.uid,task=newSeriesTaskMap.set(pipelineId,oldSeriesTaskMap&&oldSeriesTaskMap.get(pipelineId)||createTask({plan:seriesTaskPlan,reset:seriesTaskReset,count:seriesTaskCount}));task.context={model:seriesModel,ecModel,api,useClearVisual:stageHandler.isVisual&&!stageHandler.isLayout,plan:stageHandler.plan,reset:stageHandler.reset,scheduler},scheduler._pipe(seriesModel,task)}},Scheduler$1.prototype._createOverallStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,overallTask=stageHandlerRecord.overallTask=stageHandlerRecord.overallTask||createTask({reset:overallTaskReset});overallTask.context={ecModel,api,overallReset:stageHandler.overallReset,scheduler};var oldAgentStubMap=overallTask.agentStubMap,newAgentStubMap=overallTask.agentStubMap=createHashMap(),seriesType$1=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries,overallProgress=!0,shouldOverallTaskDirty=!1;assert(!stageHandler.createOnAllSeries,``),seriesType$1?ecModel.eachRawSeriesByType(seriesType$1,createStub):getTargetSeries?getTargetSeries(ecModel,api).each(createStub):(overallProgress=!1,each(ecModel.getSeries(),createStub));function createStub(seriesModel){var pipelineId=seriesModel.uid,stub=newAgentStubMap.set(pipelineId,oldAgentStubMap&&oldAgentStubMap.get(pipelineId)||(shouldOverallTaskDirty=!0,createTask({reset:stubReset,onDirty:stubOnDirty})));stub.context={model:seriesModel,overallProgress},stub.agent=overallTask,stub.__block=overallProgress,scheduler._pipe(seriesModel,stub)}shouldOverallTaskDirty&&overallTask.dirty()},Scheduler$1.prototype._pipe=function(seriesModel,task){var pipelineId=seriesModel.uid,pipeline=this._pipelineMap.get(pipelineId);!pipeline.head&&(pipeline.head=task),pipeline.tail&&pipeline.tail.pipe(task),pipeline.tail=task,task.__idxInPipeline=pipeline.count++,task.__pipeline=pipeline},Scheduler$1.wrapStageHandler=function(stageHandler,visualType){return isFunction(stageHandler)&&(stageHandler={overallReset:stageHandler,seriesType:detectSeriseType(stageHandler)}),stageHandler.uid=getUID(`stageHandler`),visualType&&(stageHandler.visualType=visualType),stageHandler},Scheduler$1}();function overallTaskReset(context$1){context$1.overallReset(context$1.ecModel,context$1.api,context$1.payload)}function stubReset(context$1){return context$1.overallProgress&&stubProgress}function stubProgress(){this.agent.dirty(),this.getDownstream().dirty()}function stubOnDirty(){this.agent&&this.agent.dirty()}function seriesTaskPlan(context$1){return context$1.plan?context$1.plan(context$1.model,context$1.ecModel,context$1.api,context$1.payload):null}function seriesTaskReset(context$1){context$1.useClearVisual&&context$1.data.clearAllVisual();var resetDefines=context$1.resetDefines=normalizeToArray(context$1.reset(context$1.model,context$1.ecModel,context$1.api,context$1.payload));return resetDefines.length>1?map(resetDefines,function(v$1,idx){return makeSeriesTaskProgress(idx)}):singleSeriesTaskProgress}var singleSeriesTaskProgress=makeSeriesTaskProgress(0);function makeSeriesTaskProgress(resetDefineIdx){return function(params,context$1){var data=context$1.data,resetDefine=context$1.resetDefines[resetDefineIdx];if(resetDefine&&resetDefine.dataEach)for(var i$1=params.start;i$1<params.end;i$1++)resetDefine.dataEach(data,i$1);else resetDefine&&resetDefine.progress&&resetDefine.progress(params,data)}}function seriesTaskCount(context$1){return context$1.data.count()}function detectSeriseType(legacyFunc){seriesType=null;try{legacyFunc(ecModelMock,apiMock)}catch{}return seriesType}var ecModelMock={},apiMock={},seriesType;mockMethods(ecModelMock,Global_default),mockMethods(apiMock,ExtensionAPI_default),ecModelMock.eachSeriesByType=ecModelMock.eachRawSeriesByType=function(type){seriesType=type},ecModelMock.eachComponent=function(cond){cond.mainType===`series`&&cond.subType&&(seriesType=cond.subType)};function mockMethods(target,Clz){for(var name_1 in Clz.prototype)target[name_1]=noop}var Scheduler_default=Scheduler,color=tokens_default.darkColor,backgroundColor=color.background,axisCommon=function(){return{axisLine:{lineStyle:{color:color.axisLine}},splitLine:{lineStyle:{color:color.axisSplitLine}},splitArea:{areaStyle:{color:[color.backgroundTint,color.backgroundTransparent]}},minorSplitLine:{lineStyle:{color:color.axisMinorSplitLine}},axisLabel:{color:color.axisLabel},axisName:{}}},matrixAxis={label:{color:color.secondary},itemStyle:{borderColor:color.borderTint},dividerLineStyle:{color:color.border}},theme={darkMode:!0,color:color.theme,backgroundColor,axisPointer:{lineStyle:{color:color.border},crossStyle:{color:color.borderShade},label:{color:color.tertiary}},legend:{textStyle:{color:color.secondary},pageTextStyle:{color:color.tertiary}},textStyle:{color:color.secondary},title:{textStyle:{color:color.primary},subtextStyle:{color:color.quaternary}},toolbox:{iconStyle:{borderColor:color.accent50}},tooltip:{backgroundColor:color.neutral20,defaultBorderColor:color.border,textStyle:{color:color.tertiary}},dataZoom:{borderColor:color.accent10,textStyle:{color:color.tertiary},brushStyle:{color:color.backgroundTint},handleStyle:{color:color.neutral00,borderColor:color.accent20},moveHandleStyle:{color:color.accent40},emphasis:{handleStyle:{borderColor:color.accent50}},dataBackground:{lineStyle:{color:color.accent30},areaStyle:{color:color.accent20}},selectedDataBackground:{lineStyle:{color:color.accent50},areaStyle:{color:color.accent30}}},visualMap:{textStyle:{color:color.secondary},handleStyle:{borderColor:color.neutral30}},timeline:{lineStyle:{color:color.accent10},label:{color:color.tertiary},controlStyle:{color:color.accent30,borderColor:color.accent30}},calendar:{itemStyle:{color:color.neutral00,borderColor:color.neutral20},dayLabel:{color:color.tertiary},monthLabel:{color:color.secondary},yearLabel:{color:color.secondary}},matrix:{x:matrixAxis,y:matrixAxis,backgroundColor:{borderColor:color.axisLine},body:{itemStyle:{borderColor:color.borderTint}}},timeAxis:axisCommon(),logAxis:axisCommon(),valueAxis:axisCommon(),categoryAxis:axisCommon(),line:{symbol:`circle`},graph:{color:color.theme},gauge:{title:{color:color.secondary},axisLine:{lineStyle:{color:[[1,color.neutral05]]}},axisLabel:{color:color.axisLabel},detail:{color:color.primary}},candlestick:{itemStyle:{color:`#f64e56`,color0:`#54ea92`,borderColor:`#f64e56`,borderColor0:`#54ea92`}},funnel:{itemStyle:{borderColor:color.background}},radar:function(){var radar=axisCommon();return radar.axisName={color:color.axisLabel},radar.axisLine.lineStyle.color=color.neutral20,radar}(),treemap:{breadcrumb:{itemStyle:{color:color.neutral20,textStyle:{color:color.secondary}},emphasis:{itemStyle:{color:color.neutral30}}}},sunburst:{itemStyle:{borderColor:color.background}},map:{itemStyle:{borderColor:color.border,areaColor:color.neutral10},label:{color:color.tertiary},emphasis:{label:{color:color.primary},itemStyle:{areaColor:color.highlight}},select:{label:{color:color.primary},itemStyle:{areaColor:color.highlight}}},geo:{itemStyle:{borderColor:color.border,areaColor:color.neutral10},emphasis:{label:{color:color.primary},itemStyle:{areaColor:color.highlight}},select:{label:{color:color.primary},itemStyle:{color:color.highlight}}}};theme.categoryAxis.splitLine.show=!1;var dark_default=theme,ECEventProcessor=function(){function ECEventProcessor$1(){}return ECEventProcessor$1.prototype.normalizeQuery=function(query){var cptQuery={},dataQuery={},otherQuery={};if(isString(query)){var condCptType=parseClassType(query);cptQuery.mainType=condCptType.main||null,cptQuery.subType=condCptType.sub||null}else{var suffixes_1=[`Index`,`Name`,`Id`],dataKeys_1={name:1,dataIndex:1,dataType:1};each(query,function(val,key$1){for(var reserved=!1,i$1=0;i$1<suffixes_1.length;i$1++){var propSuffix=suffixes_1[i$1],suffixPos=key$1.lastIndexOf(propSuffix);if(suffixPos>0&&suffixPos===key$1.length-propSuffix.length){var mainType=key$1.slice(0,suffixPos);mainType!==`data`&&(cptQuery.mainType=mainType,cptQuery[propSuffix.toLowerCase()]=val,reserved=!0)}}dataKeys_1.hasOwnProperty(key$1)&&(dataQuery[key$1]=val,reserved=!0),reserved||(otherQuery[key$1]=val)})}return{cptQuery,dataQuery,otherQuery}},ECEventProcessor$1.prototype.filter=function(eventType,query){var eventInfo=this.eventInfo;if(!eventInfo)return!0;var targetEl=eventInfo.targetEl,packedEvent=eventInfo.packedEvent,model=eventInfo.model,view=eventInfo.view;if(!model||!view)return!0;var cptQuery=query.cptQuery,dataQuery=query.dataQuery;return check(cptQuery,model,`mainType`)&&check(cptQuery,model,`subType`)&&check(cptQuery,model,`index`,`componentIndex`)&&check(cptQuery,model,`name`)&&check(cptQuery,model,`id`)&&check(dataQuery,packedEvent,`name`)&&check(dataQuery,packedEvent,`dataIndex`)&&check(dataQuery,packedEvent,`dataType`)&&(!view.filterForExposedEvent||view.filterForExposedEvent(eventType,query.otherQuery,targetEl,packedEvent));function check(query$1,host,prop,propOnHost){return query$1[prop]==null||host[propOnHost||prop]===query$1[prop]}},ECEventProcessor$1.prototype.afterTrigger=function(){this.eventInfo=null},ECEventProcessor$1}(),SYMBOL_PROPS_WITH_CB=[`symbol`,`symbolSize`,`symbolRotate`,`symbolOffset`],SYMBOL_PROPS=SYMBOL_PROPS_WITH_CB.concat([`symbolKeepAspect`]),seriesSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData();if(seriesModel.legendIcon&&data.setVisual(`legendIcon`,seriesModel.legendIcon),!seriesModel.hasSymbolVisual)return;for(var symbolOptions={},symbolOptionsCb={},hasCallback=!1,i$1=0;i$1<SYMBOL_PROPS_WITH_CB.length;i$1++){var symbolPropName=SYMBOL_PROPS_WITH_CB[i$1],val=seriesModel.get(symbolPropName);isFunction(val)?(hasCallback=!0,symbolOptionsCb[symbolPropName]=val):symbolOptions[symbolPropName]=val}if(symbolOptions.symbol=symbolOptions.symbol||seriesModel.defaultSymbol,data.setVisual(extend({legendIcon:seriesModel.legendIcon||symbolOptions.symbol,symbolKeepAspect:seriesModel.get(`symbolKeepAspect`)},symbolOptions)),ecModel.isSeriesFiltered(seriesModel))return;var symbolPropsCb=keys(symbolOptionsCb);function dataEach(data$1,idx){for(var rawValue=seriesModel.getRawValue(idx),params=seriesModel.getDataParams(idx),i$2=0;i$2<symbolPropsCb.length;i$2++){var symbolPropName$1=symbolPropsCb[i$2];data$1.setItemVisual(idx,symbolPropName$1,symbolOptionsCb[symbolPropName$1](rawValue,params))}}return{dataEach:hasCallback?dataEach:null}}},dataSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){if(!seriesModel.hasSymbolVisual||ecModel.isSeriesFiltered(seriesModel))return;var data=seriesModel.getData();function dataEach(data$1,idx){for(var itemModel=data$1.getItemModel(idx),i$1=0;i$1<SYMBOL_PROPS.length;i$1++){var symbolPropName=SYMBOL_PROPS[i$1],val=itemModel.getShallow(symbolPropName,!0);val!=null&&data$1.setItemVisual(idx,symbolPropName,val)}}return{dataEach:data.hasItemOption?dataEach:null}}};function getItemVisualFromData(data,dataIndex,key$1){switch(key$1){case`color`:return data.getItemVisual(dataIndex,`style`)[data.getVisual(`drawType`)];case`opacity`:return data.getItemVisual(dataIndex,`style`).opacity;case`symbol`:case`symbolSize`:case`liftZ`:return data.getItemVisual(dataIndex,key$1);default:}}function getVisualFromData(data,key$1){switch(key$1){case`color`:return data.getVisual(`style`)[data.getVisual(`drawType`)];case`opacity`:return data.getVisual(`style`).opacity;case`symbol`:case`symbolSize`:case`liftZ`:return data.getVisual(key$1);default:}}function handleSeriesLegacySelectEvents(type,eventPostfix,ecIns,ecModel,payload){var legacyEventName=type+eventPostfix;ecIns.isSilent(legacyEventName)||ecModel.eachComponent({mainType:`series`,subType:`pie`},function(seriesModel){for(var seriesIndex=seriesModel.seriesIndex,selectedMap=seriesModel.option.selectedMap,selected=payload.selected,i$1=0;i$1<selected.length;i$1++)if(selected[i$1].seriesIndex===seriesIndex){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload.fromActionPayload);ecIns.trigger(legacyEventName,{type:legacyEventName,seriesId:seriesModel.id,name:isArray(dataIndex)?data.getName(dataIndex[0]):data.getName(dataIndex),selected:isString(selectedMap)?selectedMap:extend({},selectedMap)})}})}function handleLegacySelectEvents(messageCenter,ecIns,api){messageCenter.on(`selectchanged`,function(params){var ecModel=api.getModel();params.isFromClick?(handleSeriesLegacySelectEvents(`map`,`selectchanged`,ecIns,ecModel,params),handleSeriesLegacySelectEvents(`pie`,`selectchanged`,ecIns,ecModel,params)):params.fromAction===`select`?(handleSeriesLegacySelectEvents(`map`,`selected`,ecIns,ecModel,params),handleSeriesLegacySelectEvents(`pie`,`selected`,ecIns,ecModel,params)):params.fromAction===`unselect`&&(handleSeriesLegacySelectEvents(`map`,`unselected`,ecIns,ecModel,params),handleSeriesLegacySelectEvents(`pie`,`unselected`,ecIns,ecModel,params))})}function findEventDispatcher(target,det,returnFirstMatch){for(var found;target&&!(det(target)&&(found=target,returnFirstMatch));)target=target.__hostTarget||target.parent;return found}var wmUniqueIndex=Math.round(Math.random()*9),supportDefineProperty=typeof Object.defineProperty==`function`,WeakMap_default=function(){function WeakMap$2(){this._id=`__ec_inner_`+ wmUniqueIndex++}return WeakMap$2.prototype.get=function(key$1){return this._guard(key$1)[this._id]},WeakMap$2.prototype.set=function(key$1,value){var target=this._guard(key$1);return supportDefineProperty?Object.defineProperty(target,this._id,{value,enumerable:!1,configurable:!0}):target[this._id]=value,this},WeakMap$2.prototype.delete=function(key$1){return this.has(key$1)?(delete this._guard(key$1)[this._id],!0):!1},WeakMap$2.prototype.has=function(key$1){return!!this._guard(key$1)[this._id]},WeakMap$2.prototype._guard=function(key$1){if(key$1!==Object(key$1))throw TypeError(`Value of WeakMap is not a non-null object.`);return key$1},WeakMap$2}(),Triangle=Path_default.extend({type:`triangle`,shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path$1,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,height=shape.height/2;path$1.moveTo(cx,cy-height),path$1.lineTo(cx+width,cy+height),path$1.lineTo(cx-width,cy+height),path$1.closePath()}}),Diamond=Path_default.extend({type:`diamond`,shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path$1,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,height=shape.height/2;path$1.moveTo(cx,cy-height),path$1.lineTo(cx+width,cy),path$1.lineTo(cx,cy+height),path$1.lineTo(cx-width,cy),path$1.closePath()}}),Pin=Path_default.extend({type:`pin`,shape:{x:0,y:0,width:0,height:0},buildPath:function(path$1,shape){var x$1=shape.x,y$1=shape.y,w$1=shape.width/5*3,h$2=Math.max(w$1,shape.height),r$1=w$1/2,dy=r$1*r$1/(h$2-r$1),cy=y$1-h$2+r$1+dy,angle=Math.asin(dy/r$1),dx=Math.cos(angle)*r$1,tanX=Math.sin(angle),tanY=Math.cos(angle),cpLen=r$1*.6,cpLen2=r$1*.7;path$1.moveTo(x$1-dx,cy+dy),path$1.arc(x$1,cy,r$1,Math.PI-angle,Math.PI*2+angle),path$1.bezierCurveTo(x$1+dx-tanX*cpLen,cy+dy+tanY*cpLen,x$1,y$1-cpLen2,x$1,y$1),path$1.bezierCurveTo(x$1,y$1-cpLen2,x$1-dx+tanX*cpLen,cy+dy+tanY*cpLen,x$1-dx,cy+dy),path$1.closePath()}}),Arrow=Path_default.extend({type:`arrow`,shape:{x:0,y:0,width:0,height:0},buildPath:function(ctx,shape){var height=shape.height,width=shape.width,x$1=shape.x,y$1=shape.y,dx=width/3*2;ctx.moveTo(x$1,y$1),ctx.lineTo(x$1+dx,y$1+height),ctx.lineTo(x$1,y$1+height/4*3),ctx.lineTo(x$1-dx,y$1+height),ctx.lineTo(x$1,y$1),ctx.closePath()}}),symbolCtors={line:Line_default,rect:Rect_default,roundRect:Rect_default,square:Rect_default,circle:Circle_default,diamond:Diamond,pin:Pin,arrow:Arrow,triangle:Triangle},symbolShapeMakers={line:function(x$1,y$1,w$1,h$2,shape){shape.x1=x$1,shape.y1=y$1+h$2/2,shape.x2=x$1+w$1,shape.y2=y$1+h$2/2},rect:function(x$1,y$1,w$1,h$2,shape){shape.x=x$1,shape.y=y$1,shape.width=w$1,shape.height=h$2},roundRect:function(x$1,y$1,w$1,h$2,shape){shape.x=x$1,shape.y=y$1,shape.width=w$1,shape.height=h$2,shape.r=Math.min(w$1,h$2)/4},square:function(x$1,y$1,w$1,h$2,shape){var size=Math.min(w$1,h$2);shape.x=x$1,shape.y=y$1,shape.width=size,shape.height=size},circle:function(x$1,y$1,w$1,h$2,shape){shape.cx=x$1+w$1/2,shape.cy=y$1+h$2/2,shape.r=Math.min(w$1,h$2)/2},diamond:function(x$1,y$1,w$1,h$2,shape){shape.cx=x$1+w$1/2,shape.cy=y$1+h$2/2,shape.width=w$1,shape.height=h$2},pin:function(x$1,y$1,w$1,h$2,shape){shape.x=x$1+w$1/2,shape.y=y$1+h$2/2,shape.width=w$1,shape.height=h$2},arrow:function(x$1,y$1,w$1,h$2,shape){shape.x=x$1+w$1/2,shape.y=y$1+h$2/2,shape.width=w$1,shape.height=h$2},triangle:function(x$1,y$1,w$1,h$2,shape){shape.cx=x$1+w$1/2,shape.cy=y$1+h$2/2,shape.width=w$1,shape.height=h$2}},symbolBuildProxies={};each(symbolCtors,function(Ctor,name){symbolBuildProxies[name]=new Ctor});var SymbolClz=Path_default.extend({type:`symbol`,shape:{symbolType:``,x:0,y:0,width:0,height:0},calculateTextPosition:function(out$2,config,rect){var res=calculateTextPosition(out$2,config,rect),shape=this.shape;return shape&&shape.symbolType===`pin`&&config.position===`inside`&&(res.y=rect.y+rect.height*.4),res},buildPath:function(ctx,shape,inBundle){var symbolType=shape.symbolType;if(symbolType!==`none`){var proxySymbol=symbolBuildProxies[symbolType];proxySymbol||=(symbolType=`rect`,symbolBuildProxies[symbolType]),symbolShapeMakers[symbolType](shape.x,shape.y,shape.width,shape.height,proxySymbol.shape),proxySymbol.buildPath(ctx,proxySymbol.shape,inBundle)}}});function symbolPathSetColor(color$2,innerColor$1){if(this.type!==`image`){var symbolStyle=this.style;this.__isEmptyBrush?(symbolStyle.stroke=color$2,symbolStyle.fill=innerColor$1||tokens_default.color.neutral00,symbolStyle.lineWidth=2):this.shape.symbolType===`line`?symbolStyle.stroke=color$2:symbolStyle.fill=color$2,this.markRedraw()}}function createSymbol(symbolType,x$1,y$1,w$1,h$2,color$2,keepAspect){var isEmpty=symbolType.indexOf(`empty`)===0;isEmpty&&(symbolType=symbolType.substr(5,1).toLowerCase()+symbolType.substr(6));var symbolPath=symbolType.indexOf(`image://`)===0?makeImage(symbolType.slice(8),new BoundingRect_default(x$1,y$1,w$1,h$2),keepAspect?`center`:`cover`):symbolType.indexOf(`path://`)===0?makePath(symbolType.slice(7),{},new BoundingRect_default(x$1,y$1,w$1,h$2),keepAspect?`center`:`cover`):new SymbolClz({shape:{symbolType,x:x$1,y:y$1,width:w$1,height:h$2}});return symbolPath.__isEmptyBrush=isEmpty,symbolPath.setColor=symbolPathSetColor,color$2&&symbolPath.setColor(color$2),symbolPath}function normalizeSymbolSize(symbolSize){return isArray(symbolSize)||(symbolSize=[+symbolSize,+symbolSize]),[symbolSize[0]||0,symbolSize[1]||0]}function normalizeSymbolOffset(symbolOffset,symbolSize){if(symbolOffset!=null)return isArray(symbolOffset)||(symbolOffset=[symbolOffset,symbolOffset]),[parsePercent(symbolOffset[0],symbolSize[0])||0,parsePercent(retrieve2(symbolOffset[1],symbolOffset[0]),symbolSize[1])||0]}function isSafeNum(num){return isFinite(num)}function createLinearGradient(ctx,obj,rect){var x$1=obj.x==null?0:obj.x,x2=obj.x2==null?1:obj.x2,y$1=obj.y==null?0:obj.y,y2=obj.y2==null?0:obj.y2;return obj.global||(x$1=x$1*rect.width+rect.x,x2=x2*rect.width+rect.x,y$1=y$1*rect.height+rect.y,y2=y2*rect.height+rect.y),x$1=isSafeNum(x$1)?x$1:0,x2=isSafeNum(x2)?x2:1,y$1=isSafeNum(y$1)?y$1:0,y2=isSafeNum(y2)?y2:0,ctx.createLinearGradient(x$1,y$1,x2,y2)}function createRadialGradient(ctx,obj,rect){var width=rect.width,height=rect.height,min$2=Math.min(width,height),x$1=obj.x==null?.5:obj.x,y$1=obj.y==null?.5:obj.y,r$1=obj.r==null?.5:obj.r;return obj.global||(x$1=x$1*width+rect.x,y$1=y$1*height+rect.y,r$1*=min$2),x$1=isSafeNum(x$1)?x$1:.5,y$1=isSafeNum(y$1)?y$1:.5,r$1=r$1>=0&&isSafeNum(r$1)?r$1:.5,ctx.createRadialGradient(x$1,y$1,0,x$1,y$1,r$1)}function getCanvasGradient(ctx,obj,rect){for(var canvasGradient=obj.type===`radial`?createRadialGradient(ctx,obj,rect):createLinearGradient(ctx,obj,rect),colorStops=obj.colorStops,i$1=0;i$1<colorStops.length;i$1++)canvasGradient.addColorStop(colorStops[i$1].offset,colorStops[i$1].color);return canvasGradient}function isClipPathChanged(clipPaths,prevClipPaths){if(clipPaths===prevClipPaths||!clipPaths&&!prevClipPaths)return!1;if(!clipPaths||!prevClipPaths||clipPaths.length!==prevClipPaths.length)return!0;for(var i$1=0;i$1<clipPaths.length;i$1++)if(clipPaths[i$1]!==prevClipPaths[i$1])return!0;return!1}function parseInt10(val){return parseInt(val,10)}function getSize(root,whIdx,opts){var wh=[`width`,`height`][whIdx],cwh=[`clientWidth`,`clientHeight`][whIdx],plt=[`paddingLeft`,`paddingTop`][whIdx],prb=[`paddingRight`,`paddingBottom`][whIdx];if(opts[wh]!=null&&opts[wh]!==`auto`)return parseFloat(opts[wh]);var stl=document.defaultView.getComputedStyle(root);return(root[cwh]||parseInt10(stl[wh])||parseInt10(root.style[wh]))-(parseInt10(stl[plt])||0)-(parseInt10(stl[prb])||0)|0}function normalizeLineDash(lineType,lineWidth){return!lineType||lineType===`solid`||!(lineWidth>0)?null:lineType===`dashed`?[4*lineWidth,2*lineWidth]:lineType===`dotted`?[lineWidth]:isNumber(lineType)?[lineType]:isArray(lineType)?lineType:null}function getLineDash(el){var style=el.style,lineDash=style.lineDash&&style.lineWidth>0&&normalizeLineDash(style.lineDash,style.lineWidth),lineDashOffset=style.lineDashOffset;if(lineDash){var lineScale_1=style.strokeNoScale&&el.getLineScale?el.getLineScale():1;lineScale_1&&lineScale_1!==1&&(lineDash=map(lineDash,function(rawVal){return rawVal/lineScale_1}),lineDashOffset/=lineScale_1)}return[lineDash,lineDashOffset]}var pathProxyForDraw=new PathProxy_default(!0);function styleHasStroke(style){var stroke=style.stroke;return!(stroke==null||stroke===`none`||!(style.lineWidth>0))}function isValidStrokeFillStyle(strokeOrFill){return typeof strokeOrFill==`string`&&strokeOrFill!==`none`}function styleHasFill(style){var fill=style.fill;return fill!=null&&fill!==`none`}function doFillPath(ctx,style){if(style.fillOpacity!=null&&style.fillOpacity!==1){var originalGlobalAlpha=ctx.globalAlpha;ctx.globalAlpha=style.fillOpacity*style.opacity,ctx.fill(),ctx.globalAlpha=originalGlobalAlpha}else ctx.fill()}function doStrokePath(ctx,style){if(style.strokeOpacity!=null&&style.strokeOpacity!==1){var originalGlobalAlpha=ctx.globalAlpha;ctx.globalAlpha=style.strokeOpacity*style.opacity,ctx.stroke(),ctx.globalAlpha=originalGlobalAlpha}else ctx.stroke()}function createCanvasPattern(ctx,pattern,el){var image=createOrUpdateImage(pattern.image,pattern.__image,el);if(isImageReady(image)){var canvasPattern=ctx.createPattern(image,pattern.repeat||`repeat`);if(typeof DOMMatrix==`function`&&canvasPattern&&canvasPattern.setTransform){var matrix=new DOMMatrix;matrix.translateSelf(pattern.x||0,pattern.y||0),matrix.rotateSelf(0,0,(pattern.rotation||0)*RADIAN_TO_DEGREE),matrix.scaleSelf(pattern.scaleX||1,pattern.scaleY||1),canvasPattern.setTransform(matrix)}return canvasPattern}}function brushPath(ctx,el,style,inBatch){var _a$1,hasStroke=styleHasStroke(style),hasFill=styleHasFill(style),strokePercent=style.strokePercent,strokePart=strokePercent<1,firstDraw=!el.path;(!el.silent||strokePart)&&firstDraw&&el.createPathProxy();var path$1=el.path||pathProxyForDraw,dirtyFlag=el.__dirty;if(!inBatch){var fill=style.fill,stroke=style.stroke,hasFillGradient=hasFill&&!!fill.colorStops,hasStrokeGradient=hasStroke&&!!stroke.colorStops,hasFillPattern=hasFill&&!!fill.image,hasStrokePattern=hasStroke&&!!stroke.image,fillGradient=void 0,strokeGradient=void 0,fillPattern=void 0,strokePattern=void 0,rect=void 0;(hasFillGradient||hasStrokeGradient)&&(rect=el.getBoundingRect()),hasFillGradient&&(fillGradient=dirtyFlag?getCanvasGradient(ctx,fill,rect):el.__canvasFillGradient,el.__canvasFillGradient=fillGradient),hasStrokeGradient&&(strokeGradient=dirtyFlag?getCanvasGradient(ctx,stroke,rect):el.__canvasStrokeGradient,el.__canvasStrokeGradient=strokeGradient),hasFillPattern&&(fillPattern=dirtyFlag||!el.__canvasFillPattern?createCanvasPattern(ctx,fill,el):el.__canvasFillPattern,el.__canvasFillPattern=fillPattern),hasStrokePattern&&(strokePattern=dirtyFlag||!el.__canvasStrokePattern?createCanvasPattern(ctx,stroke,el):el.__canvasStrokePattern,el.__canvasStrokePattern=strokePattern),hasFillGradient?ctx.fillStyle=fillGradient:hasFillPattern&&(fillPattern?ctx.fillStyle=fillPattern:hasFill=!1),hasStrokeGradient?ctx.strokeStyle=strokeGradient:hasStrokePattern&&(strokePattern?ctx.strokeStyle=strokePattern:hasStroke=!1)}var scale$3=el.getGlobalScale();path$1.setScale(scale$3[0],scale$3[1],el.segmentIgnoreThreshold);var lineDash,lineDashOffset;ctx.setLineDash&&style.lineDash&&(_a$1=getLineDash(el),lineDash=_a$1[0],lineDashOffset=_a$1[1]);var needsRebuild=!0;(firstDraw||dirtyFlag&4)&&(path$1.setDPR(ctx.dpr),strokePart?path$1.setContext(null):(path$1.setContext(ctx),needsRebuild=!1),path$1.reset(),el.buildPath(path$1,el.shape,inBatch),path$1.toStatic(),el.pathUpdated()),needsRebuild&&path$1.rebuildPath(ctx,strokePart?strokePercent:1),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),inBatch||(style.strokeFirst?(hasStroke&&doStrokePath(ctx,style),hasFill&&doFillPath(ctx,style)):(hasFill&&doFillPath(ctx,style),hasStroke&&doStrokePath(ctx,style))),lineDash&&ctx.setLineDash([])}function brushImage(ctx,el,style){var image=el.__image=createOrUpdateImage(style.image,el.__image,el,el.onload);if(!(!image||!isImageReady(image))){var x$1=style.x||0,y$1=style.y||0,width=el.getWidth(),height=el.getHeight(),aspect=image.width/image.height;if(width==null&&height!=null?width=height*aspect:height==null&&width!=null?height=width/aspect:width==null&&height==null&&(width=image.width,height=image.height),style.sWidth&&style.sHeight){var sx=style.sx||0,sy=style.sy||0;ctx.drawImage(image,sx,sy,style.sWidth,style.sHeight,x$1,y$1,width,height)}else if(style.sx&&style.sy){var sx=style.sx,sy=style.sy,sWidth=width-sx,sHeight=height-sy;ctx.drawImage(image,sx,sy,sWidth,sHeight,x$1,y$1,width,height)}else ctx.drawImage(image,x$1,y$1,width,height)}}function brushText(ctx,el,style){var _a$1,text=style.text;if(text!=null&&(text+=``),text){ctx.font=style.font||`12px sans-serif`,ctx.textAlign=style.textAlign,ctx.textBaseline=style.textBaseline;var lineDash=void 0,lineDashOffset=void 0;ctx.setLineDash&&style.lineDash&&(_a$1=getLineDash(el),lineDash=_a$1[0],lineDashOffset=_a$1[1]),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),style.strokeFirst?(styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y),styleHasFill(style)&&ctx.fillText(text,style.x,style.y)):(styleHasFill(style)&&ctx.fillText(text,style.x,style.y),styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y)),lineDash&&ctx.setLineDash([])}}var SHADOW_NUMBER_PROPS=[`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`],STROKE_PROPS=[[`lineCap`,`butt`],[`lineJoin`,`miter`],[`miterLimit`,10]];function bindCommonProps(ctx,style,prevStyle,forceSetAll,scope){var styleChanged=!1;if(!forceSetAll&&(prevStyle||={},style===prevStyle))return!1;if(forceSetAll||style.opacity!==prevStyle.opacity){flushPathDrawn(ctx,scope),styleChanged=!0;var opacity=Math.max(Math.min(style.opacity,1),0);ctx.globalAlpha=isNaN(opacity)?DEFAULT_COMMON_STYLE.opacity:opacity}(forceSetAll||style.blend!==prevStyle.blend)&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx.globalCompositeOperation=style.blend||DEFAULT_COMMON_STYLE.blend);for(var i$1=0;i$1<SHADOW_NUMBER_PROPS.length;i$1++){var propName=SHADOW_NUMBER_PROPS[i$1];(forceSetAll||style[propName]!==prevStyle[propName])&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx[propName]=ctx.dpr*(style[propName]||0))}return(forceSetAll||style.shadowColor!==prevStyle.shadowColor)&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx.shadowColor=style.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),styleChanged}function bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetAll,scope){var style=getStyle(el,scope.inHover),prevStyle=forceSetAll?null:prevEl&&getStyle(prevEl,scope.inHover)||{};if(style===prevStyle)return!1;var styleChanged=bindCommonProps(ctx,style,prevStyle,forceSetAll,scope);if((forceSetAll||style.fill!==prevStyle.fill)&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),isValidStrokeFillStyle(style.fill)&&(ctx.fillStyle=style.fill)),(forceSetAll||style.stroke!==prevStyle.stroke)&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),isValidStrokeFillStyle(style.stroke)&&(ctx.strokeStyle=style.stroke)),(forceSetAll||style.opacity!==prevStyle.opacity)&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx.globalAlpha=style.opacity==null?1:style.opacity),el.hasStroke()){var newLineWidth=style.lineWidth/(style.strokeNoScale&&el.getLineScale?el.getLineScale():1);ctx.lineWidth!==newLineWidth&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx.lineWidth=newLineWidth)}for(var i$1=0;i$1<STROKE_PROPS.length;i$1++){var prop=STROKE_PROPS[i$1],propName=prop[0];(forceSetAll||style[propName]!==prevStyle[propName])&&(styleChanged||=(flushPathDrawn(ctx,scope),!0),ctx[propName]=style[propName]||prop[1])}return styleChanged}function bindImageStyle(ctx,el,prevEl,forceSetAll,scope){return bindCommonProps(ctx,getStyle(el,scope.inHover),prevEl&&getStyle(prevEl,scope.inHover),forceSetAll,scope)}function setContextTransform(ctx,el){var m$2=el.transform,dpr$1=ctx.dpr||1;m$2?ctx.setTransform(dpr$1*m$2[0],dpr$1*m$2[1],dpr$1*m$2[2],dpr$1*m$2[3],dpr$1*m$2[4],dpr$1*m$2[5]):ctx.setTransform(dpr$1,0,0,dpr$1,0,0)}function updateClipStatus(clipPaths,ctx,scope){for(var allClipped=!1,i$1=0;i$1<clipPaths.length;i$1++){var clipPath=clipPaths[i$1];allClipped||=clipPath.isZeroArea(),setContextTransform(ctx,clipPath),ctx.beginPath(),clipPath.buildPath(ctx,clipPath.shape),ctx.clip()}scope.allClipped=allClipped}function isTransformChanged(m0,m1){return m0&&m1?m0[0]!==m1[0]||m0[1]!==m1[1]||m0[2]!==m1[2]||m0[3]!==m1[3]||m0[4]!==m1[4]||m0[5]!==m1[5]:!(!m0&&!m1)}var DRAW_TYPE_PATH=1,DRAW_TYPE_IMAGE=2,DRAW_TYPE_TEXT=3,DRAW_TYPE_INCREMENTAL=4;function canPathBatch(style){var hasFill=styleHasFill(style),hasStroke=styleHasStroke(style);return!(style.lineDash||!(hasFill^+hasStroke)||hasFill&&typeof style.fill!=`string`||hasStroke&&typeof style.stroke!=`string`||style.strokePercent<1||style.strokeOpacity<1||style.fillOpacity<1)}function flushPathDrawn(ctx,scope){scope.batchFill&&ctx.fill(),scope.batchStroke&&ctx.stroke(),scope.batchFill=``,scope.batchStroke=``}function getStyle(el,inHover){return inHover&&el.__hoverStyle||el.style}function brushSingle(ctx,el){brush(ctx,el,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush(ctx,el,scope,isLast){var m$2=el.transform;if(!el.shouldBePainted(scope.viewWidth,scope.viewHeight,!1,!1)){el.__dirty&=-2,el.__isRendered=!1;return}var clipPaths=el.__clipPaths,prevElClipPaths=scope.prevElClipPaths,forceSetTransform=!1,forceSetStyle=!1;if((!prevElClipPaths||isClipPathChanged(clipPaths,prevElClipPaths))&&(prevElClipPaths&&prevElClipPaths.length&&(flushPathDrawn(ctx,scope),ctx.restore(),forceSetStyle=forceSetTransform=!0,scope.prevElClipPaths=null,scope.allClipped=!1,scope.prevEl=null),clipPaths&&clipPaths.length&&(flushPathDrawn(ctx,scope),ctx.save(),updateClipStatus(clipPaths,ctx,scope),forceSetTransform=!0),scope.prevElClipPaths=clipPaths),scope.allClipped){el.__isRendered=!1;return}el.beforeBrush&&el.beforeBrush(),el.innerBeforeBrush();var prevEl=scope.prevEl;prevEl||(forceSetStyle=forceSetTransform=!0);var canBatchPath=el instanceof Path_default&&el.autoBatch&&canPathBatch(el.style);forceSetTransform||isTransformChanged(m$2,prevEl.transform)?(flushPathDrawn(ctx,scope),setContextTransform(ctx,el)):canBatchPath||flushPathDrawn(ctx,scope);var style=getStyle(el,scope.inHover);el instanceof Path_default?(scope.lastDrawType!==DRAW_TYPE_PATH&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_PATH),bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetStyle,scope),(!canBatchPath||!scope.batchFill&&!scope.batchStroke)&&ctx.beginPath(),brushPath(ctx,el,style,canBatchPath),canBatchPath&&(scope.batchFill=style.fill||``,scope.batchStroke=style.stroke||``)):el instanceof TSpan_default?(scope.lastDrawType!==DRAW_TYPE_TEXT&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_TEXT),bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetStyle,scope),brushText(ctx,el,style)):el instanceof Image_default?(scope.lastDrawType!==DRAW_TYPE_IMAGE&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_IMAGE),bindImageStyle(ctx,el,prevEl,forceSetStyle,scope),brushImage(ctx,el,style)):el.getTemporalDisplayables&&(scope.lastDrawType!==DRAW_TYPE_INCREMENTAL&&(forceSetStyle=!0,scope.lastDrawType=DRAW_TYPE_INCREMENTAL),brushIncremental(ctx,el,scope)),canBatchPath&&isLast&&flushPathDrawn(ctx,scope),el.innerAfterBrush(),el.afterBrush&&el.afterBrush(),scope.prevEl=el,el.__dirty=0,el.__isRendered=!0}function brushIncremental(ctx,el,scope){var displayables=el.getDisplayables(),temporalDisplayables=el.getTemporalDisplayables();ctx.save();var innerScope={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:scope.viewWidth,viewHeight:scope.viewHeight,inHover:scope.inHover},i$1,len$1;for(i$1=el.getCursor(),len$1=displayables.length;i$1<len$1;i$1++){var displayable=displayables[i$1];displayable.beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush(ctx,displayable,innerScope,i$1===len$1-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable}for(var i_1=0,len_1=temporalDisplayables.length;i_1<len_1;i_1++){var displayable=temporalDisplayables[i_1];displayable.beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush(ctx,displayable,innerScope,i_1===len_1-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable}el.clearTemporalDisplayables(),el.notClear=!0,ctx.restore()}var decalMap=new WeakMap_default,decalCache=new LRU_default(100),decalKeys=[`symbol`,`symbolSize`,`symbolKeepAspect`,`color`,`backgroundColor`,`dashArrayX`,`dashArrayY`,`maxTileWidth`,`maxTileHeight`];function createOrUpdatePatternFromDecal(decalObject,api){if(decalObject===`none`)return null;var dpr$1=api.getDevicePixelRatio(),zr=api.getZr(),isSVG=zr.painter.type===`svg`;decalObject.dirty&&decalMap.delete(decalObject);var oldPattern=decalMap.get(decalObject);if(oldPattern)return oldPattern;var decalOpt=defaults(decalObject,{symbol:`rect`,symbolSize:1,symbolKeepAspect:!0,color:`rgba(0, 0, 0, 0.2)`,backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});decalOpt.backgroundColor===`none`&&(decalOpt.backgroundColor=null);var pattern={repeat:`repeat`};return setPatternnSource(pattern),pattern.rotation=decalOpt.rotation,pattern.scaleX=pattern.scaleY=isSVG?1:1/dpr$1,decalMap.set(decalObject,pattern),decalObject.dirty=!1,pattern;function setPatternnSource(pattern$1){for(var keys$1=[dpr$1],isValidKey=!0,i$1=0;i$1<decalKeys.length;++i$1){var value=decalOpt[decalKeys[i$1]];if(value!=null&&!isArray(value)&&!isString(value)&&!isNumber(value)&&typeof value!=`boolean`){isValidKey=!1;break}keys$1.push(value)}var cacheKey;if(isValidKey){cacheKey=keys$1.join(`,`)+(isSVG?`-svg`:``);var cache=decalCache.get(cacheKey);cache&&(isSVG?pattern$1.svgElement=cache:pattern$1.image=cache)}var dashArrayX=normalizeDashArrayX(decalOpt.dashArrayX),dashArrayY=normalizeDashArrayY(decalOpt.dashArrayY),symbolArray=normalizeSymbolArray(decalOpt.symbol),lineBlockLengthsX=getLineBlockLengthX(dashArrayX),lineBlockLengthY=getLineBlockLengthY(dashArrayY),canvas=!isSVG&&platformApi.createCanvas(),svgRoot=isSVG&&{tag:`g`,attrs:{},key:`dcl`,children:[]},pSize=getPatternSize(),ctx;canvas&&(canvas.width=pSize.width*dpr$1,canvas.height=pSize.height*dpr$1,ctx=canvas.getContext(`2d`)),brushDecal(),isValidKey&&decalCache.put(cacheKey,canvas||svgRoot),pattern$1.image=canvas,pattern$1.svgElement=svgRoot,pattern$1.svgWidth=pSize.width,pattern$1.svgHeight=pSize.height;function getPatternSize(){for(var width=1,i$2=0,xlen=lineBlockLengthsX.length;i$2<xlen;++i$2)width=getLeastCommonMultiple(width,lineBlockLengthsX[i$2]);for(var symbolRepeats=1,i$2=0,xlen=symbolArray.length;i$2<xlen;++i$2)symbolRepeats=getLeastCommonMultiple(symbolRepeats,symbolArray[i$2].length);width*=symbolRepeats;var height=lineBlockLengthY*lineBlockLengthsX.length*symbolArray.length;return{width:Math.max(1,Math.min(width,decalOpt.maxTileWidth)),height:Math.max(1,Math.min(height,decalOpt.maxTileHeight))}}function brushDecal(){ctx&&(ctx.clearRect(0,0,canvas.width,canvas.height),decalOpt.backgroundColor&&(ctx.fillStyle=decalOpt.backgroundColor,ctx.fillRect(0,0,canvas.width,canvas.height)));for(var ySum=0,i$2=0;i$2<dashArrayY.length;++i$2)ySum+=dashArrayY[i$2];if(ySum<=0)return;for(var y$1=-lineBlockLengthY,yId=0,yIdTotal=0,xId0=0;y$1<pSize.height;){if(yId%2==0){for(var symbolYId=yIdTotal/2%symbolArray.length,x$1=0,xId1=0,xId1Total=0;x$1<pSize.width*2;){for(var xSum=0,i$2=0;i$2<dashArrayX[xId0].length;++i$2)xSum+=dashArrayX[xId0][i$2];if(xSum<=0)break;if(xId1%2==0){var size=(1-decalOpt.symbolSize)*.5,left=x$1+dashArrayX[xId0][xId1]*size,top_1=y$1+dashArrayY[yId]*size,width=dashArrayX[xId0][xId1]*decalOpt.symbolSize,height=dashArrayY[yId]*decalOpt.symbolSize,symbolXId=xId1Total/2%symbolArray[symbolYId].length;brushSymbol(left,top_1,width,height,symbolArray[symbolYId][symbolXId])}x$1+=dashArrayX[xId0][xId1],++xId1Total,++xId1,xId1===dashArrayX[xId0].length&&(xId1=0)}++xId0,xId0===dashArrayX.length&&(xId0=0)}y$1+=dashArrayY[yId],++yIdTotal,++yId,yId===dashArrayY.length&&(yId=0)}function brushSymbol(x$2,y$2,width$1,height$1,symbolType){var scale$3=isSVG?1:dpr$1,symbol=createSymbol(symbolType,x$2*scale$3,y$2*scale$3,width$1*scale$3,height$1*scale$3,decalOpt.color,decalOpt.symbolKeepAspect);if(isSVG){var symbolVNode=zr.painter.renderOneToVNode(symbol);symbolVNode&&svgRoot.children.push(symbolVNode)}else brushSingle(ctx,symbol)}}}}function normalizeSymbolArray(symbol){if(!symbol||symbol.length===0)return[[`rect`]];if(isString(symbol))return[[symbol]];for(var isAllString=!0,i$1=0;i$1<symbol.length;++i$1)if(!isString(symbol[i$1])){isAllString=!1;break}if(isAllString)return normalizeSymbolArray([symbol]);for(var result=[],i$1=0;i$1<symbol.length;++i$1)isString(symbol[i$1])?result.push([symbol[i$1]]):result.push(symbol[i$1]);return result}function normalizeDashArrayX(dash){if(!dash||dash.length===0)return[[0,0]];if(isNumber(dash)){var dashValue=Math.ceil(dash);return[[dashValue,dashValue]]}for(var isAllNumber=!0,i$1=0;i$1<dash.length;++i$1)if(!isNumber(dash[i$1])){isAllNumber=!1;break}if(isAllNumber)return normalizeDashArrayX([dash]);for(var result=[],i$1=0;i$1<dash.length;++i$1)if(isNumber(dash[i$1])){var dashValue=Math.ceil(dash[i$1]);result.push([dashValue,dashValue])}else{var dashValue=map(dash[i$1],function(n$1){return Math.ceil(n$1)});dashValue.length%2==1?result.push(dashValue.concat(dashValue)):result.push(dashValue)}return result}function normalizeDashArrayY(dash){if(!dash||typeof dash==`object`&&dash.length===0)return[0,0];if(isNumber(dash)){var dashValue_1=Math.ceil(dash);return[dashValue_1,dashValue_1]}var dashValue=map(dash,function(n$1){return Math.ceil(n$1)});return dash.length%2?dashValue.concat(dashValue):dashValue}function getLineBlockLengthX(dash){return map(dash,function(line){return getLineBlockLengthY(line)})}function getLineBlockLengthY(dash){for(var blockLength=0,i$1=0;i$1<dash.length;++i$1)blockLength+=dash[i$1];return dash.length%2==1?blockLength*2:blockLength}function decalVisual(ecModel,api){ecModel.eachRawSeries(function(seriesModel){if(!ecModel.isSeriesFiltered(seriesModel)){var data=seriesModel.getData();data.hasItemVisual()&&data.each(function(idx){var decal$1=data.getItemVisual(idx,`decal`);if(decal$1){var itemStyle=data.ensureUniqueItemVisual(idx,`style`);itemStyle.decal=createOrUpdatePatternFromDecal(decal$1,api)}});var decal=data.getVisual(`decal`);if(decal){var style=data.getVisual(`style`);style.decal=createOrUpdatePatternFromDecal(decal,api)}}})}var lifecycle_default=new Eventful_default,implsStore={};function registerImpl(name,impl){implsStore[name]=impl}function getImpl(name){return implsStore[name]}var customRenderers={};function registerCustomSeries(type,renderItem){customRenderers[type]=renderItem}var TEST_FRAME_REMAIN_TIME=1,PRIORITY_PROCESSOR_SERIES_FILTER=800,PRIORITY_PROCESSOR_DATASTACK=900,PRIORITY_PROCESSOR_FILTER=1e3,PRIORITY_PROCESSOR_DEFAULT=2e3,PRIORITY_PROCESSOR_STATISTIC=5e3,PRIORITY_VISUAL_LAYOUT=1e3,PRIORITY_VISUAL_PROGRESSIVE_LAYOUT=1100,PRIORITY_VISUAL_GLOBAL=2e3,PRIORITY_VISUAL_CHART=3e3,PRIORITY_VISUAL_COMPONENT=4e3,PRIORITY_VISUAL_CHART_DATA_CUSTOM=4500,PRIORITY_VISUAL_POST_CHART_LAYOUT=4600,PRIORITY_VISUAL_BRUSH=5e3,PRIORITY_VISUAL_ARIA=6e3,PRIORITY_VISUAL_DECAL=7e3,PRIORITY={PROCESSOR:{FILTER:PRIORITY_PROCESSOR_FILTER,SERIES_FILTER:PRIORITY_PROCESSOR_SERIES_FILTER,STATISTIC:PRIORITY_PROCESSOR_STATISTIC},VISUAL:{LAYOUT:PRIORITY_VISUAL_LAYOUT,PROGRESSIVE_LAYOUT:PRIORITY_VISUAL_PROGRESSIVE_LAYOUT,GLOBAL:PRIORITY_VISUAL_GLOBAL,CHART:PRIORITY_VISUAL_CHART,POST_CHART_LAYOUT:PRIORITY_VISUAL_POST_CHART_LAYOUT,COMPONENT:PRIORITY_VISUAL_COMPONENT,BRUSH:PRIORITY_VISUAL_BRUSH,CHART_ITEM:PRIORITY_VISUAL_CHART_DATA_CUSTOM,ARIA:PRIORITY_VISUAL_ARIA,DECAL:PRIORITY_VISUAL_DECAL}},IN_MAIN_PROCESS_KEY=`__flagInMainProcess`,MAIN_PROCESS_VERSION_KEY=`__mainProcessVersion`,PENDING_UPDATE=`__pendingUpdate`,STATUS_NEEDS_UPDATE_KEY=`__needsUpdateStatus`,ACTION_REG=/^[a-zA-Z0-9_]+$/,CONNECT_STATUS_KEY=`__connectUpdateStatus`,CONNECT_STATUS_PENDING=0,CONNECT_STATUS_UPDATING=1,CONNECT_STATUS_UPDATED=2;function createRegisterEventWithLowercaseECharts(method){return function(){var args=[...arguments];if(this.isDisposed()){this.id;return}return toLowercaseNameAndCallEventful(this,method,args)}}function createRegisterEventWithLowercaseMessageCenter(method){return function(){return toLowercaseNameAndCallEventful(this,method,[...arguments])}}function toLowercaseNameAndCallEventful(host,method,args){return args[0]=args[0]&&args[0].toLowerCase(),Eventful_default.prototype[method].apply(host,args)}var MessageCenter=function(_super){__extends(MessageCenter$1,_super);function MessageCenter$1(){return _super!==null&&_super.apply(this,arguments)||this}return MessageCenter$1}(Eventful_default),messageCenterProto=MessageCenter.prototype;messageCenterProto.on=createRegisterEventWithLowercaseMessageCenter(`on`),messageCenterProto.off=createRegisterEventWithLowercaseMessageCenter(`off`);var prepare,prepareView,updateDirectly,updateMethods,doConvertPixel,updateStreamModes,doDispatchAction,flushPendingActions,triggerUpdatedEvent,bindRenderedEvent,bindMouseEvent,render,renderComponents,renderSeries,createExtensionAPI,enableConnect,markStatusToUpdate,applyChangedStates,updateMainProcessVersion,ECharts=function(_super){__extends(ECharts$1,_super);function ECharts$1(dom,theme$1,opts){var _this=_super.call(this,new ECEventProcessor)||this;_this._chartsViews=[],_this._chartsMap={},_this._componentsViews=[],_this._componentsMap={},_this._pendingActions=[],opts||={},_this._dom=dom;var defaultRenderer=`canvas`,defaultCoarsePointer=`auto`,defaultUseDirtyRect=!1;_this[MAIN_PROCESS_VERSION_KEY]=1,opts.ssr;var zr=_this._zr=init$1(dom,{renderer:opts.renderer||defaultRenderer,devicePixelRatio:opts.devicePixelRatio,width:opts.width,height:opts.height,ssr:opts.ssr,useDirtyRect:retrieve2(opts.useDirtyRect,defaultUseDirtyRect),useCoarsePointer:retrieve2(opts.useCoarsePointer,defaultCoarsePointer),pointerSize:opts.pointerSize});_this._ssr=opts.ssr,_this._throttledZrFlush=throttle(bind(zr.flush,zr),17),_this._updateTheme(theme$1),_this._locale=createLocaleObject(opts.locale||SYSTEM_LANG),_this._coordSysMgr=new CoordinateSystem_default;var api=_this._api=createExtensionAPI(_this);function prioritySortFunc(a$1,b$1){return a$1.__prio-b$1.__prio}return sort(visualFuncs,prioritySortFunc),sort(dataProcessorFuncs,prioritySortFunc),_this._scheduler=new Scheduler_default(_this,api,dataProcessorFuncs,visualFuncs),_this._messageCenter=new MessageCenter,_this._initEvents(),_this.resize=bind(_this.resize,_this),zr.animation.on(`frame`,_this._onframe,_this),bindRenderedEvent(zr,_this),bindMouseEvent(zr,_this),setAsPrimitive(_this),_this}return ECharts$1.prototype._onframe=function(){if(!this._disposed){applyChangedStates(this);var scheduler=this._scheduler;if(this[PENDING_UPDATE]){var silent=this[PENDING_UPDATE].silent;this[IN_MAIN_PROCESS_KEY]=!0,updateMainProcessVersion(this);try{prepare(this),updateMethods.update.call(this,null,this[PENDING_UPDATE].updateParams)}catch(e$2){throw this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,e$2}this._zr.flush(),this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}else if(scheduler.unfinished){var remainTime=TEST_FRAME_REMAIN_TIME,ecModel=this._model,api=this._api;scheduler.unfinished=!1;do{var startTime=+new Date;scheduler.performSeriesTasks(ecModel),scheduler.performDataProcessorTasks(ecModel),updateStreamModes(this,ecModel),scheduler.performVisualTasks(ecModel),renderSeries(this,this._model,api,`remain`,{}),remainTime-=+new Date-startTime}while(remainTime>0&&scheduler.unfinished);scheduler.unfinished||this._zr.flush()}}},ECharts$1.prototype.getDom=function(){return this._dom},ECharts$1.prototype.getId=function(){return this.id},ECharts$1.prototype.getZr=function(){return this._zr},ECharts$1.prototype.isSSR=function(){return this._ssr},ECharts$1.prototype.setOption=function(option,notMerge,lazyUpdate){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}var silent,replaceMerge,transitionOpt;if(isObject(notMerge)&&(lazyUpdate=notMerge.lazyUpdate,silent=notMerge.silent,replaceMerge=notMerge.replaceMerge,transitionOpt=notMerge.transition,notMerge=notMerge.notMerge),this[IN_MAIN_PROCESS_KEY]=!0,updateMainProcessVersion(this),!this._model||notMerge){var optionManager=new OptionManager_default(this._api),theme$1=this._theme,ecModel=this._model=new Global_default;ecModel.scheduler=this._scheduler,ecModel.ssr=this._ssr,ecModel.init(null,null,null,theme$1,this._locale,optionManager)}this._model.setOption(option,{replaceMerge},optionPreprocessorFuncs);var updateParams={seriesTransition:transitionOpt,optionChanged:!0};if(lazyUpdate)this[PENDING_UPDATE]={silent,updateParams},this[IN_MAIN_PROCESS_KEY]=!1,this.getZr().wakeUp();else{try{prepare(this),updateMethods.update.call(this,null,updateParams)}catch(e$2){throw this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,e$2}this._ssr||this._zr.flush(),this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts$1.prototype.setTheme=function(theme$1,opts){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}var ecModel=this._model;if(ecModel){var silent=opts&&opts.silent,updateParams=null;this[PENDING_UPDATE]&&(silent??=this[PENDING_UPDATE].silent,updateParams=this[PENDING_UPDATE].updateParams,this[PENDING_UPDATE]=null),this[IN_MAIN_PROCESS_KEY]=!0,updateMainProcessVersion(this);try{this._updateTheme(theme$1),ecModel.setTheme(this._theme),prepare(this),updateMethods.update.call(this,{type:`setTheme`},updateParams)}catch(e$2){throw this[IN_MAIN_PROCESS_KEY]=!1,e$2}this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts$1.prototype._updateTheme=function(theme$1){isString(theme$1)&&(theme$1=themeStorage[theme$1]),theme$1&&(theme$1=clone(theme$1),theme$1&&globalBackwardCompat(theme$1,!0),this._theme=theme$1)},ECharts$1.prototype.getModel=function(){return this._model},ECharts$1.prototype.getOption=function(){return this._model&&this._model.getOption()},ECharts$1.prototype.getWidth=function(){return this._zr.getWidth()},ECharts$1.prototype.getHeight=function(){return this._zr.getHeight()},ECharts$1.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||env_default.hasGlobalWindow&&window.devicePixelRatio||1},ECharts$1.prototype.getRenderedCanvas=function(opts){return this.renderToCanvas(opts)},ECharts$1.prototype.renderToCanvas=function(opts){return opts||={},this._zr.painter.getRenderedCanvas({backgroundColor:opts.backgroundColor||this._model.get(`backgroundColor`),pixelRatio:opts.pixelRatio||this.getDevicePixelRatio()})},ECharts$1.prototype.renderToSVGString=function(opts){return opts||={},this._zr.painter.renderToString({useViewBox:opts.useViewBox})},ECharts$1.prototype.getSvgDataURL=function(){var zr=this._zr,list=zr.storage.getDisplayList();return each(list,function(el){el.stopAnimation(null,!0)}),zr.painter.toDataURL()},ECharts$1.prototype.getDataURL=function(opts){if(this._disposed){this.id;return}opts||={};var excludeComponents=opts.excludeComponents,ecModel=this._model,excludesComponentViews=[],self$1=this;each(excludeComponents,function(componentType){ecModel.eachComponent({mainType:componentType},function(component){var view=self$1._componentsMap[component.__viewId];view.group.ignore||(excludesComponentViews.push(view),view.group.ignore=!0)})});var url=this._zr.painter.getType()===`svg`?this.getSvgDataURL():this.renderToCanvas(opts).toDataURL(`image/`+(opts&&opts.type||`png`));return each(excludesComponentViews,function(view){view.group.ignore=!1}),url},ECharts$1.prototype.getConnectedDataURL=function(opts){if(this._disposed){this.id;return}var isSvg=opts.type===`svg`,groupId=this.group,mathMin$8=Math.min,mathMax$8=Math.max,MAX_NUMBER=1/0;if(connectedGroups[groupId]){var left_1=MAX_NUMBER,top_1=MAX_NUMBER,right_1=-MAX_NUMBER,bottom_1=-MAX_NUMBER,canvasList_1=[],dpr_1=opts&&opts.pixelRatio||this.getDevicePixelRatio();each(instances,function(chart,id){if(chart.group===groupId){var canvas=isSvg?chart.getZr().painter.getSvgDom().innerHTML:chart.renderToCanvas(clone(opts)),boundingRect=chart.getDom().getBoundingClientRect();left_1=mathMin$8(boundingRect.left,left_1),top_1=mathMin$8(boundingRect.top,top_1),right_1=mathMax$8(boundingRect.right,right_1),bottom_1=mathMax$8(boundingRect.bottom,bottom_1),canvasList_1.push({dom:canvas,left:boundingRect.left,top:boundingRect.top})}}),left_1*=dpr_1,top_1*=dpr_1,right_1*=dpr_1,bottom_1*=dpr_1;var width=right_1-left_1,height=bottom_1-top_1,targetCanvas=platformApi.createCanvas(),zr_1=init$1(targetCanvas,{renderer:isSvg?`svg`:`canvas`});if(zr_1.resize({width,height}),isSvg){var content_1=``;return each(canvasList_1,function(item){var x$1=item.left-left_1,y$1=item.top-top_1;content_1+=`<g transform="translate(`+x$1+`,`+y$1+`)">`+item.dom+`</g>`}),zr_1.painter.getSvgRoot().innerHTML=content_1,opts.connectedBackgroundColor&&zr_1.painter.setBackgroundColor(opts.connectedBackgroundColor),zr_1.refreshImmediately(),zr_1.painter.toDataURL()}else return opts.connectedBackgroundColor&&zr_1.add(new Rect_default({shape:{x:0,y:0,width,height},style:{fill:opts.connectedBackgroundColor}})),each(canvasList_1,function(item){var img=new Image_default({style:{x:item.left*dpr_1-left_1,y:item.top*dpr_1-top_1,image:item.dom}});zr_1.add(img)}),zr_1.refreshImmediately(),targetCanvas.toDataURL(`image/`+(opts&&opts.type||`png`))}else return this.getDataURL(opts)},ECharts$1.prototype.convertToPixel=function(finder,value,opt){return doConvertPixel(this,`convertToPixel`,finder,value,opt)},ECharts$1.prototype.convertToLayout=function(finder,value,opt){return doConvertPixel(this,`convertToLayout`,finder,value,opt)},ECharts$1.prototype.convertFromPixel=function(finder,value,opt){return doConvertPixel(this,`convertFromPixel`,finder,value,opt)},ECharts$1.prototype.containPixel=function(finder,value){if(this._disposed){this.id;return}var ecModel=this._model,result,findResult=parseFinder(ecModel,finder);return each(findResult,function(models,key$1){key$1.indexOf(`Models`)>=0&&each(models,function(model){var coordSys=model.coordinateSystem;if(coordSys&&coordSys.containPoint)result||=!!coordSys.containPoint(value);else if(key$1===`seriesModels`){var view=this._chartsMap[model.__viewId];view&&view.containPoint&&(result||=view.containPoint(value,model))}},this)},this),!!result},ECharts$1.prototype.getVisual=function(finder,visualType){var ecModel=this._model,parsedFinder=parseFinder(ecModel,finder,{defaultMainType:`series`}),data=parsedFinder.seriesModel.getData(),dataIndexInside=parsedFinder.hasOwnProperty(`dataIndexInside`)?parsedFinder.dataIndexInside:parsedFinder.hasOwnProperty(`dataIndex`)?data.indexOfRawIndex(parsedFinder.dataIndex):null;return dataIndexInside==null?getVisualFromData(data,visualType):getItemVisualFromData(data,dataIndexInside,visualType)},ECharts$1.prototype.getViewOfComponentModel=function(componentModel){return this._componentsMap[componentModel.__viewId]},ECharts$1.prototype.getViewOfSeriesModel=function(seriesModel){return this._chartsMap[seriesModel.__viewId]},ECharts$1.prototype._initEvents=function(){var _this=this;each(MOUSE_EVENT_NAMES,function(eveName){var handler=function(e$2){var ecModel=_this.getModel(),el=e$2.target,params;if(eveName===`globalout`?params={}:el&&findEventDispatcher(el,function(parent){var ecData=getECData(parent);if(ecData&&ecData.dataIndex!=null){var dataModel=ecData.dataModel||ecModel.getSeriesByIndex(ecData.seriesIndex);return params=dataModel&&dataModel.getDataParams(ecData.dataIndex,ecData.dataType,el)||{},!0}else if(ecData.eventData)return params=extend({},ecData.eventData),!0},!0),params){var componentType=params.componentType,componentIndex=params.componentIndex;(componentType===`markLine`||componentType===`markPoint`||componentType===`markArea`)&&(componentType=`series`,componentIndex=params.seriesIndex);var model=componentType&&componentIndex!=null&&ecModel.getComponent(componentType,componentIndex),view=model&&_this[model.mainType===`series`?`_chartsMap`:`_componentsMap`][model.__viewId];params.event=e$2,params.type=eveName,_this._$eventProcessor.eventInfo={targetEl:el,packedEvent:params,model,view},_this.trigger(eveName,params)}};handler.zrEventfulCallAtLast=!0,_this._zr.on(eveName,handler,_this)});var messageCenter=this._messageCenter;each(publicEventTypeMap,function(_,eventType){messageCenter.on(eventType,function(event){_this.trigger(eventType,event)})}),handleLegacySelectEvents(messageCenter,this,this._api)},ECharts$1.prototype.isDisposed=function(){return this._disposed},ECharts$1.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},ECharts$1.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0,this.getDom()&&setAttribute(this.getDom(),DOM_ATTRIBUTE_KEY,``);var chart=this,api=chart._api,ecModel=chart._model;each(chart._componentsViews,function(component){component.dispose(ecModel,api)}),each(chart._chartsViews,function(chart$1){chart$1.dispose(ecModel,api)}),chart._zr.dispose(),chart._dom=chart._model=chart._chartsMap=chart._componentsMap=chart._chartsViews=chart._componentsViews=chart._scheduler=chart._api=chart._zr=chart._throttledZrFlush=chart._theme=chart._coordSysMgr=chart._messageCenter=null,delete instances[chart.id]},ECharts$1.prototype.resize=function(opts){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}this._zr.resize(opts);var ecModel=this._model;if(this._loadingFX&&this._loadingFX.resize(),ecModel){var needPrepare=ecModel.resetOption(`media`),silent=opts&&opts.silent;this[PENDING_UPDATE]&&(silent??=this[PENDING_UPDATE].silent,needPrepare=!0,this[PENDING_UPDATE]=null),this[IN_MAIN_PROCESS_KEY]=!0,updateMainProcessVersion(this);try{needPrepare&&prepare(this),updateMethods.update.call(this,{type:`resize`,animation:extend({duration:0},opts&&opts.animation)})}catch(e$2){throw this[IN_MAIN_PROCESS_KEY]=!1,e$2}this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts$1.prototype.showLoading=function(name,cfg){if(this._disposed){this.id;return}if(isObject(name)&&(cfg=name,name=``),name||=`default`,this.hideLoading(),loadingEffects[name]){var el=loadingEffects[name](this._api,cfg),zr=this._zr;this._loadingFX=el,zr.add(el)}},ECharts$1.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},ECharts$1.prototype.makeActionFromEvent=function(eventObj){var payload=extend({},eventObj);return payload.type=connectionEventRevertMap[eventObj.type],payload},ECharts$1.prototype.dispatchAction=function(payload,opt){if(this._disposed){this.id;return}if(isObject(opt)||(opt={silent:!!opt}),actions[payload.type]&&this._model){if(this[IN_MAIN_PROCESS_KEY]){this._pendingActions.push(payload);return}var silent=opt.silent;doDispatchAction.call(this,payload,silent);var flush=opt.flush;flush?this._zr.flush():flush!==!1&&env_default.browser.weChat&&this._throttledZrFlush(),flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}},ECharts$1.prototype.updateLabelLayout=function(){lifecycle_default.trigger(`series:layoutlabels`,this._model,this._api,{updatedSeries:[]})},ECharts$1.prototype.appendData=function(params){if(this._disposed){this.id;return}var seriesIndex=params.seriesIndex;this.getModel().getSeriesByIndex(seriesIndex).appendData(params),this._scheduler.unfinished=!0,this.getZr().wakeUp()},ECharts$1.internalField=function(){prepare=function(ecIns){var scheduler=ecIns._scheduler;scheduler.restorePipelines(ecIns._model),scheduler.prepareStageTasks(),prepareView(ecIns,!0),prepareView(ecIns,!1),scheduler.plan()},prepareView=function(ecIns,isComponent){for(var ecModel=ecIns._model,scheduler=ecIns._scheduler,viewList=isComponent?ecIns._componentsViews:ecIns._chartsViews,viewMap=isComponent?ecIns._componentsMap:ecIns._chartsMap,zr=ecIns._zr,api=ecIns._api,i$1=0;i$1<viewList.length;i$1++)viewList[i$1].__alive=!1;isComponent?ecModel.eachComponent(function(componentType,model){componentType!==`series`&&doPrepare(model)}):ecModel.eachSeries(doPrepare);function doPrepare(model){var requireNewView=model.__requireNewView;model.__requireNewView=!1;var viewId=`_ec_`+model.id+`_`+model.type,view$1=!requireNewView&&viewMap[viewId];if(!view$1){var classType=parseClassType(model.type);view$1=new(isComponent?Component_default$1.getClass(classType.main,classType.sub):Chart_default.getClass(classType.sub)),view$1.init(ecModel,api),viewMap[viewId]=view$1,viewList.push(view$1),zr.add(view$1.group)}model.__viewId=view$1.__id=viewId,view$1.__alive=!0,view$1.__model=model,view$1.group.__ecComponentInfo={mainType:model.mainType,index:model.componentIndex},!isComponent&&scheduler.prepareView(view$1,model,ecModel,api)}for(var i$1=0;i$1<viewList.length;){var view=viewList[i$1];view.__alive?i$1++:(!isComponent&&view.renderTask.dispose(),zr.remove(view.group),view.dispose(ecModel,api),viewList.splice(i$1,1),viewMap[view.__id]===view&&delete viewMap[view.__id],view.__id=view.group.__ecComponentInfo=null)}},updateDirectly=function(ecIns,method,payload,mainType,subType){var ecModel=ecIns._model;if(ecModel.setUpdatePayload(payload),!mainType){each([].concat(ecIns._componentsViews,ecIns._chartsViews),callView);return}var query={};query[mainType+`Id`]=payload[mainType+`Id`],query[mainType+`Index`]=payload[mainType+`Index`],query[mainType+`Name`]=payload[mainType+`Name`];var condition={mainType,query};subType&&(condition.subType=subType);var excludeSeriesId=payload.excludeSeriesId,excludeSeriesIdMap;excludeSeriesId!=null&&(excludeSeriesIdMap=createHashMap(),each(normalizeToArray(excludeSeriesId),function(id){var modelId=convertOptionIdName(id,null);modelId!=null&&excludeSeriesIdMap.set(modelId,!0)})),ecModel&&ecModel.eachComponent(condition,function(model){if(!(excludeSeriesIdMap&&excludeSeriesIdMap.get(model.id)!=null))if(isHighDownPayload(payload))if(model instanceof Series_default)payload.type===`highlight`&&!payload.notBlur&&!model.get([`emphasis`,`disabled`])&&blurSeriesFromHighlightPayload(model,payload,ecIns._api);else{var _a$1=findComponentHighDownDispatchers(model.mainType,model.componentIndex,payload.name,ecIns._api),focusSelf=_a$1.focusSelf,dispatchers=_a$1.dispatchers;payload.type===`highlight`&&focusSelf&&!payload.notBlur&&blurComponent(model.mainType,model.componentIndex,ecIns._api),dispatchers&&each(dispatchers,function(dispatcher){payload.type===`highlight`?enterEmphasis(dispatcher):leaveEmphasis(dispatcher)})}else isSelectChangePayload(payload)&&model instanceof Series_default&&(toggleSelectionFromPayload(model,payload,ecIns._api),updateSeriesElementSelection(model),markStatusToUpdate(ecIns))},ecIns),ecModel&&ecModel.eachComponent(condition,function(model){excludeSeriesIdMap&&excludeSeriesIdMap.get(model.id)!=null||callView(ecIns[mainType===`series`?`_chartsMap`:`_componentsMap`][model.__viewId])},ecIns);function callView(view){view&&view.__alive&&view[method]&&view[method](view.__model,ecModel,ecIns._api,payload)}},updateMethods={prepareAndUpdate:function(payload){prepare(this),updateMethods.update.call(this,payload,payload&&{optionChanged:payload.newOption!=null})},update:function(payload,updateParams){var ecModel=this._model,api=this._api,zr=this._zr,coordSysMgr=this._coordSysMgr,scheduler=this._scheduler;if(ecModel){ecModel.setUpdatePayload(payload),scheduler.restoreData(ecModel,payload),scheduler.performSeriesTasks(ecModel),coordSysMgr.create(ecModel,api),scheduler.performDataProcessorTasks(ecModel,payload),updateStreamModes(this,ecModel),coordSysMgr.update(ecModel,api),clearColorPalette(ecModel),scheduler.performVisualTasks(ecModel,payload);var backgroundColor$1=ecModel.get(`backgroundColor`)||`transparent`;zr.setBackgroundColor(backgroundColor$1);var darkMode=ecModel.get(`darkMode`);darkMode!=null&&darkMode!==`auto`&&zr.setDarkMode(darkMode),render(this,ecModel,api,payload,updateParams),lifecycle_default.trigger(`afterupdate`,ecModel,api)}},updateTransform:function(payload){var _this=this,ecModel=this._model,api=this._api;if(ecModel){ecModel.setUpdatePayload(payload);var componentDirtyList=[];ecModel.eachComponent(function(componentType,componentModel){if(componentType!==`series`){var componentView=_this.getViewOfComponentModel(componentModel);if(componentView&&componentView.__alive)if(componentView.updateTransform){var result=componentView.updateTransform(componentModel,ecModel,api,payload);result&&result.update&&componentDirtyList.push(componentView)}else componentDirtyList.push(componentView)}});var seriesDirtyMap=createHashMap();ecModel.eachSeries(function(seriesModel){var chartView=_this._chartsMap[seriesModel.__viewId];if(chartView.updateTransform){var result=chartView.updateTransform(seriesModel,ecModel,api,payload);result&&result.update&&seriesDirtyMap.set(seriesModel.uid,1)}else seriesDirtyMap.set(seriesModel.uid,1)}),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0,dirtyMap:seriesDirtyMap}),renderSeries(this,ecModel,api,payload,{},seriesDirtyMap),lifecycle_default.trigger(`afterupdate`,ecModel,api)}},updateView:function(payload){var ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),Chart_default.markUpdateMethod(payload,`updateView`),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0}),render(this,ecModel,this._api,payload,{}),lifecycle_default.trigger(`afterupdate`,ecModel,this._api))},updateVisual:function(payload){var _this=this,ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),ecModel.eachSeries(function(seriesModel){seriesModel.getData().clearAllVisual()}),Chart_default.markUpdateMethod(payload,`updateVisual`),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{visualType:`visual`,setDirty:!0}),ecModel.eachComponent(function(componentType,componentModel){if(componentType!==`series`){var componentView=_this.getViewOfComponentModel(componentModel);componentView&&componentView.__alive&&componentView.updateVisual(componentModel,ecModel,_this._api,payload)}}),ecModel.eachSeries(function(seriesModel){_this._chartsMap[seriesModel.__viewId].updateVisual(seriesModel,ecModel,_this._api,payload)}),lifecycle_default.trigger(`afterupdate`,ecModel,this._api))},updateLayout:function(payload){updateMethods.update.call(this,payload)}};function doConvertPixelImpl(ecIns,methodName,finder,value,opt){if(ecIns._disposed){ecIns.id;return}for(var ecModel=ecIns._model,coordSysList=ecIns._coordSysMgr.getCoordinateSystems(),result,parsedFinder=parseFinder(ecModel,finder),i$1=0;i$1<coordSysList.length;i$1++){var coordSys=coordSysList[i$1];if(coordSys[methodName]&&(result=coordSys[methodName](ecModel,parsedFinder,value,opt))!=null)return result}}doConvertPixel=doConvertPixelImpl,updateStreamModes=function(ecIns,ecModel){var chartsMap=ecIns._chartsMap,scheduler=ecIns._scheduler;ecModel.eachSeries(function(seriesModel){scheduler.updateStreamModes(seriesModel,chartsMap[seriesModel.__viewId])})},doDispatchAction=function(payload,silent){var _this=this,ecModel=this.getModel(),payloadType=payload.type,escapeConnect=payload.escapeConnect,actionInfo=actions[payloadType],cptTypeTmp=(actionInfo.update||`update`).split(`:`),updateMethod=cptTypeTmp.pop(),cptType=cptTypeTmp[0]!=null&&parseClassType(cptTypeTmp[0]);this[IN_MAIN_PROCESS_KEY]=!0,updateMainProcessVersion(this);var payloads=[payload],batched=!1;payload.batch&&(batched=!0,payloads=map(payload.batch,function(item){return item=defaults(extend({},item),payload),item.batch=null,item}));var eventObjBatch=[],eventObj,actionResultBatch=[],nonRefinedEventType=actionInfo.nonRefinedEventType,isSelectChange=isSelectChangePayload(payload),isHighDown=isHighDownPayload(payload);if(isHighDown&&allLeaveBlur(this._api),each(payloads,function(batchItem){var actionResult=actionInfo.action(batchItem,ecModel,_this._api);if(actionInfo.refineEvent?actionResultBatch.push(actionResult):eventObj=actionResult,eventObj||=extend({},batchItem),eventObj.type=nonRefinedEventType,eventObjBatch.push(eventObj),isHighDown){var _a$1=preParseFinder(payload),queryOptionMap=_a$1.queryOptionMap,componentMainType=_a$1.mainTypeSpecified?queryOptionMap.keys()[0]:`series`;updateDirectly(_this,updateMethod,batchItem,componentMainType),markStatusToUpdate(_this)}else isSelectChange?(updateDirectly(_this,updateMethod,batchItem,`series`),markStatusToUpdate(_this)):cptType&&updateDirectly(_this,updateMethod,batchItem,cptType.main,cptType.sub)}),updateMethod!==`none`&&!isHighDown&&!isSelectChange&&!cptType)try{this[PENDING_UPDATE]?(prepare(this),updateMethods.update.call(this,payload),this[PENDING_UPDATE]=null):updateMethods[updateMethod].call(this,payload)}catch(e$2){throw this[IN_MAIN_PROCESS_KEY]=!1,e$2}if(eventObj=batched?{type:nonRefinedEventType,escapeConnect,batch:eventObjBatch}:eventObjBatch[0],this[IN_MAIN_PROCESS_KEY]=!1,!silent){var refinedEvent=void 0;if(actionInfo.refineEvent){var eventContent=actionInfo.refineEvent(actionResultBatch,payload,ecModel,this._api).eventContent;assert(isObject(eventContent)),refinedEvent=defaults({type:actionInfo.refinedEventType},eventContent),refinedEvent.fromAction=payload.type,refinedEvent.fromActionPayload=payload,refinedEvent.escapeConnect=!0}var messageCenter=this._messageCenter;messageCenter.trigger(eventObj.type,eventObj),refinedEvent&&messageCenter.trigger(refinedEvent.type,refinedEvent)}},flushPendingActions=function(silent){for(var pendingActions=this._pendingActions;pendingActions.length;){var payload=pendingActions.shift();doDispatchAction.call(this,payload,silent)}},triggerUpdatedEvent=function(silent){!silent&&this.trigger(`updated`)},bindRenderedEvent=function(zr,ecIns){zr.on(`rendered`,function(params){ecIns.trigger(`rendered`,params),zr.animation.isFinished()&&!ecIns[PENDING_UPDATE]&&!ecIns._scheduler.unfinished&&!ecIns._pendingActions.length&&ecIns.trigger(`finished`)})},bindMouseEvent=function(zr,ecIns){zr.on(`mouseover`,function(e$2){var el=e$2.target,dispatcher=findEventDispatcher(el,isHighDownDispatcher);dispatcher&&(handleGlobalMouseOverForHighDown(dispatcher,e$2,ecIns._api),markStatusToUpdate(ecIns))}).on(`mouseout`,function(e$2){var el=e$2.target,dispatcher=findEventDispatcher(el,isHighDownDispatcher);dispatcher&&(handleGlobalMouseOutForHighDown(dispatcher,e$2,ecIns._api),markStatusToUpdate(ecIns))}).on(`click`,function(e$2){var el=e$2.target,dispatcher=findEventDispatcher(el,function(target){return getECData(target).dataIndex!=null},!0);if(dispatcher){var actionType=dispatcher.selected?`unselect`:`select`,ecData=getECData(dispatcher);ecIns._api.dispatchAction({type:actionType,dataType:ecData.dataType,dataIndexInside:ecData.dataIndex,seriesIndex:ecData.seriesIndex,isFromClick:!0})}})};function clearColorPalette(ecModel){ecModel.clearColorPalette(),ecModel.eachSeries(function(seriesModel){seriesModel.clearColorPalette()})}function allocateZlevels(ecModel){var componentZLevels=[],seriesZLevels=[],hasSeparateZLevel=!1;if(ecModel.eachComponent(function(componentType,componentModel){var zlevel=componentModel.get(`zlevel`)||0,z=componentModel.get(`z`)||0,zlevelKey=componentModel.getZLevelKey();hasSeparateZLevel||=!!zlevelKey,(componentType===`series`?seriesZLevels:componentZLevels).push({zlevel,z,idx:componentModel.componentIndex,type:componentType,key:zlevelKey})}),hasSeparateZLevel){var zLevels=componentZLevels.concat(seriesZLevels),lastSeriesZLevel_1,lastSeriesKey_1;sort(zLevels,function(a$1,b$1){return a$1.zlevel===b$1.zlevel?a$1.z-b$1.z:a$1.zlevel-b$1.zlevel}),each(zLevels,function(item){var componentModel=ecModel.getComponent(item.type,item.idx),zlevel=item.zlevel,key$1=item.key;lastSeriesZLevel_1!=null&&(zlevel=Math.max(lastSeriesZLevel_1,zlevel)),key$1?(zlevel===lastSeriesZLevel_1&&key$1!==lastSeriesKey_1&&zlevel++,lastSeriesKey_1=key$1):lastSeriesKey_1&&=(zlevel===lastSeriesZLevel_1&&zlevel++,``),lastSeriesZLevel_1=zlevel,componentModel.setZLevel(zlevel)})}}render=function(ecIns,ecModel,api,payload,updateParams){allocateZlevels(ecModel),renderComponents(ecIns,ecModel,api,payload,updateParams),each(ecIns._chartsViews,function(chart){chart.__alive=!1}),renderSeries(ecIns,ecModel,api,payload,updateParams),each(ecIns._chartsViews,function(chart){chart.__alive||chart.remove(ecModel,api)})},renderComponents=function(ecIns,ecModel,api,payload,updateParams,dirtyList){each(dirtyList||ecIns._componentsViews,function(componentView){var componentModel=componentView.__model;clearStates(componentModel,componentView),componentView.render(componentModel,ecModel,api,payload),updateZ(componentModel,componentView),updateStates(componentModel,componentView)})},renderSeries=function(ecIns,ecModel,api,payload,updateParams,dirtyMap){var scheduler=ecIns._scheduler;updateParams=extend(updateParams||{},{updatedSeries:ecModel.getSeries()}),lifecycle_default.trigger(`series:beforeupdate`,ecModel,api,updateParams);var unfinished=!1;ecModel.eachSeries(function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId];chartView.__alive=!0;var renderTask=chartView.renderTask;scheduler.updatePayload(renderTask,payload),clearStates(seriesModel,chartView),dirtyMap&&dirtyMap.get(seriesModel.uid)&&renderTask.dirty(),renderTask.perform(scheduler.getPerformArgs(renderTask))&&(unfinished=!0),chartView.group.silent=!!seriesModel.get(`silent`),updateBlend(seriesModel,chartView),updateSeriesElementSelection(seriesModel)}),scheduler.unfinished=unfinished||scheduler.unfinished,lifecycle_default.trigger(`series:layoutlabels`,ecModel,api,updateParams),lifecycle_default.trigger(`series:transition`,ecModel,api,updateParams),ecModel.eachSeries(function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId];updateZ(seriesModel,chartView),updateStates(seriesModel,chartView)}),updateHoverLayerStatus(ecIns,ecModel),lifecycle_default.trigger(`series:afterupdate`,ecModel,api,updateParams)},markStatusToUpdate=function(ecIns){ecIns[STATUS_NEEDS_UPDATE_KEY]=!0,ecIns.getZr().wakeUp()},updateMainProcessVersion=function(ecIns){ecIns[MAIN_PROCESS_VERSION_KEY]=(ecIns[MAIN_PROCESS_VERSION_KEY]+1)%1e3},applyChangedStates=function(ecIns){ecIns[STATUS_NEEDS_UPDATE_KEY]&&(ecIns.getZr().storage.traverse(function(el){isElementRemoved(el)||applyElementStates(el)}),ecIns[STATUS_NEEDS_UPDATE_KEY]=!1)};function applyElementStates(el){for(var newStates=[],oldStates=el.currentStates,i$1=0;i$1<oldStates.length;i$1++){var stateName=oldStates[i$1];stateName===`emphasis`||stateName===`blur`||stateName===`select`||newStates.push(stateName)}el.selected&&el.states.select&&newStates.push(`select`),el.hoverState===2&&el.states.emphasis?newStates.push(`emphasis`):el.hoverState===1&&el.states.blur&&newStates.push(`blur`),el.useStates(newStates)}function updateHoverLayerStatus(ecIns,ecModel){var storage=ecIns._zr.storage,elCount=0;storage.traverse(function(el){el.isGroup||elCount++}),elCount>ecModel.get(`hoverLayerThreshold`)&&!env_default.node&&!env_default.worker&&ecModel.eachSeries(function(seriesModel){if(!seriesModel.preventUsingHoverLayer){var chartView=ecIns._chartsMap[seriesModel.__viewId];chartView.__alive&&chartView.eachRendered(function(el){el.states.emphasis&&(el.states.emphasis.hoverLayer=!0)})}})}function updateBlend(seriesModel,chartView){var blendMode=seriesModel.get(`blendMode`)||null;chartView.eachRendered(function(el){el.isGroup||(el.style.blend=blendMode)})}function updateZ(model,view){if(!model.preventAutoZ){var zInfo=retrieveZInfo(model);view.eachRendered(function(el){return traverseUpdateZ(el,zInfo.z,zInfo.zlevel),!0})}}function clearStates(model,view){view.eachRendered(function(el){if(!isElementRemoved(el)){var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();el.stateTransition&&=null,textContent&&textContent.stateTransition&&(textContent.stateTransition=null),textGuide&&textGuide.stateTransition&&(textGuide.stateTransition=null),el.hasState()?(el.prevStates=el.currentStates,el.clearStates()):el.prevStates&&=null}})}function updateStates(model,view){var stateAnimationModel=model.getModel(`stateAnimation`),enableAnimation=model.isAnimationEnabled(),duration=stateAnimationModel.get(`duration`),stateTransition=duration>0?{duration,delay:stateAnimationModel.get(`delay`),easing:stateAnimationModel.get(`easing`)}:null;view.eachRendered(function(el){if(el.states&&el.states.emphasis){if(isElementRemoved(el))return;if(el instanceof Path_default&&savePathStates(el),el.__dirty){var prevStates=el.prevStates;prevStates&&el.useStates(prevStates)}if(enableAnimation){el.stateTransition=stateTransition;var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();textContent&&(textContent.stateTransition=stateTransition),textGuide&&(textGuide.stateTransition=stateTransition)}el.__dirty&&applyElementStates(el)}})}createExtensionAPI=function(ecIns){return new(function(_super$1){__extends(class_1,_super$1);function class_1(){return _super$1!==null&&_super$1.apply(this,arguments)||this}return class_1.prototype.getCoordinateSystems=function(){return ecIns._coordSysMgr.getCoordinateSystems()},class_1.prototype.getComponentByElement=function(el){for(;el;){var modelInfo=el.__ecComponentInfo;if(modelInfo!=null)return ecIns._model.getComponent(modelInfo.mainType,modelInfo.index);el=el.parent}},class_1.prototype.enterEmphasis=function(el,highlightDigit){enterEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.leaveEmphasis=function(el,highlightDigit){leaveEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.enterBlur=function(el){enterBlur(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveBlur=function(el){leaveBlur(el),markStatusToUpdate(ecIns)},class_1.prototype.enterSelect=function(el){enterSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveSelect=function(el){leaveSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.getModel=function(){return ecIns.getModel()},class_1.prototype.getViewOfComponentModel=function(componentModel){return ecIns.getViewOfComponentModel(componentModel)},class_1.prototype.getViewOfSeriesModel=function(seriesModel){return ecIns.getViewOfSeriesModel(seriesModel)},class_1.prototype.getMainProcessVersion=function(){return ecIns[MAIN_PROCESS_VERSION_KEY]},class_1}(ExtensionAPI_default))(ecIns)},enableConnect=function(chart){function updateConnectedChartsStatus(charts,status){for(var i$1=0;i$1<charts.length;i$1++){var otherChart=charts[i$1];otherChart[CONNECT_STATUS_KEY]=status}}each(connectionEventRevertMap,function(_,eventType){chart._messageCenter.on(eventType,function(event){if(connectedGroups[chart.group]&&chart[CONNECT_STATUS_KEY]!==CONNECT_STATUS_PENDING){if(event&&event.escapeConnect)return;var action_1=chart.makeActionFromEvent(event),otherCharts_1=[];each(instances,function(otherChart){otherChart!==chart&&otherChart.group===chart.group&&otherCharts_1.push(otherChart)}),updateConnectedChartsStatus(otherCharts_1,CONNECT_STATUS_PENDING),each(otherCharts_1,function(otherChart){otherChart[CONNECT_STATUS_KEY]!==CONNECT_STATUS_UPDATING&&otherChart.dispatchAction(action_1)}),updateConnectedChartsStatus(otherCharts_1,CONNECT_STATUS_UPDATED)}})})}}(),ECharts$1}(Eventful_default),echartsProto=ECharts.prototype;echartsProto.on=createRegisterEventWithLowercaseECharts(`on`),echartsProto.off=createRegisterEventWithLowercaseECharts(`off`),echartsProto.one=function(eventName,cb,ctx){var self$1=this;function wrapped(){var args2=[...arguments];cb&&cb.apply&&cb.apply(this,args2),self$1.off(eventName,wrapped)}this.on.call(this,eventName,wrapped,ctx)};var MOUSE_EVENT_NAMES=[`click`,`dblclick`,`mouseover`,`mouseout`,`mousemove`,`mousedown`,`mouseup`,`globalout`,`contextmenu`],actions={},connectionEventRevertMap={},publicEventTypeMap={},dataProcessorFuncs=[],optionPreprocessorFuncs=[],visualFuncs=[],themeStorage={},loadingEffects={},instances={},connectedGroups={},idBase=new Date-0,groupIdBase=new Date-0,DOM_ATTRIBUTE_KEY=`_echarts_instance_`;function init(dom,theme$1,opts){var isClient=!(opts&&opts.ssr);if(isClient){var existInstance=getInstanceByDom(dom);if(existInstance)return existInstance}var chart=new ECharts(dom,theme$1,opts);return chart.id=`ec_`+ idBase++,instances[chart.id]=chart,isClient&&setAttribute(dom,DOM_ATTRIBUTE_KEY,chart.id),enableConnect(chart),lifecycle_default.trigger(`afterinit`,chart),chart}function getInstanceByDom(dom){return instances[getAttribute(dom,DOM_ATTRIBUTE_KEY)]}function registerTheme(name,theme$1){themeStorage[name]=theme$1}function registerPreprocessor(preprocessorFunc){indexOf(optionPreprocessorFuncs,preprocessorFunc)<0&&optionPreprocessorFuncs.push(preprocessorFunc)}function registerProcessor(priority,processor){normalizeRegister(dataProcessorFuncs,priority,processor,PRIORITY_PROCESSOR_DEFAULT)}function registerPostInit(postInitFunc){registerUpdateLifecycle(`afterinit`,postInitFunc)}function registerPostUpdate(postUpdateFunc){registerUpdateLifecycle(`afterupdate`,postUpdateFunc)}function registerUpdateLifecycle(name,cb){lifecycle_default.on(name,cb)}function registerAction(arg0,arg1,action){var actionType,publicEventType,refineEvent,update,publishNonRefinedEvent;isFunction(arg1)&&(action=arg1,arg1=``),isObject(arg0)?(actionType=arg0.type,publicEventType=arg0.event,update=arg0.update,publishNonRefinedEvent=arg0.publishNonRefinedEvent,action||=arg0.action,refineEvent=arg0.refineEvent):(actionType=arg0,publicEventType=arg1);function createEventType(actionOrEventType){return actionOrEventType.toLowerCase()}publicEventType=createEventType(publicEventType||actionType);var nonRefinedEventType=refineEvent?createEventType(actionType):publicEventType;actions[actionType]||(assert(ACTION_REG.test(actionType)&&ACTION_REG.test(publicEventType)),refineEvent&&assert(publicEventType!==actionType),actions[actionType]={actionType,refinedEventType:publicEventType,nonRefinedEventType,update,action,refineEvent},publicEventTypeMap[publicEventType]=1,refineEvent&&publishNonRefinedEvent&&(publicEventTypeMap[nonRefinedEventType]=1),connectionEventRevertMap[nonRefinedEventType]=actionType)}function registerCoordinateSystem(type,coordSysCreator){CoordinateSystem_default.register(type,coordSysCreator)}function registerLayout(priority,layoutTask){normalizeRegister(visualFuncs,priority,layoutTask,PRIORITY_VISUAL_LAYOUT,`layout`)}function registerVisual(priority,visualTask){normalizeRegister(visualFuncs,priority,visualTask,PRIORITY_VISUAL_CHART,`visual`)}var registeredTasks=[];function normalizeRegister(targetList,priority,fn,defaultPriority,visualType){if((isFunction(priority)||isObject(priority))&&(fn=priority,priority=defaultPriority),!(indexOf(registeredTasks,fn)>=0)){registeredTasks.push(fn);var stageHandler=Scheduler_default.wrapStageHandler(fn,visualType);stageHandler.__prio=priority,stageHandler.__raw=fn,targetList.push(stageHandler)}}function registerLoading(name,loadingFx){loadingEffects[name]=loadingFx}function registerMap(mapName,geoJson,specialAreas){var registerMap$1=getImpl(`registerMap`);registerMap$1&&registerMap$1(mapName,geoJson,specialAreas)}var registerTransform=registerExternalTransform;registerVisual(PRIORITY_VISUAL_GLOBAL,seriesStyleTask),registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataStyleTask),registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataColorPaletteTask),registerVisual(PRIORITY_VISUAL_GLOBAL,seriesSymbolTask),registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataSymbolTask),registerVisual(PRIORITY_VISUAL_DECAL,decalVisual),registerPreprocessor(globalBackwardCompat),registerProcessor(PRIORITY_PROCESSOR_DATASTACK,dataStack),registerLoading(`default`,defaultLoading),registerAction({type:HIGHLIGHT_ACTION_TYPE,event:HIGHLIGHT_ACTION_TYPE,update:HIGHLIGHT_ACTION_TYPE},noop),registerAction({type:DOWNPLAY_ACTION_TYPE,event:DOWNPLAY_ACTION_TYPE,update:DOWNPLAY_ACTION_TYPE},noop),registerAction({type:SELECT_ACTION_TYPE,event:SELECT_CHANGED_EVENT_TYPE,update:SELECT_ACTION_TYPE,action:noop,refineEvent:makeSelectChangedEvent,publishNonRefinedEvent:!0}),registerAction({type:UNSELECT_ACTION_TYPE,event:SELECT_CHANGED_EVENT_TYPE,update:UNSELECT_ACTION_TYPE,action:noop,refineEvent:makeSelectChangedEvent,publishNonRefinedEvent:!0}),registerAction({type:TOGGLE_SELECT_ACTION_TYPE,event:SELECT_CHANGED_EVENT_TYPE,update:TOGGLE_SELECT_ACTION_TYPE,action:noop,refineEvent:makeSelectChangedEvent,publishNonRefinedEvent:!0});function makeSelectChangedEvent(actionResultBatch,payload,ecModel,api){return{eventContent:{selected:getAllSelectedIndices(ecModel),isFromClick:payload.isFromClick||!1}}}registerTheme(`default`,{}),registerTheme(`dark`,dark_default);function dataIndexMapValueLength(valNumOrArrLengthMoreThan2){return valNumOrArrLengthMoreThan2==null?0:valNumOrArrLengthMoreThan2.length||1}function defaultKeyGetter(item){return item}var DataDiffer_default=function(){function DataDiffer$1(oldArr,newArr,oldKeyGetter,newKeyGetter,context$1,diffMode){this._old=oldArr,this._new=newArr,this._oldKeyGetter=oldKeyGetter||defaultKeyGetter,this._newKeyGetter=newKeyGetter||defaultKeyGetter,this.context=context$1,this._diffModeMultiple=diffMode===`multiple`}return DataDiffer$1.prototype.add=function(func){return this._add=func,this},DataDiffer$1.prototype.update=function(func){return this._update=func,this},DataDiffer$1.prototype.updateManyToOne=function(func){return this._updateManyToOne=func,this},DataDiffer$1.prototype.updateOneToMany=function(func){return this._updateOneToMany=func,this},DataDiffer$1.prototype.updateManyToMany=function(func){return this._updateManyToMany=func,this},DataDiffer$1.prototype.remove=function(func){return this._remove=func,this},DataDiffer$1.prototype.execute=function(){this[this._diffModeMultiple?`_executeMultiple`:`_executeOneToOne`]()},DataDiffer$1.prototype._executeOneToOne=function(){var oldArr=this._old,newArr=this._new,newDataIndexMap={},oldDataKeyArr=Array(oldArr.length),newDataKeyArr=Array(newArr.length);this._initIndexMap(oldArr,null,oldDataKeyArr,`_oldKeyGetter`),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,`_newKeyGetter`);for(var i$1=0;i$1<oldArr.length;i$1++){var oldKey=oldDataKeyArr[i$1],newIdxMapVal=newDataIndexMap[oldKey],newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(newIdxMapValLen>1){var newIdx=newIdxMapVal.shift();newIdxMapVal.length===1&&(newDataIndexMap[oldKey]=newIdxMapVal[0]),this._update&&this._update(newIdx,i$1)}else newIdxMapValLen===1?(newDataIndexMap[oldKey]=null,this._update&&this._update(newIdxMapVal,i$1)):this._remove&&this._remove(i$1)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer$1.prototype._executeMultiple=function(){var oldArr=this._old,newArr=this._new,oldDataIndexMap={},newDataIndexMap={},oldDataKeyArr=[],newDataKeyArr=[];this._initIndexMap(oldArr,oldDataIndexMap,oldDataKeyArr,`_oldKeyGetter`),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,`_newKeyGetter`);for(var i$1=0;i$1<oldDataKeyArr.length;i$1++){var oldKey=oldDataKeyArr[i$1],oldIdxMapVal=oldDataIndexMap[oldKey],newIdxMapVal=newDataIndexMap[oldKey],oldIdxMapValLen=dataIndexMapValueLength(oldIdxMapVal),newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(oldIdxMapValLen>1&&newIdxMapValLen===1)this._updateManyToOne&&this._updateManyToOne(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen===1&&newIdxMapValLen>1)this._updateOneToMany&&this._updateOneToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen===1&&newIdxMapValLen===1)this._update&&this._update(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen>1&&newIdxMapValLen>1)this._updateManyToMany&&this._updateManyToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen>1)for(var i_1=0;i_1<oldIdxMapValLen;i_1++)this._remove&&this._remove(oldIdxMapVal[i_1]);else this._remove&&this._remove(oldIdxMapVal)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer$1.prototype._performRestAdd=function(newDataKeyArr,newDataIndexMap){for(var i$1=0;i$1<newDataKeyArr.length;i$1++){var newKey=newDataKeyArr[i$1],newIdxMapVal=newDataIndexMap[newKey],idxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(idxMapValLen>1)for(var j$1=0;j$1<idxMapValLen;j$1++)this._add&&this._add(newIdxMapVal[j$1]);else idxMapValLen===1&&this._add&&this._add(newIdxMapVal);newDataIndexMap[newKey]=null}},DataDiffer$1.prototype._initIndexMap=function(arr,map$2,keyArr,keyGetterName){for(var cbModeMultiple=this._diffModeMultiple,i$1=0;i$1<arr.length;i$1++){var key$1=`_ec_`+this[keyGetterName](arr[i$1],i$1);if(cbModeMultiple||(keyArr[i$1]=key$1),map$2){var idxMapVal=map$2[key$1],idxMapValLen=dataIndexMapValueLength(idxMapVal);idxMapValLen===0?(map$2[key$1]=i$1,cbModeMultiple&&keyArr.push(key$1)):idxMapValLen===1?map$2[key$1]=[idxMapVal,i$1]:idxMapVal.push(i$1)}}},DataDiffer$1}(),DimensionUserOuput=function(){function DimensionUserOuput$1(encode,dimRequest){this._encode=encode,this._schema=dimRequest}return DimensionUserOuput$1.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},DimensionUserOuput$1.prototype._getFullDimensionNames=function(){return this._cachedDimNames||=this._schema?this._schema.makeOutputDimensionNames():[],this._cachedDimNames},DimensionUserOuput$1}();function summarizeDimensions(data,schema){var summary={},encode=summary.encode={},notExtraCoordDimMap=createHashMap(),defaultedLabel=[],defaultedTooltip=[],userOutputEncode={};each(data.dimensions,function(dimName){var dimItem=data.getDimensionInfo(dimName),coordDim=dimItem.coordDim;if(coordDim){var coordDimIndex=dimItem.coordDimIndex;getOrCreateEncodeArr(encode,coordDim)[coordDimIndex]=dimName,dimItem.isExtraCoord||(notExtraCoordDimMap.set(coordDim,1),mayLabelDimType(dimItem.type)&&(defaultedLabel[0]=dimName),getOrCreateEncodeArr(userOutputEncode,coordDim)[coordDimIndex]=data.getDimensionIndex(dimItem.name)),dimItem.defaultTooltip&&defaultedTooltip.push(dimName)}VISUAL_DIMENSIONS.each(function(v$1,otherDim){var encodeArr=getOrCreateEncodeArr(encode,otherDim),dimIndex=dimItem.otherDims[otherDim];dimIndex!=null&&dimIndex!==!1&&(encodeArr[dimIndex]=dimItem.name)})});var dataDimsOnCoord=[],encodeFirstDimNotExtra={};notExtraCoordDimMap.each(function(v$1,coordDim){var dimArr=encode[coordDim];encodeFirstDimNotExtra[coordDim]=dimArr[0],dataDimsOnCoord=dataDimsOnCoord.concat(dimArr)}),summary.dataDimsOnCoord=dataDimsOnCoord,summary.dataDimIndicesOnCoord=map(dataDimsOnCoord,function(dimName){return data.getDimensionInfo(dimName).storeDimIndex}),summary.encodeFirstDimNotExtra=encodeFirstDimNotExtra;var encodeLabel=encode.label;encodeLabel&&encodeLabel.length&&(defaultedLabel=encodeLabel.slice());var encodeTooltip=encode.tooltip;return encodeTooltip&&encodeTooltip.length?defaultedTooltip=encodeTooltip.slice():defaultedTooltip.length||(defaultedTooltip=defaultedLabel.slice()),encode.defaultedLabel=defaultedLabel,encode.defaultedTooltip=defaultedTooltip,summary.userOutput=new DimensionUserOuput(userOutputEncode,schema),summary}function getOrCreateEncodeArr(encode,dim){return encode.hasOwnProperty(dim)||(encode[dim]=[]),encode[dim]}function getDimensionTypeByAxis(axisType){return axisType===`category`?`ordinal`:axisType===`time`?`time`:`float`}function mayLabelDimType(dimType){return!(dimType===`ordinal`||dimType===`time`)}var SeriesDimensionDefine_default=function(){function SeriesDimensionDefine$1(opt){this.otherDims={},opt!=null&&extend(this,opt)}return SeriesDimensionDefine$1}(),inner$6=makeInner(),dimTypeShort={float:`f`,int:`i`,ordinal:`o`,number:`n`,time:`t`},SeriesDataSchema=function(){function SeriesDataSchema$1(opt){this.dimensions=opt.dimensions,this._dimOmitted=opt.dimensionOmitted,this.source=opt.source,this._fullDimCount=opt.fullDimensionCount,this._updateDimOmitted(opt.dimensionOmitted)}return SeriesDataSchema$1.prototype.isDimensionOmitted=function(){return this._dimOmitted},SeriesDataSchema$1.prototype._updateDimOmitted=function(dimensionOmitted){this._dimOmitted=dimensionOmitted,dimensionOmitted&&(this._dimNameMap||=ensureSourceDimNameMap(this.source))},SeriesDataSchema$1.prototype.getSourceDimensionIndex=function(dimName){return retrieve2(this._dimNameMap.get(dimName),-1)},SeriesDataSchema$1.prototype.getSourceDimension=function(dimIndex){var dimensionsDefine=this.source.dimensionsDefine;if(dimensionsDefine)return dimensionsDefine[dimIndex]},SeriesDataSchema$1.prototype.makeStoreSchema=function(){for(var dimCount=this._fullDimCount,willRetrieveDataByName=shouldRetrieveDataByName(this.source),makeHashStrict=!shouldOmitUnusedDimensions(dimCount),dimHash=``,dims=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<dimCount;fullDimIdx++){var property=void 0,type=void 0,ordinalMeta=void 0,seriesDimDef=this.dimensions[seriesDimIdx];if(seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx)property=willRetrieveDataByName?seriesDimDef.name:null,type=seriesDimDef.type,ordinalMeta=seriesDimDef.ordinalMeta,seriesDimIdx++;else{var sourceDimDef=this.getSourceDimension(fullDimIdx);sourceDimDef&&(property=willRetrieveDataByName?sourceDimDef.name:null,type=sourceDimDef.type)}dims.push({property,type,ordinalMeta}),willRetrieveDataByName&&property!=null&&(!seriesDimDef||!seriesDimDef.isCalculationCoord)&&(dimHash+=makeHashStrict?property.replace(/\`/g,"`1").replace(/\$/g,"`2"):property),dimHash+=`$`,dimHash+=dimTypeShort[type]||`f`,ordinalMeta&&(dimHash+=ordinalMeta.uid),dimHash+=`$`}var source$2=this.source,hash=[source$2.seriesLayoutBy,source$2.startIndex,dimHash].join(`$$`);return{dimensions:dims,hash}},SeriesDataSchema$1.prototype.makeOutputDimensionNames=function(){for(var result=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<this._fullDimCount;fullDimIdx++){var name_1=void 0,seriesDimDef=this.dimensions[seriesDimIdx];if(seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx)seriesDimDef.isCalculationCoord||(name_1=seriesDimDef.name),seriesDimIdx++;else{var sourceDimDef=this.getSourceDimension(fullDimIdx);sourceDimDef&&(name_1=sourceDimDef.name)}result.push(name_1)}return result},SeriesDataSchema$1.prototype.appendCalculationDimension=function(dimDef){this.dimensions.push(dimDef),dimDef.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},SeriesDataSchema$1}();function isSeriesDataSchema(schema){return schema instanceof SeriesDataSchema}function createDimNameMap(dimsDef){for(var dataDimNameMap=createHashMap(),i$1=0;i$1<(dimsDef||[]).length;i$1++){var dimDefItemRaw=dimsDef[i$1],userDimName=isObject(dimDefItemRaw)?dimDefItemRaw.name:dimDefItemRaw;userDimName!=null&&dataDimNameMap.get(userDimName)==null&&dataDimNameMap.set(userDimName,i$1)}return dataDimNameMap}function ensureSourceDimNameMap(source$2){var innerSource=inner$6(source$2);return innerSource.dimNameMap||=createDimNameMap(source$2.dimensionsDefine)}function shouldOmitUnusedDimensions(dimCount){return dimCount>30}var isObject$1=isObject,map$1=map,CtorInt32Array$1=typeof Int32Array>`u`?Array:Int32Array,ID_PREFIX=`e\0\0`,INDEX_NOT_FOUND=-1,TRANSFERABLE_PROPERTIES=[`hasItemOption`,`_nameList`,`_idList`,`_invertedIndicesMap`,`_dimSummary`,`userOutput`,`_rawData`,`_dimValueGetter`,`_nameDimIdx`,`_idDimIdx`,`_nameRepeatCount`],CLONE_PROPERTIES=[`_approximateExtent`],prepareInvertedIndex,getId,getIdNameFromStore,normalizeDimensions,transferProperties,cloneListForMapAndSample,makeIdFromName,SeriesData_default=function(){function SeriesData$1(dimensionsInput,hostModel){this.type=`list`,this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=[`cloneShallow`,`downSample`,`minmaxDownSample`,`lttbDownSample`,`map`],this.CHANGABLE_METHODS=[`filterSelf`,`selectRange`],this.DOWNSAMPLE_METHODS=[`downSample`,`minmaxDownSample`,`lttbDownSample`];var dimensions,assignStoreDimIdx=!1;isSeriesDataSchema(dimensionsInput)?(dimensions=dimensionsInput.dimensions,this._dimOmitted=dimensionsInput.isDimensionOmitted(),this._schema=dimensionsInput):(assignStoreDimIdx=!0,dimensions=dimensionsInput),dimensions||=[`x`,`y`];for(var dimensionInfos={},dimensionNames=[],invertedIndicesMap={},needsHasOwn=!1,emptyObj={},i$1=0;i$1<dimensions.length;i$1++){var dimInfoInput=dimensions[i$1],dimensionInfo=isString(dimInfoInput)?new SeriesDimensionDefine_default({name:dimInfoInput}):dimInfoInput instanceof SeriesDimensionDefine_default?dimInfoInput:new SeriesDimensionDefine_default(dimInfoInput),dimensionName=dimensionInfo.name;dimensionInfo.type=dimensionInfo.type||`float`,dimensionInfo.coordDim||(dimensionInfo.coordDim=dimensionName,dimensionInfo.coordDimIndex=0);var otherDims=dimensionInfo.otherDims=dimensionInfo.otherDims||{};dimensionNames.push(dimensionName),dimensionInfos[dimensionName]=dimensionInfo,emptyObj[dimensionName]!=null&&(needsHasOwn=!0),dimensionInfo.createInvertedIndices&&(invertedIndicesMap[dimensionName]=[]);var dimIdx=i$1;isNumber(dimensionInfo.storeDimIndex)&&(dimIdx=dimensionInfo.storeDimIndex),otherDims.itemName===0&&(this._nameDimIdx=dimIdx),otherDims.itemId===0&&(this._idDimIdx=dimIdx),assignStoreDimIdx&&(dimensionInfo.storeDimIndex=i$1)}if(this.dimensions=dimensionNames,this._dimInfos=dimensionInfos,this._initGetDimensionInfo(needsHasOwn),this.hostModel=hostModel,this._invertedIndicesMap=invertedIndicesMap,this._dimOmitted){var dimIdxToName_1=this._dimIdxToName=createHashMap();each(dimensionNames,function(dimName){dimIdxToName_1.set(dimensionInfos[dimName].storeDimIndex,dimName)})}}return SeriesData$1.prototype.getDimension=function(dim){var dimIdx=this._recognizeDimIndex(dim);if(dimIdx==null)return dim;if(dimIdx=dim,!this._dimOmitted)return this.dimensions[dimIdx];var dimName=this._dimIdxToName.get(dimIdx);if(dimName!=null)return dimName;var sourceDimDef=this._schema.getSourceDimension(dimIdx);if(sourceDimDef)return sourceDimDef.name},SeriesData$1.prototype.getDimensionIndex=function(dim){var dimIdx=this._recognizeDimIndex(dim);if(dimIdx!=null)return dimIdx;if(dim==null)return-1;var dimInfo=this._getDimInfo(dim);return dimInfo?dimInfo.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(dim):-1},SeriesData$1.prototype._recognizeDimIndex=function(dim){if(isNumber(dim)||dim!=null&&!isNaN(dim)&&!this._getDimInfo(dim)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(dim)<0))return+dim},SeriesData$1.prototype._getStoreDimIndex=function(dim){return this.getDimensionIndex(dim)},SeriesData$1.prototype.getDimensionInfo=function(dim){return this._getDimInfo(this.getDimension(dim))},SeriesData$1.prototype._initGetDimensionInfo=function(needsHasOwn){var dimensionInfos=this._dimInfos;this._getDimInfo=needsHasOwn?function(dimName){return dimensionInfos.hasOwnProperty(dimName)?dimensionInfos[dimName]:void 0}:function(dimName){return dimensionInfos[dimName]}},SeriesData$1.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},SeriesData$1.prototype.mapDimension=function(coordDim,idx){var dimensionsSummary=this._dimSummary;if(idx==null)return dimensionsSummary.encodeFirstDimNotExtra[coordDim];var dims=dimensionsSummary.encode[coordDim];return dims?dims[idx]:null},SeriesData$1.prototype.mapDimensionsAll=function(coordDim){return(this._dimSummary.encode[coordDim]||[]).slice()},SeriesData$1.prototype.getStore=function(){return this._store},SeriesData$1.prototype.initData=function(data,nameList,dimValueGetter){var _this=this,store;if(data instanceof DataStore_default&&(store=data),!store){var dimensions=this.dimensions,provider=isSourceInstance(data)||isArrayLike(data)?new DefaultDataProvider(data,dimensions.length):data;store=new DataStore_default;var dimensionInfos=map$1(dimensions,function(dimName){return{type:_this._dimInfos[dimName].type,property:dimName}});store.initData(provider,dimensionInfos,dimValueGetter)}this._store=store,this._nameList=(nameList||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,store.count()),this._dimSummary=summarizeDimensions(this,this._schema),this.userOutput=this._dimSummary.userOutput},SeriesData$1.prototype.appendData=function(data){var range=this._store.appendData(data);this._doInit(range[0],range[1])},SeriesData$1.prototype.appendValues=function(values,names){var _a$1=this._store.appendValues(values,names&&names.length),start$1=_a$1.start,end$1=_a$1.end,shouldMakeIdFromName=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),names)for(var idx=start$1;idx<end$1;idx++){var sourceIdx=idx-start$1;this._nameList[idx]=names[sourceIdx],shouldMakeIdFromName&&makeIdFromName(this,idx)}},SeriesData$1.prototype._updateOrdinalMeta=function(){for(var store=this._store,dimensions=this.dimensions,i$1=0;i$1<dimensions.length;i$1++){var dimInfo=this._dimInfos[dimensions[i$1]];dimInfo.ordinalMeta&&store.collectOrdinalMeta(dimInfo.storeDimIndex,dimInfo.ordinalMeta)}},SeriesData$1.prototype._shouldMakeIdFromName=function(){var provider=this._store.getProvider();return this._idDimIdx==null&&provider.getSource().sourceFormat!==`typedArray`&&!provider.fillStorage},SeriesData$1.prototype._doInit=function(start$1,end$1){if(!(start$1>=end$1)){var provider=this._store.getProvider();this._updateOrdinalMeta();var nameList=this._nameList,idList=this._idList;if(provider.getSource().sourceFormat===`original`&&!provider.pure)for(var sharedDataItem=[],idx=start$1;idx<end$1;idx++){var dataItem=provider.getItem(idx,sharedDataItem);if(!this.hasItemOption&&isDataItemOption(dataItem)&&(this.hasItemOption=!0),dataItem){var itemName=dataItem.name;nameList[idx]==null&&itemName!=null&&(nameList[idx]=convertOptionIdName(itemName,null));var itemId=dataItem.id;idList[idx]==null&&itemId!=null&&(idList[idx]=convertOptionIdName(itemId,null))}}if(this._shouldMakeIdFromName())for(var idx=start$1;idx<end$1;idx++)makeIdFromName(this,idx);prepareInvertedIndex(this)}},SeriesData$1.prototype.getApproximateExtent=function(dim){return this._approximateExtent[dim]||this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData$1.prototype.setApproximateExtent=function(extent,dim){dim=this.getDimension(dim),this._approximateExtent[dim]=extent.slice()},SeriesData$1.prototype.getCalculationInfo=function(key$1){return this._calculationInfo[key$1]},SeriesData$1.prototype.setCalculationInfo=function(key$1,value){isObject$1(key$1)?extend(this._calculationInfo,key$1):this._calculationInfo[key$1]=value},SeriesData$1.prototype.getName=function(idx){var rawIndex=this.getRawIndex(idx),name=this._nameList[rawIndex];return name==null&&this._nameDimIdx!=null&&(name=getIdNameFromStore(this,this._nameDimIdx,rawIndex)),name??=``,name},SeriesData$1.prototype._getCategory=function(dimIdx,idx){var ordinal=this._store.get(dimIdx,idx),ordinalMeta=this._store.getOrdinalMeta(dimIdx);return ordinalMeta?ordinalMeta.categories[ordinal]:ordinal},SeriesData$1.prototype.getId=function(idx){return getId(this,this.getRawIndex(idx))},SeriesData$1.prototype.count=function(){return this._store.count()},SeriesData$1.prototype.get=function(dim,idx){var store=this._store,dimInfo=this._dimInfos[dim];if(dimInfo)return store.get(dimInfo.storeDimIndex,idx)},SeriesData$1.prototype.getByRawIndex=function(dim,rawIdx){var store=this._store,dimInfo=this._dimInfos[dim];if(dimInfo)return store.getByRawIndex(dimInfo.storeDimIndex,rawIdx)},SeriesData$1.prototype.getIndices=function(){return this._store.getIndices()},SeriesData$1.prototype.getDataExtent=function(dim){return this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData$1.prototype.getSum=function(dim){return this._store.getSum(this._getStoreDimIndex(dim))},SeriesData$1.prototype.getMedian=function(dim){return this._store.getMedian(this._getStoreDimIndex(dim))},SeriesData$1.prototype.getValues=function(dimensions,idx){var _this=this,store=this._store;return isArray(dimensions)?store.getValues(map$1(dimensions,function(dim){return _this._getStoreDimIndex(dim)}),idx):store.getValues(dimensions)},SeriesData$1.prototype.hasValue=function(idx){for(var dataDimIndicesOnCoord=this._dimSummary.dataDimIndicesOnCoord,i$1=0,len$1=dataDimIndicesOnCoord.length;i$1<len$1;i$1++)if(isNaN(this._store.get(dataDimIndicesOnCoord[i$1],idx)))return!1;return!0},SeriesData$1.prototype.indexOfName=function(name){for(var i$1=0,len$1=this._store.count();i$1<len$1;i$1++)if(this.getName(i$1)===name)return i$1;return-1},SeriesData$1.prototype.getRawIndex=function(idx){return this._store.getRawIndex(idx)},SeriesData$1.prototype.indexOfRawIndex=function(rawIndex){return this._store.indexOfRawIndex(rawIndex)},SeriesData$1.prototype.rawIndexOf=function(dim,value){var invertedIndices=dim&&this._invertedIndicesMap[dim],rawIndex=invertedIndices&&invertedIndices[value];return rawIndex==null||isNaN(rawIndex)?INDEX_NOT_FOUND:rawIndex},SeriesData$1.prototype.each=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);var fCtx=ctx||this,dimIndices=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this);this._store.each(dimIndices,fCtx?bind(cb,fCtx):cb)},SeriesData$1.prototype.filterSelf=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);var fCtx=ctx||this,dimIndices=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this);return this._store=this._store.filter(dimIndices,fCtx?bind(cb,fCtx):cb),this},SeriesData$1.prototype.selectRange=function(range){var _this=this,innerRange={},dims=keys(range),dimIndices=[];return each(dims,function(dim){var dimIdx=_this._getStoreDimIndex(dim);innerRange[dimIdx]=range[dim],dimIndices.push(dimIdx)}),this._store=this._store.selectRange(innerRange),this},SeriesData$1.prototype.mapArray=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]),ctx||=this;var result=[];return this.each(dims,function(){result.push(cb&&cb.apply(this,arguments))},ctx),result},SeriesData$1.prototype.map=function(dims,cb,ctx,ctxCompat){var fCtx=ctx||ctxCompat||this,dimIndices=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this),list=cloneListForMapAndSample(this);return list._store=this._store.map(dimIndices,fCtx?bind(cb,fCtx):cb),list},SeriesData$1.prototype.modify=function(dims,cb,ctx,ctxCompat){var fCtx=ctx||ctxCompat||this,dimIndices=map$1(normalizeDimensions(dims),this._getStoreDimIndex,this);this._store.modify(dimIndices,fCtx?bind(cb,fCtx):cb)},SeriesData$1.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){var list=cloneListForMapAndSample(this);return list._store=this._store.downSample(this._getStoreDimIndex(dimension),rate,sampleValue,sampleIndex),list},SeriesData$1.prototype.minmaxDownSample=function(valueDimension,rate){var list=cloneListForMapAndSample(this);return list._store=this._store.minmaxDownSample(this._getStoreDimIndex(valueDimension),rate),list},SeriesData$1.prototype.lttbDownSample=function(valueDimension,rate){var list=cloneListForMapAndSample(this);return list._store=this._store.lttbDownSample(this._getStoreDimIndex(valueDimension),rate),list},SeriesData$1.prototype.getRawDataItem=function(idx){return this._store.getRawDataItem(idx)},SeriesData$1.prototype.getItemModel=function(idx){var hostModel=this.hostModel,dataItem=this.getRawDataItem(idx);return new Model_default(dataItem,hostModel,hostModel&&hostModel.ecModel)},SeriesData$1.prototype.diff=function(otherList){var thisList=this;return new DataDiffer_default(otherList?otherList.getStore().getIndices():[],this.getStore().getIndices(),function(idx){return getId(otherList,idx)},function(idx){return getId(thisList,idx)})},SeriesData$1.prototype.getVisual=function(key$1){var visual=this._visual;return visual&&visual[key$1]},SeriesData$1.prototype.setVisual=function(kvObj,val){this._visual=this._visual||{},isObject$1(kvObj)?extend(this._visual,kvObj):this._visual[kvObj]=val},SeriesData$1.prototype.getItemVisual=function(idx,key$1){var itemVisual=this._itemVisuals[idx];return(itemVisual&&itemVisual[key$1])??this.getVisual(key$1)},SeriesData$1.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},SeriesData$1.prototype.ensureUniqueItemVisual=function(idx,key$1){var itemVisuals=this._itemVisuals,itemVisual=itemVisuals[idx];itemVisual||=itemVisuals[idx]={};var val=itemVisual[key$1];return val??(val=this.getVisual(key$1),isArray(val)?val=val.slice():isObject$1(val)&&(val=extend({},val)),itemVisual[key$1]=val),val},SeriesData$1.prototype.setItemVisual=function(idx,key$1,value){var itemVisual=this._itemVisuals[idx]||{};this._itemVisuals[idx]=itemVisual,isObject$1(key$1)?extend(itemVisual,key$1):itemVisual[key$1]=value},SeriesData$1.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},SeriesData$1.prototype.setLayout=function(key$1,val){isObject$1(key$1)?extend(this._layout,key$1):this._layout[key$1]=val},SeriesData$1.prototype.getLayout=function(key$1){return this._layout[key$1]},SeriesData$1.prototype.getItemLayout=function(idx){return this._itemLayouts[idx]},SeriesData$1.prototype.setItemLayout=function(idx,layout$2,merge$1){this._itemLayouts[idx]=merge$1?extend(this._itemLayouts[idx]||{},layout$2):layout$2},SeriesData$1.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},SeriesData$1.prototype.setItemGraphicEl=function(idx,el){var seriesIndex=this.hostModel&&this.hostModel.seriesIndex;setCommonECData(seriesIndex,this.dataType,idx,el),this._graphicEls[idx]=el},SeriesData$1.prototype.getItemGraphicEl=function(idx){return this._graphicEls[idx]},SeriesData$1.prototype.eachItemGraphicEl=function(cb,context$1){each(this._graphicEls,function(el,idx){el&&cb&&cb.call(context$1,el,idx)})},SeriesData$1.prototype.cloneShallow=function(list){return list||=new SeriesData$1(this._schema?this._schema:map$1(this.dimensions,this._getDimInfo,this),this.hostModel),transferProperties(list,this),list._store=this._store,list},SeriesData$1.prototype.wrapMethod=function(methodName,injectFunction){var originalMethod=this[methodName];isFunction(originalMethod)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(methodName),this[methodName]=function(){var res=originalMethod.apply(this,arguments);return injectFunction.apply(this,[res].concat(slice(arguments)))})},SeriesData$1.internalField=function(){prepareInvertedIndex=function(data){var invertedIndicesMap=data._invertedIndicesMap;each(invertedIndicesMap,function(invertedIndices,dim){var dimInfo=data._dimInfos[dim],ordinalMeta=dimInfo.ordinalMeta,store=data._store;if(ordinalMeta){invertedIndices=invertedIndicesMap[dim]=new CtorInt32Array$1(ordinalMeta.categories.length);for(var i$1=0;i$1<invertedIndices.length;i$1++)invertedIndices[i$1]=INDEX_NOT_FOUND;for(var i$1=0;i$1<store.count();i$1++)invertedIndices[store.get(dimInfo.storeDimIndex,i$1)]=i$1}})},getIdNameFromStore=function(data,dimIdx,idx){return convertOptionIdName(data._getCategory(dimIdx,idx),null)},getId=function(data,rawIndex){var id=data._idList[rawIndex];return id==null&&data._idDimIdx!=null&&(id=getIdNameFromStore(data,data._idDimIdx,rawIndex)),id??=ID_PREFIX+rawIndex,id},normalizeDimensions=function(dimensions){return isArray(dimensions)||(dimensions=dimensions==null?[]:[dimensions]),dimensions},cloneListForMapAndSample=function(original){var list=new SeriesData$1(original._schema?original._schema:map$1(original.dimensions,original._getDimInfo,original),original.hostModel);return transferProperties(list,original),list},transferProperties=function(target,source$2){each(TRANSFERABLE_PROPERTIES.concat(source$2.__wrappedMethods||[]),function(propName){source$2.hasOwnProperty(propName)&&(target[propName]=source$2[propName])}),target.__wrappedMethods=source$2.__wrappedMethods,each(CLONE_PROPERTIES,function(propName){target[propName]=clone(source$2[propName])}),target._calculationInfo=extend({},source$2._calculationInfo)},makeIdFromName=function(data,idx){var nameList=data._nameList,idList=data._idList,nameDimIdx=data._nameDimIdx,idDimIdx=data._idDimIdx,name=nameList[idx],id=idList[idx];if(name==null&&nameDimIdx!=null&&(nameList[idx]=name=getIdNameFromStore(data,nameDimIdx,idx)),id==null&&idDimIdx!=null&&(idList[idx]=id=getIdNameFromStore(data,idDimIdx,idx)),id==null&&name!=null){var nameRepeatCount=data._nameRepeatCount,nmCnt=nameRepeatCount[name]=(nameRepeatCount[name]||0)+1;id=name,nmCnt>1&&(id+=`__ec__`+nmCnt),idList[idx]=id}}}(),SeriesData$1}();function prepareSeriesDataSchema(source$2,opt){isSourceInstance(source$2)||(source$2=createSourceFromSeriesDataOption(source$2)),opt||={};var sysDims=opt.coordDimensions||[],dimsDef=opt.dimensionsDefine||source$2.dimensionsDefine||[],coordDimNameMap=createHashMap(),resultList=[],dimCount=getDimCount(source$2,sysDims,dimsDef,opt.dimensionsCount),omitUnusedDimensions=opt.canOmitUnusedDimensions&&shouldOmitUnusedDimensions(dimCount),isUsingSourceDimensionsDef=dimsDef===source$2.dimensionsDefine,dataDimNameMap=isUsingSourceDimensionsDef?ensureSourceDimNameMap(source$2):createDimNameMap(dimsDef),encodeDef=opt.encodeDefine;!encodeDef&&opt.encodeDefaulter&&(encodeDef=opt.encodeDefaulter(source$2,dimCount));for(var encodeDefMap=createHashMap(encodeDef),indicesMap=new CtorInt32Array(dimCount),i$1=0;i$1<indicesMap.length;i$1++)indicesMap[i$1]=-1;function getResultItem(dimIdx){var idx=indicesMap[dimIdx];if(idx<0){var dimDefItemRaw=dimsDef[dimIdx],dimDefItem=isObject(dimDefItemRaw)?dimDefItemRaw:{name:dimDefItemRaw},resultItem$1=new SeriesDimensionDefine_default,userDimName=dimDefItem.name;return userDimName!=null&&dataDimNameMap.get(userDimName)!=null&&(resultItem$1.name=resultItem$1.displayName=userDimName),dimDefItem.type!=null&&(resultItem$1.type=dimDefItem.type),dimDefItem.displayName!=null&&(resultItem$1.displayName=dimDefItem.displayName),indicesMap[dimIdx]=resultList.length,resultItem$1.storeDimIndex=dimIdx,resultList.push(resultItem$1),resultItem$1}return resultList[idx]}if(!omitUnusedDimensions)for(var i$1=0;i$1<dimCount;i$1++)getResultItem(i$1);encodeDefMap.each(function(dataDimsRaw,coordDim){var dataDims=normalizeToArray(dataDimsRaw).slice();if(dataDims.length===1&&!isString(dataDims[0])&&dataDims[0]<0){encodeDefMap.set(coordDim,!1);return}var validDataDims=encodeDefMap.set(coordDim,[]);each(dataDims,function(resultDimIdxOrName,idx){var resultDimIdx$1=isString(resultDimIdxOrName)?dataDimNameMap.get(resultDimIdxOrName):resultDimIdxOrName;resultDimIdx$1!=null&&resultDimIdx$1<dimCount&&(validDataDims[idx]=resultDimIdx$1,applyDim(getResultItem(resultDimIdx$1),coordDim,idx))})});var availDimIdx=0;each(sysDims,function(sysDimItemRaw){var coordDim,sysDimItemDimsDef,sysDimItemOtherDims,sysDimItem;if(isString(sysDimItemRaw))coordDim=sysDimItemRaw,sysDimItem={};else{sysDimItem=sysDimItemRaw,coordDim=sysDimItem.name;var ordinalMeta=sysDimItem.ordinalMeta;sysDimItem.ordinalMeta=null,sysDimItem=extend({},sysDimItem),sysDimItem.ordinalMeta=ordinalMeta,sysDimItemDimsDef=sysDimItem.dimsDef,sysDimItemOtherDims=sysDimItem.otherDims,sysDimItem.name=sysDimItem.coordDim=sysDimItem.coordDimIndex=sysDimItem.dimsDef=sysDimItem.otherDims=null}var dataDims=encodeDefMap.get(coordDim);if(dataDims!==!1){if(dataDims=normalizeToArray(dataDims),!dataDims.length)for(var i$2=0;i$2<(sysDimItemDimsDef&&sysDimItemDimsDef.length||1);i$2++){for(;availDimIdx<dimCount&&getResultItem(availDimIdx).coordDim!=null;)availDimIdx++;availDimIdx<dimCount&&dataDims.push(availDimIdx++)}each(dataDims,function(resultDimIdx$1,coordDimIndex){var resultItem$1=getResultItem(resultDimIdx$1);if(isUsingSourceDimensionsDef&&sysDimItem.type!=null&&(resultItem$1.type=sysDimItem.type),applyDim(defaults(resultItem$1,sysDimItem),coordDim,coordDimIndex),resultItem$1.name==null&&sysDimItemDimsDef){var sysDimItemDimsDefItem=sysDimItemDimsDef[coordDimIndex];!isObject(sysDimItemDimsDefItem)&&(sysDimItemDimsDefItem={name:sysDimItemDimsDefItem}),resultItem$1.name=resultItem$1.displayName=sysDimItemDimsDefItem.name,resultItem$1.defaultTooltip=sysDimItemDimsDefItem.defaultTooltip}sysDimItemOtherDims&&defaults(resultItem$1.otherDims,sysDimItemOtherDims)})}});function applyDim(resultItem$1,coordDim,coordDimIndex){VISUAL_DIMENSIONS.get(coordDim)==null?(resultItem$1.coordDim=coordDim,resultItem$1.coordDimIndex=coordDimIndex,coordDimNameMap.set(coordDim,!0)):resultItem$1.otherDims[coordDim]=coordDimIndex}var generateCoord=opt.generateCoord,generateCoordCount=opt.generateCoordCount,fromZero=generateCoordCount!=null;generateCoordCount=generateCoord?generateCoordCount||1:0;var extra=generateCoord||`value`;function ifNoNameFillWithCoordName(resultItem$1){resultItem$1.name??=resultItem$1.coordDim}if(omitUnusedDimensions)each(resultList,function(resultItem$1){ifNoNameFillWithCoordName(resultItem$1)}),resultList.sort(function(item0,item1){return item0.storeDimIndex-item1.storeDimIndex});else for(var resultDimIdx=0;resultDimIdx<dimCount;resultDimIdx++){var resultItem=getResultItem(resultDimIdx);resultItem.coordDim??(resultItem.coordDim=genCoordDimName(extra,coordDimNameMap,fromZero),resultItem.coordDimIndex=0,(!generateCoord||generateCoordCount<=0)&&(resultItem.isExtraCoord=!0),generateCoordCount--),ifNoNameFillWithCoordName(resultItem),resultItem.type==null&&(guessOrdinal(source$2,resultDimIdx)===BE_ORDINAL.Must||resultItem.isExtraCoord&&(resultItem.otherDims.itemName!=null||resultItem.otherDims.seriesName!=null))&&(resultItem.type=`ordinal`)}return removeDuplication(resultList),new SeriesDataSchema({source:source$2,dimensions:resultList,fullDimensionCount:dimCount,dimensionOmitted:omitUnusedDimensions})}function removeDuplication(result){for(var duplicationMap=createHashMap(),i$1=0;i$1<result.length;i$1++){var dim=result[i$1],dimOriginalName=dim.name,count$1=duplicationMap.get(dimOriginalName)||0;count$1>0&&(dim.name=dimOriginalName+(count$1-1)),count$1++,duplicationMap.set(dimOriginalName,count$1)}}function getDimCount(source$2,sysDims,dimsDef,optDimCount){var dimCount=Math.max(source$2.dimensionsDetectedCount||1,sysDims.length,dimsDef.length,optDimCount||0);return each(sysDims,function(sysDimItem){var sysDimItemDimsDef;isObject(sysDimItem)&&(sysDimItemDimsDef=sysDimItem.dimsDef)&&(dimCount=Math.max(dimCount,sysDimItemDimsDef.length))}),dimCount}function genCoordDimName(name,map$2,fromZero){if(fromZero||map$2.hasKey(name)){for(var i$1=0;map$2.hasKey(name+i$1);)i$1++;name+=i$1}return map$2.set(name,!0),name}var CoordSysInfo=function(){function CoordSysInfo$1(coordSysName){this.coordSysDims=[],this.axisMap=createHashMap(),this.categoryAxisMap=createHashMap(),this.coordSysName=coordSysName}return CoordSysInfo$1}();function getCoordSysInfoBySeries(seriesModel){var coordSysName=seriesModel.get(`coordinateSystem`),result=new CoordSysInfo(coordSysName),fetch$1=fetchers[coordSysName];if(fetch$1)return fetch$1(seriesModel,result,result.axisMap,result.categoryAxisMap),result}var fetchers={cartesian2d:function(seriesModel,result,axisMap,categoryAxisMap){var xAxisModel=seriesModel.getReferringComponents(`xAxis`,SINGLE_REFERRING).models[0],yAxisModel=seriesModel.getReferringComponents(`yAxis`,SINGLE_REFERRING).models[0];result.coordSysDims=[`x`,`y`],axisMap.set(`x`,xAxisModel),axisMap.set(`y`,yAxisModel),isCategory(xAxisModel)&&(categoryAxisMap.set(`x`,xAxisModel),result.firstCategoryDimIndex=0),isCategory(yAxisModel)&&(categoryAxisMap.set(`y`,yAxisModel),result.firstCategoryDimIndex??=1)},singleAxis:function(seriesModel,result,axisMap,categoryAxisMap){var singleAxisModel=seriesModel.getReferringComponents(`singleAxis`,SINGLE_REFERRING).models[0];result.coordSysDims=[`single`],axisMap.set(`single`,singleAxisModel),isCategory(singleAxisModel)&&(categoryAxisMap.set(`single`,singleAxisModel),result.firstCategoryDimIndex=0)},polar:function(seriesModel,result,axisMap,categoryAxisMap){var polarModel=seriesModel.getReferringComponents(`polar`,SINGLE_REFERRING).models[0],radiusAxisModel=polarModel.findAxisModel(`radiusAxis`),angleAxisModel=polarModel.findAxisModel(`angleAxis`);result.coordSysDims=[`radius`,`angle`],axisMap.set(`radius`,radiusAxisModel),axisMap.set(`angle`,angleAxisModel),isCategory(radiusAxisModel)&&(categoryAxisMap.set(`radius`,radiusAxisModel),result.firstCategoryDimIndex=0),isCategory(angleAxisModel)&&(categoryAxisMap.set(`angle`,angleAxisModel),result.firstCategoryDimIndex??=1)},geo:function(seriesModel,result,axisMap,categoryAxisMap){result.coordSysDims=[`lng`,`lat`]},parallel:function(seriesModel,result,axisMap,categoryAxisMap){var ecModel=seriesModel.ecModel,parallelModel=ecModel.getComponent(`parallel`,seriesModel.get(`parallelIndex`)),coordSysDims=result.coordSysDims=parallelModel.dimensions.slice();each(parallelModel.parallelAxisIndex,function(axisIndex,index){var axisModel=ecModel.getComponent(`parallelAxis`,axisIndex),axisDim=coordSysDims[index];axisMap.set(axisDim,axisModel),isCategory(axisModel)&&(categoryAxisMap.set(axisDim,axisModel),result.firstCategoryDimIndex??=index)})},matrix:function(seriesModel,result,axisMap,categoryAxisMap){var matrixModel=seriesModel.getReferringComponents(`matrix`,SINGLE_REFERRING).models[0];result.coordSysDims=[`x`,`y`];var xModel=matrixModel.getDimensionModel(`x`),yModel=matrixModel.getDimensionModel(`y`);axisMap.set(`x`,xModel),axisMap.set(`y`,yModel),categoryAxisMap.set(`x`,xModel),categoryAxisMap.set(`y`,yModel)}};function isCategory(axisModel){return axisModel.get(`type`)===`category`}function enableDataStack(seriesModel,dimensionsInput,opt){opt||={};var byIndex=opt.byIndex,stackedCoordDimension=opt.stackedCoordDimension,dimensionDefineList,schema,store;isLegacyDimensionsInput(dimensionsInput)?dimensionDefineList=dimensionsInput:(schema=dimensionsInput.schema,dimensionDefineList=schema.dimensions,store=dimensionsInput.store);var mayStack=!!(seriesModel&&seriesModel.get(`stack`)),stackedByDimInfo,stackedDimInfo,stackResultDimension,stackedOverDimension;if(each(dimensionDefineList,function(dimensionInfo,index){isString(dimensionInfo)&&(dimensionDefineList[index]=dimensionInfo={name:dimensionInfo}),mayStack&&!dimensionInfo.isExtraCoord&&(!byIndex&&!stackedByDimInfo&&dimensionInfo.ordinalMeta&&(stackedByDimInfo=dimensionInfo),!stackedDimInfo&&dimensionInfo.type!==`ordinal`&&dimensionInfo.type!==`time`&&(!stackedCoordDimension||stackedCoordDimension===dimensionInfo.coordDim)&&(stackedDimInfo=dimensionInfo))}),stackedDimInfo&&!byIndex&&!stackedByDimInfo&&(byIndex=!0),stackedDimInfo){stackResultDimension=`__\0ecstackresult_`+seriesModel.id,stackedOverDimension=`__\0ecstackedover_`+seriesModel.id,stackedByDimInfo&&(stackedByDimInfo.createInvertedIndices=!0);var stackedDimCoordDim_1=stackedDimInfo.coordDim,stackedDimType=stackedDimInfo.type,stackedDimCoordIndex_1=0;each(dimensionDefineList,function(dimensionInfo){dimensionInfo.coordDim===stackedDimCoordDim_1&&stackedDimCoordIndex_1++});var stackedOverDimensionDefine={name:stackResultDimension,coordDim:stackedDimCoordDim_1,coordDimIndex:stackedDimCoordIndex_1,type:stackedDimType,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length},stackResultDimensionDefine={name:stackedOverDimension,coordDim:stackedOverDimension,coordDimIndex:stackedDimCoordIndex_1+1,type:stackedDimType,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length+1};schema?(store&&(stackedOverDimensionDefine.storeDimIndex=store.ensureCalculationDimension(stackedOverDimension,stackedDimType),stackResultDimensionDefine.storeDimIndex=store.ensureCalculationDimension(stackResultDimension,stackedDimType)),schema.appendCalculationDimension(stackedOverDimensionDefine),schema.appendCalculationDimension(stackResultDimensionDefine)):(dimensionDefineList.push(stackedOverDimensionDefine),dimensionDefineList.push(stackResultDimensionDefine))}return{stackedDimension:stackedDimInfo&&stackedDimInfo.name,stackedByDimension:stackedByDimInfo&&stackedByDimInfo.name,isStackedByIndex:byIndex,stackedOverDimension,stackResultDimension}}function isLegacyDimensionsInput(dimensionsInput){return!isSeriesDataSchema(dimensionsInput.schema)}function isDimensionStacked(data,stackedDim){return!!stackedDim&&stackedDim===data.getCalculationInfo(`stackedDimension`)}function getStackedDimension(data,targetDim){return isDimensionStacked(data,targetDim)?data.getCalculationInfo(`stackResultDimension`):targetDim}function getCoordSysDimDefs(seriesModel,coordSysInfo){var coordSysName=seriesModel.get(`coordinateSystem`),registeredCoordSys=CoordinateSystem_default.get(coordSysName),coordSysDimDefs;return coordSysInfo&&coordSysInfo.coordSysDims&&(coordSysDimDefs=map(coordSysInfo.coordSysDims,function(dim){var dimInfo={name:dim},axisModel=coordSysInfo.axisMap.get(dim);if(axisModel){var axisType=axisModel.get(`type`);dimInfo.type=getDimensionTypeByAxis(axisType)}return dimInfo})),coordSysDimDefs||=registeredCoordSys&&(registeredCoordSys.getDimensionsInfo?registeredCoordSys.getDimensionsInfo():registeredCoordSys.dimensions.slice())||[`x`,`y`],coordSysDimDefs}function injectOrdinalMeta(dimInfoList,createInvertedIndices,coordSysInfo){var firstCategoryDimIndex,hasNameEncode;return coordSysInfo&&each(dimInfoList,function(dimInfo,dimIndex){var coordDim=dimInfo.coordDim,categoryAxisModel=coordSysInfo.categoryAxisMap.get(coordDim);categoryAxisModel&&(firstCategoryDimIndex??=dimIndex,dimInfo.ordinalMeta=categoryAxisModel.getOrdinalMeta(),createInvertedIndices&&(dimInfo.createInvertedIndices=!0)),dimInfo.otherDims.itemName!=null&&(hasNameEncode=!0)}),!hasNameEncode&&firstCategoryDimIndex!=null&&(dimInfoList[firstCategoryDimIndex].otherDims.itemName=0),firstCategoryDimIndex}function createSeriesData(sourceRaw,seriesModel,opt){opt||={};var sourceManager=seriesModel.getSourceManager(),source$2,isOriginalSource=!1;sourceRaw?(isOriginalSource=!0,source$2=createSourceFromSeriesDataOption(sourceRaw)):(source$2=sourceManager.getSource(),isOriginalSource=source$2.sourceFormat===SOURCE_FORMAT_ORIGINAL);var coordSysInfo=getCoordSysInfoBySeries(seriesModel),coordSysDimDefs=getCoordSysDimDefs(seriesModel,coordSysInfo),useEncodeDefaulter=opt.useEncodeDefaulter,encodeDefaulter=isFunction(useEncodeDefaulter)?useEncodeDefaulter:useEncodeDefaulter?curry(makeSeriesEncodeForAxisCoordSys,coordSysDimDefs,seriesModel):null,createDimensionOptions={coordDimensions:coordSysDimDefs,generateCoord:opt.generateCoord,encodeDefine:seriesModel.getEncode(),encodeDefaulter,canOmitUnusedDimensions:!isOriginalSource},schema=prepareSeriesDataSchema(source$2,createDimensionOptions),firstCategoryDimIndex=injectOrdinalMeta(schema.dimensions,opt.createInvertedIndices,coordSysInfo),store=isOriginalSource?null:sourceManager.getSharedDataStore(schema),stackCalculationInfo=enableDataStack(seriesModel,{schema,store}),data=new SeriesData_default(schema,seriesModel);data.setCalculationInfo(stackCalculationInfo);var dimValueGetter=firstCategoryDimIndex!=null&&isNeedCompleteOrdinalData(source$2)?function(itemOpt,dimName,dataIndex,dimIndex){return dimIndex===firstCategoryDimIndex?dataIndex:this.defaultDimValueGetter(itemOpt,dimName,dataIndex,dimIndex)}:null;return data.hasItemOption=!1,data.initData(isOriginalSource?source$2:store,null,dimValueGetter),data}function isNeedCompleteOrdinalData(source$2){if(source$2.sourceFormat===`original`){var sampleItem=firstDataNotNull(source$2.data||[]);return!isArray(getDataItemValue(sampleItem))}}function firstDataNotNull(arr){for(var i$1=0;i$1<arr.length&&arr[i$1]==null;)i$1++;return arr[i$1]}var createSeriesData_default=createSeriesData;function isIntervalOrLogScale(scale$3){return scale$3.type===`interval`||scale$3.type===`log`}function intervalScaleNiceTicks(extent,spanWithBreaks,splitNumber,minInterval,maxInterval){var result={},interval=result.interval=nice(spanWithBreaks/splitNumber,!0);minInterval!=null&&interval<minInterval&&(interval=result.interval=minInterval),maxInterval!=null&&interval>maxInterval&&(interval=result.interval=maxInterval);var precision=result.intervalPrecision=getIntervalPrecision(interval),niceTickExtent=result.niceTickExtent=[round(Math.ceil(extent[0]/interval)*interval,precision),round(Math.floor(extent[1]/interval)*interval,precision)];return fixExtent(niceTickExtent,extent),result}function increaseInterval(interval){var exp10=10**quantityExponent(interval),f$1=interval/exp10;return f$1?f$1===2?f$1=3:f$1===3?f$1=5:f$1*=2:f$1=1,round(f$1*exp10)}function getIntervalPrecision(interval){return getPrecision(interval)+2}function clamp(niceTickExtent,idx,extent){niceTickExtent[idx]=Math.max(Math.min(niceTickExtent[idx],extent[1]),extent[0])}function fixExtent(niceTickExtent,extent){!isFinite(niceTickExtent[0])&&(niceTickExtent[0]=extent[0]),!isFinite(niceTickExtent[1])&&(niceTickExtent[1]=extent[1]),clamp(niceTickExtent,0,extent),clamp(niceTickExtent,1,extent),niceTickExtent[0]>niceTickExtent[1]&&(niceTickExtent[0]=niceTickExtent[1])}function contain(val,extent){return val>=extent[0]&&val<=extent[1]}var ScaleCalculator=function(){function ScaleCalculator$1(){this.normalize=normalize,this.scale=scale}return ScaleCalculator$1.prototype.updateMethods=function(brkCtx){brkCtx.hasBreaks()?(this.normalize=bind(brkCtx.normalize,brkCtx),this.scale=bind(brkCtx.scale,brkCtx)):(this.normalize=normalize,this.scale=scale)},ScaleCalculator$1}();function normalize(val,extent){return extent[1]===extent[0]?.5:(val-extent[0])/(extent[1]-extent[0])}function scale(val,extent){return val*(extent[1]-extent[0])+extent[0]}function logTransform(base$1,extent,noClampNegative){var loggedBase=Math.log(base$1);return[Math.log(noClampNegative?extent[0]:Math.max(0,extent[0]))/loggedBase,Math.log(noClampNegative?extent[1]:Math.max(0,extent[1]))/loggedBase]}var Scale=function(){function Scale$1(setting){this._calculator=new ScaleCalculator,this._setting=setting||{},this._extent=[1/0,-1/0];var scaleBreakHelper=getScaleBreakHelper();scaleBreakHelper&&(this._brkCtx=scaleBreakHelper.createScaleBreakContext(),this._brkCtx.update(this._extent))}return Scale$1.prototype.getSetting=function(name){return this._setting[name]},Scale$1.prototype._innerUnionExtent=function(other){var extent=this._extent;this._innerSetExtent(other[0]<extent[0]?other[0]:extent[0],other[1]>extent[1]?other[1]:extent[1])},Scale$1.prototype.unionExtentFromData=function(data,dim){this._innerUnionExtent(data.getApproximateExtent(dim))},Scale$1.prototype.getExtent=function(){return this._extent.slice()},Scale$1.prototype.setExtent=function(start$1,end$1){this._innerSetExtent(start$1,end$1)},Scale$1.prototype._innerSetExtent=function(start$1,end$1){var thisExtent=this._extent;isNaN(start$1)||(thisExtent[0]=start$1),isNaN(end$1)||(thisExtent[1]=end$1),this._brkCtx&&this._brkCtx.update(thisExtent)},Scale$1.prototype.setBreaksFromOption=function(breakOptionList){var scaleBreakHelper=getScaleBreakHelper();scaleBreakHelper&&this._innerSetBreak(scaleBreakHelper.parseAxisBreakOption(breakOptionList,bind(this.parse,this)))},Scale$1.prototype._innerSetBreak=function(parsed){this._brkCtx&&(this._brkCtx.setBreaks(parsed),this._calculator.updateMethods(this._brkCtx),this._brkCtx.update(this._extent))},Scale$1.prototype._innerGetBreaks=function(){return this._brkCtx?this._brkCtx.breaks:[]},Scale$1.prototype.hasBreaks=function(){return this._brkCtx?this._brkCtx.hasBreaks():!1},Scale$1.prototype._getExtentSpanWithBreaks=function(){return this._brkCtx&&this._brkCtx.hasBreaks()?this._brkCtx.getExtentSpan():this._extent[1]-this._extent[0]},Scale$1.prototype.isInExtentRange=function(value){return this._extent[0]<=value&&this._extent[1]>=value},Scale$1.prototype.isBlank=function(){return this._isBlank},Scale$1.prototype.setBlank=function(isBlank){this._isBlank=isBlank},Scale$1}();enableClassManagement(Scale);var Scale_default=Scale,uidBase=0,OrdinalMeta=function(){function OrdinalMeta$1(opt){this.categories=opt.categories||[],this._needCollect=opt.needCollect,this._deduplication=opt.deduplication,this.uid=++uidBase,this._onCollect=opt.onCollect}return OrdinalMeta$1.createByAxisModel=function(axisModel){var option=axisModel.option,data=option.data,categories=data&&map(data,getName);return new OrdinalMeta$1({categories,needCollect:!categories,deduplication:option.dedplication!==!1})},OrdinalMeta$1.prototype.getOrdinal=function(category){return this._getOrCreateMap().get(category)},OrdinalMeta$1.prototype.parseAndCollect=function(category){var index,needCollect=this._needCollect;if(!isString(category)&&!needCollect)return category;if(needCollect&&!this._deduplication)return index=this.categories.length,this.categories[index]=category,this._onCollect&&this._onCollect(category,index),index;var map$2=this._getOrCreateMap();return index=map$2.get(category),index??(needCollect?(index=this.categories.length,this.categories[index]=category,map$2.set(category,index),this._onCollect&&this._onCollect(category,index)):index=NaN),index},OrdinalMeta$1.prototype._getOrCreateMap=function(){return this._map||=createHashMap(this.categories)},OrdinalMeta$1}();function getName(obj){return isObject(obj)&&obj.value!=null?obj.value:obj+``}var OrdinalMeta_default=OrdinalMeta,OrdinalScale=function(_super){__extends(OrdinalScale$1,_super);function OrdinalScale$1(setting){var _this=_super.call(this,setting)||this;_this.type=`ordinal`;var ordinalMeta=_this.getSetting(`ordinalMeta`);return ordinalMeta||=new OrdinalMeta_default({}),isArray(ordinalMeta)&&(ordinalMeta=new OrdinalMeta_default({categories:map(ordinalMeta,function(item){return isObject(item)?item.value:item})})),_this._ordinalMeta=ordinalMeta,_this._extent=_this.getSetting(`extent`)||[0,ordinalMeta.categories.length-1],_this}return OrdinalScale$1.prototype.parse=function(val){return val==null?NaN:isString(val)?this._ordinalMeta.getOrdinal(val):Math.round(val)},OrdinalScale$1.prototype.contain=function(val){return contain(val,this._extent)&&val>=0&&val<this._ordinalMeta.categories.length},OrdinalScale$1.prototype.normalize=function(val){return val=this._getTickNumber(val),this._calculator.normalize(val,this._extent)},OrdinalScale$1.prototype.scale=function(val){return val=Math.round(this._calculator.scale(val,this._extent)),this.getRawOrdinalNumber(val)},OrdinalScale$1.prototype.getTicks=function(){for(var ticks=[],extent=this._extent,rank$1=extent[0];rank$1<=extent[1];)ticks.push({value:rank$1}),rank$1++;return ticks},OrdinalScale$1.prototype.getMinorTicks=function(splitNumber){},OrdinalScale$1.prototype.setSortInfo=function(info){if(info==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var infoOrdinalNumbers=info.ordinalNumbers,ordinalsByTick=this._ordinalNumbersByTick=[],ticksByOrdinal=this._ticksByOrdinalNumber=[],tickNum=0,allCategoryLen=this._ordinalMeta.categories.length,len$1=Math.min(allCategoryLen,infoOrdinalNumbers.length);tickNum<len$1;++tickNum){var ordinalNumber=infoOrdinalNumbers[tickNum];ordinalsByTick[tickNum]=ordinalNumber,ticksByOrdinal[ordinalNumber]=tickNum}for(var unusedOrdinal=0;tickNum<allCategoryLen;++tickNum){for(;ticksByOrdinal[unusedOrdinal]!=null;)unusedOrdinal++;ordinalsByTick.push(unusedOrdinal),ticksByOrdinal[unusedOrdinal]=tickNum}},OrdinalScale$1.prototype._getTickNumber=function(ordinal){var ticksByOrdinalNumber=this._ticksByOrdinalNumber;return ticksByOrdinalNumber&&ordinal>=0&&ordinal<ticksByOrdinalNumber.length?ticksByOrdinalNumber[ordinal]:ordinal},OrdinalScale$1.prototype.getRawOrdinalNumber=function(tickNumber){var ordinalNumbersByTick=this._ordinalNumbersByTick;return ordinalNumbersByTick&&tickNumber>=0&&tickNumber<ordinalNumbersByTick.length?ordinalNumbersByTick[tickNumber]:tickNumber},OrdinalScale$1.prototype.getLabel=function(tick){if(!this.isBlank()){var ordinalNumber=this.getRawOrdinalNumber(tick.value),cateogry=this._ordinalMeta.categories[ordinalNumber];return cateogry==null?``:cateogry+``}},OrdinalScale$1.prototype.count=function(){return this._extent[1]-this._extent[0]+1},OrdinalScale$1.prototype.isInExtentRange=function(value){return value=this._getTickNumber(value),this._extent[0]<=value&&this._extent[1]>=value},OrdinalScale$1.prototype.getOrdinalMeta=function(){return this._ordinalMeta},OrdinalScale$1.prototype.calcNiceTicks=function(){},OrdinalScale$1.prototype.calcNiceExtent=function(){},OrdinalScale$1.type=`ordinal`,OrdinalScale$1}(Scale_default);Scale_default.registerClass(OrdinalScale);var Ordinal_default=OrdinalScale,roundNumber=round,IntervalScale=function(_super){__extends(IntervalScale$1,_super);function IntervalScale$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`interval`,_this._interval=0,_this._intervalPrecision=2,_this}return IntervalScale$1.prototype.parse=function(val){return val==null||val===``?NaN:Number(val)},IntervalScale$1.prototype.contain=function(val){return contain(val,this._extent)},IntervalScale$1.prototype.normalize=function(val){return this._calculator.normalize(val,this._extent)},IntervalScale$1.prototype.scale=function(val){return this._calculator.scale(val,this._extent)},IntervalScale$1.prototype.getInterval=function(){return this._interval},IntervalScale$1.prototype.setInterval=function(interval){this._interval=interval,this._niceExtent=this._extent.slice(),this._intervalPrecision=getIntervalPrecision(interval)},IntervalScale$1.prototype.getTicks=function(opt){opt||={};var interval=this._interval,extent=this._extent,niceTickExtent=this._niceExtent,intervalPrecision=this._intervalPrecision,scaleBreakHelper=getScaleBreakHelper(),ticks=[];if(!interval)return ticks;if(opt.breakTicks===`only_break`&&scaleBreakHelper)return scaleBreakHelper.addBreaksToTicks(ticks,this._brkCtx.breaks,this._extent),ticks;var safeLimit=1e4;extent[0]<niceTickExtent[0]&&(opt.expandToNicedExtent?ticks.push({value:roundNumber(niceTickExtent[0]-interval,intervalPrecision)}):ticks.push({value:extent[0]}));for(var estimateNiceMultiple=function(tickVal,targetTick){return Math.round((targetTick-tickVal)/interval)},tick=niceTickExtent[0];tick<=niceTickExtent[1];){if(ticks.push({value:tick}),tick=roundNumber(tick+interval,intervalPrecision),this._brkCtx){var moreMultiple=this._brkCtx.calcNiceTickMultiple(tick,estimateNiceMultiple);moreMultiple>=0&&(tick=roundNumber(tick+moreMultiple*interval,intervalPrecision))}if(ticks.length>0&&tick===ticks[ticks.length-1].value)break;if(ticks.length>safeLimit)return[]}var lastNiceTick=ticks.length?ticks[ticks.length-1].value:niceTickExtent[1];return extent[1]>lastNiceTick&&(opt.expandToNicedExtent?ticks.push({value:roundNumber(lastNiceTick+interval,intervalPrecision)}):ticks.push({value:extent[1]})),scaleBreakHelper&&scaleBreakHelper.pruneTicksByBreak(opt.pruneByBreak,ticks,this._brkCtx.breaks,function(item){return item.value},this._interval,this._extent),opt.breakTicks!==`none`&&scaleBreakHelper&&scaleBreakHelper.addBreaksToTicks(ticks,this._brkCtx.breaks,this._extent),ticks},IntervalScale$1.prototype.getMinorTicks=function(splitNumber){for(var ticks=this.getTicks({expandToNicedExtent:!0}),minorTicks=[],extent=this.getExtent(),i$1=1;i$1<ticks.length;i$1++){var nextTick$1=ticks[i$1],prevTick=ticks[i$1-1];if(!(prevTick.break||nextTick$1.break)){for(var count$1=0,minorTicksGroup=[],minorInterval=(nextTick$1.value-prevTick.value)/splitNumber,minorIntervalPrecision=getIntervalPrecision(minorInterval);count$1<splitNumber-1;){var minorTick=roundNumber(prevTick.value+(count$1+1)*minorInterval,minorIntervalPrecision);minorTick>extent[0]&&minorTick<extent[1]&&minorTicksGroup.push(minorTick),count$1++}var scaleBreakHelper=getScaleBreakHelper();scaleBreakHelper&&scaleBreakHelper.pruneTicksByBreak(`auto`,minorTicksGroup,this._getNonTransBreaks(),function(value){return value},this._interval,extent),minorTicks.push(minorTicksGroup)}}return minorTicks},IntervalScale$1.prototype._getNonTransBreaks=function(){return this._brkCtx?this._brkCtx.breaks:[]},IntervalScale$1.prototype.getLabel=function(data,opt){if(data==null)return``;var precision=opt&&opt.precision;precision==null?precision=getPrecision(data.value)||0:precision===`auto`&&(precision=this._intervalPrecision);var dataNum=roundNumber(data.value,precision,!0);return addCommas(dataNum)},IntervalScale$1.prototype.calcNiceTicks=function(splitNumber,minInterval,maxInterval){splitNumber||=5;var extent=this._extent.slice(),span=this._getExtentSpanWithBreaks();if(isFinite(span)){span<0&&(span=-span,extent.reverse(),this._innerSetExtent(extent[0],extent[1]),extent=this._extent.slice());var result=intervalScaleNiceTicks(extent,span,splitNumber,minInterval,maxInterval);this._intervalPrecision=result.intervalPrecision,this._interval=result.interval,this._niceExtent=result.niceTickExtent}},IntervalScale$1.prototype.calcNiceExtent=function(opt){var extent=this._extent.slice();if(extent[0]===extent[1])if(extent[0]!==0){var expandSize=Math.abs(extent[0]);opt.fixMax||(extent[1]+=expandSize/2),extent[0]-=expandSize/2}else extent[1]=1;var span=extent[1]-extent[0];isFinite(span)||(extent[0]=0,extent[1]=1),this._innerSetExtent(extent[0],extent[1]),extent=this._extent.slice(),this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval);var interval=this._interval,intervalPrecition=this._intervalPrecision;opt.fixMin||(extent[0]=roundNumber(Math.floor(extent[0]/interval)*interval,intervalPrecition)),opt.fixMax||(extent[1]=roundNumber(Math.ceil(extent[1]/interval)*interval,intervalPrecition)),this._innerSetExtent(extent[0],extent[1])},IntervalScale$1.prototype.setNiceExtent=function(min$2,max$2){this._niceExtent=[min$2,max$2]},IntervalScale$1.type=`interval`,IntervalScale$1}(Scale_default);Scale_default.registerClass(IntervalScale);var Interval_default=IntervalScale,supportFloat32Array=typeof Float32Array<`u`,Float32ArrayCtor=supportFloat32Array?Float32Array:Array;function createFloat32Array(arg){return isArray(arg)?supportFloat32Array?new Float32Array(arg):arg:new Float32ArrayCtor(arg)}var STACK_PREFIX=`__ec_stack_`;function getSeriesStackId(seriesModel){return seriesModel.get(`stack`)||STACK_PREFIX+seriesModel.seriesIndex}function getAxisKey(axis){return axis.dim+axis.index}function prepareLayoutBarSeries(seriesType$1,ecModel){var seriesModels=[];return ecModel.eachSeriesByType(seriesType$1,function(seriesModel){isOnCartesian(seriesModel)&&seriesModels.push(seriesModel)}),seriesModels}function getValueAxesMinGaps(barSeries){var axisValues={};each(barSeries,function(seriesModel){var baseAxis=seriesModel.coordinateSystem.getBaseAxis();if(!(baseAxis.type!==`time`&&baseAxis.type!==`value`))for(var data=seriesModel.getData(),key$2=baseAxis.dim+`_`+baseAxis.index,dimIdx=data.getDimensionIndex(data.mapDimension(baseAxis.dim)),store=data.getStore(),i$1=0,cnt=store.count();i$1<cnt;++i$1){var value=store.get(dimIdx,i$1);axisValues[key$2]?axisValues[key$2].push(value):axisValues[key$2]=[value]}});var axisMinGaps={};for(var key$1 in axisValues)if(axisValues.hasOwnProperty(key$1)){var valuesInAxis=axisValues[key$1];if(valuesInAxis){valuesInAxis.sort(function(a$1,b$1){return a$1-b$1});for(var min$2=null,j$1=1;j$1<valuesInAxis.length;++j$1){var delta=valuesInAxis[j$1]-valuesInAxis[j$1-1];delta>0&&(min$2=min$2===null?delta:Math.min(min$2,delta))}axisMinGaps[key$1]=min$2}}return axisMinGaps}function makeColumnLayout(barSeries){var axisMinGaps=getValueAxesMinGaps(barSeries),seriesInfoList=[];return each(barSeries,function(seriesModel){var baseAxis=seriesModel.coordinateSystem.getBaseAxis(),axisExtent=baseAxis.getExtent(),bandWidth;if(baseAxis.type===`category`)bandWidth=baseAxis.getBandWidth();else if(baseAxis.type===`value`||baseAxis.type===`time`){var key$1=baseAxis.dim+`_`+baseAxis.index,minGap=axisMinGaps[key$1],extentSpan=Math.abs(axisExtent[1]-axisExtent[0]),scale$3=baseAxis.scale.getExtent(),scaleSpan=Math.abs(scale$3[1]-scale$3[0]);bandWidth=minGap?extentSpan/scaleSpan*minGap:extentSpan}else{var data=seriesModel.getData();bandWidth=Math.abs(axisExtent[1]-axisExtent[0])/data.count()}var barWidth=parsePercent(seriesModel.get(`barWidth`),bandWidth),barMaxWidth=parsePercent(seriesModel.get(`barMaxWidth`),bandWidth),barMinWidth=parsePercent(seriesModel.get(`barMinWidth`)||(isInLargeMode(seriesModel)?.5:1),bandWidth),barGap=seriesModel.get(`barGap`),barCategoryGap=seriesModel.get(`barCategoryGap`),defaultBarGap=seriesModel.get(`defaultBarGap`);seriesInfoList.push({bandWidth,barWidth,barMaxWidth,barMinWidth,barGap,barCategoryGap,defaultBarGap,axisKey:getAxisKey(baseAxis),stackId:getSeriesStackId(seriesModel)})}),doCalBarWidthAndOffset(seriesInfoList)}function doCalBarWidthAndOffset(seriesInfoList){var columnsMap={};each(seriesInfoList,function(seriesInfo,idx){var axisKey=seriesInfo.axisKey,bandWidth=seriesInfo.bandWidth,columnsOnAxis=columnsMap[axisKey]||{bandWidth,remainedWidth:bandWidth,autoWidthCount:0,categoryGap:null,gap:seriesInfo.defaultBarGap||0,stacks:{}},stacks=columnsOnAxis.stacks;columnsMap[axisKey]=columnsOnAxis;var stackId=seriesInfo.stackId;stacks[stackId]||columnsOnAxis.autoWidthCount++,stacks[stackId]=stacks[stackId]||{width:0,maxWidth:0};var barWidth=seriesInfo.barWidth;barWidth&&!stacks[stackId].width&&(stacks[stackId].width=barWidth,barWidth=Math.min(columnsOnAxis.remainedWidth,barWidth),columnsOnAxis.remainedWidth-=barWidth);var barMaxWidth=seriesInfo.barMaxWidth;barMaxWidth&&(stacks[stackId].maxWidth=barMaxWidth);var barMinWidth=seriesInfo.barMinWidth;barMinWidth&&(stacks[stackId].minWidth=barMinWidth);var barGap=seriesInfo.barGap;barGap!=null&&(columnsOnAxis.gap=barGap);var barCategoryGap=seriesInfo.barCategoryGap;barCategoryGap!=null&&(columnsOnAxis.categoryGap=barCategoryGap)});var result={};return each(columnsMap,function(columnsOnAxis,coordSysName){result[coordSysName]={};var stacks=columnsOnAxis.stacks,bandWidth=columnsOnAxis.bandWidth,categoryGapPercent=columnsOnAxis.categoryGap;if(categoryGapPercent==null){var columnCount=keys(stacks).length;categoryGapPercent=Math.max(35-columnCount*4,15)+`%`}var categoryGap=parsePercent(categoryGapPercent,bandWidth),barGapPercent=parsePercent(columnsOnAxis.gap,1),remainedWidth=columnsOnAxis.remainedWidth,autoWidthCount=columnsOnAxis.autoWidthCount,autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent);autoWidth=Math.max(autoWidth,0),each(stacks,function(column){var maxWidth=column.maxWidth,minWidth=column.minWidth;if(column.width){var finalWidth=column.width;maxWidth&&(finalWidth=Math.min(finalWidth,maxWidth)),minWidth&&(finalWidth=Math.max(finalWidth,minWidth)),column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--}else{var finalWidth=autoWidth;maxWidth&&maxWidth<finalWidth&&(finalWidth=Math.min(maxWidth,remainedWidth)),minWidth&&minWidth>finalWidth&&(finalWidth=minWidth),finalWidth!==autoWidth&&(column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--)}}),autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent),autoWidth=Math.max(autoWidth,0);var widthSum=0,lastColumn;each(stacks,function(column,idx){column.width||=autoWidth,lastColumn=column,widthSum+=column.width*(1+barGapPercent)}),lastColumn&&(widthSum-=lastColumn.width*barGapPercent);var offset=-widthSum/2;each(stacks,function(column,stackId){result[coordSysName][stackId]=result[coordSysName][stackId]||{bandWidth,offset,width:column.width},offset+=column.width*(1+barGapPercent)})}),result}function retrieveColumnLayout(barWidthAndOffset,axis,seriesModel){if(barWidthAndOffset&&axis){var result=barWidthAndOffset[getAxisKey(axis)];return result!=null&&seriesModel!=null?result[getSeriesStackId(seriesModel)]:result}}function layout$1(seriesType$1,ecModel){var seriesModels=prepareLayoutBarSeries(seriesType$1,ecModel),barWidthAndOffset=makeColumnLayout(seriesModels);each(seriesModels,function(seriesModel){var data=seriesModel.getData(),baseAxis=seriesModel.coordinateSystem.getBaseAxis(),stackId=getSeriesStackId(seriesModel),columnLayoutInfo=barWidthAndOffset[getAxisKey(baseAxis)][stackId],columnOffset=columnLayoutInfo.offset,columnWidth=columnLayoutInfo.width;data.setLayout({bandWidth:columnLayoutInfo.bandWidth,offset:columnOffset,size:columnWidth})})}function createProgressiveLayout(seriesType$1){return{seriesType:seriesType$1,plan:createRenderPlanner(),reset:function(seriesModel){if(isOnCartesian(seriesModel)){var data=seriesModel.getData(),cartesian=seriesModel.coordinateSystem,baseAxis=cartesian.getBaseAxis(),valueAxis$1=cartesian.getOtherAxis(baseAxis),valueDimIdx=data.getDimensionIndex(data.mapDimension(valueAxis$1.dim)),baseDimIdx=data.getDimensionIndex(data.mapDimension(baseAxis.dim)),drawBackground=seriesModel.get(`showBackground`,!0),valueDim=data.mapDimension(valueAxis$1.dim),stackResultDim=data.getCalculationInfo(`stackResultDimension`),stacked=isDimensionStacked(data,valueDim)&&!!data.getCalculationInfo(`stackedOnSeries`),isValueAxisH=valueAxis$1.isHorizontal(),valueAxisStart=getValueAxisStart(baseAxis,valueAxis$1),isLarge=isInLargeMode(seriesModel),barMinHeight=seriesModel.get(`barMinHeight`)||0,stackedDimIdx=stackResultDim&&data.getDimensionIndex(stackResultDim),columnWidth=data.getLayout(`size`),columnOffset=data.getLayout(`offset`);return{progress:function(params,data$1){for(var count$1=params.count,largePoints=isLarge&&createFloat32Array(count$1*3),largeBackgroundPoints=isLarge&&drawBackground&&createFloat32Array(count$1*3),largeDataIndices=isLarge&&createFloat32Array(count$1),coordLayout=cartesian.master.getRect(),bgSize=isValueAxisH?coordLayout.width:coordLayout.height,dataIndex,store=data$1.getStore(),idxOffset=0;(dataIndex=params.next())!=null;){var value=store.get(stacked?stackedDimIdx:valueDimIdx,dataIndex),baseValue=store.get(baseDimIdx,dataIndex),baseCoord=valueAxisStart,stackStartValue=void 0;stacked&&(stackStartValue=+value-store.get(valueDimIdx,dataIndex));var x$1=void 0,y$1=void 0,width=void 0,height=void 0;if(isValueAxisH){var coord=cartesian.dataToPoint([value,baseValue]);if(stacked){var startCoord=cartesian.dataToPoint([stackStartValue,baseValue]);baseCoord=startCoord[0]}x$1=baseCoord,y$1=coord[1]+columnOffset,width=coord[0]-baseCoord,height=columnWidth,Math.abs(width)<barMinHeight&&(width=(width<0?-1:1)*barMinHeight)}else{var coord=cartesian.dataToPoint([baseValue,value]);if(stacked){var startCoord=cartesian.dataToPoint([baseValue,stackStartValue]);baseCoord=startCoord[1]}x$1=coord[0]+columnOffset,y$1=baseCoord,width=columnWidth,height=coord[1]-baseCoord,Math.abs(height)<barMinHeight&&(height=(height<=0?-1:1)*barMinHeight)}isLarge?(largePoints[idxOffset]=x$1,largePoints[idxOffset+1]=y$1,largePoints[idxOffset+2]=isValueAxisH?width:height,largeBackgroundPoints&&(largeBackgroundPoints[idxOffset]=isValueAxisH?coordLayout.x:x$1,largeBackgroundPoints[idxOffset+1]=isValueAxisH?y$1:coordLayout.y,largeBackgroundPoints[idxOffset+2]=bgSize),largeDataIndices[dataIndex]=dataIndex):data$1.setItemLayout(dataIndex,{x:x$1,y:y$1,width,height}),idxOffset+=3}isLarge&&data$1.setLayout({largePoints,largeDataIndices,largeBackgroundPoints,valueAxisHorizontal:isValueAxisH})}}}}}}function isOnCartesian(seriesModel){return seriesModel.coordinateSystem&&seriesModel.coordinateSystem.type===`cartesian2d`}function isInLargeMode(seriesModel){return seriesModel.pipelineContext&&seriesModel.pipelineContext.large}function getValueAxisStart(baseAxis,valueAxis$1){var startValue=valueAxis$1.model.get(`startValue`);return startValue||=0,valueAxis$1.toGlobalCoord(valueAxis$1.dataToCoord(valueAxis$1.type===`log`?startValue>0?startValue:1:startValue))}var bisect=function(a$1,x$1,lo,hi){for(;lo<hi;){var mid=lo+hi>>>1;a$1[mid][1]<x$1?lo=mid+1:hi=mid}return lo},TimeScale=function(_super){__extends(TimeScale$1,_super);function TimeScale$1(settings){var _this=_super.call(this,settings)||this;return _this.type=`time`,_this}return TimeScale$1.prototype.getLabel=function(tick){var useUTC=this.getSetting(`useUTC`);return format(tick.value,fullLeveledFormatter[getDefaultFormatPrecisionOfInterval(getPrimaryTimeUnit(this._minLevelUnit))]||fullLeveledFormatter.second,useUTC,this.getSetting(`locale`))},TimeScale$1.prototype.getFormattedLabel=function(tick,idx,labelFormatter){var isUTC=this.getSetting(`useUTC`),lang=this.getSetting(`locale`);return leveledFormat(tick,idx,labelFormatter,lang,isUTC)},TimeScale$1.prototype.getTicks=function(opt){opt||={};var interval=this._interval,extent=this._extent,scaleBreakHelper=getScaleBreakHelper(),ticks=[];if(!interval)return ticks;var useUTC=this.getSetting(`useUTC`);if(scaleBreakHelper&&opt.breakTicks===`only_break`)return getScaleBreakHelper().addBreaksToTicks(ticks,this._brkCtx.breaks,this._extent),ticks;var extent0Unit=getUnitFromValue(extent[1],useUTC);ticks.push({value:extent[0],time:{level:0,upperTimeUnit:extent0Unit,lowerTimeUnit:extent0Unit}});var innerTicks=getIntervalTicks(this._minLevelUnit,this._approxInterval,useUTC,extent,this._getExtentSpanWithBreaks(),this._brkCtx);ticks=ticks.concat(innerTicks);var extent1Unit=getUnitFromValue(extent[1],useUTC);ticks.push({value:extent[1],time:{level:0,upperTimeUnit:extent1Unit,lowerTimeUnit:extent1Unit}});var isUTC=this.getSetting(`useUTC`),upperUnitIndex=primaryTimeUnits.length-1,maxLevel=0;return each(ticks,function(tick){upperUnitIndex=Math.min(upperUnitIndex,indexOf(primaryTimeUnits,tick.time.upperTimeUnit)),maxLevel=Math.max(maxLevel,tick.time.level)}),scaleBreakHelper&&getScaleBreakHelper().pruneTicksByBreak(opt.pruneByBreak,ticks,this._brkCtx.breaks,function(item){return item.value},this._approxInterval,this._extent),scaleBreakHelper&&opt.breakTicks!==`none`&&getScaleBreakHelper().addBreaksToTicks(ticks,this._brkCtx.breaks,this._extent,function(trimmedBrk){for(var lowerBrkUnitIndex=Math.max(indexOf(primaryTimeUnits,getUnitFromValue(trimmedBrk.vmin,isUTC)),indexOf(primaryTimeUnits,getUnitFromValue(trimmedBrk.vmax,isUTC))),upperBrkUnitIndex=0,unitIdx=0;unitIdx<primaryTimeUnits.length;unitIdx++)if(!isPrimaryUnitValueAndGreaterSame(primaryTimeUnits[unitIdx],trimmedBrk.vmin,trimmedBrk.vmax,isUTC)){upperBrkUnitIndex=unitIdx;break}var upperIdx=Math.min(upperBrkUnitIndex,upperUnitIndex);return{level:maxLevel,lowerTimeUnit:primaryTimeUnits[Math.max(upperIdx,lowerBrkUnitIndex)],upperTimeUnit:primaryTimeUnits[upperIdx]}}),ticks},TimeScale$1.prototype.calcNiceExtent=function(opt){var extent=this.getExtent();if(extent[0]===extent[1]&&(extent[0]-=ONE_DAY,extent[1]+=ONE_DAY),extent[1]===-1/0&&extent[0]===1/0){var d$1=new Date;extent[1]=+new Date(d$1.getFullYear(),d$1.getMonth(),d$1.getDate()),extent[0]=extent[1]-ONE_DAY}this._innerSetExtent(extent[0],extent[1]),this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval)},TimeScale$1.prototype.calcNiceTicks=function(approxTickNum,minInterval,maxInterval){approxTickNum||=10,this._approxInterval=this._getExtentSpanWithBreaks()/approxTickNum,minInterval!=null&&this._approxInterval<minInterval&&(this._approxInterval=minInterval),maxInterval!=null&&this._approxInterval>maxInterval&&(this._approxInterval=maxInterval);var scaleIntervalsLen=scaleIntervals.length,idx=Math.min(bisect(scaleIntervals,this._approxInterval,0,scaleIntervalsLen),scaleIntervalsLen-1);this._interval=scaleIntervals[idx][1],this._intervalPrecision=getIntervalPrecision(this._interval),this._minLevelUnit=scaleIntervals[Math.max(idx-1,0)][0]},TimeScale$1.prototype.parse=function(val){return isNumber(val)?val:+parseDate(val)},TimeScale$1.prototype.contain=function(val){return contain(val,this._extent)},TimeScale$1.prototype.normalize=function(val){return this._calculator.normalize(val,this._extent)},TimeScale$1.prototype.scale=function(val){return this._calculator.scale(val,this._extent)},TimeScale$1.type=`time`,TimeScale$1}(Interval_default),scaleIntervals=[[`second`,ONE_SECOND],[`minute`,ONE_MINUTE],[`hour`,ONE_HOUR],[`quarter-day`,ONE_HOUR*6],[`half-day`,ONE_HOUR*12],[`day`,ONE_DAY*1.2],[`half-week`,ONE_DAY*3.5],[`week`,ONE_DAY*7],[`month`,ONE_DAY*31],[`quarter`,ONE_DAY*95],[`half-year`,ONE_YEAR/2],[`year`,ONE_YEAR]];function isPrimaryUnitValueAndGreaterSame(unit,valueA,valueB,isUTC){return roundTime(new Date(valueA),unit,isUTC).getTime()===roundTime(new Date(valueB),unit,isUTC).getTime()}function getDateInterval(approxInterval,daysInMonth){return approxInterval/=ONE_DAY,approxInterval>16?16:approxInterval>7.5?7:approxInterval>3.5?4:approxInterval>1.5?2:1}function getMonthInterval(approxInterval){var APPROX_ONE_MONTH=30*ONE_DAY;return approxInterval/=APPROX_ONE_MONTH,approxInterval>6?6:approxInterval>3?3:approxInterval>2?2:1}function getHourInterval(approxInterval){return approxInterval/=ONE_HOUR,approxInterval>12?12:approxInterval>6?6:approxInterval>3.5?4:approxInterval>2?2:1}function getMinutesAndSecondsInterval(approxInterval,isMinutes){return approxInterval/=isMinutes?ONE_MINUTE:ONE_SECOND,approxInterval>30?30:approxInterval>20?20:approxInterval>15?15:approxInterval>10?10:approxInterval>5?5:approxInterval>2?2:1}function getMillisecondsInterval(approxInterval){return nice(approxInterval,!0)}function getFirstTimestampOfUnit(timestamp,unitName,isUTC){var upperUnitIdx=Math.max(0,indexOf(primaryTimeUnits,unitName)-1);return roundTime(new Date(timestamp),primaryTimeUnits[upperUnitIdx],isUTC).getTime()}function createEstimateNiceMultiple(setMethodName,dateMethodInterval){var tmpDate=new Date(0);tmpDate[setMethodName](1);var tmpTime=tmpDate.getTime();tmpDate[setMethodName](1+dateMethodInterval);var approxTimeInterval=tmpDate.getTime()-tmpTime;return function(tickVal,targetValue){return Math.max(0,Math.round((targetValue-tickVal)/approxTimeInterval))}}function getIntervalTicks(bottomUnitName,approxInterval,isUTC,extent,extentSpanWithBreaks,brkCtx){var safeLimit=1e4,unitNames=timeUnits,iter=0;function addTicksInSpan(interval,minTimestamp,maxTimestamp,getMethodName,setMethodName,isDate$1,out$2){for(var estimateNiceMultiple=createEstimateNiceMultiple(setMethodName,interval),dateTime=minTimestamp,date=new Date(dateTime);dateTime<maxTimestamp&&dateTime<=extent[1]&&(out$2.push({value:dateTime}),!(iter++>safeLimit));)if(date[setMethodName](date[getMethodName]()+interval),dateTime=date.getTime(),brkCtx){var moreMultiple=brkCtx.calcNiceTickMultiple(dateTime,estimateNiceMultiple);moreMultiple>0&&(date[setMethodName](date[getMethodName]()+moreMultiple*interval),dateTime=date.getTime())}out$2.push({value:dateTime,notAdd:!0})}function addLevelTicks(unitName,lastLevelTicks,levelTicks$1){var newAddedTicks=[],isFirstLevel=!lastLevelTicks.length;if(!isPrimaryUnitValueAndGreaterSame(getPrimaryTimeUnit(unitName),extent[0],extent[1],isUTC)){isFirstLevel&&(lastLevelTicks=[{value:getFirstTimestampOfUnit(extent[0],unitName,isUTC)},{value:extent[1]}]);for(var i$2=0;i$2<lastLevelTicks.length-1;i$2++){var startTick=lastLevelTicks[i$2].value,endTick=lastLevelTicks[i$2+1].value;if(startTick!==endTick){var interval=void 0,getterName=void 0,setterName=void 0,isDate$1=!1;switch(unitName){case`year`:interval=Math.max(1,Math.round(approxInterval/ONE_DAY/365)),getterName=fullYearGetterName(isUTC),setterName=fullYearSetterName(isUTC);break;case`half-year`:case`quarter`:case`month`:interval=getMonthInterval(approxInterval),getterName=monthGetterName(isUTC),setterName=monthSetterName(isUTC);break;case`week`:case`half-week`:case`day`:interval=getDateInterval(approxInterval,31),getterName=dateGetterName(isUTC),setterName=dateSetterName(isUTC),isDate$1=!0;break;case`half-day`:case`quarter-day`:case`hour`:interval=getHourInterval(approxInterval),getterName=hoursGetterName(isUTC),setterName=hoursSetterName(isUTC);break;case`minute`:interval=getMinutesAndSecondsInterval(approxInterval,!0),getterName=minutesGetterName(isUTC),setterName=minutesSetterName(isUTC);break;case`second`:interval=getMinutesAndSecondsInterval(approxInterval,!1),getterName=secondsGetterName(isUTC),setterName=secondsSetterName(isUTC);break;case`millisecond`:interval=getMillisecondsInterval(approxInterval),getterName=millisecondsGetterName(isUTC),setterName=millisecondsSetterName(isUTC);break}endTick>=extent[0]&&startTick<=extent[1]&&addTicksInSpan(interval,startTick,endTick,getterName,setterName,isDate$1,newAddedTicks),unitName===`year`&&levelTicks$1.length>1&&i$2===0&&levelTicks$1.unshift({value:levelTicks$1[0].value-interval})}}for(var i$2=0;i$2<newAddedTicks.length;i$2++)levelTicks$1.push(newAddedTicks[i$2])}}for(var levelsTicks=[],currentLevelTicks=[],tickCount=0,lastLevelTickCount=0,i$1=0;i$1<unitNames.length;++i$1){var primaryTimeUnit=getPrimaryTimeUnit(unitNames[i$1]);if(isPrimaryTimeUnit(unitNames[i$1])){addLevelTicks(unitNames[i$1],levelsTicks[levelsTicks.length-1]||[],currentLevelTicks);var nextPrimaryTimeUnit=unitNames[i$1+1]?getPrimaryTimeUnit(unitNames[i$1+1]):null;if(primaryTimeUnit!==nextPrimaryTimeUnit){if(currentLevelTicks.length){lastLevelTickCount=tickCount,currentLevelTicks.sort(function(a$1,b$1){return a$1.value-b$1.value});for(var levelTicksRemoveDuplicated=[],i_1=0;i_1<currentLevelTicks.length;++i_1){var tickValue=currentLevelTicks[i_1].value;(i_1===0||currentLevelTicks[i_1-1].value!==tickValue)&&(levelTicksRemoveDuplicated.push(currentLevelTicks[i_1]),tickValue>=extent[0]&&tickValue<=extent[1]&&tickCount++)}var targetTickNum=extentSpanWithBreaks/approxInterval;if(tickCount>targetTickNum*1.5&&lastLevelTickCount>targetTickNum/1.5||(levelsTicks.push(levelTicksRemoveDuplicated),tickCount>targetTickNum||bottomUnitName===unitNames[i$1]))break}currentLevelTicks=[]}}}for(var levelsTicksInExtent=filter(map(levelsTicks,function(levelTicks$1){return filter(levelTicks$1,function(tick){return tick.value>=extent[0]&&tick.value<=extent[1]&&!tick.notAdd})}),function(levelTicks$1){return levelTicks$1.length>0}),ticks=[],maxLevel=levelsTicksInExtent.length-1,i$1=0;i$1<levelsTicksInExtent.length;++i$1)for(var levelTicks=levelsTicksInExtent[i$1],k$1=0;k$1<levelTicks.length;++k$1){var unit=getUnitFromValue(levelTicks[k$1].value,isUTC);ticks.push({value:levelTicks[k$1].value,time:{level:maxLevel-i$1,upperTimeUnit:unit,lowerTimeUnit:unit}})}ticks.sort(function(a$1,b$1){return a$1.value-b$1.value});for(var result=[],i$1=0;i$1<ticks.length;++i$1)(i$1===0||ticks[i$1].value!==ticks[i$1-1].value)&&result.push(ticks[i$1]);return result}Scale_default.registerClass(TimeScale);var Time_default=TimeScale,fixRound=round,mathFloor=Math.floor,mathCeil=Math.ceil,mathPow=Math.pow,mathLog=Math.log,LogScale=function(_super){__extends(LogScale$1,_super);function LogScale$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`log`,_this.base=10,_this._originalScale=new Interval_default,_this}return LogScale$1.prototype.getTicks=function(opt){opt||={};var extent=this._extent.slice(),originalExtent=this._originalScale.getExtent(),ticks=_super.prototype.getTicks.call(this,opt),base$1=this.base,originalBreaks=this._originalScale._innerGetBreaks(),scaleBreakHelper=getScaleBreakHelper();return map(ticks,function(tick){var val=tick.value,roundingCriterion=null,powVal=mathPow(base$1,val);val===extent[0]&&this._fixMin?roundingCriterion=originalExtent[0]:val===extent[1]&&this._fixMax&&(roundingCriterion=originalExtent[1]);var vBreak;if(scaleBreakHelper){var transformed=scaleBreakHelper.getTicksLogTransformBreak(tick,base$1,originalBreaks,fixRoundingError);vBreak=transformed.vBreak,roundingCriterion??=transformed.brkRoundingCriterion}return roundingCriterion!=null&&(powVal=fixRoundingError(powVal,roundingCriterion)),{value:powVal,break:vBreak}},this)},LogScale$1.prototype._getNonTransBreaks=function(){return this._originalScale._innerGetBreaks()},LogScale$1.prototype.setExtent=function(start$1,end$1){this._originalScale.setExtent(start$1,end$1);var loggedExtent=logTransform(this.base,[start$1,end$1]);_super.prototype.setExtent.call(this,loggedExtent[0],loggedExtent[1])},LogScale$1.prototype.getExtent=function(){var base$1=this.base,extent=_super.prototype.getExtent.call(this);extent[0]=mathPow(base$1,extent[0]),extent[1]=mathPow(base$1,extent[1]);var originalExtent=this._originalScale.getExtent();return this._fixMin&&(extent[0]=fixRoundingError(extent[0],originalExtent[0])),this._fixMax&&(extent[1]=fixRoundingError(extent[1],originalExtent[1])),extent},LogScale$1.prototype.unionExtentFromData=function(data,dim){this._originalScale.unionExtentFromData(data,dim);var loggedOther=logTransform(this.base,data.getApproximateExtent(dim),!0);this._innerUnionExtent(loggedOther)},LogScale$1.prototype.calcNiceTicks=function(approxTickNum){approxTickNum||=10;var extent=this._extent.slice(),span=this._getExtentSpanWithBreaks();if(!(!isFinite(span)||span<=0)){var interval=quantity(span);for(approxTickNum/span*interval<=.5&&(interval*=10);!isNaN(interval)&&Math.abs(interval)<1&&Math.abs(interval)>0;)interval*=10;var niceExtent=[fixRound(mathCeil(extent[0]/interval)*interval),fixRound(mathFloor(extent[1]/interval)*interval)];this._interval=interval,this._intervalPrecision=getIntervalPrecision(interval),this._niceExtent=niceExtent}},LogScale$1.prototype.calcNiceExtent=function(opt){_super.prototype.calcNiceExtent.call(this,opt),this._fixMin=opt.fixMin,this._fixMax=opt.fixMax},LogScale$1.prototype.contain=function(val){return val=mathLog(val)/mathLog(this.base),_super.prototype.contain.call(this,val)},LogScale$1.prototype.normalize=function(val){return val=mathLog(val)/mathLog(this.base),_super.prototype.normalize.call(this,val)},LogScale$1.prototype.scale=function(val){return val=_super.prototype.scale.call(this,val),mathPow(this.base,val)},LogScale$1.prototype.setBreaksFromOption=function(breakOptionList){var scaleBreakHelper=getScaleBreakHelper();if(scaleBreakHelper){var _a$1=scaleBreakHelper.logarithmicParseBreaksFromOption(breakOptionList,this.base,bind(this.parse,this)),parsedOriginal=_a$1.parsedOriginal,parsedLogged=_a$1.parsedLogged;this._originalScale._innerSetBreak(parsedOriginal),this._innerSetBreak(parsedLogged)}},LogScale$1.type=`log`,LogScale$1}(Interval_default);function fixRoundingError(val,originalVal){return fixRound(val,getPrecision(originalVal))}Scale_default.registerClass(LogScale);var Log_default=LogScale,ScaleRawExtentInfo=function(){function ScaleRawExtentInfo$1(scale$3,model,originalExtent){this._prepareParams(scale$3,model,originalExtent)}return ScaleRawExtentInfo$1.prototype._prepareParams=function(scale$3,model,dataExtent){dataExtent[1]<dataExtent[0]&&(dataExtent=[NaN,NaN]),this._dataMin=dataExtent[0],this._dataMax=dataExtent[1];var isOrdinal=this._isOrdinal=scale$3.type===`ordinal`;this._needCrossZero=scale$3.type===`interval`&&model.getNeedCrossZero&&model.getNeedCrossZero();var axisMinValue=model.get(`min`,!0);axisMinValue??=model.get(`startValue`,!0);var modelMinRaw=this._modelMinRaw=axisMinValue;isFunction(modelMinRaw)?this._modelMinNum=parseAxisModelMinMax(scale$3,modelMinRaw({min:dataExtent[0],max:dataExtent[1]})):modelMinRaw!==`dataMin`&&(this._modelMinNum=parseAxisModelMinMax(scale$3,modelMinRaw));var modelMaxRaw=this._modelMaxRaw=model.get(`max`,!0);if(isFunction(modelMaxRaw)?this._modelMaxNum=parseAxisModelMinMax(scale$3,modelMaxRaw({min:dataExtent[0],max:dataExtent[1]})):modelMaxRaw!==`dataMax`&&(this._modelMaxNum=parseAxisModelMinMax(scale$3,modelMaxRaw)),isOrdinal)this._axisDataLen=model.getCategories().length;else{var boundaryGap=model.get(`boundaryGap`),boundaryGapArr=isArray(boundaryGap)?boundaryGap:[boundaryGap||0,boundaryGap||0];typeof boundaryGapArr[0]==`boolean`||typeof boundaryGapArr[1]==`boolean`?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[parsePercent$1(boundaryGapArr[0],1),parsePercent$1(boundaryGapArr[1],1)]}},ScaleRawExtentInfo$1.prototype.calculate=function(){var isOrdinal=this._isOrdinal,dataMin=this._dataMin,dataMax=this._dataMax,axisDataLen=this._axisDataLen,boundaryGapInner=this._boundaryGapInner,span=isOrdinal?null:dataMax-dataMin||Math.abs(dataMin),min$2=this._modelMinRaw===`dataMin`?dataMin:this._modelMinNum,max$2=this._modelMaxRaw===`dataMax`?dataMax:this._modelMaxNum,minFixed=min$2!=null,maxFixed=max$2!=null;min$2??=isOrdinal?axisDataLen?0:NaN:dataMin-boundaryGapInner[0]*span,max$2??=isOrdinal?axisDataLen?axisDataLen-1:NaN:dataMax+boundaryGapInner[1]*span,(min$2==null||!isFinite(min$2))&&(min$2=NaN),(max$2==null||!isFinite(max$2))&&(max$2=NaN);var isBlank=eqNaN(min$2)||eqNaN(max$2)||isOrdinal&&!axisDataLen;this._needCrossZero&&(min$2>0&&max$2>0&&!minFixed&&(min$2=0),min$2<0&&max$2<0&&!maxFixed&&(max$2=0));var determinedMin=this._determinedMin,determinedMax=this._determinedMax;return determinedMin!=null&&(min$2=determinedMin,minFixed=!0),determinedMax!=null&&(max$2=determinedMax,maxFixed=!0),{min:min$2,max:max$2,minFixed,maxFixed,isBlank}},ScaleRawExtentInfo$1.prototype.modifyDataMinMax=function(minMaxName,val){this[DATA_MIN_MAX_ATTR[minMaxName]]=val},ScaleRawExtentInfo$1.prototype.setDeterminedMinMax=function(minMaxName,val){var attr=DETERMINED_MIN_MAX_ATTR[minMaxName];this[attr]=val},ScaleRawExtentInfo$1.prototype.freeze=function(){this.frozen=!0},ScaleRawExtentInfo$1}(),DETERMINED_MIN_MAX_ATTR={min:`_determinedMin`,max:`_determinedMax`},DATA_MIN_MAX_ATTR={min:`_dataMin`,max:`_dataMax`};function ensureScaleRawExtentInfo(scale$3,model,originalExtent){var rawExtentInfo=scale$3.rawExtentInfo;return rawExtentInfo||(rawExtentInfo=new ScaleRawExtentInfo(scale$3,model,originalExtent),scale$3.rawExtentInfo=rawExtentInfo,rawExtentInfo)}function parseAxisModelMinMax(scale$3,minMax){return minMax==null?null:eqNaN(minMax)?NaN:scale$3.parse(minMax)}function getScaleExtent(scale$3,model){var scaleType=scale$3.type,rawExtentResult=ensureScaleRawExtentInfo(scale$3,model,scale$3.getExtent()).calculate();scale$3.setBlank(rawExtentResult.isBlank);var min$2=rawExtentResult.min,max$2=rawExtentResult.max,ecModel=model.ecModel;if(ecModel&&scaleType===`time`){var barSeriesModels=prepareLayoutBarSeries(`bar`,ecModel),isBaseAxisAndHasBarSeries_1=!1;if(each(barSeriesModels,function(seriesModel){isBaseAxisAndHasBarSeries_1||=seriesModel.getBaseAxis()===model.axis}),isBaseAxisAndHasBarSeries_1){var barWidthAndOffset=makeColumnLayout(barSeriesModels),adjustedScale=adjustScaleForOverflow(min$2,max$2,model,barWidthAndOffset);min$2=adjustedScale.min,max$2=adjustedScale.max}}return{extent:[min$2,max$2],fixMin:rawExtentResult.minFixed,fixMax:rawExtentResult.maxFixed}}function adjustScaleForOverflow(min$2,max$2,model,barWidthAndOffset){var axisExtent=model.axis.getExtent(),axisLength=Math.abs(axisExtent[1]-axisExtent[0]),barsOnCurrentAxis=retrieveColumnLayout(barWidthAndOffset,model.axis);if(barsOnCurrentAxis===void 0)return{min:min$2,max:max$2};var minOverflow=1/0;each(barsOnCurrentAxis,function(item){minOverflow=Math.min(item.offset,minOverflow)});var maxOverflow=-1/0;each(barsOnCurrentAxis,function(item){maxOverflow=Math.max(item.offset+item.width,maxOverflow)}),minOverflow=Math.abs(minOverflow),maxOverflow=Math.abs(maxOverflow);var totalOverFlow=minOverflow+maxOverflow,oldRange=max$2-min$2,oldRangePercentOfNew=1-(minOverflow+maxOverflow)/axisLength,overflowBuffer=oldRange/oldRangePercentOfNew-oldRange;return max$2+=overflowBuffer*(maxOverflow/totalOverFlow),min$2-=overflowBuffer*(minOverflow/totalOverFlow),{min:min$2,max:max$2}}function niceScaleExtent(scale$3,inModel){var model=inModel,extentInfo=getScaleExtent(scale$3,model),extent=extentInfo.extent,splitNumber=model.get(`splitNumber`);scale$3 instanceof Log_default&&(scale$3.base=model.get(`logBase`));var scaleType=scale$3.type,interval=model.get(`interval`),isIntervalOrTime=scaleType===`interval`||scaleType===`time`;scale$3.setBreaksFromOption(retrieveAxisBreaksOption(model)),scale$3.setExtent(extent[0],extent[1]),scale$3.calcNiceExtent({splitNumber,fixMin:extentInfo.fixMin,fixMax:extentInfo.fixMax,minInterval:isIntervalOrTime?model.get(`minInterval`):null,maxInterval:isIntervalOrTime?model.get(`maxInterval`):null}),interval!=null&&scale$3.setInterval&&scale$3.setInterval(interval)}function createScaleByModel(model,axisType){if(axisType||=model.get(`type`),axisType)switch(axisType){case`category`:return new Ordinal_default({ordinalMeta:model.getOrdinalMeta?model.getOrdinalMeta():model.getCategories(),extent:[1/0,-1/0]});case`time`:return new Time_default({locale:model.ecModel.getLocaleModel(),useUTC:model.ecModel.get(`useUTC`)});default:return new((Scale_default.getClass(axisType))||Interval_default)}}function ifAxisCrossZero(axis){var dataExtent=axis.scale.getExtent(),min$2=dataExtent[0],max$2=dataExtent[1];return!(min$2>0&&max$2>0||min$2<0&&max$2<0)}function makeLabelFormatter(axis){var labelFormatter=axis.getLabelModel().get(`formatter`);if(axis.type===`time`){var parsed_1=parseTimeAxisLabelFormatter(labelFormatter);return function(tick,idx){return axis.scale.getFormattedLabel(tick,idx,parsed_1)}}else if(isString(labelFormatter))return function(tick){var label=axis.scale.getLabel(tick);return labelFormatter.replace(`{value}`,label??``)};else if(isFunction(labelFormatter)){if(axis.type===`category`)return function(tick,idx){return labelFormatter(getAxisRawValue(axis,tick),tick.value-axis.scale.getExtent()[0],null)};var scaleBreakHelper_1=getScaleBreakHelper();return function(tick,idx){var extra=null;return scaleBreakHelper_1&&(extra=scaleBreakHelper_1.makeAxisLabelFormatterParamBreak(extra,tick.break)),labelFormatter(getAxisRawValue(axis,tick),idx,extra)}}else return function(tick){return axis.scale.getLabel(tick)}}function getAxisRawValue(axis,tick){return axis.type===`category`?axis.scale.getLabel(tick):tick.value}function getOptionCategoryInterval(model){return model.get(`interval`)??`auto`}function shouldShowAllLabels(axis){return axis.type===`category`&&getOptionCategoryInterval(axis.getLabelModel())===0}function getDataDimensionsOnAxis(data,axisDim){var dataDimMap={};return each(data.mapDimensionsAll(axisDim),function(dataDim){dataDimMap[getStackedDimension(data,dataDim)]=!0}),keys(dataDimMap)}function unionAxisExtentFromData(dataExtent,data,axisDim){data&&each(getDataDimensionsOnAxis(data,axisDim),function(dim){var seriesExtent=data.getApproximateExtent(dim);seriesExtent[0]<dataExtent[0]&&(dataExtent[0]=seriesExtent[0]),seriesExtent[1]>dataExtent[1]&&(dataExtent[1]=seriesExtent[1])})}function isNameLocationCenter(nameLocation){return nameLocation===`middle`||nameLocation===`center`}function shouldAxisShow(axisModel){return axisModel.getShallow(`show`)}function retrieveAxisBreaksOption(model){var option=model.get(`breaks`,!0);if(option!=null)return!getScaleBreakHelper()||!isSupportAxisBreak(model.axis)?void 0:option}function isSupportAxisBreak(axis){return(axis.dim===`x`||axis.dim===`y`||axis.dim===`z`||axis.dim===`single`)&&axis.type!==`category`}var AxisModelCommonMixin=function(){function AxisModelCommonMixin$1(){}return AxisModelCommonMixin$1.prototype.getNeedCrossZero=function(){return!this.option.scale},AxisModelCommonMixin$1.prototype.getCoordSysModel=function(){},AxisModelCommonMixin$1}(),extensions=[],extensionRegisters={registerPreprocessor,registerProcessor,registerPostInit,registerPostUpdate,registerUpdateLifecycle,registerAction,registerCoordinateSystem,registerLayout,registerVisual,registerTransform,registerLoading,registerMap,registerImpl,PRIORITY,ComponentModel:Component_default,ComponentView:Component_default$1,SeriesModel:Series_default,ChartView:Chart_default,registerComponentModel:function(ComponentModelClass){Component_default.registerClass(ComponentModelClass)},registerComponentView:function(ComponentViewClass){Component_default$1.registerClass(ComponentViewClass)},registerSeriesModel:function(SeriesModelClass){Series_default.registerClass(SeriesModelClass)},registerChartView:function(ChartViewClass){Chart_default.registerClass(ChartViewClass)},registerCustomSeries:function(seriesType$1,renderItem){registerCustomSeries(seriesType$1,renderItem)},registerSubTypeDefaulter:function(componentType,defaulter){Component_default.registerSubTypeDefaulter(componentType,defaulter)},registerPainter:function(painterType,PainterCtor){registerPainter(painterType,PainterCtor)}};function use(ext){if(isArray(ext)){each(ext,function(singleExt){use(singleExt)});return}indexOf(extensions,ext)>=0||(extensions.push(ext),isFunction(ext)&&(ext={install:ext}),ext.install(extensionRegisters))}var modelInner=makeInner(),axisInner=makeInner(),AxisTickLabelComputingKind={estimate:1,determine:2};function createAxisLabelsComputingContext(kind){return{out:{noPxChangeTryDetermine:[]},kind}}function tickValuesToNumbers(axis,values){var nums=map(values,function(val){return axis.scale.parse(val)});return axis.type===`time`&&nums.length>0&&(nums.sort(),nums.unshift(nums[0]),nums.push(nums[nums.length-1])),nums}function createAxisLabels(axis,ctx){var custom=axis.getLabelModel().get(`customValues`);if(custom){var labelFormatter_1=makeLabelFormatter(axis),extent_1=axis.scale.getExtent(),tickNumbers=tickValuesToNumbers(axis,custom),ticks=filter(tickNumbers,function(val){return val>=extent_1[0]&&val<=extent_1[1]});return{labels:map(ticks,function(numval){var tick={value:numval};return{formattedLabel:labelFormatter_1(tick),rawLabel:axis.scale.getLabel(tick),tickValue:numval,time:void 0,break:void 0}})}}return axis.type===`category`?makeCategoryLabels(axis,ctx):makeRealNumberLabels(axis)}function createAxisTicks(axis,tickModel,opt){var custom=axis.getTickModel().get(`customValues`);if(custom){var extent_2=axis.scale.getExtent(),tickNumbers=tickValuesToNumbers(axis,custom);return{ticks:filter(tickNumbers,function(val){return val>=extent_2[0]&&val<=extent_2[1]})}}return axis.type===`category`?makeCategoryTicks(axis,tickModel):{ticks:map(axis.scale.getTicks(opt),function(tick){return tick.value})}}function makeCategoryLabels(axis,ctx){var labelModel=axis.getLabelModel(),result=makeCategoryLabelsActually(axis,labelModel,ctx);return!labelModel.get(`show`)||axis.scale.isBlank()?{labels:[]}:result}function makeCategoryLabelsActually(axis,labelModel,ctx){var labelsCache=ensureCategoryLabelCache(axis),optionLabelInterval=getOptionCategoryInterval(labelModel),isEstimate=ctx.kind===AxisTickLabelComputingKind.estimate;if(!isEstimate){var result_1=axisCacheGet(labelsCache,optionLabelInterval);if(result_1)return result_1}var labels,numericLabelInterval;isFunction(optionLabelInterval)?labels=makeLabelsByCustomizedCategoryInterval(axis,optionLabelInterval):(numericLabelInterval=optionLabelInterval===`auto`?makeAutoCategoryInterval(axis,ctx):optionLabelInterval,labels=makeLabelsByNumericCategoryInterval(axis,numericLabelInterval));var result={labels,labelCategoryInterval:numericLabelInterval};return isEstimate?ctx.out.noPxChangeTryDetermine.push(function(){return axisCacheSet(labelsCache,optionLabelInterval,result),!0}):axisCacheSet(labelsCache,optionLabelInterval,result),result}function makeCategoryTicks(axis,tickModel){var ticksCache=ensureCategoryTickCache(axis),optionTickInterval=getOptionCategoryInterval(tickModel),result=axisCacheGet(ticksCache,optionTickInterval);if(result)return result;var ticks,tickCategoryInterval;if((!tickModel.get(`show`)||axis.scale.isBlank())&&(ticks=[]),isFunction(optionTickInterval))ticks=makeLabelsByCustomizedCategoryInterval(axis,optionTickInterval,!0);else if(optionTickInterval===`auto`){var labelsResult=makeCategoryLabelsActually(axis,axis.getLabelModel(),createAxisLabelsComputingContext(AxisTickLabelComputingKind.determine));tickCategoryInterval=labelsResult.labelCategoryInterval,ticks=map(labelsResult.labels,function(labelItem){return labelItem.tickValue})}else tickCategoryInterval=optionTickInterval,ticks=makeLabelsByNumericCategoryInterval(axis,tickCategoryInterval,!0);return axisCacheSet(ticksCache,optionTickInterval,{ticks,tickCategoryInterval})}function makeRealNumberLabels(axis){var ticks=axis.scale.getTicks(),labelFormatter=makeLabelFormatter(axis);return{labels:map(ticks,function(tick,idx){return{formattedLabel:labelFormatter(tick,idx),rawLabel:axis.scale.getLabel(tick),tickValue:tick.value,time:tick.time,break:tick.break}})}}var ensureCategoryTickCache=initAxisCacheMethod(`axisTick`),ensureCategoryLabelCache=initAxisCacheMethod(`axisLabel`);function initAxisCacheMethod(prop){return function(axis){return axisInner(axis)[prop]||(axisInner(axis)[prop]={list:[]})}}function axisCacheGet(cache,key$1){for(var i$1=0;i$1<cache.list.length;i$1++)if(cache.list[i$1].key===key$1)return cache.list[i$1].value}function axisCacheSet(cache,key$1,value){return cache.list.push({key:key$1,value}),value}function makeAutoCategoryInterval(axis,ctx){if(ctx.kind===AxisTickLabelComputingKind.estimate){var result_2=axis.calculateCategoryInterval(ctx);return ctx.out.noPxChangeTryDetermine.push(function(){return axisInner(axis).autoInterval=result_2,!0}),result_2}return axisInner(axis).autoInterval??(axisInner(axis).autoInterval=axis.calculateCategoryInterval(ctx))}function calculateCategoryInterval(axis,ctx){var kind=ctx.kind,params=fetchAutoCategoryIntervalCalculationParams(axis),labelFormatter=makeLabelFormatter(axis),rotation=(params.axisRotate-params.labelRotate)/180*Math.PI,ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),tickCount=ordinalScale.count();if(ordinalExtent[1]-ordinalExtent[0]<1)return 0;var step=1,maxCount=40;tickCount>maxCount&&(step=Math.max(1,Math.floor(tickCount/maxCount)));for(var tickValue=ordinalExtent[0],unitSpan=axis.dataToCoord(tickValue+1)-axis.dataToCoord(tickValue),unitW=Math.abs(unitSpan*Math.cos(rotation)),unitH=Math.abs(unitSpan*Math.sin(rotation)),maxW=0,maxH=0;tickValue<=ordinalExtent[1];tickValue+=step){var width=0,height=0,rect=getBoundingRect(labelFormatter({value:tickValue}),params.font,`center`,`top`);width=rect.width*1.3,height=rect.height*1.3,maxW=Math.max(maxW,width,7),maxH=Math.max(maxH,height,7)}var dw=maxW/unitW,dh=maxH/unitH;isNaN(dw)&&(dw=1/0),isNaN(dh)&&(dh=1/0);var interval=Math.max(0,Math.floor(Math.min(dw,dh)));return kind===AxisTickLabelComputingKind.estimate?(ctx.out.noPxChangeTryDetermine.push(bind(calculateCategoryIntervalTryDetermine,null,axis,interval,tickCount)),interval):calculateCategoryIntervalDealCache(axis,interval,tickCount)??interval}function calculateCategoryIntervalTryDetermine(axis,interval,tickCount){return calculateCategoryIntervalDealCache(axis,interval,tickCount)==null}function calculateCategoryIntervalDealCache(axis,interval,tickCount){var cache=modelInner(axis.model),axisExtent=axis.getExtent(),lastAutoInterval=cache.lastAutoInterval,lastTickCount=cache.lastTickCount;if(lastAutoInterval!=null&&lastTickCount!=null&&Math.abs(lastAutoInterval-interval)<=1&&Math.abs(lastTickCount-tickCount)<=1&&lastAutoInterval>interval&&cache.axisExtent0===axisExtent[0]&&cache.axisExtent1===axisExtent[1])return lastAutoInterval;cache.lastTickCount=tickCount,cache.lastAutoInterval=interval,cache.axisExtent0=axisExtent[0],cache.axisExtent1=axisExtent[1]}function fetchAutoCategoryIntervalCalculationParams(axis){var labelModel=axis.getLabelModel();return{axisRotate:axis.getRotate?axis.getRotate():axis.isHorizontal&&!axis.isHorizontal()?90:0,labelRotate:labelModel.get(`rotate`)||0,font:labelModel.getFont()}}function makeLabelsByNumericCategoryInterval(axis,categoryInterval,onlyTick){var labelFormatter=makeLabelFormatter(axis),ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),labelModel=axis.getLabelModel(),result=[],step=Math.max((categoryInterval||0)+1,1),startTick=ordinalExtent[0],tickCount=ordinalScale.count();startTick!==0&&step>1&&tickCount/step>2&&(startTick=Math.round(Math.ceil(startTick/step)*step));var showAllLabel=shouldShowAllLabels(axis),includeMinLabel=labelModel.get(`showMinLabel`)||showAllLabel,includeMaxLabel=labelModel.get(`showMaxLabel`)||showAllLabel;includeMinLabel&&startTick!==ordinalExtent[0]&&addItem(ordinalExtent[0]);for(var tickValue=startTick;tickValue<=ordinalExtent[1];tickValue+=step)addItem(tickValue);includeMaxLabel&&tickValue-step!==ordinalExtent[1]&&addItem(ordinalExtent[1]);function addItem(tickValue$1){var tickObj={value:tickValue$1};result.push(onlyTick?tickValue$1:{formattedLabel:labelFormatter(tickObj),rawLabel:ordinalScale.getLabel(tickObj),tickValue:tickValue$1,time:void 0,break:void 0})}return result}function makeLabelsByCustomizedCategoryInterval(axis,categoryInterval,onlyTick){var ordinalScale=axis.scale,labelFormatter=makeLabelFormatter(axis),result=[];return each(ordinalScale.getTicks(),function(tick){var rawLabel=ordinalScale.getLabel(tick),tickValue=tick.value;categoryInterval(tick.value,rawLabel)&&result.push(onlyTick?tickValue:{formattedLabel:labelFormatter(tick),rawLabel,tickValue,time:void 0,break:void 0})}),result}var NORMALIZED_EXTENT=[0,1],Axis=function(){function Axis$2(dim,scale$3,extent){this.onBand=!1,this.inverse=!1,this.dim=dim,this.scale=scale$3,this._extent=extent||[0,0]}return Axis$2.prototype.contain=function(coord){var extent=this._extent,min$2=Math.min(extent[0],extent[1]),max$2=Math.max(extent[0],extent[1]);return coord>=min$2&&coord<=max$2},Axis$2.prototype.containData=function(data){return this.scale.contain(this.scale.parse(data))},Axis$2.prototype.getExtent=function(){return this._extent.slice()},Axis$2.prototype.getPixelPrecision=function(dataExtent){return getPixelPrecision(dataExtent||this.scale.getExtent(),this._extent)},Axis$2.prototype.setExtent=function(start$1,end$1){var extent=this._extent;extent[0]=start$1,extent[1]=end$1},Axis$2.prototype.dataToCoord=function(data,clamp$1){var extent=this._extent,scale$3=this.scale;return data=scale$3.normalize(scale$3.parse(data)),this.onBand&&scale$3.type===`ordinal`&&(extent=extent.slice(),fixExtentWithBands(extent,scale$3.count())),linearMap(data,NORMALIZED_EXTENT,extent,clamp$1)},Axis$2.prototype.coordToData=function(coord,clamp$1){var extent=this._extent,scale$3=this.scale;this.onBand&&scale$3.type===`ordinal`&&(extent=extent.slice(),fixExtentWithBands(extent,scale$3.count()));var t$1=linearMap(coord,extent,NORMALIZED_EXTENT,clamp$1);return this.scale.scale(t$1)},Axis$2.prototype.pointToData=function(point,clamp$1){},Axis$2.prototype.getTicksCoords=function(opt){opt||={};var tickModel=opt.tickModel||this.getTickModel(),ticks=createAxisTicks(this,tickModel,{breakTicks:opt.breakTicks,pruneByBreak:opt.pruneByBreak}).ticks,ticksCoords=map(ticks,function(tickVal){return{coord:this.dataToCoord(this.scale.type===`ordinal`?this.scale.getRawOrdinalNumber(tickVal):tickVal),tickValue:tickVal}},this),alignWithLabel=tickModel.get(`alignWithLabel`);return fixOnBandTicksCoords(this,ticksCoords,alignWithLabel,opt.clamp),ticksCoords},Axis$2.prototype.getMinorTicksCoords=function(){if(this.scale.type===`ordinal`)return[];var splitNumber=this.model.getModel(`minorTick`).get(`splitNumber`);splitNumber>0&&splitNumber<100||(splitNumber=5);var minorTicks=this.scale.getMinorTicks(splitNumber);return map(minorTicks,function(minorTicksGroup){return map(minorTicksGroup,function(minorTick){return{coord:this.dataToCoord(minorTick),tickValue:minorTick}},this)},this)},Axis$2.prototype.getViewLabels=function(ctx){return ctx||=createAxisLabelsComputingContext(AxisTickLabelComputingKind.determine),createAxisLabels(this,ctx).labels},Axis$2.prototype.getLabelModel=function(){return this.model.getModel(`axisLabel`)},Axis$2.prototype.getTickModel=function(){return this.model.getModel(`axisTick`)},Axis$2.prototype.getBandWidth=function(){var axisExtent=this._extent,dataExtent=this.scale.getExtent(),len$1=dataExtent[1]-dataExtent[0]+(this.onBand?1:0);len$1===0&&(len$1=1);var size=Math.abs(axisExtent[1]-axisExtent[0]);return Math.abs(size)/len$1},Axis$2.prototype.calculateCategoryInterval=function(ctx){return ctx||=createAxisLabelsComputingContext(AxisTickLabelComputingKind.determine),calculateCategoryInterval(this,ctx)},Axis$2}();function fixExtentWithBands(extent,nTick){var margin=(extent[1]-extent[0])/nTick/2;extent[0]+=margin,extent[1]-=margin}function fixOnBandTicksCoords(axis,ticksCoords,alignWithLabel,clamp$1){var ticksLen=ticksCoords.length;if(!axis.onBand||alignWithLabel||!ticksLen)return;var axisExtent=axis.getExtent(),last,diffSize;if(ticksLen===1)ticksCoords[0].coord=axisExtent[0],ticksCoords[0].onBand=!0,last=ticksCoords[1]={coord:axisExtent[1],tickValue:ticksCoords[0].tickValue,onBand:!0};else{var crossLen=ticksCoords[ticksLen-1].tickValue-ticksCoords[0].tickValue,shift_1=(ticksCoords[ticksLen-1].coord-ticksCoords[0].coord)/crossLen;each(ticksCoords,function(ticksItem){ticksItem.coord-=shift_1/2,ticksItem.onBand=!0});var dataExtent=axis.scale.getExtent();diffSize=1+dataExtent[1]-ticksCoords[ticksLen-1].tickValue,last={coord:ticksCoords[ticksLen-1].coord+shift_1*diffSize,tickValue:dataExtent[1]+1,onBand:!0},ticksCoords.push(last)}var inverse=axisExtent[0]>axisExtent[1];littleThan(ticksCoords[0].coord,axisExtent[0])&&(clamp$1?ticksCoords[0].coord=axisExtent[0]:ticksCoords.shift()),clamp$1&&littleThan(axisExtent[0],ticksCoords[0].coord)&&ticksCoords.unshift({coord:axisExtent[0],onBand:!0}),littleThan(axisExtent[1],last.coord)&&(clamp$1?last.coord=axisExtent[1]:ticksCoords.pop()),clamp$1&&littleThan(last.coord,axisExtent[1])&&ticksCoords.push({coord:axisExtent[1],onBand:!0});function littleThan(a$1,b$1){return a$1=round(a$1),b$1=round(b$1),inverse?a$1>b$1:a$1<b$1}}var Axis_default=Axis,LABEL_LAYOUT_BASE_PROPS=[`label`,`labelLine`,`layoutOption`,`priority`,`defaultAttr`,`marginForce`,`minMarginForce`,`marginDefault`,`suggestIgnore`],LABEL_LAYOUT_DIRTY_BIT_OTHERS=1,LABEL_LAYOUT_DIRTY_BIT_OBB=2,LABEL_LAYOUT_DIRTY_ALL=LABEL_LAYOUT_DIRTY_BIT_OTHERS|LABEL_LAYOUT_DIRTY_BIT_OBB;function setLabelLayoutDirty(labelGeometry,dirtyOrClear,dirtyBits){dirtyBits||=LABEL_LAYOUT_DIRTY_ALL,dirtyOrClear?labelGeometry.dirty|=dirtyBits:labelGeometry.dirty&=~dirtyBits}function isLabelLayoutDirty(labelGeometry,dirtyBits){return dirtyBits||=LABEL_LAYOUT_DIRTY_ALL,labelGeometry.dirty==null||!!(labelGeometry.dirty&dirtyBits)}function ensureLabelLayoutWithGeometry(labelLayout){if(labelLayout)return isLabelLayoutDirty(labelLayout)&&computeLabelGeometry(labelLayout,labelLayout.label,labelLayout),labelLayout}function computeLabelGeometry(out$2,label,opt){var rawTransform=label.getComputedTransform();out$2.transform=ensureCopyTransform(out$2.transform,rawTransform);var outLocalRect=out$2.localRect=ensureCopyRect(out$2.localRect,label.getBoundingRect()),labelStyleExt=label.style,margin=labelStyleExt.margin,marginForce=opt&&opt.marginForce,minMarginForce=opt&&opt.minMarginForce,marginDefault=opt&&opt.marginDefault,marginType=labelStyleExt.__marginType;marginType==null&&marginDefault&&(margin=marginDefault,marginType=LabelMarginType.textMargin);for(var i$1=0;i$1<4;i$1++)_tmpLabelMargin[i$1]=marginType===LabelMarginType.minMargin&&minMarginForce&&minMarginForce[i$1]!=null?minMarginForce[i$1]:marginForce&&marginForce[i$1]!=null?marginForce[i$1]:margin?margin[i$1]:0;marginType===LabelMarginType.textMargin&&expandOrShrinkRect(outLocalRect,_tmpLabelMargin,!1,!1);var outGlobalRect=out$2.rect=ensureCopyRect(out$2.rect,outLocalRect);return rawTransform&&outGlobalRect.applyTransform(rawTransform),marginType===LabelMarginType.minMargin&&expandOrShrinkRect(outGlobalRect,_tmpLabelMargin,!1,!1),out$2.axisAligned=isBoundingRectAxisAligned(rawTransform),(out$2.label=out$2.label||{}).ignore=label.ignore,setLabelLayoutDirty(out$2,!1),setLabelLayoutDirty(out$2,!0,LABEL_LAYOUT_DIRTY_BIT_OBB),out$2}var _tmpLabelMargin=[0,0,0,0];function computeLabelGeometry2(out$2,rawLocalRect,rawTransform){return out$2.transform=ensureCopyTransform(out$2.transform,rawTransform),out$2.localRect=ensureCopyRect(out$2.localRect,rawLocalRect),out$2.rect=ensureCopyRect(out$2.rect,rawLocalRect),rawTransform&&out$2.rect.applyTransform(rawTransform),out$2.axisAligned=isBoundingRectAxisAligned(rawTransform),out$2.obb=void 0,(out$2.label=out$2.label||{}).ignore=!1,out$2}function labelLayoutApplyTranslation(labelLayout,offset){if(labelLayout){labelLayout.label.x+=offset.x,labelLayout.label.y+=offset.y,labelLayout.label.markRedraw();var transform=labelLayout.transform;transform&&(transform[4]+=offset.x,transform[5]+=offset.y);var globalRect=labelLayout.rect;globalRect&&(globalRect.x+=offset.x,globalRect.y+=offset.y);var obb=labelLayout.obb;obb&&obb.fromBoundingRect(labelLayout.localRect,transform)}}function newLabelLayoutWithGeometry(newBaseWithDefaults,source$2){for(var i$1=0;i$1<LABEL_LAYOUT_BASE_PROPS.length;i$1++){var prop=LABEL_LAYOUT_BASE_PROPS[i$1];newBaseWithDefaults[prop]??(newBaseWithDefaults[prop]=source$2[prop])}return ensureLabelLayoutWithGeometry(newBaseWithDefaults)}function ensureOBB(labelGeometry){var obb=labelGeometry.obb;return(!obb||isLabelLayoutDirty(labelGeometry,LABEL_LAYOUT_DIRTY_BIT_OBB))&&(labelGeometry.obb=obb||=new OrientedBoundingRect_default,obb.fromBoundingRect(labelGeometry.localRect,labelGeometry.transform),setLabelLayoutDirty(labelGeometry,!1,LABEL_LAYOUT_DIRTY_BIT_OBB)),obb}function hideOverlap(labelList){var displayedLabels=[];labelList.sort(function(a$1,b$1){return(b$1.suggestIgnore?1:0)-(a$1.suggestIgnore?1:0)||b$1.priority-a$1.priority});function hideEl(el){if(!el.ignore){var emphasisState=el.ensureState(`emphasis`);emphasisState.ignore??=!1}el.ignore=!0}for(var i$1=0;i$1<labelList.length;i$1++){var labelItem=ensureLabelLayoutWithGeometry(labelList[i$1]);if(!labelItem.label.ignore){for(var label=labelItem.label,labelLine=labelItem.labelLine,overlapped=!1,j$1=0;j$1<displayedLabels.length;j$1++)if(labelIntersect(labelItem,displayedLabels[j$1],null,{touchThreshold:.05})){overlapped=!0;break}overlapped?(hideEl(label),labelLine&&hideEl(labelLine)):displayedLabels.push(labelItem)}}}function labelIntersect(baseLayoutInfo,targetLayoutInfo,mtv,intersectOpt){return!baseLayoutInfo||!targetLayoutInfo||baseLayoutInfo.label&&baseLayoutInfo.label.ignore||targetLayoutInfo.label&&targetLayoutInfo.label.ignore||!baseLayoutInfo.rect.intersect(targetLayoutInfo.rect,mtv,intersectOpt)?!1:baseLayoutInfo.axisAligned&&targetLayoutInfo.axisAligned?!0:ensureOBB(baseLayoutInfo).intersect(ensureOBB(targetLayoutInfo),mtv,intersectOpt)}var LineSeries_default=function(_super){__extends(LineSeriesModel$1,_super);function LineSeriesModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=LineSeriesModel$1.type,_this.hasSymbolVisual=!0,_this}return LineSeriesModel$1.prototype.getInitialData=function(option){return createSeriesData_default(null,this,{useEncodeDefaulter:!0})},LineSeriesModel$1.prototype.getLegendIcon=function(opt){var group=new Group_default,line=createSymbol(`line`,0,opt.itemHeight/2,opt.itemWidth,0,opt.lineStyle.stroke,!1);group.add(line),line.setStyle(opt.lineStyle);var visualType=this.getData().getVisual(`symbol`),visualRotate=this.getData().getVisual(`symbolRotate`),symbolType=visualType===`none`?`circle`:visualType,size=opt.itemHeight*.8,symbol=createSymbol(symbolType,(opt.itemWidth-size)/2,(opt.itemHeight-size)/2,size,size,opt.itemStyle.fill);return group.add(symbol),symbol.setStyle(opt.itemStyle),symbol.rotation=(opt.iconRotate===`inherit`?visualRotate:opt.iconRotate||0)*Math.PI/180,symbol.setOrigin([opt.itemWidth/2,opt.itemHeight/2]),symbolType.indexOf(`empty`)>-1&&(symbol.style.stroke=symbol.style.fill,symbol.style.fill=tokens_default.color.neutral00,symbol.style.lineWidth=2),group},LineSeriesModel$1.type=`series.line`,LineSeriesModel$1.dependencies=[`grid`,`polar`],LineSeriesModel$1.defaultOption={z:3,coordinateSystem:`cartesian2d`,legendHoverLink:!0,clip:!0,label:{position:`top`},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:`solid`},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:`emptyCircle`,symbolSize:6,symbolRotate:null,showSymbol:!0,showAllSymbol:`auto`,connectNulls:!1,sampling:`none`,animationEasing:`linear`,progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:`clone`},triggerLineEvent:!1},LineSeriesModel$1}(Series_default);function getDefaultLabel(data,dataIndex){var labelDims=data.mapDimensionsAll(`defaultedLabel`),len$1=labelDims.length;if(len$1===1){var rawVal=retrieveRawValue(data,dataIndex,labelDims[0]);return rawVal==null?null:rawVal+``}else if(len$1){for(var vals=[],i$1=0;i$1<labelDims.length;i$1++)vals.push(retrieveRawValue(data,dataIndex,labelDims[i$1]));return vals.join(` `)}}function getDefaultInterpolatedLabel(data,interpolatedValue){var labelDims=data.mapDimensionsAll(`defaultedLabel`);if(!isArray(interpolatedValue))return interpolatedValue+``;for(var vals=[],i$1=0;i$1<labelDims.length;i$1++){var dimIndex=data.getDimensionIndex(labelDims[i$1]);dimIndex>=0&&vals.push(interpolatedValue[dimIndex])}return vals.join(` `)}var Symbol$1=function(_super){__extends(Symbol$2,_super);function Symbol$2(data,idx,seriesScope,opts){var _this=_super.call(this)||this;return _this.updateData(data,idx,seriesScope,opts),_this}return Symbol$2.prototype._createSymbol=function(symbolType,data,idx,symbolSize,z2,keepAspect){this.removeAll();var symbolPath=createSymbol(symbolType,-1,-1,2,2,null,keepAspect);symbolPath.attr({z2:retrieve2(z2,100),culling:!0,scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2}),symbolPath.drift=driftSymbol,this._symbolType=symbolType,this.add(symbolPath)},Symbol$2.prototype.stopSymbolAnimation=function(toLastFrame){this.childAt(0).stopAnimation(null,toLastFrame)},Symbol$2.prototype.getSymbolType=function(){return this._symbolType},Symbol$2.prototype.getSymbolPath=function(){return this.childAt(0)},Symbol$2.prototype.highlight=function(){enterEmphasis(this.childAt(0))},Symbol$2.prototype.downplay=function(){leaveEmphasis(this.childAt(0))},Symbol$2.prototype.setZ=function(zlevel,z){var symbolPath=this.childAt(0);symbolPath.zlevel=zlevel,symbolPath.z=z},Symbol$2.prototype.setDraggable=function(draggable,hasCursorOption){var symbolPath=this.childAt(0);symbolPath.draggable=draggable,symbolPath.cursor=!hasCursorOption&&draggable?`move`:symbolPath.cursor},Symbol$2.prototype.updateData=function(data,idx,seriesScope,opts){this.silent=!1;var symbolType=data.getItemVisual(idx,`symbol`)||`circle`,seriesModel=data.hostModel,symbolSize=Symbol$2.getSymbolSize(data,idx),z2=Symbol$2.getSymbolZ2(data,idx),isInit=symbolType!==this._symbolType,disableAnimation=opts&&opts.disableAnimation;if(isInit){var keepAspect=data.getItemVisual(idx,`symbolKeepAspect`);this._createSymbol(symbolType,data,idx,symbolSize,z2,keepAspect)}else{var symbolPath=this.childAt(0);symbolPath.silent=!1;var target={scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2};disableAnimation?symbolPath.attr(target):updateProps$1(symbolPath,target,seriesModel,idx),saveOldStyle(symbolPath)}if(this._updateCommon(data,idx,symbolSize,seriesScope,opts),isInit){var symbolPath=this.childAt(0);if(!disableAnimation){var target={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:symbolPath.style.opacity}};symbolPath.scaleX=symbolPath.scaleY=0,symbolPath.style.opacity=0,initProps(symbolPath,target,seriesModel,idx)}}disableAnimation&&this.childAt(0).stopAnimation(`leave`)},Symbol$2.prototype._updateCommon=function(data,idx,symbolSize,seriesScope,opts){var symbolPath=this.childAt(0),seriesModel=data.hostModel,emphasisItemStyle,blurItemStyle,selectItemStyle,focus,blurScope,emphasisDisabled,labelStatesModels,hoverScale,cursorStyle;if(seriesScope&&(emphasisItemStyle=seriesScope.emphasisItemStyle,blurItemStyle=seriesScope.blurItemStyle,selectItemStyle=seriesScope.selectItemStyle,focus=seriesScope.focus,blurScope=seriesScope.blurScope,labelStatesModels=seriesScope.labelStatesModels,hoverScale=seriesScope.hoverScale,cursorStyle=seriesScope.cursorStyle,emphasisDisabled=seriesScope.emphasisDisabled),!seriesScope||data.hasItemOption){var itemModel=seriesScope&&seriesScope.itemModel?seriesScope.itemModel:data.getItemModel(idx),emphasisModel=itemModel.getModel(`emphasis`);emphasisItemStyle=emphasisModel.getModel(`itemStyle`).getItemStyle(),selectItemStyle=itemModel.getModel([`select`,`itemStyle`]).getItemStyle(),blurItemStyle=itemModel.getModel([`blur`,`itemStyle`]).getItemStyle(),focus=emphasisModel.get(`focus`),blurScope=emphasisModel.get(`blurScope`),emphasisDisabled=emphasisModel.get(`disabled`),labelStatesModels=getLabelStatesModels(itemModel),hoverScale=emphasisModel.getShallow(`scale`),cursorStyle=itemModel.getShallow(`cursor`)}var symbolRotate=data.getItemVisual(idx,`symbolRotate`);symbolPath.attr(`rotation`,(symbolRotate||0)*Math.PI/180||0);var symbolOffset=normalizeSymbolOffset(data.getItemVisual(idx,`symbolOffset`),symbolSize);symbolOffset&&(symbolPath.x=symbolOffset[0],symbolPath.y=symbolOffset[1]),cursorStyle&&symbolPath.attr(`cursor`,cursorStyle);var symbolStyle=data.getItemVisual(idx,`style`),visualColor=symbolStyle.fill;if(symbolPath instanceof Image_default){var pathStyle=symbolPath.style;symbolPath.useStyle(extend({image:pathStyle.image,x:pathStyle.x,y:pathStyle.y,width:pathStyle.width,height:pathStyle.height},symbolStyle))}else symbolPath.__isEmptyBrush?symbolPath.useStyle(extend({},symbolStyle)):symbolPath.useStyle(symbolStyle),symbolPath.style.decal=null,symbolPath.setColor(visualColor,opts&&opts.symbolInnerColor),symbolPath.style.strokeNoScale=!0;var liftZ=data.getItemVisual(idx,`liftZ`),z2Origin=this._z2;liftZ==null?z2Origin!=null&&(symbolPath.z2=z2Origin,this._z2=null):z2Origin??(this._z2=symbolPath.z2,symbolPath.z2+=liftZ);var useNameLabel=opts&&opts.useNameLabel;setLabelStyle(symbolPath,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:idx,defaultText:getLabelDefaultText,inheritColor:visualColor,defaultOpacity:symbolStyle.opacity});function getLabelDefaultText(idx$1){return useNameLabel?data.getName(idx$1):getDefaultLabel(data,idx$1)}this._sizeX=symbolSize[0]/2,this._sizeY=symbolSize[1]/2;var emphasisState=symbolPath.ensureState(`emphasis`);emphasisState.style=emphasisItemStyle,symbolPath.ensureState(`select`).style=selectItemStyle,symbolPath.ensureState(`blur`).style=blurItemStyle;var scaleRatio=hoverScale==null||hoverScale===!0?Math.max(1.1,3/this._sizeY):isFinite(hoverScale)&&hoverScale>0?+hoverScale:1;emphasisState.scaleX=this._sizeX*scaleRatio,emphasisState.scaleY=this._sizeY*scaleRatio,this.setSymbolScale(1),toggleHoverEmphasis(this,focus,blurScope,emphasisDisabled)},Symbol$2.prototype.setSymbolScale=function(scale$3){this.scaleX=this.scaleY=scale$3},Symbol$2.prototype.fadeOut=function(cb,seriesModel,opt){var symbolPath=this.childAt(0),dataIndex=getECData(this).dataIndex,animationOpt=opt&&opt.animation;if(this.silent=symbolPath.silent=!0,opt&&opt.fadeLabel){var textContent=symbolPath.getTextContent();textContent&&removeElement(textContent,{style:{opacity:0}},seriesModel,{dataIndex,removeOpt:animationOpt,cb:function(){symbolPath.removeTextContent()}})}else symbolPath.removeTextContent();removeElement(symbolPath,{style:{opacity:0},scaleX:0,scaleY:0},seriesModel,{dataIndex,cb,removeOpt:animationOpt})},Symbol$2.getSymbolSize=function(data,idx){return normalizeSymbolSize(data.getItemVisual(idx,`symbolSize`))},Symbol$2.getSymbolZ2=function(data,idx){return data.getItemVisual(idx,`z2`)},Symbol$2}(Group_default);function driftSymbol(dx,dy){this.parent.drift(dx,dy)}var Symbol_default=Symbol$1;function symbolNeedsDraw(data,point,idx,opt){return point&&!isNaN(point[0])&&!isNaN(point[1])&&!(opt.isIgnore&&opt.isIgnore(idx))&&!(opt.clipShape&&!opt.clipShape.contain(point[0],point[1]))&&data.getItemVisual(idx,`symbol`)!==`none`}function normalizeUpdateOpt(opt){return opt!=null&&!isObject(opt)&&(opt={isIgnore:opt}),opt||{}}function makeSeriesScope(data){var seriesModel=data.hostModel,emphasisModel=seriesModel.getModel(`emphasis`);return{emphasisItemStyle:emphasisModel.getModel(`itemStyle`).getItemStyle(),blurItemStyle:seriesModel.getModel([`blur`,`itemStyle`]).getItemStyle(),selectItemStyle:seriesModel.getModel([`select`,`itemStyle`]).getItemStyle(),focus:emphasisModel.get(`focus`),blurScope:emphasisModel.get(`blurScope`),emphasisDisabled:emphasisModel.get(`disabled`),hoverScale:emphasisModel.get(`scale`),labelStatesModels:getLabelStatesModels(seriesModel),cursorStyle:seriesModel.get(`cursor`)}}var SymbolDraw_default=function(){function SymbolDraw$1(SymbolCtor){this.group=new Group_default,this._SymbolCtor=SymbolCtor||Symbol_default}return SymbolDraw$1.prototype.updateData=function(data,opt){this._progressiveEls=null,opt=normalizeUpdateOpt(opt);var group=this.group,seriesModel=data.hostModel,oldData=this._data,SymbolCtor=this._SymbolCtor,disableAnimation=opt.disableAnimation,seriesScope=makeSeriesScope(data),symbolUpdateOpt={disableAnimation},getSymbolPoint=opt.getSymbolPoint||function(idx){return data.getItemLayout(idx)};oldData||group.removeAll(),data.diff(oldData).add(function(newIdx){var point=getSymbolPoint(newIdx);if(symbolNeedsDraw(data,point,newIdx,opt)){var symbolEl=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt);symbolEl.setPosition(point),data.setItemGraphicEl(newIdx,symbolEl),group.add(symbolEl)}}).update(function(newIdx,oldIdx){var symbolEl=oldData.getItemGraphicEl(oldIdx),point=getSymbolPoint(newIdx);if(!symbolNeedsDraw(data,point,newIdx,opt)){group.remove(symbolEl);return}var newSymbolType=data.getItemVisual(newIdx,`symbol`)||`circle`,oldSymbolType=symbolEl&&symbolEl.getSymbolType&&symbolEl.getSymbolType();if(!symbolEl||oldSymbolType&&oldSymbolType!==newSymbolType)group.remove(symbolEl),symbolEl=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt),symbolEl.setPosition(point);else{symbolEl.updateData(data,newIdx,seriesScope,symbolUpdateOpt);var target={x:point[0],y:point[1]};disableAnimation?symbolEl.attr(target):updateProps$1(symbolEl,target,seriesModel)}group.add(symbolEl),data.setItemGraphicEl(newIdx,symbolEl)}).remove(function(oldIdx){var el=oldData.getItemGraphicEl(oldIdx);el&&el.fadeOut(function(){group.remove(el)},seriesModel)}).execute(),this._getSymbolPoint=getSymbolPoint,this._data=data},SymbolDraw$1.prototype.updateLayout=function(){var _this=this,data=this._data;data&&data.eachItemGraphicEl(function(el,idx){var point=_this._getSymbolPoint(idx);el.setPosition(point),el.markRedraw()})},SymbolDraw$1.prototype.incrementalPrepareUpdate=function(data){this._seriesScope=makeSeriesScope(data),this._data=null,this.group.removeAll()},SymbolDraw$1.prototype.incrementalUpdate=function(taskParams,data,opt){this._progressiveEls=[],opt=normalizeUpdateOpt(opt);function updateIncrementalAndHover(el$1){el$1.isGroup||(el$1.incremental=!0,el$1.ensureState(`emphasis`).hoverLayer=!0)}for(var idx=taskParams.start;idx<taskParams.end;idx++){var point=data.getItemLayout(idx);if(symbolNeedsDraw(data,point,idx,opt)){var el=new this._SymbolCtor(data,idx,this._seriesScope);el.traverse(updateIncrementalAndHover),el.setPosition(point),this.group.add(el),data.setItemGraphicEl(idx,el),this._progressiveEls.push(el)}}},SymbolDraw$1.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},SymbolDraw$1.prototype.remove=function(enableAnimation){var group=this.group,data=this._data;data&&enableAnimation?data.eachItemGraphicEl(function(el){el.fadeOut(function(){group.remove(el)},data.hostModel)}):group.removeAll()},SymbolDraw$1}();function prepareDataCoordInfo(coordSys,data,valueOrigin){var baseAxis=coordSys.getBaseAxis(),valueAxis$1=coordSys.getOtherAxis(baseAxis),valueStart=getValueStart(valueAxis$1,valueOrigin),baseAxisDim=baseAxis.dim,valueAxisDim=valueAxis$1.dim,valueDim=data.mapDimension(valueAxisDim),baseDim=data.mapDimension(baseAxisDim),baseDataOffset=valueAxisDim===`x`||valueAxisDim===`radius`?1:0,dims=map(coordSys.dimensions,function(coordDim){return data.mapDimension(coordDim)}),stacked=!1,stackResultDim=data.getCalculationInfo(`stackResultDimension`);return isDimensionStacked(data,dims[0])&&(stacked=!0,dims[0]=stackResultDim),isDimensionStacked(data,dims[1])&&(stacked=!0,dims[1]=stackResultDim),{dataDimsForPoint:dims,valueStart,valueAxisDim,baseAxisDim,stacked:!!stacked,valueDim,baseDim,baseDataOffset,stackedOverDimension:data.getCalculationInfo(`stackedOverDimension`)}}function getValueStart(valueAxis$1,valueOrigin){var valueStart=0,extent=valueAxis$1.scale.getExtent();return valueOrigin===`start`?valueStart=extent[0]:valueOrigin===`end`?valueStart=extent[1]:isNumber(valueOrigin)&&!isNaN(valueOrigin)?valueStart=valueOrigin:extent[0]>0?valueStart=extent[0]:extent[1]<0&&(valueStart=extent[1]),valueStart}function getStackedOnPoint(dataCoordInfo,coordSys,data,idx){var value=NaN;dataCoordInfo.stacked&&(value=data.get(data.getCalculationInfo(`stackedOverDimension`),idx)),isNaN(value)&&(value=dataCoordInfo.valueStart);var baseDataOffset=dataCoordInfo.baseDataOffset,stackedData=[];return stackedData[baseDataOffset]=data.get(dataCoordInfo.baseDim,idx),stackedData[1-baseDataOffset]=value,coordSys.dataToPoint(stackedData)}function diffData(oldData,newData){var diffResult=[];return newData.diff(oldData).add(function(idx){diffResult.push({cmd:`+`,idx})}).update(function(newIdx,oldIdx){diffResult.push({cmd:`=`,idx:oldIdx,idx1:newIdx})}).remove(function(idx){diffResult.push({cmd:`-`,idx})}).execute(),diffResult}function lineAnimationDiff(oldData,newData,oldStackedOnPoints,newStackedOnPoints,oldCoordSys,newCoordSys,oldValueOrigin,newValueOrigin){for(var diff=diffData(oldData,newData),currPoints=[],nextPoints=[],currStackedPoints=[],nextStackedPoints=[],status=[],sortedIndices=[],rawIndices=[],newDataOldCoordInfo=prepareDataCoordInfo(oldCoordSys,newData,oldValueOrigin),oldPoints=oldData.getLayout(`points`)||[],newPoints=newData.getLayout(`points`)||[],i$1=0;i$1<diff.length;i$1++){var diffItem=diff[i$1],pointAdded=!0,oldIdx2=void 0,newIdx2=void 0;switch(diffItem.cmd){case`=`:oldIdx2=diffItem.idx*2,newIdx2=diffItem.idx1*2;var currentX=oldPoints[oldIdx2],currentY=oldPoints[oldIdx2+1],nextX=newPoints[newIdx2],nextY=newPoints[newIdx2+1];(isNaN(currentX)||isNaN(currentY))&&(currentX=nextX,currentY=nextY),currPoints.push(currentX,currentY),nextPoints.push(nextX,nextY),currStackedPoints.push(oldStackedOnPoints[oldIdx2],oldStackedOnPoints[oldIdx2+1]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(diffItem.idx1));break;case`+`:var newIdx=diffItem.idx,newDataDimsForPoint=newDataOldCoordInfo.dataDimsForPoint,oldPt=oldCoordSys.dataToPoint([newData.get(newDataDimsForPoint[0],newIdx),newData.get(newDataDimsForPoint[1],newIdx)]);newIdx2=newIdx*2,currPoints.push(oldPt[0],oldPt[1]),nextPoints.push(newPoints[newIdx2],newPoints[newIdx2+1]);var stackedOnPoint=getStackedOnPoint(newDataOldCoordInfo,oldCoordSys,newData,newIdx);currStackedPoints.push(stackedOnPoint[0],stackedOnPoint[1]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(newIdx));break;case`-`:pointAdded=!1}pointAdded&&(status.push(diffItem),sortedIndices.push(sortedIndices.length))}sortedIndices.sort(function(a$1,b$1){return rawIndices[a$1]-rawIndices[b$1]});for(var len$1=currPoints.length,sortedCurrPoints=createFloat32Array(len$1),sortedNextPoints=createFloat32Array(len$1),sortedCurrStackedPoints=createFloat32Array(len$1),sortedNextStackedPoints=createFloat32Array(len$1),sortedStatus=[],i$1=0;i$1<sortedIndices.length;i$1++){var idx=sortedIndices[i$1],i2=i$1*2,idx2=idx*2;sortedCurrPoints[i2]=currPoints[idx2],sortedCurrPoints[i2+1]=currPoints[idx2+1],sortedNextPoints[i2]=nextPoints[idx2],sortedNextPoints[i2+1]=nextPoints[idx2+1],sortedCurrStackedPoints[i2]=currStackedPoints[idx2],sortedCurrStackedPoints[i2+1]=currStackedPoints[idx2+1],sortedNextStackedPoints[i2]=nextStackedPoints[idx2],sortedNextStackedPoints[i2+1]=nextStackedPoints[idx2+1],sortedStatus[i$1]=status[idx]}return{current:sortedCurrPoints,next:sortedNextPoints,stackedOnCurrent:sortedCurrStackedPoints,stackedOnNext:sortedNextStackedPoints,status:sortedStatus}}var mathMin$1=Math.min,mathMax$2=Math.max;function isPointNull$1(x$1,y$1){return isNaN(x$1)||isNaN(y$1)}function drawSegment(ctx,points$1,start$1,segLen,allLen,dir,smooth,smoothMonotone,connectNulls){for(var prevX,prevY,cpx0,cpy0,cpx1,cpy1,idx=start$1,k$1=0;k$1<segLen;k$1++){var x$1=points$1[idx*2],y$1=points$1[idx*2+1];if(idx>=allLen||idx<0)break;if(isPointNull$1(x$1,y$1)){if(connectNulls){idx+=dir;continue}break}if(idx===start$1)ctx[dir>0?`moveTo`:`lineTo`](x$1,y$1),cpx0=x$1,cpy0=y$1;else{var dx=x$1-prevX,dy=y$1-prevY;if(dx*dx+dy*dy<.5){idx+=dir;continue}if(smooth>0){for(var nextIdx=idx+dir,nextX=points$1[nextIdx*2],nextY=points$1[nextIdx*2+1];nextX===x$1&&nextY===y$1&&k$1<segLen;)k$1++,nextIdx+=dir,idx+=dir,nextX=points$1[nextIdx*2],nextY=points$1[nextIdx*2+1],x$1=points$1[idx*2],y$1=points$1[idx*2+1],dx=x$1-prevX,dy=y$1-prevY;var tmpK=k$1+1;if(connectNulls)for(;isPointNull$1(nextX,nextY)&&tmpK<segLen;)tmpK++,nextIdx+=dir,nextX=points$1[nextIdx*2],nextY=points$1[nextIdx*2+1];var ratioNextSeg=.5,vx$1=0,vy$1=0,nextCpx0=void 0,nextCpy0=void 0;if(tmpK>=segLen||isPointNull$1(nextX,nextY))cpx1=x$1,cpy1=y$1;else{vx$1=nextX-prevX,vy$1=nextY-prevY;var dx0=x$1-prevX,dx1=nextX-x$1,dy0=y$1-prevY,dy1=nextY-y$1,lenPrevSeg=void 0,lenNextSeg=void 0;if(smoothMonotone===`x`){lenPrevSeg=Math.abs(dx0),lenNextSeg=Math.abs(dx1);var dir_1=vx$1>0?1:-1;cpx1=x$1-dir_1*lenPrevSeg*smooth,cpy1=y$1,nextCpx0=x$1+dir_1*lenNextSeg*smooth,nextCpy0=y$1}else if(smoothMonotone===`y`){lenPrevSeg=Math.abs(dy0),lenNextSeg=Math.abs(dy1);var dir_2=vy$1>0?1:-1;cpx1=x$1,cpy1=y$1-dir_2*lenPrevSeg*smooth,nextCpx0=x$1,nextCpy0=y$1+dir_2*lenNextSeg*smooth}else lenPrevSeg=Math.sqrt(dx0*dx0+dy0*dy0),lenNextSeg=Math.sqrt(dx1*dx1+dy1*dy1),ratioNextSeg=lenNextSeg/(lenNextSeg+lenPrevSeg),cpx1=x$1-vx$1*smooth*(1-ratioNextSeg),cpy1=y$1-vy$1*smooth*(1-ratioNextSeg),nextCpx0=x$1+vx$1*smooth*ratioNextSeg,nextCpy0=y$1+vy$1*smooth*ratioNextSeg,nextCpx0=mathMin$1(nextCpx0,mathMax$2(nextX,x$1)),nextCpy0=mathMin$1(nextCpy0,mathMax$2(nextY,y$1)),nextCpx0=mathMax$2(nextCpx0,mathMin$1(nextX,x$1)),nextCpy0=mathMax$2(nextCpy0,mathMin$1(nextY,y$1)),vx$1=nextCpx0-x$1,vy$1=nextCpy0-y$1,cpx1=x$1-vx$1*lenPrevSeg/lenNextSeg,cpy1=y$1-vy$1*lenPrevSeg/lenNextSeg,cpx1=mathMin$1(cpx1,mathMax$2(prevX,x$1)),cpy1=mathMin$1(cpy1,mathMax$2(prevY,y$1)),cpx1=mathMax$2(cpx1,mathMin$1(prevX,x$1)),cpy1=mathMax$2(cpy1,mathMin$1(prevY,y$1)),vx$1=x$1-cpx1,vy$1=y$1-cpy1,nextCpx0=x$1+vx$1*lenNextSeg/lenPrevSeg,nextCpy0=y$1+vy$1*lenNextSeg/lenPrevSeg}ctx.bezierCurveTo(cpx0,cpy0,cpx1,cpy1,x$1,y$1),cpx0=nextCpx0,cpy0=nextCpy0}else ctx.lineTo(x$1,y$1)}prevX=x$1,prevY=y$1,idx+=dir}return k$1}var ECPolylineShape=function(){function ECPolylineShape$1(){this.smooth=0,this.smoothConstraint=!0}return ECPolylineShape$1}(),ECPolyline=function(_super){__extends(ECPolyline$1,_super);function ECPolyline$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`ec-polyline`,_this}return ECPolyline$1.prototype.getDefaultStyle=function(){return{stroke:tokens_default.color.neutral99,fill:null}},ECPolyline$1.prototype.getDefaultShape=function(){return new ECPolylineShape},ECPolyline$1.prototype.buildPath=function(ctx,shape){var points$1=shape.points,i$1=0,len$1=points$1.length/2;if(shape.connectNulls){for(;len$1>0&&isPointNull$1(points$1[len$1*2-2],points$1[len$1*2-1]);len$1--);for(;i$1<len$1&&isPointNull$1(points$1[i$1*2],points$1[i$1*2+1]);i$1++);}for(;i$1<len$1;)i$1+=drawSegment(ctx,points$1,i$1,len$1,len$1,1,shape.smooth,shape.smoothMonotone,shape.connectNulls)+1},ECPolyline$1.prototype.getPointOn=function(xOrY,dim){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var data=this.path.data,CMD$3=PathProxy_default.CMD,x0,y0,isDimX=dim===`x`,roots$1=[],i$1=0;i$1<data.length;){var cmd=data[i$1++],x$1=void 0,y$1=void 0,x2=void 0,y2=void 0,x3=void 0,y3=void 0,t$1=void 0;switch(cmd){case CMD$3.M:x0=data[i$1++],y0=data[i$1++];break;case CMD$3.L:if(x$1=data[i$1++],y$1=data[i$1++],t$1=isDimX?(xOrY-x0)/(x$1-x0):(xOrY-y0)/(y$1-y0),t$1<=1&&t$1>=0){var val=isDimX?(y$1-y0)*t$1+y0:(x$1-x0)*t$1+x0;return isDimX?[xOrY,val]:[val,xOrY]}x0=x$1,y0=y$1;break;case CMD$3.C:x$1=data[i$1++],y$1=data[i$1++],x2=data[i$1++],y2=data[i$1++],x3=data[i$1++],y3=data[i$1++];var nRoot=isDimX?cubicRootAt(x0,x$1,x2,x3,xOrY,roots$1):cubicRootAt(y0,y$1,y2,y3,xOrY,roots$1);if(nRoot>0)for(var i_1=0;i_1<nRoot;i_1++){var t_1=roots$1[i_1];if(t_1<=1&&t_1>=0){var val=isDimX?cubicAt(y0,y$1,y2,y3,t_1):cubicAt(x0,x$1,x2,x3,t_1);return isDimX?[xOrY,val]:[val,xOrY]}}x0=x3,y0=y3;break}}},ECPolyline$1}(Path_default),ECPolygonShape=function(_super){__extends(ECPolygonShape$1,_super);function ECPolygonShape$1(){return _super!==null&&_super.apply(this,arguments)||this}return ECPolygonShape$1}(ECPolylineShape),ECPolygon=function(_super){__extends(ECPolygon$1,_super);function ECPolygon$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`ec-polygon`,_this}return ECPolygon$1.prototype.getDefaultShape=function(){return new ECPolygonShape},ECPolygon$1.prototype.buildPath=function(ctx,shape){var points$1=shape.points,stackedOnPoints=shape.stackedOnPoints,i$1=0,len$1=points$1.length/2,smoothMonotone=shape.smoothMonotone;if(shape.connectNulls){for(;len$1>0&&isPointNull$1(points$1[len$1*2-2],points$1[len$1*2-1]);len$1--);for(;i$1<len$1&&isPointNull$1(points$1[i$1*2],points$1[i$1*2+1]);i$1++);}for(;i$1<len$1;){var k$1=drawSegment(ctx,points$1,i$1,len$1,len$1,1,shape.smooth,smoothMonotone,shape.connectNulls);drawSegment(ctx,stackedOnPoints,i$1+k$1-1,k$1,len$1,-1,shape.stackedOnSmooth,smoothMonotone,shape.connectNulls),i$1+=k$1+1,ctx.closePath()}},ECPolygon$1}(Path_default);function createGridClipPath(cartesian,hasAnimation,seriesModel,done,during){var rect=cartesian.getArea(),x$1=rect.x,y$1=rect.y,width=rect.width,height=rect.height,lineWidth=seriesModel.get([`lineStyle`,`width`])||0;x$1-=lineWidth/2,y$1-=lineWidth/2,width+=lineWidth,height+=lineWidth,width=Math.ceil(width),x$1!==Math.floor(x$1)&&(x$1=Math.floor(x$1),width++);var clipPath=new Rect_default({shape:{x:x$1,y:y$1,width,height}});if(hasAnimation){var baseAxis=cartesian.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isAxisInversed=baseAxis.inverse;isHorizontal?(isAxisInversed&&(clipPath.shape.x+=width),clipPath.shape.width=0):(isAxisInversed||(clipPath.shape.y+=height),clipPath.shape.height=0);var duringCb=isFunction(during)?function(percent){during(percent,clipPath)}:null;initProps(clipPath,{shape:{width,height,x:x$1,y:y$1}},seriesModel,null,done,duringCb)}return clipPath}function createPolarClipPath(polar,hasAnimation,seriesModel){var sectorArea=polar.getArea(),r0=round(sectorArea.r0,1),r$1=round(sectorArea.r,1),clipPath=new Sector_default({shape:{cx:round(polar.cx,1),cy:round(polar.cy,1),r0,r:r$1,startAngle:sectorArea.startAngle,endAngle:sectorArea.endAngle,clockwise:sectorArea.clockwise}});return hasAnimation&&(polar.getBaseAxis().dim===`angle`?clipPath.shape.endAngle=sectorArea.startAngle:clipPath.shape.r=r0,initProps(clipPath,{shape:{endAngle:sectorArea.endAngle,r:r$1}},seriesModel)),clipPath}function createClipPath(coordSys,hasAnimation,seriesModel,done,during){if(coordSys){if(coordSys.type===`polar`)return createPolarClipPath(coordSys,hasAnimation,seriesModel);if(coordSys.type===`cartesian2d`)return createGridClipPath(coordSys,hasAnimation,seriesModel,done,during)}else return null;return null}function isCoordinateSystemType(coordSys,type){return coordSys.type===type}function isPointsSame(points1,points2){if(points1.length===points2.length){for(var i$1=0;i$1<points1.length;i$1++)if(points1[i$1]!==points2[i$1])return;return!0}}function bboxFromPoints(points$1){for(var minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,i$1=0;i$1<points$1.length;){var x$1=points$1[i$1++],y$1=points$1[i$1++];isNaN(x$1)||(minX=Math.min(x$1,minX),maxX=Math.max(x$1,maxX)),isNaN(y$1)||(minY=Math.min(y$1,minY),maxY=Math.max(y$1,maxY))}return[[minX,minY],[maxX,maxY]]}function getBoundingDiff(points1,points2){var _a$1=bboxFromPoints(points1),min1=_a$1[0],max1=_a$1[1],_b$1=bboxFromPoints(points2),min2$1=_b$1[0],max2$1=_b$1[1];return Math.max(Math.abs(min1[0]-min2$1[0]),Math.abs(min1[1]-min2$1[1]),Math.abs(max1[0]-max2$1[0]),Math.abs(max1[1]-max2$1[1]))}function getSmooth(smooth){return isNumber(smooth)?smooth:smooth?.5:0}function getStackedOnPoints(coordSys,data,dataCoordInfo){if(!dataCoordInfo.valueDim)return[];for(var len$1=data.count(),points$1=createFloat32Array(len$1*2),idx=0;idx<len$1;idx++){var pt=getStackedOnPoint(dataCoordInfo,coordSys,data,idx);points$1[idx*2]=pt[0],points$1[idx*2+1]=pt[1]}return points$1}function turnPointsIntoStep(points$1,basePoints,coordSys,stepTurnAt,connectNulls){var baseAxis=coordSys.getBaseAxis(),baseIndex=baseAxis.dim===`x`||baseAxis.dim===`radius`?0:1,stepPoints=[],i$1=0,stepPt=[],pt=[],nextPt=[],filteredPoints=[];if(connectNulls){for(i$1=0;i$1<points$1.length;i$1+=2){var reference=basePoints||points$1;!isNaN(reference[i$1])&&!isNaN(reference[i$1+1])&&filteredPoints.push(points$1[i$1],points$1[i$1+1])}points$1=filteredPoints}for(i$1=0;i$1<points$1.length-2;i$1+=2)switch(nextPt[0]=points$1[i$1+2],nextPt[1]=points$1[i$1+3],pt[0]=points$1[i$1],pt[1]=points$1[i$1+1],stepPoints.push(pt[0],pt[1]),stepTurnAt){case`end`:stepPt[baseIndex]=nextPt[baseIndex],stepPt[1-baseIndex]=pt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]);break;case`middle`:var middle=(pt[baseIndex]+nextPt[baseIndex])/2,stepPt2=[];stepPt[baseIndex]=stepPt2[baseIndex]=middle,stepPt[1-baseIndex]=pt[1-baseIndex],stepPt2[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]),stepPoints.push(stepPt2[0],stepPt2[1]);break;default:stepPt[baseIndex]=pt[baseIndex],stepPt[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1])}return stepPoints.push(points$1[i$1++],points$1[i$1++]),stepPoints}function clipColorStops(colorStops,maxSize){var newColorStops=[],len$1=colorStops.length,prevOutOfRangeColorStop,prevInRangeColorStop;function lerpStop(stop0,stop1,clippedCoord){var coord0=stop0.coord,p$2=(clippedCoord-coord0)/(stop1.coord-coord0),color$2=lerp(p$2,[stop0.color,stop1.color]);return{coord:clippedCoord,color:color$2}}for(var i$1=0;i$1<len$1;i$1++){var stop_1=colorStops[i$1],coord=stop_1.coord;if(coord<0)prevOutOfRangeColorStop=stop_1;else if(coord>maxSize){prevInRangeColorStop?newColorStops.push(lerpStop(prevInRangeColorStop,stop_1,maxSize)):prevOutOfRangeColorStop&&newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0),lerpStop(prevOutOfRangeColorStop,stop_1,maxSize));break}else prevOutOfRangeColorStop&&=(newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0)),null),newColorStops.push(stop_1),prevInRangeColorStop=stop_1}return newColorStops}function getVisualGradient(data,coordSys,api){var visualMetaList=data.getVisual(`visualMeta`);if(!(!visualMetaList||!visualMetaList.length||!data.count())&&coordSys.type===`cartesian2d`){for(var coordDim,visualMeta,i$1=visualMetaList.length-1;i$1>=0;i$1--){var dimInfo=data.getDimensionInfo(visualMetaList[i$1].dimension);if(coordDim=dimInfo&&dimInfo.coordDim,coordDim===`x`||coordDim===`y`){visualMeta=visualMetaList[i$1];break}}if(visualMeta){var axis=coordSys.getAxis(coordDim),colorStops=map(visualMeta.stops,function(stop$2){return{coord:axis.toGlobalCoord(axis.dataToCoord(stop$2.value)),color:stop$2.color}}),stopLen=colorStops.length,outerColors=visualMeta.outerColors.slice();stopLen&&colorStops[0].coord>colorStops[stopLen-1].coord&&(colorStops.reverse(),outerColors.reverse());var colorStopsInRange=clipColorStops(colorStops,coordDim===`x`?api.getWidth():api.getHeight()),inRangeStopLen=colorStopsInRange.length;if(!inRangeStopLen&&stopLen)return colorStops[0].coord<0?outerColors[1]?outerColors[1]:colorStops[stopLen-1].color:outerColors[0]?outerColors[0]:colorStops[0].color;var tinyExtent=10,minCoord=colorStopsInRange[0].coord-tinyExtent,maxCoord=colorStopsInRange[inRangeStopLen-1].coord+tinyExtent,coordSpan=maxCoord-minCoord;if(coordSpan<.001)return`transparent`;each(colorStopsInRange,function(stop$2){stop$2.offset=(stop$2.coord-minCoord)/coordSpan}),colorStopsInRange.push({offset:inRangeStopLen?colorStopsInRange[inRangeStopLen-1].offset:.5,color:outerColors[1]||`transparent`}),colorStopsInRange.unshift({offset:inRangeStopLen?colorStopsInRange[0].offset:.5,color:outerColors[0]||`transparent`});var gradient=new LinearGradient_default(0,0,0,0,colorStopsInRange,!0);return gradient[coordDim]=minCoord,gradient[coordDim+`2`]=maxCoord,gradient}}}function getIsIgnoreFunc(seriesModel,data,coordSys){var showAllSymbol=seriesModel.get(`showAllSymbol`),isAuto=showAllSymbol===`auto`;if(!(showAllSymbol&&!isAuto)){var categoryAxis$1=coordSys.getAxesByScale(`ordinal`)[0];if(categoryAxis$1&&!(isAuto&&canShowAllSymbolForCategory(categoryAxis$1,data))){var categoryDataDim=data.mapDimension(categoryAxis$1.dim),labelMap={};return each(categoryAxis$1.getViewLabels(),function(labelItem){var ordinalNumber=categoryAxis$1.scale.getRawOrdinalNumber(labelItem.tickValue);labelMap[ordinalNumber]=1}),function(dataIndex){return!labelMap.hasOwnProperty(data.get(categoryDataDim,dataIndex))}}}}function canShowAllSymbolForCategory(categoryAxis$1,data){var axisExtent=categoryAxis$1.getExtent(),availSize=Math.abs(axisExtent[1]-axisExtent[0])/categoryAxis$1.scale.count();isNaN(availSize)&&(availSize=0);for(var dataLen=data.count(),step=Math.max(1,Math.round(dataLen/5)),dataIndex=0;dataIndex<dataLen;dataIndex+=step)if(Symbol_default.getSymbolSize(data,dataIndex)[categoryAxis$1.isHorizontal()?1:0]*1.5>availSize)return!1;return!0}function isPointNull(x$1,y$1){return isNaN(x$1)||isNaN(y$1)}function getLastIndexNotNull(points$1){for(var len$1=points$1.length/2;len$1>0&&isPointNull(points$1[len$1*2-2],points$1[len$1*2-1]);len$1--);return len$1-1}function getPointAtIndex(points$1,idx){return[points$1[idx*2],points$1[idx*2+1]]}function getIndexRange(points$1,xOrY,dim){for(var len$1=points$1.length/2,dimIdx=dim===`x`?0:1,a$1,b$1,prevIndex=0,nextIndex=-1,i$1=0;i$1<len$1;i$1++)if(b$1=points$1[i$1*2+dimIdx],!(isNaN(b$1)||isNaN(points$1[i$1*2+1-dimIdx]))){if(i$1===0){a$1=b$1;continue}if(a$1<=xOrY&&b$1>=xOrY||a$1>=xOrY&&b$1<=xOrY){nextIndex=i$1;break}prevIndex=i$1,a$1=b$1}return{range:[prevIndex,nextIndex],t:(xOrY-a$1)/(b$1-a$1)}}function anyStateShowEndLabel(seriesModel){if(seriesModel.get([`endLabel`,`show`]))return!0;for(var i$1=0;i$1<SPECIAL_STATES.length;i$1++)if(seriesModel.get([SPECIAL_STATES[i$1],`endLabel`,`show`]))return!0;return!1}function createLineClipPath(lineView,coordSys,hasAnimation,seriesModel){if(isCoordinateSystemType(coordSys,`cartesian2d`)){var endLabelModel_1=seriesModel.getModel(`endLabel`),valueAnimation_1=endLabelModel_1.get(`valueAnimation`),data_1=seriesModel.getData(),labelAnimationRecord_1={lastFrameIndex:0},during=anyStateShowEndLabel(seriesModel)?function(percent,clipRect){lineView._endLabelOnDuring(percent,clipRect,data_1,labelAnimationRecord_1,valueAnimation_1,endLabelModel_1,coordSys)}:null,isHorizontal=coordSys.getBaseAxis().isHorizontal(),clipPath=createGridClipPath(coordSys,hasAnimation,seriesModel,function(){var endLabel=lineView._endLabel;endLabel&&hasAnimation&&labelAnimationRecord_1.originalX!=null&&endLabel.attr({x:labelAnimationRecord_1.originalX,y:labelAnimationRecord_1.originalY})},during);if(!seriesModel.get(`clip`,!0)){var rectShape=clipPath.shape,expandSize=Math.max(rectShape.width,rectShape.height);isHorizontal?(rectShape.y-=expandSize,rectShape.height+=expandSize*2):(rectShape.x-=expandSize,rectShape.width+=expandSize*2)}return during&&during(1,clipPath),clipPath}else return createPolarClipPath(coordSys,hasAnimation,seriesModel)}function getEndLabelStateSpecified(endLabelModel,coordSys){var baseAxis=coordSys.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isBaseInversed=baseAxis.inverse,align=isHorizontal?isBaseInversed?`right`:`left`:`center`,verticalAlign=isHorizontal?`middle`:isBaseInversed?`top`:`bottom`;return{normal:{align:endLabelModel.get(`align`)||align,verticalAlign:endLabelModel.get(`verticalAlign`)||verticalAlign}}}var LineView_default=function(_super){__extends(LineView$1,_super);function LineView$1(){return _super!==null&&_super.apply(this,arguments)||this}return LineView$1.prototype.init=function(){var lineGroup=new Group_default,symbolDraw=new SymbolDraw_default;this.group.add(symbolDraw.group),this._symbolDraw=symbolDraw,this._lineGroup=lineGroup,this._changePolyState=bind(this._changePolyState,this)},LineView$1.prototype.render=function(seriesModel,ecModel,api){var coordSys=seriesModel.coordinateSystem,group=this.group,data=seriesModel.getData(),lineStyleModel=seriesModel.getModel(`lineStyle`),areaStyleModel=seriesModel.getModel(`areaStyle`),points$1=data.getLayout(`points`)||[],isCoordSysPolar=coordSys.type===`polar`,prevCoordSys=this._coordSys,symbolDraw=this._symbolDraw,polyline=this._polyline,polygon=this._polygon,lineGroup=this._lineGroup,hasAnimation=!ecModel.ssr&&seriesModel.get(`animation`),isAreaChart=!areaStyleModel.isEmpty(),valueOrigin=areaStyleModel.get(`origin`),dataCoordInfo=prepareDataCoordInfo(coordSys,data,valueOrigin),stackedOnPoints=isAreaChart&&getStackedOnPoints(coordSys,data,dataCoordInfo),showSymbol=seriesModel.get(`showSymbol`),connectNulls=seriesModel.get(`connectNulls`),isIgnoreFunc=showSymbol&&!isCoordSysPolar&&getIsIgnoreFunc(seriesModel,data,coordSys),oldData=this._data;oldData&&oldData.eachItemGraphicEl(function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))}),showSymbol||symbolDraw.remove(),group.add(lineGroup);var step=isCoordSysPolar?!1:seriesModel.get(`step`),clipShapeForSymbol;coordSys&&coordSys.getArea&&seriesModel.get(`clip`,!0)&&(clipShapeForSymbol=coordSys.getArea(),clipShapeForSymbol.width==null?clipShapeForSymbol.r0&&(clipShapeForSymbol.r0-=.5,clipShapeForSymbol.r+=.5):(clipShapeForSymbol.x-=.1,clipShapeForSymbol.y-=.1,clipShapeForSymbol.width+=.2,clipShapeForSymbol.height+=.2)),this._clipShapeForSymbol=clipShapeForSymbol;var visualColor=getVisualGradient(data,coordSys,api)||data.getVisual(`style`)[data.getVisual(`drawType`)];if(!(polyline&&prevCoordSys.type===coordSys.type&&step===this._step))showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points$1[idx*2],points$1[idx*2+1]]}}),hasAnimation&&this._initSymbolLabelAnimation(data,coordSys,clipShapeForSymbol),step&&(stackedOnPoints&&=turnPointsIntoStep(stackedOnPoints,points$1,coordSys,step,connectNulls),points$1=turnPointsIntoStep(points$1,null,coordSys,step,connectNulls)),polyline=this._newPolyline(points$1),isAreaChart?polygon=this._newPolygon(points$1,stackedOnPoints):polygon&&=(lineGroup.remove(polygon),this._polygon=null),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor)),lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel));else{isAreaChart&&!polygon?polygon=this._newPolygon(points$1,stackedOnPoints):polygon&&!isAreaChart&&(lineGroup.remove(polygon),polygon=this._polygon=null),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor));var oldClipPath=lineGroup.getClipPath();if(oldClipPath){var newClipPath=createLineClipPath(this,coordSys,!1,seriesModel);initProps(oldClipPath,{shape:newClipPath.shape},seriesModel)}else lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel));showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points$1[idx*2],points$1[idx*2+1]]}}),(!isPointsSame(this._stackedOnPoints,stackedOnPoints)||!isPointsSame(this._points,points$1))&&(hasAnimation?this._doUpdateAnimation(data,stackedOnPoints,coordSys,api,step,valueOrigin,connectNulls):(step&&(stackedOnPoints&&=turnPointsIntoStep(stackedOnPoints,points$1,coordSys,step,connectNulls),points$1=turnPointsIntoStep(points$1,null,coordSys,step,connectNulls)),polyline.setShape({points:points$1}),polygon&&polygon.setShape({points:points$1,stackedOnPoints})))}var emphasisModel=seriesModel.getModel(`emphasis`),focus=emphasisModel.get(`focus`),blurScope=emphasisModel.get(`blurScope`),emphasisDisabled=emphasisModel.get(`disabled`);if(polyline.useStyle(defaults(lineStyleModel.getLineStyle(),{fill:`none`,stroke:visualColor,lineJoin:`bevel`})),setStatesStylesFromModel(polyline,seriesModel,`lineStyle`),polyline.style.lineWidth>0&&seriesModel.get([`emphasis`,`lineStyle`,`width`])===`bolder`){var emphasisLineStyle=polyline.getState(`emphasis`).style;emphasisLineStyle.lineWidth=+polyline.style.lineWidth+1}getECData(polyline).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polyline,focus,blurScope,emphasisDisabled);var smooth=getSmooth(seriesModel.get(`smooth`)),smoothMonotone=seriesModel.get(`smoothMonotone`);if(polyline.setShape({smooth,smoothMonotone,connectNulls}),polygon){var stackedOnSeries=data.getCalculationInfo(`stackedOnSeries`),stackedOnSmooth=0;polygon.useStyle(defaults(areaStyleModel.getAreaStyle(),{fill:visualColor,opacity:.7,lineJoin:`bevel`,decal:data.getVisual(`style`).decal})),stackedOnSeries&&(stackedOnSmooth=getSmooth(stackedOnSeries.get(`smooth`))),polygon.setShape({smooth,stackedOnSmooth,smoothMonotone,connectNulls}),setStatesStylesFromModel(polygon,seriesModel,`areaStyle`),getECData(polygon).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polygon,focus,blurScope,emphasisDisabled)}var changePolyState=this._changePolyState;data.eachItemGraphicEl(function(el){el&&(el.onHoverStateChange=changePolyState)}),this._polyline.onHoverStateChange=changePolyState,this._data=data,this._coordSys=coordSys,this._stackedOnPoints=stackedOnPoints,this._points=points$1,this._step=step,this._valueOrigin=valueOrigin,seriesModel.get(`triggerLineEvent`)&&(this.packEventData(seriesModel,polyline),polygon&&this.packEventData(seriesModel,polygon))},LineView$1.prototype.packEventData=function(seriesModel,el){getECData(el).eventData={componentType:`series`,componentSubType:`line`,componentIndex:seriesModel.componentIndex,seriesIndex:seriesModel.seriesIndex,seriesName:seriesModel.name,seriesType:`line`}},LineView$1.prototype.highlight=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);if(this._changePolyState(`emphasis`),!(dataIndex instanceof Array)&&dataIndex!=null&&dataIndex>=0){var points$1=data.getLayout(`points`),symbol=data.getItemGraphicEl(dataIndex);if(!symbol){var x$1=points$1[dataIndex*2],y$1=points$1[dataIndex*2+1];if(isNaN(x$1)||isNaN(y$1)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(x$1,y$1))return;var zlevel=seriesModel.get(`zlevel`)||0,z=seriesModel.get(`z`)||0;symbol=new Symbol_default(data,dataIndex),symbol.x=x$1,symbol.y=y$1,symbol.setZ(zlevel,z);var symbolLabel=symbol.getSymbolPath().getTextContent();symbolLabel&&(symbolLabel.zlevel=zlevel,symbolLabel.z=z,symbolLabel.z2=this._polyline.z2+1),symbol.__temp=!0,data.setItemGraphicEl(dataIndex,symbol),symbol.stopSymbolAnimation(!0),this.group.add(symbol)}symbol.highlight()}else Chart_default.prototype.highlight.call(this,seriesModel,ecModel,api,payload)},LineView$1.prototype.downplay=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);if(this._changePolyState(`normal`),dataIndex!=null&&dataIndex>=0){var symbol=data.getItemGraphicEl(dataIndex);symbol&&(symbol.__temp?(data.setItemGraphicEl(dataIndex,null),this.group.remove(symbol)):symbol.downplay())}else Chart_default.prototype.downplay.call(this,seriesModel,ecModel,api,payload)},LineView$1.prototype._changePolyState=function(toState){var polygon=this._polygon;setStatesFlag(this._polyline,toState),polygon&&setStatesFlag(polygon,toState)},LineView$1.prototype._newPolyline=function(points$1){var polyline=this._polyline;return polyline&&this._lineGroup.remove(polyline),polyline=new ECPolyline({shape:{points:points$1},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(polyline),this._polyline=polyline,polyline},LineView$1.prototype._newPolygon=function(points$1,stackedOnPoints){var polygon=this._polygon;return polygon&&this._lineGroup.remove(polygon),polygon=new ECPolygon({shape:{points:points$1,stackedOnPoints},segmentIgnoreThreshold:2}),this._lineGroup.add(polygon),this._polygon=polygon,polygon},LineView$1.prototype._initSymbolLabelAnimation=function(data,coordSys,clipShape){var isHorizontalOrRadial,isCoordSysPolar,baseAxis=coordSys.getBaseAxis(),isAxisInverse=baseAxis.inverse;coordSys.type===`cartesian2d`?(isHorizontalOrRadial=baseAxis.isHorizontal(),isCoordSysPolar=!1):coordSys.type===`polar`&&(isHorizontalOrRadial=baseAxis.dim===`angle`,isCoordSysPolar=!0);var seriesModel=data.hostModel,seriesDuration=seriesModel.get(`animationDuration`);isFunction(seriesDuration)&&(seriesDuration=seriesDuration(null));var seriesDelay=seriesModel.get(`animationDelay`)||0,seriesDelayValue=isFunction(seriesDelay)?seriesDelay(null):seriesDelay;data.eachItemGraphicEl(function(symbol,idx){var el=symbol;if(el){var point=[symbol.x,symbol.y],start$1=void 0,end$1=void 0,current=void 0;if(clipShape)if(isCoordSysPolar){var polarClip=clipShape,coord=coordSys.pointToCoord(point);isHorizontalOrRadial?(start$1=polarClip.startAngle,end$1=polarClip.endAngle,current=-coord[1]/180*Math.PI):(start$1=polarClip.r0,end$1=polarClip.r,current=coord[0])}else{var gridClip=clipShape;isHorizontalOrRadial?(start$1=gridClip.x,end$1=gridClip.x+gridClip.width,current=symbol.x):(start$1=gridClip.y+gridClip.height,end$1=gridClip.y,current=symbol.y)}var ratio=end$1===start$1?0:(current-start$1)/(end$1-start$1);isAxisInverse&&(ratio=1-ratio);var delay=isFunction(seriesDelay)?seriesDelay(idx):seriesDuration*ratio+seriesDelayValue,symbolPath=el.getSymbolPath(),text=symbolPath.getTextContent();el.attr({scaleX:0,scaleY:0}),el.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay}),text&&text.animateFrom({style:{opacity:0}},{duration:300,delay}),symbolPath.disableLabelAnimation=!0}})},LineView$1.prototype._initOrUpdateEndLabel=function(seriesModel,coordSys,inheritColor){var endLabelModel=seriesModel.getModel(`endLabel`);if(anyStateShowEndLabel(seriesModel)){var data_2=seriesModel.getData(),polyline=this._polyline,points$1=data_2.getLayout(`points`);if(!points$1){polyline.removeTextContent(),this._endLabel=null;return}var endLabel=this._endLabel;endLabel||(endLabel=this._endLabel=new Text_default({z2:200}),endLabel.ignoreClip=!0,polyline.setTextContent(this._endLabel),polyline.disableLabelAnimation=!0);var dataIndex=getLastIndexNotNull(points$1);dataIndex>=0&&(setLabelStyle(polyline,getLabelStatesModels(seriesModel,`endLabel`),{inheritColor,labelFetcher:seriesModel,labelDataIndex:dataIndex,defaultText:function(dataIndex$1,opt,interpolatedValue){return interpolatedValue==null?getDefaultLabel(data_2,dataIndex$1):getDefaultInterpolatedLabel(data_2,interpolatedValue)},enableTextSetter:!0},getEndLabelStateSpecified(endLabelModel,coordSys)),polyline.textConfig.position=null)}else this._endLabel&&=(this._polyline.removeTextContent(),null)},LineView$1.prototype._endLabelOnDuring=function(percent,clipRect,data,animationRecord,valueAnimation,endLabelModel,coordSys){var endLabel=this._endLabel,polyline=this._polyline;if(endLabel){percent<1&&animationRecord.originalX==null&&(animationRecord.originalX=endLabel.x,animationRecord.originalY=endLabel.y);var points$1=data.getLayout(`points`),seriesModel=data.hostModel,connectNulls=seriesModel.get(`connectNulls`),precision=endLabelModel.get(`precision`),distance$1=endLabelModel.get(`distance`)||0,baseAxis=coordSys.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isBaseInversed=baseAxis.inverse,clipShape=clipRect.shape,xOrY=isBaseInversed?isHorizontal?clipShape.x:clipShape.y+clipShape.height:isHorizontal?clipShape.x+clipShape.width:clipShape.y,distanceX=(isHorizontal?distance$1:0)*(isBaseInversed?-1:1),distanceY=(isHorizontal?0:-distance$1)*(isBaseInversed?-1:1),dim=isHorizontal?`x`:`y`,dataIndexRange=getIndexRange(points$1,xOrY,dim),indices=dataIndexRange.range,diff=indices[1]-indices[0],value=void 0;if(diff>=1){if(diff>1&&!connectNulls){var pt=getPointAtIndex(points$1,indices[0]);endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY}),valueAnimation&&(value=seriesModel.getRawValue(indices[0]))}else{var pt=polyline.getPointOn(xOrY,dim);pt&&endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY});var startValue=seriesModel.getRawValue(indices[0]),endValue=seriesModel.getRawValue(indices[1]);valueAnimation&&(value=interpolateRawValues(data,precision,startValue,endValue,dataIndexRange.t))}animationRecord.lastFrameIndex=indices[0]}else{var idx=percent===1||animationRecord.lastFrameIndex>0?indices[0]:0,pt=getPointAtIndex(points$1,idx);valueAnimation&&(value=seriesModel.getRawValue(idx)),endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY})}if(valueAnimation){var inner$11=labelInner(endLabel);typeof inner$11.setLabelText==`function`&&inner$11.setLabelText(value)}}},LineView$1.prototype._doUpdateAnimation=function(data,stackedOnPoints,coordSys,api,step,valueOrigin,connectNulls){var polyline=this._polyline,polygon=this._polygon,seriesModel=data.hostModel,diff=lineAnimationDiff(this._data,data,this._stackedOnPoints,stackedOnPoints,this._coordSys,coordSys,this._valueOrigin,valueOrigin),current=diff.current,stackedOnCurrent=diff.stackedOnCurrent,next=diff.next,stackedOnNext=diff.stackedOnNext;if(step&&(stackedOnCurrent=turnPointsIntoStep(diff.stackedOnCurrent,diff.current,coordSys,step,connectNulls),current=turnPointsIntoStep(diff.current,null,coordSys,step,connectNulls),stackedOnNext=turnPointsIntoStep(diff.stackedOnNext,diff.next,coordSys,step,connectNulls),next=turnPointsIntoStep(diff.next,null,coordSys,step,connectNulls)),getBoundingDiff(current,next)>3e3||polygon&&getBoundingDiff(stackedOnCurrent,stackedOnNext)>3e3){polyline.stopAnimation(),polyline.setShape({points:next}),polygon&&(polygon.stopAnimation(),polygon.setShape({points:next,stackedOnPoints:stackedOnNext}));return}polyline.shape.__points=diff.current,polyline.shape.points=current;var target={shape:{points:next}};diff.current!==current&&(target.shape.__points=diff.next),polyline.stopAnimation(),updateProps$1(polyline,target,seriesModel),polygon&&(polygon.setShape({points:current,stackedOnPoints:stackedOnCurrent}),polygon.stopAnimation(),updateProps$1(polygon,{shape:{stackedOnPoints:stackedOnNext}},seriesModel),polyline.shape.points!==polygon.shape.points&&(polygon.shape.points=polyline.shape.points));for(var updatedDataInfo=[],diffStatus=diff.status,i$1=0;i$1<diffStatus.length;i$1++)if(diffStatus[i$1].cmd===`=`){var el=data.getItemGraphicEl(diffStatus[i$1].idx1);el&&updatedDataInfo.push({el,ptIdx:i$1})}polyline.animators&&polyline.animators.length&&polyline.animators[0].during(function(){polygon&&polygon.dirtyShape();for(var points$1=polyline.shape.__points,i$2=0;i$2<updatedDataInfo.length;i$2++){var el$1=updatedDataInfo[i$2].el,offset=updatedDataInfo[i$2].ptIdx*2;el$1.x=points$1[offset],el$1.y=points$1[offset+1],el$1.markRedraw()}})},LineView$1.prototype.remove=function(ecModel){var group=this.group,oldData=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),oldData&&oldData.eachItemGraphicEl(function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},LineView$1.type=`line`,LineView$1}(Chart_default);function pointsLayout(seriesType$1,forceStoreInTypedArray){return{seriesType:seriesType$1,plan:createRenderPlanner(),reset:function(seriesModel){var data=seriesModel.getData(),coordSys=seriesModel.coordinateSystem,pipelineContext=seriesModel.pipelineContext,useTypedArray=forceStoreInTypedArray||pipelineContext.large;if(coordSys){var dims=map(coordSys.dimensions,function(dim){return data.mapDimension(dim)}).slice(0,2),dimLen=dims.length,stackResultDim=data.getCalculationInfo(`stackResultDimension`);isDimensionStacked(data,dims[0])&&(dims[0]=stackResultDim),isDimensionStacked(data,dims[1])&&(dims[1]=stackResultDim);var store=data.getStore(),dimIdx0=data.getDimensionIndex(dims[0]),dimIdx1=data.getDimensionIndex(dims[1]);return dimLen&&{progress:function(params,data$1){for(var segCount=params.end-params.start,points$1=useTypedArray&&createFloat32Array(segCount*dimLen),tmpIn=[],tmpOut=[],i$1=params.start,offset=0;i$1<params.end;i$1++){var point=void 0;if(dimLen===1){var x$1=store.get(dimIdx0,i$1);point=coordSys.dataToPoint(x$1,null,tmpOut)}else tmpIn[0]=store.get(dimIdx0,i$1),tmpIn[1]=store.get(dimIdx1,i$1),point=coordSys.dataToPoint(tmpIn,null,tmpOut);useTypedArray?(points$1[offset++]=point[0],points$1[offset++]=point[1]):data$1.setItemLayout(i$1,point.slice())}useTypedArray&&data$1.setLayout(`points`,points$1)}}}}}}var samplers={average:function(frame){for(var sum=0,count$1=0,i$1=0;i$1<frame.length;i$1++)isNaN(frame[i$1])||(sum+=frame[i$1],count$1++);return count$1===0?NaN:sum/count$1},sum:function(frame){for(var sum=0,i$1=0;i$1<frame.length;i$1++)sum+=frame[i$1]||0;return sum},max:function(frame){for(var max$2=-1/0,i$1=0;i$1<frame.length;i$1++)frame[i$1]>max$2&&(max$2=frame[i$1]);return isFinite(max$2)?max$2:NaN},min:function(frame){for(var min$2=1/0,i$1=0;i$1<frame.length;i$1++)frame[i$1]<min$2&&(min$2=frame[i$1]);return isFinite(min$2)?min$2:NaN},nearest:function(frame){return frame[0]}},indexSampler=function(frame){return Math.round(frame.length/2)};function dataSample(seriesType$1){return{seriesType:seriesType$1,reset:function(seriesModel,ecModel,api){var data=seriesModel.getData(),sampling=seriesModel.get(`sampling`),coordSys=seriesModel.coordinateSystem,count$1=data.count();if(count$1>10&&coordSys.type===`cartesian2d`&&sampling){var baseAxis=coordSys.getBaseAxis(),valueAxis$1=coordSys.getOtherAxis(baseAxis),extent=baseAxis.getExtent(),dpr$1=api.getDevicePixelRatio(),size=Math.abs(extent[1]-extent[0])*(dpr$1||1),rate=Math.round(count$1/size);if(isFinite(rate)&&rate>1){sampling===`lttb`?seriesModel.setData(data.lttbDownSample(data.mapDimension(valueAxis$1.dim),1/rate)):sampling===`minmax`&&seriesModel.setData(data.minmaxDownSample(data.mapDimension(valueAxis$1.dim),1/rate));var sampler=void 0;isString(sampling)?sampler=samplers[sampling]:isFunction(sampling)&&(sampler=sampling),sampler&&seriesModel.setData(data.downSample(data.mapDimension(valueAxis$1.dim),1/rate,sampler,indexSampler))}}}}}function install$1(registers){registers.registerChartView(LineView_default),registers.registerSeriesModel(LineSeries_default),registers.registerLayout(pointsLayout(`line`,!0)),registers.registerVisual({seriesType:`line`,reset:function(seriesModel){var data=seriesModel.getData(),lineStyle=seriesModel.getModel(`lineStyle`).getLineStyle();lineStyle&&!lineStyle.stroke&&(lineStyle.stroke=data.getVisual(`style`).fill),data.setVisual(`legendLineStyle`,lineStyle)}}),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample(`line`))}var BaseBarSeriesModel=function(_super){__extends(BaseBarSeriesModel$1,_super);function BaseBarSeriesModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=BaseBarSeriesModel$1.type,_this}return BaseBarSeriesModel$1.prototype.getInitialData=function(option,ecModel){return createSeriesData_default(null,this,{useEncodeDefaulter:!0})},BaseBarSeriesModel$1.prototype.getMarkerPosition=function(value,dims,startingAtTick){var coordSys=this.coordinateSystem;if(coordSys&&coordSys.clampData){var clampData_1=coordSys.clampData(value),pt_1=coordSys.dataToPoint(clampData_1);if(startingAtTick)each(coordSys.getAxes(),function(axis,idx){if(axis.type===`category`&&dims!=null){var tickCoords=axis.getTicksCoords(),alignTicksWithLabel=axis.getTickModel().get(`alignWithLabel`),targetTickId=clampData_1[idx],isEnd=dims[idx]===`x1`||dims[idx]===`y1`;if(isEnd&&!alignTicksWithLabel&&(targetTickId+=1),tickCoords.length<2)return;if(tickCoords.length===2){pt_1[idx]=axis.toGlobalCoord(axis.getExtent()[isEnd?1:0]);return}for(var leftCoord=void 0,coord=void 0,stepTickValue=1,i$1=0;i$1<tickCoords.length;i$1++){var tickCoord=tickCoords[i$1].coord,tickValue=i$1===tickCoords.length-1?tickCoords[i$1-1].tickValue+stepTickValue:tickCoords[i$1].tickValue;if(tickValue===targetTickId){coord=tickCoord;break}else if(tickValue<targetTickId)leftCoord=tickCoord;else if(leftCoord!=null&&tickValue>targetTickId){coord=(tickCoord+leftCoord)/2;break}i$1===1&&(stepTickValue=tickValue-tickCoords[0].tickValue)}coord??(leftCoord?leftCoord&&(coord=tickCoords[tickCoords.length-1].coord):coord=tickCoords[0].coord),pt_1[idx]=axis.toGlobalCoord(coord)}});else{var data=this.getData(),offset=data.getLayout(`offset`),size=data.getLayout(`size`),offsetIndex=coordSys.getBaseAxis().isHorizontal()?0:1;pt_1[offsetIndex]+=offset+size/2}return pt_1}return[NaN,NaN]},BaseBarSeriesModel$1.type=`series.__base_bar__`,BaseBarSeriesModel$1.defaultOption={z:2,coordinateSystem:`cartesian2d`,legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:`mod`,defaultBarGap:`10%`},BaseBarSeriesModel$1}(Series_default);Series_default.registerClass(BaseBarSeriesModel);var BaseBarSeries_default=BaseBarSeriesModel,BarSeries_default=function(_super){__extends(BarSeriesModel$1,_super);function BarSeriesModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=BarSeriesModel$1.type,_this}return BarSeriesModel$1.prototype.getInitialData=function(){return createSeriesData_default(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get(`realtimeSort`,!0)||null})},BarSeriesModel$1.prototype.getProgressive=function(){return this.get(`large`)?this.get(`progressive`):!1},BarSeriesModel$1.prototype.getProgressiveThreshold=function(){var progressiveThreshold=this.get(`progressiveThreshold`),largeThreshold=this.get(`largeThreshold`);return largeThreshold>progressiveThreshold&&(progressiveThreshold=largeThreshold),progressiveThreshold},BarSeriesModel$1.prototype.brushSelector=function(dataIndex,data,selectors){return selectors.rect(data.getItemLayout(dataIndex))},BarSeriesModel$1.type=`series.bar`,BarSeriesModel$1.dependencies=[`grid`,`polar`],BarSeriesModel$1.defaultOption=inheritDefaultOption(BaseBarSeries_default.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:`rgba(180, 180, 180, 0.2)`,borderColor:null,borderWidth:0,borderType:`solid`,borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:tokens_default.color.primary,borderWidth:2}},realtimeSort:!1}),BarSeriesModel$1}(BaseBarSeries_default),SausageShape=function(){function SausageShape$1(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return SausageShape$1}(),sausage_default=function(_super){__extends(SausagePath$1,_super);function SausagePath$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`sausage`,_this}return SausagePath$1.prototype.getDefaultShape=function(){return new SausageShape},SausagePath$1.prototype.buildPath=function(ctx,shape){var cx=shape.cx,cy=shape.cy,r0=Math.max(shape.r0||0,0),r$1=Math.max(shape.r,0),dr=(r$1-r0)*.5,rCenter=r0+dr,startAngle=shape.startAngle,endAngle=shape.endAngle,clockwise=shape.clockwise,PI2$6=Math.PI*2,lessThanCircle=clockwise?endAngle-startAngle<PI2$6:startAngle-endAngle<PI2$6;lessThanCircle||(startAngle=endAngle-(clockwise?PI2$6:-PI2$6));var unitStartX=Math.cos(startAngle),unitStartY=Math.sin(startAngle),unitEndX=Math.cos(endAngle),unitEndY=Math.sin(endAngle);lessThanCircle?(ctx.moveTo(unitStartX*r0+cx,unitStartY*r0+cy),ctx.arc(unitStartX*rCenter+cx,unitStartY*rCenter+cy,dr,-Math.PI+startAngle,startAngle,!clockwise)):ctx.moveTo(unitStartX*r$1+cx,unitStartY*r$1+cy),ctx.arc(cx,cy,r$1,startAngle,endAngle,!clockwise),ctx.arc(unitEndX*rCenter+cx,unitEndY*rCenter+cy,dr,endAngle-Math.PI*2,endAngle-Math.PI,!clockwise),r0!==0&&ctx.arc(cx,cy,r0,endAngle,startAngle,clockwise)},SausagePath$1}(Path_default);function createSectorCalculateTextPosition(positionMapping,opts){opts||={};var isRoundCap=opts.isRoundCap;return function(out$2,opts$1,boundingRect){var textPosition=opts$1.position;if(!textPosition||textPosition instanceof Array)return calculateTextPosition(out$2,opts$1,boundingRect);var mappedSectorPosition=positionMapping(textPosition),distance$1=opts$1.distance==null?5:opts$1.distance,sector=this.shape,cx=sector.cx,cy=sector.cy,r$1=sector.r,r0=sector.r0,middleR=(r$1+r0)/2,startAngle=sector.startAngle,endAngle=sector.endAngle,middleAngle=(startAngle+endAngle)/2,extraDist=isRoundCap?Math.abs(r$1-r0)/2:0,mathCos$4=Math.cos,mathSin$4=Math.sin,x$1=cx+r$1*mathCos$4(startAngle),y$1=cy+r$1*mathSin$4(startAngle),textAlign=`left`,textVerticalAlign=`top`;switch(mappedSectorPosition){case`startArc`:x$1=cx+(r0-distance$1)*mathCos$4(middleAngle),y$1=cy+(r0-distance$1)*mathSin$4(middleAngle),textAlign=`center`,textVerticalAlign=`top`;break;case`insideStartArc`:x$1=cx+(r0+distance$1)*mathCos$4(middleAngle),y$1=cy+(r0+distance$1)*mathSin$4(middleAngle),textAlign=`center`,textVerticalAlign=`bottom`;break;case`startAngle`:x$1=cx+middleR*mathCos$4(startAngle)+adjustAngleDistanceX(startAngle,distance$1+extraDist,!1),y$1=cy+middleR*mathSin$4(startAngle)+adjustAngleDistanceY(startAngle,distance$1+extraDist,!1),textAlign=`right`,textVerticalAlign=`middle`;break;case`insideStartAngle`:x$1=cx+middleR*mathCos$4(startAngle)+adjustAngleDistanceX(startAngle,-distance$1+extraDist,!1),y$1=cy+middleR*mathSin$4(startAngle)+adjustAngleDistanceY(startAngle,-distance$1+extraDist,!1),textAlign=`left`,textVerticalAlign=`middle`;break;case`middle`:x$1=cx+middleR*mathCos$4(middleAngle),y$1=cy+middleR*mathSin$4(middleAngle),textAlign=`center`,textVerticalAlign=`middle`;break;case`endArc`:x$1=cx+(r$1+distance$1)*mathCos$4(middleAngle),y$1=cy+(r$1+distance$1)*mathSin$4(middleAngle),textAlign=`center`,textVerticalAlign=`bottom`;break;case`insideEndArc`:x$1=cx+(r$1-distance$1)*mathCos$4(middleAngle),y$1=cy+(r$1-distance$1)*mathSin$4(middleAngle),textAlign=`center`,textVerticalAlign=`top`;break;case`endAngle`:x$1=cx+middleR*mathCos$4(endAngle)+adjustAngleDistanceX(endAngle,distance$1+extraDist,!0),y$1=cy+middleR*mathSin$4(endAngle)+adjustAngleDistanceY(endAngle,distance$1+extraDist,!0),textAlign=`left`,textVerticalAlign=`middle`;break;case`insideEndAngle`:x$1=cx+middleR*mathCos$4(endAngle)+adjustAngleDistanceX(endAngle,-distance$1+extraDist,!0),y$1=cy+middleR*mathSin$4(endAngle)+adjustAngleDistanceY(endAngle,-distance$1+extraDist,!0),textAlign=`right`,textVerticalAlign=`middle`;break;default:return calculateTextPosition(out$2,opts$1,boundingRect)}return out$2||={},out$2.x=x$1,out$2.y=y$1,out$2.align=textAlign,out$2.verticalAlign=textVerticalAlign,out$2}}function setSectorTextRotation(sector,textPosition,positionMapping,rotateType){if(isNumber(rotateType)){sector.setTextConfig({rotation:rotateType});return}else if(isArray(textPosition)){sector.setTextConfig({rotation:0});return}var shape=sector.shape,startAngle=shape.clockwise?shape.startAngle:shape.endAngle,endAngle=shape.clockwise?shape.endAngle:shape.startAngle,middleAngle=(startAngle+endAngle)/2,anchorAngle,mappedSectorPosition=positionMapping(textPosition);switch(mappedSectorPosition){case`startArc`:case`insideStartArc`:case`middle`:case`insideEndArc`:case`endArc`:anchorAngle=middleAngle;break;case`startAngle`:case`insideStartAngle`:anchorAngle=startAngle;break;case`endAngle`:case`insideEndAngle`:anchorAngle=endAngle;break;default:sector.setTextConfig({rotation:0});return}var rotate$1=Math.PI*1.5-anchorAngle;mappedSectorPosition===`middle`&&rotate$1>Math.PI/2&&rotate$1<Math.PI*1.5&&(rotate$1-=Math.PI),sector.setTextConfig({rotation:rotate$1})}function adjustAngleDistanceX(angle,distance$1,isEnd){return distance$1*Math.sin(angle)*(isEnd?-1:1)}function adjustAngleDistanceY(angle,distance$1,isEnd){return distance$1*Math.cos(angle)*(isEnd?1:-1)}function getSectorCornerRadius(model,shape,zeroIfNull){var cornerRadius=model.get(`borderRadius`);if(cornerRadius==null)return zeroIfNull?{cornerRadius:0}:null;isArray(cornerRadius)||(cornerRadius=[cornerRadius,cornerRadius,cornerRadius,cornerRadius]);var dr=Math.abs(shape.r||0-shape.r0||0);return{cornerRadius:map(cornerRadius,function(cr){return parsePercent$1(cr,dr)})}}var mathMax$1=Math.max,mathMin=Math.min;function getClipArea(coord,data){var coordSysClipArea=coord.getArea&&coord.getArea();if(isCoordinateSystemType(coord,`cartesian2d`)){var baseAxis=coord.getBaseAxis();if(baseAxis.type!==`category`||!baseAxis.onBand){var expandWidth=data.getLayout(`bandWidth`);baseAxis.isHorizontal()?(coordSysClipArea.x-=expandWidth,coordSysClipArea.width+=expandWidth*2):(coordSysClipArea.y-=expandWidth,coordSysClipArea.height+=expandWidth*2)}}return coordSysClipArea}var BarView=function(_super){__extends(BarView$1,_super);function BarView$1(){var _this=_super.call(this)||this;return _this.type=BarView$1.type,_this._isFirstFrame=!0,_this}return BarView$1.prototype.render=function(seriesModel,ecModel,api,payload){this._model=seriesModel,this._removeOnRenderedListener(api),this._updateDrawMode(seriesModel);var coordinateSystemType=seriesModel.get(`coordinateSystem`);(coordinateSystemType===`cartesian2d`||coordinateSystemType===`polar`)&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(seriesModel,ecModel,api):this._renderNormal(seriesModel,ecModel,api,payload))},BarView$1.prototype.incrementalPrepareRender=function(seriesModel){this._clear(),this._updateDrawMode(seriesModel),this._updateLargeClip(seriesModel)},BarView$1.prototype.incrementalRender=function(params,seriesModel){this._progressiveEls=[],this._incrementalRenderLarge(params,seriesModel)},BarView$1.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},BarView$1.prototype._updateDrawMode=function(seriesModel){var isLargeDraw=seriesModel.pipelineContext.large;(this._isLargeDraw==null||isLargeDraw!==this._isLargeDraw)&&(this._isLargeDraw=isLargeDraw,this._clear())},BarView$1.prototype._renderNormal=function(seriesModel,ecModel,api,payload){var group=this.group,data=seriesModel.getData(),oldData=this._data,coord=seriesModel.coordinateSystem,baseAxis=coord.getBaseAxis(),isHorizontalOrRadial;coord.type===`cartesian2d`?isHorizontalOrRadial=baseAxis.isHorizontal():coord.type===`polar`&&(isHorizontalOrRadial=baseAxis.dim===`angle`);var animationModel=seriesModel.isAnimationEnabled()?seriesModel:null,realtimeSortCfg=shouldRealtimeSort(seriesModel,coord);realtimeSortCfg&&this._enableRealtimeSort(realtimeSortCfg,data,api);var needsClip=seriesModel.get(`clip`,!0)||realtimeSortCfg,coordSysClipArea=getClipArea(coord,data);group.removeClipPath();var roundCap=seriesModel.get(`roundCap`,!0),drawBackground=seriesModel.get(`showBackground`,!0),backgroundModel=seriesModel.getModel(`backgroundStyle`),barBorderRadius=backgroundModel.get(`borderRadius`)||0,bgEls=[],oldBgEls=this._backgroundEls,isInitSort=payload&&payload.isInitSort,isChangeOrder=payload&&payload.type===`changeAxisOrder`;function createBackground(dataIndex){var bgLayout=getLayout[coord.type](data,dataIndex);if(!bgLayout)return null;var bgEl=createBackgroundEl(coord,isHorizontalOrRadial,bgLayout);return bgEl.useStyle(backgroundModel.getItemStyle()),coord.type===`cartesian2d`?bgEl.setShape(`r`,barBorderRadius):bgEl.setShape(`cornerRadius`,barBorderRadius),bgEls[dataIndex]=bgEl,bgEl}data.diff(oldData).add(function(dataIndex){var itemModel=data.getItemModel(dataIndex),layout$2=getLayout[coord.type](data,dataIndex,itemModel);if(layout$2&&(drawBackground&&createBackground(dataIndex),!(!data.hasValue(dataIndex)||!isValidLayout[coord.type](layout$2)))){var isClipped=!1;needsClip&&(isClipped=clip[coord.type](coordSysClipArea,layout$2));var el=elementCreator[coord.type](seriesModel,data,dataIndex,layout$2,isHorizontalOrRadial,animationModel,baseAxis.model,!1,roundCap);realtimeSortCfg&&(el.forceLabelAnimation=!0),updateStyle(el,data,dataIndex,itemModel,layout$2,seriesModel,isHorizontalOrRadial,coord.type===`polar`),isInitSort?el.attr({shape:layout$2}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,el,layout$2,dataIndex,isHorizontalOrRadial,!1,!1):initProps(el,{shape:layout$2},seriesModel,dataIndex),data.setItemGraphicEl(dataIndex,el),group.add(el),el.ignore=isClipped}}).update(function(newIndex,oldIndex){var itemModel=data.getItemModel(newIndex),layout$2=getLayout[coord.type](data,newIndex,itemModel);if(layout$2){if(drawBackground){var bgEl=void 0;oldBgEls.length===0?bgEl=createBackground(oldIndex):(bgEl=oldBgEls[oldIndex],bgEl.useStyle(backgroundModel.getItemStyle()),coord.type===`cartesian2d`?bgEl.setShape(`r`,barBorderRadius):bgEl.setShape(`cornerRadius`,barBorderRadius),bgEls[newIndex]=bgEl);var bgLayout=getLayout[coord.type](data,newIndex),shape=createBackgroundShape(isHorizontalOrRadial,bgLayout,coord);updateProps$1(bgEl,{shape},animationModel,newIndex)}var el=oldData.getItemGraphicEl(oldIndex);if(!data.hasValue(newIndex)||!isValidLayout[coord.type](layout$2)){group.remove(el);return}var isClipped=!1;if(needsClip&&(isClipped=clip[coord.type](coordSysClipArea,layout$2),isClipped&&group.remove(el)),el&&(el.type===`sector`&&roundCap||el.type===`sausage`&&!roundCap)&&(el&&removeElementWithFadeOut(el,seriesModel,oldIndex),el=null),el?saveOldStyle(el):el=elementCreator[coord.type](seriesModel,data,newIndex,layout$2,isHorizontalOrRadial,animationModel,baseAxis.model,!0,roundCap),realtimeSortCfg&&(el.forceLabelAnimation=!0),isChangeOrder){var textEl=el.getTextContent();if(textEl){var labelInnerStore=labelInner(textEl);labelInnerStore.prevValue!=null&&(labelInnerStore.prevValue=labelInnerStore.value)}}else updateStyle(el,data,newIndex,itemModel,layout$2,seriesModel,isHorizontalOrRadial,coord.type===`polar`);isInitSort?el.attr({shape:layout$2}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,el,layout$2,newIndex,isHorizontalOrRadial,!0,isChangeOrder):updateProps$1(el,{shape:layout$2},seriesModel,newIndex,null),data.setItemGraphicEl(newIndex,el),el.ignore=isClipped,group.add(el)}}).remove(function(dataIndex){var el=oldData.getItemGraphicEl(dataIndex);el&&removeElementWithFadeOut(el,seriesModel,dataIndex)}).execute();var bgGroup=this._backgroundGroup||=new Group_default;bgGroup.removeAll();for(var i$1=0;i$1<bgEls.length;++i$1)bgGroup.add(bgEls[i$1]);group.add(bgGroup),this._backgroundEls=bgEls,this._data=data},BarView$1.prototype._renderLarge=function(seriesModel,ecModel,api){this._clear(),createLarge$1(seriesModel,this.group),this._updateLargeClip(seriesModel)},BarView$1.prototype._incrementalRenderLarge=function(params,seriesModel){this._removeBackground(),createLarge$1(seriesModel,this.group,this._progressiveEls,!0)},BarView$1.prototype._updateLargeClip=function(seriesModel){var clipPath=seriesModel.get(`clip`,!0)&&createClipPath(seriesModel.coordinateSystem,!1,seriesModel),group=this.group;clipPath?group.setClipPath(clipPath):group.removeClipPath()},BarView$1.prototype._enableRealtimeSort=function(realtimeSortCfg,data,api){var _this=this;if(data.count()){var baseAxis=realtimeSortCfg.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(data,realtimeSortCfg,api),this._isFirstFrame=!1;else{var orderMapping_1=function(idx){var el=data.getItemGraphicEl(idx),shape=el&&el.shape;return shape&&Math.abs(baseAxis.isHorizontal()?shape.height:shape.width)||0};this._onRendered=function(){_this._updateSortWithinSameData(data,orderMapping_1,baseAxis,api)},api.getZr().on(`rendered`,this._onRendered)}}},BarView$1.prototype._dataSort=function(data,baseAxis,orderMapping){var info=[];return data.each(data.mapDimension(baseAxis.dim),function(ordinalNumber,dataIdx){var mappedValue=orderMapping(dataIdx);mappedValue??=NaN,info.push({dataIndex:dataIdx,mappedValue,ordinalNumber})}),info.sort(function(a$1,b$1){return b$1.mappedValue-a$1.mappedValue}),{ordinalNumbers:map(info,function(item){return item.ordinalNumber})}},BarView$1.prototype._isOrderChangedWithinSameData=function(data,orderMapping,baseAxis){for(var scale$3=baseAxis.scale,ordinalDataDim=data.mapDimension(baseAxis.dim),lastValue=Number.MAX_VALUE,tickNum=0,len$1=scale$3.getOrdinalMeta().categories.length;tickNum<len$1;++tickNum){var rawIdx=data.rawIndexOf(ordinalDataDim,scale$3.getRawOrdinalNumber(tickNum)),value=rawIdx<0?Number.MIN_VALUE:orderMapping(data.indexOfRawIndex(rawIdx));if(value>lastValue)return!0;lastValue=value}return!1},BarView$1.prototype._isOrderDifferentInView=function(orderInfo,baseAxis){for(var scale$3=baseAxis.scale,extent=scale$3.getExtent(),tickNum=Math.max(0,extent[0]),tickMax=Math.min(extent[1],scale$3.getOrdinalMeta().categories.length-1);tickNum<=tickMax;++tickNum)if(orderInfo.ordinalNumbers[tickNum]!==scale$3.getRawOrdinalNumber(tickNum))return!0},BarView$1.prototype._updateSortWithinSameData=function(data,orderMapping,baseAxis,api){if(this._isOrderChangedWithinSameData(data,orderMapping,baseAxis)){var sortInfo=this._dataSort(data,baseAxis,orderMapping);this._isOrderDifferentInView(sortInfo,baseAxis)&&(this._removeOnRenderedListener(api),api.dispatchAction({type:`changeAxisOrder`,componentType:baseAxis.dim+`Axis`,axisId:baseAxis.index,sortInfo}))}},BarView$1.prototype._dispatchInitSort=function(data,realtimeSortCfg,api){var baseAxis=realtimeSortCfg.baseAxis,sortResult=this._dataSort(data,baseAxis,function(dataIdx){return data.get(data.mapDimension(realtimeSortCfg.otherAxis.dim),dataIdx)});api.dispatchAction({type:`changeAxisOrder`,componentType:baseAxis.dim+`Axis`,isInitSort:!0,axisId:baseAxis.index,sortInfo:sortResult})},BarView$1.prototype.remove=function(ecModel,api){this._clear(this._model),this._removeOnRenderedListener(api)},BarView$1.prototype.dispose=function(ecModel,api){this._removeOnRenderedListener(api)},BarView$1.prototype._removeOnRenderedListener=function(api){this._onRendered&&=(api.getZr().off(`rendered`,this._onRendered),null)},BarView$1.prototype._clear=function(model){var group=this.group,data=this._data;model&&model.isAnimationEnabled()&&data&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],data.eachItemGraphicEl(function(el){removeElementWithFadeOut(el,model,getECData(el).dataIndex)})):group.removeAll(),this._data=null,this._isFirstFrame=!0},BarView$1.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},BarView$1.type=`bar`,BarView$1}(Chart_default),clip={cartesian2d:function(coordSysBoundingRect,layout$2){var signWidth=layout$2.width<0?-1:1,signHeight=layout$2.height<0?-1:1;signWidth<0&&(layout$2.x+=layout$2.width,layout$2.width=-layout$2.width),signHeight<0&&(layout$2.y+=layout$2.height,layout$2.height=-layout$2.height);var coordSysX2=coordSysBoundingRect.x+coordSysBoundingRect.width,coordSysY2=coordSysBoundingRect.y+coordSysBoundingRect.height,x$1=mathMax$1(layout$2.x,coordSysBoundingRect.x),x2=mathMin(layout$2.x+layout$2.width,coordSysX2),y$1=mathMax$1(layout$2.y,coordSysBoundingRect.y),y2=mathMin(layout$2.y+layout$2.height,coordSysY2),xClipped=x2<x$1,yClipped=y2<y$1;return layout$2.x=xClipped&&x$1>coordSysX2?x2:x$1,layout$2.y=yClipped&&y$1>coordSysY2?y2:y$1,layout$2.width=xClipped?0:x2-x$1,layout$2.height=yClipped?0:y2-y$1,signWidth<0&&(layout$2.x+=layout$2.width,layout$2.width=-layout$2.width),signHeight<0&&(layout$2.y+=layout$2.height,layout$2.height=-layout$2.height),xClipped||yClipped},polar:function(coordSysClipArea,layout$2){var signR=layout$2.r0<=layout$2.r?1:-1;if(signR<0){var tmp=layout$2.r;layout$2.r=layout$2.r0,layout$2.r0=tmp}var r$1=mathMin(layout$2.r,coordSysClipArea.r),r0=mathMax$1(layout$2.r0,coordSysClipArea.r0);layout$2.r=r$1,layout$2.r0=r0;var clipped=r$1-r0<0;if(signR<0){var tmp=layout$2.r;layout$2.r=layout$2.r0,layout$2.r0=tmp}return clipped}},elementCreator={cartesian2d:function(seriesModel,data,newIndex,layout$2,isHorizontal,animationModel,axisModel,isUpdate,roundCap){var rect=new Rect_default({shape:extend({},layout$2),z2:1});if(rect.__dataIndex=newIndex,rect.name=`item`,animationModel){var rectShape=rect.shape,animateProperty=isHorizontal?`height`:`width`;rectShape[animateProperty]=0}return rect},polar:function(seriesModel,data,newIndex,layout$2,isRadial,animationModel,axisModel,isUpdate,roundCap){var ShapeClass=!isRadial&&roundCap?sausage_default:Sector_default,sector=new ShapeClass({shape:layout$2,z2:1});sector.name=`item`;var positionMap=createPolarPositionMapping(isRadial);if(sector.calculateTextPosition=createSectorCalculateTextPosition(positionMap,{isRoundCap:ShapeClass===sausage_default}),animationModel){var sectorShape=sector.shape,animateProperty=isRadial?`r`:`endAngle`,animateTarget={};sectorShape[animateProperty]=isRadial?layout$2.r0:layout$2.startAngle,animateTarget[animateProperty]=layout$2[animateProperty],(isUpdate?updateProps$1:initProps)(sector,{shape:animateTarget},animationModel)}return sector}};function shouldRealtimeSort(seriesModel,coordSys){var realtimeSortOption=seriesModel.get(`realtimeSort`,!0),baseAxis=coordSys.getBaseAxis();if(realtimeSortOption&&baseAxis.type===`category`&&coordSys.type===`cartesian2d`)return{baseAxis,otherAxis:coordSys.getOtherAxis(baseAxis)}}function updateRealtimeAnimation(realtimeSortCfg,seriesAnimationModel,el,layout$2,newIndex,isHorizontal,isUpdate,isChangeOrder){var seriesTarget,axisTarget;isHorizontal?(axisTarget={x:layout$2.x,width:layout$2.width},seriesTarget={y:layout$2.y,height:layout$2.height}):(axisTarget={y:layout$2.y,height:layout$2.height},seriesTarget={x:layout$2.x,width:layout$2.width}),isChangeOrder||(isUpdate?updateProps$1:initProps)(el,{shape:seriesTarget},seriesAnimationModel,newIndex,null);var axisAnimationModel=seriesAnimationModel?realtimeSortCfg.baseAxis.model:null;(isUpdate?updateProps$1:initProps)(el,{shape:axisTarget},axisAnimationModel,newIndex)}function checkPropertiesNotValid(obj,props){for(var i$1=0;i$1<props.length;i$1++)if(!isFinite(obj[props[i$1]]))return!0;return!1}var rectPropties=[`x`,`y`,`width`,`height`],polarPropties=[`cx`,`cy`,`r`,`startAngle`,`endAngle`],isValidLayout={cartesian2d:function(layout$2){return!checkPropertiesNotValid(layout$2,rectPropties)},polar:function(layout$2){return!checkPropertiesNotValid(layout$2,polarPropties)}},getLayout={cartesian2d:function(data,dataIndex,itemModel){var layout$2=data.getItemLayout(dataIndex);if(!layout$2)return null;var fixedLineWidth=itemModel?getLineWidth(itemModel,layout$2):0,signX=layout$2.width>0?1:-1,signY=layout$2.height>0?1:-1;return{x:layout$2.x+signX*fixedLineWidth/2,y:layout$2.y+signY*fixedLineWidth/2,width:layout$2.width-signX*fixedLineWidth,height:layout$2.height-signY*fixedLineWidth}},polar:function(data,dataIndex,itemModel){var layout$2=data.getItemLayout(dataIndex);return{cx:layout$2.cx,cy:layout$2.cy,r0:layout$2.r0,r:layout$2.r,startAngle:layout$2.startAngle,endAngle:layout$2.endAngle,clockwise:layout$2.clockwise}}};function isZeroOnPolar(layout$2){return layout$2.startAngle!=null&&layout$2.endAngle!=null&&layout$2.startAngle===layout$2.endAngle}function createPolarPositionMapping(isRadial){return function(isRadial$1){var arcOrAngle=isRadial$1?`Arc`:`Angle`;return function(position){switch(position){case`start`:case`insideStart`:case`end`:case`insideEnd`:return position+arcOrAngle;default:return position}}}(isRadial)}function updateStyle(el,data,dataIndex,itemModel,layout$2,seriesModel,isHorizontalOrRadial,isPolar){var style=data.getItemVisual(dataIndex,`style`);if(isPolar){if(!seriesModel.get(`roundCap`)){var sectorShape=el.shape,cornerRadius=getSectorCornerRadius(itemModel.getModel(`itemStyle`),sectorShape,!0);extend(sectorShape,cornerRadius),el.setShape(sectorShape)}}else{var borderRadius=itemModel.get([`itemStyle`,`borderRadius`])||0;el.setShape(`r`,borderRadius)}el.useStyle(style);var cursorStyle=itemModel.getShallow(`cursor`);cursorStyle&&el.attr(`cursor`,cursorStyle);var labelPositionOutside=isPolar?isHorizontalOrRadial?layout$2.r>=layout$2.r0?`endArc`:`startArc`:layout$2.endAngle>=layout$2.startAngle?`endAngle`:`startAngle`:isHorizontalOrRadial?layout$2.height>=0?`bottom`:`top`:layout$2.width>=0?`right`:`left`,labelStatesModels=getLabelStatesModels(itemModel);setLabelStyle(el,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:dataIndex,defaultText:getDefaultLabel(seriesModel.getData(),dataIndex),inheritColor:style.fill,defaultOpacity:style.opacity,defaultOutsidePosition:labelPositionOutside});var label=el.getTextContent();if(isPolar&&label){var position=itemModel.get([`label`,`position`]);el.textConfig.inside=position===`middle`?!0:null,setSectorTextRotation(el,position===`outside`?labelPositionOutside:position,createPolarPositionMapping(isHorizontalOrRadial),itemModel.get([`label`,`rotate`]))}setLabelValueAnimation(label,labelStatesModels,seriesModel.getRawValue(dataIndex),function(value){return getDefaultInterpolatedLabel(data,value)});var emphasisModel=itemModel.getModel([`emphasis`]);toggleHoverEmphasis(el,emphasisModel.get(`focus`),emphasisModel.get(`blurScope`),emphasisModel.get(`disabled`)),setStatesStylesFromModel(el,itemModel),isZeroOnPolar(layout$2)&&(el.style.fill=`none`,el.style.stroke=`none`,each(el.states,function(state){state.style&&(state.style.fill=state.style.stroke=`none`)}))}function getLineWidth(itemModel,rawLayout){var borderColor=itemModel.get([`itemStyle`,`borderColor`]);if(!borderColor||borderColor===`none`)return 0;var lineWidth=itemModel.get([`itemStyle`,`borderWidth`])||0,width=isNaN(rawLayout.width)?Number.MAX_VALUE:Math.abs(rawLayout.width),height=isNaN(rawLayout.height)?Number.MAX_VALUE:Math.abs(rawLayout.height);return Math.min(lineWidth,width,height)}var LagePathShape=function(){function LagePathShape$1(){}return LagePathShape$1}(),LargePath=function(_super){__extends(LargePath$1,_super);function LargePath$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`largeBar`,_this}return LargePath$1.prototype.getDefaultShape=function(){return new LagePathShape},LargePath$1.prototype.buildPath=function(ctx,shape){for(var points$1=shape.points,baseDimIdx=this.baseDimIdx,valueDimIdx=1-this.baseDimIdx,startPoint=[],size=[],barWidth=this.barWidth,i$1=0;i$1<points$1.length;i$1+=3)size[baseDimIdx]=barWidth,size[valueDimIdx]=points$1[i$1+2],startPoint[baseDimIdx]=points$1[i$1+baseDimIdx],startPoint[valueDimIdx]=points$1[i$1+valueDimIdx],ctx.rect(startPoint[0],startPoint[1],size[0],size[1])},LargePath$1}(Path_default);function createLarge$1(seriesModel,group,progressiveEls,incremental){var data=seriesModel.getData(),baseDimIdx=data.getLayout(`valueAxisHorizontal`)?1:0,largeDataIndices=data.getLayout(`largeDataIndices`),barWidth=data.getLayout(`size`),backgroundModel=seriesModel.getModel(`backgroundStyle`),bgPoints=data.getLayout(`largeBackgroundPoints`);if(bgPoints){var bgEl=new LargePath({shape:{points:bgPoints},incremental:!!incremental,silent:!0,z2:0});bgEl.baseDimIdx=baseDimIdx,bgEl.largeDataIndices=largeDataIndices,bgEl.barWidth=barWidth,bgEl.useStyle(backgroundModel.getItemStyle()),group.add(bgEl),progressiveEls&&progressiveEls.push(bgEl)}var el=new LargePath({shape:{points:data.getLayout(`largePoints`)},incremental:!!incremental,ignoreCoarsePointer:!0,z2:1});el.baseDimIdx=baseDimIdx,el.largeDataIndices=largeDataIndices,el.barWidth=barWidth,group.add(el),el.useStyle(data.getVisual(`style`)),el.style.stroke=null,getECData(el).seriesIndex=seriesModel.seriesIndex,seriesModel.get(`silent`)||(el.on(`mousedown`,largePathUpdateDataIndex),el.on(`mousemove`,largePathUpdateDataIndex)),progressiveEls&&progressiveEls.push(el)}var largePathUpdateDataIndex=throttle(function(event){var largePath=this,dataIndex=largePathFindDataIndex(largePath,event.offsetX,event.offsetY);getECData(largePath).dataIndex=dataIndex>=0?dataIndex:null},30,!1);function largePathFindDataIndex(largePath,x$1,y$1){for(var baseDimIdx=largePath.baseDimIdx,valueDimIdx=1-baseDimIdx,points$1=largePath.shape.points,largeDataIndices=largePath.largeDataIndices,startPoint=[],size=[],barWidth=largePath.barWidth,i$1=0,len$1=points$1.length/3;i$1<len$1;i$1++){var ii=i$1*3;if(size[baseDimIdx]=barWidth,size[valueDimIdx]=points$1[ii+2],startPoint[baseDimIdx]=points$1[ii+baseDimIdx],startPoint[valueDimIdx]=points$1[ii+valueDimIdx],size[valueDimIdx]<0&&(startPoint[valueDimIdx]+=size[valueDimIdx],size[valueDimIdx]=-size[valueDimIdx]),x$1>=startPoint[0]&&x$1<=startPoint[0]+size[0]&&y$1>=startPoint[1]&&y$1<=startPoint[1]+size[1])return largeDataIndices[i$1]}return-1}function createBackgroundShape(isHorizontalOrRadial,layout$2,coord){if(isCoordinateSystemType(coord,`cartesian2d`)){var rectShape=layout$2,coordLayout=coord.getArea();return{x:isHorizontalOrRadial?rectShape.x:coordLayout.x,y:isHorizontalOrRadial?coordLayout.y:rectShape.y,width:isHorizontalOrRadial?rectShape.width:coordLayout.width,height:isHorizontalOrRadial?coordLayout.height:rectShape.height}}else{var coordLayout=coord.getArea(),sectorShape=layout$2;return{cx:coordLayout.cx,cy:coordLayout.cy,r0:isHorizontalOrRadial?coordLayout.r0:sectorShape.r0,r:isHorizontalOrRadial?coordLayout.r:sectorShape.r,startAngle:isHorizontalOrRadial?sectorShape.startAngle:0,endAngle:isHorizontalOrRadial?sectorShape.endAngle:Math.PI*2}}}function createBackgroundEl(coord,isHorizontalOrRadial,layout$2){return new(coord.type===`polar`?Sector_default:Rect_default)({shape:createBackgroundShape(isHorizontalOrRadial,layout$2,coord),silent:!0,z2:0})}var BarView_default=BarView;function install$2(registers){registers.registerChartView(BarView_default),registers.registerSeriesModel(BarSeries_default),registers.registerLayout(registers.PRIORITY.VISUAL.LAYOUT,curry(layout$1,`bar`)),registers.registerLayout(registers.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout(`bar`)),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample(`bar`)),registers.registerAction({type:`changeAxisOrder`,event:`changeAxisOrder`,update:`update`},function(payload,ecModel){var componentType=payload.componentType||`series`;ecModel.eachComponent({mainType:componentType,query:payload},function(componentModel){payload.sortInfo&&componentModel.axis.setCategorySortInfo(payload.sortInfo)})})}function createSeriesDataSimply(seriesModel,opt,nameList){opt=isArray(opt)&&{coordDimensions:opt}||extend({encodeDefine:seriesModel.getEncode()},opt);var source$2=seriesModel.getSource(),dimensions=prepareSeriesDataSchema(source$2,opt).dimensions,list=new SeriesData_default(dimensions,seriesModel);return list.initData(source$2,nameList),list}var OUTER_BOUNDS_DEFAULT={left:0,right:0,top:0,bottom:0},OUTER_BOUNDS_CLAMP_DEFAULT=[`25%`,`25%`],GridModel_default=function(_super){__extends(GridModel$1,_super);function GridModel$1(){return _super!==null&&_super.apply(this,arguments)||this}return GridModel$1.prototype.mergeDefaultAndTheme=function(option,ecModel){var outerBoundsCp=getLayoutParams(option.outerBounds);_super.prototype.mergeDefaultAndTheme.apply(this,arguments),outerBoundsCp&&option.outerBounds&&mergeLayoutParam(option.outerBounds,outerBoundsCp)},GridModel$1.prototype.mergeOption=function(newOption,ecModel){_super.prototype.mergeOption.apply(this,arguments),this.option.outerBounds&&newOption.outerBounds&&mergeLayoutParam(this.option.outerBounds,newOption.outerBounds)},GridModel$1.type=`grid`,GridModel$1.dependencies=[`xAxis`,`yAxis`],GridModel$1.layoutMode=`box`,GridModel$1.defaultOption={show:!1,z:0,left:`15%`,top:65,right:`10%`,bottom:80,containLabel:!1,outerBoundsMode:`auto`,outerBounds:OUTER_BOUNDS_DEFAULT,outerBoundsContain:`all`,outerBoundsClampWidth:OUTER_BOUNDS_CLAMP_DEFAULT[0],outerBoundsClampHeight:OUTER_BOUNDS_CLAMP_DEFAULT[1],backgroundColor:tokens_default.color.transparent,borderWidth:1,borderColor:tokens_default.color.neutral30},GridModel$1}(Component_default),CartesianAxisModel=function(_super){__extends(CartesianAxisModel$1,_super);function CartesianAxisModel$1(){return _super!==null&&_super.apply(this,arguments)||this}return CartesianAxisModel$1.prototype.getCoordSysModel=function(){return this.getReferringComponents(`grid`,SINGLE_REFERRING).models[0]},CartesianAxisModel$1.type=`cartesian2dAxis`,CartesianAxisModel$1}(Component_default);mixin(CartesianAxisModel,AxisModelCommonMixin);var defaultOption={show:!0,z:0,inverse:!1,name:``,nameLocation:`end`,nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:`...`,placeholder:`.`},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:tokens_default.color.axisLine,width:1,type:`solid`},symbol:[`none`,`none`],symbolSize:[10,15],breakLine:!0},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12,color:tokens_default.color.axisLabel,textMargin:[0,3]},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:tokens_default.color.axisSplitLine,width:1,type:`solid`}},splitArea:{show:!1,areaStyle:{color:[tokens_default.color.backgroundTint,tokens_default.color.backgroundTransparent]}},breakArea:{show:!0,itemStyle:{color:tokens_default.color.neutral00,borderColor:tokens_default.color.border,borderWidth:1,borderType:[3,3],opacity:.6},zigzagAmplitude:4,zigzagMinSpan:4,zigzagMaxSpan:20,zigzagZ:100,expandOnClick:!0},breakLabelLayout:{moveOverlap:`auto`}},categoryAxis=merge({boundaryGap:!0,deduplication:null,jitter:0,jitterOverlap:!0,jitterMargin:2,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:`auto`,show:`auto`},axisLabel:{interval:`auto`}},defaultOption),valueAxis=merge({boundaryGap:[0,0],axisLine:{show:`auto`},axisTick:{show:`auto`},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:tokens_default.color.axisMinorSplitLine,width:1}}},defaultOption),timeAxis=merge({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:`bold`}}},splitLine:{show:!1}},valueAxis),logAxis=defaults({logBase:10},valueAxis),axisDefault_default={category:categoryAxis,value:valueAxis,time:timeAxis,log:logAxis},AXIS_TYPES={value:1,category:1,time:1,log:1},_impl=null;function getAxisBreakHelper(){return _impl}function axisModelCreator(registers,axisName,BaseAxisModelClass,extraDefaultOption){each(AXIS_TYPES,function(v$1,axisType){var defaultOption$1=merge(merge({},axisDefault_default[axisType],!0),extraDefaultOption,!0),AxisModel=function(_super){__extends(AxisModel$1,_super);function AxisModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=axisName+`Axis.`+axisType,_this}return AxisModel$1.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{},themeModel=ecModel.getTheme();merge(option,themeModel.get(axisType+`Axis`)),merge(option,this.getDefaultOption()),option.type=getAxisType(option),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},AxisModel$1.prototype.optionUpdated=function(){this.option.type===`category`&&(this.__ordinalMeta=OrdinalMeta_default.createByAxisModel(this))},AxisModel$1.prototype.getCategories=function(rawData){var option=this.option;if(option.type===`category`)return rawData?option.data:this.__ordinalMeta.categories},AxisModel$1.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},AxisModel$1.prototype.updateAxisBreaks=function(payload){var axisBreakHelper=getAxisBreakHelper();return axisBreakHelper?axisBreakHelper.updateModelAxisBreak(this,payload):{breaks:[]}},AxisModel$1.type=axisName+`Axis.`+axisType,AxisModel$1.defaultOption=defaultOption$1,AxisModel$1}(BaseAxisModelClass);registers.registerComponentModel(AxisModel)}),registers.registerSubTypeDefaulter(axisName+`Axis`,getAxisType)}function getAxisType(option){return option.type||(option.data?`category`:`value`)}var Cartesian_default=function(){function Cartesian$1(name){this.type=`cartesian`,this._dimList=[],this._axes={},this.name=name||``}return Cartesian$1.prototype.getAxis=function(dim){return this._axes[dim]},Cartesian$1.prototype.getAxes=function(){return map(this._dimList,function(dim){return this._axes[dim]},this)},Cartesian$1.prototype.getAxesByScale=function(scaleType){return scaleType=scaleType.toLowerCase(),filter(this.getAxes(),function(axis){return axis.scale.type===scaleType})},Cartesian$1.prototype.addAxis=function(axis){var dim=axis.dim;this._axes[dim]=axis,this._dimList.push(dim)},Cartesian$1}(),cartesian2DDimensions=[`x`,`y`];function canCalculateAffineTransform(scale$3){return(scale$3.type===`interval`||scale$3.type===`time`)&&!scale$3.hasBreaks()}var Cartesian2D_default=function(_super){__extends(Cartesian2D$1,_super);function Cartesian2D$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`cartesian2d`,_this.dimensions=cartesian2DDimensions,_this}return Cartesian2D$1.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var xAxisScale=this.getAxis(`x`).scale,yAxisScale=this.getAxis(`y`).scale;if(!(!canCalculateAffineTransform(xAxisScale)||!canCalculateAffineTransform(yAxisScale))){var xScaleExtent=xAxisScale.getExtent(),yScaleExtent=yAxisScale.getExtent(),start$1=this.dataToPoint([xScaleExtent[0],yScaleExtent[0]]),end$1=this.dataToPoint([xScaleExtent[1],yScaleExtent[1]]),xScaleSpan=xScaleExtent[1]-xScaleExtent[0],yScaleSpan=yScaleExtent[1]-yScaleExtent[0];if(!(!xScaleSpan||!yScaleSpan)){var scaleX=(end$1[0]-start$1[0])/xScaleSpan,scaleY=(end$1[1]-start$1[1])/yScaleSpan,translateX=start$1[0]-xScaleExtent[0]*scaleX,translateY=start$1[1]-yScaleExtent[0]*scaleY,m$2=this._transform=[scaleX,0,0,scaleY,translateX,translateY];this._invTransform=invert([],m$2)}}},Cartesian2D$1.prototype.getBaseAxis=function(){return this.getAxesByScale(`ordinal`)[0]||this.getAxesByScale(`time`)[0]||this.getAxis(`x`)},Cartesian2D$1.prototype.containPoint=function(point){var axisX=this.getAxis(`x`),axisY=this.getAxis(`y`);return axisX.contain(axisX.toLocalCoord(point[0]))&&axisY.contain(axisY.toLocalCoord(point[1]))},Cartesian2D$1.prototype.containData=function(data){return this.getAxis(`x`).containData(data[0])&&this.getAxis(`y`).containData(data[1])},Cartesian2D$1.prototype.containZone=function(data1,data2){var zoneDiag1=this.dataToPoint(data1),zoneDiag2=this.dataToPoint(data2),area$1=this.getArea(),zone=new BoundingRect_default(zoneDiag1[0],zoneDiag1[1],zoneDiag2[0]-zoneDiag1[0],zoneDiag2[1]-zoneDiag1[1]);return area$1.intersect(zone)},Cartesian2D$1.prototype.dataToPoint=function(data,clamp$1,out$2){out$2||=[];var xVal=data[0],yVal=data[1];if(this._transform&&xVal!=null&&isFinite(xVal)&&yVal!=null&&isFinite(yVal))return applyTransform(out$2,data,this._transform);var xAxis=this.getAxis(`x`),yAxis=this.getAxis(`y`);return out$2[0]=xAxis.toGlobalCoord(xAxis.dataToCoord(xVal,clamp$1)),out$2[1]=yAxis.toGlobalCoord(yAxis.dataToCoord(yVal,clamp$1)),out$2},Cartesian2D$1.prototype.clampData=function(data,out$2){var xScale=this.getAxis(`x`).scale,yScale=this.getAxis(`y`).scale,xAxisExtent=xScale.getExtent(),yAxisExtent=yScale.getExtent(),x$1=xScale.parse(data[0]),y$1=yScale.parse(data[1]);return out$2||=[],out$2[0]=Math.min(Math.max(Math.min(xAxisExtent[0],xAxisExtent[1]),x$1),Math.max(xAxisExtent[0],xAxisExtent[1])),out$2[1]=Math.min(Math.max(Math.min(yAxisExtent[0],yAxisExtent[1]),y$1),Math.max(yAxisExtent[0],yAxisExtent[1])),out$2},Cartesian2D$1.prototype.pointToData=function(point,clamp$1,out$2){if(out$2||=[],this._invTransform)return applyTransform(out$2,point,this._invTransform);var xAxis=this.getAxis(`x`),yAxis=this.getAxis(`y`);return out$2[0]=xAxis.coordToData(xAxis.toLocalCoord(point[0]),clamp$1),out$2[1]=yAxis.coordToData(yAxis.toLocalCoord(point[1]),clamp$1),out$2},Cartesian2D$1.prototype.getOtherAxis=function(axis){return this.getAxis(axis.dim===`x`?`y`:`x`)},Cartesian2D$1.prototype.getArea=function(tolerance){tolerance||=0;var xExtent=this.getAxis(`x`).getGlobalExtent(),yExtent=this.getAxis(`y`).getGlobalExtent(),x$1=Math.min(xExtent[0],xExtent[1])-tolerance,y$1=Math.min(yExtent[0],yExtent[1])-tolerance,width=Math.max(xExtent[0],xExtent[1])-x$1+tolerance,height=Math.max(yExtent[0],yExtent[1])-y$1+tolerance;return new BoundingRect_default(x$1,y$1,width,height)},Cartesian2D$1}(Cartesian_default),Axis2D_default=function(_super){__extends(Axis2D$1,_super);function Axis2D$1(dim,scale$3,coordExtent,axisType,position){var _this=_super.call(this,dim,scale$3,coordExtent)||this;return _this.index=0,_this.type=axisType||`value`,_this.position=position||`bottom`,_this}return Axis2D$1.prototype.isHorizontal=function(){var position=this.position;return position===`top`||position===`bottom`},Axis2D$1.prototype.getGlobalExtent=function(asc$2){var ret=this.getExtent();return ret[0]=this.toGlobalCoord(ret[0]),ret[1]=this.toGlobalCoord(ret[1]),asc$2&&ret[0]>ret[1]&&ret.reverse(),ret},Axis2D$1.prototype.pointToData=function(point,clamp$1){return this.coordToData(this.toLocalCoord(point[this.dim===`x`?0:1]),clamp$1)},Axis2D$1.prototype.setCategorySortInfo=function(info){if(this.type!==`category`)return!1;this.model.option.categorySortInfo=info,this.scale.setSortInfo(info)},Axis2D$1}(Axis_default),AXIS_BREAK_EXPAND_ACTION_TYPE=`expandAxisBreak`,PI=Math.PI,DEFAULT_CENTER_NAME_MARGIN_LEVELS=[[1,2,1,2],[5,3,5,3],[8,3,8,3]],DEFAULT_ENDS_NAME_MARGIN_LEVELS=[[0,1,0,1],[0,3,0,3],[0,3,0,3]],getLabelInner=makeInner(),getTickInner=makeInner(),AxisBuilderSharedContext=function(){function AxisBuilderSharedContext$1(resolveAxisNameOverlap){this.recordMap={},this.resolveAxisNameOverlap=resolveAxisNameOverlap}return AxisBuilderSharedContext$1.prototype.ensureRecord=function(axisModel){var dim=axisModel.axis.dim,idx=axisModel.componentIndex,recordMap=this.recordMap,records=recordMap[dim]||(recordMap[dim]=[]);return records[idx]||(records[idx]={ready:{}})},AxisBuilderSharedContext$1}();function resetOverlapRecordToShared(cfg,shared,axisModel,labelLayoutList){var axis=axisModel.axis,record=shared.ensureRecord(axisModel),labelInfoList=[],stOccupiedRect,useStOccupiedRect=hasAxisName(cfg.axisName)&&isNameLocationCenter(cfg.nameLocation);each(labelLayoutList,function(layout$2){var layoutInfo=ensureLabelLayoutWithGeometry(layout$2);if(!(!layoutInfo||layoutInfo.label.ignore)){labelInfoList.push(layoutInfo);var transGroup=record.transGroup;useStOccupiedRect&&(transGroup.transform?invert(_stTransTmp,transGroup.transform):identity(_stTransTmp),layoutInfo.transform&&mul(_stTransTmp,_stTransTmp,layoutInfo.transform),BoundingRect_default.copy(_stLabelRectTmp,layoutInfo.localRect),_stLabelRectTmp.applyTransform(_stTransTmp),stOccupiedRect?stOccupiedRect.union(_stLabelRectTmp):BoundingRect_default.copy(stOccupiedRect=new BoundingRect_default(0,0,0,0),_stLabelRectTmp))}});var sortByDim=Math.abs(record.dirVec.x)>.1?`x`:`y`,sortByValue=record.transGroup[sortByDim];if(labelInfoList.sort(function(info1,info2){return Math.abs(info1.label[sortByDim]-sortByValue)-Math.abs(info2.label[sortByDim]-sortByValue)}),useStOccupiedRect&&stOccupiedRect){var extent=axis.getExtent(),axisLineX=Math.min(extent[0],extent[1]),axisLineWidth=Math.max(extent[0],extent[1])-axisLineX;stOccupiedRect.union(new BoundingRect_default(axisLineX,0,axisLineWidth,1))}record.stOccupiedRect=stOccupiedRect,record.labelInfoList=labelInfoList}var _stTransTmp=create$1(),_stLabelRectTmp=new BoundingRect_default(0,0,0,0),resolveAxisNameOverlapDefault=function(cfg,ctx,axisModel,nameLayoutInfo,nameMoveDirVec,thisRecord){if(isNameLocationCenter(cfg.nameLocation)){var stOccupiedRect=thisRecord.stOccupiedRect;stOccupiedRect&&moveIfOverlap(computeLabelGeometry2({},stOccupiedRect,thisRecord.transGroup.transform),nameLayoutInfo,nameMoveDirVec)}else moveIfOverlapByLinearLabels(thisRecord.labelInfoList,thisRecord.dirVec,nameLayoutInfo,nameMoveDirVec)};function moveIfOverlap(basedLayoutInfo,movableLayoutInfo,moveDirVec){var mtv=new Point_default;labelIntersect(basedLayoutInfo,movableLayoutInfo,mtv,{direction:Math.atan2(moveDirVec.y,moveDirVec.x),bidirectional:!1,touchThreshold:.05})&&labelLayoutApplyTranslation(movableLayoutInfo,mtv)}function moveIfOverlapByLinearLabels(baseLayoutInfoList,baseDirVec,movableLayoutInfo,moveDirVec){for(var sameDir=Point_default.dot(moveDirVec,baseDirVec)>=0,idx=0,len$1=baseLayoutInfoList.length;idx<len$1;idx++){var labelInfo=baseLayoutInfoList[sameDir?idx:len$1-1-idx];labelInfo.label.ignore||moveIfOverlap(labelInfo,movableLayoutInfo,moveDirVec)}}var AxisBuilder=function(){function AxisBuilder$1(axisModel,api,opt,shared){this.group=new Group_default,this._axisModel=axisModel,this._api=api,this._local={},this._shared=shared||new AxisBuilderSharedContext(resolveAxisNameOverlapDefault),this._resetCfgDetermined(opt)}return AxisBuilder$1.prototype.updateCfg=function(opt){var raw=this._cfg.raw;raw.position=opt.position,raw.labelOffset=opt.labelOffset,this._resetCfgDetermined(raw)},AxisBuilder$1.prototype.__getRawCfg=function(){return this._cfg.raw},AxisBuilder$1.prototype._resetCfgDetermined=function(raw){var axisModel=this._axisModel,axisModelDefaultOption=axisModel.getDefaultOption?axisModel.getDefaultOption():{},axisName=retrieve2(raw.axisName,axisModel.get(`name`)),nameMoveOverlapOption=axisModel.get(`nameMoveOverlap`);(nameMoveOverlapOption==null||nameMoveOverlapOption===`auto`)&&(nameMoveOverlapOption=retrieve2(raw.defaultNameMoveOverlap,!0));var cfg={raw,position:raw.position,rotation:raw.rotation,nameDirection:retrieve2(raw.nameDirection,1),tickDirection:retrieve2(raw.tickDirection,1),labelDirection:retrieve2(raw.labelDirection,1),labelOffset:retrieve2(raw.labelOffset,0),silent:retrieve2(raw.silent,!0),axisName,nameLocation:retrieve3(axisModel.get(`nameLocation`),axisModelDefaultOption.nameLocation,`end`),shouldNameMoveOverlap:hasAxisName(axisName)&&nameMoveOverlapOption,optionHideOverlap:axisModel.get([`axisLabel`,`hideOverlap`]),showMinorTicks:axisModel.get([`minorTick`,`show`])};this._cfg=cfg;var transformGroup=new Group_default({x:cfg.position[0],y:cfg.position[1],rotation:cfg.rotation});transformGroup.updateTransform(),this._transformGroup=transformGroup;var record=this._shared.ensureRecord(axisModel);record.transGroup=this._transformGroup,record.dirVec=new Point_default(Math.cos(-cfg.rotation),Math.sin(-cfg.rotation))},AxisBuilder$1.prototype.build=function(axisPartNameMap,extraParams){var _this=this;return axisPartNameMap||={axisLine:!0,axisTickLabelEstimate:!1,axisTickLabelDetermine:!0,axisName:!0},each(AXIS_BUILDER_AXIS_PART_NAMES,function(partName){axisPartNameMap[partName]&&builders[partName](_this._cfg,_this._local,_this._shared,_this._axisModel,_this.group,_this._transformGroup,_this._api,extraParams||{})}),this},AxisBuilder$1.innerTextLayout=function(axisRotation,textRotation,direction){var rotationDiff=remRadian(textRotation-axisRotation),textAlign,textVerticalAlign;return isRadianAroundZero(rotationDiff)?(textVerticalAlign=direction>0?`top`:`bottom`,textAlign=`center`):isRadianAroundZero(rotationDiff-PI)?(textVerticalAlign=direction>0?`bottom`:`top`,textAlign=`center`):(textVerticalAlign=`middle`,textAlign=rotationDiff>0&&rotationDiff<PI?direction>0?`right`:`left`:direction>0?`left`:`right`),{rotation:rotationDiff,textAlign,textVerticalAlign}},AxisBuilder$1.makeAxisEventDataBase=function(axisModel){var eventData={componentType:axisModel.mainType,componentIndex:axisModel.componentIndex};return eventData[axisModel.mainType+`Index`]=axisModel.componentIndex,eventData},AxisBuilder$1.isLabelSilent=function(axisModel){var tooltipOpt=axisModel.get(`tooltip`);return axisModel.get(`silent`)||!(axisModel.get(`triggerEvent`)||tooltipOpt&&tooltipOpt.show)},AxisBuilder$1}(),AXIS_BUILDER_AXIS_PART_NAMES=[`axisLine`,`axisTickLabelEstimate`,`axisTickLabelDetermine`,`axisName`],builders={axisLine:function(cfg,local,shared,axisModel,group,transformGroup,api){var shown=axisModel.get([`axisLine`,`show`]);if(shown===`auto`&&(shown=!0,cfg.raw.axisLineAutoShow!=null&&(shown=!!cfg.raw.axisLineAutoShow)),shown){var extent=axisModel.axis.getExtent(),matrix=transformGroup.transform,pt1=[extent[0],0],pt2=[extent[1],0],inverse=pt1[0]>pt2[0];matrix&&(applyTransform(pt1,pt1,matrix),applyTransform(pt2,pt2,matrix));var lineStyle=extend({lineCap:`round`},axisModel.getModel([`axisLine`,`lineStyle`]).getLineStyle()),pathBaseProp={strokeContainThreshold:cfg.raw.strokeContainThreshold||5,silent:!0,z2:1,style:lineStyle};if(axisModel.get([`axisLine`,`breakLine`])&&axisModel.axis.scale.hasBreaks())getAxisBreakHelper().buildAxisBreakLine(axisModel,group,transformGroup,pathBaseProp);else{var line=new Line_default(extend({shape:{x1:pt1[0],y1:pt1[1],x2:pt2[0],y2:pt2[1]}},pathBaseProp));subPixelOptimizeLine(line.shape,line.style.lineWidth),line.anid=`line`,group.add(line)}var arrows=axisModel.get([`axisLine`,`symbol`]);if(arrows!=null){var arrowSize=axisModel.get([`axisLine`,`symbolSize`]);isString(arrows)&&(arrows=[arrows,arrows]),(isString(arrowSize)||isNumber(arrowSize))&&(arrowSize=[arrowSize,arrowSize]);var arrowOffset=normalizeSymbolOffset(axisModel.get([`axisLine`,`symbolOffset`])||0,arrowSize),symbolWidth_1=arrowSize[0],symbolHeight_1=arrowSize[1];each([{rotate:cfg.rotation+Math.PI/2,offset:arrowOffset[0],r:0},{rotate:cfg.rotation-Math.PI/2,offset:arrowOffset[1],r:Math.sqrt((pt1[0]-pt2[0])*(pt1[0]-pt2[0])+(pt1[1]-pt2[1])*(pt1[1]-pt2[1]))}],function(point,index){if(arrows[index]!==`none`&&arrows[index]!=null){var symbol=createSymbol(arrows[index],-symbolWidth_1/2,-symbolHeight_1/2,symbolWidth_1,symbolHeight_1,lineStyle.stroke,!0),r$1=point.r+point.offset,pt=inverse?pt2:pt1;symbol.attr({rotation:point.rotate,x:pt[0]+r$1*Math.cos(cfg.rotation),y:pt[1]-r$1*Math.sin(cfg.rotation),silent:!0,z2:11}),group.add(symbol)}})}}},axisTickLabelEstimate:function(cfg,local,shared,axisModel,group,transformGroup,api,extraParams){dealLastTickLabelResultReusable(local,group,extraParams)&&layOutAxisTickLabel(cfg,local,shared,axisModel,group,transformGroup,api,AxisTickLabelComputingKind.estimate)},axisTickLabelDetermine:function(cfg,local,shared,axisModel,group,transformGroup,api,extraParams){dealLastTickLabelResultReusable(local,group,extraParams)&&layOutAxisTickLabel(cfg,local,shared,axisModel,group,transformGroup,api,AxisTickLabelComputingKind.determine);var ticksEls=buildAxisMajorTicks(cfg,group,transformGroup,axisModel);syncLabelIgnoreToMajorTicks(cfg,local.labelLayoutList,ticksEls),buildAxisMinorTicks(cfg,group,transformGroup,axisModel,cfg.tickDirection)},axisName:function(cfg,local,shared,axisModel,group,transformGroup,api,extraParams){var sharedRecord=shared.ensureRecord(axisModel);local.nameEl&&=(group.remove(local.nameEl),sharedRecord.nameLayout=sharedRecord.nameLocation=null);var name=cfg.axisName;if(hasAxisName(name)){var nameLocation=cfg.nameLocation,nameDirection=cfg.nameDirection,textStyleModel=axisModel.getModel(`nameTextStyle`),gap=axisModel.get(`nameGap`)||0,extent=axisModel.axis.getExtent(),gapStartEndSignal=axisModel.axis.inverse?-1:1,pos=new Point_default(0,0),nameMoveDirVec=new Point_default(0,0);nameLocation===`start`?(pos.x=extent[0]-gapStartEndSignal*gap,nameMoveDirVec.x=-gapStartEndSignal):nameLocation===`end`?(pos.x=extent[1]+gapStartEndSignal*gap,nameMoveDirVec.x=gapStartEndSignal):(pos.x=(extent[0]+extent[1])/2,pos.y=cfg.labelOffset+nameDirection*gap,nameMoveDirVec.y=nameDirection);var mt=create$1();nameMoveDirVec.transform(rotate(mt,mt,cfg.rotation));var nameRotation=axisModel.get(`nameRotate`);nameRotation!=null&&(nameRotation=nameRotation*PI/180);var labelLayout,axisNameAvailableWidth;isNameLocationCenter(nameLocation)?labelLayout=AxisBuilder.innerTextLayout(cfg.rotation,nameRotation??cfg.rotation,nameDirection):(labelLayout=endTextLayout(cfg.rotation,nameLocation,nameRotation||0,extent),axisNameAvailableWidth=cfg.raw.axisNameAvailableWidth,axisNameAvailableWidth!=null&&(axisNameAvailableWidth=Math.abs(axisNameAvailableWidth/Math.sin(labelLayout.rotation)),!isFinite(axisNameAvailableWidth)&&(axisNameAvailableWidth=null)));var textFont=textStyleModel.getFont(),truncateOpt=axisModel.get(`nameTruncate`,!0)||{},ellipsis=truncateOpt.ellipsis,maxWidth=retrieve(cfg.raw.nameTruncateMaxWidth,truncateOpt.maxWidth,axisNameAvailableWidth),nameMarginLevel=extraParams.nameMarginLevel||0,textEl=new Text_default({x:pos.x,y:pos.y,rotation:labelLayout.rotation,silent:AxisBuilder.isLabelSilent(axisModel),style:createTextStyle(textStyleModel,{text:name,font:textFont,overflow:`truncate`,width:maxWidth,ellipsis,fill:textStyleModel.getTextColor()||axisModel.get([`axisLine`,`lineStyle`,`color`]),align:textStyleModel.get(`align`)||labelLayout.textAlign,verticalAlign:textStyleModel.get(`verticalAlign`)||labelLayout.textVerticalAlign}),z2:1});if(setTooltipConfig({el:textEl,componentModel:axisModel,itemName:name}),textEl.__fullText=name,textEl.anid=`name`,axisModel.get(`triggerEvent`)){var eventData=AxisBuilder.makeAxisEventDataBase(axisModel);eventData.targetType=`axisName`,eventData.name=name,getECData(textEl).eventData=eventData}transformGroup.add(textEl),textEl.updateTransform(),local.nameEl=textEl;var nameLayout=sharedRecord.nameLayout=ensureLabelLayoutWithGeometry({label:textEl,priority:textEl.z2,defaultAttr:{ignore:textEl.ignore},marginDefault:isNameLocationCenter(nameLocation)?DEFAULT_CENTER_NAME_MARGIN_LEVELS[nameMarginLevel]:DEFAULT_ENDS_NAME_MARGIN_LEVELS[nameMarginLevel]});if(sharedRecord.nameLocation=nameLocation,group.add(textEl),textEl.decomposeTransform(),cfg.shouldNameMoveOverlap&&nameLayout){var record=shared.ensureRecord(axisModel);shared.resolveAxisNameOverlap(cfg,shared,axisModel,nameLayout,nameMoveDirVec,record)}}}};function layOutAxisTickLabel(cfg,local,shared,axisModel,group,transformGroup,api,kind){axisLabelBuildResultExists(local)||buildAxisLabel(cfg,local,group,kind,axisModel,api);var labelLayoutList=local.labelLayoutList;updateAxisLabelChangableProps(cfg,axisModel,labelLayoutList,transformGroup),adjustBreakLabels(axisModel,cfg.rotation,labelLayoutList);var optionHideOverlap=cfg.optionHideOverlap;fixMinMaxLabelShow(axisModel,labelLayoutList,optionHideOverlap),optionHideOverlap&&hideOverlap(filter(labelLayoutList,function(layout$2){return layout$2&&!layout$2.label.ignore})),resetOverlapRecordToShared(cfg,shared,axisModel,labelLayoutList)}function endTextLayout(rotation,textPosition,textRotate,extent){var rotationDiff=remRadian(textRotate-rotation),textAlign,textVerticalAlign,inverse=extent[0]>extent[1],onLeft=textPosition===`start`&&!inverse||textPosition!==`start`&&inverse;return isRadianAroundZero(rotationDiff-PI/2)?(textVerticalAlign=onLeft?`bottom`:`top`,textAlign=`center`):isRadianAroundZero(rotationDiff-PI*1.5)?(textVerticalAlign=onLeft?`top`:`bottom`,textAlign=`center`):(textVerticalAlign=`middle`,textAlign=rotationDiff<PI*1.5&&rotationDiff>PI/2?onLeft?`left`:`right`:onLeft?`right`:`left`),{rotation:rotationDiff,textAlign,textVerticalAlign}}function fixMinMaxLabelShow(axisModel,labelLayoutList,optionHideOverlap){if(shouldShowAllLabels(axisModel.axis))return;function deal(showMinMaxLabel,outmostLabelIdx,innerLabelIdx){var outmostLabelLayout=ensureLabelLayoutWithGeometry(labelLayoutList[outmostLabelIdx]),innerLabelLayout=ensureLabelLayoutWithGeometry(labelLayoutList[innerLabelIdx]);if(!(!outmostLabelLayout||!innerLabelLayout)){if(showMinMaxLabel===!1||outmostLabelLayout.suggestIgnore){ignoreEl(outmostLabelLayout.label);return}if(innerLabelLayout.suggestIgnore){ignoreEl(innerLabelLayout.label);return}var touchThreshold=.1;if(!optionHideOverlap){var marginForce=[0,0,0,0];outmostLabelLayout=newLabelLayoutWithGeometry({marginForce},outmostLabelLayout),innerLabelLayout=newLabelLayoutWithGeometry({marginForce},innerLabelLayout)}labelIntersect(outmostLabelLayout,innerLabelLayout,null,{touchThreshold})&&ignoreEl(showMinMaxLabel?innerLabelLayout.label:outmostLabelLayout.label)}}var showMinLabel=axisModel.get([`axisLabel`,`showMinLabel`]),showMaxLabel=axisModel.get([`axisLabel`,`showMaxLabel`]),labelsLen=labelLayoutList.length;deal(showMinLabel,0,1),deal(showMaxLabel,labelsLen-1,labelsLen-2)}function syncLabelIgnoreToMajorTicks(cfg,labelLayoutList,tickEls){cfg.showMinorTicks||each(labelLayoutList,function(labelLayout){if(labelLayout&&labelLayout.label.ignore)for(var idx=0;idx<tickEls.length;idx++){var tickEl=tickEls[idx],tickInner=getTickInner(tickEl),labelInner$1=getLabelInner(labelLayout.label);if(tickInner.tickValue!=null&&!tickInner.onBand&&tickInner.tickValue===labelInner$1.tickValue){ignoreEl(tickEl);return}}})}function ignoreEl(el){el&&(el.ignore=!0)}function createTicks(ticksCoords,tickTransform,tickEndCoord,tickLineStyle,anidPrefix){for(var tickEls=[],pt1=[],pt2=[],i$1=0;i$1<ticksCoords.length;i$1++){var tickCoord=ticksCoords[i$1].coord;pt1[0]=tickCoord,pt1[1]=0,pt2[0]=tickCoord,pt2[1]=tickEndCoord,tickTransform&&(applyTransform(pt1,pt1,tickTransform),applyTransform(pt2,pt2,tickTransform));var tickEl=new Line_default({shape:{x1:pt1[0],y1:pt1[1],x2:pt2[0],y2:pt2[1]},style:tickLineStyle,z2:2,autoBatch:!0,silent:!0});subPixelOptimizeLine(tickEl.shape,tickEl.style.lineWidth),tickEl.anid=anidPrefix+`_`+ticksCoords[i$1].tickValue,tickEls.push(tickEl);var inner$11=getTickInner(tickEl);inner$11.onBand=!!ticksCoords[i$1].onBand,inner$11.tickValue=ticksCoords[i$1].tickValue}return tickEls}function buildAxisMajorTicks(cfg,group,transformGroup,axisModel){var axis=axisModel.axis,tickModel=axisModel.getModel(`axisTick`),shown=tickModel.get(`show`);if(shown===`auto`&&(shown=!0,cfg.raw.axisTickAutoShow!=null&&(shown=!!cfg.raw.axisTickAutoShow)),!shown||axis.scale.isBlank())return[];for(var lineStyleModel=tickModel.getModel(`lineStyle`),tickEndCoord=cfg.tickDirection*tickModel.get(`length`),ticksCoords=axis.getTicksCoords(),ticksEls=createTicks(ticksCoords,transformGroup.transform,tickEndCoord,defaults(lineStyleModel.getLineStyle(),{stroke:axisModel.get([`axisLine`,`lineStyle`,`color`])}),`ticks`),i$1=0;i$1<ticksEls.length;i$1++)group.add(ticksEls[i$1]);return ticksEls}function buildAxisMinorTicks(cfg,group,transformGroup,axisModel,tickDirection){var axis=axisModel.axis,minorTickModel=axisModel.getModel(`minorTick`);if(!(!cfg.showMinorTicks||axis.scale.isBlank())){var minorTicksCoords=axis.getMinorTicksCoords();if(minorTicksCoords.length)for(var lineStyleModel=minorTickModel.getModel(`lineStyle`),tickEndCoord=tickDirection*minorTickModel.get(`length`),minorTickLineStyle=defaults(lineStyleModel.getLineStyle(),defaults(axisModel.getModel(`axisTick`).getLineStyle(),{stroke:axisModel.get([`axisLine`,`lineStyle`,`color`])})),i$1=0;i$1<minorTicksCoords.length;i$1++)for(var minorTicksEls=createTicks(minorTicksCoords[i$1],transformGroup.transform,tickEndCoord,minorTickLineStyle,`minorticks_`+i$1),k$1=0;k$1<minorTicksEls.length;k$1++)group.add(minorTicksEls[k$1])}}function dealLastTickLabelResultReusable(local,group,extraParams){if(axisLabelBuildResultExists(local)){var noPxChangeTryDetermine=local.axisLabelsCreationContext.out.noPxChangeTryDetermine;if(extraParams.noPxChange){for(var canDetermine=!0,idx=0;idx<noPxChangeTryDetermine.length;idx++)canDetermine&&=noPxChangeTryDetermine[idx]();if(canDetermine)return!1}noPxChangeTryDetermine.length&&(group.remove(local.labelGroup),axisLabelBuildResultSet(local,null,null,null))}return!0}function buildAxisLabel(cfg,local,group,kind,axisModel,api){var axis=axisModel.axis,show=retrieve(cfg.raw.axisLabelShow,axisModel.get([`axisLabel`,`show`])),labelGroup=new Group_default;group.add(labelGroup);var axisLabelCreationCtx=createAxisLabelsComputingContext(kind);if(!show||axis.scale.isBlank()){axisLabelBuildResultSet(local,[],labelGroup,axisLabelCreationCtx);return}var labelModel=axisModel.getModel(`axisLabel`),labels=axis.getViewLabels(axisLabelCreationCtx),labelRotation=(retrieve(cfg.raw.labelRotate,labelModel.get(`rotate`))||0)*PI/180,labelLayout=AxisBuilder.innerTextLayout(cfg.rotation,labelRotation,cfg.labelDirection),rawCategoryData=axisModel.getCategories&&axisModel.getCategories(!0),labelEls=[],triggerEvent=axisModel.get(`triggerEvent`),z2Min=1/0,z2Max=-1/0;each(labels,function(labelItem,index){var _a$1,tickValue=axis.scale.type===`ordinal`?axis.scale.getRawOrdinalNumber(labelItem.tickValue):labelItem.tickValue,formattedLabel=labelItem.formattedLabel,rawLabel=labelItem.rawLabel,itemLabelModel=labelModel;if(rawCategoryData&&rawCategoryData[tickValue]){var rawCategoryItem=rawCategoryData[tickValue];isObject(rawCategoryItem)&&rawCategoryItem.textStyle&&(itemLabelModel=new Model_default(rawCategoryItem.textStyle,labelModel,axisModel.ecModel))}var textColor=itemLabelModel.getTextColor()||axisModel.get([`axisLine`,`lineStyle`,`color`]),align=itemLabelModel.getShallow(`align`,!0)||labelLayout.textAlign,alignMin=retrieve2(itemLabelModel.getShallow(`alignMinLabel`,!0),align),alignMax=retrieve2(itemLabelModel.getShallow(`alignMaxLabel`,!0),align),verticalAlign=itemLabelModel.getShallow(`verticalAlign`,!0)||itemLabelModel.getShallow(`baseline`,!0)||labelLayout.textVerticalAlign,verticalAlignMin=retrieve2(itemLabelModel.getShallow(`verticalAlignMinLabel`,!0),verticalAlign),verticalAlignMax=retrieve2(itemLabelModel.getShallow(`verticalAlignMaxLabel`,!0),verticalAlign),z2=10+(labelItem.time?.level||0);z2Min=Math.min(z2Min,z2),z2Max=Math.max(z2Max,z2);var textEl=new Text_default({x:0,y:0,rotation:0,silent:AxisBuilder.isLabelSilent(axisModel),z2,style:createTextStyle(itemLabelModel,{text:formattedLabel,align:index===0?alignMin:index===labels.length-1?alignMax:align,verticalAlign:index===0?verticalAlignMin:index===labels.length-1?verticalAlignMax:verticalAlign,fill:isFunction(textColor)?textColor(axis.type===`category`?rawLabel:axis.type===`value`?tickValue+``:tickValue,index):textColor})});textEl.anid=`label_`+tickValue;var inner$11=getLabelInner(textEl);if(inner$11.break=labelItem.break,inner$11.tickValue=tickValue,inner$11.layoutRotation=labelLayout.rotation,setTooltipConfig({el:textEl,componentModel:axisModel,itemName:formattedLabel,formatterParamsExtra:{isTruncated:function(){return textEl.isTruncated},value:rawLabel,tickIndex:index}}),triggerEvent){var eventData=AxisBuilder.makeAxisEventDataBase(axisModel);eventData.targetType=`axisLabel`,eventData.value=rawLabel,eventData.tickIndex=index,labelItem.break&&(eventData.break={start:labelItem.break.parsedBreak.vmin,end:labelItem.break.parsedBreak.vmax}),axis.type===`category`&&(eventData.dataIndex=tickValue),getECData(textEl).eventData=eventData,labelItem.break&&addBreakEventHandler(axisModel,api,textEl,labelItem.break)}labelEls.push(textEl),labelGroup.add(textEl)});var labelLayoutList=map(labelEls,function(label){return{label,priority:getLabelInner(label).break?label.z2+(z2Max-z2Min+1):label.z2,defaultAttr:{ignore:label.ignore}}});axisLabelBuildResultSet(local,labelLayoutList,labelGroup,axisLabelCreationCtx)}function axisLabelBuildResultExists(local){return!!local.labelLayoutList}function axisLabelBuildResultSet(local,labelLayoutList,labelGroup,axisLabelsCreationContext){local.labelLayoutList=labelLayoutList,local.labelGroup=labelGroup,local.axisLabelsCreationContext=axisLabelsCreationContext}function updateAxisLabelChangableProps(cfg,axisModel,labelLayoutList,transformGroup){var labelMargin=axisModel.get([`axisLabel`,`margin`]);each(labelLayoutList,function(layout$2,idx){var geometry=ensureLabelLayoutWithGeometry(layout$2);if(geometry){var labelEl=geometry.label,inner$11=getLabelInner(labelEl);geometry.suggestIgnore=labelEl.ignore,labelEl.ignore=!1,copyTransform(_tmpLayoutEl,_tmpLayoutElReset),_tmpLayoutEl.x=axisModel.axis.dataToCoord(inner$11.tickValue),_tmpLayoutEl.y=cfg.labelOffset+cfg.labelDirection*labelMargin,_tmpLayoutEl.rotation=inner$11.layoutRotation,transformGroup.add(_tmpLayoutEl),_tmpLayoutEl.updateTransform(),transformGroup.remove(_tmpLayoutEl),_tmpLayoutEl.decomposeTransform(),copyTransform(labelEl,_tmpLayoutEl),labelEl.markRedraw(),setLabelLayoutDirty(geometry,!0),ensureLabelLayoutWithGeometry(geometry)}})}var _tmpLayoutEl=new Rect_default,_tmpLayoutElReset=new Rect_default;function hasAxisName(axisName){return!!axisName}function addBreakEventHandler(axisModel,api,textEl,visualBreak){textEl.on(`click`,function(params){var payload={type:AXIS_BREAK_EXPAND_ACTION_TYPE,breaks:[{start:visualBreak.parsedBreak.breakOption.start,end:visualBreak.parsedBreak.breakOption.end}]};payload[axisModel.axis.dim+`AxisIndex`]=axisModel.componentIndex,api.dispatchAction(payload)})}function adjustBreakLabels(axisModel,axisRotation,labelLayoutList){var scaleBreakHelper=getScaleBreakHelper();if(scaleBreakHelper){var breakLabelIndexPairs=scaleBreakHelper.retrieveAxisBreakPairs(labelLayoutList,function(layoutInfo){return layoutInfo&&getLabelInner(layoutInfo.label).break},!0),moveOverlap=axisModel.get([`breakLabelLayout`,`moveOverlap`],!0);(moveOverlap===!0||moveOverlap===`auto`)&&each(breakLabelIndexPairs,function(idxPair){getAxisBreakHelper().adjustBreakLabelPair(axisModel.axis.inverse,axisRotation,[ensureLabelLayoutWithGeometry(labelLayoutList[idxPair[0]]),ensureLabelLayoutWithGeometry(labelLayoutList[idxPair[1]])])})}}var AxisBuilder_default=AxisBuilder;function layout(rect,axisModel,opt){opt||={};var axis=axisModel.axis,layout$2={},otherAxisOnZeroOf=axis.getAxesOnZeroOf()[0],rawAxisPosition=axis.position,axisPosition=otherAxisOnZeroOf?`onZero`:rawAxisPosition,axisDim=axis.dim,rectBound=[rect.x,rect.x+rect.width,rect.y,rect.y+rect.height],idx={left:0,right:1,top:0,bottom:1,onZero:2},axisOffset=axisModel.get(`offset`)||0,posBound=axisDim===`x`?[rectBound[2]-axisOffset,rectBound[3]+axisOffset]:[rectBound[0]-axisOffset,rectBound[1]+axisOffset];if(otherAxisOnZeroOf){var onZeroCoord=otherAxisOnZeroOf.toGlobalCoord(otherAxisOnZeroOf.dataToCoord(0));posBound[idx.onZero]=Math.max(Math.min(onZeroCoord,posBound[1]),posBound[0])}layout$2.position=[axisDim===`y`?posBound[idx[axisPosition]]:rectBound[0],axisDim===`x`?posBound[idx[axisPosition]]:rectBound[3]],layout$2.rotation=Math.PI/2*(axisDim===`x`?0:1),layout$2.labelDirection=layout$2.tickDirection=layout$2.nameDirection={top:-1,bottom:1,left:-1,right:1}[rawAxisPosition],layout$2.labelOffset=otherAxisOnZeroOf?posBound[idx[rawAxisPosition]]-posBound[idx.onZero]:0,axisModel.get([`axisTick`,`inside`])&&(layout$2.tickDirection=-layout$2.tickDirection),retrieve(opt.labelInside,axisModel.get([`axisLabel`,`inside`]))&&(layout$2.labelDirection=-layout$2.labelDirection);var labelRotate=axisModel.get([`axisLabel`,`rotate`]);return layout$2.labelRotate=axisPosition===`top`?-labelRotate:labelRotate,layout$2.z2=1,layout$2}function isCartesian2DInjectedAsDataCoordSys(seriesModel){return seriesModel.coordinateSystem&&seriesModel.coordinateSystem.type===`cartesian2d`}function findAxisModels(seriesModel){var axisModelMap={xAxisModel:null,yAxisModel:null};return each(axisModelMap,function(v$1,key$1){var axisType=key$1.replace(/Model$/,``);axisModelMap[key$1]=seriesModel.getReferringComponents(axisType,SINGLE_REFERRING).models[0]}),axisModelMap}function createCartesianAxisViewCommonPartBuilder(gridRect,cartesians,axisModel,api,ctx,defaultNameMoveOverlap){for(var layoutResult=layout(gridRect,axisModel),axisLineAutoShow=!1,axisTickAutoShow=!1,i$1=0;i$1<cartesians.length;i$1++)isIntervalOrLogScale(cartesians[i$1].getOtherAxis(axisModel.axis).scale)&&(axisLineAutoShow=axisTickAutoShow=!0,axisModel.axis.type===`category`&&axisModel.axis.onBand&&(axisTickAutoShow=!1));return layoutResult.axisLineAutoShow=axisLineAutoShow,layoutResult.axisTickAutoShow=axisTickAutoShow,layoutResult.defaultNameMoveOverlap=defaultNameMoveOverlap,new AxisBuilder_default(axisModel,api,layoutResult,ctx)}function updateCartesianAxisViewCommonPartBuilder(axisBuilder,gridRect,axisModel){var newRaw=layout(gridRect,axisModel);axisBuilder.updateCfg(newRaw)}function alignScaleTicks(scale$3,axisModel,alignToScale){var intervalScaleProto=Interval_default.prototype,alignToTicks=intervalScaleProto.getTicks.call(alignToScale),alignToNicedTicks=intervalScaleProto.getTicks.call(alignToScale,{expandToNicedExtent:!0}),alignToSplitNumber=alignToTicks.length-1,alignToInterval=intervalScaleProto.getInterval.call(alignToScale),scaleExtent=getScaleExtent(scale$3,axisModel),rawExtent=scaleExtent.extent,isMinFixed=scaleExtent.fixMin,isMaxFixed=scaleExtent.fixMax;scale$3.type===`log`&&(rawExtent=logTransform(scale$3.base,rawExtent,!0)),scale$3.setBreaksFromOption(retrieveAxisBreaksOption(axisModel)),scale$3.setExtent(rawExtent[0],rawExtent[1]),scale$3.calcNiceExtent({splitNumber:alignToSplitNumber,fixMin:isMinFixed,fixMax:isMaxFixed});var extent=intervalScaleProto.getExtent.call(scale$3);isMinFixed&&(rawExtent[0]=extent[0]),isMaxFixed&&(rawExtent[1]=extent[1]);var interval=intervalScaleProto.getInterval.call(scale$3),min$2=rawExtent[0],max$2=rawExtent[1];if(isMinFixed&&isMaxFixed)interval=(max$2-min$2)/alignToSplitNumber;else if(isMinFixed)for(max$2=rawExtent[0]+interval*alignToSplitNumber;max$2<rawExtent[1]&&isFinite(max$2)&&isFinite(rawExtent[1]);)interval=increaseInterval(interval),max$2=rawExtent[0]+interval*alignToSplitNumber;else if(isMaxFixed)for(min$2=rawExtent[1]-interval*alignToSplitNumber;min$2>rawExtent[0]&&isFinite(min$2)&&isFinite(rawExtent[0]);)interval=increaseInterval(interval),min$2=rawExtent[1]-interval*alignToSplitNumber;else{scale$3.getTicks().length-1>alignToSplitNumber&&(interval=increaseInterval(interval));var range=interval*alignToSplitNumber;max$2=Math.ceil(rawExtent[1]/interval)*interval,min$2=round(max$2-range),min$2<0&&rawExtent[0]>=0?(min$2=0,max$2=round(range)):max$2>0&&rawExtent[1]<=0&&(max$2=0,min$2=-round(range))}var t0=(alignToTicks[0].value-alignToNicedTicks[0].value)/alignToInterval,t1=(alignToTicks[alignToSplitNumber].value-alignToNicedTicks[alignToSplitNumber].value)/alignToInterval;intervalScaleProto.setExtent.call(scale$3,min$2+interval*t0,max$2+interval*t1),intervalScaleProto.setInterval.call(scale$3,interval),(t0||t1)&&intervalScaleProto.setNiceExtent.call(scale$3,min$2+interval,max$2-interval)}var XY_TO_MARGIN_IDX=[[3,1],[0,2]],Grid=function(){function Grid$1(gridModel,ecModel,api){this.type=`grid`,this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=cartesian2DDimensions,this._initCartesian(gridModel,ecModel,api),this.model=gridModel}return Grid$1.prototype.getRect=function(){return this._rect},Grid$1.prototype.update=function(ecModel,api){var axesMap=this._axesMap;this._updateScale(ecModel,this.model);function updateAxisTicks(axes){var alignTo,axesIndices=keys(axes),len$1=axesIndices.length;if(len$1){for(var axisNeedsAlign=[],i$1=len$1-1;i$1>=0;i$1--){var idx=+axesIndices[i$1],axis=axes[idx],model=axis.model,scale$3=axis.scale;isIntervalOrLogScale(scale$3)&&model.get(`alignTicks`)&&model.get(`interval`)==null?axisNeedsAlign.push(axis):(niceScaleExtent(scale$3,model),isIntervalOrLogScale(scale$3)&&(alignTo=axis))}axisNeedsAlign.length&&(alignTo||(alignTo=axisNeedsAlign.pop(),niceScaleExtent(alignTo.scale,alignTo.model)),each(axisNeedsAlign,function(axis$1){alignScaleTicks(axis$1.scale,axis$1.model,alignTo.scale)}))}}updateAxisTicks(axesMap.x),updateAxisTicks(axesMap.y);var onZeroRecords={};each(axesMap.x,function(xAxis){fixAxisOnZero(axesMap,`y`,xAxis,onZeroRecords)}),each(axesMap.y,function(yAxis){fixAxisOnZero(axesMap,`x`,yAxis,onZeroRecords)}),this.resize(this.model,api)},Grid$1.prototype.resize=function(gridModel,api,beforeDataProcessing){var layoutRef=createBoxLayoutReference(gridModel,api),gridRect=this._rect=getLayoutRect(gridModel.getBoxLayoutParams(),layoutRef.refContainer),axesMap=this._axesMap,coordsList=this._coordsList,optionContainLabel=gridModel.get(`containLabel`);if(updateAllAxisExtentTransByGridRect(axesMap,gridRect),!beforeDataProcessing){var axisBuilderSharedCtx=createAxisBiulders(gridRect,coordsList,axesMap,optionContainLabel,api),noPxChange=void 0;if(optionContainLabel)legacyLayOutGridByContainLabel?(legacyLayOutGridByContainLabel(this._axesList,gridRect),updateAllAxisExtentTransByGridRect(axesMap,gridRect)):noPxChange=layOutGridByOuterBounds(gridRect.clone(),`axisLabel`,null,gridRect,axesMap,axisBuilderSharedCtx,layoutRef);else{var _a$1=prepareOuterBounds(gridModel,gridRect,layoutRef),outerBoundsRect=_a$1.outerBoundsRect,parsedOuterBoundsContain=_a$1.parsedOuterBoundsContain,outerBoundsClamp=_a$1.outerBoundsClamp;outerBoundsRect&&(noPxChange=layOutGridByOuterBounds(outerBoundsRect,parsedOuterBoundsContain,outerBoundsClamp,gridRect,axesMap,axisBuilderSharedCtx,layoutRef))}createOrUpdateAxesView(gridRect,axesMap,AxisTickLabelComputingKind.determine,null,noPxChange,layoutRef)}each(this._coordsList,function(coord){coord.calcAffineTransform()})},Grid$1.prototype.getAxis=function(dim,axisIndex){var axesMapOnDim=this._axesMap[dim];if(axesMapOnDim!=null)return axesMapOnDim[axisIndex||0]},Grid$1.prototype.getAxes=function(){return this._axesList.slice()},Grid$1.prototype.getCartesian=function(xAxisIndex,yAxisIndex){if(xAxisIndex!=null&&yAxisIndex!=null){var key$1=`x`+xAxisIndex+`y`+yAxisIndex;return this._coordsMap[key$1]}isObject(xAxisIndex)&&(yAxisIndex=xAxisIndex.yAxisIndex,xAxisIndex=xAxisIndex.xAxisIndex);for(var i$1=0,coordList=this._coordsList;i$1<coordList.length;i$1++)if(coordList[i$1].getAxis(`x`).index===xAxisIndex||coordList[i$1].getAxis(`y`).index===yAxisIndex)return coordList[i$1]},Grid$1.prototype.getCartesians=function(){return this._coordsList.slice()},Grid$1.prototype.convertToPixel=function(ecModel,finder,value){var target=this._findConvertTarget(finder);return target.cartesian?target.cartesian.dataToPoint(value):target.axis?target.axis.toGlobalCoord(target.axis.dataToCoord(value)):null},Grid$1.prototype.convertFromPixel=function(ecModel,finder,value){var target=this._findConvertTarget(finder);return target.cartesian?target.cartesian.pointToData(value):target.axis?target.axis.coordToData(target.axis.toLocalCoord(value)):null},Grid$1.prototype._findConvertTarget=function(finder){var seriesModel=finder.seriesModel,xAxisModel=finder.xAxisModel||seriesModel&&seriesModel.getReferringComponents(`xAxis`,SINGLE_REFERRING).models[0],yAxisModel=finder.yAxisModel||seriesModel&&seriesModel.getReferringComponents(`yAxis`,SINGLE_REFERRING).models[0],gridModel=finder.gridModel,coordsList=this._coordsList,cartesian,axis;return seriesModel?(cartesian=seriesModel.coordinateSystem,indexOf(coordsList,cartesian)<0&&(cartesian=null)):xAxisModel&&yAxisModel?cartesian=this.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex):xAxisModel?axis=this.getAxis(`x`,xAxisModel.componentIndex):yAxisModel?axis=this.getAxis(`y`,yAxisModel.componentIndex):gridModel&&gridModel.coordinateSystem===this&&(cartesian=this._coordsList[0]),{cartesian,axis}},Grid$1.prototype.containPoint=function(point){var coord=this._coordsList[0];if(coord)return coord.containPoint(point)},Grid$1.prototype._initCartesian=function(gridModel,ecModel,api){var _this=this,grid=this,axisPositionUsed={left:!1,right:!1,top:!1,bottom:!1},axesMap={x:{},y:{}},axesCount={x:0,y:0};if(ecModel.eachComponent(`xAxis`,createAxisCreator(`x`),this),ecModel.eachComponent(`yAxis`,createAxisCreator(`y`),this),!axesCount.x||!axesCount.y){this._axesMap={},this._axesList=[];return}this._axesMap=axesMap,each(axesMap.x,function(xAxis,xAxisIndex){each(axesMap.y,function(yAxis,yAxisIndex){var key$1=`x`+xAxisIndex+`y`+yAxisIndex,cartesian=new Cartesian2D_default(key$1);cartesian.master=_this,cartesian.model=gridModel,_this._coordsMap[key$1]=cartesian,_this._coordsList.push(cartesian),cartesian.addAxis(xAxis),cartesian.addAxis(yAxis)})});function createAxisCreator(dimName){return function(axisModel,idx){if(isAxisUsedInTheGrid(axisModel,gridModel)){var axisPosition=axisModel.get(`position`);dimName===`x`?axisPosition!==`top`&&axisPosition!==`bottom`&&(axisPosition=axisPositionUsed.bottom?`top`:`bottom`):axisPosition!==`left`&&axisPosition!==`right`&&(axisPosition=axisPositionUsed.left?`right`:`left`),axisPositionUsed[axisPosition]=!0;var axis=new Axis2D_default(dimName,createScaleByModel(axisModel),[0,0],axisModel.get(`type`),axisPosition);axis.onBand=axis.type===`category`&&axisModel.get(`boundaryGap`),axis.inverse=axisModel.get(`inverse`),axisModel.axis=axis,axis.model=axisModel,axis.grid=grid,axis.index=idx,grid._axesList.push(axis),axesMap[dimName][idx]=axis,axesCount[dimName]++}}}},Grid$1.prototype._updateScale=function(ecModel,gridModel){each(this._axesList,function(axis){if(axis.scale.setExtent(1/0,-1/0),axis.type===`category`){var categorySortInfo=axis.model.get(`categorySortInfo`);axis.scale.setSortInfo(categorySortInfo)}}),ecModel.eachSeries(function(seriesModel){if(isCartesian2DInjectedAsDataCoordSys(seriesModel)){var axesModelMap=findAxisModels(seriesModel),xAxisModel=axesModelMap.xAxisModel,yAxisModel=axesModelMap.yAxisModel;if(!isAxisUsedInTheGrid(xAxisModel,gridModel)||!isAxisUsedInTheGrid(yAxisModel,gridModel))return;var cartesian=this.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex),data=seriesModel.getData(),xAxis=cartesian.getAxis(`x`),yAxis=cartesian.getAxis(`y`);unionExtent(data,xAxis),unionExtent(data,yAxis)}},this);function unionExtent(data,axis){each(getDataDimensionsOnAxis(data,axis.dim),function(dim){axis.scale.unionExtentFromData(data,dim)})}},Grid$1.prototype.getTooltipAxes=function(dim){var baseAxes=[],otherAxes=[];return each(this.getCartesians(),function(cartesian){var baseAxis=dim!=null&&dim!==`auto`?cartesian.getAxis(dim):cartesian.getBaseAxis(),otherAxis=cartesian.getOtherAxis(baseAxis);indexOf(baseAxes,baseAxis)<0&&baseAxes.push(baseAxis),indexOf(otherAxes,otherAxis)<0&&otherAxes.push(otherAxis)}),{baseAxes,otherAxes}},Grid$1.create=function(ecModel,api){var grids=[];return ecModel.eachComponent(`grid`,function(gridModel,idx){var grid=new Grid$1(gridModel,ecModel,api);grid.name=`grid_`+idx,grid.resize(gridModel,api,!0),gridModel.coordinateSystem=grid,grids.push(grid)}),ecModel.eachSeries(function(seriesModel){injectCoordSysByOption({targetModel:seriesModel,coordSysType:`cartesian2d`,coordSysProvider});function coordSysProvider(){var axesModelMap=findAxisModels(seriesModel),xAxisModel=axesModelMap.xAxisModel,yAxisModel=axesModelMap.yAxisModel;return xAxisModel.getCoordSysModel().coordinateSystem.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex)}}),grids},Grid$1.dimensions=cartesian2DDimensions,Grid$1}();function isAxisUsedInTheGrid(axisModel,gridModel){return axisModel.getCoordSysModel()===gridModel}function fixAxisOnZero(axesMap,otherAxisDim,axis,onZeroRecords){axis.getAxesOnZeroOf=function(){return otherAxisOnZeroOf?[otherAxisOnZeroOf]:[]};var otherAxes=axesMap[otherAxisDim],otherAxisOnZeroOf,axisModel=axis.model,onZero=axisModel.get([`axisLine`,`onZero`]),onZeroAxisIndex=axisModel.get([`axisLine`,`onZeroAxisIndex`]);if(!onZero)return;if(onZeroAxisIndex!=null)canOnZeroToAxis(otherAxes[onZeroAxisIndex])&&(otherAxisOnZeroOf=otherAxes[onZeroAxisIndex]);else for(var idx in otherAxes)if(otherAxes.hasOwnProperty(idx)&&canOnZeroToAxis(otherAxes[idx])&&!onZeroRecords[getOnZeroRecordKey(otherAxes[idx])]){otherAxisOnZeroOf=otherAxes[idx];break}otherAxisOnZeroOf&&(onZeroRecords[getOnZeroRecordKey(otherAxisOnZeroOf)]=!0);function getOnZeroRecordKey(axis$1){return axis$1.dim+`_`+axis$1.index}}function canOnZeroToAxis(axis){return axis&&axis.type!==`category`&&axis.type!==`time`&&ifAxisCrossZero(axis)}function updateAxisTransform(axis,coordBase){var axisExtent=axis.getExtent(),axisExtentSum=axisExtent[0]+axisExtent[1];axis.toGlobalCoord=axis.dim===`x`?function(coord){return coord+coordBase}:function(coord){return axisExtentSum-coord+coordBase},axis.toLocalCoord=axis.dim===`x`?function(coord){return coord-coordBase}:function(coord){return axisExtentSum-coord+coordBase}}function updateAllAxisExtentTransByGridRect(axesMap,gridRect){each(axesMap.x,function(axis){return updateAxisExtentTransByGridRect(axis,gridRect.x,gridRect.width)}),each(axesMap.y,function(axis){return updateAxisExtentTransByGridRect(axis,gridRect.y,gridRect.height)})}function updateAxisExtentTransByGridRect(axis,gridXY,gridWH){var extent=[0,gridWH],idx=axis.inverse?1:0;axis.setExtent(extent[idx],extent[1-idx]),updateAxisTransform(axis,gridXY)}var legacyLayOutGridByContainLabel;function layOutGridByOuterBounds(outerBoundsRect,outerBoundsContain,outerBoundsClamp,gridRect,axesMap,axisBuilderSharedCtx,layoutRef){createOrUpdateAxesView(gridRect,axesMap,AxisTickLabelComputingKind.estimate,outerBoundsContain,!1,layoutRef);var margin=[0,0,0,0];fillLabelNameOverflowOnOneDimension(0),fillLabelNameOverflowOnOneDimension(1),fillMarginOnOneDimension(gridRect,0,NaN),fillMarginOnOneDimension(gridRect,1,NaN);var noPxChange=find(margin,function(item){return item>0})==null;return expandOrShrinkRect(gridRect,margin,!0,!0,outerBoundsClamp),updateAllAxisExtentTransByGridRect(axesMap,gridRect),noPxChange;function fillLabelNameOverflowOnOneDimension(xyIdx){each(axesMap[XY[xyIdx]],function(axis){if(shouldAxisShow(axis.model)){var sharedRecord=axisBuilderSharedCtx.ensureRecord(axis.model),labelInfoList=sharedRecord.labelInfoList;if(labelInfoList)for(var idx=0;idx<labelInfoList.length;idx++){var labelInfo=labelInfoList[idx],proportion=axis.scale.normalize(getLabelInner(labelInfo.label).tickValue);proportion=xyIdx===1?1-proportion:proportion,fillMarginOnOneDimension(labelInfo.rect,xyIdx,proportion),fillMarginOnOneDimension(labelInfo.rect,1-xyIdx,NaN)}var nameLayout=sharedRecord.nameLayout;if(nameLayout){var proportion=isNameLocationCenter(sharedRecord.nameLocation)?.5:NaN;fillMarginOnOneDimension(nameLayout.rect,xyIdx,proportion),fillMarginOnOneDimension(nameLayout.rect,1-xyIdx,NaN)}}})}function fillMarginOnOneDimension(itemRect,xyIdx,proportion){var overflow1=outerBoundsRect[XY[xyIdx]]-itemRect[XY[xyIdx]],overflow2=itemRect[WH[xyIdx]]+itemRect[XY[xyIdx]]-(outerBoundsRect[WH[xyIdx]]+outerBoundsRect[XY[xyIdx]]);overflow1=applyProportion(overflow1,1-proportion),overflow2=applyProportion(overflow2,proportion);var minIdx=XY_TO_MARGIN_IDX[xyIdx][0],maxIdx=XY_TO_MARGIN_IDX[xyIdx][1];margin[minIdx]=mathMax(margin[minIdx],overflow1),margin[maxIdx]=mathMax(margin[maxIdx],overflow2)}function applyProportion(overflow,proportion){return overflow>0&&!eqNaN(proportion)&&proportion>1e-4&&(overflow/=proportion),overflow}}function createAxisBiulders(gridRect,cartesians,axesMap,optionContainLabel,api){var axisBuilderSharedCtx=new AxisBuilderSharedContext(resolveAxisNameOverlapForGrid);return each(axesMap,function(axisList){return each(axisList,function(axis){if(shouldAxisShow(axis.model)){var defaultNameMoveOverlap=!optionContainLabel;axis.axisBuilder=createCartesianAxisViewCommonPartBuilder(gridRect,cartesians,axis.model,api,axisBuilderSharedCtx,defaultNameMoveOverlap)}})}),axisBuilderSharedCtx}function createOrUpdateAxesView(gridRect,axesMap,kind,outerBoundsContain,noPxChange,layoutRef){var isDetermine=kind===AxisTickLabelComputingKind.determine;each(axesMap,function(axisList){return each(axisList,function(axis){shouldAxisShow(axis.model)&&(updateCartesianAxisViewCommonPartBuilder(axis.axisBuilder,gridRect,axis.model),axis.axisBuilder.build(isDetermine?{axisTickLabelDetermine:!0}:{axisTickLabelEstimate:!0},{noPxChange}))})});var nameMarginLevelMap={x:0,y:0};calcNameMarginLevel(0),calcNameMarginLevel(1);function calcNameMarginLevel(xyIdx){nameMarginLevelMap[XY[1-xyIdx]]=gridRect[WH[xyIdx]]<=layoutRef.refContainer[WH[xyIdx]]*.5?0:1-xyIdx==1?2:1}each(axesMap,function(axisList,xy){return each(axisList,function(axis){shouldAxisShow(axis.model)&&((outerBoundsContain===`all`||isDetermine)&&axis.axisBuilder.build({axisName:!0},{nameMarginLevel:nameMarginLevelMap[xy]}),isDetermine&&axis.axisBuilder.build({axisLine:!0}))})})}function prepareOuterBounds(gridModel,rawRridRect,layoutRef){var outerBoundsRect,optionOuterBoundsMode=gridModel.get(`outerBoundsMode`,!0);optionOuterBoundsMode===`same`?outerBoundsRect=rawRridRect.clone():(optionOuterBoundsMode==null||optionOuterBoundsMode===`auto`)&&(outerBoundsRect=getLayoutRect(gridModel.get(`outerBounds`,!0)||OUTER_BOUNDS_DEFAULT,layoutRef.refContainer));var optionOuterBoundsContain=gridModel.get(`outerBoundsContain`,!0),parsedOuterBoundsContain=optionOuterBoundsContain==null||optionOuterBoundsContain===`auto`||indexOf([`all`,`axisLabel`],optionOuterBoundsContain)<0?`all`:optionOuterBoundsContain,outerBoundsClamp=[parsePositionSizeOption(retrieve2(gridModel.get(`outerBoundsClampWidth`,!0),OUTER_BOUNDS_CLAMP_DEFAULT[0]),rawRridRect.width),parsePositionSizeOption(retrieve2(gridModel.get(`outerBoundsClampHeight`,!0),OUTER_BOUNDS_CLAMP_DEFAULT[1]),rawRridRect.height)];return{outerBoundsRect,parsedOuterBoundsContain,outerBoundsClamp}}var resolveAxisNameOverlapForGrid=function(cfg,ctx,axisModel,nameLayoutInfo,nameMoveDirVec,thisRecord){var perpendicularDim=axisModel.axis.dim===`x`?`y`:`x`;resolveAxisNameOverlapDefault(cfg,ctx,axisModel,nameLayoutInfo,nameMoveDirVec,thisRecord),isNameLocationCenter(cfg.nameLocation)||each(ctx.recordMap[perpendicularDim],function(perpenRecord){perpenRecord&&perpenRecord.labelInfoList&&perpenRecord.dirVec&&moveIfOverlapByLinearLabels(perpenRecord.labelInfoList,perpenRecord.dirVec,nameLayoutInfo,nameMoveDirVec)})},Grid_default=Grid;function collect(ecModel,api){var result={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return collectAxesInfo(result,ecModel,api),result.seriesInvolved&&collectSeriesInfo(result,ecModel),result}function collectAxesInfo(result,ecModel,api){var globalTooltipModel=ecModel.getComponent(`tooltip`),globalAxisPointerModel=ecModel.getComponent(`axisPointer`),linksOption=globalAxisPointerModel.get(`link`,!0)||[],linkGroups=[];each(api.getCoordinateSystems(),function(coordSys){if(!coordSys.axisPointerEnabled)return;var coordSysKey=makeKey(coordSys.model),axesInfoInCoordSys=result.coordSysAxesInfo[coordSysKey]={};result.coordSysMap[coordSysKey]=coordSys;var baseTooltipModel=coordSys.model.getModel(`tooltip`,globalTooltipModel);if(each(coordSys.getAxes(),curry(saveTooltipAxisInfo,!1,null)),coordSys.getTooltipAxes&&globalTooltipModel&&baseTooltipModel.get(`show`)){var triggerAxis=baseTooltipModel.get(`trigger`)===`axis`,cross=baseTooltipModel.get([`axisPointer`,`type`])===`cross`,tooltipAxes=coordSys.getTooltipAxes(baseTooltipModel.get([`axisPointer`,`axis`]));(triggerAxis||cross)&&each(tooltipAxes.baseAxes,curry(saveTooltipAxisInfo,cross?`cross`:!0,triggerAxis)),cross&&each(tooltipAxes.otherAxes,curry(saveTooltipAxisInfo,`cross`,!1))}function saveTooltipAxisInfo(fromTooltip,triggerTooltip,axis){var axisPointerModel=axis.model.getModel(`axisPointer`,globalAxisPointerModel),axisPointerShow=axisPointerModel.get(`show`);if(!(!axisPointerShow||axisPointerShow===`auto`&&!fromTooltip&&!isHandleTrigger(axisPointerModel))){triggerTooltip??=axisPointerModel.get(`triggerTooltip`),axisPointerModel=fromTooltip?makeAxisPointerModel(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip):axisPointerModel;var snap=axisPointerModel.get(`snap`),triggerEmphasis=axisPointerModel.get(`triggerEmphasis`),axisKey=makeKey(axis.model),involveSeries=triggerTooltip||snap||axis.type===`category`,axisInfo=result.axesInfo[axisKey]={key:axisKey,axis,coordSys,axisPointerModel,triggerTooltip,triggerEmphasis,involveSeries,snap,useHandle:isHandleTrigger(axisPointerModel),seriesModels:[],linkGroup:null};axesInfoInCoordSys[axisKey]=axisInfo,result.seriesInvolved=result.seriesInvolved||involveSeries;var groupIndex=getLinkGroupIndex(linksOption,axis);if(groupIndex!=null){var linkGroup=linkGroups[groupIndex]||(linkGroups[groupIndex]={axesInfo:{}});linkGroup.axesInfo[axisKey]=axisInfo,linkGroup.mapper=linksOption[groupIndex].mapper,axisInfo.linkGroup=linkGroup}}}})}function makeAxisPointerModel(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip){var tooltipAxisPointerModel=baseTooltipModel.getModel(`axisPointer`),fields=[`type`,`snap`,`lineStyle`,`shadowStyle`,`label`,`animation`,`animationDurationUpdate`,`animationEasingUpdate`,`z`],volatileOption={};each(fields,function(field){volatileOption[field]=clone(tooltipAxisPointerModel.get(field))}),volatileOption.snap=axis.type!==`category`&&!!triggerTooltip,tooltipAxisPointerModel.get(`type`)===`cross`&&(volatileOption.type=`line`);var labelOption=volatileOption.label||={};if(labelOption.show??=!1,fromTooltip===`cross`&&(labelOption.show=tooltipAxisPointerModel.get([`label`,`show`])??!0,!triggerTooltip)){var crossStyle=volatileOption.lineStyle=tooltipAxisPointerModel.get(`crossStyle`);crossStyle&&defaults(labelOption,crossStyle.textStyle)}return axis.model.getModel(`axisPointer`,new Model_default(volatileOption,globalAxisPointerModel,ecModel))}function collectSeriesInfo(result,ecModel){ecModel.eachSeries(function(seriesModel){var coordSys=seriesModel.coordinateSystem,seriesTooltipTrigger=seriesModel.get([`tooltip`,`trigger`],!0),seriesTooltipShow=seriesModel.get([`tooltip`,`show`],!0);!coordSys||!coordSys.model||seriesTooltipTrigger===`none`||seriesTooltipTrigger===!1||seriesTooltipTrigger===`item`||seriesTooltipShow===!1||seriesModel.get([`axisPointer`,`show`],!0)===!1||each(result.coordSysAxesInfo[makeKey(coordSys.model)],function(axisInfo){var axis=axisInfo.axis;coordSys.getAxis(axis.dim)===axis&&(axisInfo.seriesModels.push(seriesModel),axisInfo.seriesDataCount??=0,axisInfo.seriesDataCount+=seriesModel.getData().count())})})}function getLinkGroupIndex(linksOption,axis){for(var axisModel=axis.model,dim=axis.dim,i$1=0;i$1<linksOption.length;i$1++){var linkOption=linksOption[i$1]||{};if(checkPropInLink(linkOption[dim+`AxisId`],axisModel.id)||checkPropInLink(linkOption[dim+`AxisIndex`],axisModel.componentIndex)||checkPropInLink(linkOption[dim+`AxisName`],axisModel.name))return i$1}}function checkPropInLink(linkPropValue,axisPropValue){return linkPropValue===`all`||isArray(linkPropValue)&&indexOf(linkPropValue,axisPropValue)>=0||linkPropValue===axisPropValue}function fixValue(axisModel){var axisInfo=getAxisInfo(axisModel);if(axisInfo){var axisPointerModel=axisInfo.axisPointerModel,scale$3=axisInfo.axis.scale,option=axisPointerModel.option,status=axisPointerModel.get(`status`),value=axisPointerModel.get(`value`);value!=null&&(value=scale$3.parse(value));var useHandle=isHandleTrigger(axisPointerModel);status??(option.status=useHandle?`show`:`hide`);var extent=scale$3.getExtent().slice();extent[0]>extent[1]&&extent.reverse(),(value==null||value>extent[1])&&(value=extent[1]),value<extent[0]&&(value=extent[0]),option.value=value,useHandle&&(option.status=axisInfo.axis.scale.isBlank()?`hide`:`show`)}}function getAxisInfo(axisModel){var coordSysAxesInfo=(axisModel.ecModel.getComponent(`axisPointer`)||{}).coordSysAxesInfo;return coordSysAxesInfo&&coordSysAxesInfo.axesInfo[makeKey(axisModel)]}function getAxisPointerModel(axisModel){var axisInfo=getAxisInfo(axisModel);return axisInfo&&axisInfo.axisPointerModel}function isHandleTrigger(axisPointerModel){return!!axisPointerModel.get([`handle`,`show`])}function makeKey(model){return model.type+`||`+model.id}var axisPointerClazz={},AxisView_default=function(_super){__extends(AxisView$1,_super);function AxisView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=AxisView$1.type,_this}return AxisView$1.prototype.render=function(axisModel,ecModel,api,payload){this.axisPointerClass&&fixValue(axisModel),_super.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(axisModel,api,!0)},AxisView$1.prototype.updateAxisPointer=function(axisModel,ecModel,api,payload){this._doUpdateAxisPointerClass(axisModel,api,!1)},AxisView$1.prototype.remove=function(ecModel,api){var axisPointer=this._axisPointer;axisPointer&&axisPointer.remove(api)},AxisView$1.prototype.dispose=function(ecModel,api){this._disposeAxisPointer(api),_super.prototype.dispose.apply(this,arguments)},AxisView$1.prototype._doUpdateAxisPointerClass=function(axisModel,api,forceRender){var Clazz=AxisView$1.getAxisPointerClass(this.axisPointerClass);if(Clazz){var axisPointerModel=getAxisPointerModel(axisModel);axisPointerModel?(this._axisPointer||=new Clazz).render(axisModel,axisPointerModel,api,forceRender):this._disposeAxisPointer(api)}},AxisView$1.prototype._disposeAxisPointer=function(api){this._axisPointer&&this._axisPointer.dispose(api),this._axisPointer=null},AxisView$1.registerAxisPointerClass=function(type,clazz){axisPointerClazz[type]=clazz},AxisView$1.getAxisPointerClass=function(type){return type&&axisPointerClazz[type]},AxisView$1.type=`axis`,AxisView$1}(Component_default$1),inner$5=makeInner();function rectCoordAxisBuildSplitArea(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis;if(!axis.scale.isBlank()){var splitAreaModel=axisModel.getModel(`splitArea`),areaStyleModel=splitAreaModel.getModel(`areaStyle`),areaColors=areaStyleModel.get(`color`),gridRect=gridModel.coordinateSystem.getRect(),ticksCoords=axis.getTicksCoords({tickModel:splitAreaModel,clamp:!0,breakTicks:`none`,pruneByBreak:`preserve_extent_bound`});if(ticksCoords.length){var areaColorsLen=areaColors.length,lastSplitAreaColors=inner$5(axisView).splitAreaColors,newSplitAreaColors=createHashMap(),colorIndex=0;if(lastSplitAreaColors)for(var i$1=0;i$1<ticksCoords.length;i$1++){var cIndex=lastSplitAreaColors.get(ticksCoords[i$1].tickValue);if(cIndex!=null){colorIndex=(cIndex+(areaColorsLen-1)*i$1)%areaColorsLen;break}}var prev=axis.toGlobalCoord(ticksCoords[0].coord),areaStyle=areaStyleModel.getAreaStyle();areaColors=isArray(areaColors)?areaColors:[areaColors];for(var i$1=1;i$1<ticksCoords.length;i$1++){var tickCoord=axis.toGlobalCoord(ticksCoords[i$1].coord),x$1=void 0,y$1=void 0,width=void 0,height=void 0;axis.isHorizontal()?(x$1=prev,y$1=gridRect.y,width=tickCoord-x$1,height=gridRect.height,prev=x$1+width):(x$1=gridRect.x,y$1=prev,width=gridRect.width,height=tickCoord-y$1,prev=y$1+height);var tickValue=ticksCoords[i$1-1].tickValue;tickValue!=null&&newSplitAreaColors.set(tickValue,colorIndex),axisGroup.add(new Rect_default({anid:tickValue==null?null:`area_`+tickValue,shape:{x:x$1,y:y$1,width,height},style:defaults({fill:areaColors[colorIndex]},areaStyle),autoBatch:!0,silent:!0})),colorIndex=(colorIndex+1)%areaColorsLen}inner$5(axisView).splitAreaColors=newSplitAreaColors}}}function rectCoordAxisHandleRemove(axisView){inner$5(axisView).splitAreaColors=null}var selfBuilderAttrs=[`splitArea`,`splitLine`,`minorSplitLine`,`breakArea`],CartesianAxisView=function(_super){__extends(CartesianAxisView$1,_super);function CartesianAxisView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=CartesianAxisView$1.type,_this.axisPointerClass=`CartesianAxisPointer`,_this}return CartesianAxisView$1.prototype.render=function(axisModel,ecModel,api,payload){this.group.removeAll();var oldAxisGroup=this._axisGroup;this._axisGroup=new Group_default,this.group.add(this._axisGroup),shouldAxisShow(axisModel)&&(this._axisGroup.add(axisModel.axis.axisBuilder.group),each(selfBuilderAttrs,function(name){axisModel.get([name,`show`])&&axisElementBuilders[name](this,this._axisGroup,axisModel,axisModel.getCoordSysModel(),api)},this),payload&&payload.type===`changeAxisOrder`&&payload.isInitSort||groupTransition(oldAxisGroup,this._axisGroup,axisModel),_super.prototype.render.call(this,axisModel,ecModel,api,payload))},CartesianAxisView$1.prototype.remove=function(){rectCoordAxisHandleRemove(this)},CartesianAxisView$1.type=`cartesianAxis`,CartesianAxisView$1}(AxisView_default),axisElementBuilders={splitLine:function(axisView,axisGroup,axisModel,gridModel,api){var axis=axisModel.axis;if(!axis.scale.isBlank()){var splitLineModel=axisModel.getModel(`splitLine`),lineStyleModel=splitLineModel.getModel(`lineStyle`),lineColors=lineStyleModel.get(`color`),showMinLine=splitLineModel.get(`showMinLine`)!==!1,showMaxLine=splitLineModel.get(`showMaxLine`)!==!1;lineColors=isArray(lineColors)?lineColors:[lineColors];for(var gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),lineCount=0,ticksCoords=axis.getTicksCoords({tickModel:splitLineModel,breakTicks:`none`,pruneByBreak:`preserve_extent_bound`}),p1=[],p2=[],lineStyle=lineStyleModel.getLineStyle(),i$1=0;i$1<ticksCoords.length;i$1++){var tickCoord=axis.toGlobalCoord(ticksCoords[i$1].coord);if(!(i$1===0&&!showMinLine||i$1===ticksCoords.length-1&&!showMaxLine)){var tickValue=ticksCoords[i$1].tickValue;isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord);var colorIndex=lineCount++%lineColors.length,line=new Line_default({anid:tickValue==null?null:`line_`+tickValue,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:defaults({stroke:lineColors[colorIndex]},lineStyle),silent:!0});subPixelOptimizeLine(line.shape,lineStyle.lineWidth),axisGroup.add(line)}}}},minorSplitLine:function(axisView,axisGroup,axisModel,gridModel,api){var axis=axisModel.axis,lineStyleModel=axisModel.getModel(`minorSplitLine`).getModel(`lineStyle`),gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),minorTicksCoords=axis.getMinorTicksCoords();if(minorTicksCoords.length)for(var p1=[],p2=[],lineStyle=lineStyleModel.getLineStyle(),i$1=0;i$1<minorTicksCoords.length;i$1++)for(var k$1=0;k$1<minorTicksCoords[i$1].length;k$1++){var tickCoord=axis.toGlobalCoord(minorTicksCoords[i$1][k$1].coord);isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord);var line=new Line_default({anid:`minor_line_`+minorTicksCoords[i$1][k$1].tickValue,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:lineStyle,silent:!0});subPixelOptimizeLine(line.shape,lineStyle.lineWidth),axisGroup.add(line)}},splitArea:function(axisView,axisGroup,axisModel,gridModel,api){rectCoordAxisBuildSplitArea(axisView,axisGroup,axisModel,gridModel)},breakArea:function(axisView,axisGroup,axisModel,gridModel,api){var axisBreakHelper=getAxisBreakHelper(),scale$3=axisModel.axis.scale;axisBreakHelper&&scale$3.type!==`ordinal`&&axisBreakHelper.rectCoordBuildBreakAxis(axisGroup,axisView,axisModel,gridModel.coordinateSystem.getRect(),api)}},CartesianXAxisView=function(_super){__extends(CartesianXAxisView$1,_super);function CartesianXAxisView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView$1.type,_this}return CartesianXAxisView$1.type=`xAxis`,CartesianXAxisView$1}(CartesianAxisView),CartesianYAxisView=function(_super){__extends(CartesianYAxisView$1,_super);function CartesianYAxisView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView.type,_this}return CartesianYAxisView$1.type=`yAxis`,CartesianYAxisView$1}(CartesianAxisView),GridView=function(_super){__extends(GridView$1,_super);function GridView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`grid`,_this}return GridView$1.prototype.render=function(gridModel,ecModel){this.group.removeAll(),gridModel.get(`show`)&&this.group.add(new Rect_default({shape:gridModel.coordinateSystem.getRect(),style:defaults({fill:gridModel.get(`backgroundColor`)},gridModel.getItemStyle()),silent:!0,z2:-1}))},GridView$1.type=`grid`,GridView$1}(Component_default$1),extraOption={offset:0};function install$11(registers){registers.registerComponentView(GridView),registers.registerComponentModel(GridModel_default),registers.registerCoordinateSystem(`cartesian2d`,Grid_default),axisModelCreator(registers,`x`,CartesianAxisModel,extraOption),axisModelCreator(registers,`y`,CartesianAxisModel,extraOption),registers.registerComponentView(CartesianXAxisView),registers.registerComponentView(CartesianYAxisView),registers.registerPreprocessor(function(option){option.xAxis&&option.yAxis&&!option.grid&&(option.grid={})})}var inner$4=makeInner();function isTaken(zr,resourceKey){return!!inner$4(zr)[resourceKey]}registerAction({type:`takeGlobalCursor`,event:`globalCursorTaken`,update:`update`},noop);var IRRELEVANT_EXCLUDES={axisPointer:1,tooltip:1,brush:1};function onIrrelevantElement(e$2,api,targetComponent){var eventElComponent=api.getComponentByElement(e$2.topTarget);if(!eventElComponent||eventElComponent===targetComponent||IRRELEVANT_EXCLUDES.hasOwnProperty(eventElComponent.mainType))return!1;var eventElCoordSys=eventElComponent.coordinateSystem;if(!eventElCoordSys||eventElCoordSys.model===targetComponent)return!1;var eventElCmptZInfo=retrieveZInfo(eventElComponent),targetCmptZInfo=retrieveZInfo(targetComponent);return!((eventElCmptZInfo.zlevel-targetCmptZInfo.zlevel||eventElCmptZInfo.z-targetCmptZInfo.z)<=0)}var RoamController=function(_super){__extends(RoamController$1,_super);function RoamController$1(zr){var _this=_super.call(this)||this;_this._zr=zr;var mousedownHandler=bind(_this._mousedownHandler,_this),mousemoveHandler=bind(_this._mousemoveHandler,_this),mouseupHandler=bind(_this._mouseupHandler,_this),mousewheelHandler=bind(_this._mousewheelHandler,_this),pinchHandler=bind(_this._pinchHandler,_this);return _this.enable=function(controlType,rawOpt){var zInfo=rawOpt.zInfo,_a$1=retrieveZInfo(zInfo.component),z=_a$1.z,zlevel=_a$1.zlevel,zInfoParsed={component:zInfo.component,z,zlevel,z2:retrieve2(zInfo.z2,-1/0)},triggerInfo=extend({},rawOpt.triggerInfo);this._opt=defaults(extend({},rawOpt),{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0,zInfoParsed,triggerInfo}),controlType??=!0,(!this._enabled||this._controlType!==controlType)&&(this._enabled=!0,this.disable(),(controlType===!0||controlType===`move`||controlType===`pan`)&&(addRoamZrListener(zr,`mousedown`,mousedownHandler,zInfoParsed),addRoamZrListener(zr,`mousemove`,mousemoveHandler,zInfoParsed),addRoamZrListener(zr,`mouseup`,mouseupHandler,zInfoParsed)),(controlType===!0||controlType===`scale`||controlType===`zoom`)&&(addRoamZrListener(zr,`mousewheel`,mousewheelHandler,zInfoParsed),addRoamZrListener(zr,`pinch`,pinchHandler,zInfoParsed)))},_this.disable=function(){this._enabled=!1,removeRoamZrListener(zr,`mousedown`,mousedownHandler),removeRoamZrListener(zr,`mousemove`,mousemoveHandler),removeRoamZrListener(zr,`mouseup`,mouseupHandler),removeRoamZrListener(zr,`mousewheel`,mousewheelHandler),removeRoamZrListener(zr,`pinch`,pinchHandler)},_this}return RoamController$1.prototype.isDragging=function(){return this._dragging},RoamController$1.prototype.isPinching=function(){return this._pinching},RoamController$1.prototype._checkPointer=function(e$2,x$1,y$1){var opt=this._opt,zInfoParsed=opt.zInfoParsed;if(onIrrelevantElement(e$2,opt.api,zInfoParsed.component))return!1;var triggerInfo=opt.triggerInfo,roamTrigger=triggerInfo.roamTrigger,inArea=!1;return roamTrigger===`global`&&(inArea=!0),inArea||=triggerInfo.isInSelf(e$2,x$1,y$1),inArea&&triggerInfo.isInClip&&!triggerInfo.isInClip(e$2,x$1,y$1)&&(inArea=!1),inArea},RoamController$1.prototype._decideCursorStyle=function(e$2,x$1,y$1,forReverse){var target=e$2.target;if(!target&&this._checkPointer(e$2,x$1,y$1))return`grab`;if(forReverse)return target&&target.cursor||`default`},RoamController$1.prototype.dispose=function(){this.disable()},RoamController$1.prototype._mousedownHandler=function(e$2){if(!(isMiddleOrRightButtonOnMouseUpDown(e$2)||eventConsumed(e$2))){for(var el=e$2.target;el;){if(el.draggable)return;el=el.__hostTarget||el.parent}var x$1=e$2.offsetX,y$1=e$2.offsetY;this._checkPointer(e$2,x$1,y$1)&&(this._x=x$1,this._y=y$1,this._dragging=!0)}},RoamController$1.prototype._mousemoveHandler=function(e$2){var zr=this._zr;if(!(e$2.gestureEvent===`pinch`||isTaken(zr,`globalPan`)||eventConsumed(e$2))){var x$1=e$2.offsetX,y$1=e$2.offsetY;if(!this._dragging||!isAvailableBehavior(`moveOnMouseMove`,e$2,this._opt)){var cursorStyle=this._decideCursorStyle(e$2,x$1,y$1,!1);cursorStyle&&zr.setCursorStyle(cursorStyle);return}zr.setCursorStyle(`grabbing`);var oldX=this._x,oldY=this._y,dx=x$1-oldX,dy=y$1-oldY;this._x=x$1,this._y=y$1,this._opt.preventDefaultMouseMove&&stop(e$2.event),e$2.__ecRoamConsumed=!0,trigger(this,`pan`,`moveOnMouseMove`,e$2,{dx,dy,oldX,oldY,newX:x$1,newY:y$1,isAvailableBehavior:null})}},RoamController$1.prototype._mouseupHandler=function(e$2){if(!eventConsumed(e$2)){var zr=this._zr;if(!isMiddleOrRightButtonOnMouseUpDown(e$2)){this._dragging=!1;var cursorStyle=this._decideCursorStyle(e$2,e$2.offsetX,e$2.offsetY,!0);cursorStyle&&zr.setCursorStyle(cursorStyle)}}},RoamController$1.prototype._mousewheelHandler=function(e$2){if(!eventConsumed(e$2)){var shouldZoom=isAvailableBehavior(`zoomOnMouseWheel`,e$2,this._opt),shouldMove=isAvailableBehavior(`moveOnMouseWheel`,e$2,this._opt),wheelDelta=e$2.wheelDelta,absWheelDeltaDelta=Math.abs(wheelDelta),originX=e$2.offsetX,originY=e$2.offsetY;if(!(wheelDelta===0||!shouldZoom&&!shouldMove)){if(shouldZoom){var factor=absWheelDeltaDelta>3?1.4:absWheelDeltaDelta>1?1.2:1.1,scale$3=wheelDelta>0?factor:1/factor;this._checkTriggerMoveZoom(this,`zoom`,`zoomOnMouseWheel`,e$2,{scale:scale$3,originX,originY,isAvailableBehavior:null})}if(shouldMove){var absDelta=Math.abs(wheelDelta),scrollDelta=(wheelDelta>0?1:-1)*(absDelta>3?.4:absDelta>1?.15:.05);this._checkTriggerMoveZoom(this,`scrollMove`,`moveOnMouseWheel`,e$2,{scrollDelta,originX,originY,isAvailableBehavior:null})}}}},RoamController$1.prototype._pinchHandler=function(e$2){if(!(isTaken(this._zr,`globalPan`)||eventConsumed(e$2))){var scale$3=e$2.pinchScale>1?1.1:1/1.1;this._checkTriggerMoveZoom(this,`zoom`,null,e$2,{scale:scale$3,originX:e$2.pinchX,originY:e$2.pinchY,isAvailableBehavior:null})}},RoamController$1.prototype._checkTriggerMoveZoom=function(controller,eventName,behaviorToCheck,e$2,contollerEvent){controller._checkPointer(e$2,contollerEvent.originX,contollerEvent.originY)&&(stop(e$2.event),e$2.__ecRoamConsumed=!0,trigger(controller,eventName,behaviorToCheck,e$2,contollerEvent))},RoamController$1}(Eventful_default);function eventConsumed(e$2){return e$2.__ecRoamConsumed}var innerZrStore=makeInner();function ensureZrStore(zr){var store=innerZrStore(zr);return store.roam=store.roam||{},store.uniform=store.uniform||{},store}function addRoamZrListener(zr,eventType,listener,zInfoParsed){for(var roam=ensureZrStore(zr).roam,listenerList=roam[eventType]=roam[eventType]||[],idx=0;idx<listenerList.length;idx++){var currZInfo=listenerList[idx].zInfoParsed;if((currZInfo.zlevel-zInfoParsed.zlevel||currZInfo.z-zInfoParsed.z||currZInfo.z2-zInfoParsed.z2)<=0)break}listenerList.splice(idx,0,{listener,zInfoParsed}),ensureUniformListener(zr,eventType)}function removeRoamZrListener(zr,eventType,listener){for(var listenerList=ensureZrStore(zr).roam[eventType]||[],idx=0;idx<listenerList.length;idx++)if(listenerList[idx].listener===listener){listenerList.splice(idx,1),listenerList.length||removeUniformListener(zr,eventType);return}}function ensureUniformListener(zr,eventType){var store=ensureZrStore(zr);store.uniform[eventType]||zr.on(eventType,store.uniform[eventType]=function(event){var listenerList=store.roam[eventType];if(listenerList)for(var i$1=0;i$1<listenerList.length;i$1++)listenerList[i$1].listener(event)})}function removeUniformListener(zr,eventType){var uniform=ensureZrStore(zr).uniform;uniform[eventType]&&(zr.off(eventType,uniform[eventType]),uniform[eventType]=null)}function trigger(controller,eventName,behaviorToCheck,e$2,contollerEvent){contollerEvent.isAvailableBehavior=bind(isAvailableBehavior,null,behaviorToCheck,e$2),controller.trigger(eventName,contollerEvent)}function isAvailableBehavior(behaviorToCheck,e$2,settings){var setting=settings[behaviorToCheck];return!behaviorToCheck||setting&&(!isString(setting)||e$2.event[setting+`Key`])}var RoamController_default=RoamController;function sliderMove(delta,handleEnds,extent,handleIndex,minSpan,maxSpan){delta||=0;var extentSpan=extent[1]-extent[0];if(minSpan!=null&&(minSpan=restrict(minSpan,[0,extentSpan])),maxSpan!=null&&(maxSpan=Math.max(maxSpan,minSpan??0)),handleIndex===`all`){var handleSpan=Math.abs(handleEnds[1]-handleEnds[0]);handleSpan=restrict(handleSpan,[0,extentSpan]),minSpan=maxSpan=restrict(handleSpan,[minSpan,maxSpan]),handleIndex=0}handleEnds[0]=restrict(handleEnds[0],extent),handleEnds[1]=restrict(handleEnds[1],extent);var originalDistSign=getSpanSign(handleEnds,handleIndex);handleEnds[handleIndex]+=delta;var extentMinSpan=minSpan||0,realExtent=extent.slice();originalDistSign.sign<0?realExtent[0]+=extentMinSpan:realExtent[1]-=extentMinSpan,handleEnds[handleIndex]=restrict(handleEnds[handleIndex],realExtent);var currDistSign=getSpanSign(handleEnds,handleIndex);return minSpan!=null&&(currDistSign.sign!==originalDistSign.sign||currDistSign.span<minSpan)&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+originalDistSign.sign*minSpan),currDistSign=getSpanSign(handleEnds,handleIndex),maxSpan!=null&&currDistSign.span>maxSpan&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+currDistSign.sign*maxSpan),handleEnds}function getSpanSign(handleEnds,handleIndex){var dist$2=handleEnds[handleIndex]-handleEnds[1-handleIndex];return{span:Math.abs(dist$2),sign:dist$2>0?-1:dist$2<0?1:handleIndex?-1:1}}function restrict(value,extend$2){return Math.min(extend$2[1]==null?1/0:extend$2[1],Math.max(extend$2[0]==null?-1/0:extend$2[0],value))}var WhiskerBoxCommonMixin=function(){function WhiskerBoxCommonMixin$1(){}return WhiskerBoxCommonMixin$1.prototype._hasEncodeRule=function(key$1){var encodeRules=this.getEncode();return encodeRules&&encodeRules.get(key$1)!=null},WhiskerBoxCommonMixin$1.prototype.getInitialData=function(option,ecModel){var ordinalMeta,xAxisModel=ecModel.getComponent(`xAxis`,this.get(`xAxisIndex`)),yAxisModel=ecModel.getComponent(`yAxis`,this.get(`yAxisIndex`)),xAxisType=xAxisModel.get(`type`),yAxisType=yAxisModel.get(`type`),addOrdinal;xAxisType===`category`?(option.layout=`horizontal`,ordinalMeta=xAxisModel.getOrdinalMeta(),addOrdinal=!this._hasEncodeRule(`x`)):yAxisType===`category`?(option.layout=`vertical`,ordinalMeta=yAxisModel.getOrdinalMeta(),addOrdinal=!this._hasEncodeRule(`y`)):option.layout=option.layout||`horizontal`;var coordDims=[`x`,`y`],baseAxisDimIndex=option.layout===`horizontal`?0:1,baseAxisDim=this._baseAxisDim=coordDims[baseAxisDimIndex],otherAxisDim=coordDims[1-baseAxisDimIndex],axisModels=[xAxisModel,yAxisModel],baseAxisType=axisModels[baseAxisDimIndex].get(`type`),otherAxisType=axisModels[1-baseAxisDimIndex].get(`type`),data=option.data;if(data&&addOrdinal){var newOptionData_1=[];each(data,function(item,index){var newItem;isArray(item)?(newItem=item.slice(),item.unshift(index)):isArray(item.value)?(newItem=extend({},item),newItem.value=newItem.value.slice(),item.value.unshift(index)):newItem=item,newOptionData_1.push(newItem)}),option.data=newOptionData_1}var defaultValueDimensions=this.defaultValueDimensions,coordDimensions=[{name:baseAxisDim,type:getDimensionTypeByAxis(baseAxisType),ordinalMeta,otherDims:{tooltip:!1,itemName:0},dimsDef:[`base`]},{name:otherAxisDim,type:getDimensionTypeByAxis(otherAxisType),dimsDef:defaultValueDimensions.slice()}];return createSeriesDataSimply(this,{coordDimensions,dimensionsCount:defaultValueDimensions.length+1,encodeDefaulter:curry(makeSeriesEncodeForAxisCoordSys,coordDimensions,this)})},WhiskerBoxCommonMixin$1.prototype.getBaseAxis=function(){var dim=this._baseAxisDim;return this.ecModel.getComponent(dim+`Axis`,this.get(dim+`AxisIndex`)).axis},WhiskerBoxCommonMixin$1}(),positiveBorderColorQuery=[`itemStyle`,`borderColor`],negativeBorderColorQuery=[`itemStyle`,`borderColor0`],dojiBorderColorQuery=[`itemStyle`,`borderColorDoji`],positiveColorQuery=[`itemStyle`,`color`],negativeColorQuery=[`itemStyle`,`color0`];function getColor(sign$1,model){return model.get(sign$1>0?positiveColorQuery:negativeColorQuery)}function getBorderColor(sign$1,model){return model.get(sign$1===0?dojiBorderColorQuery:sign$1>0?positiveBorderColorQuery:negativeBorderColorQuery)}var candlestickVisual_default={seriesType:`candlestick`,plan:createRenderPlanner(),performRawSeries:!0,reset:function(seriesModel,ecModel){if(!ecModel.isSeriesFiltered(seriesModel))return!seriesModel.pipelineContext.large&&{progress:function(params,data){for(var dataIndex;(dataIndex=params.next())!=null;){var itemModel=data.getItemModel(dataIndex),sign$1=data.getItemLayout(dataIndex).sign,style=itemModel.getItemStyle();style.fill=getColor(sign$1,itemModel),style.stroke=getBorderColor(sign$1,itemModel)||style.fill;var existsStyle=data.ensureUniqueItemVisual(dataIndex,`style`);extend(existsStyle,style)}}}}},SKIP_PROPS=[`color`,`borderColor`],CandlestickView=function(_super){__extends(CandlestickView$1,_super);function CandlestickView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=CandlestickView$1.type,_this}return CandlestickView$1.prototype.render=function(seriesModel,ecModel,api){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(seriesModel),this._isLargeDraw?this._renderLarge(seriesModel):this._renderNormal(seriesModel)},CandlestickView$1.prototype.incrementalPrepareRender=function(seriesModel,ecModel,api){this._clear(),this._updateDrawMode(seriesModel)},CandlestickView$1.prototype.incrementalRender=function(params,seriesModel,ecModel,api){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(params,seriesModel):this._incrementalRenderNormal(params,seriesModel)},CandlestickView$1.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},CandlestickView$1.prototype._updateDrawMode=function(seriesModel){var isLargeDraw=seriesModel.pipelineContext.large;(this._isLargeDraw==null||isLargeDraw!==this._isLargeDraw)&&(this._isLargeDraw=isLargeDraw,this._clear())},CandlestickView$1.prototype._renderNormal=function(seriesModel){var data=seriesModel.getData(),oldData=this._data,group=this.group,isSimpleBox=data.getLayout(`isSimpleBox`),needsClip=seriesModel.get(`clip`,!0),coord=seriesModel.coordinateSystem,clipArea=coord.getArea&&coord.getArea();this._data||group.removeAll(),data.diff(oldData).add(function(newIdx){if(data.hasValue(newIdx)){var itemLayout=data.getItemLayout(newIdx);if(needsClip&&isNormalBoxClipped(clipArea,itemLayout))return;var el=createNormalBox(itemLayout,newIdx,!0);initProps(el,{shape:{points:itemLayout.ends}},seriesModel,newIdx),setBoxCommon(el,data,newIdx,isSimpleBox),group.add(el),data.setItemGraphicEl(newIdx,el)}}).update(function(newIdx,oldIdx){var el=oldData.getItemGraphicEl(oldIdx);if(!data.hasValue(newIdx)){group.remove(el);return}var itemLayout=data.getItemLayout(newIdx);if(needsClip&&isNormalBoxClipped(clipArea,itemLayout)){group.remove(el);return}el?(updateProps$1(el,{shape:{points:itemLayout.ends}},seriesModel,newIdx),saveOldStyle(el)):el=createNormalBox(itemLayout,newIdx),setBoxCommon(el,data,newIdx,isSimpleBox),group.add(el),data.setItemGraphicEl(newIdx,el)}).remove(function(oldIdx){var el=oldData.getItemGraphicEl(oldIdx);el&&group.remove(el)}).execute(),this._data=data},CandlestickView$1.prototype._renderLarge=function(seriesModel){this._clear(),createLarge(seriesModel,this.group);var clipPath=seriesModel.get(`clip`,!0)?createClipPath(seriesModel.coordinateSystem,!1,seriesModel):null;clipPath?this.group.setClipPath(clipPath):this.group.removeClipPath()},CandlestickView$1.prototype._incrementalRenderNormal=function(params,seriesModel){for(var data=seriesModel.getData(),isSimpleBox=data.getLayout(`isSimpleBox`),dataIndex;(dataIndex=params.next())!=null;){var itemLayout=data.getItemLayout(dataIndex),el=createNormalBox(itemLayout,dataIndex);setBoxCommon(el,data,dataIndex,isSimpleBox),el.incremental=!0,this.group.add(el),this._progressiveEls.push(el)}},CandlestickView$1.prototype._incrementalRenderLarge=function(params,seriesModel){createLarge(seriesModel,this.group,this._progressiveEls,!0)},CandlestickView$1.prototype.remove=function(ecModel){this._clear()},CandlestickView$1.prototype._clear=function(){this.group.removeAll(),this._data=null},CandlestickView$1.type=`candlestick`,CandlestickView$1}(Chart_default),NormalBoxPathShape=function(){function NormalBoxPathShape$1(){}return NormalBoxPathShape$1}(),NormalBoxPath=function(_super){__extends(NormalBoxPath$1,_super);function NormalBoxPath$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`normalCandlestickBox`,_this}return NormalBoxPath$1.prototype.getDefaultShape=function(){return new NormalBoxPathShape},NormalBoxPath$1.prototype.buildPath=function(ctx,shape){var ends=shape.points;this.__simpleBox?(ctx.moveTo(ends[4][0],ends[4][1]),ctx.lineTo(ends[6][0],ends[6][1])):(ctx.moveTo(ends[0][0],ends[0][1]),ctx.lineTo(ends[1][0],ends[1][1]),ctx.lineTo(ends[2][0],ends[2][1]),ctx.lineTo(ends[3][0],ends[3][1]),ctx.closePath(),ctx.moveTo(ends[4][0],ends[4][1]),ctx.lineTo(ends[5][0],ends[5][1]),ctx.moveTo(ends[6][0],ends[6][1]),ctx.lineTo(ends[7][0],ends[7][1]))},NormalBoxPath$1}(Path_default);function createNormalBox(itemLayout,dataIndex,isInit){var ends=itemLayout.ends;return new NormalBoxPath({shape:{points:isInit?transInit(ends,itemLayout):ends},z2:100})}function isNormalBoxClipped(clipArea,itemLayout){for(var clipped=!0,i$1=0;i$1<itemLayout.ends.length;i$1++)if(clipArea.contain(itemLayout.ends[i$1][0],itemLayout.ends[i$1][1])){clipped=!1;break}return clipped}function setBoxCommon(el,data,dataIndex,isSimpleBox){var itemModel=data.getItemModel(dataIndex);el.useStyle(data.getItemVisual(dataIndex,`style`)),el.style.strokeNoScale=!0,el.__simpleBox=isSimpleBox,setStatesStylesFromModel(el,itemModel);var sign$1=data.getItemLayout(dataIndex).sign;each(el.states,function(state,stateName){var stateModel=itemModel.getModel(stateName),color$2=getColor(sign$1,stateModel),borderColor=getBorderColor(sign$1,stateModel)||color$2,stateStyle=state.style||={};color$2&&(stateStyle.fill=color$2),borderColor&&(stateStyle.stroke=borderColor)});var emphasisModel=itemModel.getModel(`emphasis`);toggleHoverEmphasis(el,emphasisModel.get(`focus`),emphasisModel.get(`blurScope`),emphasisModel.get(`disabled`))}function transInit(points$1,itemLayout){return map(points$1,function(point){return point=point.slice(),point[1]=itemLayout.initBaseline,point})}var LargeBoxPathShape=function(){function LargeBoxPathShape$1(){}return LargeBoxPathShape$1}(),LargeBoxPath=function(_super){__extends(LargeBoxPath$1,_super);function LargeBoxPath$1(opts){var _this=_super.call(this,opts)||this;return _this.type=`largeCandlestickBox`,_this}return LargeBoxPath$1.prototype.getDefaultShape=function(){return new LargeBoxPathShape},LargeBoxPath$1.prototype.buildPath=function(ctx,shape){for(var points$1=shape.points,i$1=0;i$1<points$1.length;)if(this.__sign===points$1[i$1++]){var x$1=points$1[i$1++];ctx.moveTo(x$1,points$1[i$1++]),ctx.lineTo(x$1,points$1[i$1++])}else i$1+=3},LargeBoxPath$1}(Path_default);function createLarge(seriesModel,group,progressiveEls,incremental){var data=seriesModel.getData(),largePoints=data.getLayout(`largePoints`),elP=new LargeBoxPath({shape:{points:largePoints},__sign:1,ignoreCoarsePointer:!0});group.add(elP);var elN=new LargeBoxPath({shape:{points:largePoints},__sign:-1,ignoreCoarsePointer:!0});group.add(elN);var elDoji=new LargeBoxPath({shape:{points:largePoints},__sign:0,ignoreCoarsePointer:!0});group.add(elDoji),setLargeStyle(1,elP,seriesModel,data),setLargeStyle(-1,elN,seriesModel,data),setLargeStyle(0,elDoji,seriesModel,data),incremental&&(elP.incremental=!0,elN.incremental=!0),progressiveEls&&progressiveEls.push(elP,elN)}function setLargeStyle(sign$1,el,seriesModel,data){var borderColor=getBorderColor(sign$1,seriesModel)||getColor(sign$1,seriesModel),itemStyle=seriesModel.getModel(`itemStyle`).getItemStyle(SKIP_PROPS);el.useStyle(itemStyle),el.style.fill=null,el.style.stroke=borderColor}var CandlestickView_default=CandlestickView,CandlestickSeriesModel=function(_super){__extends(CandlestickSeriesModel$1,_super);function CandlestickSeriesModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=CandlestickSeriesModel$1.type,_this.defaultValueDimensions=[{name:`open`,defaultTooltip:!0},{name:`close`,defaultTooltip:!0},{name:`lowest`,defaultTooltip:!0},{name:`highest`,defaultTooltip:!0}],_this}return CandlestickSeriesModel$1.prototype.getShadowDim=function(){return`open`},CandlestickSeriesModel$1.prototype.brushSelector=function(dataIndex,data,selectors){var itemLayout=data.getItemLayout(dataIndex);return itemLayout&&selectors.rect(itemLayout.brushRect)},CandlestickSeriesModel$1.type=`series.candlestick`,CandlestickSeriesModel$1.dependencies=[`xAxis`,`yAxis`,`grid`],CandlestickSeriesModel$1.defaultOption={z:2,coordinateSystem:`cartesian2d`,legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:`#eb5454`,color0:`#47b262`,borderColor:`#eb5454`,borderColor0:`#47b262`,borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:`mod`,animationEasing:`linear`,animationDuration:300},CandlestickSeriesModel$1}(Series_default);mixin(CandlestickSeriesModel,WhiskerBoxCommonMixin,!0);var CandlestickSeries_default=CandlestickSeriesModel;function candlestickPreprocessor(option){!option||!isArray(option.series)||each(option.series,function(seriesItem){isObject(seriesItem)&&seriesItem.type===`k`&&(seriesItem.type=`candlestick`)})}var candlestickLayout={seriesType:`candlestick`,plan:createRenderPlanner(),reset:function(seriesModel){var coordSys=seriesModel.coordinateSystem,data=seriesModel.getData(),candleWidth=calculateCandleWidth(seriesModel,data),cDimIdx=0,vDimIdx=1,coordDims=[`x`,`y`],cDimI=data.getDimensionIndex(data.mapDimension(coordDims[cDimIdx])),vDimsI=map(data.mapDimensionsAll(coordDims[vDimIdx]),data.getDimensionIndex,data),openDimI=vDimsI[0],closeDimI=vDimsI[1],lowestDimI=vDimsI[2],highestDimI=vDimsI[3];if(data.setLayout({candleWidth,isSimpleBox:candleWidth<=1.3}),cDimI<0||vDimsI.length<4)return;return{progress:seriesModel.pipelineContext.large?largeProgress:normalProgress};function normalProgress(params,data$1){for(var dataIndex,store=data$1.getStore();(dataIndex=params.next())!=null;){var axisDimVal=store.get(cDimI,dataIndex),openVal=store.get(openDimI,dataIndex),closeVal=store.get(closeDimI,dataIndex),lowestVal=store.get(lowestDimI,dataIndex),highestVal=store.get(highestDimI,dataIndex),ocLow=Math.min(openVal,closeVal),ocHigh=Math.max(openVal,closeVal),ocLowPoint=getPoint(ocLow,axisDimVal),ocHighPoint=getPoint(ocHigh,axisDimVal),lowestPoint=getPoint(lowestVal,axisDimVal),highestPoint=getPoint(highestVal,axisDimVal),ends=[];addBodyEnd(ends,ocHighPoint,0),addBodyEnd(ends,ocLowPoint,1),ends.push(subPixelOptimizePoint(highestPoint),subPixelOptimizePoint(ocHighPoint),subPixelOptimizePoint(lowestPoint),subPixelOptimizePoint(ocLowPoint));var hasDojiColor=!!data$1.getItemModel(dataIndex).get([`itemStyle`,`borderColorDoji`]);data$1.setItemLayout(dataIndex,{sign:getSign(store,dataIndex,openVal,closeVal,closeDimI,hasDojiColor),initBaseline:openVal>closeVal?ocHighPoint[vDimIdx]:ocLowPoint[vDimIdx],ends,brushRect:makeBrushRect(lowestVal,highestVal,axisDimVal)})}function getPoint(val,axisDimVal$1){var p$2=[];return p$2[cDimIdx]=axisDimVal$1,p$2[vDimIdx]=val,isNaN(axisDimVal$1)||isNaN(val)?[NaN,NaN]:coordSys.dataToPoint(p$2)}function addBodyEnd(ends$1,point,start$1){var point1=point.slice(),point2=point.slice();point1[cDimIdx]=subPixelOptimize(point1[cDimIdx]+candleWidth/2,1,!1),point2[cDimIdx]=subPixelOptimize(point2[cDimIdx]-candleWidth/2,1,!0),start$1?ends$1.push(point1,point2):ends$1.push(point2,point1)}function makeBrushRect(lowestVal$1,highestVal$1,axisDimVal$1){var pmin=getPoint(lowestVal$1,axisDimVal$1),pmax=getPoint(highestVal$1,axisDimVal$1);return pmin[cDimIdx]-=candleWidth/2,pmax[cDimIdx]-=candleWidth/2,{x:pmin[0],y:pmin[1],width:vDimIdx?candleWidth:pmax[0]-pmin[0],height:vDimIdx?pmax[1]-pmin[1]:candleWidth}}function subPixelOptimizePoint(point){return point[cDimIdx]=subPixelOptimize(point[cDimIdx],1),point}}function largeProgress(params,data$1){for(var points$1=createFloat32Array(params.count*4),offset=0,point,tmpIn=[],tmpOut=[],dataIndex,store=data$1.getStore(),hasDojiColor=!!seriesModel.get([`itemStyle`,`borderColorDoji`]);(dataIndex=params.next())!=null;){var axisDimVal=store.get(cDimI,dataIndex),openVal=store.get(openDimI,dataIndex),closeVal=store.get(closeDimI,dataIndex),lowestVal=store.get(lowestDimI,dataIndex),highestVal=store.get(highestDimI,dataIndex);if(isNaN(axisDimVal)||isNaN(lowestVal)||isNaN(highestVal)){points$1[offset++]=NaN,offset+=3;continue}points$1[offset++]=getSign(store,dataIndex,openVal,closeVal,closeDimI,hasDojiColor),tmpIn[cDimIdx]=axisDimVal,tmpIn[vDimIdx]=lowestVal,point=coordSys.dataToPoint(tmpIn,null,tmpOut),points$1[offset++]=point?point[0]:NaN,points$1[offset++]=point?point[1]:NaN,tmpIn[vDimIdx]=highestVal,point=coordSys.dataToPoint(tmpIn,null,tmpOut),points$1[offset++]=point?point[1]:NaN}data$1.setLayout(`largePoints`,points$1)}}};function getSign(store,dataIndex,openVal,closeVal,closeDimI,hasDojiColor){return openVal>closeVal?-1:openVal<closeVal?1:hasDojiColor?0:dataIndex>0?store.get(closeDimI,dataIndex-1)<=closeVal?1:-1:1}function calculateCandleWidth(seriesModel,data){var baseAxis=seriesModel.getBaseAxis(),extent,bandWidth=baseAxis.type===`category`?baseAxis.getBandWidth():(extent=baseAxis.getExtent(),Math.abs(extent[1]-extent[0])/data.count()),barMaxWidth=parsePercent(retrieve2(seriesModel.get(`barMaxWidth`),bandWidth),bandWidth),barMinWidth=parsePercent(retrieve2(seriesModel.get(`barMinWidth`),1),bandWidth),barWidth=seriesModel.get(`barWidth`);return barWidth==null?Math.max(Math.min(bandWidth/2,barMaxWidth),barMinWidth):parsePercent(barWidth,bandWidth)}var candlestickLayout_default=candlestickLayout;function install(registers){registers.registerChartView(CandlestickView_default),registers.registerSeriesModel(CandlestickSeries_default),registers.registerPreprocessor(candlestickPreprocessor),registers.registerVisual(candlestickVisual_default),registers.registerLayout(candlestickLayout_default)}var inner$3=makeInner(),clone$1=clone,bind$1=bind,BaseAxisPointer=function(){function BaseAxisPointer$1(){this._dragging=!1,this.animationThreshold=15}return BaseAxisPointer$1.prototype.render=function(axisModel,axisPointerModel,api,forceRender){var value=axisPointerModel.get(`value`),status=axisPointerModel.get(`status`);if(this._axisModel=axisModel,this._axisPointerModel=axisPointerModel,this._api=api,!(!forceRender&&this._lastValue===value&&this._lastStatus===status)){this._lastValue=value,this._lastStatus=status;var group=this._group,handle=this._handle;if(!status||status===`hide`){group&&group.hide(),handle&&handle.hide();return}group&&group.show(),handle&&handle.show();var elOption={};this.makeElOption(elOption,value,axisModel,axisPointerModel,api);var graphicKey=elOption.graphicKey;graphicKey!==this._lastGraphicKey&&this.clear(api),this._lastGraphicKey=graphicKey;var moveAnimation=this._moveAnimation=this.determineAnimation(axisModel,axisPointerModel);if(!group)group=this._group=new Group_default,this.createPointerEl(group,elOption,axisModel,axisPointerModel),this.createLabelEl(group,elOption,axisModel,axisPointerModel),api.getZr().add(group);else{var doUpdateProps=curry(updateProps,axisPointerModel,moveAnimation);this.updatePointerEl(group,elOption,doUpdateProps),this.updateLabelEl(group,elOption,doUpdateProps,axisPointerModel)}updateMandatoryProps(group,axisPointerModel,!0),this._renderHandle(value)}},BaseAxisPointer$1.prototype.remove=function(api){this.clear(api)},BaseAxisPointer$1.prototype.dispose=function(api){this.clear(api)},BaseAxisPointer$1.prototype.determineAnimation=function(axisModel,axisPointerModel){var animation=axisPointerModel.get(`animation`),axis=axisModel.axis,isCategoryAxis=axis.type===`category`,useSnap=axisPointerModel.get(`snap`);if(!useSnap&&!isCategoryAxis)return!1;if(animation===`auto`||animation==null){var animationThreshold=this.animationThreshold;if(isCategoryAxis&&axis.getBandWidth()>animationThreshold)return!0;if(useSnap){var seriesDataCount=getAxisInfo(axisModel).seriesDataCount,axisExtent=axis.getExtent();return Math.abs(axisExtent[0]-axisExtent[1])/seriesDataCount>animationThreshold}return!1}return animation===!0},BaseAxisPointer$1.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){},BaseAxisPointer$1.prototype.createPointerEl=function(group,elOption,axisModel,axisPointerModel){var pointerOption=elOption.pointer;if(pointerOption){var pointerEl=inner$3(group).pointerEl=new graphic_exports[pointerOption.type](clone$1(elOption.pointer));group.add(pointerEl)}},BaseAxisPointer$1.prototype.createLabelEl=function(group,elOption,axisModel,axisPointerModel){if(elOption.label){var labelEl=inner$3(group).labelEl=new Text_default(clone$1(elOption.label));group.add(labelEl),updateLabelShowHide(labelEl,axisPointerModel)}},BaseAxisPointer$1.prototype.updatePointerEl=function(group,elOption,updateProps$3){var pointerEl=inner$3(group).pointerEl;pointerEl&&elOption.pointer&&(pointerEl.setStyle(elOption.pointer.style),updateProps$3(pointerEl,{shape:elOption.pointer.shape}))},BaseAxisPointer$1.prototype.updateLabelEl=function(group,elOption,updateProps$3,axisPointerModel){var labelEl=inner$3(group).labelEl;labelEl&&(labelEl.setStyle(elOption.label.style),updateProps$3(labelEl,{x:elOption.label.x,y:elOption.label.y}),updateLabelShowHide(labelEl,axisPointerModel))},BaseAxisPointer$1.prototype._renderHandle=function(value){if(!(this._dragging||!this.updateHandleTransform)){var axisPointerModel=this._axisPointerModel,zr=this._api.getZr(),handle=this._handle,handleModel=axisPointerModel.getModel(`handle`),status=axisPointerModel.get(`status`);if(!handleModel.get(`show`)||!status||status===`hide`){handle&&zr.remove(handle),this._handle=null;return}var isInit;this._handle||(isInit=!0,handle=this._handle=createIcon(handleModel.get(`icon`),{cursor:`move`,draggable:!0,onmousemove:function(e$2){stop(e$2.event)},onmousedown:bind$1(this._onHandleDragMove,this,0,0),drift:bind$1(this._onHandleDragMove,this),ondragend:bind$1(this._onHandleDragEnd,this)}),zr.add(handle)),updateMandatoryProps(handle,axisPointerModel,!1),handle.setStyle(handleModel.getItemStyle(null,[`color`,`borderColor`,`borderWidth`,`opacity`,`shadowColor`,`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`]));var handleSize=handleModel.get(`size`);isArray(handleSize)||(handleSize=[handleSize,handleSize]),handle.scaleX=handleSize[0]/2,handle.scaleY=handleSize[1]/2,createOrUpdate(this,`_doDispatchAxisPointer`,handleModel.get(`throttle`)||0,`fixRate`),this._moveHandleToValue(value,isInit)}},BaseAxisPointer$1.prototype._moveHandleToValue=function(value,isInit){updateProps(this._axisPointerModel,!isInit&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(value,this._axisModel,this._axisPointerModel)))},BaseAxisPointer$1.prototype._onHandleDragMove=function(dx,dy){var handle=this._handle;if(handle){this._dragging=!0;var trans=this.updateHandleTransform(getHandleTransProps(handle),[dx,dy],this._axisModel,this._axisPointerModel);this._payloadInfo=trans,handle.stopAnimation(),handle.attr(getHandleTransProps(trans)),inner$3(handle).lastProp=null,this._doDispatchAxisPointer()}},BaseAxisPointer$1.prototype._doDispatchAxisPointer=function(){if(this._handle){var payloadInfo=this._payloadInfo,axisModel=this._axisModel;this._api.dispatchAction({type:`updateAxisPointer`,x:payloadInfo.cursorPoint[0],y:payloadInfo.cursorPoint[1],tooltipOption:payloadInfo.tooltipOption,axesInfo:[{axisDim:axisModel.axis.dim,axisIndex:axisModel.componentIndex}]})}},BaseAxisPointer$1.prototype._onHandleDragEnd=function(){if(this._dragging=!1,this._handle){var value=this._axisPointerModel.get(`value`);this._moveHandleToValue(value),this._api.dispatchAction({type:`hideTip`})}},BaseAxisPointer$1.prototype.clear=function(api){this._lastValue=null,this._lastStatus=null;var zr=api.getZr(),group=this._group,handle=this._handle;zr&&group&&(this._lastGraphicKey=null,group&&zr.remove(group),handle&&zr.remove(handle),this._group=null,this._handle=null,this._payloadInfo=null),clear(this,`_doDispatchAxisPointer`)},BaseAxisPointer$1.prototype.doClear=function(){},BaseAxisPointer$1.prototype.buildLabel=function(xy,wh,xDimIndex){return xDimIndex||=0,{x:xy[xDimIndex],y:xy[1-xDimIndex],width:wh[xDimIndex],height:wh[1-xDimIndex]}},BaseAxisPointer$1}();function updateProps(animationModel,moveAnimation,el,props){propsEqual(inner$3(el).lastProp,props)||(inner$3(el).lastProp=props,moveAnimation?updateProps$1(el,props,animationModel):(el.stopAnimation(),el.attr(props)))}function propsEqual(lastProps,newProps){if(isObject(lastProps)&&isObject(newProps)){var equals_1=!0;return each(newProps,function(item,key$1){equals_1&&=propsEqual(lastProps[key$1],item)}),!!equals_1}else return lastProps===newProps}function updateLabelShowHide(labelEl,axisPointerModel){labelEl[axisPointerModel.get([`label`,`show`])?`show`:`hide`]()}function getHandleTransProps(trans){return{x:trans.x||0,y:trans.y||0,rotation:trans.rotation||0}}function updateMandatoryProps(group,axisPointerModel,silent){var z=axisPointerModel.get(`z`),zlevel=axisPointerModel.get(`zlevel`);group&&group.traverse(function(el){el.type!==`group`&&(z!=null&&(el.z=z),zlevel!=null&&(el.zlevel=zlevel),el.silent=silent)})}var BaseAxisPointer_default=BaseAxisPointer;function buildElStyle(axisPointerModel){var axisPointerType=axisPointerModel.get(`type`),styleModel=axisPointerModel.getModel(axisPointerType+`Style`),style;return axisPointerType===`line`?(style=styleModel.getLineStyle(),style.fill=null):axisPointerType===`shadow`&&(style=styleModel.getAreaStyle(),style.stroke=null),style}function buildLabelElOption(elOption,axisModel,axisPointerModel,api,labelPos){var value=axisPointerModel.get(`value`),text=getValueLabel(value,axisModel.axis,axisModel.ecModel,axisPointerModel.get(`seriesDataIndices`),{precision:axisPointerModel.get([`label`,`precision`]),formatter:axisPointerModel.get([`label`,`formatter`])}),labelModel=axisPointerModel.getModel(`label`),paddings=normalizeCssArray(labelModel.get(`padding`)||0),font=labelModel.getFont(),textRect=getBoundingRect(text,font),position=labelPos.position,width=textRect.width+paddings[1]+paddings[3],height=textRect.height+paddings[0]+paddings[2],align=labelPos.align;align===`right`&&(position[0]-=width),align===`center`&&(position[0]-=width/2);var verticalAlign=labelPos.verticalAlign;verticalAlign===`bottom`&&(position[1]-=height),verticalAlign===`middle`&&(position[1]-=height/2),confineInContainer(position,width,height,api);var bgColor=labelModel.get(`backgroundColor`);(!bgColor||bgColor===`auto`)&&(bgColor=axisModel.get([`axisLine`,`lineStyle`,`color`])),elOption.label={x:position[0],y:position[1],style:createTextStyle(labelModel,{text,font,fill:labelModel.getTextColor(),padding:paddings,backgroundColor:bgColor}),z2:10}}function confineInContainer(position,width,height,api){var viewWidth=api.getWidth(),viewHeight=api.getHeight();position[0]=Math.min(position[0]+width,viewWidth)-width,position[1]=Math.min(position[1]+height,viewHeight)-height,position[0]=Math.max(position[0],0),position[1]=Math.max(position[1],0)}function getValueLabel(value,axis,ecModel,seriesDataIndices,opt){value=axis.scale.parse(value);var text=axis.scale.getLabel({value},{precision:opt.precision}),formatter=opt.formatter;if(formatter){var params_1={value:getAxisRawValue(axis,{value}),axisDimension:axis.dim,axisIndex:axis.index,seriesData:[]};each(seriesDataIndices,function(idxItem){var series=ecModel.getSeriesByIndex(idxItem.seriesIndex),dataIndex=idxItem.dataIndexInside,dataParams=series&&series.getDataParams(dataIndex);dataParams&&params_1.seriesData.push(dataParams)}),isString(formatter)?text=formatter.replace(`{value}`,text):isFunction(formatter)&&(text=formatter(params_1))}return text}function getTransformedPosition(axis,value,layoutInfo){var transform=create$1();return rotate(transform,transform,layoutInfo.rotation),translate(transform,transform,layoutInfo.position),applyTransform$1([axis.dataToCoord(value),(layoutInfo.labelOffset||0)+(layoutInfo.labelDirection||1)*(layoutInfo.labelMargin||0)],transform)}function buildCartesianSingleLabelElOption(value,elOption,layoutInfo,axisModel,axisPointerModel,api){var textLayout=AxisBuilder_default.innerTextLayout(layoutInfo.rotation,0,layoutInfo.labelDirection);layoutInfo.labelMargin=axisPointerModel.get([`label`,`margin`]),buildLabelElOption(elOption,axisModel,axisPointerModel,api,{position:getTransformedPosition(axisModel.axis,value,layoutInfo),align:textLayout.textAlign,verticalAlign:textLayout.textVerticalAlign})}function makeLineShape(p1,p2,xDimIndex){return xDimIndex||=0,{x1:p1[xDimIndex],y1:p1[1-xDimIndex],x2:p2[xDimIndex],y2:p2[1-xDimIndex]}}function makeRectShape(xy,wh,xDimIndex){return xDimIndex||=0,{x:xy[xDimIndex],y:xy[1-xDimIndex],width:wh[xDimIndex],height:wh[1-xDimIndex]}}var CartesianAxisPointer=function(_super){__extends(CartesianAxisPointer$1,_super);function CartesianAxisPointer$1(){return _super!==null&&_super.apply(this,arguments)||this}return CartesianAxisPointer$1.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){var axis=axisModel.axis,grid=axis.grid,axisPointerType=axisPointerModel.get(`type`),otherExtent=getCartesian(grid,axis).getOtherAxis(axis).getGlobalExtent(),pixelValue=axis.toGlobalCoord(axis.dataToCoord(value,!0));if(axisPointerType&&axisPointerType!==`none`){var elStyle=buildElStyle(axisPointerModel),pointerOption=pointerShapeBuilder[axisPointerType](axis,pixelValue,otherExtent);pointerOption.style=elStyle,elOption.graphicKey=pointerOption.type,elOption.pointer=pointerOption}var layoutInfo=layout(grid.getRect(),axisModel);buildCartesianSingleLabelElOption(value,elOption,layoutInfo,axisModel,axisPointerModel,api)},CartesianAxisPointer$1.prototype.getHandleTransform=function(value,axisModel,axisPointerModel){var layoutInfo=layout(axisModel.axis.grid.getRect(),axisModel,{labelInside:!1});layoutInfo.labelMargin=axisPointerModel.get([`handle`,`margin`]);var pos=getTransformedPosition(axisModel.axis,value,layoutInfo);return{x:pos[0],y:pos[1],rotation:layoutInfo.rotation+(layoutInfo.labelDirection<0?Math.PI:0)}},CartesianAxisPointer$1.prototype.updateHandleTransform=function(transform,delta,axisModel,axisPointerModel){var axis=axisModel.axis,grid=axis.grid,axisExtent=axis.getGlobalExtent(!0),otherExtent=getCartesian(grid,axis).getOtherAxis(axis).getGlobalExtent(),dimIndex=axis.dim===`x`?0:1,currPosition=[transform.x,transform.y];currPosition[dimIndex]+=delta[dimIndex],currPosition[dimIndex]=Math.min(axisExtent[1],currPosition[dimIndex]),currPosition[dimIndex]=Math.max(axisExtent[0],currPosition[dimIndex]);var cursorOtherValue=(otherExtent[1]+otherExtent[0])/2,cursorPoint=[cursorOtherValue,cursorOtherValue];return cursorPoint[dimIndex]=currPosition[dimIndex],{x:currPosition[0],y:currPosition[1],rotation:transform.rotation,cursorPoint,tooltipOption:[{verticalAlign:`middle`},{align:`center`}][dimIndex]}},CartesianAxisPointer$1}(BaseAxisPointer_default);function getCartesian(grid,axis){var opt={};return opt[axis.dim+`AxisIndex`]=axis.index,grid.getCartesian(opt)}var pointerShapeBuilder={line:function(axis,pixelValue,otherExtent){return{type:`Line`,subPixelOptimize:!0,shape:makeLineShape([pixelValue,otherExtent[0]],[pixelValue,otherExtent[1]],getAxisDimIndex(axis))}},shadow:function(axis,pixelValue,otherExtent){var bandWidth=Math.max(1,axis.getBandWidth()),span=otherExtent[1]-otherExtent[0];return{type:`Rect`,shape:makeRectShape([pixelValue-bandWidth/2,otherExtent[0]],[bandWidth,span],getAxisDimIndex(axis))}}};function getAxisDimIndex(axis){return axis.dim===`x`?0:1}var CartesianAxisPointer_default=CartesianAxisPointer,AxisPointerModel_default=function(_super){__extends(AxisPointerModel$1,_super);function AxisPointerModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=AxisPointerModel$1.type,_this}return AxisPointerModel$1.type=`axisPointer`,AxisPointerModel$1.defaultOption={show:`auto`,z:50,type:`line`,snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:tokens_default.color.border,width:1,type:`dashed`},shadowStyle:{color:tokens_default.color.shadowTint},label:{show:!0,formatter:null,precision:`auto`,margin:3,color:tokens_default.color.neutral00,padding:[5,7,5,7],backgroundColor:tokens_default.color.accent60,borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:`M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z`,size:45,margin:50,color:tokens_default.color.accent40,throttle:40}},AxisPointerModel$1}(Component_default),inner$2=makeInner(),each$2=each;function register(key$1,api,handler){if(!env_default.node){var zr=api.getZr();inner$2(zr).records||(inner$2(zr).records={}),initGlobalListeners(zr,api);var record=inner$2(zr).records[key$1]||(inner$2(zr).records[key$1]={});record.handler=handler}}function initGlobalListeners(zr,api){if(inner$2(zr).initialized)return;inner$2(zr).initialized=!0,useHandler(`click`,curry(doEnter,`click`)),useHandler(`mousemove`,curry(doEnter,`mousemove`)),useHandler(`globalout`,onLeave);function useHandler(eventType,cb){zr.on(eventType,function(e$2){var dis=makeDispatchAction$1(api);each$2(inner$2(zr).records,function(record){record&&cb(record,e$2,dis.dispatchAction)}),dispatchTooltipFinally(dis.pendings,api)})}}function dispatchTooltipFinally(pendings,api){var showLen=pendings.showTip.length,hideLen=pendings.hideTip.length,actuallyPayload;showLen?actuallyPayload=pendings.showTip[showLen-1]:hideLen&&(actuallyPayload=pendings.hideTip[hideLen-1]),actuallyPayload&&(actuallyPayload.dispatchAction=null,api.dispatchAction(actuallyPayload))}function onLeave(record,e$2,dispatchAction$1){record.handler(`leave`,null,dispatchAction$1)}function doEnter(currTrigger,record,e$2,dispatchAction$1){record.handler(currTrigger,e$2,dispatchAction$1)}function makeDispatchAction$1(api){var pendings={showTip:[],hideTip:[]},dispatchAction$1=function(payload){var pendingList=pendings[payload.type];pendingList?pendingList.push(payload):(payload.dispatchAction=dispatchAction$1,api.dispatchAction(payload))};return{dispatchAction:dispatchAction$1,pendings}}function unregister(key$1,api){if(!env_default.node){var zr=api.getZr();(inner$2(zr).records||{})[key$1]&&(inner$2(zr).records[key$1]=null)}}var AxisPointerView_default=function(_super){__extends(AxisPointerView$1,_super);function AxisPointerView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=AxisPointerView$1.type,_this}return AxisPointerView$1.prototype.render=function(globalAxisPointerModel,ecModel,api){var globalTooltipModel=ecModel.getComponent(`tooltip`),triggerOn=globalAxisPointerModel.get(`triggerOn`)||globalTooltipModel&&globalTooltipModel.get(`triggerOn`)||`mousemove|click`;register(`axisPointer`,api,function(currTrigger,e$2,dispatchAction$1){triggerOn!==`none`&&(currTrigger===`leave`||triggerOn.indexOf(currTrigger)>=0)&&dispatchAction$1({type:`updateAxisPointer`,currTrigger,x:e$2&&e$2.offsetX,y:e$2&&e$2.offsetY})})},AxisPointerView$1.prototype.remove=function(ecModel,api){unregister(`axisPointer`,api)},AxisPointerView$1.prototype.dispose=function(ecModel,api){unregister(`axisPointer`,api)},AxisPointerView$1.type=`axisPointer`,AxisPointerView$1}(Component_default$1);function findPointFromSeries(finder,ecModel){var point=[],seriesIndex=finder.seriesIndex,seriesModel;if(seriesIndex==null||!(seriesModel=ecModel.getSeriesByIndex(seriesIndex)))return{point:[]};var data=seriesModel.getData(),dataIndex=queryDataIndex(data,finder);if(dataIndex==null||dataIndex<0||isArray(dataIndex))return{point:[]};var el=data.getItemGraphicEl(dataIndex),coordSys=seriesModel.coordinateSystem;if(seriesModel.getTooltipPosition)point=seriesModel.getTooltipPosition(dataIndex)||[];else if(coordSys&&coordSys.dataToPoint)if(finder.isStacked){var baseAxis=coordSys.getBaseAxis(),valueAxisDim=coordSys.getOtherAxis(baseAxis).dim,baseAxisDim=baseAxis.dim,baseDataOffset=valueAxisDim===`x`||valueAxisDim===`radius`?1:0,baseDim=data.mapDimension(baseAxisDim),stackedData=[];stackedData[baseDataOffset]=data.get(baseDim,dataIndex),stackedData[1-baseDataOffset]=data.get(data.getCalculationInfo(`stackResultDimension`),dataIndex),point=coordSys.dataToPoint(stackedData)||[]}else point=coordSys.dataToPoint(data.getValues(map(coordSys.dimensions,function(dim){return data.mapDimension(dim)}),dataIndex))||[];else if(el){var rect=el.getBoundingRect().clone();rect.applyTransform(el.transform),point=[rect.x+rect.width/2,rect.y+rect.height/2]}return{point,el}}var inner$1=makeInner();function axisTrigger(payload,ecModel,api){var currTrigger=payload.currTrigger,point=[payload.x,payload.y],finder=payload,dispatchAction$1=payload.dispatchAction||bind(api.dispatchAction,api),coordSysAxesInfo=ecModel.getComponent(`axisPointer`).coordSysAxesInfo;if(coordSysAxesInfo){illegalPoint(point)&&(point=findPointFromSeries({seriesIndex:finder.seriesIndex,dataIndex:finder.dataIndex},ecModel).point);var isIllegalPoint=illegalPoint(point),inputAxesInfo=finder.axesInfo,axesInfo=coordSysAxesInfo.axesInfo,shouldHide=currTrigger===`leave`||illegalPoint(point),outputPayload={},showValueMap={},dataByCoordSys={list:[],map:{}},updaters={showPointer:curry(showPointer,showValueMap),showTooltip:curry(showTooltip,dataByCoordSys)};each(coordSysAxesInfo.coordSysMap,function(coordSys,coordSysKey){var coordSysContainsPoint=isIllegalPoint||coordSys.containPoint(point);each(coordSysAxesInfo.coordSysAxesInfo[coordSysKey],function(axisInfo,key$1){var axis=axisInfo.axis,inputAxisInfo=findInputAxisInfo(inputAxesInfo,axisInfo);if(!shouldHide&&coordSysContainsPoint&&(!inputAxesInfo||inputAxisInfo)){var val=inputAxisInfo&&inputAxisInfo.value;val==null&&!isIllegalPoint&&(val=axis.pointToData(point)),val!=null&&processOnAxis(axisInfo,val,updaters,!1,outputPayload)}})});var linkTriggers={};return each(axesInfo,function(tarAxisInfo,tarKey){var linkGroup=tarAxisInfo.linkGroup;linkGroup&&!showValueMap[tarKey]&&each(linkGroup.axesInfo,function(srcAxisInfo,srcKey){var srcValItem=showValueMap[srcKey];if(srcAxisInfo!==tarAxisInfo&&srcValItem){var val=srcValItem.value;linkGroup.mapper&&(val=tarAxisInfo.axis.scale.parse(linkGroup.mapper(val,makeMapperParam(srcAxisInfo),makeMapperParam(tarAxisInfo)))),linkTriggers[tarAxisInfo.key]=val}})}),each(linkTriggers,function(val,tarKey){processOnAxis(axesInfo[tarKey],val,updaters,!0,outputPayload)}),updateModelActually(showValueMap,axesInfo,outputPayload),dispatchTooltipActually(dataByCoordSys,point,payload,dispatchAction$1),dispatchHighDownActually(axesInfo,dispatchAction$1,api),outputPayload}}function processOnAxis(axisInfo,newValue,updaters,noSnap,outputFinder){var axis=axisInfo.axis;if(!(axis.scale.isBlank()||!axis.containData(newValue))){if(!axisInfo.involveSeries){updaters.showPointer(axisInfo,newValue);return}var payloadInfo=buildPayloadsBySeries(newValue,axisInfo),payloadBatch=payloadInfo.payloadBatch,snapToValue=payloadInfo.snapToValue;payloadBatch[0]&&outputFinder.seriesIndex==null&&extend(outputFinder,payloadBatch[0]),!noSnap&&axisInfo.snap&&axis.containData(snapToValue)&&snapToValue!=null&&(newValue=snapToValue),updaters.showPointer(axisInfo,newValue,payloadBatch),updaters.showTooltip(axisInfo,payloadInfo,snapToValue)}}function buildPayloadsBySeries(value,axisInfo){var axis=axisInfo.axis,dim=axis.dim,snapToValue=value,payloadBatch=[],minDist=Number.MAX_VALUE,minDiff=-1;return each(axisInfo.seriesModels,function(series,idx){var dataDim=series.getData().mapDimensionsAll(dim),seriesNestestValue,dataIndices;if(series.getAxisTooltipData){var result=series.getAxisTooltipData(dataDim,value,axis);dataIndices=result.dataIndices,seriesNestestValue=result.nestestValue}else{if(dataIndices=series.indicesOfNearest(dim,dataDim[0],value,axis.type===`category`?.5:null),!dataIndices.length)return;seriesNestestValue=series.getData().get(dataDim[0],dataIndices[0])}if(!(seriesNestestValue==null||!isFinite(seriesNestestValue))){var diff=value-seriesNestestValue,dist$2=Math.abs(diff);dist$2<=minDist&&((dist$2<minDist||diff>=0&&minDiff<0)&&(minDist=dist$2,minDiff=diff,snapToValue=seriesNestestValue,payloadBatch.length=0),each(dataIndices,function(dataIndex){payloadBatch.push({seriesIndex:series.seriesIndex,dataIndexInside:dataIndex,dataIndex:series.getData().getRawIndex(dataIndex)})}))}}),{payloadBatch,snapToValue}}function showPointer(showValueMap,axisInfo,value,payloadBatch){showValueMap[axisInfo.key]={value,payloadBatch}}function showTooltip(dataByCoordSys,axisInfo,payloadInfo,value){var payloadBatch=payloadInfo.payloadBatch,axis=axisInfo.axis,axisModel=axis.model,axisPointerModel=axisInfo.axisPointerModel;if(!(!axisInfo.triggerTooltip||!payloadBatch.length)){var coordSysModel=axisInfo.coordSys.model,coordSysKey=makeKey(coordSysModel),coordSysItem=dataByCoordSys.map[coordSysKey];coordSysItem||(coordSysItem=dataByCoordSys.map[coordSysKey]={coordSysId:coordSysModel.id,coordSysIndex:coordSysModel.componentIndex,coordSysType:coordSysModel.type,coordSysMainType:coordSysModel.mainType,dataByAxis:[]},dataByCoordSys.list.push(coordSysItem)),coordSysItem.dataByAxis.push({axisDim:axis.dim,axisIndex:axisModel.componentIndex,axisType:axisModel.type,axisId:axisModel.id,value,valueLabelOpt:{precision:axisPointerModel.get([`label`,`precision`]),formatter:axisPointerModel.get([`label`,`formatter`])},seriesDataIndices:payloadBatch.slice()})}}function updateModelActually(showValueMap,axesInfo,outputPayload){var outputAxesInfo=outputPayload.axesInfo=[];each(axesInfo,function(axisInfo,key$1){var option=axisInfo.axisPointerModel.option,valItem=showValueMap[key$1];valItem?(!axisInfo.useHandle&&(option.status=`show`),option.value=valItem.value,option.seriesDataIndices=(valItem.payloadBatch||[]).slice()):!axisInfo.useHandle&&(option.status=`hide`),option.status===`show`&&outputAxesInfo.push({axisDim:axisInfo.axis.dim,axisIndex:axisInfo.axis.model.componentIndex,value:option.value})})}function dispatchTooltipActually(dataByCoordSys,point,payload,dispatchAction$1){if(illegalPoint(point)||!dataByCoordSys.list.length){dispatchAction$1({type:`hideTip`});return}var sampleItem=((dataByCoordSys.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};dispatchAction$1({type:`showTip`,escapeConnect:!0,x:point[0],y:point[1],tooltipOption:payload.tooltipOption,position:payload.position,dataIndexInside:sampleItem.dataIndexInside,dataIndex:sampleItem.dataIndex,seriesIndex:sampleItem.seriesIndex,dataByCoordSys:dataByCoordSys.list})}function dispatchHighDownActually(axesInfo,dispatchAction$1,api){var zr=api.getZr(),highDownKey=`axisPointerLastHighlights`,lastHighlights=inner$1(zr)[highDownKey]||{},newHighlights=inner$1(zr)[highDownKey]={};each(axesInfo,function(axisInfo,key$1){var option=axisInfo.axisPointerModel.option;option.status===`show`&&axisInfo.triggerEmphasis&&each(option.seriesDataIndices,function(batchItem){var key$2=batchItem.seriesIndex+` | `+batchItem.dataIndex;newHighlights[key$2]=batchItem})});var toHighlight=[],toDownplay=[];each(lastHighlights,function(batchItem,key$1){!newHighlights[key$1]&&toDownplay.push(batchItem)}),each(newHighlights,function(batchItem,key$1){!lastHighlights[key$1]&&toHighlight.push(batchItem)}),toDownplay.length&&api.dispatchAction({type:`downplay`,escapeConnect:!0,notBlur:!0,batch:toDownplay}),toHighlight.length&&api.dispatchAction({type:`highlight`,escapeConnect:!0,notBlur:!0,batch:toHighlight})}function findInputAxisInfo(inputAxesInfo,axisInfo){for(var i$1=0;i$1<(inputAxesInfo||[]).length;i$1++){var inputAxisInfo=inputAxesInfo[i$1];if(axisInfo.axis.dim===inputAxisInfo.axisDim&&axisInfo.axis.model.componentIndex===inputAxisInfo.axisIndex)return inputAxisInfo}}function makeMapperParam(axisInfo){var axisModel=axisInfo.axis.model,item={},dim=item.axisDim=axisInfo.axis.dim;return item.axisIndex=item[dim+`AxisIndex`]=axisModel.componentIndex,item.axisName=item[dim+`AxisName`]=axisModel.name,item.axisId=item[dim+`AxisId`]=axisModel.id,item}function illegalPoint(point){return!point||point[0]==null||isNaN(point[0])||point[1]==null||isNaN(point[1])}function install$10(registers){AxisView_default.registerAxisPointerClass(`CartesianAxisPointer`,CartesianAxisPointer_default),registers.registerComponentModel(AxisPointerModel_default),registers.registerComponentView(AxisPointerView_default),registers.registerPreprocessor(function(option){if(option){(!option.axisPointer||option.axisPointer.length===0)&&(option.axisPointer={});var link=option.axisPointer.link;link&&!isArray(link)&&(option.axisPointer.link=[link])}}),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,function(ecModel,api){ecModel.getComponent(`axisPointer`).coordSysAxesInfo=collect(ecModel,api)}),registers.registerAction({type:`updateAxisPointer`,event:`updateAxisPointer`,update:`:updateAxisPointer`},axisTrigger)}function install$3(registers){use(install$11),use(install$10)}var DATA_ZOOM_AXIS_DIMENSIONS=[`x`,`y`,`radius`,`angle`,`single`],SERIES_COORDS=[`cartesian2d`,`polar`,`singleAxis`];function isCoordSupported(seriesModel){var coordType=seriesModel.get(`coordinateSystem`);return indexOf(SERIES_COORDS,coordType)>=0}function getAxisMainType(axisDim){return axisDim+`Axis`}function findEffectedDataZooms(ecModel,payload){var axisRecords=createHashMap(),effectedModels=[],effectedModelMap=createHashMap();ecModel.eachComponent({mainType:`dataZoom`,query:payload},function(dataZoomModel){effectedModelMap.get(dataZoomModel.uid)||addToEffected(dataZoomModel)});var foundNewLink;do foundNewLink=!1,ecModel.eachComponent(`dataZoom`,processSingle);while(foundNewLink);function processSingle(dataZoomModel){!effectedModelMap.get(dataZoomModel.uid)&&isLinked(dataZoomModel)&&(addToEffected(dataZoomModel),foundNewLink=!0)}function addToEffected(dataZoom){effectedModelMap.set(dataZoom.uid,!0),effectedModels.push(dataZoom),markAxisControlled(dataZoom)}function isLinked(dataZoomModel){var isLink=!1;return dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var axisIdxArr=axisRecords.get(axisDim);axisIdxArr&&axisIdxArr[axisIndex]&&(isLink=!0)}),isLink}function markAxisControlled(dataZoomModel){dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){(axisRecords.get(axisDim)||axisRecords.set(axisDim,[]))[axisIndex]=!0})}return effectedModels}function collectReferCoordSysModelInfo(dataZoomModel){var ecModel=dataZoomModel.ecModel,coordSysInfoWrap={infoList:[],infoMap:createHashMap()};return dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var axisModel=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);if(axisModel){var coordSysModel=axisModel.getCoordSysModel();if(coordSysModel){var coordSysUid=coordSysModel.uid,coordSysInfo=coordSysInfoWrap.infoMap.get(coordSysUid);coordSysInfo||(coordSysInfo={model:coordSysModel,axisModels:[]},coordSysInfoWrap.infoList.push(coordSysInfo),coordSysInfoWrap.infoMap.set(coordSysUid,coordSysInfo)),coordSysInfo.axisModels.push(axisModel)}}}),coordSysInfoWrap}var DataZoomAxisInfo=function(){function DataZoomAxisInfo$1(){this.indexList=[],this.indexMap=[]}return DataZoomAxisInfo$1.prototype.add=function(axisCmptIdx){this.indexMap[axisCmptIdx]||(this.indexList.push(axisCmptIdx),this.indexMap[axisCmptIdx]=!0)},DataZoomAxisInfo$1}(),DataZoomModel=function(_super){__extends(DataZoomModel$1,_super);function DataZoomModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=DataZoomModel$1.type,_this._autoThrottle=!0,_this._noTarget=!0,_this._rangePropMode=[`percent`,`percent`],_this}return DataZoomModel$1.prototype.init=function(option,parentModel,ecModel){var inputRawOption=retrieveRawOption(option);this.settledOption=inputRawOption,this.mergeDefaultAndTheme(option,ecModel),this._doInit(inputRawOption)},DataZoomModel$1.prototype.mergeOption=function(newOption){var inputRawOption=retrieveRawOption(newOption);merge(this.option,newOption,!0),merge(this.settledOption,inputRawOption,!0),this._doInit(inputRawOption)},DataZoomModel$1.prototype._doInit=function(inputRawOption){var thisOption=this.option;this._setDefaultThrottle(inputRawOption),this._updateRangeUse(inputRawOption);var settledOption=this.settledOption;each([[`start`,`startValue`],[`end`,`endValue`]],function(names,index){this._rangePropMode[index]===`value`&&(thisOption[names[0]]=settledOption[names[0]]=null)},this),this._resetTarget()},DataZoomModel$1.prototype._resetTarget=function(){var optionOrient=this.get(`orient`,!0),targetAxisIndexMap=this._targetAxisInfoMap=createHashMap();this._fillSpecifiedTargetAxis(targetAxisIndexMap)?this._orient=optionOrient||this._makeAutoOrientByTargetAxis():(this._orient=optionOrient||`horizontal`,this._fillAutoTargetAxisByOrient(targetAxisIndexMap,this._orient)),this._noTarget=!0,targetAxisIndexMap.each(function(axisInfo){axisInfo.indexList.length&&(this._noTarget=!1)},this)},DataZoomModel$1.prototype._fillSpecifiedTargetAxis=function(targetAxisIndexMap){var hasAxisSpecified=!1;return each(DATA_ZOOM_AXIS_DIMENSIONS,function(axisDim){var refering=this.getReferringComponents(getAxisMainType(axisDim),MULTIPLE_REFERRING);if(refering.specified){hasAxisSpecified=!0;var axisInfo=new DataZoomAxisInfo;each(refering.models,function(axisModel){axisInfo.add(axisModel.componentIndex)}),targetAxisIndexMap.set(axisDim,axisInfo)}},this),hasAxisSpecified},DataZoomModel$1.prototype._fillAutoTargetAxisByOrient=function(targetAxisIndexMap,orient){var ecModel=this.ecModel,needAuto=!0;if(needAuto){var axisDim=orient===`vertical`?`y`:`x`,axisModels=ecModel.findComponents({mainType:axisDim+`Axis`});setParallelAxis(axisModels,axisDim)}if(needAuto){var axisModels=ecModel.findComponents({mainType:`singleAxis`,filter:function(axisModel){return axisModel.get(`orient`,!0)===orient}});setParallelAxis(axisModels,`single`)}function setParallelAxis(axisModels$1,axisDim$1){var axisModel=axisModels$1[0];if(axisModel){var axisInfo=new DataZoomAxisInfo;if(axisInfo.add(axisModel.componentIndex),targetAxisIndexMap.set(axisDim$1,axisInfo),needAuto=!1,axisDim$1===`x`||axisDim$1===`y`){var gridModel_1=axisModel.getReferringComponents(`grid`,SINGLE_REFERRING).models[0];gridModel_1&&each(axisModels$1,function(axModel){axisModel.componentIndex!==axModel.componentIndex&&gridModel_1===axModel.getReferringComponents(`grid`,SINGLE_REFERRING).models[0]&&axisInfo.add(axModel.componentIndex)})}}}needAuto&&each(DATA_ZOOM_AXIS_DIMENSIONS,function(axisDim$1){if(needAuto){var axisModels$1=ecModel.findComponents({mainType:getAxisMainType(axisDim$1),filter:function(axisModel){return axisModel.get(`type`,!0)===`category`}});if(axisModels$1[0]){var axisInfo=new DataZoomAxisInfo;axisInfo.add(axisModels$1[0].componentIndex),targetAxisIndexMap.set(axisDim$1,axisInfo),needAuto=!1}}},this)},DataZoomModel$1.prototype._makeAutoOrientByTargetAxis=function(){var dim;return this.eachTargetAxis(function(axisDim){!dim&&(dim=axisDim)},this),dim===`y`?`vertical`:`horizontal`},DataZoomModel$1.prototype._setDefaultThrottle=function(inputRawOption){if(inputRawOption.hasOwnProperty(`throttle`)&&(this._autoThrottle=!1),this._autoThrottle){var globalOption=this.ecModel.option;this.option.throttle=globalOption.animation&&globalOption.animationDurationUpdate>0?100:20}},DataZoomModel$1.prototype._updateRangeUse=function(inputRawOption){var rangePropMode=this._rangePropMode,rangeModeInOption=this.get(`rangeMode`);each([[`start`,`startValue`],[`end`,`endValue`]],function(names,index){var percentSpecified=inputRawOption[names[0]]!=null,valueSpecified=inputRawOption[names[1]]!=null;percentSpecified&&!valueSpecified?rangePropMode[index]=`percent`:!percentSpecified&&valueSpecified?rangePropMode[index]=`value`:rangeModeInOption?rangePropMode[index]=rangeModeInOption[index]:percentSpecified&&(rangePropMode[index]=`percent`)})},DataZoomModel$1.prototype.noTarget=function(){return this._noTarget},DataZoomModel$1.prototype.getFirstTargetAxisModel=function(){var firstAxisModel;return this.eachTargetAxis(function(axisDim,axisIndex){firstAxisModel??=this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex)},this),firstAxisModel},DataZoomModel$1.prototype.eachTargetAxis=function(callback,context$1){this._targetAxisInfoMap.each(function(axisInfo,axisDim){each(axisInfo.indexList,function(axisIndex){callback.call(context$1,axisDim,axisIndex)})})},DataZoomModel$1.prototype.getAxisProxy=function(axisDim,axisIndex){var axisModel=this.getAxisModel(axisDim,axisIndex);if(axisModel)return axisModel.__dzAxisProxy},DataZoomModel$1.prototype.getAxisModel=function(axisDim,axisIndex){var axisInfo=this._targetAxisInfoMap.get(axisDim);if(axisInfo&&axisInfo.indexMap[axisIndex])return this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex)},DataZoomModel$1.prototype.setRawRange=function(opt){var thisOption=this.option,settledOption=this.settledOption;each([[`start`,`startValue`],[`end`,`endValue`]],function(names){(opt[names[0]]!=null||opt[names[1]]!=null)&&(thisOption[names[0]]=settledOption[names[0]]=opt[names[0]],thisOption[names[1]]=settledOption[names[1]]=opt[names[1]])},this),this._updateRangeUse(opt)},DataZoomModel$1.prototype.setCalculatedRange=function(opt){var option=this.option;each([`start`,`startValue`,`end`,`endValue`],function(name){option[name]=opt[name]})},DataZoomModel$1.prototype.getPercentRange=function(){var axisProxy=this.findRepresentativeAxisProxy();if(axisProxy)return axisProxy.getDataPercentWindow()},DataZoomModel$1.prototype.getValueRange=function(axisDim,axisIndex){if(axisDim==null&&axisIndex==null){var axisProxy=this.findRepresentativeAxisProxy();if(axisProxy)return axisProxy.getDataValueWindow()}else return this.getAxisProxy(axisDim,axisIndex).getDataValueWindow()},DataZoomModel$1.prototype.findRepresentativeAxisProxy=function(axisModel){if(axisModel)return axisModel.__dzAxisProxy;for(var firstProxy,axisDimList=this._targetAxisInfoMap.keys(),i$1=0;i$1<axisDimList.length;i$1++)for(var axisDim=axisDimList[i$1],axisInfo=this._targetAxisInfoMap.get(axisDim),j$1=0;j$1<axisInfo.indexList.length;j$1++){var proxy=this.getAxisProxy(axisDim,axisInfo.indexList[j$1]);if(proxy.hostedBy(this))return proxy;firstProxy||=proxy}return firstProxy},DataZoomModel$1.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},DataZoomModel$1.prototype.getOrient=function(){return this._orient},DataZoomModel$1.type=`dataZoom`,DataZoomModel$1.dependencies=[`xAxis`,`yAxis`,`radiusAxis`,`angleAxis`,`singleAxis`,`series`,`toolbox`],DataZoomModel$1.defaultOption={z:4,filterMode:`filter`,start:0,end:100},DataZoomModel$1}(Component_default);function retrieveRawOption(option){var ret={};return each([`start`,`end`,`startValue`,`endValue`,`throttle`],function(name){option.hasOwnProperty(name)&&(ret[name]=option[name])}),ret}var DataZoomModel_default=DataZoomModel,DataZoomView_default=function(_super){__extends(DataZoomView$1,_super);function DataZoomView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=DataZoomView$1.type,_this}return DataZoomView$1.prototype.render=function(dataZoomModel,ecModel,api,payload){this.dataZoomModel=dataZoomModel,this.ecModel=ecModel,this.api=api},DataZoomView$1.type=`dataZoom`,DataZoomView$1}(Component_default$1),each$1=each,asc$1=asc,AxisProxy=function(){function AxisProxy$1(dimName,axisIndex,dataZoomModel,ecModel){this._dimName=dimName,this._axisIndex=axisIndex,this.ecModel=ecModel,this._dataZoomModel=dataZoomModel}return AxisProxy$1.prototype.hostedBy=function(dataZoomModel){return this._dataZoomModel===dataZoomModel},AxisProxy$1.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},AxisProxy$1.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},AxisProxy$1.prototype.getTargetSeriesModels=function(){var seriesModels=[];return this.ecModel.eachSeries(function(seriesModel){if(isCoordSupported(seriesModel)){var axisMainType=getAxisMainType(this._dimName),axisModel=seriesModel.getReferringComponents(axisMainType,SINGLE_REFERRING).models[0];axisModel&&this._axisIndex===axisModel.componentIndex&&seriesModels.push(seriesModel)}},this),seriesModels},AxisProxy$1.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+`Axis`,this._axisIndex)},AxisProxy$1.prototype.getMinMaxSpan=function(){return clone(this._minMaxSpan)},AxisProxy$1.prototype.calculateDataWindow=function(opt){var dataExtent=this._dataExtent,scale$3=this.getAxisModel().axis.scale,rangePropMode=this._dataZoomModel.getRangePropMode(),percentExtent=[0,100],percentWindow=[],valueWindow=[],hasPropModeValue;each$1([`start`,`end`],function(prop,idx){var boundPercent=opt[prop],boundValue=opt[prop+`Value`];rangePropMode[idx]===`percent`?(boundPercent??=percentExtent[idx],boundValue=scale$3.parse(linearMap(boundPercent,percentExtent,dataExtent))):(hasPropModeValue=!0,boundValue=boundValue==null?dataExtent[idx]:scale$3.parse(boundValue),boundPercent=linearMap(boundValue,dataExtent,percentExtent)),valueWindow[idx]=boundValue==null||isNaN(boundValue)?dataExtent[idx]:boundValue,percentWindow[idx]=boundPercent==null||isNaN(boundPercent)?percentExtent[idx]:boundPercent}),asc$1(valueWindow),asc$1(percentWindow);var spans=this._minMaxSpan;hasPropModeValue?restrictSet(valueWindow,percentWindow,dataExtent,percentExtent,!1):restrictSet(percentWindow,valueWindow,percentExtent,dataExtent,!0);function restrictSet(fromWindow,toWindow,fromExtent,toExtent,toValue$1){var suffix=toValue$1?`Span`:`ValueSpan`;sliderMove(0,fromWindow,fromExtent,`all`,spans[`min`+suffix],spans[`max`+suffix]);for(var i$1=0;i$1<2;i$1++)toWindow[i$1]=linearMap(fromWindow[i$1],fromExtent,toExtent,!0),toValue$1&&(toWindow[i$1]=scale$3.parse(toWindow[i$1]))}return{valueWindow,percentWindow}},AxisProxy$1.prototype.reset=function(dataZoomModel){if(dataZoomModel===this._dataZoomModel){var targetSeries=this.getTargetSeriesModels();this._dataExtent=calculateDataExtent(this,this._dimName,targetSeries),this._updateMinMaxSpan();var dataWindow=this.calculateDataWindow(dataZoomModel.settledOption);this._valueWindow=dataWindow.valueWindow,this._percentWindow=dataWindow.percentWindow,this._setAxisModel()}},AxisProxy$1.prototype.filterData=function(dataZoomModel,api){if(dataZoomModel!==this._dataZoomModel)return;var axisDim=this._dimName,seriesModels=this.getTargetSeriesModels(),filterMode=dataZoomModel.get(`filterMode`),valueWindow=this._valueWindow;if(filterMode===`none`)return;each$1(seriesModels,function(seriesModel){var seriesData=seriesModel.getData(),dataDims=seriesData.mapDimensionsAll(axisDim);if(dataDims.length){if(filterMode===`weakFilter`){var store_1=seriesData.getStore(),dataDimIndices_1=map(dataDims,function(dim){return seriesData.getDimensionIndex(dim)},seriesData);seriesData.filterSelf(function(dataIndex){for(var leftOut,rightOut,hasValue,i$1=0;i$1<dataDims.length;i$1++){var value=store_1.get(dataDimIndices_1[i$1],dataIndex),thisHasValue=!isNaN(value),thisLeftOut=value<valueWindow[0],thisRightOut=value>valueWindow[1];if(thisHasValue&&!thisLeftOut&&!thisRightOut)return!0;thisHasValue&&(hasValue=!0),thisLeftOut&&(leftOut=!0),thisRightOut&&(rightOut=!0)}return hasValue&&leftOut&&rightOut})}else each$1(dataDims,function(dim){if(filterMode===`empty`)seriesModel.setData(seriesData=seriesData.map(dim,function(value){return isInWindow(value)?value:NaN}));else{var range={};range[dim]=valueWindow,seriesData.selectRange(range)}});each$1(dataDims,function(dim){seriesData.setApproximateExtent(valueWindow,dim)})}});function isInWindow(value){return value>=valueWindow[0]&&value<=valueWindow[1]}},AxisProxy$1.prototype._updateMinMaxSpan=function(){var minMaxSpan=this._minMaxSpan={},dataZoomModel=this._dataZoomModel,dataExtent=this._dataExtent;each$1([`min`,`max`],function(minMax){var percentSpan=dataZoomModel.get(minMax+`Span`),valueSpan=dataZoomModel.get(minMax+`ValueSpan`);valueSpan!=null&&(valueSpan=this.getAxisModel().axis.scale.parse(valueSpan)),valueSpan==null?percentSpan!=null&&(valueSpan=linearMap(percentSpan,[0,100],dataExtent,!0)-dataExtent[0]):percentSpan=linearMap(dataExtent[0]+valueSpan,dataExtent,[0,100],!0),minMaxSpan[minMax+`Span`]=percentSpan,minMaxSpan[minMax+`ValueSpan`]=valueSpan},this)},AxisProxy$1.prototype._setAxisModel=function(){var axisModel=this.getAxisModel(),percentWindow=this._percentWindow,valueWindow=this._valueWindow;if(percentWindow){var precision=getPixelPrecision(valueWindow,[0,500]);precision=Math.min(precision,20);var rawExtentInfo=axisModel.axis.scale.rawExtentInfo;percentWindow[0]!==0&&rawExtentInfo.setDeterminedMinMax(`min`,+valueWindow[0].toFixed(precision)),percentWindow[1]!==100&&rawExtentInfo.setDeterminedMinMax(`max`,+valueWindow[1].toFixed(precision)),rawExtentInfo.freeze()}},AxisProxy$1}();function calculateDataExtent(axisProxy,axisDim,seriesModels){var dataExtent=[1/0,-1/0];each$1(seriesModels,function(seriesModel){unionAxisExtentFromData(dataExtent,seriesModel.getData(),axisDim)});var axisModel=axisProxy.getAxisModel(),rawExtentResult=ensureScaleRawExtentInfo(axisModel.axis.scale,axisModel,dataExtent).calculate();return[rawExtentResult.min,rawExtentResult.max]}var AxisProxy_default=AxisProxy,dataZoomProcessor_default={getTargetSeries:function(ecModel){function eachAxisModel(cb){ecModel.eachComponent(`dataZoom`,function(dataZoomModel){dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var axisModel=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);cb(axisDim,axisIndex,axisModel,dataZoomModel)})})}eachAxisModel(function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy=null});var proxyList=[];eachAxisModel(function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy||(axisModel.__dzAxisProxy=new AxisProxy_default(axisDim,axisIndex,dataZoomModel,ecModel),proxyList.push(axisModel.__dzAxisProxy))});var seriesModelMap=createHashMap();return each(proxyList,function(axisProxy){each(axisProxy.getTargetSeriesModels(),function(seriesModel){seriesModelMap.set(seriesModel.uid,seriesModel)})}),seriesModelMap},overallReset:function(ecModel,api){ecModel.eachComponent(`dataZoom`,function(dataZoomModel){dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).reset(dataZoomModel)}),dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).filterData(dataZoomModel,api)})}),ecModel.eachComponent(`dataZoom`,function(dataZoomModel){var axisProxy=dataZoomModel.findRepresentativeAxisProxy();if(axisProxy){var percentRange=axisProxy.getDataPercentWindow(),valueRange=axisProxy.getDataValueWindow();dataZoomModel.setCalculatedRange({start:percentRange[0],end:percentRange[1],startValue:valueRange[0],endValue:valueRange[1]})}})}};function installDataZoomAction(registers){registers.registerAction(`dataZoom`,function(payload,ecModel){var effectedModels=findEffectedDataZooms(ecModel,payload);each(effectedModels,function(dataZoomModel){dataZoomModel.setRawRange({start:payload.start,end:payload.end,startValue:payload.startValue,endValue:payload.endValue})})})}var installed=!1;function installCommon(registers){installed||(installed=!0,registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,dataZoomProcessor_default),installDataZoomAction(registers),registers.registerSubTypeDefaulter(`dataZoom`,function(){return`slider`}))}var TooltipModel_default=function(_super){__extends(TooltipModel$1,_super);function TooltipModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=TooltipModel$1.type,_this}return TooltipModel$1.type=`tooltip`,TooltipModel$1.dependencies=[`axisPointer`],TooltipModel$1.defaultOption={z:60,show:!0,showContent:!0,trigger:`item`,triggerOn:`mousemove|click`,alwaysShowContent:!1,renderMode:`auto`,confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,displayTransition:!0,enterable:!1,backgroundColor:tokens_default.color.neutral00,shadowBlur:10,shadowColor:`rgba(0, 0, 0, .2)`,shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,defaultBorderColor:tokens_default.color.border,padding:null,extraCssText:``,axisPointer:{type:`line`,axis:`auto`,animation:`auto`,animationDurationUpdate:200,animationEasingUpdate:`exponentialOut`,crossStyle:{color:tokens_default.color.borderShade,width:1,type:`dashed`,textStyle:{}}},textStyle:{color:tokens_default.color.tertiary,fontSize:14}},TooltipModel$1}(Component_default);function shouldTooltipConfine(tooltipModel){var confineOption=tooltipModel.get(`confine`);return confineOption==null?tooltipModel.get(`renderMode`)===`richText`:!!confineOption}function testStyle(styleProps){if(env_default.domSupported){for(var style=document.documentElement.style,i$1=0,len$1=styleProps.length;i$1<len$1;i$1++)if(styleProps[i$1]in style)return styleProps[i$1]}}var TRANSFORM_VENDOR=testStyle([`transform`,`webkitTransform`,`OTransform`,`MozTransform`,`msTransform`]),TRANSITION_VENDOR=testStyle([`webkitTransition`,`transition`,`OTransition`,`MozTransition`,`msTransition`]);function toCSSVendorPrefix(styleVendor,styleProp){if(!styleVendor)return styleProp;styleProp=toCamelCase(styleProp,!0);var idx=styleVendor.indexOf(styleProp);return styleVendor=idx===-1?styleProp:`-`+styleVendor.slice(0,idx)+`-`+styleProp,styleVendor.toLowerCase()}function getComputedStyle(el,style){var stl=el.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(el);return stl?style?stl[style]:stl:null}var CSS_TRANSITION_VENDOR=toCSSVendorPrefix(TRANSITION_VENDOR,`transition`),CSS_TRANSFORM_VENDOR=toCSSVendorPrefix(TRANSFORM_VENDOR,`transform`),gCssText=`position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;`+(env_default.transform3dSupported?`will-change:transform;`:``);function mirrorPos(pos){return pos=pos===`left`?`right`:pos===`right`?`left`:pos===`top`?`bottom`:`top`,pos}function assembleArrow(tooltipModel,borderColor,arrowPosition){if(!isString(arrowPosition)||arrowPosition===`inside`)return``;var backgroundColor$1=tooltipModel.get(`backgroundColor`),borderWidth=tooltipModel.get(`borderWidth`);borderColor=convertToColorString(borderColor);var arrowPos=mirrorPos(arrowPosition),arrowSize=Math.max(Math.round(borderWidth)*1.5,6),positionStyle=``,transformStyle=CSS_TRANSFORM_VENDOR+`:`,rotateDeg;indexOf([`left`,`right`],arrowPos)>-1?(positionStyle+=`top:50%`,transformStyle+=`translateY(-50%) rotate(`+(rotateDeg=arrowPos===`left`?-225:-45)+`deg)`):(positionStyle+=`left:50%`,transformStyle+=`translateX(-50%) rotate(`+(rotateDeg=arrowPos===`top`?225:45)+`deg)`);var rotateRadian=rotateDeg*Math.PI/180,arrowWH=arrowSize+borderWidth,rotatedWH=arrowWH*Math.abs(Math.cos(rotateRadian))+arrowWH*Math.abs(Math.sin(rotateRadian)),arrowOffset=Math.round(((rotatedWH-Math.SQRT2*borderWidth)/2+Math.SQRT2*borderWidth-(rotatedWH-arrowWH)/2)*100)/100;positionStyle+=`;`+arrowPos+`:-`+arrowOffset+`px`;var borderStyle=borderColor+` solid `+borderWidth+`px;`;return`<div style="`+[`position:absolute;width:`+arrowSize+`px;height:`+arrowSize+`px;z-index:-1;`,positionStyle+`;`+transformStyle+`;`,`border-bottom:`+borderStyle,`border-right:`+borderStyle,`background-color:`+backgroundColor$1+`;`].join(``)+`"></div>`}function assembleTransition(duration,onlyFadeTransition,enableDisplayTransition){var transitionCurve=`cubic-bezier(0.23,1,0.32,1)`,transitionOption=``,transitionText=``;return enableDisplayTransition&&(transitionOption=` `+duration/2+`s `+transitionCurve,transitionText=`opacity`+transitionOption+`,visibility`+transitionOption),onlyFadeTransition||(transitionOption=` `+duration+`s `+transitionCurve,transitionText+=(transitionText.length?`,`:``)+(env_default.transformSupported?``+CSS_TRANSFORM_VENDOR+transitionOption:`,left`+transitionOption+`,top`+transitionOption)),CSS_TRANSITION_VENDOR+`:`+transitionText}function assembleTransform(x$1,y$1,toString$2){var x0=x$1.toFixed(0)+`px`,y0=y$1.toFixed(0)+`px`;if(!env_default.transformSupported)return toString$2?`top:`+y0+`;left:`+x0+`;`:[[`top`,y0],[`left`,x0]];var is3d=env_default.transform3dSupported,translate$1=`translate`+(is3d?`3d`:``)+`(`+x0+`,`+y0+(is3d?`,0`:``)+`)`;return toString$2?`top:0;left:0;`+CSS_TRANSFORM_VENDOR+`:`+translate$1+`;`:[[`top`,0],[`left`,0],[TRANSFORM_VENDOR,translate$1]]}function assembleFont(textStyleModel){var cssText=[],fontSize=textStyleModel.get(`fontSize`),color$2=textStyleModel.getTextColor();color$2&&cssText.push(`color:`+color$2),cssText.push(`font:`+textStyleModel.getFont());var lineHeight=retrieve2(textStyleModel.get(`lineHeight`),Math.round(fontSize*3/2));fontSize&&cssText.push(`line-height:`+lineHeight+`px`);var shadowColor=textStyleModel.get(`textShadowColor`),shadowBlur=textStyleModel.get(`textShadowBlur`)||0,shadowOffsetX=textStyleModel.get(`textShadowOffsetX`)||0,shadowOffsetY=textStyleModel.get(`textShadowOffsetY`)||0;return shadowColor&&shadowBlur&&cssText.push(`text-shadow:`+shadowOffsetX+`px `+shadowOffsetY+`px `+shadowBlur+`px `+shadowColor),each([`decoration`,`align`],function(name){var val=textStyleModel.get(name);val&&cssText.push(`text-`+name+`:`+val)}),cssText.join(`;`)}function assembleCssText(tooltipModel,enableTransition,onlyFadeTransition,enableDisplayTransition){var cssText=[],transitionDuration=tooltipModel.get(`transitionDuration`),backgroundColor$1=tooltipModel.get(`backgroundColor`),shadowBlur=tooltipModel.get(`shadowBlur`),shadowColor=tooltipModel.get(`shadowColor`),shadowOffsetX=tooltipModel.get(`shadowOffsetX`),shadowOffsetY=tooltipModel.get(`shadowOffsetY`),textStyleModel=tooltipModel.getModel(`textStyle`),padding=getPaddingFromTooltipModel(tooltipModel,`html`),boxShadow=shadowOffsetX+`px `+shadowOffsetY+`px `+shadowBlur+`px `+shadowColor;return cssText.push(`box-shadow:`+boxShadow),enableTransition&&transitionDuration>0&&cssText.push(assembleTransition(transitionDuration,onlyFadeTransition,enableDisplayTransition)),backgroundColor$1&&cssText.push(`background-color:`+backgroundColor$1),each([`width`,`color`,`radius`],function(name){var borderName=`border-`+name,camelCase=toCamelCase(borderName),val=tooltipModel.get(camelCase);val!=null&&cssText.push(borderName+`:`+val+(name===`color`?``:`px`))}),cssText.push(assembleFont(textStyleModel)),padding!=null&&cssText.push(`padding:`+normalizeCssArray(padding).join(`px `)+`px`),cssText.join(`;`)+`;`}function makeStyleCoord$1(out$2,zr,container,zrX,zrY){var zrPainter=zr&&zr.painter;if(container){var zrViewportRoot=zrPainter&&zrPainter.getViewportRoot();zrViewportRoot&&transformLocalCoord(out$2,zrViewportRoot,container,zrX,zrY)}else{out$2[0]=zrX,out$2[1]=zrY;var viewportRootOffset=zrPainter&&zrPainter.getViewportRootOffset();viewportRootOffset&&(out$2[0]+=viewportRootOffset.offsetLeft,out$2[1]+=viewportRootOffset.offsetTop)}out$2[2]=out$2[0]/zr.getWidth(),out$2[3]=out$2[1]/zr.getHeight()}var TooltipHTMLContent_default=function(){function TooltipHTMLContent$1(api,opt){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,env_default.wxa)return null;var el=document.createElement(`div`);el.domBelongToZr=!0,this.el=el;var zr=this._zr=api.getZr(),appendTo=opt.appendTo,container=appendTo&&(isString(appendTo)?document.querySelector(appendTo):isDom(appendTo)?appendTo:isFunction(appendTo)&&appendTo(api.getDom()));makeStyleCoord$1(this._styleCoord,zr,container,api.getWidth()/2,api.getHeight()/2),(container||api.getDom()).appendChild(el),this._api=api,this._container=container;var self$1=this;el.onmouseenter=function(){self$1._enterable&&(clearTimeout(self$1._hideTimeout),self$1._show=!0),self$1._inContent=!0},el.onmousemove=function(e$2){if(e$2||=window.event,!self$1._enterable){var handler=zr.handler,zrViewportRoot=zr.painter.getViewportRoot();normalizeEvent(zrViewportRoot,e$2,!0),handler.dispatch(`mousemove`,e$2)}},el.onmouseleave=function(){self$1._inContent=!1,self$1._enterable&&self$1._show&&self$1.hideLater(self$1._hideDelay)}}return TooltipHTMLContent$1.prototype.update=function(tooltipModel){if(!this._container){var container=this._api.getDom(),position=getComputedStyle(container,`position`),domStyle=container.style;domStyle.position!==`absolute`&&position!==`absolute`&&(domStyle.position=`relative`)}var alwaysShowContent=tooltipModel.get(`alwaysShowContent`);alwaysShowContent&&this._moveIfResized(),this._alwaysShowContent=alwaysShowContent,this._enableDisplayTransition=tooltipModel.get(`displayTransition`)&&tooltipModel.get(`transitionDuration`)>0,this.el.className=tooltipModel.get(`className`)||``},TooltipHTMLContent$1.prototype.show=function(tooltipModel,nearPointColor){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var el=this.el,style=el.style,styleCoord=this._styleCoord;el.innerHTML?style.cssText=gCssText+assembleCssText(tooltipModel,!this._firstShow,this._longHide,this._enableDisplayTransition)+assembleTransform(styleCoord[0],styleCoord[1],!0)+(`border-color:`+convertToColorString(nearPointColor)+`;`)+(tooltipModel.get(`extraCssText`)||``)+(`;pointer-events:`+(this._enterable?`auto`:`none`)):style.display=`none`,this._show=!0,this._firstShow=!1,this._longHide=!1},TooltipHTMLContent$1.prototype.setContent=function(content,markers,tooltipModel,borderColor,arrowPosition){var el=this.el;if(content==null){el.innerHTML=``;return}var arrow=``;if(isString(arrowPosition)&&tooltipModel.get(`trigger`)===`item`&&!shouldTooltipConfine(tooltipModel)&&(arrow=assembleArrow(tooltipModel,borderColor,arrowPosition)),isString(content))el.innerHTML=content+arrow;else if(content){el.innerHTML=``,isArray(content)||(content=[content]);for(var i$1=0;i$1<content.length;i$1++)isDom(content[i$1])&&content[i$1].parentNode!==el&&el.appendChild(content[i$1]);if(arrow&&el.childNodes.length){var arrowEl=document.createElement(`div`);arrowEl.innerHTML=arrow,el.appendChild(arrowEl)}}},TooltipHTMLContent$1.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipHTMLContent$1.prototype.getSize=function(){var el=this.el;return el?[el.offsetWidth,el.offsetHeight]:[0,0]},TooltipHTMLContent$1.prototype.moveTo=function(zrX,zrY){if(this.el){var styleCoord=this._styleCoord;if(makeStyleCoord$1(styleCoord,this._zr,this._container,zrX,zrY),styleCoord[0]!=null&&styleCoord[1]!=null){var style_1=this.el.style,transforms=assembleTransform(styleCoord[0],styleCoord[1]);each(transforms,function(transform){style_1[transform[0]]=transform[1]})}}},TooltipHTMLContent$1.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipHTMLContent$1.prototype.hide=function(){var _this=this,style=this.el.style;this._enableDisplayTransition?(style.visibility=`hidden`,style.opacity=`0`):style.display=`none`,env_default.transform3dSupported&&(style.willChange=``),this._show=!1,this._longHideTimeout=setTimeout(function(){return _this._longHide=!0},500)},TooltipHTMLContent$1.prototype.hideLater=function(time){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(time?(this._hideDelay=time,this._show=!1,this._hideTimeout=setTimeout(bind(this.hide,this),time)):this.hide())},TooltipHTMLContent$1.prototype.isShow=function(){return this._show},TooltipHTMLContent$1.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var zr=this._zr;transformLocalCoordClear(zr&&zr.painter&&zr.painter.getViewportRoot(),this._container);var el=this.el;if(el){el.onmouseenter=el.onmousemove=el.onmouseleave=null;var parentNode=el.parentNode;parentNode&&parentNode.removeChild(el)}this.el=this._container=null},TooltipHTMLContent$1}(),TooltipRichContent=function(){function TooltipRichContent$1(api){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=api.getZr(),makeStyleCoord(this._styleCoord,this._zr,api.getWidth()/2,api.getHeight()/2)}return TooltipRichContent$1.prototype.update=function(tooltipModel){var alwaysShowContent=tooltipModel.get(`alwaysShowContent`);alwaysShowContent&&this._moveIfResized(),this._alwaysShowContent=alwaysShowContent},TooltipRichContent$1.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},TooltipRichContent$1.prototype.setContent=function(content,markupStyleCreator,tooltipModel,borderColor,arrowPosition){var _this=this;isObject(content)&&throwError(``),this.el&&this._zr.remove(this.el);var textStyleModel=tooltipModel.getModel(`textStyle`);this.el=new Text_default({style:{rich:markupStyleCreator.richTextStyles,text:content,lineHeight:22,borderWidth:1,borderColor,textShadowColor:textStyleModel.get(`textShadowColor`),fill:tooltipModel.get([`textStyle`,`color`]),padding:getPaddingFromTooltipModel(tooltipModel,`richText`),verticalAlign:`top`,align:`left`},z:tooltipModel.get(`z`)}),each([`backgroundColor`,`borderRadius`,`shadowColor`,`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`],function(propName){_this.el.style[propName]=tooltipModel.get(propName)}),each([`textShadowBlur`,`textShadowOffsetX`,`textShadowOffsetY`],function(propName){_this.el.style[propName]=textStyleModel.get(propName)||0}),this._zr.add(this.el);var self$1=this;this.el.on(`mouseover`,function(){self$1._enterable&&(clearTimeout(self$1._hideTimeout),self$1._show=!0),self$1._inContent=!0}),this.el.on(`mouseout`,function(){self$1._enterable&&self$1._show&&self$1.hideLater(self$1._hideDelay),self$1._inContent=!1})},TooltipRichContent$1.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipRichContent$1.prototype.getSize=function(){var el=this.el,bounding=this.el.getBoundingRect(),shadowOuterSize=calcShadowOuterSize(el.style);return[bounding.width+shadowOuterSize.left+shadowOuterSize.right,bounding.height+shadowOuterSize.top+shadowOuterSize.bottom]},TooltipRichContent$1.prototype.moveTo=function(x$1,y$1){var el=this.el;if(el){var styleCoord=this._styleCoord;makeStyleCoord(styleCoord,this._zr,x$1,y$1),x$1=styleCoord[0],y$1=styleCoord[1];var style=el.style,borderWidth=mathMaxWith0(style.borderWidth||0),shadowOuterSize=calcShadowOuterSize(style);el.x=x$1+borderWidth+shadowOuterSize.left,el.y=y$1+borderWidth+shadowOuterSize.top,el.markRedraw()}},TooltipRichContent$1.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipRichContent$1.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},TooltipRichContent$1.prototype.hideLater=function(time){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(time?(this._hideDelay=time,this._show=!1,this._hideTimeout=setTimeout(bind(this.hide,this),time)):this.hide())},TooltipRichContent$1.prototype.isShow=function(){return this._show},TooltipRichContent$1.prototype.dispose=function(){this._zr.remove(this.el)},TooltipRichContent$1}();function mathMaxWith0(val){return Math.max(0,val)}function calcShadowOuterSize(style){var shadowBlur=mathMaxWith0(style.shadowBlur||0),shadowOffsetX=mathMaxWith0(style.shadowOffsetX||0),shadowOffsetY=mathMaxWith0(style.shadowOffsetY||0);return{left:mathMaxWith0(shadowBlur-shadowOffsetX),right:mathMaxWith0(shadowBlur+shadowOffsetX),top:mathMaxWith0(shadowBlur-shadowOffsetY),bottom:mathMaxWith0(shadowBlur+shadowOffsetY)}}function makeStyleCoord(out$2,zr,zrX,zrY){out$2[0]=zrX,out$2[1]=zrY,out$2[2]=out$2[0]/zr.getWidth(),out$2[3]=out$2[1]/zr.getHeight()}var TooltipRichContent_default=TooltipRichContent,proxyRect=new Rect_default({shape:{x:-1,y:-1,width:2,height:2}}),TooltipView=function(_super){__extends(TooltipView$1,_super);function TooltipView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=TooltipView$1.type,_this}return TooltipView$1.prototype.init=function(ecModel,api){if(!(env_default.node||!api.getDom())){var tooltipModel=ecModel.getComponent(`tooltip`);this._tooltipContent=(this._renderMode=getTooltipRenderMode(tooltipModel.get(`renderMode`)))===`richText`?new TooltipRichContent_default(api):new TooltipHTMLContent_default(api,{appendTo:tooltipModel.get(`appendToBody`,!0)?`body`:tooltipModel.get(`appendTo`,!0)})}},TooltipView$1.prototype.render=function(tooltipModel,ecModel,api){if(!(env_default.node||!api.getDom())){this.group.removeAll(),this._tooltipModel=tooltipModel,this._ecModel=ecModel,this._api=api;var tooltipContent=this._tooltipContent;tooltipContent.update(tooltipModel),tooltipContent.setEnterable(tooltipModel.get(`enterable`)),this._initGlobalListener(),this._keepShow(),this._renderMode!==`richText`&&tooltipModel.get(`transitionDuration`)?createOrUpdate(this,`_updatePosition`,50,`fixRate`):clear(this,`_updatePosition`)}},TooltipView$1.prototype._initGlobalListener=function(){var triggerOn=this._tooltipModel.get(`triggerOn`);register(`itemTooltip`,this._api,bind(function(currTrigger,e$2,dispatchAction$1){triggerOn!==`none`&&(triggerOn.indexOf(currTrigger)>=0?this._tryShow(e$2,dispatchAction$1):currTrigger===`leave`&&this._hide(dispatchAction$1))},this))},TooltipView$1.prototype._keepShow=function(){var tooltipModel=this._tooltipModel,ecModel=this._ecModel,api=this._api,triggerOn=tooltipModel.get(`triggerOn`);if(this._lastX!=null&&this._lastY!=null&&triggerOn!==`none`&&triggerOn!==`click`){var self_1=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!api.isDisposed()&&self_1.manuallyShowTip(tooltipModel,ecModel,api,{x:self_1._lastX,y:self_1._lastY,dataByCoordSys:self_1._lastDataByCoordSys})})}},TooltipView$1.prototype.manuallyShowTip=function(tooltipModel,ecModel,api,payload){if(!(payload.from===this.uid||env_default.node||!api.getDom())){var dispatchAction$1=makeDispatchAction(payload,api);this._ticket=``;var dataByCoordSys=payload.dataByCoordSys,cmptRef=findComponentReference(payload,ecModel,api);if(cmptRef){var rect=cmptRef.el.getBoundingRect().clone();rect.applyTransform(cmptRef.el.transform),this._tryShow({offsetX:rect.x+rect.width/2,offsetY:rect.y+rect.height/2,target:cmptRef.el,position:payload.position,positionDefault:`bottom`},dispatchAction$1)}else if(payload.tooltip&&payload.x!=null&&payload.y!=null){var el=proxyRect;el.x=payload.x,el.y=payload.y,el.update(),getECData(el).tooltipConfig={name:null,option:payload.tooltip},this._tryShow({offsetX:payload.x,offsetY:payload.y,target:el},dispatchAction$1)}else if(dataByCoordSys)this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,dataByCoordSys,tooltipOption:payload.tooltipOption},dispatchAction$1);else if(payload.seriesIndex!=null){if(this._manuallyAxisShowTip(tooltipModel,ecModel,api,payload))return;var pointInfo=findPointFromSeries(payload,ecModel),cx=pointInfo.point[0],cy=pointInfo.point[1];cx!=null&&cy!=null&&this._tryShow({offsetX:cx,offsetY:cy,target:pointInfo.el,position:payload.position,positionDefault:`bottom`},dispatchAction$1)}else payload.x!=null&&payload.y!=null&&(api.dispatchAction({type:`updateAxisPointer`,x:payload.x,y:payload.y}),this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,target:api.getZr().findHover(payload.x,payload.y).target},dispatchAction$1))}},TooltipView$1.prototype.manuallyHideTip=function(tooltipModel,ecModel,api,payload){var tooltipContent=this._tooltipContent;this._tooltipModel&&tooltipContent.hideLater(this._tooltipModel.get(`hideDelay`)),this._lastX=this._lastY=this._lastDataByCoordSys=null,payload.from!==this.uid&&this._hide(makeDispatchAction(payload,api))},TooltipView$1.prototype._manuallyAxisShowTip=function(tooltipModel,ecModel,api,payload){var seriesIndex=payload.seriesIndex,dataIndex=payload.dataIndex,coordSysAxesInfo=ecModel.getComponent(`axisPointer`).coordSysAxesInfo;if(!(seriesIndex==null||dataIndex==null||coordSysAxesInfo==null)){var seriesModel=ecModel.getSeriesByIndex(seriesIndex);if(seriesModel){var data=seriesModel.getData();if(buildTooltipModel([data.getItemModel(dataIndex),seriesModel,(seriesModel.coordinateSystem||{}).model],this._tooltipModel).get(`trigger`)===`axis`)return api.dispatchAction({type:`updateAxisPointer`,seriesIndex,dataIndex,position:payload.position}),!0}}},TooltipView$1.prototype._tryShow=function(e$2,dispatchAction$1){var el=e$2.target;if(this._tooltipModel){this._lastX=e$2.offsetX,this._lastY=e$2.offsetY;var dataByCoordSys=e$2.dataByCoordSys;if(dataByCoordSys&&dataByCoordSys.length)this._showAxisTooltip(dataByCoordSys,e$2);else if(el){if(getECData(el).ssrType===`legend`)return;this._lastDataByCoordSys=null;var seriesDispatcher_1,cmptDispatcher_1;findEventDispatcher(el,function(target){if(target.tooltipDisabled)return seriesDispatcher_1=cmptDispatcher_1=null,!0;seriesDispatcher_1||cmptDispatcher_1||(getECData(target).dataIndex==null?getECData(target).tooltipConfig!=null&&(cmptDispatcher_1=target):seriesDispatcher_1=target)},!0),seriesDispatcher_1?this._showSeriesItemTooltip(e$2,seriesDispatcher_1,dispatchAction$1):cmptDispatcher_1?this._showComponentItemTooltip(e$2,cmptDispatcher_1,dispatchAction$1):this._hide(dispatchAction$1)}else this._lastDataByCoordSys=null,this._hide(dispatchAction$1)}},TooltipView$1.prototype._showOrMove=function(tooltipModel,cb){var delay=tooltipModel.get(`showDelay`);cb=bind(cb,this),clearTimeout(this._showTimout),delay>0?this._showTimout=setTimeout(cb,delay):cb()},TooltipView$1.prototype._showAxisTooltip=function(dataByCoordSys,e$2){var ecModel=this._ecModel,globalTooltipModel=this._tooltipModel,point=[e$2.offsetX,e$2.offsetY],singleTooltipModel=buildTooltipModel([e$2.tooltipOption],globalTooltipModel),renderMode=this._renderMode,cbParamsList=[],articleMarkup=createTooltipMarkup(`section`,{blocks:[],noHeader:!0}),markupTextArrLegacy=[],markupStyleCreator=new TooltipMarkupStyleCreator;each(dataByCoordSys,function(itemCoordSys){each(itemCoordSys.dataByAxis,function(axisItem){var axisModel=ecModel.getComponent(axisItem.axisDim+`Axis`,axisItem.axisIndex),axisValue=axisItem.value;if(!(!axisModel||axisValue==null)){var axisValueLabel=getValueLabel(axisValue,axisModel.axis,ecModel,axisItem.seriesDataIndices,axisItem.valueLabelOpt),axisSectionMarkup=createTooltipMarkup(`section`,{header:axisValueLabel,noHeader:!trim(axisValueLabel),sortBlocks:!0,blocks:[]});articleMarkup.blocks.push(axisSectionMarkup),each(axisItem.seriesDataIndices,function(idxItem){var series=ecModel.getSeriesByIndex(idxItem.seriesIndex),dataIndex=idxItem.dataIndexInside,cbParams=series.getDataParams(dataIndex);if(!(cbParams.dataIndex<0)){cbParams.axisDim=axisItem.axisDim,cbParams.axisIndex=axisItem.axisIndex,cbParams.axisType=axisItem.axisType,cbParams.axisId=axisItem.axisId,cbParams.axisValue=getAxisRawValue(axisModel.axis,{value:axisValue}),cbParams.axisValueLabel=axisValueLabel,cbParams.marker=markupStyleCreator.makeTooltipMarker(`item`,convertToColorString(cbParams.color),renderMode);var seriesTooltipResult=normalizeTooltipFormatResult(series.formatTooltip(dataIndex,!0,null)),frag=seriesTooltipResult.frag;if(frag){var valueFormatter=buildTooltipModel([series],globalTooltipModel).get(`valueFormatter`);axisSectionMarkup.blocks.push(valueFormatter?extend({valueFormatter},frag):frag)}seriesTooltipResult.text&&markupTextArrLegacy.push(seriesTooltipResult.text),cbParamsList.push(cbParams)}})}})}),articleMarkup.blocks.reverse(),markupTextArrLegacy.reverse();var positionExpr=e$2.position,orderMode=singleTooltipModel.get(`order`),builtMarkupText=buildTooltipMarkup(articleMarkup,markupStyleCreator,renderMode,orderMode,ecModel.get(`useUTC`),singleTooltipModel.get(`textStyle`));builtMarkupText&&markupTextArrLegacy.unshift(builtMarkupText);var blockBreak=renderMode===`richText`?`

`:`<br/>`,allMarkupText=markupTextArrLegacy.join(blockBreak);this._showOrMove(singleTooltipModel,function(){this._updateContentNotChangedOnAxis(dataByCoordSys,cbParamsList)?this._updatePosition(singleTooltipModel,positionExpr,point[0],point[1],this._tooltipContent,cbParamsList):this._showTooltipContent(singleTooltipModel,allMarkupText,cbParamsList,Math.random()+``,point[0],point[1],positionExpr,null,markupStyleCreator)})},TooltipView$1.prototype._showSeriesItemTooltip=function(e$2,dispatcher,dispatchAction$1){var ecModel=this._ecModel,ecData=getECData(dispatcher),seriesIndex=ecData.seriesIndex,seriesModel=ecModel.getSeriesByIndex(seriesIndex),dataModel=ecData.dataModel||seriesModel,dataIndex=ecData.dataIndex,dataType=ecData.dataType,data=dataModel.getData(dataType),renderMode=this._renderMode,positionDefault=e$2.positionDefault,tooltipModel=buildTooltipModel([data.getItemModel(dataIndex),dataModel,seriesModel&&(seriesModel.coordinateSystem||{}).model],this._tooltipModel,positionDefault?{position:positionDefault}:null),tooltipTrigger=tooltipModel.get(`trigger`);if(!(tooltipTrigger!=null&&tooltipTrigger!==`item`)){var params=dataModel.getDataParams(dataIndex,dataType),markupStyleCreator=new TooltipMarkupStyleCreator;params.marker=markupStyleCreator.makeTooltipMarker(`item`,convertToColorString(params.color),renderMode);var seriesTooltipResult=normalizeTooltipFormatResult(dataModel.formatTooltip(dataIndex,!1,dataType)),orderMode=tooltipModel.get(`order`),valueFormatter=tooltipModel.get(`valueFormatter`),frag=seriesTooltipResult.frag,markupText=frag?buildTooltipMarkup(valueFormatter?extend({valueFormatter},frag):frag,markupStyleCreator,renderMode,orderMode,ecModel.get(`useUTC`),tooltipModel.get(`textStyle`)):seriesTooltipResult.text,asyncTicket=`item_`+dataModel.name+`_`+dataIndex;this._showOrMove(tooltipModel,function(){this._showTooltipContent(tooltipModel,markupText,params,asyncTicket,e$2.offsetX,e$2.offsetY,e$2.position,e$2.target,markupStyleCreator)}),dispatchAction$1({type:`showTip`,dataIndexInside:dataIndex,dataIndex:data.getRawIndex(dataIndex),seriesIndex,from:this.uid})}},TooltipView$1.prototype._showComponentItemTooltip=function(e$2,el,dispatchAction$1){var isHTMLRenderMode=this._renderMode===`html`,ecData=getECData(el),tooltipOpt=ecData.tooltipConfig.option||{},encodeHTMLContent=tooltipOpt.encodeHTMLContent;if(isString(tooltipOpt)){var content=tooltipOpt;tooltipOpt={content,formatter:content},encodeHTMLContent=!0}encodeHTMLContent&&isHTMLRenderMode&&tooltipOpt.content&&(tooltipOpt=clone(tooltipOpt),tooltipOpt.content=encodeHTML(tooltipOpt.content));var tooltipModelCascade=[tooltipOpt],cmpt=this._ecModel.getComponent(ecData.componentMainType,ecData.componentIndex);cmpt&&tooltipModelCascade.push(cmpt),tooltipModelCascade.push({formatter:tooltipOpt.content});var positionDefault=e$2.positionDefault,subTooltipModel=buildTooltipModel(tooltipModelCascade,this._tooltipModel,positionDefault?{position:positionDefault}:null),defaultHtml=subTooltipModel.get(`content`),asyncTicket=Math.random()+``,markupStyleCreator=new TooltipMarkupStyleCreator;this._showOrMove(subTooltipModel,function(){var formatterParams=clone(subTooltipModel.get(`formatterParams`)||{});this._showTooltipContent(subTooltipModel,defaultHtml,formatterParams,asyncTicket,e$2.offsetX,e$2.offsetY,e$2.position,el,markupStyleCreator)}),dispatchAction$1({type:`showTip`,from:this.uid})},TooltipView$1.prototype._showTooltipContent=function(tooltipModel,defaultHtml,params,asyncTicket,x$1,y$1,positionExpr,el,markupStyleCreator){if(this._ticket=``,!(!tooltipModel.get(`showContent`)||!tooltipModel.get(`show`))){var tooltipContent=this._tooltipContent;tooltipContent.setEnterable(tooltipModel.get(`enterable`));var formatter=tooltipModel.get(`formatter`);positionExpr||=tooltipModel.get(`position`);var html=defaultHtml,nearPointColor=this._getNearestPoint([x$1,y$1],params,tooltipModel.get(`trigger`),tooltipModel.get(`borderColor`),tooltipModel.get(`defaultBorderColor`,!0)).color;if(formatter)if(isString(formatter)){var useUTC=tooltipModel.ecModel.get(`useUTC`),params0=isArray(params)?params[0]:params,isTimeAxis=params0&&params0.axisType&&params0.axisType.indexOf(`time`)>=0;html=formatter,isTimeAxis&&(html=format(params0.axisValue,html,useUTC)),html=formatTpl(html,params,!0)}else if(isFunction(formatter)){var callback=bind(function(cbTicket,html$1){cbTicket===this._ticket&&(tooltipContent.setContent(html$1,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),this._updatePosition(tooltipModel,positionExpr,x$1,y$1,tooltipContent,params,el))},this);this._ticket=asyncTicket,html=formatter(params,asyncTicket,callback)}else html=formatter;tooltipContent.setContent(html,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),tooltipContent.show(tooltipModel,nearPointColor),this._updatePosition(tooltipModel,positionExpr,x$1,y$1,tooltipContent,params,el)}},TooltipView$1.prototype._getNearestPoint=function(point,tooltipDataParams,trigger$2,borderColor,defaultBorderColor){if(trigger$2===`axis`||isArray(tooltipDataParams))return{color:borderColor||defaultBorderColor};if(!isArray(tooltipDataParams))return{color:borderColor||tooltipDataParams.color||tooltipDataParams.borderColor}},TooltipView$1.prototype._updatePosition=function(tooltipModel,positionExpr,x$1,y$1,content,params,el){var viewWidth=this._api.getWidth(),viewHeight=this._api.getHeight();positionExpr||=tooltipModel.get(`position`);var contentSize=content.getSize(),align=tooltipModel.get(`align`),vAlign=tooltipModel.get(`verticalAlign`),rect=el&&el.getBoundingRect().clone();if(el&&rect.applyTransform(el.transform),isFunction(positionExpr)&&(positionExpr=positionExpr([x$1,y$1],params,content.el,rect,{viewSize:[viewWidth,viewHeight],contentSize:contentSize.slice()})),isArray(positionExpr))x$1=parsePercent(positionExpr[0],viewWidth),y$1=parsePercent(positionExpr[1],viewHeight);else if(isObject(positionExpr)){var boxLayoutPosition=positionExpr;boxLayoutPosition.width=contentSize[0],boxLayoutPosition.height=contentSize[1];var layoutRect=getLayoutRect(boxLayoutPosition,{width:viewWidth,height:viewHeight});x$1=layoutRect.x,y$1=layoutRect.y,align=null,vAlign=null}else if(isString(positionExpr)&&el){var pos=calcTooltipPosition(positionExpr,rect,contentSize,tooltipModel.get(`borderWidth`));x$1=pos[0],y$1=pos[1]}else{var pos=refixTooltipPosition(x$1,y$1,content,viewWidth,viewHeight,align?null:20,vAlign?null:20);x$1=pos[0],y$1=pos[1]}if(align&&(x$1-=isCenterAlign(align)?contentSize[0]/2:align===`right`?contentSize[0]:0),vAlign&&(y$1-=isCenterAlign(vAlign)?contentSize[1]/2:vAlign===`bottom`?contentSize[1]:0),shouldTooltipConfine(tooltipModel)){var pos=confineTooltipPosition(x$1,y$1,content,viewWidth,viewHeight);x$1=pos[0],y$1=pos[1]}content.moveTo(x$1,y$1)},TooltipView$1.prototype._updateContentNotChangedOnAxis=function(dataByCoordSys,cbParamsList){var lastCoordSys=this._lastDataByCoordSys,lastCbParamsList=this._cbParamsList,contentNotChanged=!!lastCoordSys&&lastCoordSys.length===dataByCoordSys.length;return contentNotChanged&&each(lastCoordSys,function(lastItemCoordSys,indexCoordSys){var lastDataByAxis=lastItemCoordSys.dataByAxis||[],thisDataByAxis=(dataByCoordSys[indexCoordSys]||{}).dataByAxis||[];contentNotChanged&&=lastDataByAxis.length===thisDataByAxis.length,contentNotChanged&&each(lastDataByAxis,function(lastItem,indexAxis){var thisItem=thisDataByAxis[indexAxis]||{},lastIndices=lastItem.seriesDataIndices||[],newIndices=thisItem.seriesDataIndices||[];contentNotChanged=contentNotChanged&&lastItem.value===thisItem.value&&lastItem.axisType===thisItem.axisType&&lastItem.axisId===thisItem.axisId&&lastIndices.length===newIndices.length,contentNotChanged&&each(lastIndices,function(lastIdxItem,j$1){var newIdxItem=newIndices[j$1];contentNotChanged=contentNotChanged&&lastIdxItem.seriesIndex===newIdxItem.seriesIndex&&lastIdxItem.dataIndex===newIdxItem.dataIndex}),lastCbParamsList&&each(lastItem.seriesDataIndices,function(idxItem){var seriesIdx=idxItem.seriesIndex,cbParams=cbParamsList[seriesIdx],lastCbParams=lastCbParamsList[seriesIdx];cbParams&&lastCbParams&&lastCbParams.data!==cbParams.data&&(contentNotChanged=!1)})})}),this._lastDataByCoordSys=dataByCoordSys,this._cbParamsList=cbParamsList,!!contentNotChanged},TooltipView$1.prototype._hide=function(dispatchAction$1){this._lastDataByCoordSys=null,dispatchAction$1({type:`hideTip`,from:this.uid})},TooltipView$1.prototype.dispose=function(ecModel,api){env_default.node||!api.getDom()||(clear(this,`_updatePosition`),this._tooltipContent.dispose(),unregister(`itemTooltip`,api))},TooltipView$1.type=`tooltip`,TooltipView$1}(Component_default$1);function buildTooltipModel(modelCascade,globalTooltipModel,defaultTooltipOption){var ecModel=globalTooltipModel.ecModel,resultModel;defaultTooltipOption?(resultModel=new Model_default(defaultTooltipOption,ecModel,ecModel),resultModel=new Model_default(globalTooltipModel.option,resultModel,ecModel)):resultModel=globalTooltipModel;for(var i$1=modelCascade.length-1;i$1>=0;i$1--){var tooltipOpt=modelCascade[i$1];tooltipOpt&&(tooltipOpt instanceof Model_default&&(tooltipOpt=tooltipOpt.get(`tooltip`,!0)),isString(tooltipOpt)&&(tooltipOpt={formatter:tooltipOpt}),tooltipOpt&&(resultModel=new Model_default(tooltipOpt,resultModel,ecModel)))}return resultModel}function makeDispatchAction(payload,api){return payload.dispatchAction||bind(api.dispatchAction,api)}function refixTooltipPosition(x$1,y$1,content,viewWidth,viewHeight,gapH,gapV){var size=content.getSize(),width=size[0],height=size[1];return gapH!=null&&(x$1+width+gapH+2>viewWidth?x$1-=width+gapH:x$1+=gapH),gapV!=null&&(y$1+height+gapV>viewHeight?y$1-=height+gapV:y$1+=gapV),[x$1,y$1]}function confineTooltipPosition(x$1,y$1,content,viewWidth,viewHeight){var size=content.getSize(),width=size[0],height=size[1];return x$1=Math.min(x$1+width,viewWidth)-width,y$1=Math.min(y$1+height,viewHeight)-height,x$1=Math.max(x$1,0),y$1=Math.max(y$1,0),[x$1,y$1]}function calcTooltipPosition(position,rect,contentSize,borderWidth){var domWidth=contentSize[0],domHeight=contentSize[1],offset=Math.ceil(Math.SQRT2*borderWidth)+8,x$1=0,y$1=0,rectWidth=rect.width,rectHeight=rect.height;switch(position){case`inside`:x$1=rect.x+rectWidth/2-domWidth/2,y$1=rect.y+rectHeight/2-domHeight/2;break;case`top`:x$1=rect.x+rectWidth/2-domWidth/2,y$1=rect.y-domHeight-offset;break;case`bottom`:x$1=rect.x+rectWidth/2-domWidth/2,y$1=rect.y+rectHeight+offset;break;case`left`:x$1=rect.x-domWidth-offset,y$1=rect.y+rectHeight/2-domHeight/2;break;case`right`:x$1=rect.x+rectWidth+offset,y$1=rect.y+rectHeight/2-domHeight/2}return[x$1,y$1]}function isCenterAlign(align){return align===`center`||align===`middle`}function findComponentReference(payload,ecModel,api){var queryOptionMap=preParseFinder(payload).queryOptionMap,componentMainType=queryOptionMap.keys()[0];if(!(!componentMainType||componentMainType===`series`)){var model=queryReferringComponents(ecModel,componentMainType,queryOptionMap.get(componentMainType),{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];if(model){var view=api.getViewOfComponentModel(model),el;if(view.group.traverse(function(subEl){var tooltipConfig=getECData(subEl).tooltipConfig;if(tooltipConfig&&tooltipConfig.name===payload.name)return el=subEl,!0}),el)return{componentMainType,componentIndex:model.componentIndex,el}}}}var TooltipView_default=TooltipView;function install$4(registers){use(install$10),registers.registerComponentModel(TooltipModel_default),registers.registerComponentView(TooltipView_default),registers.registerAction({type:`showTip`,event:`showTip`,update:`tooltip:manuallyShowTip`},noop),registers.registerAction({type:`hideTip`,event:`hideTip`,update:`tooltip:manuallyHideTip`},noop)}var TitleModel=function(_super){__extends(TitleModel$1,_super);function TitleModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=TitleModel$1.type,_this.layoutMode={type:`box`,ignoreSize:!0},_this}return TitleModel$1.type=`title`,TitleModel$1.defaultOption={z:6,show:!0,text:``,target:`blank`,subtext:``,subtarget:`blank`,left:`center`,top:tokens_default.size.m,backgroundColor:tokens_default.color.transparent,borderColor:tokens_default.color.primary,borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:`bold`,color:tokens_default.color.primary},subtextStyle:{fontSize:12,color:tokens_default.color.quaternary}},TitleModel$1}(Component_default),TitleView=function(_super){__extends(TitleView$1,_super);function TitleView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=TitleView$1.type,_this}return TitleView$1.prototype.render=function(titleModel,ecModel,api){if(this.group.removeAll(),titleModel.get(`show`)){var group=this.group,textStyleModel=titleModel.getModel(`textStyle`),subtextStyleModel=titleModel.getModel(`subtextStyle`),textAlign=titleModel.get(`textAlign`),textVerticalAlign=retrieve2(titleModel.get(`textBaseline`),titleModel.get(`textVerticalAlign`)),textEl=new Text_default({style:createTextStyle(textStyleModel,{text:titleModel.get(`text`),fill:textStyleModel.getTextColor()},{disableBox:!0}),z2:10}),textRect=textEl.getBoundingRect(),subText=titleModel.get(`subtext`),subTextEl=new Text_default({style:createTextStyle(subtextStyleModel,{text:subText,fill:subtextStyleModel.getTextColor(),y:textRect.height+titleModel.get(`itemGap`),verticalAlign:`top`},{disableBox:!0}),z2:10}),link=titleModel.get(`link`),sublink=titleModel.get(`sublink`),triggerEvent=titleModel.get(`triggerEvent`,!0);textEl.silent=!link&&!triggerEvent,subTextEl.silent=!sublink&&!triggerEvent,link&&textEl.on(`click`,function(){windowOpen(link,`_`+titleModel.get(`target`))}),sublink&&subTextEl.on(`click`,function(){windowOpen(sublink,`_`+titleModel.get(`subtarget`))}),getECData(textEl).eventData=getECData(subTextEl).eventData=triggerEvent?{componentType:`title`,componentIndex:titleModel.componentIndex}:null,group.add(textEl),subText&&group.add(subTextEl);var groupRect=group.getBoundingRect(),layoutOption=titleModel.getBoxLayoutParams();layoutOption.width=groupRect.width,layoutOption.height=groupRect.height;var layoutRef=createBoxLayoutReference(titleModel,api),layoutRect=getLayoutRect(layoutOption,layoutRef.refContainer,titleModel.get(`padding`));textAlign||(textAlign=titleModel.get(`left`)||titleModel.get(`right`),textAlign===`middle`&&(textAlign=`center`),textAlign===`right`?layoutRect.x+=layoutRect.width:textAlign===`center`&&(layoutRect.x+=layoutRect.width/2)),textVerticalAlign||(textVerticalAlign=titleModel.get(`top`)||titleModel.get(`bottom`),textVerticalAlign===`center`&&(textVerticalAlign=`middle`),textVerticalAlign===`bottom`?layoutRect.y+=layoutRect.height:textVerticalAlign===`middle`&&(layoutRect.y+=layoutRect.height/2),textVerticalAlign||=`top`),group.x=layoutRect.x,group.y=layoutRect.y,group.markRedraw();var alignStyle={align:textAlign,verticalAlign:textVerticalAlign};textEl.setStyle(alignStyle),subTextEl.setStyle(alignStyle),groupRect=group.getBoundingRect();var padding=layoutRect.margin,style=titleModel.getItemStyle([`color`,`opacity`]);style.fill=titleModel.get(`backgroundColor`);var rect=new Rect_default({shape:{x:groupRect.x-padding[3],y:groupRect.y-padding[0],width:groupRect.width+padding[1]+padding[3],height:groupRect.height+padding[0]+padding[2],r:titleModel.get(`borderRadius`)},style,subPixelOptimize:!0,silent:!0});group.add(rect)}},TitleView$1.type=`title`,TitleView$1}(Component_default$1);function install$6(registers){registers.registerComponentModel(TitleModel),registers.registerComponentView(TitleView)}var InsideZoomModel_default=function(_super){__extends(InsideZoomModel$1,_super);function InsideZoomModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=InsideZoomModel$1.type,_this}return InsideZoomModel$1.type=`dataZoom.inside`,InsideZoomModel$1.defaultOption=inheritDefaultOption(DataZoomModel_default.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),InsideZoomModel$1}(DataZoomModel_default),inner=makeInner();function setViewInfoToCoordSysRecord(api,dataZoomModel,getRange){inner(api).coordSysRecordMap.each(function(coordSysRecord){var dzInfo=coordSysRecord.dataZoomInfoMap.get(dataZoomModel.uid);dzInfo&&(dzInfo.getRange=getRange)})}function disposeCoordSysRecordIfNeeded(api,dataZoomModel){for(var coordSysRecordMap=inner(api).coordSysRecordMap,coordSysKeyArr=coordSysRecordMap.keys(),i$1=0;i$1<coordSysKeyArr.length;i$1++){var coordSysKey=coordSysKeyArr[i$1],coordSysRecord=coordSysRecordMap.get(coordSysKey),dataZoomInfoMap=coordSysRecord.dataZoomInfoMap;if(dataZoomInfoMap){var dzUid=dataZoomModel.uid;dataZoomInfoMap.get(dzUid)&&(dataZoomInfoMap.removeKey(dzUid),dataZoomInfoMap.keys().length||disposeCoordSysRecord(coordSysRecordMap,coordSysRecord))}}}function disposeCoordSysRecord(coordSysRecordMap,coordSysRecord){if(coordSysRecord){coordSysRecordMap.removeKey(coordSysRecord.model.uid);var controller=coordSysRecord.controller;controller&&controller.dispose()}}function createCoordSysRecord(api,coordSysModel){var coordSysRecord={model:coordSysModel,containsPoint:curry(containsPoint,coordSysModel),dispatchAction:curry(dispatchAction,api),dataZoomInfoMap:null,controller:null},controller=coordSysRecord.controller=new RoamController_default(api.getZr());return each([`pan`,`zoom`,`scrollMove`],function(eventName){controller.on(eventName,function(event){var batch$1=[];coordSysRecord.dataZoomInfoMap.each(function(dzInfo){if(event.isAvailableBehavior(dzInfo.model.option)){var method=(dzInfo.getRange||{})[eventName],range=method&&method(dzInfo.dzReferCoordSysInfo,coordSysRecord.model.mainType,coordSysRecord.controller,event);!dzInfo.model.get(`disabled`,!0)&&range&&batch$1.push({dataZoomId:dzInfo.model.id,start:range[0],end:range[1]})}}),batch$1.length&&coordSysRecord.dispatchAction(batch$1)})}),coordSysRecord}function dispatchAction(api,batch$1){api.isDisposed()||api.dispatchAction({type:`dataZoom`,animation:{easing:`cubicOut`,duration:100},batch:batch$1})}function containsPoint(coordSysModel,e$2,x$1,y$1){return coordSysModel.coordinateSystem.containPoint([x$1,y$1])}function mergeControllerParams(dataZoomInfoMap,coordSysRecord,api){var controlType,prefix$1=`type_`,typePriority={type_true:2,type_move:1,type_false:0,type_undefined:-1},preventDefaultMouseMove=!0;return dataZoomInfoMap.each(function(dataZoomInfo){var dataZoomModel=dataZoomInfo.model,oneType=dataZoomModel.get(`disabled`,!0)?!1:dataZoomModel.get(`zoomLock`,!0)?`move`:!0;typePriority[prefix$1+oneType]>typePriority[prefix$1+controlType]&&(controlType=oneType),preventDefaultMouseMove&&=dataZoomModel.get(`preventDefaultMouseMove`,!0)}),{controlType,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!preventDefaultMouseMove,api,zInfo:{component:coordSysRecord.model},triggerInfo:{roamTrigger:null,isInSelf:coordSysRecord.containsPoint}}}}function installDataZoomRoamProcessor(registers){registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,function(ecModel,api){var apiInner=inner(api),coordSysRecordMap=apiInner.coordSysRecordMap||=createHashMap();coordSysRecordMap.each(function(coordSysRecord){coordSysRecord.dataZoomInfoMap=null}),ecModel.eachComponent({mainType:`dataZoom`,subType:`inside`},function(dataZoomModel){var dzReferCoordSysWrap=collectReferCoordSysModelInfo(dataZoomModel);each(dzReferCoordSysWrap.infoList,function(dzCoordSysInfo){var coordSysUid=dzCoordSysInfo.model.uid,coordSysRecord=coordSysRecordMap.get(coordSysUid)||coordSysRecordMap.set(coordSysUid,createCoordSysRecord(api,dzCoordSysInfo.model));(coordSysRecord.dataZoomInfoMap||=createHashMap()).set(dataZoomModel.uid,{dzReferCoordSysInfo:dzCoordSysInfo,model:dataZoomModel,getRange:null})})}),coordSysRecordMap.each(function(coordSysRecord){var controller=coordSysRecord.controller,firstDzInfo,dataZoomInfoMap=coordSysRecord.dataZoomInfoMap;if(dataZoomInfoMap){var firstDzKey=dataZoomInfoMap.keys()[0];firstDzKey!=null&&(firstDzInfo=dataZoomInfoMap.get(firstDzKey))}if(!firstDzInfo){disposeCoordSysRecord(coordSysRecordMap,coordSysRecord);return}var controllerParams=mergeControllerParams(dataZoomInfoMap,coordSysRecord,api);controller.enable(controllerParams.controlType,controllerParams.opt),createOrUpdate(coordSysRecord,`dispatchAction`,firstDzInfo.model.get(`throttle`,!0),`fixRate`)})})}var InsideZoomView=function(_super){__extends(InsideZoomView$1,_super);function InsideZoomView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=`dataZoom.inside`,_this}return InsideZoomView$1.prototype.render=function(dataZoomModel,ecModel,api){if(_super.prototype.render.apply(this,arguments),dataZoomModel.noTarget()){this._clear();return}this.range=dataZoomModel.getPercentRange(),setViewInfoToCoordSysRecord(api,dataZoomModel,{pan:bind(getRangeHandlers.pan,this),zoom:bind(getRangeHandlers.zoom,this),scrollMove:bind(getRangeHandlers.scrollMove,this)})},InsideZoomView$1.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},InsideZoomView$1.prototype._clear=function(){disposeCoordSysRecordIfNeeded(this.api,this.dataZoomModel),this.range=null},InsideZoomView$1.type=`dataZoom.inside`,InsideZoomView$1}(DataZoomView_default),getRangeHandlers={zoom:function(coordSysInfo,coordSysMainType,controller,e$2){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel){var directionInfo=getDirectionInfo[coordSysMainType](null,[e$2.originX,e$2.originY],axisModel,controller,coordSysInfo),percentPoint=(directionInfo.signal>0?directionInfo.pixelStart+directionInfo.pixelLength-directionInfo.pixel:directionInfo.pixel-directionInfo.pixelStart)/directionInfo.pixelLength*(range[1]-range[0])+range[0],scale$3=Math.max(1/e$2.scale,0);range[0]=(range[0]-percentPoint)*scale$3+percentPoint,range[1]=(range[1]-percentPoint)*scale$3+percentPoint;var minMaxSpan=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(sliderMove(0,range,[0,100],0,minMaxSpan.minSpan,minMaxSpan.maxSpan),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1])return range}},pan:makeMover(function(range,axisModel,coordSysInfo,coordSysMainType,controller,e$2){var directionInfo=getDirectionInfo[coordSysMainType]([e$2.oldX,e$2.oldY],[e$2.newX,e$2.newY],axisModel,controller,coordSysInfo);return directionInfo.signal*(range[1]-range[0])*directionInfo.pixel/directionInfo.pixelLength}),scrollMove:makeMover(function(range,axisModel,coordSysInfo,coordSysMainType,controller,e$2){return getDirectionInfo[coordSysMainType]([0,0],[e$2.scrollDelta,e$2.scrollDelta],axisModel,controller,coordSysInfo).signal*(range[1]-range[0])*e$2.scrollDelta})};function makeMover(getPercentDelta){return function(coordSysInfo,coordSysMainType,controller,e$2){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel){var percentDelta=getPercentDelta(range,axisModel,coordSysInfo,coordSysMainType,controller,e$2);if(sliderMove(percentDelta,range,[0,100],`all`),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1])return range}}}var getDirectionInfo={grid:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,ret={},rect=coordSysInfo.model.coordinateSystem.getRect();return oldPoint||=[0,0],axis.dim===`x`?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=rect.width,ret.pixelStart=rect.x,ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=rect.height,ret.pixelStart=rect.y,ret.signal=axis.inverse?-1:1),ret},polar:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,ret={},polar=coordSysInfo.model.coordinateSystem,radiusExtent=polar.getRadiusAxis().getExtent(),angleExtent=polar.getAngleAxis().getExtent();return oldPoint=oldPoint?polar.pointToCoord(oldPoint):[0,0],newPoint=polar.pointToCoord(newPoint),axisModel.mainType===`radiusAxis`?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=radiusExtent[1]-radiusExtent[0],ret.pixelStart=radiusExtent[0],ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=angleExtent[1]-angleExtent[0],ret.pixelStart=angleExtent[0],ret.signal=axis.inverse?-1:1),ret},singleAxis:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,rect=coordSysInfo.model.coordinateSystem.getRect(),ret={};return oldPoint||=[0,0],axis.orient===`horizontal`?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=rect.width,ret.pixelStart=rect.x,ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=rect.height,ret.pixelStart=rect.y,ret.signal=axis.inverse?-1:1),ret}},InsideZoomView_default=InsideZoomView;function install$8(registers){installCommon(registers),registers.registerComponentModel(InsideZoomModel_default),registers.registerComponentView(InsideZoomView_default),installDataZoomRoamProcessor(registers)}var SliderZoomModel_default=function(_super){__extends(SliderZoomModel$1,_super);function SliderZoomModel$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=SliderZoomModel$1.type,_this}return SliderZoomModel$1.type=`dataZoom.slider`,SliderZoomModel$1.layoutMode=`box`,SliderZoomModel$1.defaultOption=inheritDefaultOption(DataZoomModel_default.defaultOption,{show:!0,right:`ph`,top:`ph`,width:`ph`,height:`ph`,left:null,bottom:null,borderColor:tokens_default.color.accent10,borderRadius:0,backgroundColor:tokens_default.color.transparent,dataBackground:{lineStyle:{color:tokens_default.color.accent30,width:.5},areaStyle:{color:tokens_default.color.accent20,opacity:.2}},selectedDataBackground:{lineStyle:{color:tokens_default.color.accent40,width:.5},areaStyle:{color:tokens_default.color.accent20,opacity:.3}},fillerColor:`rgba(135,175,274,0.2)`,handleIcon:`path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z`,handleSize:`100%`,handleStyle:{color:tokens_default.color.neutral00,borderColor:tokens_default.color.accent20},moveHandleSize:7,moveHandleIcon:`path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z`,moveHandleStyle:{color:tokens_default.color.accent40,opacity:.5},showDetail:!0,showDataShadow:`auto`,realtime:!0,zoomLock:!1,textStyle:{color:tokens_default.color.tertiary},brushSelect:!0,brushStyle:{color:tokens_default.color.accent30,opacity:.3},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:tokens_default.color.accent40},moveHandleStyle:{opacity:.8}},defaultLocationEdgeGap:15}),SliderZoomModel$1}(DataZoomModel_default),Rect=Rect_default,DEFAULT_FRAME_BORDER_WIDTH=1,DEFAULT_FILLER_SIZE=30,DEFAULT_MOVE_HANDLE_SIZE=7,HORIZONTAL=`horizontal`,VERTICAL=`vertical`,LABEL_GAP=5,SHOW_DATA_SHADOW_SERIES_TYPE=[`line`,`bar`,`candlestick`,`scatter`],REALTIME_ANIMATION_CONFIG={easing:`cubicOut`,duration:100,delay:0},SliderZoomView=function(_super){__extends(SliderZoomView$1,_super);function SliderZoomView$1(){var _this=_super!==null&&_super.apply(this,arguments)||this;return _this.type=SliderZoomView$1.type,_this._displayables={},_this}return SliderZoomView$1.prototype.init=function(ecModel,api){this.api=api,this._onBrush=bind(this._onBrush,this),this._onBrushEnd=bind(this._onBrushEnd,this)},SliderZoomView$1.prototype.render=function(dataZoomModel,ecModel,api,payload){if(_super.prototype.render.apply(this,arguments),createOrUpdate(this,`_dispatchZoomAction`,dataZoomModel.get(`throttle`),`fixRate`),this._orient=dataZoomModel.getOrient(),dataZoomModel.get(`show`)===!1){this.group.removeAll();return}if(dataZoomModel.noTarget()){this._clear(),this.group.removeAll();return}(!payload||payload.type!==`dataZoom`||payload.from!==this.uid)&&this._buildView(),this._updateView()},SliderZoomView$1.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},SliderZoomView$1.prototype._clear=function(){clear(this,`_dispatchZoomAction`);var zr=this.api.getZr();zr.off(`mousemove`,this._onBrush),zr.off(`mouseup`,this._onBrushEnd)},SliderZoomView$1.prototype._buildView=function(){var thisGroup=this.group;thisGroup.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var barGroup=this._displayables.sliderGroup=new Group_default;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),thisGroup.add(barGroup),this._positionGroup()},SliderZoomView$1.prototype._resetLocation=function(){var dataZoomModel=this.dataZoomModel,api=this.api,moveHandleSize=dataZoomModel.get(`brushSelect`)?DEFAULT_MOVE_HANDLE_SIZE:0,refContainer=createBoxLayoutReference(dataZoomModel,api).refContainer,coordRect=this._findCoordRect(),edgeGap=dataZoomModel.get(`defaultLocationEdgeGap`,!0)||0,positionInfo=this._orient===HORIZONTAL?{right:refContainer.width-coordRect.x-coordRect.width,top:refContainer.height-DEFAULT_FILLER_SIZE-edgeGap-moveHandleSize,width:coordRect.width,height:DEFAULT_FILLER_SIZE}:{right:edgeGap,top:coordRect.y,width:DEFAULT_FILLER_SIZE,height:coordRect.height},layoutParams=getLayoutParams(dataZoomModel.option);each([`right`,`top`,`width`,`height`],function(name){layoutParams[name]===`ph`&&(layoutParams[name]=positionInfo[name])});var layoutRect=getLayoutRect(layoutParams,refContainer);this._location={x:layoutRect.x,y:layoutRect.y},this._size=[layoutRect.width,layoutRect.height],this._orient===VERTICAL&&this._size.reverse()},SliderZoomView$1.prototype._positionGroup=function(){var thisGroup=this.group,location$1=this._location,orient=this._orient,targetAxisModel=this.dataZoomModel.getFirstTargetAxisModel(),inverse=targetAxisModel&&targetAxisModel.get(`inverse`),sliderGroup=this._displayables.sliderGroup,otherAxisInverse=(this._dataShadowInfo||{}).otherAxisInverse;sliderGroup.attr(orient===HORIZONTAL&&!inverse?{scaleY:otherAxisInverse?1:-1,scaleX:1}:orient===HORIZONTAL&&inverse?{scaleY:otherAxisInverse?1:-1,scaleX:-1}:orient===VERTICAL&&!inverse?{scaleY:otherAxisInverse?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:otherAxisInverse?-1:1,scaleX:-1,rotation:Math.PI/2});var rect=thisGroup.getBoundingRect([sliderGroup]);thisGroup.x=location$1.x-rect.x,thisGroup.y=location$1.y-rect.y,thisGroup.markRedraw()},SliderZoomView$1.prototype._getViewExtent=function(){return[0,this._size[0]]},SliderZoomView$1.prototype._renderBackground=function(){var dataZoomModel=this.dataZoomModel,size=this._size,barGroup=this._displayables.sliderGroup,brushSelect=dataZoomModel.get(`brushSelect`);barGroup.add(new Rect({silent:!0,shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:dataZoomModel.get(`backgroundColor`)},z2:-40}));var clickPanel=new Rect({shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:`transparent`},z2:0,onclick:bind(this._onClickPanel,this)}),zr=this.api.getZr();brushSelect?(clickPanel.on(`mousedown`,this._onBrushStart,this),clickPanel.cursor=`crosshair`,zr.on(`mousemove`,this._onBrush),zr.on(`mouseup`,this._onBrushEnd)):(zr.off(`mousemove`,this._onBrush),zr.off(`mouseup`,this._onBrushEnd)),barGroup.add(clickPanel)},SliderZoomView$1.prototype._renderDataShadow=function(){var info=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!info)return;var size=this._size,oldSize=this._shadowSize||[],seriesModel=info.series,data=seriesModel.getRawData(),candlestickDim=seriesModel.getShadowDim&&seriesModel.getShadowDim(),otherDim=candlestickDim&&data.getDimensionInfo(candlestickDim)?seriesModel.getShadowDim():info.otherDim;if(otherDim==null)return;var polygonPts=this._shadowPolygonPts,polylinePts=this._shadowPolylinePts;if(data!==this._shadowData||otherDim!==this._shadowDim||size[0]!==oldSize[0]||size[1]!==oldSize[1]){var thisDataExtent_1=data.getDataExtent(info.thisDim),otherDataExtent_1=data.getDataExtent(otherDim),otherOffset=(otherDataExtent_1[1]-otherDataExtent_1[0])*.3;otherDataExtent_1=[otherDataExtent_1[0]-otherOffset,otherDataExtent_1[1]+otherOffset];var otherShadowExtent_1=[0,size[1]],thisShadowExtent=[0,size[0]],areaPoints_1=[[size[0],0],[0,0]],linePoints_1=[],step_1=thisShadowExtent[1]/Math.max(1,data.count()-1),normalizationConstant_1=size[0]/(thisDataExtent_1[1]-thisDataExtent_1[0]),isTimeAxis_1=info.thisAxis.type===`time`,thisCoord_1=-step_1,stride_1=Math.round(data.count()/size[0]),lastIsEmpty_1;data.each([info.thisDim,otherDim],function(thisValue,otherValue,index){if(stride_1>0&&index%stride_1){isTimeAxis_1||(thisCoord_1+=step_1);return}thisCoord_1=isTimeAxis_1?(+thisValue-thisDataExtent_1[0])*normalizationConstant_1:thisCoord_1+step_1;var isEmpty=otherValue==null||isNaN(otherValue)||otherValue===``,otherCoord=isEmpty?0:linearMap(otherValue,otherDataExtent_1,otherShadowExtent_1,!0);isEmpty&&!lastIsEmpty_1&&index?(areaPoints_1.push([areaPoints_1[areaPoints_1.length-1][0],0]),linePoints_1.push([linePoints_1[linePoints_1.length-1][0],0])):!isEmpty&&lastIsEmpty_1&&(areaPoints_1.push([thisCoord_1,0]),linePoints_1.push([thisCoord_1,0])),isEmpty||(areaPoints_1.push([thisCoord_1,otherCoord]),linePoints_1.push([thisCoord_1,otherCoord])),lastIsEmpty_1=isEmpty}),polygonPts=this._shadowPolygonPts=areaPoints_1,polylinePts=this._shadowPolylinePts=linePoints_1}this._shadowData=data,this._shadowDim=otherDim,this._shadowSize=[size[0],size[1]];var dataZoomModel=this.dataZoomModel;function createDataShadowGroup(isSelectedArea){var model=dataZoomModel.getModel(isSelectedArea?`selectedDataBackground`:`dataBackground`),group$1=new Group_default,polygon=new Polygon_default({shape:{points:polygonPts},segmentIgnoreThreshold:1,style:model.getModel(`areaStyle`).getAreaStyle(),silent:!0,z2:-20}),polyline=new Polyline_default({shape:{points:polylinePts},segmentIgnoreThreshold:1,style:model.getModel(`lineStyle`).getLineStyle(),silent:!0,z2:-19});return group$1.add(polygon),group$1.add(polyline),group$1}for(var i$1=0;i$1<3;i$1++){var group=createDataShadowGroup(i$1===1);this._displayables.sliderGroup.add(group),this._displayables.dataShadowSegs.push(group)}},SliderZoomView$1.prototype._prepareDataShadowInfo=function(){var dataZoomModel=this.dataZoomModel,showDataShadow=dataZoomModel.get(`showDataShadow`);if(showDataShadow!==!1){var result,ecModel=this.ecModel;return dataZoomModel.eachTargetAxis(function(axisDim,axisIndex){var seriesModels=dataZoomModel.getAxisProxy(axisDim,axisIndex).getTargetSeriesModels();each(seriesModels,function(seriesModel){if(!result&&!(showDataShadow!==!0&&indexOf(SHOW_DATA_SHADOW_SERIES_TYPE,seriesModel.get(`type`))<0)){var thisAxis=ecModel.getComponent(getAxisMainType(axisDim),axisIndex).axis,otherDim=getOtherDim(axisDim),otherAxisInverse,coordSys=seriesModel.coordinateSystem;otherDim!=null&&coordSys.getOtherAxis&&(otherAxisInverse=coordSys.getOtherAxis(thisAxis).inverse),otherDim=seriesModel.getData().mapDimension(otherDim);var thisDim=seriesModel.getData().mapDimension(axisDim);result={thisAxis,series:seriesModel,thisDim,otherDim,otherAxisInverse}}},this)},this),result}},SliderZoomView$1.prototype._renderHandle=function(){var thisGroup=this.group,displayables=this._displayables,handles=displayables.handles=[null,null],handleLabels=displayables.handleLabels=[null,null],sliderGroup=this._displayables.sliderGroup,size=this._size,dataZoomModel=this.dataZoomModel,api=this.api,borderRadius=dataZoomModel.get(`borderRadius`)||0,brushSelect=dataZoomModel.get(`brushSelect`),filler=displayables.filler=new Rect({silent:brushSelect,style:{fill:dataZoomModel.get(`fillerColor`)},textConfig:{position:`inside`}});sliderGroup.add(filler),sliderGroup.add(new Rect({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:size[0],height:size[1],r:borderRadius},style:{stroke:dataZoomModel.get(`dataBackgroundColor`)||dataZoomModel.get(`borderColor`),lineWidth:DEFAULT_FRAME_BORDER_WIDTH,fill:tokens_default.color.transparent}})),each([0,1],function(handleIndex){var iconStr=dataZoomModel.get(`handleIcon`);!symbolBuildProxies[iconStr]&&iconStr.indexOf(`path://`)<0&&iconStr.indexOf(`image://`)<0&&(iconStr=`path://`+iconStr);var path$1=createSymbol(iconStr,-1,0,2,2,null,!0);path$1.attr({cursor:getCursor(this._orient),draggable:!0,drift:bind(this._onDragMove,this,handleIndex),ondragend:bind(this._onDragEnd,this),onmouseover:bind(this._showDataInfo,this,!0),onmouseout:bind(this._showDataInfo,this,!1),z2:5});var bRect=path$1.getBoundingRect(),handleSize=dataZoomModel.get(`handleSize`);this._handleHeight=parsePercent(handleSize,this._size[1]),this._handleWidth=bRect.width/bRect.height*this._handleHeight,path$1.setStyle(dataZoomModel.getModel(`handleStyle`).getItemStyle()),path$1.style.strokeNoScale=!0,path$1.rectHover=!0,path$1.ensureState(`emphasis`).style=dataZoomModel.getModel([`emphasis`,`handleStyle`]).getItemStyle(),enableHoverEmphasis(path$1);var handleColor=dataZoomModel.get(`handleColor`);handleColor!=null&&(path$1.style.fill=handleColor),sliderGroup.add(handles[handleIndex]=path$1);var textStyleModel=dataZoomModel.getModel(`textStyle`),handleLabelShow=(dataZoomModel.get(`handleLabel`)||{}).show||!1;thisGroup.add(handleLabels[handleIndex]=new Text_default({silent:!0,invisible:!handleLabelShow,style:createTextStyle(textStyleModel,{x:0,y:0,text:``,verticalAlign:`middle`,align:`center`,fill:textStyleModel.getTextColor(),font:textStyleModel.getFont()}),z2:10}))},this);var actualMoveZone=filler;if(brushSelect){var moveHandleHeight=parsePercent(dataZoomModel.get(`moveHandleSize`),size[1]),moveHandle_1=displayables.moveHandle=new Rect_default({style:dataZoomModel.getModel(`moveHandleStyle`).getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:size[1]-.5,height:moveHandleHeight}}),iconSize=moveHandleHeight*.8,moveHandleIcon=displayables.moveHandleIcon=createSymbol(dataZoomModel.get(`moveHandleIcon`),-iconSize/2,-iconSize/2,iconSize,iconSize,tokens_default.color.neutral00,!0);moveHandleIcon.silent=!0,moveHandleIcon.y=size[1]+moveHandleHeight/2-.5,moveHandle_1.ensureState(`emphasis`).style=dataZoomModel.getModel([`emphasis`,`moveHandleStyle`]).getItemStyle();var moveZoneExpandSize=Math.min(size[1]/2,Math.max(moveHandleHeight,10));actualMoveZone=displayables.moveZone=new Rect_default({invisible:!0,shape:{y:size[1]-moveZoneExpandSize,height:moveHandleHeight+moveZoneExpandSize}}),actualMoveZone.on(`mouseover`,function(){api.enterEmphasis(moveHandle_1)}).on(`mouseout`,function(){api.leaveEmphasis(moveHandle_1)}),sliderGroup.add(moveHandle_1),sliderGroup.add(moveHandleIcon),sliderGroup.add(actualMoveZone)}actualMoveZone.attr({draggable:!0,cursor:`default`,drift:bind(this._onDragMove,this,`all`),ondragstart:bind(this._showDataInfo,this,!0),ondragend:bind(this._onDragEnd,this),onmouseover:bind(this._showDataInfo,this,!0),onmouseout:bind(this._showDataInfo,this,!1)})},SliderZoomView$1.prototype._resetInterval=function(){var range=this._range=this.dataZoomModel.getPercentRange(),viewExtent=this._getViewExtent();this._handleEnds=[linearMap(range[0],[0,100],viewExtent,!0),linearMap(range[1],[0,100],viewExtent,!0)]},SliderZoomView$1.prototype._updateInterval=function(handleIndex,delta){var dataZoomModel=this.dataZoomModel,handleEnds=this._handleEnds,viewExtend=this._getViewExtent(),minMaxSpan=dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan(),percentExtent=[0,100];sliderMove(delta,handleEnds,viewExtend,dataZoomModel.get(`zoomLock`)?`all`:handleIndex,minMaxSpan.minSpan==null?null:linearMap(minMaxSpan.minSpan,percentExtent,viewExtend,!0),minMaxSpan.maxSpan==null?null:linearMap(minMaxSpan.maxSpan,percentExtent,viewExtend,!0));var lastRange=this._range,range=this._range=asc([linearMap(handleEnds[0],viewExtend,percentExtent,!0),linearMap(handleEnds[1],viewExtend,percentExtent,!0)]);return!lastRange||lastRange[0]!==range[0]||lastRange[1]!==range[1]},SliderZoomView$1.prototype._updateView=function(nonRealtime){var displaybles=this._displayables,handleEnds=this._handleEnds,handleInterval=asc(handleEnds.slice()),size=this._size;each([0,1],function(handleIndex){var handle=displaybles.handles[handleIndex],handleHeight=this._handleHeight;handle.attr({scaleX:handleHeight/2,scaleY:handleHeight/2,x:handleEnds[handleIndex]+(handleIndex?-1:1),y:size[1]/2-handleHeight/2})},this),displaybles.filler.setShape({x:handleInterval[0],y:0,width:handleInterval[1]-handleInterval[0],height:size[1]});var viewExtent={x:handleInterval[0],width:handleInterval[1]-handleInterval[0]};displaybles.moveHandle&&(displaybles.moveHandle.setShape(viewExtent),displaybles.moveZone.setShape(viewExtent),displaybles.moveZone.getBoundingRect(),displaybles.moveHandleIcon&&displaybles.moveHandleIcon.attr(`x`,viewExtent.x+viewExtent.width/2));for(var dataShadowSegs=displaybles.dataShadowSegs,segIntervals=[0,handleInterval[0],handleInterval[1],size[0]],i$1=0;i$1<dataShadowSegs.length;i$1++){var segGroup=dataShadowSegs[i$1],clipPath=segGroup.getClipPath();clipPath||(clipPath=new Rect_default,segGroup.setClipPath(clipPath)),clipPath.setShape({x:segIntervals[i$1],y:0,width:segIntervals[i$1+1]-segIntervals[i$1],height:size[1]})}this._updateDataInfo(nonRealtime)},SliderZoomView$1.prototype._updateDataInfo=function(nonRealtime){var dataZoomModel=this.dataZoomModel,displaybles=this._displayables,handleLabels=displaybles.handleLabels,orient=this._orient,labelTexts=[``,``];if(dataZoomModel.get(`showDetail`)){var axisProxy=dataZoomModel.findRepresentativeAxisProxy();if(axisProxy){var axis=axisProxy.getAxisModel().axis,range=this._range,dataInterval=nonRealtime?axisProxy.calculateDataWindow({start:range[0],end:range[1]}).valueWindow:axisProxy.getDataValueWindow();labelTexts=[this._formatLabel(dataInterval[0],axis),this._formatLabel(dataInterval[1],axis)]}}var orderedHandleEnds=asc(this._handleEnds.slice());setLabel.call(this,0),setLabel.call(this,1);function setLabel(handleIndex){var barTransform=getTransform(displaybles.handles[handleIndex].parent,this.group),direction=transformDirection(handleIndex===0?`right`:`left`,barTransform),offset=this._handleWidth/2+LABEL_GAP,textPoint=applyTransform$1([orderedHandleEnds[handleIndex]+(handleIndex===0?-offset:offset),this._size[1]/2],barTransform);handleLabels[handleIndex].setStyle({x:textPoint[0],y:textPoint[1],verticalAlign:orient===HORIZONTAL?`middle`:direction,align:orient===HORIZONTAL?direction:`center`,text:labelTexts[handleIndex]})}},SliderZoomView$1.prototype._formatLabel=function(value,axis){var dataZoomModel=this.dataZoomModel,labelFormatter=dataZoomModel.get(`labelFormatter`),labelPrecision=dataZoomModel.get(`labelPrecision`);(labelPrecision==null||labelPrecision===`auto`)&&(labelPrecision=axis.getPixelPrecision());var valueStr=value==null||isNaN(value)?``:axis.type===`category`||axis.type===`time`?axis.scale.getLabel({value:Math.round(value)}):value.toFixed(Math.min(labelPrecision,20));return isFunction(labelFormatter)?labelFormatter(value,valueStr):isString(labelFormatter)?labelFormatter.replace(`{value}`,valueStr):valueStr},SliderZoomView$1.prototype._showDataInfo=function(isEmphasis){var normalShow=(this.dataZoomModel.get(`handleLabel`)||{}).show||!1,emphasisShow=this.dataZoomModel.getModel([`emphasis`,`handleLabel`]).get(`show`)||!1,toShow=isEmphasis||this._dragging?emphasisShow:normalShow,displayables=this._displayables,handleLabels=displayables.handleLabels;handleLabels[0].attr(`invisible`,!toShow),handleLabels[1].attr(`invisible`,!toShow),displayables.moveHandle&&this.api[toShow?`enterEmphasis`:`leaveEmphasis`](displayables.moveHandle,1)},SliderZoomView$1.prototype._onDragMove=function(handleIndex,dx,dy,event){this._dragging=!0,stop(event.event);var barTransform=this._displayables.sliderGroup.getLocalTransform(),vertex$3=applyTransform$1([dx,dy],barTransform,!0),changed=this._updateInterval(handleIndex,vertex$3[0]),realtime=this.dataZoomModel.get(`realtime`);this._updateView(!realtime),changed&&realtime&&this._dispatchZoomAction(!0)},SliderZoomView$1.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get(`realtime`)&&this._dispatchZoomAction(!1)},SliderZoomView$1.prototype._onClickPanel=function(e$2){var size=this._size,localPoint=this._displayables.sliderGroup.transformCoordToLocal(e$2.offsetX,e$2.offsetY);if(!(localPoint[0]<0||localPoint[0]>size[0]||localPoint[1]<0||localPoint[1]>size[1])){var handleEnds=this._handleEnds,center$1=(handleEnds[0]+handleEnds[1])/2,changed=this._updateInterval(`all`,localPoint[0]-center$1);this._updateView(),changed&&this._dispatchZoomAction(!1)}},SliderZoomView$1.prototype._onBrushStart=function(e$2){var x$1=e$2.offsetX,y$1=e$2.offsetY;this._brushStart=new Point_default(x$1,y$1),this._brushing=!0,this._brushStartTime=+new Date},SliderZoomView$1.prototype._onBrushEnd=function(e$2){if(this._brushing){var brushRect=this._displayables.brushRect;if(this._brushing=!1,brushRect){brushRect.attr(`ignore`,!0);var brushShape=brushRect.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(brushShape.width)<5)){var viewExtend=this._getViewExtent(),percentExtent=[0,100],handleEnds=this._handleEnds=[brushShape.x,brushShape.x+brushShape.width],minMaxSpan=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();sliderMove(0,handleEnds,viewExtend,0,minMaxSpan.minSpan==null?null:linearMap(minMaxSpan.minSpan,percentExtent,viewExtend,!0),minMaxSpan.maxSpan==null?null:linearMap(minMaxSpan.maxSpan,percentExtent,viewExtend,!0)),this._range=asc([linearMap(handleEnds[0],viewExtend,percentExtent,!0),linearMap(handleEnds[1],viewExtend,percentExtent,!0)]),this._updateView(),this._dispatchZoomAction(!1)}}}},SliderZoomView$1.prototype._onBrush=function(e$2){this._brushing&&(stop(e$2.event),this._updateBrushRect(e$2.offsetX,e$2.offsetY))},SliderZoomView$1.prototype._updateBrushRect=function(mouseX,mouseY){var displayables=this._displayables,dataZoomModel=this.dataZoomModel,brushRect=displayables.brushRect;brushRect||(brushRect=displayables.brushRect=new Rect({silent:!0,style:dataZoomModel.getModel(`brushStyle`).getItemStyle()}),displayables.sliderGroup.add(brushRect)),brushRect.attr(`ignore`,!1);var brushStart=this._brushStart,sliderGroup=this._displayables.sliderGroup,endPoint=sliderGroup.transformCoordToLocal(mouseX,mouseY),startPoint=sliderGroup.transformCoordToLocal(brushStart.x,brushStart.y),size=this._size;endPoint[0]=Math.max(Math.min(size[0],endPoint[0]),0),brushRect.setShape({x:startPoint[0],y:0,width:endPoint[0]-startPoint[0],height:size[1]})},SliderZoomView$1.prototype._dispatchZoomAction=function(realtime){var range=this._range;this.api.dispatchAction({type:`dataZoom`,from:this.uid,dataZoomId:this.dataZoomModel.id,animation:realtime?REALTIME_ANIMATION_CONFIG:null,start:range[0],end:range[1]})},SliderZoomView$1.prototype._findCoordRect=function(){var rect,coordSysInfoList=collectReferCoordSysModelInfo(this.dataZoomModel).infoList;if(!rect&&coordSysInfoList.length){var coordSys=coordSysInfoList[0].model.coordinateSystem;rect=coordSys.getRect&&coordSys.getRect()}if(!rect){var width=this.api.getWidth(),height=this.api.getHeight();rect={x:width*.2,y:height*.2,width:width*.6,height:height*.6}}return rect},SliderZoomView$1.type=`dataZoom.slider`,SliderZoomView$1}(DataZoomView_default);function getOtherDim(thisDim){return{x:`y`,y:`x`,radius:`angle`,angle:`radius`}[thisDim]}function getCursor(orient){return orient===`vertical`?`ns-resize`:`ew-resize`}var SliderZoomView_default=SliderZoomView;function install$9(registers){registers.registerComponentModel(SliderZoomModel_default),registers.registerComponentView(SliderZoomView_default),installCommon(registers)}function install$5(registers){use(install$8),use(install$9)}function createDom(id,painter,dpr$1){var newDom=platformApi.createCanvas(),width=painter.getWidth(),height=painter.getHeight(),newDomStyle=newDom.style;return newDomStyle&&(newDomStyle.position=`absolute`,newDomStyle.left=`0`,newDomStyle.top=`0`,newDomStyle.width=width+`px`,newDomStyle.height=height+`px`,newDom.setAttribute(`data-zr-dom-id`,id)),newDom.width=width*dpr$1,newDom.height=height*dpr$1,newDom}var Layer_default=function(_super){__extends(Layer$1,_super);function Layer$1(id,painter,dpr$1){var _this=_super.call(this)||this;_this.motionBlur=!1,_this.lastFrameAlpha=.7,_this.dpr=1,_this.virtual=!1,_this.config={},_this.incremental=!1,_this.zlevel=0,_this.maxRepaintRectCount=5,_this.__dirty=!0,_this.__firstTimePaint=!0,_this.__used=!1,_this.__drawIndex=0,_this.__startIndex=0,_this.__endIndex=0,_this.__prevStartIndex=null,_this.__prevEndIndex=null;var dom;dpr$1||=devicePixelRatio,typeof id==`string`?dom=createDom(id,painter,dpr$1):isObject(id)&&(dom=id,id=dom.id),_this.id=id,_this.dom=dom;var domStyle=dom.style;return domStyle&&(disableUserSelect(dom),dom.onselectstart=function(){return!1},domStyle.padding=`0`,domStyle.margin=`0`,domStyle.borderWidth=`0`),_this.painter=painter,_this.dpr=dpr$1,_this}return Layer$1.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},Layer$1.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},Layer$1.prototype.initContext=function(){this.ctx=this.dom.getContext(`2d`),this.ctx.dpr=this.dpr},Layer$1.prototype.setUnpainted=function(){this.__firstTimePaint=!0},Layer$1.prototype.createBackBuffer=function(){var dpr$1=this.dpr;this.domBack=createDom(`back-`+this.id,this.painter,dpr$1),this.ctxBack=this.domBack.getContext(`2d`),dpr$1!==1&&this.ctxBack.scale(dpr$1,dpr$1)},Layer$1.prototype.createRepaintRects=function(displayList,prevList,viewWidth,viewHeight){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var mergedRepaintRects=[],maxRepaintRectCount=this.maxRepaintRectCount,full=!1,pendingRect=new BoundingRect_default(0,0,0,0);function addRectToMergePool(rect){if(!(!rect.isFinite()||rect.isZero()))if(mergedRepaintRects.length===0){var boundingRect=new BoundingRect_default(0,0,0,0);boundingRect.copy(rect),mergedRepaintRects.push(boundingRect)}else{for(var isMerged=!1,minDeltaArea=1/0,bestRectToMergeIdx=0,i$2=0;i$2<mergedRepaintRects.length;++i$2){var mergedRect=mergedRepaintRects[i$2];if(mergedRect.intersect(rect)){var pendingRect_1=new BoundingRect_default(0,0,0,0);pendingRect_1.copy(mergedRect),pendingRect_1.union(rect),mergedRepaintRects[i$2]=pendingRect_1,isMerged=!0;break}else if(full){pendingRect.copy(rect),pendingRect.union(mergedRect);var aArea=rect.width*rect.height,bArea=mergedRect.width*mergedRect.height,deltaArea=pendingRect.width*pendingRect.height-aArea-bArea;deltaArea<minDeltaArea&&(minDeltaArea=deltaArea,bestRectToMergeIdx=i$2)}}if(full&&(mergedRepaintRects[bestRectToMergeIdx].union(rect),isMerged=!0),!isMerged){var boundingRect=new BoundingRect_default(0,0,0,0);boundingRect.copy(rect),mergedRepaintRects.push(boundingRect)}full||=mergedRepaintRects.length>=maxRepaintRectCount}}for(var i$1=this.__startIndex;i$1<this.__endIndex;++i$1){var el=displayList[i$1];if(el){var shouldPaint=el.shouldBePainted(viewWidth,viewHeight,!0,!0),prevRect=el.__isRendered&&(el.__dirty&1||!shouldPaint)?el.getPrevPaintRect():null;prevRect&&addRectToMergePool(prevRect);var curRect=shouldPaint&&(el.__dirty&1||!el.__isRendered)?el.getPaintRect():null;curRect&&addRectToMergePool(curRect)}}for(var i$1=this.__prevStartIndex;i$1<this.__prevEndIndex;++i$1){var el=prevList[i$1],shouldPaint=el&&el.shouldBePainted(viewWidth,viewHeight,!0,!0);if(el&&(!shouldPaint||!el.__zr)&&el.__isRendered){var prevRect=el.getPrevPaintRect();prevRect&&addRectToMergePool(prevRect)}}var hasIntersections;do{hasIntersections=!1;for(var i$1=0;i$1<mergedRepaintRects.length;){if(mergedRepaintRects[i$1].isZero()){mergedRepaintRects.splice(i$1,1);continue}for(var j$1=i$1+1;j$1<mergedRepaintRects.length;)mergedRepaintRects[i$1].intersect(mergedRepaintRects[j$1])?(hasIntersections=!0,mergedRepaintRects[i$1].union(mergedRepaintRects[j$1]),mergedRepaintRects.splice(j$1,1)):j$1++;i$1++}}while(hasIntersections);return this._paintRects=mergedRepaintRects,mergedRepaintRects},Layer$1.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},Layer$1.prototype.resize=function(width,height){var dpr$1=this.dpr,dom=this.dom,domStyle=dom.style,domBack=this.domBack;domStyle&&(domStyle.width=width+`px`,domStyle.height=height+`px`),dom.width=width*dpr$1,dom.height=height*dpr$1,domBack&&(domBack.width=width*dpr$1,domBack.height=height*dpr$1,dpr$1!==1&&this.ctxBack.scale(dpr$1,dpr$1))},Layer$1.prototype.clear=function(clearAll,clearColor,repaintRects){var dom=this.dom,ctx=this.ctx,width=dom.width,height=dom.height;clearColor||=this.clearColor;var haveMotionBLur=this.motionBlur&&!clearAll,lastFrameAlpha=this.lastFrameAlpha,dpr$1=this.dpr,self$1=this;haveMotionBLur&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation=`copy`,this.ctxBack.drawImage(dom,0,0,width/dpr$1,height/dpr$1));var domBack=this.domBack;function doClear(x$1,y$1,width$1,height$1){if(ctx.clearRect(x$1,y$1,width$1,height$1),clearColor&&clearColor!==`transparent`){var clearColorGradientOrPattern=void 0;isGradientObject(clearColor)?(clearColorGradientOrPattern=(clearColor.global||clearColor.__width===width$1&&clearColor.__height===height$1)&&clearColor.__canvasGradient||getCanvasGradient(ctx,clearColor,{x:0,y:0,width:width$1,height:height$1}),clearColor.__canvasGradient=clearColorGradientOrPattern,clearColor.__width=width$1,clearColor.__height=height$1):isImagePatternObject(clearColor)&&(clearColor.scaleX=clearColor.scaleX||dpr$1,clearColor.scaleY=clearColor.scaleY||dpr$1,clearColorGradientOrPattern=createCanvasPattern(ctx,clearColor,{dirty:function(){self$1.setUnpainted(),self$1.painter.refresh()}})),ctx.save(),ctx.fillStyle=clearColorGradientOrPattern||clearColor,ctx.fillRect(x$1,y$1,width$1,height$1),ctx.restore()}haveMotionBLur&&(ctx.save(),ctx.globalAlpha=lastFrameAlpha,ctx.drawImage(domBack,x$1,y$1,width$1,height$1),ctx.restore())}!repaintRects||haveMotionBLur?doClear(0,0,width,height):repaintRects.length&&each(repaintRects,function(rect){doClear(rect.x*dpr$1,rect.y*dpr$1,rect.width*dpr$1,rect.height*dpr$1)})},Layer$1}(Eventful_default),HOVER_LAYER_ZLEVEL=1e5,CANVAS_ZLEVEL=314159,EL_AFTER_INCREMENTAL_INC=.01,INCREMENTAL_INC=.001;function isLayerValid(layer){return layer?layer.__builtin__?!0:!(typeof layer.resize!=`function`||typeof layer.refresh!=`function`):!1}function createRoot(width,height){var domRoot=document.createElement(`div`);return domRoot.style.cssText=[`position:relative`,`width:`+width+`px`,`height:`+height+`px`,`padding:0`,`margin:0`,`border-width:0`].join(`;`)+`;`,domRoot}var Painter_default=function(){function CanvasPainter$1(root,storage,opts,id){this.type=`canvas`,this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type=`canvas`;var singleCanvas=!root.nodeName||root.nodeName.toUpperCase()===`CANVAS`;this._opts=opts=extend({},opts||{}),this.dpr=opts.devicePixelRatio||devicePixelRatio,this._singleCanvas=singleCanvas,this.root=root,root.style&&(disableUserSelect(root),root.innerHTML=``),this.storage=storage;var zlevelList=this._zlevelList;this._prevDisplayList=[];var layers=this._layers;if(singleCanvas){var rootCanvas=root,width=rootCanvas.width,height=rootCanvas.height;opts.width!=null&&(width=opts.width),opts.height!=null&&(height=opts.height),this.dpr=opts.devicePixelRatio||1,rootCanvas.width=width*this.dpr,rootCanvas.height=height*this.dpr,this._width=width,this._height=height;var mainLayer=new Layer_default(rootCanvas,this,this.dpr);mainLayer.__builtin__=!0,mainLayer.initContext(),layers[CANVAS_ZLEVEL]=mainLayer,mainLayer.zlevel=CANVAS_ZLEVEL,zlevelList.push(CANVAS_ZLEVEL),this._domRoot=root}else{this._width=getSize(root,0,opts),this._height=getSize(root,1,opts);var domRoot=this._domRoot=createRoot(this._width,this._height);root.appendChild(domRoot)}}return CanvasPainter$1.prototype.getType=function(){return`canvas`},CanvasPainter$1.prototype.isSingleCanvas=function(){return this._singleCanvas},CanvasPainter$1.prototype.getViewportRoot=function(){return this._domRoot},CanvasPainter$1.prototype.getViewportRootOffset=function(){var viewportRoot=this.getViewportRoot();if(viewportRoot)return{offsetLeft:viewportRoot.offsetLeft||0,offsetTop:viewportRoot.offsetTop||0}},CanvasPainter$1.prototype.refresh=function(paintAll){var list=this.storage.getDisplayList(!0),prevList=this._prevDisplayList,zlevelList=this._zlevelList;this._redrawId=Math.random(),this._paintList(list,prevList,paintAll,this._redrawId);for(var i$1=0;i$1<zlevelList.length;i$1++){var z=zlevelList[i$1],layer=this._layers[z];if(!layer.__builtin__&&layer.refresh){var clearColor=i$1===0?this._backgroundColor:null;layer.refresh(clearColor)}}return this._opts.useDirtyRect&&(this._prevDisplayList=list.slice()),this},CanvasPainter$1.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},CanvasPainter$1.prototype._paintHoverList=function(list){var len$1=list.length,hoverLayer=this._hoverlayer;if(hoverLayer&&hoverLayer.clear(),len$1){for(var scope={inHover:!0,viewWidth:this._width,viewHeight:this._height},ctx,i$1=0;i$1<len$1;i$1++){var el=list[i$1];el.__inHover&&(hoverLayer||=this._hoverlayer=this.getLayer(HOVER_LAYER_ZLEVEL),ctx||(ctx=hoverLayer.ctx,ctx.save()),brush(ctx,el,scope,i$1===len$1-1))}ctx&&ctx.restore()}},CanvasPainter$1.prototype.getHoverLayer=function(){return this.getLayer(HOVER_LAYER_ZLEVEL)},CanvasPainter$1.prototype.paintOne=function(ctx,el){brushSingle(ctx,el)},CanvasPainter$1.prototype._paintList=function(list,prevList,paintAll,redrawId){if(this._redrawId===redrawId){paintAll||=!1,this._updateLayerStatus(list);var _a$1=this._doPaintList(list,prevList,paintAll),finished=_a$1.finished,needsRefreshHover=_a$1.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),needsRefreshHover&&this._paintHoverList(list),finished)this.eachLayer(function(layer){layer.afterBrush&&layer.afterBrush()});else{var self_1=this;requestAnimationFrame_default(function(){self_1._paintList(list,prevList,paintAll,redrawId)})}}},CanvasPainter$1.prototype._compositeManually=function(){var ctx=this.getLayer(CANVAS_ZLEVEL).ctx,width=this._domRoot.width,height=this._domRoot.height;ctx.clearRect(0,0,width,height),this.eachBuiltinLayer(function(layer){layer.virtual&&ctx.drawImage(layer.dom,0,0,width,height)})},CanvasPainter$1.prototype._doPaintList=function(list,prevList,paintAll){for(var _this=this,layerList=[],useDirtyRect=this._opts.useDirtyRect,zi=0;zi<this._zlevelList.length;zi++){var zlevel=this._zlevelList[zi],layer=this._layers[zlevel];layer.__builtin__&&layer!==this._hoverlayer&&(layer.__dirty||paintAll)&&layerList.push(layer)}for(var finished=!0,needsRefreshHover=!1,_loop_1=function(k$2){var layer$1=layerList[k$2],ctx=layer$1.ctx,repaintRects=useDirtyRect&&layer$1.createRepaintRects(list,prevList,this_1._width,this_1._height),start$1=paintAll?layer$1.__startIndex:layer$1.__drawIndex,useTimer=!paintAll&&layer$1.incremental&&Date.now,startTime=useTimer&&Date.now(),clearColor=layer$1.zlevel===this_1._zlevelList[0]?this_1._backgroundColor:null;if(layer$1.__startIndex===layer$1.__endIndex)layer$1.clear(!1,clearColor,repaintRects);else if(start$1===layer$1.__startIndex){var firstEl=list[start$1];(!firstEl.incremental||!firstEl.notClear||paintAll)&&layer$1.clear(!1,clearColor,repaintRects)}start$1===-1&&(console.error(`For some unknown reason. drawIndex is -1`),start$1=layer$1.__startIndex);var i$1,repaint=function(repaintRect){var scope={inHover:!1,allClipped:!1,prevEl:null,viewWidth:_this._width,viewHeight:_this._height};for(i$1=start$1;i$1<layer$1.__endIndex;i$1++){var el=list[i$1];if(el.__inHover&&(needsRefreshHover=!0),_this._doPaintEl(el,layer$1,useDirtyRect,repaintRect,scope,i$1===layer$1.__endIndex-1),useTimer&&Date.now()-startTime>15)break}scope.prevElClipPaths&&ctx.restore()};if(repaintRects)if(repaintRects.length===0)i$1=layer$1.__endIndex;else for(var dpr$1=this_1.dpr,r$1=0;r$1<repaintRects.length;++r$1){var rect=repaintRects[r$1];ctx.save(),ctx.beginPath(),ctx.rect(rect.x*dpr$1,rect.y*dpr$1,rect.width*dpr$1,rect.height*dpr$1),ctx.clip(),repaint(rect),ctx.restore()}else ctx.save(),repaint(),ctx.restore();layer$1.__drawIndex=i$1,layer$1.__drawIndex<layer$1.__endIndex&&(finished=!1)},this_1=this,k$1=0;k$1<layerList.length;k$1++)_loop_1(k$1);return env_default.wxa&&each(this._layers,function(layer$1){layer$1&&layer$1.ctx&&layer$1.ctx.draw&&layer$1.ctx.draw()}),{finished,needsRefreshHover}},CanvasPainter$1.prototype._doPaintEl=function(el,currentLayer,useDirtyRect,repaintRect,scope,isLast){var ctx=currentLayer.ctx;if(useDirtyRect){var paintRect=el.getPaintRect();(!repaintRect||paintRect&&paintRect.intersect(repaintRect))&&(brush(ctx,el,scope,isLast),el.setPrevPaintRect(paintRect))}else brush(ctx,el,scope,isLast)},CanvasPainter$1.prototype.getLayer=function(zlevel,virtual){this._singleCanvas&&!this._needsManuallyCompositing&&(zlevel=CANVAS_ZLEVEL);var layer=this._layers[zlevel];return layer||(layer=new Layer_default(`zr_`+zlevel,this,this.dpr),layer.zlevel=zlevel,layer.__builtin__=!0,this._layerConfig[zlevel]?merge(layer,this._layerConfig[zlevel],!0):this._layerConfig[zlevel-EL_AFTER_INCREMENTAL_INC]&&merge(layer,this._layerConfig[zlevel-EL_AFTER_INCREMENTAL_INC],!0),virtual&&(layer.virtual=virtual),this.insertLayer(zlevel,layer),layer.initContext()),layer},CanvasPainter$1.prototype.insertLayer=function(zlevel,layer){var layersMap=this._layers,zlevelList=this._zlevelList,len$1=zlevelList.length,domRoot=this._domRoot,prevLayer=null,i$1=-1;if(!layersMap[zlevel]&&isLayerValid(layer)){if(len$1>0&&zlevel>zlevelList[0]){for(i$1=0;i$1<len$1-1&&!(zlevelList[i$1]<zlevel&&zlevelList[i$1+1]>zlevel);i$1++);prevLayer=layersMap[zlevelList[i$1]]}if(zlevelList.splice(i$1+1,0,zlevel),layersMap[zlevel]=layer,!layer.virtual)if(prevLayer){var prevDom=prevLayer.dom;prevDom.nextSibling?domRoot.insertBefore(layer.dom,prevDom.nextSibling):domRoot.appendChild(layer.dom)}else domRoot.firstChild?domRoot.insertBefore(layer.dom,domRoot.firstChild):domRoot.appendChild(layer.dom);layer.painter||=this}},CanvasPainter$1.prototype.eachLayer=function(cb,context$1){for(var zlevelList=this._zlevelList,i$1=0;i$1<zlevelList.length;i$1++){var z=zlevelList[i$1];cb.call(context$1,this._layers[z],z)}},CanvasPainter$1.prototype.eachBuiltinLayer=function(cb,context$1){for(var zlevelList=this._zlevelList,i$1=0;i$1<zlevelList.length;i$1++){var z=zlevelList[i$1],layer=this._layers[z];layer.__builtin__&&cb.call(context$1,layer,z)}},CanvasPainter$1.prototype.eachOtherLayer=function(cb,context$1){for(var zlevelList=this._zlevelList,i$1=0;i$1<zlevelList.length;i$1++){var z=zlevelList[i$1],layer=this._layers[z];layer.__builtin__||cb.call(context$1,layer,z)}},CanvasPainter$1.prototype.getLayers=function(){return this._layers},CanvasPainter$1.prototype._updateLayerStatus=function(list){this.eachBuiltinLayer(function(layer$1,z){layer$1.__dirty=layer$1.__used=!1});function updatePrevLayer(idx){prevLayer&&(prevLayer.__endIndex!==idx&&(prevLayer.__dirty=!0),prevLayer.__endIndex=idx)}if(this._singleCanvas)for(var i_1=1;i_1<list.length;i_1++){var el=list[i_1];if(el.zlevel!==list[i_1-1].zlevel||el.incremental){this._needsManuallyCompositing=!0;break}}var prevLayer=null,incrementalLayerCount=0,prevZlevel,i$1;for(i$1=0;i$1<list.length;i$1++){var el=list[i$1],zlevel=el.zlevel,layer=void 0;prevZlevel!==zlevel&&(prevZlevel=zlevel,incrementalLayerCount=0),el.incremental?(layer=this.getLayer(zlevel+INCREMENTAL_INC,this._needsManuallyCompositing),layer.incremental=!0,incrementalLayerCount=1):layer=this.getLayer(zlevel+(incrementalLayerCount>0?EL_AFTER_INCREMENTAL_INC:0),this._needsManuallyCompositing),layer.__builtin__||logError(`ZLevel `+zlevel+` has been used by unkown layer `+layer.id),layer!==prevLayer&&(layer.__used=!0,layer.__startIndex!==i$1&&(layer.__dirty=!0),layer.__startIndex=i$1,layer.incremental?layer.__drawIndex=-1:layer.__drawIndex=i$1,updatePrevLayer(i$1),prevLayer=layer),el.__dirty&1&&!el.__inHover&&(layer.__dirty=!0,layer.incremental&&layer.__drawIndex<0&&(layer.__drawIndex=i$1))}updatePrevLayer(i$1),this.eachBuiltinLayer(function(layer$1,z){!layer$1.__used&&layer$1.getElementCount()>0&&(layer$1.__dirty=!0,layer$1.__startIndex=layer$1.__endIndex=layer$1.__drawIndex=0),layer$1.__dirty&&layer$1.__drawIndex<0&&(layer$1.__drawIndex=layer$1.__startIndex)})},CanvasPainter$1.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},CanvasPainter$1.prototype._clearLayer=function(layer){layer.clear()},CanvasPainter$1.prototype.setBackgroundColor=function(backgroundColor$1){this._backgroundColor=backgroundColor$1,each(this._layers,function(layer){layer.setUnpainted()})},CanvasPainter$1.prototype.configLayer=function(zlevel,config){if(config){var layerConfig=this._layerConfig;layerConfig[zlevel]?merge(layerConfig[zlevel],config,!0):layerConfig[zlevel]=config;for(var i$1=0;i$1<this._zlevelList.length;i$1++){var _zlevel=this._zlevelList[i$1];if(_zlevel===zlevel||_zlevel===zlevel+EL_AFTER_INCREMENTAL_INC){var layer=this._layers[_zlevel];merge(layer,layerConfig[zlevel],!0)}}}},CanvasPainter$1.prototype.delLayer=function(zlevel){var layers=this._layers,zlevelList=this._zlevelList,layer=layers[zlevel];layer&&(layer.dom.parentNode.removeChild(layer.dom),delete layers[zlevel],zlevelList.splice(indexOf(zlevelList,zlevel),1))},CanvasPainter$1.prototype.resize=function(width,height){if(this._domRoot.style){var domRoot=this._domRoot;domRoot.style.display=`none`;var opts=this._opts,root=this.root;if(width!=null&&(opts.width=width),height!=null&&(opts.height=height),width=getSize(root,0,opts),height=getSize(root,1,opts),domRoot.style.display=``,this._width!==width||height!==this._height){for(var id in domRoot.style.width=width+`px`,domRoot.style.height=height+`px`,this._layers)this._layers.hasOwnProperty(id)&&this._layers[id].resize(width,height);this.refresh(!0)}this._width=width,this._height=height}else{if(width==null||height==null)return;this._width=width,this._height=height,this.getLayer(CANVAS_ZLEVEL).resize(width,height)}return this},CanvasPainter$1.prototype.clearLayer=function(zlevel){var layer=this._layers[zlevel];layer&&layer.clear()},CanvasPainter$1.prototype.dispose=function(){this.root.innerHTML=``,this.root=this.storage=this._domRoot=this._layers=null},CanvasPainter$1.prototype.getRenderedCanvas=function(opts){if(opts||={},this._singleCanvas&&!this._compositeManually)return this._layers[CANVAS_ZLEVEL].dom;var imageLayer=new Layer_default(`image`,this,opts.pixelRatio||this.dpr);imageLayer.initContext(),imageLayer.clear(!1,opts.backgroundColor||this._backgroundColor);var ctx=imageLayer.ctx;if(opts.pixelRatio<=this.dpr){this.refresh();var width_1=imageLayer.dom.width,height_1=imageLayer.dom.height;this.eachLayer(function(layer){layer.__builtin__?ctx.drawImage(layer.dom,0,0,width_1,height_1):layer.renderToCanvas&&(ctx.save(),layer.renderToCanvas(ctx),ctx.restore())})}else for(var scope={inHover:!1,viewWidth:this._width,viewHeight:this._height},displayList=this.storage.getDisplayList(!0),i$1=0,len$1=displayList.length;i$1<len$1;i$1++){var el=displayList[i$1];brush(ctx,el,scope,i$1===len$1-1)}return imageLayer.dom},CanvasPainter$1.prototype.getWidth=function(){return this._width},CanvasPainter$1.prototype.getHeight=function(){return this._height},CanvasPainter$1}();function install$7(registers){registers.registerPainter(`canvas`,Painter_default)}var EMAStudy=class extends WindowedStudy{constructor(period=12,color$2=`#ff6b6b`){super(`ema`,`EMA(${period})`,period,new PolylineBatch(color$2,2)),this.previousEMA=null,this.multiplier=2/(period+1),this.color=color$2}getPeriod(){return this.windowSize}getColor(){return this.color}calculateValue(window$1){if(window$1.length<this.windowSize)return null;let currentClose=window$1[window$1.length-1].close;if(this.previousEMA===null)return this.previousEMA=window$1.reduce((acc,candle)=>acc+candle.close,0)/window$1.length,this.previousEMA;let ema=(currentClose-this.previousEMA)*this.multiplier+this.previousEMA;return this.previousEMA=ema,ema}extractPriceBounds(value){return{min:value,max:value}}resetCandles(allCandles){return this.previousEMA=null,super.resetCandles(allCandles)}prependHistoricalCandles(allCandles){return this.previousEMA=null,super.prependHistoricalCandles(allCandles)}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,priceScale=commonScales.priceScale;return{x:timeScale.scaledValueFromIndex(index),y:priceScale.scaledValue(value)}}},RSIStudy=class extends WindowedStudy{constructor(period=14,color$2=`#9c27b0`){super(`rsi`,`RSI(${period})`,period,new PolylineBatch(color$2,2)),this.color=color$2,this.customYScale=new NumericScale(0,100,0,100,!0)}getPeriod(){return this.windowSize}getColor(){return this.color}calculateValue(window$1){if(window$1.length<this.windowSize)return null;let totalGain=0,totalLoss=0;for(let i$1=1;i$1<window$1.length;i$1++){let change=window$1[i$1].close-window$1[i$1-1].close;change>0?totalGain+=change:totalLoss+=Math.abs(change)}let avgGain=totalGain/(window$1.length-1),avgLoss=totalLoss/(window$1.length-1);return avgLoss===0?100:100-100/(1+avgGain/avgLoss)}extractPriceBounds(_value){return null}updateScaleBounds(bounds){this.customYScale.updateRange(bounds.y,bounds.y+bounds.height)}valueToPoint(value,timestamp,index,commonScales){let timeScale=commonScales.timeScale,rsiScale=this.customYScale;return{x:timeScale.scaledValueFromIndex(index),y:rsiScale.scaledValue(value)}}};function mapCandleStudyToECharts(study,timestamps,theme$1,xAxisIndex=0){return{type:`candlestick`,name:`Candles`,data:study.getComputedValues().map(point=>[point.open,point.close,point.low,point.high]),xAxisIndex,yAxisIndex:0,itemStyle:{color:theme$1.candlePositive,color0:theme$1.candleNegative,borderColor:theme$1.candlePositive,borderColor0:theme$1.candleNegative}}}function mapSMAStudyToECharts(study,timestamps,xAxisIndex=0){let values=study.getComputedValues(),startIndex=timestamps.length-values.length,smaData=Array(startIndex).fill(null);for(let i$1=0;i$1<values.length;i$1++)smaData.push(isNaN(values[i$1])?null:values[i$1]);return{type:`line`,name:`SMA(${study.getPeriod()})`,data:smaData,xAxisIndex,yAxisIndex:0,smooth:!1,lineStyle:{width:2,color:study.getColor()},showSymbol:!1}}function mapEMAStudyToECharts(study,timestamps,xAxisIndex=0){let values=study.getComputedValues(),startIndex=timestamps.length-values.length,emaData=Array(startIndex).fill(null);for(let i$1=0;i$1<values.length;i$1++)emaData.push(isNaN(values[i$1])?null:values[i$1]);return{type:`line`,name:`EMA(${study.getPeriod()})`,data:emaData,xAxisIndex,yAxisIndex:0,smooth:!1,lineStyle:{width:2,color:study.getColor()},showSymbol:!1}}function mapVolumeStudyToECharts(study,timestamps,ohlcData,theme$1,xAxisIndex,yAxisIndex){return{type:`bar`,name:`Volume`,data:study.getComputedValues().map((vol,i$1)=>({value:vol.volume,itemStyle:{color:ohlcData[i$1].close>=ohlcData[i$1].open?theme$1.volumePositive:theme$1.volumeNegative}})),xAxisIndex,yAxisIndex,barWidth:`60%`}}function mapBollingerBandsToECharts(study,timestamps,xAxisIndex=0){let values=study.getComputedValues(),startIndex=timestamps.length-values.length,upperData=Array(startIndex).fill(null),middleData=Array(startIndex).fill(null),lowerData=Array(startIndex).fill(null);for(let i$1=0;i$1<values.length;i$1++){let bb=values[i$1];bb&&!isNaN(bb.upper)&&!isNaN(bb.middle)&&!isNaN(bb.lower)?(upperData.push(bb.upper),middleData.push(bb.middle),lowerData.push(bb.lower)):(upperData.push(null),middleData.push(null),lowerData.push(null))}return[{type:`line`,name:`BB Upper`,data:upperData,xAxisIndex,yAxisIndex:0,smooth:!1,lineStyle:{width:1,color:`#2196f380`,type:`dashed`},showSymbol:!1},{type:`line`,name:`BB Middle`,data:middleData,xAxisIndex,yAxisIndex:0,smooth:!1,lineStyle:{width:2,color:`#2196f3`},showSymbol:!1},{type:`line`,name:`BB Lower`,data:lowerData,xAxisIndex,yAxisIndex:0,smooth:!1,lineStyle:{width:1,color:`#2196f380`,type:`dashed`},showSymbol:!1}]}function mapRSIStudyToECharts(study,timestamps,xAxisIndex,yAxisIndex){let values=study.getComputedValues(),startIndex=timestamps.length-values.length,rsiData=Array(startIndex).fill(null);for(let i$1=0;i$1<values.length;i$1++)rsiData.push(isNaN(values[i$1])?null:values[i$1]);return{type:`line`,name:`RSI(${study.getPeriod()})`,data:rsiData,xAxisIndex,yAxisIndex,smooth:!1,lineStyle:{width:2,color:`#9c27b0`},showSymbol:!1}}var EChartsAdapter=class{static mainPaneToSeries(studies,timestamps,ohlcData,theme$1){let series=[],xAxisIndex=0;for(let study of studies)study instanceof CandleStudy?series.push(mapCandleStudyToECharts(study,timestamps,{candlePositive:theme$1.colors.candlePositive,candleNegative:theme$1.colors.candleNegative},0)):study instanceof SMAStudy?series.push(mapSMAStudyToECharts(study,timestamps,0)):study instanceof EMAStudy?series.push(mapEMAStudyToECharts(study,timestamps,0)):study instanceof BollingerBandsStudy&&series.push(...mapBollingerBandsToECharts(study,timestamps,0));return series}static subPaneToSeries(studies,timestamps,ohlcData,theme$1,xAxisIndex,yAxisIndex){let series=[];for(let study of studies)study instanceof VolumeStudy?series.push(mapVolumeStudyToECharts(study,timestamps,ohlcData,{volumePositive:theme$1.colors.candlePositive,volumeNegative:theme$1.colors.candleNegative},xAxisIndex,yAxisIndex)):study instanceof RSIStudy&&series.push(mapRSIStudyToECharts(study,timestamps,xAxisIndex,yAxisIndex));return series}static buildOption(mainPaneStudies,subPanes,timestamps,ohlcData,theme$1){let categoryData=timestamps.map(ts=>{let hours=ts.getHours().toString().padStart(2,`0`),minutes=ts.getMinutes().toString().padStart(2,`0`),seconds=ts.getSeconds().toString().padStart(2,`0`);return`${hours}:${minutes}:${seconds}`}),allSeries=[];allSeries.push(...this.mainPaneToSeries(mainPaneStudies,timestamps,ohlcData,theme$1)),subPanes.forEach((pane,index)=>{let axisIndex=index+1;allSeries.push(...this.subPaneToSeries(pane.studies,timestamps,ohlcData,theme$1,axisIndex,axisIndex))});let totalPanes=1+subPanes.length,gapPercent=.03,availableHeight=1-(totalPanes-1)*gapPercent,mainPaneHeight=(1-subPanes.reduce((sum,pane)=>sum+pane.heightPercent,0))*availableHeight,grids=[],xAxes=[],yAxes=[],currentTop=0;return grids.push({left:60,right:80,top:`${currentTop*100}%`,height:`${mainPaneHeight*100}%`,containLabel:!1}),xAxes.push({type:`category`,data:categoryData,gridIndex:0,scale:!0,boundaryGap:!1,splitLine:{show:!1}}),yAxes.push({type:`value`,gridIndex:0,scale:!0,splitArea:{show:!0},position:`right`}),currentTop+=mainPaneHeight+gapPercent,subPanes.forEach((pane,index)=>{let adjustedHeight=pane.heightPercent*availableHeight;grids.push({left:60,right:80,top:`${currentTop*100}%`,height:`${adjustedHeight*100}%`,containLabel:!1}),xAxes.push({type:`category`,data:categoryData,gridIndex:index+1,scale:!0,boundaryGap:!1,splitLine:{show:!1}}),yAxes.push({type:`value`,gridIndex:index+1,scale:!0,splitArea:{show:!0},position:`right`}),currentTop+=adjustedHeight,index<subPanes.length-1&&(currentTop+=gapPercent)}),{grid:grids,xAxis:xAxes,yAxis:yAxes,series:allSeries,dataZoom:[{type:`inside`,xAxisIndex:Array.from({length:totalPanes},(_,i$1)=>i$1),filterMode:`filter`},{type:`slider`,xAxisIndex:Array.from({length:totalPanes},(_,i$1)=>i$1),bottom:10,filterMode:`filter`}],animation:!1,backgroundColor:theme$1.colors.background,textStyle:{color:theme$1.colors.textColor},tooltip:{trigger:`axis`,axisPointer:{type:`cross`}}}}};use([install,install$1,install$2,install$3,install$4,install$5,install$6,install$7]);var EChartsChart=class{constructor(canvas,chartSize,_padding,theme$1){this.chart=null,this.timestamps=[],this.ohlcData=[],this.mainPaneStudies=[],this.subPanes=[],this.canvas=canvas,this.chartSize=chartSize,this.theme=theme$1;let initOptions={renderer:`canvas`,width:chartSize.width,height:chartSize.height,devicePixelRatio:window.devicePixelRatio||1};this.chart=init(this.canvas,void 0,initOptions),this.setupResizeObserver()}addMainPaneStudy(study){this.mainPaneStudies.push(study),this.ohlcData.length>0&&(study.resetCandles(this.ohlcData),this.render())}createSubPane(id,primaryStudy,heightPercent){let paneConfig={id,heightPercent,studies:[primaryStudy]};this.subPanes.push(paneConfig),this.ohlcData.length>0&&(primaryStudy.resetCandles(this.ohlcData),this.render())}addSubPaneStudy(paneId,study){let pane=this.subPanes.find(p$2=>p$2.id===paneId);if(!pane){console.warn(`Sub-pane with id "${paneId}" not found`);return}pane.studies.push(study),this.ohlcData.length>0&&(study.resetCandles(this.ohlcData),this.render())}loadData(ohlcData){this.ohlcData=ohlcData,this.timestamps=ohlcData.map(d$1=>d$1.timestamp);for(let study of this.mainPaneStudies)study.resetCandles(ohlcData);for(let pane of this.subPanes)for(let study of pane.studies)study.resetCandles(ohlcData);this.render()}updateLastCandle(candle){if(this.ohlcData.length!==0){this.ohlcData[this.ohlcData.length-1]=candle,this.timestamps[this.timestamps.length-1]=candle.timestamp;for(let study of this.mainPaneStudies)study.updateLastCandle(this.ohlcData);for(let pane of this.subPanes)for(let study of pane.studies)study.updateLastCandle(this.ohlcData);this.render()}}appendCandle(candle){this.ohlcData.push(candle),this.timestamps.push(candle.timestamp);for(let study of this.mainPaneStudies)study.appendNewCandle(this.ohlcData);for(let pane of this.subPanes)for(let study of pane.studies)study.appendNewCandle(this.ohlcData);this.render()}prependCandles(candles){this.ohlcData=[...candles,...this.ohlcData],this.timestamps=[...candles.map(c$2=>c$2.timestamp),...this.timestamps];for(let study of this.mainPaneStudies)study.prependHistoricalCandles(candles);for(let pane of this.subPanes)for(let study of pane.studies)study.prependHistoricalCandles(candles);this.render()}updateTheme(theme$1){this.theme=theme$1,this.render()}resize(newSize){this.chartSize=newSize,this.chart?.resize({width:newSize.width,height:newSize.height})}destroy(){this.chart?.dispose(),this.chart=null}render(){if(!this.chart||this.ohlcData.length===0)return;let option=EChartsAdapter.buildOption(this.mainPaneStudies,this.subPanes,this.timestamps,this.ohlcData,this.theme);this.chart.setOption(option,{})}setupResizeObserver(){new ResizeObserver(()=>{this.chart&&this.chart.resize()}).observe(this.canvas.parentElement||this.canvas)}getEChartsInstance(){return this.chart}},_hoisted_1$1={class:`echarts-demo`},_hoisted_2$1={class:`chart-layout`},_hoisted_3$1={class:`controls-sidebar`},_hoisted_4={class:`control-group`},_hoisted_5=[`disabled`],_hoisted_6={class:`control-group`},_hoisted_7=[`disabled`],_hoisted_8={class:`control-group`},_hoisted_9=[`disabled`],_hoisted_10=[`disabled`],_hoisted_11={class:`chart-area`},_hoisted_12={class:`stats`},_hoisted_13={key:0,class:`loading-indicator`},EChartsDemo_default=__plugin_vue_export_helper_default(defineComponent({__name:`EChartsDemo`,setup(__props){let chartCanvas=ref(),chartContainer=ref(),chartSize=reactive({width:1200,height:700}),chartPadding=reactive(getDefaultChartPadding()),{currentThemeObject,actualTheme}=useTheme(),chart=null,dataManager=null,volatility=ref(Volatility.Medium),candleDuration=ref(CandleDuration.FiveSeconds),ticksPerSecond=ref(5),isRunning=ref(!1),isLoading=ref(!1),candleCount=ref(0),updatesPerSecond=ref(0),lastPrice=ref(0),updateCount=0,lastStatsUpdate=Date.now();watch([candleDuration,volatility,ticksPerSecond],()=>{isRunning.value||resetChart()});async function initChart(){let canvas=chartCanvas.value,container=chartContainer.value;if(!(!canvas||!container))try{isLoading.value=!0;let dimensions=getInitialChartDimensions(chartContainer.value);Object.assign(chartSize,dimensions.size),Object.assign(chartPadding,dimensions.padding),dataManager=new SimulatorDataManager({symbol:`ECHARTS-DEMO`,candleDuration:candleDuration.value,initialPrice:500,historicalCandleCount:500,ticksPerSecond:ticksPerSecond.value,volatility:volatility.value}),chart=new EChartsChart(canvas,chartSize,chartPadding,currentThemeObject.value);let candleStudy=new CandleStudy;chart.addMainPaneStudy(candleStudy);let sma20=new SMAStudy(20,`#2196f3`);chart.addMainPaneStudy(sma20);let bb=new BollingerBandsStudy(20,2);chart.addMainPaneStudy(bb);let volumeStudy=new VolumeStudy;chart.createSubPane(`volume`,volumeStudy,.2);let batch$1=await dataManager.loadHistorical();chart.loadData(batch$1.candles),candleCount.value=batch$1.candles.length;let lastTimestamp=batch$1.candles[batch$1.candles.length-1].timestamp;dataManager.onRealtimeUpdate(candle=>{candle.timestamp.getTime()===lastTimestamp.getTime()?chart?.updateLastCandle(candle):(chart?.appendCandle(candle),lastTimestamp=candle.timestamp,candleCount.value++),updateCount++,lastPrice.value=candle.close}),isLoading.value=!1,console.log(`ECharts demo initialized successfully`)}catch(error$1){console.error(`Failed to initialize ECharts demo:`,error$1),isLoading.value=!1}}function toggleSimulation(){isRunning.value?stopSimulation():startSimulation()}function startSimulation(){dataManager&&(dataManager.start(),isRunning.value=!0,updateCount=0,lastStatsUpdate=Date.now(),startStatsTracking())}function stopSimulation(){dataManager&&(dataManager.stop(),isRunning.value=!1,stopStatsTracking())}async function resetChart(){isRunning.value&&stopSimulation(),chart&&=(chart.destroy(),null),await initChart()}let statsInterval=null;function startStatsTracking(){statsInterval=window.setInterval(()=>{let now=Date.now(),elapsed=(now-lastStatsUpdate)/1e3;updatesPerSecond.value=updateCount/elapsed,updateCount=0,lastStatsUpdate=now},1e3)}function stopStatsTracking(){statsInterval!==null&&(clearInterval(statsInterval),statsInterval=null),updatesPerSecond.value=0}return onMounted(()=>{initChart()}),onUnmounted(()=>{isRunning.value&&stopSimulation(),stopStatsTracking(),chart&&chart.destroy()}),watch(()=>actualTheme.value,()=>{let newTheme=currentThemeObject.value;chart&&chart.updateTheme(newTheme)}),(_ctx,_cache)=>(openBlock(),createElementBlock(`div`,_hoisted_1$1,[_cache[8]||=createBaseVNode(`h2`,{class:`demo-title`},`ECharts Canvas (High-Level Charting Library)`,-1),createBaseVNode(`div`,_hoisted_2$1,[createBaseVNode(`div`,_hoisted_3$1,[createBaseVNode(`div`,_hoisted_4,[_cache[4]||=createBaseVNode(`label`,null,`Volatility`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[0]||=$event=>volatility.value=$event,disabled:isRunning.value},[..._cache[3]||=[createBaseVNode(`option`,{value:`low`},`Low`,-1),createBaseVNode(`option`,{value:`medium`},`Medium`,-1),createBaseVNode(`option`,{value:`high`},`High`,-1)]],8,_hoisted_5),[[vModelSelect,volatility.value]])]),createBaseVNode(`div`,_hoisted_6,[_cache[6]||=createBaseVNode(`label`,null,`Candle Duration`,-1),withDirectives(createBaseVNode(`select`,{"onUpdate:modelValue":_cache[1]||=$event=>candleDuration.value=$event,disabled:isRunning.value},[..._cache[5]||=[createBaseVNode(`option`,{value:`1s`},`1 Second`,-1),createBaseVNode(`option`,{value:`5s`},`5 Seconds`,-1),createBaseVNode(`option`,{value:`30s`},`30 Seconds`,-1),createBaseVNode(`option`,{value:`1m`},`1 Minute`,-1)]],8,_hoisted_7),[[vModelSelect,candleDuration.value]])]),createBaseVNode(`div`,_hoisted_8,[_cache[7]||=createBaseVNode(`label`,null,`Ticks/sec`,-1),withDirectives(createBaseVNode(`input`,{type:`number`,"onUpdate:modelValue":_cache[2]||=$event=>ticksPerSecond.value=$event,min:`1`,max:`60`,disabled:isRunning.value},null,8,_hoisted_9),[[vModelText,ticksPerSecond.value,void 0,{number:!0}]])]),createBaseVNode(`button`,{onClick:toggleSimulation,class:`toggle-btn`},toDisplayString(isRunning.value?`Stop`:`Start`),1),createBaseVNode(`button`,{onClick:resetChart,disabled:!isRunning.value,class:`reset-btn`},` Reset `,8,_hoisted_10)]),createBaseVNode(`div`,_hoisted_11,[createBaseVNode(`div`,{ref_key:`chartContainer`,ref:chartContainer,class:`chart-container`},[createBaseVNode(`canvas`,{ref_key:`chartCanvas`,ref:chartCanvas,class:`chart-canvas`},null,512)],512),createBaseVNode(`div`,_hoisted_12,[createBaseVNode(`span`,null,`Candles: `+toDisplayString(candleCount.value),1),createBaseVNode(`span`,null,`Updates/sec: `+toDisplayString(updatesPerSecond.value.toFixed(1)),1),isLoading.value?(openBlock(),createElementBlock(`span`,_hoisted_13,` Loading initial data...`)):createCommentVNode(``,!0)])])])]))}}),[[`__scopeId`,`data-v-3c23dbba`]]),_hoisted_1={class:`not-found`},_hoisted_2={class:`error-content`},_hoisted_3={class:`error-actions`},NotFound_default=__plugin_vue_export_helper_default(defineComponent({__name:`NotFound`,setup(__props){return(_ctx,_cache)=>{let _component_router_link=resolveComponent(`router-link`);return openBlock(),createElementBlock(`div`,_hoisted_1,[createBaseVNode(`div`,_hoisted_2,[_cache[2]||=createBaseVNode(`h1`,{class:`error-code`},`404`,-1),_cache[3]||=createBaseVNode(`h2`,{class:`error-title`},`Page Not Found`,-1),_cache[4]||=createBaseVNode(`p`,{class:`error-message`},`The page you're looking for doesn't exist or has been moved.`,-1),createBaseVNode(`div`,_hoisted_3,[createVNode(_component_router_link,{to:`/`,class:`btn-home`},{default:withCtx(()=>[..._cache[0]||=[createTextVNode(`Go Home`,-1)]]),_:1}),createVNode(_component_router_link,{to:`/chart`,class:`btn-chart`},{default:withCtx(()=>[..._cache[1]||=[createTextVNode(`View Chart`,-1)]]),_:1})])])])}}}),[[`__scopeId`,`data-v-9dfc3c87`]]),router_default=createRouter({history:createWebHistory(`/chart-poc/`),routes:[{path:`/`,name:`Home`,component:HomeComponent_default},{path:`/canvas`,name:`Canvas2D`,component:LiveChartDemo_default},{path:`/pixi-graphics`,name:`PixiGraphics`,component:PixiChart_default},{path:`/pixi-mesh`,name:`PixiMesh`,component:MeshChart_default},{path:`/echarts`,name:`EChartsDemo`,component:EChartsDemo_default},{path:`/:pathMatch(.*)*`,name:`NotFound`,component:NotFound_default}]}),app=createApp(App_default);app.use(router_default),app.mount(`#app`);export{AccessibilitySystem as C,accessibilityTarget as S,extensions$1 as T,EventSystem as _,BitmapTextPipe as a,TickerPlugin as b,GpuParticleContainerPipe as c,GraphicsPipe as d,WebGPURenderer as f,FederatedContainer as g,FilterPipe as h,HTMLTextPipe as i,GlParticleContainerPipe as l,FilterSystem as m,CanvasTextPipe as n,TilingSpritePipe as o,WebGLRenderer as p,HTMLTextSystem as r,NineSliceSpritePipe as s,CanvasTextSystem as t,MeshPipe as u,DOMPipe as v,Container as w,ResizePlugin as x,GraphicsContextSystem as y};